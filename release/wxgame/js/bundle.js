!function(){"use strict";class i{static init(){}}i.width=1280,i.height=720,i.scaleMode="fixedheight",i.screenMode="none",i.alignV="top",i.alignH="left",i.startScene="test/TestScene.scene",i.sceneRoot="",i.debug=!1,i.stat=!1,i.physicsDebug=!1,i.exportSceneToJson=!0,i.init();class t{constructor(){}}t.QUDAO=0,t.bDebugMode=!0,t.bAutoUpdateAPK=!0;class s{constructor(){this.iStatType=0}Draw(){}ProcTouch(i,t,s){return!1}CallBack(i,t){}}class e{constructor(){}}e.GV=2,e.bGm=!1,e.bFromSD=!0,e.sSDTo="url/7gol/",e.sDSURL="www.honglajiao-qiguo.cn",e.sLGURL="www.hlj-qiguo.cn",e.sUpdateSeverList=["http://www.honglajiao-qiguo.cn:7999/7gol/","http://www.honglajiao-qiguo.cn:7998/7gol/","http://www.hlj-qiguo.cn:7999/7gol/","http://www.hlj-qiguo.cn:7998/7gol/","http://www.honglajiao-qiguo.cn:7999/7gol_test/","http://192.168.1.102:7998/7gol_test/"],e.sUpdateClientList=["http://www.honglajiao-qiguo.cn:7999/clients/","http://www.honglajiao-qiguo.cn:7998/clients/","http://www.hlj-qiguo.cn:7999/clients/","http://www.hlj-qiguo.cn:7998/clients/","http://www.honglajiao-qiguo.cn:7999/clients/"],e.APKVersion=83,e.bAutoGetInForDebug=!1,e.iUpgradeExp=[50,82,118,162,223,309,437,625,900,1299,1865,2655,3737,5190,7108,9602,12797,16839,21892,28143,35800,45097,56291,69673,85554,104286,126244,151847,181542,215822,255210,300282,351648,409973,475959,550369,634007,727740,832483,949217,1078972,1222853,1382018,1557702,1751196,1963878,2197181,2452633,2731820,3036427,3368205,3729006,4120752,4545473,5005273,5502370,6039058,6617754,7240952,7911277,8631436,9404270,10232709,11119824,12068777,13082876,14165527,15320290,16550824,17860949,38753380,44123118,50086102,56692039,63993533,72046195,80908733,90643061,101314396,112991366,125746113,139654396,154795703,171253353,189114611,208470792,229417375,252054113,276485149,302819125,331075927,361085709,392955657,426797546,462727854,500867876,541343848,584287057,629618890,677400453,727767957,780862910,836699467,895022208,955969897],e.iUpgradeMoney=[50,82,118,162,223,309,437,625,900,1299,1865,2655,3737,5190,7108,9602,12797,16839,21892,28143,35800,45097,56291,69673,85554,104286,126244,151847,181542,215822,255210,300282,351648,409973,475959,550369,634007,727740,832483,949217,1078972,1222853,1382018,1557702,1751196,1963878,2197181,2452633,2731820,3036427,3368205,3729006,4120752,4545473,5005273,5502370,6039058,6617754,7240952,7911277,8631436,9404270,10232709,11119824,12068777,13082876,14165527,15320290,16550824,17860949,38753380,39648336,40642166,41743155,42960070,44302180,45779269,47401657,49180212,51126373,53252164,55570211,58093762,60836703,63813579,67039609,70530706,74303495,78375334,82764330,87473797,92475427,97787085,103427399,109415783,115772453,122518448,129675649,137230954,145194547,153589131,162438289,171744381,181464837,191622785],e.sZhenName=["普通阵","天罡阵","八卦阵","疾风阵","飞龙阵","聚星阵"],e.sWXK=["火","金","土","水","木"],e.sWuXing=["金","木","水","火","土"],e.sWXS=["土","水","金","木","火"],e._sWXK=["木","土","火","金","水"],e._sWXS=["水","火","木","土","金"],e.sWeek=["日","一","二","三","四","五","六","日","八","九","十"],e.sBigNum=["零","一","二","三","四","五","六","七","八","九","十","十一","十二","十三","十四","十五","十六","十七","十八","十九","二十"],e.iBaseAttAdd=[[10,10,10,10,10],[12,5,11,12,10],[12,11,11,8,8]],e.iMasterids=[75,5,6,7,21,22,23,24,25,26],e.sSchools=["无","剑侠居","茅蓬坞","庐医崖","武安阁","溶洞","鬼谷","封神台","仙人洞","神女峰"],e.iSchoolMapIds=[0,5,6,7,10,8,9,11,12,13],e.iSchoolSkillId=[[1,2,3,4,5,12],[1,2,3,4,5,12],[14,15,16,17,18,19],[27,28,29,30,31,32],[40,41,42,43,44,45],[53,54,55,56,57,58],[66,67,68,69,70,71],[79,80,81,82,83,84],[92,93,94,95,96,97],[105,106,107,108,109,110]],e.iGovSkillId=[118,119,120,121,122,123,124,125],e.iGovXiuId=[126,127,128,129,130,131,197,198,199,200],e.EXTCOLOR="#c00ff00",e.VOICETIMEOUT=300;class h{constructor(){}}h.SCRW=800,h.SCRH=480,h.OFFX=0,h.OFFY=0,h.REALW=1024,h.REALH=768,h.SYSW=2048,h.SYSH=1440,h.bDebug=!1,h.bBigUI=!1,h.BUW=960,h.BUH=540;class a{constructor(i){this.bUseing=!1,this.bLoaded=!1,this.iImageId=i,this.blocks=new Array,this.iBlockCount=0}GetBlock(i,t,s,e){var h;for(h=0;h<this.iBlockCount;h++)if(this.blocks[h].x==i&&this.blocks[h].y==t&&this.blocks[h].w==s&&this.blocks[h].h==e)return this.blocks[h].image;return this.CreateBlock(i,t,s,e).image}CreateBlock(i,t,s,e){return this.blocks[this.iBlockCount]=new Object,this.blocks[this.iBlockCount].x=i,this.blocks[this.iBlockCount].y=t,this.blocks[this.iBlockCount].w=s,this.blocks[this.iBlockCount].h=e,this.blocks[this.iBlockCount].image=Laya.Texture.createFromTexture(this.image,i,t,s,e),this.iBlockCount++,this.blocks[this.iBlockCount-1]}}class n{constructor(){this._txts=new Array(n.SIZE);for(var i=0;i<n.SIZE;i++)this._txts[i]=new Object,this._txts[i].bUseing=!1,this._txts[i].bUsed=!1,this._txts[i].txt=new Laya.Text,this._txts[i].iTimeOut=0,this._txts[i].s="",this._txts[i].c=0,this._txts[i].size=0,this._txts[i].ab=0,this._txts[i].sw=0,this._txts[i].sh=0,this._txts[i].ra=0,this._txts[i].ratx=0,this._txts[i].raty=0,this._txts[i].x=0,this._txts[i].y=0;this.iMaxPoint=0}Find(i,t,s,e,h,a,o,r,c){for(var l=0;l<this.iMaxPoint;l++)if(this._txts[l].bUseing&&!this._txts[l].bUsed&&this._txts[l].s==i&&this._txts[l].c==t&&this._txts[l].size==s&&this._txts[l].ab==e&&this._txts[l].sw==h&&this._txts[l].sh==a&&this._txts[l].ra==o&&this._txts[l].ratx==r&&this._txts[l].raty==c)return this._txts[l].iTimeOut=n.iTick+30,this._txts[l].bUsed=!0,this._txts[l];return null}Get(i,t,s,e,h,a,o,r,c){for(var l=0;l<n.SIZE;l++)if(!this._txts[l].bUseing)return this._txts[l].bUseing=!0,this._txts[l].s=i,this._txts[l].c=t,this._txts[l].size=s,this._txts[l].ab=e,this._txts[l].sw=h,this._txts[l].sh=a,this._txts[l].ra=o,this._txts[l].ratx=r,this._txts[l].raty=c,this._txts[l].iTimeOut=n.iTick+30,this._txts[l].bUsed=!0,this._txts[l];return null}Clear(){this.iCount=0,this.iMaxPoint=0;for(var i=0;i<n.SIZE;i++)this._txts[i].bUseing&&(this._txts[i].iTimeOut<n.iTick?this._txts[i].bUseing=!1:(this._txts[i].bUsed=!1,this.iCount++,this.iMaxPoint=i));this.iMaxPoint++}}n.SIZE=1024,n.iTick=0;class o{constructor(){this._spans=new Array(o.SIZE);for(var i=0;i<o.SIZE;i++)this._spans[i]=new Object,this._spans[i].bUseing=!1,this._spans[i].bUsed=!1,this._spans[i].span=new Laya.HTMLDivElement,this._spans[i].iTimeOut=0,this._spans[i].s="",this._spans[i].x=0,this._spans[i].y=0;this.iMaxPoint=0}Find(i){for(var t=0;t<this.iMaxPoint;t++)if(this._spans[t].bUseing&&!this._spans[t].bUsed&&this._spans[t].s==i)return this._spans[t].iTimeOut=n.iTick+30,this._spans[t].bUsed=!0,this._spans[t];return null}Get(i){for(var t=0;t<o.SIZE;t++)if(!this._spans[t].bUseing)return this._spans[t].bUseing=!0,this._spans[t].span.innerHTML=i,this._spans[t].s=i,this._spans[t].iTimeOut=n.iTick+30,this._spans[t].bUsed=!0,this._spans[t];return null}Clear(){this.iCount=0,this.iMaxPoint=0;for(var i=0;i<o.SIZE;i++)this._spans[i].bUseing&&(this._spans[i].iTimeOut<n.iTick?this._spans[i].bUseing=!1:(this._spans[i].bUsed=!1,this.iCount++,this.iMaxPoint=i));this.iMaxPoint++}}o.SIZE=16;class r{constructor(){this.tb=new n,this.sb=new o,this.m_ImageList=new Array(r.MAXIMAGECOUNT);for(var i=0;i<r.MAXIMAGECOUNT;i++)this.m_ImageList[i]=new a(i);this.view_sprite=new Laya.Sprite,Laya.stage.addChild(this.view_sprite),this.view_sprite.graphics.clear(),this.Clear(),this.block_sprites=new Array,this.iSpritePoint=0,this.iSpriteCount=0,this.block_texts=new Array,this.iTextPoint=0,this.iTextCount=0,this.iClipSpriteCount=0,this.clip_sprites=new Array,this.bClip=!1,this.iFlashDelay=0,this.iTextWidth=-1,this.txt_w=new Laya.Text,this.drawrect=new Int32Array(4)}_SpanText(i,t,s){return"<span style='font-size:"+s+"px;color:"+this.c_to_c(t)+"'>"+i+"</span>"}_DrawSpanText(i,t,s,e){var h=this.sb.Find(s);null==h&&null==(h=this.sb.Get(s))||(h.span.pos(i,t),h.span.style.wordWrap=!0,h.span.style.width=e,this.view_sprite.addChild(h.span))}FindFreeText(){return this.iTextPoint>=this.iTextCount&&(this.block_texts[this.iTextCount]=new Laya.Text,this.iTextCount++),this.iTextPoint++,this.block_texts[this.iTextPoint-1]}FindFreeSprite(){return this.iSpritePoint>=this.iSpriteCount&&(this.block_sprites[this.iSpriteCount]=new Laya.Sprite,this.iSpriteCount++),this.iSpritePoint++,this.block_sprites[this.iSpritePoint-1]}Clear(){var i;for(this.view_sprite.removeChildren(),this.iSpritePoint=0,this.iTextPoint=0,i=0;i<this.iClipSpriteCount;i++)this.clip_sprites[i].scrollRect=null,this.clip_sprites[i].removeChildren();this.iClipSpriteCount=0,this.iFlashDelay>0?(this.iFlashDelay--,this.view_sprite.pos(bn.grnd(-5,5),bn.grnd(-5,5))):this.view_sprite.pos(0,0),n.iTick++,this.tb.Clear(),this.sb.Clear()}FindFreeImage(){for(var i=0;i<r.MAXIMAGECOUNT;i++)if(!this.m_ImageList[i].bUseing)return this.m_ImageList[i];return null}FindImage(i){return this.m_ImageList[i].bUseing&&this.m_ImageList[i].bLoaded?this.m_ImageList[i]:null}LoadedImage(i,t,s,e,h){if(null==h)return t.indexOf("spirit")>0&&bn.addLoadMask(1),void Laya.loader.load((s?"":bn.BASE_URL)+t,Laya.Handler.create(i,i.LoadedImage,[i,t,s,e]),null,Laya.Loader.IMAGE);t.indexOf("spirit")>0&&bn.addLoadMask(2),e.image=h,e.bLoaded=!0,e.fn=t}LoadImage(i,t,s){null==t&&(t=!1),t=!1;var e=this.FindFreeImage();return null==e?-1:(e.bUseing=!0,this.LoadedImage(this,i,t,e),e.iImageId)}_SetViewClip(i,t,s,e){this.bClip=!0,this.iClipX=i,this.iClipY=t,this.iClipW=s,this.iClipH=e}NoClip(){this.bClip=!1}_DrawImageEx(i,t,s,e,h,a,n,o,r,c,l,b,_,f){if(!(a>2048||n>2048)){f=f||!1;var u=this.FindImage(s);if(null!=u){-1==a&&(a=u.image.width),-1==n&&(n=u.image.height),this.bClip;var d=this.FindFreeSprite();if(this.bClip){var p=this.FindFreeSprite();p.graphics.clear(),p.pos(this.iClipX,this.iClipY),p.rotation=0,p.alpha=1,p.scale(1,1),p.scrollRect=new Laya.Rectangle(this.iClipX,this.iClipY,this.iClipW,this.iClipH),this.view_sprite.addChild(p),p.addChild(d),this.clip_sprites[this.iClipSpriteCount++]=p}else this.view_sprite.addChild(d);d.graphics.clear(),-1==b?b=i:-2==b?b=i+a/2:-3==b&&(b=i+a),-1==_?_=t:-2==_?_=t+n/2:-3==_&&(_=t+n);var m=u.GetBlock(e,h,a,n);d.graphics.drawImage(m,i-b,t-_,a,n),d.pos(b,_),d.alpha=o/100,d.rotation=l,d.scale(f?-r:r,c)}}}c_to_c(i){for(var t=i.toString(16);t.length<6;)t="0"+t;return"#"+t}TextWidth(i,t){return this.txt_w.text=i,this.txt_w.fontSize=t,this.iTextHeight=this.txt_w.textHeight,this.txt_w.textWidth}_DrawTextEx(i,t,s,e,h,a,n,o,r,c,l){if(null!=s&&!(t>Laya.stage.height)){var b,_,f,u=this.tb.Find(s,e,h,a,n,o,r,c,l);if(null==u){if(null==(u=this.tb.Get(s,e,h,a,n,o,r,c,l)))return;(b=u.txt).text=s,b.color=this.c_to_c(e),b.fontSize=h,b.width=b.textWidth,b.height=b.textHeight,this.iTextWidth>0?(b.wordWrap=!0,b.width=this.iTextWidth):b.wordWrap=!1,b.alpha=a/100,b.rotation=r,b.scale(n,o),u.x=-1,u.y=-1}else b=u.txt;if(this.drawrect[0]=i,this.drawrect[1]=t,this.drawrect[2]=i+b.textWidth,this.drawrect[3]=t+b.textHeight,u.x!=i||u.y!=t)_=0==c||-1==c?0:-2==c?b.textWidth/2:-3==c?b.textWidth:c-i,f=0==l||-1==l?0:-2==l?b.textHeight/2:-3==l?b.textHeight:l-t,b.pivot(_,f),b.x=i,b.y=t,u.x=i,u.y=t;if(this.bClip){var d=this.FindFreeSprite();d.graphics.clear(),d.pos(this.iClipX,this.iClipY),d.rotation=0,d.alpha=1,d.scale(1,1),d.scrollRect=new Laya.Rectangle(this.iClipX,this.iClipY,this.iClipW,this.iClipH),this.view_sprite.addChild(d),d.addChild(b),this.clip_sprites[this.iClipSpriteCount++]=d}else this.view_sprite.addChild(b);return b.textWidth}}DrawTextEx22(i,t,s,e,h,a,n,o,r,c,l){if(null!=s&&!(i>640||t>Laya.stage.height)){var b,_,f=this.FindFreeText();if(this.bClip){var u=this.FindFreeSprite();u.graphics.clear(),u.pos(this.iClipX,this.iClipY),u.rotation=0,u.alpha=1,u.scale(1,1),u.scrollRect=new Laya.Rectangle(this.iClipX,this.iClipY,this.iClipW,this.iClipH),this.view_sprite.addChild(u),u.addChild(f),this.clip_sprites[this.iClipSpriteCount++]=u}else this.view_sprite.addChild(f);f.text=s,f.color=this.c_to_c(e),f.fontSize=h,f.width=f.textWidth,f.height=f.textHeight,this.iTextWidth>0?(f.wordWrap=!0,f.width=this.iTextWidth):f.wordWrap=!1,b=-1==c?0:-2==c?f.textWidth/2:-3==c?f.textWidth:c-i,_=-1==l?0:-2==l?f.textHeight/2:-3==l?f.textHeight:l-t,f.pivot(b,_),f.alpha=a/100,f.rotation=r,f.scale(n,o),f.x=i,f.y=t}}DrawCircle(i,t,s,e,h){null==h&&(h=1);var a=this.FindFreeSprite();this.view_sprite.addChild(a),a.graphics.clear(),a.graphics.drawCircle(i,t,s,null,this.c_to_c(e),h),a.pivot(0,0),a.rotation=0,a.alpha=100,a.scale(1,1),a.pos(0,0)}FillCircle(i,t,s,e,h){if(!(i-s>640||t-s>Laya.stage.height||i+s<0||t+s<0)){if(this.bClip){if(i-s>this.iClipX+this.iClipW)return;if(t-s>this.iClipY+this.iClipH)return;if(i+s<this.iClipX)return;if(t+s<this.iClipY)return}null==h&&(h=1);var a=this.FindFreeSprite();this.view_sprite.addChild(a),a.graphics.clear(),a.graphics.drawCircle(i,t,s,this.c_to_c(e),null,h),a.pivot(0,0),a.rotation=0,a.alpha=100,a.scale(1,1),a.pos(0,0)}}DrawRect(i,t,s,e,h,a){null==a&&(a=1);var n=this.FindFreeSprite();if(this.bClip){var o=this.FindFreeSprite();o.graphics.clear(),o.pos(this.iClipX,this.iClipY),o.rotation=0,o.alpha=1,o.scale(1,1),o.scrollRect=new Laya.Rectangle(this.iClipX,this.iClipY,this.iClipW,this.iClipH),this.view_sprite.addChild(o),o.addChild(n),this.clip_sprites[this.iClipSpriteCount++]=o}else this.view_sprite.addChild(n);n.graphics.clear(),n.graphics.drawRect(i,t,s,e,null,this.c_to_c(h),a),n.pivot(0,0),n.rotation=0,n.alpha=100,n.scale(1,1),n.pos(0,0)}FillRect(i,t,s,e,h,a,n){if(!(s<=0||e<=0)){null==a&&(a=1),null==n&&(n=100);var o=this.FindFreeSprite();if(this.bClip){var r=this.FindFreeSprite();r.graphics.clear(),r.pos(this.iClipX,this.iClipY),r.rotation=0,r.alpha=1,r.scale(1,1),r.scrollRect=new Laya.Rectangle(this.iClipX,this.iClipY,this.iClipW,this.iClipH),this.view_sprite.addChild(r),r.addChild(o),this.clip_sprites[this.iClipSpriteCount++]=r}else this.view_sprite.addChild(o);o.graphics.clear(),o.graphics.drawRect(i,t,s,e,this.c_to_c(h),this.c_to_c(h),a),o.pivot(0,0),o.rotation=0,o.alpha=n/100,o.scale(1,1),o.pos(0,0)}}DrawLine(i,t,s,e,h,a){null==a&&(a=1);var n=this.FindFreeSprite();this.view_sprite.addChild(n),n.graphics.clear(),n.graphics.drawLine(i,t,s,e,h,a),n.pivot(0,0),n.rotation=0,n.alpha=1,n.scale(1,1),n.pos(0,0)}}r.pm2f=null,r.xm3f=null,r.gi=function(){return null==r.pm2f&&(r.pm2f=new r,r.xm3f=r.pm2f),r.pm2f},r.MAXIMAGECOUNT=2500;class c extends r{constructor(){super()}LoadFromFile(i,t,s,e){return this.LoadImage("res/"+i,s,e)}DrawImageEx(i,t,s,e,h,a,n,o,r,c,l,b,_,f){this._DrawImageEx(t,s,e,h,a,n,o,r,c,l,b,_,f)}SetViewClip(i,t,s,e){this._SetViewClip(i,t,s-i,e-t)}FillRect_2D(i,t,s,e,h){var a=(4278190080&h)>>24;a<0&&(a+=256),this.FillRect(i,t,s-i,e-t,16777215&h,1,a/2.55)}DrawTextEx(i,t,s,e,h,a,n,o,r,c,l){this._DrawTextEx(i,t,s,16777215&e,h,a,n,o,r,c,l)}DrawText(i,t,s,e){this.DrawTextEx(i,t,s,e,30,101,1,1,0,0,0)}DrawText_2(i,t,s,e,h,a,n,o,r,c,l,b,_){this.DrawTextEx(i,t,s,e,h,a,n,o,r,c,l)}DrawRect_2D(i,t,s,e,h){this.DrawRect(i,t,s-i,e-t,16777215&h,1)}GetTextWidth(i,t){return this.TextWidth(i,t)}GetTextHeight(){return this.iTextHeight}CheckImageLoaded(){for(var i=0,t=0,s=0;s<r.MAXIMAGECOUNT;s++)this.m_ImageList[s].bUseing&&(i++,this.m_ImageList[s].bLoaded&&t++);i!=t&&this.DrawTextEx22(Laya.stage.width/2,Laya.stage.height,i+"/"+t,4294967295,30,101,1,1,0,-2,-3)}}c.pm3f=null,c.gi=function(){return null==c.pm3f&&(c.pm3f=new c),c.pm3f};class l{constructor(i){this.iAnimaPoint=-1,this.iDelay=-1,this.iFrame=-1,this.pani=null,this.iRect=[0,0,0,0],null!=i&&this.copyfrom(i)}copyfrom(i){this.iAnimaPoint=i.iAnimaPoint,this.iDelay=i.iDelay,this.iFrame=i.iFrame,this.pani=i.pani,this.iRect[0]=i.iRect[0],this.iRect[1]=i.iRect[1],this.iRect[2]=i.iRect[2],this.iRect[3]=i.iRect[3]}Reset(){this.iFrame=0,this.iDelay=0}Draw(i,t,s){null==s&&(s=this.iFrame),this.pani.DrawAnimaEx_ByOffset(i,t,this.iAnimaPoint,s,101,1,1,0,0,0)}DrawEx1(i,t,s,e,h,a,n,o,r,c){this.pani.DrawAnimaEx_ByOffset(i,t,this.iAnimaPoint,s,e,h,a,n,o,r,c)}DrawEx(i,t,s,e,h,a,n,o,r,c){101!=e?this.pani.DrawAnimaEx_ByOffset(i,t,this.iAnimaPoint,this.iFrame,s,e,h,a,n,o,r):this.DrawEx1(i,t,s,e,h,a,n,o,r,c)}NextFrame(){return null!=this.pani&&this.pani.NextFrame(this)}bIn(i,t,s,e){return null!=this.pani&&this.pani.bInAnima(this,i,t,s,e)}SetFrame(i){null!=this.pani&&this.pani.SetFrame(this,i)}}class b{constructor(i){this.pani=i,this.iPos=0,this.bInited=!1,this.bLock=!1}InitAdjust(i){this.pani.InitAnimaWithName(i,gn.aaa),this.aa_line=new l,this.aa_btn=new l,gn.aaa.iFrame=0,this.aa_line.copyfrom(gn.aaa),gn.aaa.iFrame=1,this.aa_btn.copyfrom(gn.aaa),this.bInited=!0}SetPos(i,t,s){this.iMin=i,this.iMax=t,this.iPos=s}Move(i,t,s,e){this.iX=i,this.iY=t,this.iW=s,this.iH=e}Draw(){var i=this.iH,t=this.iX-i/2+(this.iPos-this.iMin)*this.iW/(this.iMax-this.iMin);this.bInited?(i=48,t=this.iX-i/2+(this.iPos-this.iMin)*this.iW/(this.iMax-this.iMin),this.aa_line.DrawEx(this.iX,this.iY+this.iH/2,101,1*this.iW/387,1,0,0,0),this.aa_btn.Draw(t,this.iY+this.iH/2)):(i=this.iH,t=iX-i/2+(this.iPos-this.iMin)*this.iW/(this.iMax-this.iMin),c.gi().DrawLine(this.iX,this.iY+this.iH/2,this.iX+this.iW,this.iY+this.iH/2,4294967295),c.gi().FillRect_2D(t,this.iY,t+i,this.iY+i,4294967295),c.gi().DrawTextEx((this.iX-40+t)/2,this.iY+i/2,""+this.iPos,4278255360,20,101,1,1,0,-2,-2))}ProcTouch(i,t,s){return 3==i&&this.bLock?(this.bLock=!1,!0):bn.bInRect(t,s,this.iX-this.iH/2,this.iY,this.iW+this.iH,this.iH)&&1==i?(this.iPos=(t-this.iX)*(this.iMax-this.iMin)/this.iW+this.iMin,this.iPos<this.iMin&&(this.iPos=this.iMin),this.iPos>this.iMax&&(this.iPos=this.iMax),this.bLock=!0,!0):!(!this.bLock||2!=i)&&(this.iPos=(t-this.iX)*(this.iMax-this.iMin)/this.iW+this.iMin,this.iPos<this.iMin&&(this.iPos=this.iMin),this.iPos>this.iMax&&(this.iPos=this.iMax),!0)}}class _{constructor(){this.ani_list=new Array,this.bLoadFinished=!1}PushAnima(i){this.ani_list[this.ani_list.length]=i}LoadInitRes(){_.iLoadingCount=0,_.iLoadedResCount=0;for(var i=0;i<this.ani_list.length;i++)_.iLoadedResCount+=this.ani_list[i].LoadInitRes(_._init_res);_.iLoadedResCount>=_.iMaxResCount&&bn.sop("=========load init finished=========")}LoadOtherRes(){if(!this.bLoadFinished){_.iLoadingCount=0,this.bLoadFinished=!0;for(var i=0;i<this.ani_list.length;i++)this.ani_list[i].IsResLoadedFinish()||(this.ani_list[i].LoadRes(),this.bLoadFinished=!1);this.bLoadFinished&&bn.sop("=========load other finished=========")}}}_.iMaxLoadThread=4096,_.iLoadingCount=0,_.pp=null,_.gi=function(){return null==_.pp&&(_.pp=new _),_.pp},_._init_res=[],_.iMaxResCount=_._init_res.length,_.iLoadedResCount=0;class f{constructor(){}}f.U2Ghash={},f.G2Uhash={},f.zipData="4e:020405060f12171f20212326292e2f313335373c40414244464a5155575a5b6263646567686a6b6c6d6e6f727475767778797a7b7c7d7f808182838485878a#909697999c9d9ea3aaafb0b1b4b6b7b8b9bcbdbec8cccfd0d2dadbdce0e2e6e7e9edeeeff1f4f8f9fafcfe,4f:00020304050607080b0c12131415161c1d212328292c2d2e31333537393b3e3f40414244454748494a4b4c525456616266686a6b6d6e7172757778797a7d8081828586878a8c8e909293959698999a9c9e9fa1a2a4abadb0b1b2b3b4b6b7b8b9babbbcbdbec0c1c2c6c7c8c9cbcccdd2d3d4d5d6d9dbe0e2e4e5e7ebecf0f2f4f5f6f7f9fbfcfdff,50:000102030405060708090a#0b0e1011131516171b1d1e20222324272b2f303132333435363738393b3d3f404142444546494a4b4d5051525354565758595b5d5e5f6061626364666768696a6b6d6e6f70717273747578797a7c7d818283848687898a8b8c8e8f909192939495969798999a9b9c9d9e9fa0a1a2a4a6aaabadaeafb0b1b3b4b5b6b7b8b9bcbdbebfc0c1c2c3c4c5c6c7c8c9cacbcccdced0d1d2d3d4d5d7d8d9dbdcdddedfe0e1e2e3e4e5e8e9eaebeff0f1f2f4f6f7f8f9fafcfdfeff,51:00010203040508#090a0c0d0e0f1011131415161718191a1b1c1d1e1f2022232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e42474a4c4e4f5052535758595b5d5e5f606163646667696a6f727a7e7f838486878a8b8e8f90919394989a9d9e9fa1a3a6a7a8a9aaadaeb4b8b9babebfc1c2c3c5c8cacdced0d2d3d4d5d6d7d8d9dadcdedfe2e3e5e6e7e8e9eaeceef1f2f4f7fe,52:0405090b0c0f101314151c1e1f2122232526272a2c2f313234353c3e4445464748494b4e4f5253555758#595a5b5d5f6062636466686b6c6d6e7071737475767778797a7b7c7e808384858687898a8b8c8d8e8f91929495969798999a9ca4a5a6a7aeafb0b4b5b6b7b8b9babbbcbdc0c1c2c4c5c6c8cacccdcecfd1d3d4d5d7d9dadbdcdddee0e1e2e3e5e6e7e8e9eaebecedeeeff1f2f3f4f5f6f7f8fbfcfd,53:0102030407090a0b0c0e11121314181b1c1e1f2224252728292b2c2d2f3031323334353637383c3d404244464b4c4d505458595b5d65686a6c6d7276797b7c7d7e80818387888a8e8f#90919293949697999b9c9ea0a1a4a7aaabacadafb0b1b2b3b4b5b7b8b9babcbdbec0c3c4c5c6c7cecfd0d2d3d5dadcdddee1e2e7f4fafeff,54:000205070b1418191a1c2224252a303336373a3d3f4142444547494c4d4e4f515a5d5e5f6061636567696a6b6c6d6e6f7074797a7e7f8183858788898a8d919397989c9e9fa0a1a2a5aeb0b2b5b6b7b9babcbec3c5cacbd6d8dbe0e1e2e3e4ebeceff0f1f4f5f6f7f8f9fbfe,55:0002030405080a0b0c0d0e121315161718191a1c1d1e1f212526#28292b2d3234353638393a3b3d40424547484b4c4d4e4f515253545758595a5b5d5e5f60626368696b6f7071727374797a7d7f85868c8d8e9092939596979a9b9ea0a1a2a3a4a5a6a8a9aaabacadaeafb0b2b4b6b8babcbfc0c1c2c3c6c7c8cacbcecfd0d5d7d8d9dadbdee0e2e7e9edeef0f1f4f6f8f9fafbfcff,56:0203040506070a0b0d1011121314151617191a1c1d202122252628292a2b2e2f30333537383a3c3d3e404142434445464748494a4b4f5051525355565a5b5d5e5f6061#636566676d6e6f70727374757778797a7d7e7f80818283848788898a8b8c8d9091929495969798999a9b9c9d9e9fa0a1a2a4a5a6a7a8a9aaabacadaeb0b1b2b3b4b5b6b8b9babbbdbebfc0c1c2c3c4c5c6c7c8c9cbcccdcecfd0d1d2d3d5d6d8d9dce3e5e6e7e8e9eaeceeeff2f3f6f7f8fbfc,57:00010205070b0c0d0e0f101112131415161718191a1b1d1e202122242526272b313234353637383c3d3f414344454648494b52535455565859626365676c6e707172747578797a7d7e7f80#818788898a8d8e8f90919495969798999a9c9d9e9fa5a8aaacafb0b1b3b5b6b7b9babbbcbdbebfc0c1c4c5c6c7c8c9cacccdd0d1d3d6d7dbdcdee1e2e3e5e6e7e8e9eaebeceef0f1f2f3f5f6f7fbfcfeff,58:0103040508090a0c0e0f101213141617181a1b1c1d1f222325262728292b2c2d2e2f31323334363738393a3b3c3d3e3f4041424345464748494a4b4e4f505253555657595a5b5c5d5f6061626364666768696a6d6e6f707172737475767778797a7b7c7d7f82848687888a8b8c#8d8e8f909194959697989b9c9da0a1a2a3a4a5a6a7aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbdbebfc0c2c3c4c6c7c8c9cacbcccdcecfd0d2d3d4d6d7d8d9dadbdcdddedfe0e1e2e3e5e6e7e8e9eaedeff1f2f4f5f7f8fafbfcfdfeff,59:000103050608090a0b0c0e1011121317181b1d1e2021222326282c30323335363b3d3e3f404345464a4c4d505253595b5c5d5e5f616364666768696a6b6c6d6e6f70717275777a7b7c7e7f8085898b8c8e8f90919495989a9b9c9d9fa0a1a2a6#a7acadb0b1b3b4b5b6b7b8babcbdbfc0c1c2c3c4c5c7c8c9cccdcecfd5d6d9dbdedfe0e1e2e4e6e7e9eaebedeeeff0f1f2f3f4f5f6f7f8fafcfdfe,5a:00020a0b0d0e0f101214151617191a1b1d1e2122242627282a2b2c2d2e2f3033353738393a3b3d3e3f414243444547484b4c4d4e4f5051525354565758595b5c5d5e5f60616364656668696b6c6d6e6f7071727378797b7c7d7e808182838485868788898a8b8c8d8e8f9091939495969798999c9d9e9fa0a1a2a3a4a5a6a7a8a9abac#adaeafb0b1b4b6b7b9babbbcbdbfc0c3c4c5c6c7c8cacbcdcecfd0d1d3d5d7d9dadbdddedfe2e4e5e7e8eaecedeeeff0f2f3f4f5f6f7f8f9fafbfcfdfeff,5b:0001020304050607080a0b0c0d0e0f10111213141518191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f303133353638393a3b3c3d3e3f4142434445464748494a4b4c4d4e4f52565e606167686b6d6e6f7274767778797b7c7e7f82868a8d8e90919294969fa7a8a9acadaeafb1b2b7babbbcc0c1c3c8c9cacbcdcecf#d1d4d5d6d7d8d9dadbdce0e2e3e6e7e9eaebecedeff1f2f3f4f5f6f7fdfe,5c:0002030507080b0c0d0e10121317191b1e1f2021232628292a2b2d2e2f303233353637434446474c4d5253545657585a5b5c5d5f62646768696a6b6c6d70727374757677787b7c7d7e808384858687898a8b8e8f9293959d9e9fa0a1a4a5a6a7a8aaaeafb0b2b4b6b9babbbcbec0c2c3c5c6c7c8c9cacccdcecfd0d1d3d4d5d6d7d8dadbdcdddedfe0e2e3e7e9ebeceeeff1f2f3f4f5f6f7f8f9fafcfdfeff,5d:00#01040508090a0b0c0d0f10111213151718191a1c1d1f2021222325282a2b2c2f3031323335363738393a3b3c3f4041424344454648494d4e4f5051525354555657595a5c5e5f6061626364656667686a6d6e7071727375767778797a7b7c7d7e7f8081838485868788898a8b8c8d8e8f9091929394959697989a9b9c9e9fa0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b8b9babbbcbdbebfc0c1c2c3c4c6c7c8c9cacbcccecfd0d1d2d3d4d5d6d7d8d9dadcdfe0e3e4eaeced#f0f5f6f8f9fafbfcff,5e:000407090a0b0d0e1213171e1f20212223242528292a2b2c2f303233343536393a3e3f404143464748494a4b4d4e4f50515253565758595a5c5d5f60636465666768696a6b6c6d6e6f70717577797e8182838588898c8d8e92989b9da1a2a3a4a8a9aaabacaeafb0b1b2b4babbbcbdbfc0c1c2c3c4c5c6c7c8cbcccdcecfd0d4d5d7d8d9dadcdddedfe0e1e2e3e4e5e6e7e9ebecedeeeff0f1f2f3f5f8f9fbfcfd,5f:050607090c0d0e10121416191a1c1d1e21222324#282b2c2e30323334353637383b3d3e3f4142434445464748494a4b4c4d4e4f5154595a5b5c5e5f60636567686b6e6f72747576787a7d7e7f83868d8e8f919394969a9b9d9e9fa0a2a3a4a5a6a7a9abacafb0b1b2b3b4b6b8b9babbbebfc0c1c2c7c8cacbced3d4d5dadbdcdedfe2e3e5e6e8e9eceff0f2f3f4f6f7f9fafc,60:0708090b0c10111317181a1e1f2223242c2d2e3031323334363738393a3d3e404445464748494a4c4e4f5153545657585b5c5e5f606165666e71727475777e80#8182858687888a8b8e8f909193959798999c9ea1a2a4a5a7a9aaaeb0b3b5b6b7b9babdbebfc0c1c2c3c4c7c8c9cccdcecfd0d2d3d4d6d7d9dbdee1e2e3e4e5eaf1f2f5f7f8fbfcfdfeff,61:02030405070a0b0c1011121314161718191b1c1d1e21222528292a2c2d2e2f303132333435363738393a3b3c3d3e4041424344454647494b4d4f50525354565758595a5b5c5e5f606163646566696a6b6c6d6e6f717273747678797a7b7c7d7e7f808182838485868788898a8c8d8f9091929395#969798999a9b9c9e9fa0a1a2a3a4a5a6aaabadaeafb0b1b2b3b4b5b6b8b9babbbcbdbfc0c1c3c4c5c6c7c9cccdcecfd0d3d5d6d7d8d9dadbdcdddedfe0e1e2e3e4e5e7e8e9eaebecedeeeff0f1f2f3f4f6f7f8f9fafbfcfdfe,62:00010203040507091314191c1d1e2023262728292b2d2f303132353638393a3b3c424445464a4f50555657595a5c5d5e5f6061626465687172747577787a7b7d818283858687888b8c8d8e8f9094999c9d9ea3a6a7a9aaadaeafb0b2b3b4b6b7b8babec0c1#c3cbcfd1d5dddee0e1e4eaebf0f2f5f8f9fafb,63:00030405060a0b0c0d0f10121314151718191c2627292c2d2e30313334353637383b3c3e3f40414447484a51525354565758595a5b5c5d60646566686a6b6c6f707273747578797c7d7e7f81838485868b8d9193949597999a9b9c9d9e9fa1a4a6abafb1b2b5b6b9bbbdbfc0c1c2c3c5c7c8cacbccd1d3d4d5d7d8d9dadbdcdddfe2e4e5e6e7e8ebeceeeff0f1f3f5f7f9fafbfcfe,64:0304060708090a0d0e111215161718191a1d1f222324#252728292b2e2f3031323335363738393b3c3e404243494b4c4d4e4f505153555657595a5b5c5d5f60616263646566686a6b6c6e6f70717273747576777b7c7d7e7f8081838688898a8b8c8d8e8f90939497989a9b9c9d9fa0a1a2a3a5a6a7a8aaabafb1b2b3b4b6b9bbbdbebfc1c3c4c6c7c8c9cacbcccfd1d3d4d5d6d9dadbdcdddfe0e1e3e5e7e8e9eaebecedeeeff0f1f2f3f4f5f6f7f8f9fafbfcfdfeff,65:01020304050607080a0b0c0d0e0f10111314151617191a1b1c1d1e1f2021#222324262728292a2c2d30313233373a3c3d404142434446474a4b4d4e5052535457585a5c5f606164656768696a6d6e6f7173757678797a7b7c7d7e7f8081828384858688898a8d8e8f92949596989a9d9ea0a2a3a6a8aaacaeb1b2b3b4b5b6b7b8babbbebfc0c2c7c8c9cacdd0d1d3d4d5d8d9dadbdcdddedfe1e3e4eaebf2f3f4f5f8f9fbfcfdfeff,66:0104050708090b0d1011121617181a1b1c1e2122232426292a2b2c2e3032333738393a3b3d3f40424445464748494a4d4e505158#595b5c5d5e6062636567696a6b6c6d7172737578797b7c7d7f808183858688898a8b8d8e8f909293949598999a9b9c9e9fa0a1a2a3a4a5a6a9aaabacadafb0b1b2b3b5b6b7b8babbbcbdbfc0c1c2c3c4c5c6c7c8c9cacbcccdcecfd0d1d2d3d4d5d6d7d8dadedfe0e1e2e3e4e5e7e8eaebecedeeeff1f5f6f8fafbfd,67:010203040506070c0e0f1112131618191a1c1e20212223242527292e303233363738393b3c3e3f414445474a4b4d5254555758595a5b5d62636466676b6c6e717476#78797a7b7d8082838586888a8c8d8e8f9192939496999b9fa0a1a4a6a9acaeb1b2b4b9babbbcbdbebfc0c2c5c6c7c8c9cacbcccdced5d6d7dbdfe1e3e4e6e7e8eaebedeef2f5f6f7f8f9fafbfcfe,68:01020304060d1012141518191a1b1c1e1f20222324252627282b2c2d2e2f30313435363a3b3f474b4d4f52565758595a5b5c5d5e5f6a6c6d6e6f707172737578797a7b7c7d7e7f8082848788898a8b8c8d8e90919294959698999a9b9c9d9e9fa0a1a3a4a5a9aaabacaeb1b2b4b6b7b8#b9babbbcbdbebfc1c3c4c5c6c7c8cacccecfd0d1d3d4d6d7d9dbdcdddedfe1e2e4e5e6e7e8e9eaebecedeff2f3f4f6f7f8fbfdfeff,69:00020304060708090a0c0f11131415161718191a1b1c1d1e21222325262728292a2b2c2e2f313233353637383a3b3c3e4041434445464748494a4b4c4d4e4f50515253555658595b5c5f616264656768696a6c6d6f7072737475767a7b7d7e7f8183858a8b8c8e8f909192939697999a9d9e9fa0a1a2a3a4a5a6a9aaacaeafb0b2b3b5b6b8b9babcbd#bebfc0c2c3c4c5c6c7c8c9cbcdcfd1d2d3d5d6d7d8d9dadcdddee1e2e3e4e5e6e7e8e9eaebeceeeff0f1f3f4f5f6f7f8f9fafbfcfe,6a:000102030405060708090b0c0d0e0f10111213141516191a1b1c1d1e20222324252627292b2c2d2e30323334363738393a3b3c3f40414243454648494a4b4c4d4e4f515253545556575a5c5d5e5f60626364666768696a6b6c6d6e6f70727374757677787a7b7d7e7f81828385868788898a8b8c8d8f929394959698999a9b9c9d9e9fa1a2a3a4a5a6#a7a8aaadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebfc0c1c2c3c4c5c6c7c8c9cacbcccdcecfd0d1d2d3d4d5d6d7d8d9dadbdcdddedfe0e1e2e3e4e5e6e7e8e9eaebecedeeeff0f1f2f3f4f5f6f7f8f9fafbfcfdfeff,6b:000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f252628292a2b2c2d2e2f303133343536383b3c3d3f4041424445484a4b4d4e4f5051525354555657585a5b5c5d5e5f606168696b6c6d6e6f7071727374757677787a7d7e7f808588#8c8e8f909194959798999c9d9e9fa0a2a3a4a5a6a7a8a9abacadaeafb0b1b2b6b8b9babbbcbdbec0c3c4c6c7c8c9caccced0d1d8dadcdddedfe0e2e3e4e5e6e7e8e9ecedeef0f1f2f4f6f7f8fafbfcfeff,6c:000102030408090a0b0c0e12171c1d1e2023252b2c2d31333637393a3b3c3e3f434445484b4c4d4e4f5152535658595a62636566676b6c6d6e6f71737577787a7b7c7f8084878a8b8d8e9192959697989a9c9d9ea0a2a8acafb0b4b5b6b7bac0c1c2c3c6c7c8cbcdcecfd1d2d8#d9dadcdddfe4e6e7e9ecedf2f4f9ff,6d:000203050608090a0d0f101113141516181c1d1f20212223242628292c2d2f30343637383a3f404244494c50555657585b5d5f6162646567686b6c6d707172737576797a7b7d7e7f8081838486878a8b8d8f9092969798999a9ca2a5acadb0b1b3b4b6b7b9babbbcbdbec1c2c3c8c9cacdcecfd0d2d3d4d5d7dadbdcdfe2e3e5e7e8e9eaedeff0f2f4f5f6f8fafdfeff,6e:0001020304060708090b0f12131518191b1c1e1f222627282a2c2e30313335#3637393b3c3d3e3f40414245464748494a4b4c4f5051525557595a5c5d5e606162636465666768696a6c6d6f707172737475767778797a7b7c7d8081828487888a8b8c8d8e91929394959697999a9b9d9ea0a1a3a4a6a8a9abacadaeb0b3b5b8b9bcbebfc0c3c4c5c6c8c9cacccdced0d2d6d8d9dbdcdde3e7eaebecedeeeff0f1f2f3f5f6f7f8fafbfcfdfeff,6f:000103040507080a0b0c0d0e101112161718191a1b1c1d1e1f212223252627282c2e303234353738393a3b3c3d3f404142#43444548494a4c4e4f5051525354555657595a5b5d5f60616364656768696a6b6c6f707173757677797b7d7e7f808182838586878a8b8f909192939495969798999a9b9d9e9fa0a2a3a4a5a6a8a9aaabacadaeafb0b1b2b4b5b7b8babbbcbdbebfc1c3c4c5c6c7c8cacbcccdcecfd0d3d4d5d6d7d8d9dadbdcdddfe2e3e4e5e6e7e8e9eaebecedf0f1f2f3f4f5f6f7f8f9fafbfcfdfeff,70:000102030405060708090a0b0c0d0e0f1012131415161718191c1d1e1f2021222425262728292a#2b2c2d2e2f30313233343637383a3b3c3d3e3f404142434445464748494a4b4d4e505152535455565758595a5b5c5d5f606162636465666768696a6e7172737477797a7b7d818283848687888b8c8d8f90919397989a9b9e9fa0a1a2a3a4a5a6a7a8a9aab0b2b4b5b6babebfc4c5c6c7c9cbcccdcecfd0d1d2d3d4d5d6d7dadcdddee0e1e2e3e5eaeef0f1f2f3f4f5f6f8fafbfcfeff,71:0001020304050607080b0c0d0e0f111214171b1c1d1e1f2021222324252728292a2b2c2d2e323334#353738393a3b3c3d3e3f4041424344464748494b4d4f505152535455565758595a5b5d5f6061626365696a6b6c6d6f707174757677797b7c7e7f8081828385868788898b8c8d8e909192939596979a9b9c9d9ea1a2a3a4a5a6a7a9aaabadaeafb0b1b2b4b6b7b8babbbcbdbebfc0c1c2c4c5c6c7c8c9cacbcccdcfd0d1d2d3d6d7d8d9dadbdcdddedfe1e2e3e4e6e8e9eaebecedeff0f1f2f3f4f5f6f7f8fafbfcfdfeff,72:0001020304050708090a0b0c0d0e0f101112131415161718191a#1b1c1e1f2021222324252627292b2d2e2f3233343a3c3e40414243444546494a4b4e4f505153545557585a5c5e60636465686a6b6c6d707173747677787b7c7d828385868788898c8e9091939495969798999a9b9c9d9ea0a1a2a3a4a5a6a7a8a9aaabaeb1b2b3b5babbbcbdbebfc0c5c6c7c9cacbcccfd1d3d4d5d6d8dadb#95$,30:000102,00b702:c9c7,00a830:0305,2014ff5e20:162618191c1d,30:141508090a0b0c0d0e0f16171011,00:b1d7f7,22:362728110f2a2908371aa52520,231222:992b2e614c483d1d606e6f64651e3534,26:4240,00b020:3233,2103ff0400a4ff:e0e1,203000a7211626:0605,25:cbcfcec7c6a1a0b3b2,203b21:92909193,30:13#95$,21:70717273747576777879#4$,24:88898a8b8c8d8e8f909192939495969798999a9b7475767778797a7b7c7d7e7f808182838485868760616263646566676869##,32:20212223242526272829##,21:606162636465666768696a6b#97$,ff:010203e505060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f404142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5de3#95$,30:4142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f707172737475767778797a7b7c7d7e7f808182838485868788898a8b8c8d8e8f90919293#106$a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebfc0c1c2c3c4c5c6c7c8c9cacbcccdcecfd0d1d2d3d4d5d6d7d8d9dadbdcdddedfe0e1e2e3e4e5e6e7e8e9eaebecedeeeff0f1f2f3f4f5f6#103$,03:9192939495969798999a9b9c9d9e9fa0a1a3a4a5a6a7a8a9#6$b1b2b3b4b5b6b7b8b9babbbcbdbebfc0c1c3c4c5c6c7c8c9#5$,fe:3536393a3f403d3e41424344##3b3c373831#3334#104$,04:10111213141501161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f#13$30313233343551363738393a3b3c3d3e3f404142434445464748494a4b4c4d4e4f#11$,02:cacbd9,20:13152535,21:050996979899,22:151f23526667bf,25:505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f7071727381828384858687#88898a8b8c8d8e8f939495bcbde2e3e4e5,2609229530:121d1e#9$,010100e101ce00e0011300e9011b00e8012b00ed01d000ec014d00f301d200f2016b00fa01d400f901:d6d8dadc,00:fcea,0251e7c701:4448,e7c802:61#2$,31:05060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20212223242526272829#19$,30:212223242526272829,32a333:8e8f9c9d9ea1c4ced1d2d5,fe30ff:e2e4#,212132:31#,20:10#1$,30:fc9b9cfdfe069d9e,fe:494a4b4c4d4e4f50515254555657595a5b5c5d5e5f6061#626364656668696a6b,e7:e7e8e9eaebecedeeeff0f1f2f3,30:07#11$,25:000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f404142434445464748494a4b#13$,72:dcdddfe2e3e4e5e6e7eaebf5f6f9fdfeff,73:00020405060708090b0c0d0f1011121418191a1f2023242627282d2f30323335363a3b3c3d404142434445464748#494a4b4c4e4f515354555658595a5b5c5d5e5f6162636465666768696a6b6e7071#92$72737475767778797a7b7c7d7f808182838586888a8c8d8f90929394959798999a9c9d9ea0a1a3a4a5a6a7a8aaacadb1b4b5b6b8b9bcbdbebfc1c3c4c5c6c7#cbccced2d3d4d5d6d7d8dadbdcdddfe1e2e3e4e6e8eaebeceeeff0f1f3f4f5f6f7#92$f8f9fafbfcfdfeff,74:0001020407080b0c0d0e1112131415161718191c1d1e1f2021232427292b2d2f31323738393a3b3d3e3f4042434445464748494a4b4c4d#4e4f505152535456585d606162636465666768696a6b6c6e6f717273747578797a#92$7b7c7d7f8284858688898a8c8d8f9192939495969798999a9b9d9fa0a1a2a3a4a5a6aaabacadaeafb0b1b2b3b4b5b6b7b8b9bbbcbdbebfc0c1c2c3c4c5c6c7#c8c9cacbcccdcecfd0d1d3d4d5d6d7d8d9dadbdddfe1e5e7e8e9eaebecedf0f1f2#92$f3f5f8f9fafbfcfdfe,75:0001020305060708090a0b0c0e1012141516171b1d1e202122232426272a2e3436393c3d3f414243444647494a4d5051525355565758#5d5e5f60616263646768696b6c6d6e6f7071737576777a7b7c7d7e808182848587#92$88898a8c8d8e909395989b9c9ea2a6a7a8a9aaadb6b7babbbfc0c1c6cbcccecfd0d1d3d7d9dadcdddfe0e1e5e9ecedeeeff2f3f5f6f7f8fafbfdfe,76:02040607#08090b0d0e0f11121314161a1c1d1e212327282c2e2f31323637393a3b3d414244#92$45464748494a4b4e4f50515253555758595a5b5d5f6061626465666768696a6c6d6e7071727374757677797a7c7f80818385898a8c8d8f9092949597989a9b#9c9d9e9fa0a1a2a3a5a6a7a8a9aaabacadafb0b3b5b6b7b8b9babbbcbdbec0c1c3,554a963f57c3632854ce550954c076:914c,853c77ee827e788d72319698978d6c285b894ffa630966975cb880fa684880ae660276ce51f9655671ac7ff1888450b2596561ca6fb382ad634c625253ed54277b06516b75a45df462d48dcb9776628a8019575d97387f627238767d67cf767e64464f708d2562dc7a17659173ed642c6273822c9881677f724862:6ecc,4f3474e3534a529e7eca90a65e2e6886699c81807ed168d278c5868c9551508d8c2482de80de53058912526576:c4c7c9cbccd3d5d9dadcdddee0e1e2e3e4e6e7e8e9eaebecedf0f3f5f6f7fafbfdff,77:00020305060a0c0e0f1011121314151617181b1c1d1e21232425272a2b#2c2e3031323334393b3d3e3f4244454648494a4b4c4d4e4f52535455565758595c,858496f94fdd582199715b9d62:b1a5,66b48c799c8d7206676f789160b253:5117,8f8880cc8d1d94a1500d72c8590760eb711988ab595482ef672c7b285d297ef7752d6cf58e668ff8903c9f3b6bd491197b145f7c78a784d6853d6b:d5d9d6,5e:0187,75f995ed655d5f:0ac5,8f9f58c181c2907f965b97ad8fb97f168d2c62414fbf53:d85e,8f:a8a9ab,904d68075f6a819888689cd6618b522b762a5f6c658c6fd26ee85bbe644851:75b0,67c44e1979c9997c70b377:5d5e5f606467696a6d6e6f7071727374757677787a7b7c818283868788898a8b8f90939495969798999a9b9c9d9ea1a3a4a6a8abadaeafb1b2b4b6b7b8b9ba#bcbec0c1c2c3c4c5c6c7c8c9cacbcccecfd0d1d2d3d4d5d6d8d9dadddedfe0e1e4,75c55e7673bb83e064ad62e894b56ce2535a52c3640f94c27b944f2f5e1b823681:168a,6e246cca9a736355535c54fa886557e04e0d5e036b657c3f90e8601664e6731c88c16750624d8d22776c8e2991c75f6983dc8521991053c286956b8b60:ede8,707f82:cd31,4ed36ca785cf64cd7cd969fd66f9834953957b564fa7518c6d4b5c428e6d63d253c983:2c36,67e578b4643d5bdf5c945dee8be762c667f48c7a640063ba8749998b8c177f2094f24ea7961098a4660c731677:e6e8eaeff0f1f2f4f5f7f9fafbfc,78:0304050607080a0b0e0f101315191b1e20212224282a2b2e2f31323335363d3f414243444648494a4b4d4f51535458595a#5b5c5e5f606162636465666768696f7071727374757678797a7b7d7e7f80818283,573a5c1d5e38957f507f80a05382655e7545553150218d856284949e671d56326f6e5de2543570928f66626f64a463a35f7b6f8890f481e38fb05c1866685ff16c8996488d81886c649179f057ce6a59621054484e587a0b60e96f848bda627f901e9a8b79e4540375f4630153196c608fdf5f1b9a70803b9f7f4f885c3a8d647fc565a570bd51:45b2,866b5d075ba062bd916c75748e0c7a2061017b794ec77ef877854e1181ed521d51fa6a7153a88e87950496cf6ec19664695a78:848586888a8b8f9092949596999d9ea0a2a4a6a8a9aaabacadaeafb5b6b7b8babbbcbdbfc0c2c3c4c6c7c8cccdcecfd1d2d3d6d7d8dadbdcdddedfe0e1e2e3#e4e5e6e7e9eaebedeeeff0f1f3f5f6f8f9fbfcfdfeff,79:00020304060708090a0b0c,784050a877d7641089e6590463e35ddd7a7f693d4f20823955984e3275ae7a975e:628a,95ef521b5439708a6376952457826625693f918755076df37eaf882262337ef075b5832878c196cc8f9e614874f78bcd6b64523a8d506b21806a847156f153064e:ce1b,51d17c97918b7c074fc38e7f7be17a9c64675d1450ac810676017cb96dec7fe067515b:58f8,78cb64:ae13,63:aa2b,9519642d8fbe7b5476296253592754466b7950a362345e266b864ee38d37888b5f85902e79:0d0e0f1011121415161718191a1b1c1d1f2021222325262728292a2b2c2d2e2f3031323335363738393d3f42434445474a4b4c4d4e4f505152545558596163#6466696a6b6c6e70717273747576797b7c7d7e7f8283868788898b8c8d8e909192,6020803d62c54e39535590f863b880c665e66c2e4f4660ee6de18bde5f3986cb5f536321515a83616863520063638e4850125c9b79775bfc52307a3b60bc905376d75f:b797,76848e6c706f767b7b4977aa51f3909358244f4e6ef48fea654c7b1b72c46da47fdf5ae162b55e95573084827b2c5e1d5f1f90127f1498a063826ec7789870b95178975b57ab75354f4375385e9760e659606dc06bbf788953fc96d551cb52016389540a94938c038dcc7239789f87768fed8c0d53e079:939495969798999b9c9d9e9fa0a1a2a3a4a5a6a8a9aaabacadaeafb0b1b2b4b5b6b7b8bcbfc2c4c5c7c8cacccecfd0d3d4d6d7d9dadbdcdddee0e1e2e5e8ea#eceef1f2f3f4f5f6f7f9fafcfeff,7a:0104050708090a0c0f10111213151618191b1c,4e0176ef53ee948998769f0e952d5b9a8ba24e:221c,51ac846361c252a8680b4f97606b51bb6d1e515c6296659796618c46901775d890fd77636bd272:8aec,8bfb583577798d4c675c9540809a5ea66e2159927aef77ed953b6bb565ad7f0e58065151961f5bf958a954288e726566987f56e4949d76fe9041638754c659:1a3a,579b8eb267358dfa8235524160f0581586fe5ce89e454fc4989d8bb95a2560765384627c904f9102997f6069800c513f80335c1499756d314e8c7a:1d1f21222425262728292a2b2c2d2e2f303132343536383a3e4041424344454748494a4b4c4d4e4f50525354555658595a5b5c5d5e5f606162636465666768#696a6b6c6d6e6f717273757b7c7d7e828587898a8b8c8e8f909394999a9b9ea1a2,8d3053d17f5a7b4f4f104e4f96006cd573d085e95e06756a7ffb6a0a77fe94927e4151e170e653cd8fd483038d2972af996d6cdb574a82b365b980aa623f963259a84eff8bbf7eba653e83f2975e556198de80a5532a8bfd542080ba5e9f6cb88d3982ac915a54296c1b52067eb7575f711a6c7e7c89594b4efd5fff61247caa4e305c0167ab87025cf0950b98ce75af70fd902251af7f1d8bbd594951e44f5b5426592b657780a45b7562:76c2,8f905e456c1f7b264f:0fd8,670d7a:a3a4a7a9aaabaeafb0b1b2b4b5b6b7b8b9babbbcbdbec0c1c2c3c4c5c6c7c8c9cacccdcecfd0d1d2d3d4d5d7d8dadbdcdde1e2e4e7e8e9eaebeceef0f1f2f3#f4f5f6f7f8fbfcfe,7b:0001020507090c0d0e1012131617181a1c1d1f21222327292d,6d:6eaa,798f88b15f17752b629a8f854fef91dc65a781:2f51,5e9c81508d74526f89868d4b590d50854ed8961c723681798d1f5bcc8ba3964459877f1a549056:760e,8be565396982949976d66e895e72751867:46d1,7aff809d8d76611f79c665628d635188521a94a27f38809b7eb25c976e2f67607bd9768b9ad8818f7f947cd5641e95507a3f54:4ae5,6b4c640162089e3d80f3759952729769845b683c86e496:0194,94ec4e2a54047ed968398ddf801566f45e9a7fb97b:2f303234353637393b3d3f404142434446484a4d4e535557595c5e5f61636465666768696a6b6c6d6f70737476787a7c7d7f81828384868788898a8b8c8e8f#9192939698999a9b9e9fa0a3a4a5aeafb0b2b3b5b6b7b9babbbcbdbebfc0c2c3c4,57c2803f68975de5653b529f606d9f9a4f9b8eac516c5bab5f135de96c5e62f18d21517194a952fe6c9f82df72d757a267848d2d591f8f9c83c754957b8d4f306cbd5b6459d19f1353e486ca9aa88c3780a16545987e56fa96c7522e74dc52505be1630289024e5662d0602a68fa51735b9851a089c27ba199867f5060ef704c8d2f51495e7f901b747089c4572d78455f529f9f95fa8f689b3c8be17678684267dc8d:ea35,523d8f8a6eda68cd950590ed56fd679c88f98fc754c87b:c5c8c9cacbcdcecfd0d2d4d5d6d7d8dbdcdedfe0e2e3e4e7e8e9ebecedeff0f2f3f4f5f6f8f9fafbfdff,7c:0001020304050608090a0d0e101112131415171819#1a1b1c1d1e20212223242528292b2c2d2e2f3031323334353637393a3b3c3d3e42,9ab85b696d776c264ea55bb39a87916361a890af97e9542b6db55bd251fd558a7f:55f0,64bc634d65f161be608d710a6c:5749,592f676d822a58d5568e8c6a6beb90dd597d801753f76d695475559d83:77cf,683879be548c4f55540876d28c8996026cb36db88d6b89109e648d3a563f9ed175d55f8872e0606854fc4ea86a2a886160528f7054c470d886799e3f6d2a5b8f5f187ea255894faf7334543c539a501954:0e7c,4e4e5ffd745a58f6846b80e1877472d07cca6e567c:434445464748494a4b4c4e4f505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f70717275767778797a7e7f8081828384858687#888a8b8c8d8e8f90939496999a9ba0a1a3a6a7a8a9abacadafb0b4b5b6b7b8babb,5f27864e552c62a44e926caa623782b154d7534e733e6ed1753b521253168bdd69d05f8a60006dee574f6b2273af68538fd87f13636260a3552475ea8c6271156da35ba65e7b8352614c9ec478fa87577c27768751f060f6714c66435e4c604d8c0e707063258f895fbd606286d456de6bc160946167534960e066668d3f79fd4f1a70e96c478b:b3f2,7ed88364660f5a5a9b426d:51f7,8c416d3b4f19706b83b7621660d1970d8d27797851fb57:3efa,673a75787a3d79ef7b957c:bfc0c2c3c4c6c9cbcecfd0d1d2d3d4d8dadbdddee1e2e3e4e5e6e7e9eaebecedeef0f1f2f3f4f5f6f7f9fafcfdfeff,7d:000102030405060708090b0c0d0e0f10#1112131415161718191a1b1c1d1e1f212324252628292a2c2d2e30313233343536,808c99658ff96fc08ba59e2159ec7ee97f095409678168d88f917c4d96c653ca602575be6c7253735ac97ea7632451e0810a5df184df628051805b634f0e796d524260b86d4e5b:c4c2,8b:a1b0,65e25fcc964559937e:e7aa,560967b759394f735bb652a0835a988a8d3e753294be50477a3c4ef767b69a7e5ac16b7c76d1575a5c167b3a95f4714e517c80a9827059787f04832768c067ec78:b177,62e363617b804fed526a51cf835069db92748d:f531,89c1952e7bad4ef67d:3738393a3b3c3d3e3f404142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6f70717273747576#78797a7b7c7d7e7f808182838485868788898a8b8c8d8e8f909192939495969798,506582305251996f6e:1085,6da75efa50f559dc5c066d466c5f7586848b686859568bb253209171964d854969127901712680f64ea490ca6d479a845a0756bc640594f077eb4fa5811a72e189d2997a7f347ede527f655991758f:7f83,53eb7a9663:eda5,768679f888579636622a52ab8282685467706377776b7aed6d017ed389e359d0621285c982a5754c501f4ecb75a58beb5c4a5dfe7b4b65a491d14eca6d25895f7d2795264ec58c288fdb9773664b79818fd170ec6d787d:999a9b9c9d9e9fa0a1a2a3a4a5a7a8a9aaabacadafb0b1b2b3b4b5b6b7b8b9babbbcbdbebfc0c1c2c3c4c5c6c7c8c9cacbcccdcecfd0d1d2d3d4d5d6d7d8d9#dadbdcdddedfe0e1e2e3e4e5e6e7e8e9eaebecedeeeff0f1f2f3f4f5f6f7f8f9fa,5c3d52b283465162830e775b66769cb84eac60ca7c:beb3,7ecf4e958b66666f988897595883656c955c5f8475c997567a:dfde,51c070af7a9863ea7a767ea0739697ed4e4570784e5d915253a965:51e7,81fc8205548e5c31759a97a062d872d975bd5c459a7983ca5c40548077e94e3e6cae805a62d2636e5de851778ddd8e1e952f4ff153e560e770ac526763509e435a1f5026773753777ee26485652b628963985014723589c951b38bc07edd574783cc94a7519b541b5cfb7d:fbfcfdfeff,7e:000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f30313233343536373839#3a3c3d3e3f40424344454648494a4b4c4d4e4f505152535455565758595a5b5c5d,4fca7ae36d5a90e19a8f55805496536154af5f0063e9697751ef6168520a582a52d8574e780d770b5eb761777ce062:5b97,4ea27095800362f770e49760577782db67ef68f578d5989779d158f354b353ef6e34514b523b5ba28bfe80af554357a660735751542d7a7a60505b5463a762a053e362635bc767af54ed7a9f82e691775e9388e4593857ae630e8de880ef57577b774fa95feb5bbd6b3e53217b5072c2684677:ff36,65f751b54e8f76d45cbf7aa58475594e9b4150807e:5e5f606162636465666768696a6b6c6d6e6f707172737475767778797a7b7c7d7e7f8081838485868788898a8b8c8d8e8f909192939495969798999a9c9d9e#aeb4bbbcd6e4ecf9,7f:0a101e37393b3c3d3e3f404143464748494a4b4c4d4e4f5253,998861276e8357646606634656f062:ec69,5ed39614578362c955878721814a8fa3556683b167658d5684dd5a6a680f62e67bee961151706f9c8c3063fd89c861d27f0670c26ee57405699472fc5eca90ce67176d6a635e52b3726280014f6c59e5916a70d96d9d52d24e5096f7956d857e78ca7d2f5121579264c2808b7c7b6cea68f1695e51b7539868a872819ece7bf172f879bb6f137406674e91cc9ca4793c83:8954,540f68174e3d538952b1783e5386522950884f:8bd0,7f:56595b5c5d5e6063646566676b6c6d6f7073757677787a7b7c7d7f8082838485868788898b8d8f9091929395969798999b9ca0a2a3a5a6a8a9aaabacadaeb1#b3b4b5b6b7babbbec0c2c3c4c6c7c8c9cbcdcfd0d1d2d3d6d7d9dadbdcdddee2e3,75e27acb7c926ca596b6529b748354e94fe9805483b28fde95705ec9601c6d9f5e18655b813894fe604b70bc7ec37cae51c968817cb1826f4e248f8691cf667e4eae8c0564a9804a50da759771ce5be58fbd6f664e86648295635ed66599521788c270c852a3730e7433679778f797164e3490bb9cde6dcb51db8d41541d62ce73b283f196f69f8494c34f367f9a51cc707596755cad988653e64ee46e9c740969b4786b998f7559521876246d4167f3516d9f99804b54997b3c7abf7f:e4e7e8eaebecedeff2f4f5f6f7f8f9fafdfeff,80:020708090a0e0f11131a1b1d1e1f2123242b2c2d2e2f303234393a3c3e404144454748494e4f505153555657#595b5c5d5e5f6061626364656667686b6c6d6e6f7072737475767778797a7b7c7d,9686578462e29647697c5a0464027bd36f0f964b82a6536298855e90708963b35364864f9c819e93788c97328d:ef42,9e7f6f5e79845f559646622e9a74541594dd4fa365c55c:6561,7f1586516c2f5f8b73876ee47eff5ce6631b5b6a6ee653754e7163a0756562a18f6e4f264ed16ca67eb68bba841d87ba7f57903b95237ba99aa188f8843d6d1b9a867edc59889ebb739b780186829a:6c82,561b541757cb4e709ea653568fc881097792999286ee6ee1851366fc61626f2b80:7e818285888a8d8e8f909192949597999ea3a6a7a8acb0b3b5b6b8b9bbc5c7c8c9cacbcfd0d1d2d3d4d5d8dfe0e2e3e6eef5f7f9fbfeff,81:000103040507080b#0c1517191b1c1d1f202122232425262728292a2b2d2e3033343537393a3b3c3d3f,8c298292832b76f26c135fd983bd732b8305951a6bdb77db94c6536f830251925e3d8c8c8d384e4873ab679a68859176970971646ca177095a9295416bcf7f8e66275bd059b95a9a95:e8f7,4eec84:0c99,6aac76df9530731b68a65b5f772f919a97617cdc8ff78c1c5f257c7379d889c56ccc871c5bc65e4268c977207ef551:954d,52c95a297f05976282d763cf778485d079d26e3a5e9959998511706d6c1162bf76bf654f60af95fd660e879f9e2394ed54:0d7d,8c2c647881:40414243444547494d4e4f525657585b5c5d5e5f6162636466686a6b6c6f727375767778818384858687898b8c8d8e90929394959697999a9e9fa0a1a2a4a5#a7a9abacadaeafb0b1b2b4b5b6b7b8b9bcbdbebfc4c5c7c8c9cbcdcecfd0d1d2d3,647986116a21819c78e864699b5462b9672b83ab58a89ed86cab6f205bde964c8c0b725f67d062c772614ea959c66bcd589366ae5e5552df6155672876ee776672677a4662ff54:ea50,94a090a35a1c7eb36c164e435976801059485357753796be56ca63208111607c95f96dd65462998151855ae980fd59ae9713502a6ce55c3c62df4f60533f817b90066eba852b62c85e7478be64b5637b5ff55a18917f9e1f5c3f634f80425b7d556e95:4a4d,6d8560a867e072de51dd5b8181:d4d5d6d7d8d9dadbdcdddedfe0e1e2e4e5e6e8e9ebeeeff0f1f2f5f6f7f8f9fafdff,82:030708090a0b0e0f111315161718191a1d2024252627292e323a3c3d3f#404142434546484a4c4d4e5051525354555657595b5c5d5e606162636465666769,62e76cde725b626d94ae7ebd81136d53519c5f04597452aa6012597366968650759f632a61e67cef8bfa54e66b279e256bb485d5545550766ca4556a8db4722c5e156015743662cd6392724c5f986e436d3e65006f5876d878d076fc7554522453db4e535e9e65c180:2ad6,629b5486522870ae888d8dd16ce1547880da57f988f48d54966a914d4f696c9b55b776c6783062a870f96f8e5f6d84ec68da787c7bf781a8670b9e4f636778b0576f7812973962:79ab,528874356bd782:6a6b6c6d71757677787b7c808183858687898c90939495969a9b9ea0a2a3a7b2b5b6babbbcbfc0c2c3c5c6c9d0d6d9dadde2e7e8e9eaecedeef0f2f3f5f6f8#fafcfdfeff,83:000a0b0d1012131618191d1e1f20212223242526292a2e3032373b3d,5564813e75b276ae533975de50fb5c418b6c7bc7504f72479a9798d86f0274e27968648777a562fc98918d2b54c180584e52576a82f9840d5e7351ed74f68bc45c4f57616cfc98875a4678349b448feb7c955256625194fa4ec68386846183e984b257d467345703666e6d668c3166dd7011671f6b3a6816621a59bb4e0351c46f0667d26c8f517668cb59476b6775665d0e81109f5065d779:4841,9a918d775c824e5e4f01542f5951780c56686c148fc45f036c:7de3,8bab639083:3e3f41424445484a4b4c4d4e5355565758595d6270717273747576797a7e7f808182838487888a8b8c8d8f909194959697999a9d9fa1a2a3a4a5a6a7acadae#afb5bbbebfc2c3c4c6c8c9cbcdced0d1d2d3d5d7d9dadbdee2e3e4e6e7e8ebeced,60706d3d7275626694:8ec5,53438fc17b7e4edf8c264e7e9ed494:b1b3,524d6f5c90636d458c3458115d4c6b:2049,67aa545b81547f8c589985375f3a62a26a47953965726084686577a74e544fa85de7979864ac7fd85ced4fcf7a8d520783044e14602f7a8394a64fb54eb279e6743452e482b964d279bd5bdd6c8197528f7b6c22503e537f6e0564ce66746c3060c598778bf75e86743c7a7779cb4e1890b174036c4256da914b6cc58d8b533a86c666f28eaf5c489a716e2083:eeeff3f4f5f6f7fafbfcfeff,84:0002050708090a10121314151617191a1b1e1f20212223292a2b2c2d2e2f30323334353637393a3b3e3f404142434445474849#4a4b4c4d4e4f505253545556585d5e5f606264656667686a6e6f70727477797b7c,53d65a369f8b8da353bb570898a76743919b6cc9516875ca62f372ac52:389d,7f3a7094763853749e4a69b7786e96c088d97fa471:36c3,518967d374e458e4651856b78ba9997662707ed560f970ed58ec4e:c1ba,5fcd97e74efb8ba45203598a7eab62544ecd65e5620e833884c98363878d71946eb65bb97ed2519763c967d480898339881551125b7a59828fb14e736c5d516589258f6f962e854a745e95:10f0,6da682e55f3164926d128428816e9cc3585e8d5b4e0953c184:7d7e7f8081838485868a8d8f90919293949596989a9b9d9e9fa0a2a3a4a5a6a7a8a9aaabacadaeb0b1b3b5b6b7bbbcbec0c2c3c5c6c7c8cbcccecfd2d4d5d7#d8d9dadbdcdee1e2e4e7e8e9eaebedeeeff1f2f3f4f5f6f7f8f9fafbfdfe,85:000102,4f1e6563685155d34e2764149a9a626b5ac2745f82726da968ee50e7838e7802674052396c997eb150bb5565715e7b5b665273ca82eb67495c715220717d886b95ea965564c58d6181b355846c5562477f2e58924f2455468d4f664c4e0a5c1a88f368a2634e7a0d70e7828d52fa97f65c1154e890b57ecd59628d4a86c782:0c0d,8d6664445c0461516d89793e8bbe78377533547b4f388eab6df15a207ec5795e6c885ba15a76751a80be614e6e1758f075:1f25,727253477ef385:030405060708090a0b0d0e0f101214151618191b1c1d1e2022232425262728292a2d2e2f303132333435363e3f404142444546474b4c4d4e4f505152535455#57585a5b5c5d5f60616263656667696a6b6c6d6e6f707173757677787c7d7f8081,770176db526980dc57235e08593172ee65bd6e7f8bd75c388671534177f362fe65f64ec098df86805b9e8bc653f277e24f7f5c4e9a7659cb5f0f793a58eb4e1667ff4e8b62ed8a93901d52bf662f55dc566c90024ed54f8d91ca99706c0f5e0260435ba489c68bd56536624b99965b:88ff,6388552e53d77626517d852c67a268b36b8a62928f9353d482126dd1758f4e668d4e5b70719f85af66:91d9,7f7287009ecd9f205c5e672f8ff06811675f620d7ad658855eb665706f3185:82838688898a8b8c8d8e909192939495969798999a9d9e9fa0a1a2a3a5a6a7a9abacadb1b2b3b4b5b6b8babbbcbdbebfc0c2c3c4c5c6c7c8cacbcccdced1d2#d4d6d7d8d9dadbdddedfe0e1e2e3e5e6e7e8eaebecedeeeff0f1f2f3f4f5f6f7f8,60555237800d6454887075295e05681362f4971c53cc723d8c016c3477617a0e542e77ac987a821c8bf47855671470c165af64955636601d79c153f84e1d6b7b80865bfa55e356db4f:3a3c,99725df3677e80386002988290015b8b8b:bcf5,641c825864de55fd82cf91654fd77d20901f7c9f50f358516eaf5bbf8bc980839178849c7b97867d96:8b8f,7ee59ad3788e5c817a57904296a7795f5b59635f7b0b84d168ad55067f2974107d2295016240584c4ed65b835979585485:f9fafcfdfe,86:0001020304060708090a0b0c0d0e0f10121314151718191a1b1c1d1e1f20212223242526282a2b2c2d2e2f3031323334353637393a3b3d3e3f40#4142434445464748494a4b4c525355565758595b5c5d5f6061636465666768696a,736d631e8e:4b0f,80ce82d462ac53f06cf0915e592a60016c70574d644a8d2a762b6ee9575b6a8075f06f6d8c:2d08,57666bef889278b363a253f970ad6c645858642a580268e0819b55107cd650188eba6dcc8d9f70eb638f6d9b6ed47ee68404684390036dd896768ba85957727985e4817e75bc8a8a68af52548e22951163d098988e44557c4f5366ff568f60d56d9552435c4959296dfb586b75:301c,606c82148146631167618fe2773a8d:f334,94c15e165385542c70c386:6d6f7072737475767778838485868788898e8f90919294969798999a9b9e9fa0a1a2a5a6abadaeb2b3b7b8b9bbbcbdbebfc1c2c3c5c8cccdd2d3d5d6d7dadc#dde0e1e2e3e5e6e7e8eaebeceff5f6f7fafbfcfdff,87:010405060b0c0e0f10111416,6c405ef7505c4ead5ead633a8247901a6850916e77b3540c94dc5f647ae5687663457b527edf75db507762955934900f51f879c37a8156fe5f9290146d825c60571f541051546e4d56e263a89893817f8715892a9000541e5c6f81c062:d658,81319e3596409a:6e7c,692d59a562d3553e631654c786d96d3c5a0374e6889c6b6a59168c4c5f2f6e7e73a9987d4e3870f75b8c7897633d665a769660cb5b9b5a494e0781556c6a738b4ea167897f515f8065fa671b5fd859845a0187:191b1d1f20242627282a2b2c2d2f303233353638393a3c3d404142434445464a4b4d4f505152545556585a5b5c5d5e5f6162666768696a6b6c6d6f71727375#7778797a7f8081848687898a8c8e8f90919294959698999a9b9c9d9ea0a1a2a3a4,5dcd5fae537197e68fdd684556f4552f60df4e3a6f4d7ef482c7840e59d44f:1f2a,5c3e7eac672a851a5473754f80c355829b4f4f4d6e2d8c135c096170536b761f6e29868a658795fb7eb9543b7a337d0a95ee55e17fc174ee631d87176da17a9d621165a1536763e16c835deb545c94a84e4c6c618bec5c4b65e0829c68a754:3e34,6b:cb66,4e9463425348821e4f:0dae,575e620a96fe6664726952:ffa1,609f8bef661471996790897f785277fd6670563b54389521727a87:a5a6a7a9aaaeb0b1b2b4b6b7b8b9bbbcbebfc1c2c3c4c5c7c8c9cccdcecfd0d4d5d6d7d8d9dadcdddedfe1e2e3e4e6e7e8e9ebecedeff0f1f2f3f4f5f6f7f8#fafbfcfdff,88:0001020405060708090b0c0d0e0f101112141718191a1c1d1e1f2023,7a00606f5e0c6089819d591560dc718470ef6eaa6c5072806a8488ad5e2d4e605ab3559c94e36d177cfb9699620f7ec6778e867e5323971e8f9666875ce14fa072ed4e0b53a6590f54136380952851484ed99c9c7ea454b88d248854823795f26d8e5f265acc663e966973:b02e,53bf817a99857fa15baa96:7750,7ebf76f853a2957699997bb189446e584e617fd479658be660f354cd4eab98795df76a6150cf54118c618427785d9704524a54ee56a395006d885bb56dc6665388:2425262728292a2b2c2d2e2f30313334353637383a3b3d3e3f414243464748494a4b4e4f505152535556585a5b5c5d5e5f6066676a6d6f717374757678797a#7b7c80838687898a8c8e8f90919394959798999a9b9d9e9fa0a1a3a5a6a7a8a9aa,5c0f5b5d6821809655787b11654869544e9b6b47874e978b534f631f643a90aa659c80c18c10519968b0537887f961c86c:c4fb,8c225c5185aa82af950c6b238f9b65b05f:fbc3,4fe18845661f8165732960fa51745211578b5f6290a2884c91925e78674f602759d351:44f6,80f853086c7996c4718a4f:11ee,7f9e673d55c5950879c088967ee3589f620c9700865a5618987b5f908bb884c4915753d965ed5e8f755c60647d6e5a7f7e:eaed,8f6955a75ba360ac65cb738488:acaeafb0b2b3b4b5b6b8b9babbbdbebfc0c3c4c7c8cacbcccdcfd0d1d3d6d7dadbdcdddee0e1e6e7e9eaebecedeeeff2f5f6f7fafbfdff,89:0001030405060708#090b0c0d0e0f1114151617181c1d1e1f20222324262728292c2d2e2f3132333537,9009766377297eda9774859b5b667a7496ea884052cb718f5faa65ec8be25bfb9a6f5de16b896c5b8b:adaf,900a8fc5538b62bc9e:262d,54404e2b82bd7259869c5d1688596daf96c554d14e9a8bb6710954bd960970df6df976d04e25781487125ca95ef68a00989c960e708e6cbf594463a9773c884d6f148273583071d5538c781a96c155015f6671305bb48c1a9a8c6b83592e9e2f79e76768626c4f6f75a17f8a6d0b96336c274ef075d2517b68376f3e908081705996747689:38393a3b3c3d3e3f40424345464748494a4b4c4d4e4f505152535455565758595a5b5c5d6061626364656768696a6b6c6d6e6f707172737475767778797a7c#7d7e808284858788898a8b8c8d8e8f909192939495969798999a9b9c9d9e9fa0a1,64475c2790657a918c2359da54ac8200836f898180006930564e8036723791ce51b64e5f987563964e1a53f666f3814b591c6db24e0058f9533b63d694f14f:9d0a,886398905937905779fb4eea80f075916c825b9c59e85f5d69058681501a5df24e5977e34ee5827a6291661390915c794ebf5f7981c69038808475ab4ea688d4610f6bc55fc64e4976ca6ea28b:e3ae,8c0a8bd15f027f:fccc,7ece83:356b,56e06bb797f3963459fb541f94f66deb5bc5996e5c395f15969089:a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebfc0c3cdd3d4d5d7d8d9dbdddfe0e1e2e4e7e8e9eaecedeef0f1f2f4f5f6f7f8f9fa#fbfcfdfeff,8a:01020304050608090a0b0c0d0e0f101112131415161718191a1b1c1d,537082f16a315a749e705e947f2883b984:2425,836787478fce8d6276c85f719896786c662054df62e54f6381c375c85eb896cd8e0a86f9548f6cf36d8c6c38607f52c775285e7d4f1860a05fe75c24753190ae94c072b96cb96e389149670953:cbf3,4f5191c98bf153c85e7c8fc26de44e8e76c26986865e611a82064f:59de,903e9c7c61096e:1d14,96854e885a3196e84e0e5c7f79b95b878bed7fbd738957df828b90c15401904755bb5cea5fa161086b3272f180b28a:891e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3f4041424344454647494a4b4c4d4e4f505152535455565758595a5b5c5d5e#5f606162636465666768696a6b6c6d6e6f7071727374757677787a7b7c7d7e7f80,6d745bd388d598848c6b9a6d9e336e0a51:a443,57a38881539f63f48f9556ed54585706733f6e907f188fdc82d1613f6028966266f07ea68d:8ac3,94a55cb37ca4670860a6960580184e9190e75300966851418fd08574915d665597f55b55531d78386742683d54c9707e5bb08f7d518d572854b1651266828d:5e43,810f846c906d7cdf51ff85fb67a365e96fa186a48e81566a90207682707671e58d2362e952196cfd8d3c600e589e618e66fe8d60624e55b36e23672d8f678a:81828384858687888b8c8d8e8f9091929495969798999a9b9c9d9e9fa0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebfc0c1c2#c3c4c5c6c7c8c9cacbcccdcecfd0d1d2d3d4d5d6d7d8d9dadbdcdddedfe0e1e2e3,94e195f87728680569a8548b4e4d70b88bc86458658b5b857a84503a5be877bb6be18a797c986cbe76cf65a98f975d2d5c5586386808536062187ad96e5b7efd6a1f7ae05f706f335f20638c6da867564e085e108d264ed780c07634969c62db662d627e6cbc8d7571677f695146808753ec906e629854f286f08f998005951785178fd96d5973cd659f771f7504782781fb8d1e94884fa6679575b98bca9707632f9547963584b8632377415f8172f04e896014657462ef6b63653f8a:e4e5e6e7e8e9eaebecedeeeff0f1f2f3f4f5f6f7f8f9fafbfcfdfeff,8b:0001020304050608090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20212223#24252728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f404142434445,5e2775c790d18bc1829d679d652f5431871877e580a281026c414e4b7ec7804c76f4690d6b966267503c4f84574063076b628dbe53ea65e87eb85fd763:1ab7,81:f3f4,7f6e5e1c5cd95236667a79e97a1a8d28709975d46ede6cbb7a924e2d76c55fe0949f88777ec879cd80bf91cd4ef24f17821f54685dde6d328bcc7ca58f7480985e1a549276b15b99663c9aa473e0682a86db6731732a8b:f8db,90107af970db716e62c477a956314e3b845767f152a986c08d2e94f87b518b:464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f6061626364656768696a6b6d6e6f707172737475767778797a7b7c7d7e7f80818283848586#8788898a8b8c8d8e8f909192939495969798999a9b9c9d9e9facb1bbc7d0ea,8c:091e,4f4f6ce8795d9a7b6293722a62fd4e1378168f6c64b08d5a7bc668695e8488c55986649e58ee72b6690e95258ffd8d5857607f008c0651c6634962d95353684c74228301914c55447740707c6d4a517954a88d4459ff6ecb6dc45b5c7d2b4ed47c7d6ed35b5081ea6e0d5b579b0368d58e2a5b977efc603b7eb590b98d70594f63cd79df8db3535265cf79568bc5963b7ec494bb7e825634918967007f6a5c0a907566285de64f5067de505a4f5c57505e:a7#3$,8c:38393a3b3c3d3e3f4042434445484a4b4d4e4f5051525354565758595b5c5d5e5f60636465666768696c6d6e6f707172747576777b7c7d7e7f808183848687#888b8d8e8f90919293959697999a9b9c9d9e9fa0a1a2a3a4a5a6a7a8a9aaabacad,4e:8d0c,51404e105eff53454e:15981e,9b325b6c56694e2879ba4e3f53154e47592d723b536e6c1056df80e499976bd3777e9f174e:369f,9f104e:5c6993,82885b5b556c560f4ec453:8d9da3a5ae,97658d5d53:1af5262e3e,8d5c53:6663,52:02080e2d333f404c5e615c,84af52:7d82819093,51827f544e:bbc3c9c2e8e1ebde,4f1b4ef34f:2264,4ef54f:2527092b5e67,65384f:5a5d,8c:aeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebfc0c1c2c3c4c5c6c7c8c9cacbcccdcecfd0d1d2d3d4d5d6d7d8d9dadbdcdddedfe0e1e2e3e4e5e6e7e8e9eaebec#edeeeff0f1f2f3f4f5f6f7f8f9fafbfcfdfeff,8d:000102030405060708090a0b0c0d,4f:5f57323d76749189838f7e7baa7cac94e6e8eac5dae3dcd1dff8,50:294c,4ff350:2c0f2e2d,4ffe50:1c0c25287e4355484e6c7ba5a7a9bad6,510650:edece6ee,51:070b,4edd6c3d4f:5865ce,9fa06c467c74516e5dfd9ec999985181591452f9530d8a07531051eb591951554ea051564eb388:6ea4,4eb5811488d279805b3488037fb851:abb1bdbc,8d:0e0f101112131415161718191a1b1c205152575f6568696a6c6e6f717278797a7b7c7d7e7f808283868788898c8d8e8f90929395969798999a9b9c9d9ea0a1#a2a4a5a6a7a8a9aaabacadaeafb0b2b6b7b9bbbdc0c1c2c5c7c8c9cacdd0d2d3d4,51:c796a2a5,8b:a0a6a7aab4b5b7c2c3cbcfced2d3d4d6d8d9dcdfe0e4e8e9eef0f3f6f9fcff,8c:000204070c0f1112141516191b181d1f202125272a2b2e2f32333536,53:697a,96:1d2221312a3d3c4249545f676c7274888d97b0,90:979b9d99aca1b4b3b6ba,8d:d5d8d9dce0e1e2e5e6e7e9edeef0f1f2f4f6fcfeff,8e:00010203040607080b0d0e1011121315161718191a1b1c202124252627282b2d303233343637383b3c3e#3f4345464c4d4e4f505354555657585a5b5c5d5e5f60616263646567686a6b6e71,90:b8b0cfc5bed0c4c7d3e6e2dcd7dbebeffe,91:04221e23312f394346,520d594252:a2acadbe,54ff52:d0d6f0,53df71ee77cd5ef451:f5fc,9b2f53b65f01755a5def57:4ca9a1,58:7ebcc5d1,57:292c2a33392e2f5c3b4269856b867c7b686d7673ada48cb2cfa7b493a0d5d8dad9d2b8f4eff8e4dd,8e:73757778797a7b7d7e808283848688898a8b8c8d8e91929395969798999a9b9d9fa0a1a2a3a4a5a6a7a8a9aaadaeb0b1b3b4b5b6b7b8b9bbbcbdbebfc0c1c2#c3c4c5c6c7c8c9cacbcccdcfd0d1d2d3d4d5d6d7d8d9dadbdcdddedfe0e1e2e3e4,58:0b0d,57:fded,58:001e194420656c81899a80,99a89f1961ff82:797d7f8f8aa8848e919799abb8beb0c8cae398b7aecbccc1a9b4a1aa9fc4cea4e1,830982:f7e4,83:0f07,82:dcf4d2d8,830c82:fbd3,83:111a061415,82:e0d5,83:1c515b5c08923c34319b5e2f4f47435f4017602d3a336665,8e:e5e6e7e8e9eaebecedeeeff0f1f2f3f4f5f6f7f8f9fafbfcfdfeff,8f:000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20212223#2425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f4041424344,83:681b696c6a6d6eb078b3b4a0aa939c857cb6a97db87b989ea8babcc1,840183:e5d8,580784:180b,83:ddfdd6,84:1c381106,83:d4df,84:0f03,83:f8f9eac5c0,842683:f0e1,84:5c515a597387887a89783c4669768c8e316dc1cdd0e6bdd3cabfbae0a1b9b497e5e3,850c750d853884f085:391f3a,8f:45464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f6061626364656a808c929da0a1a2a4a5a6a7aaacadaeafb2b3b4b5b7b8babbbcbfc0c3c6#c9cacbcccdcfd2d6d7dae0e1e3e7eceff1f2f4f5f6fafbfcfeff,90:07080c0e131518,85:563b,84:fffc,85:594868645e7a,77a285:43727ba4a8878f79ae9c85b9b7b0d3c1dcff,86:270529163c,5efe5f0859:3c41,803759:555a58,530f5c:22252c34,62:4c6a9fbbcadad7ee,632262f663:394b43adf6717a8eb46dac8a69aebcf2f8e0ffc4dece,645263:c6be,64:45410b1b200c26215e846d96,90:191c2324252728292a2b2c303132333437393a3d3f4043454648494a4b4c4e545556595a5c5d5e5f6061646667696a6b6c6f70717273767778797a7b7c7e81#84858687898a8c8d8e8f90929496989a9c9e9fa0a4a5a7a8a9abadb2b7bcbdbfc0,64:7ab7b899bac0d0d7e4e2,65:09252e,5f:0bd2,75195f1153:5ff1fde9e8fb,54:1216064b5253545643215759233282947771649a9b8476669dd0adc2b4d2a7a6d3d472a3d5bbbfccd9dadca9aaa4ddcfde,551b54e7552054fd551454f355:22230f11272a678fb5496d41553f503c,90:c2c3c6c8c9cbcccdd2d4d5d6d8d9dadedfe0e3e4e5e9eaeceef0f1f2f3f5f6f7f9fafbfcff,91:00010305060708090a0b0c0d0e0f1011121314151617181a1b1c#1d1f20212425262728292a2b2c2d2e30323334353637383a3b3c3d3e3f40414244,55:375675767733305c8bd283b1b988819f7ed6917bdfbdbe9499eaf7c9,561f55:d1ebecd4e6ddc4efe5f2f3cccde8f5e4,8f9456:1e080c012423,55fe56:00272d5839572c4d62595c4c548664716b7b7c8593afd4d7dde1f5ebf9ff,57:040a091c,5e:0f191411313b3c,91:454748515354555658595b5c5f606667686b6d737a7b7c808182838486888a8e8f939495969798999c9d9e9fa0a1a4a5a6a7a8a9abacb0b1b2b3b6b7b8b9bb#bcbdbebfc0c1c2c3c4c5c6c8cbd0d2d3d4d5d6d7d8d9dadbdddedfe0e1e2e3e4e5,5e:3744545b5e61,5c:8c7a8d9096889899919a9cb5a2bdacabb1a3c1b7c4d2e4cbe5,5d:020327262e241e061b583e343d6c5b6f5d6b4b4a697482999d,8c735d:b7c5,5f:73778287898c95999ca8adb5bc,88625f6172:adb0b4b7b8c3c1cecdd2e8efe9f2f4f7,730172f3730372fa91:e6e7e8e9eaebecedeeeff0f1f2f3f4f5f6f7f8f9fafbfcfdfeff,92:000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f2021222324#25262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f404142434445,72fb73:1713210a1e1d152239252c3831504d57606c6f7e,821b592598e759:2402,99:636768696a6b6c74777d8084878a8d9091939495,5e:80918b96a5a0b9b5beb3,8d535e:d2d1dbe8ea,81ba5f:c4c9d6cf,60035fee60045f:e1e4fe,60:0506,5f:eaedf8,60:1935261b0f0d292b0a3f2178797b7a42,92:464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f7071727375767778797a7b7c7d7e7f808182838485#868788898a8b8c8d8f909192939495969798999a9b9c9d9e9fa0a1a2a3a4a5a6a7,60:6a7d969aad9d83928c9becbbb1ddd8c6dab4,61:20261523,60f461:000e2b4a75ac94a7b7d4f5,5fdd96b395:e9ebf1f3f5f6fcfe,96:030406080a0b0c0d0f12151617191a,4e2c723f62156c:35545c4aa38590948c6869747686a9d0d4adf7f8f1d7b2e0d6faebeeb1d3effe,92:a8a9aaabacadafb0b1b2b3b4b5b6b7b8b9babbbcbdbebfc0c1c2c3c4c5c6c7c9cacbcccdcecfd0d1d2d3d4d5d6d7d8d9dadbdcdddedfe0e1e2e3e4e5e6e7e8#e9eaebecedeeeff0f1f2f3f4f5f6f7f8f9fafbfcfdfeff,93:00010203040506070809,6d:39270c43480704190e2b4d2e351a4f525433916f9ea05e93945c607c63,6e1a6d:c7c5de,6e0e6d:bfe0,6e116d:e6ddd9,6e166dab6e0c6dae6e:2b6e4e6bb25f865354322544dfb198e0,6f2d6e:e2a5a7bdbbb7d7b4cf8fc29f,6f:6246472415,6ef96f:2f364b742a0929898d8c78727c7ad1,93:0a0b0c0d0e0f101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3f40414243444546474849#4a4b4c4d4e4f505152535455565758595a5b5c5d5e5f606162636465666768696b,6f:c9a7b9b6c2e1eedee0ef,70:1a231b39354f5e,5b:80849593a5b8,752f9a9e64345b:e4ee,89305bf08e478b078f:b6d3d5e5eee4e9e6f3e8,90:05040b26110d162135362d2f445152506858625b,66b990:747d8288838b,5f:50575658,5c3b54ab5c:5059,5b715c:6366,7fbc5f:2a292d,82745f3c9b3b5c6e59:81838da9aaa3,93:6c6d6e6f707172737475767778797a7b7c7d7e7f808182838485868788898a8b8c8d8e909192939495969798999a9b9c9d9e9fa0a1a2a3a4a5a6a7a8a9aaab#acadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebfc0c1c2c3c4c5c6c7c8c9cbcccd,59:97caab9ea4d2b2afd7be,5a:0506,59dd5a0859:e3d8f9,5a:0c09323411231340674a553c6275,80ec5a:aa9b777abeebb2d2d4b8e0e3f1d6e6d8dc,5b:091716323740,5c:151c,5b:5a6573515362,9a:7577787a7f7d808185888a90929396989b9c9d9fa0a2a3a5a7,7e:9fa1a3a5a8a9,93:cecfd0d1d2d3d4d5d7d8d9dadbdcdddedfe0e1e2e3e4e5e6e7e8e9eaebecedeeeff0f1f2f3f4f5f6f7f8f9fafbfcfdfeff,94:000102030405060708090a0b0c0d#0e0f101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e,7e:adb0bec0c1c2c9cbccd0d4d7dbe0e1e8ebeeeff1f2,7f0d7e:f6fafbfe,7f:01020307080b0c0f111217191c1b1f212223242526272a2b2c2d2f3031323335,5e7a757f5ddb753e909573:8e91aea29fcfc2d1b7b3c0c9c8e5d9,987c740a73:e9e7debaf2,74:0f2a5b262528302e2c,94:2f303132333435363738393a3b3c3d3f404142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f606162636465666768696a6c6d6e6f#707172737475767778797a7b7c7d7e7f8081828384919698c7cfd3d4dae6fb,95:1c20,74:1b1a415c575559776d7e9c8e8081878b9ea8a990a7d2ba,97:eaebec,67:4c535e4869a5876a7398a775a89ead8b777cf0,680967d8680a67:e9b0,680c67:d9b5dab3dd,680067:c3b8e2,680e67:c1fd,68:323360614e624464831d55664167403e4a4929b58f7477936bc2,696e68fc69:1f20,68f995:27333d43484b555a606e74757778797a7b7c7d7e808182838485868788898a8b8c8d8e8f909192939495969798999a9b9c9d9e9fa0a1a2a3a4a5a6a7a8a9aa#abacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebfc0c1c2c3c4c5c6c7c8c9cacb,692468f069:0b0157,68e369:10713960425d846b80987834cc8788ce896663799ba7bbabadd4b1c1cadf95e08dff,6a2f69ed6a:171865,69f26a:443ea0505b358e793d28587c9190a997ab,73:3752,6b:8182878492938d9a9ba1aa,8f:6b6d71727375767877797a7c7e818284878b,95:cccdcecfd0d1d2d3d4d5d6d7d8d9dadbdcdddedfe0e1e2e3e4e5e6e7ecff,96:0713181b1e20232425262728292b2c2d2f303738393a3e41434a4e4f5152535657#58595a5c5d5e606365666b6d6e6f70717378797a7b7c7d7e7f808182838487898a,8f:8d8e8f989a,8ece62:0b171b1f222125242c,81e774:eff4ff,75:0f1113,65:34eeeff0,66:0a19,677266:031500,708566:f71d34313635,800666:5f54414f56615777848ca79dbedbdce6e9,8d:3233363b3d4045464849474d5559,89:c7cacbcccecfd0d1,72:6e9f5d666f7e7f848b8d8f92,63:0832b0,96:8c8e91929395969a9b9d9e9fa0a1a2a3a4a5a6a8a9aaabacadaeafb1b2b4b5b7b8babbbfc2c3c8cacbd0d1d3d4d6d7d8d9dadbdcdddedfe1e2e3e4e5e6e7eb#ecedeef0f1f2f4f5f8fafbfcfdff,97:0203050a0b0c10111214151718191a1b1d1f20,64:3fd8,80046b:eaf3fdf5f9,6c:0507060d1518191a2129242a32,65:35556b,72:4d525630,8662521680:9f9c93bc,670a80:bdb1abadb4b7e7e8e9eadbc2c4d9cdd7,671080:ddebf1f4ed,81:0d0e,80:f2fc,671581128c5a81:361e2c1832484c5374595a7160697c7d6d67,584d5ab581:888291,6ed581:a3aacc,672681:cabb,97:2122232425262728292b2c2e2f3133343536373a3b3c3d3f404142434445464748494a4b4c4d4e4f5051545557585a5c5d5f63646667686a6b6c6d6e6f7071#72757778797a7b7d7e7f8081828384868788898a8c8e8f9093959697999a9b9c9d,81:c1a6,6b:243739434659,98:d1d2d3d5d9da,6bb35f406bc289f365909f5165:93bcc6c4c3ccced2d6,70:809c969dbbc0b7abb1e8ca,71:1013162f31735c6845724a787a98b3b5a8a0e0d4e7f9,72:1d28,706c71:1866b9,62:3e3d434849,79:3b4046495b5c535a6257606f677a858a9aa7b3,5f:d1d0,97:9e9fa1a2a4a5a6a7a8a9aaacaeb0b1b3b5b6b7b8b9babbbcbdbebfc0c1c2c3c4c5c6c7c8c9cacbcccdcecfd0d1d2d3d4d5d6d7d8d9dadbdcdddedfe0e1e2e3#e4e5e8eeeff0f1f2f4f7f8f9fafbfcfdfeff,98:000102030405060708090a0b0c0d0e,60:3c5d5a67415963ab,61:060d5da99dcbd1,620680:807f,6c:93f6,6dfc77:f6f8,78:0009171811,65ab78:2d1c1d393a3b1f3c252c23294e6d56572650474c6a9b939a879ca1a3b2b9a5d4d9c9ecf2,790578f479:13241e34,9f9b9e:f9fbfc,76f177:040d,76f977:07081a22192d263538505147435a68,98:0f101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f404142434445464748494a4b4c4d#4e4f505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e,77:62657f8d7d808c919fa0b0b5bd,75:3a404e4b485b727983,7f:58615f,8a487f:68747179817e,76:cde5,883294:8586878b8a8c8d8f909497959a9b9ca3a4abaaadacafb0b2b4b6b7b8b9babcbdbfc4c8c9cacbcccdced0d1d2d5d6d7d9d8dbdedfe0e2e4e5e7e8ea,98:6f70717273748b8e929599a3a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebfc0c1c2c3c4c5c6c7c8c9cacbcccdcfd0d4d6d7dbdcdde0e1e2e3e4#e5e6e9eaebecedeeeff0f1f2f3f4f5f6f7f8f9fafbfcfdfeff,99:0001020304050607,94:e9ebeeeff3f4f5f7f9fcfdff,95:03020607090a0d0e0f1213141516181b1d1e1f222a2b292c3132343637383c3e3f4235444546494c4e4f525354565758595b5e5f5d61626465666768696a6b6c6f7172733a,77:e7ec,96c979:d5ede3eb,7a065d477a:03021e14,99:08090a0b0c0e0f1112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2f303132333435363738393a3b3c3d3e3f40414243444546474849#4a4b4c4d4e4f50515253565758595a5b5c5d5e5f60616264667378797b7e828389,7a:393751,9ecf99a57a7076:888e9399a4,74:dee0,752c9e:202228292a2b2c3231363837393a3e414244464748494b4c4e5155575a5b5c5e63666768696a6b6c716d73,75:929496a09daca3b3b4b8c4b1b0c3c2d6cde3e8e6e4ebe7,760375:f1fcff,76:1000050c170a25181519,99:8c8e9a9b9c9d9e9fa0a1a2a3a4a6a7a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebfc0c1c2c3c4c5c6c7c8c9cacbcccdcecfd0d1d2d3d4d5d6d7d8#d9dadbdcdddedfe0e1e2e3e4e5e6e7e8e9eaebecedeeeff0f1f2f3f4f5f6f7f8f9,76:1b3c2220402d303f35433e334d5e545c566b6f,7fca7a:e6787980868895a6a0aca8adb3,88:6469727d7f82a2c6b7bcc9e2cee3e5f1,891a88:fce8fef0,89:2119131b0a342b3641667b,758b80e576:b2b4,77dc80:1214161c20222526272928310b3543464d526971,898398:788083,99:fafbfcfdfeff,9a:000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f303132333435363738#393a3b3c3d3e3f404142434445464748494a4b4c4d4e4f50515253545556575859,98:898c8d8f949a9b9e9fa1a2a5a6,86:4d546c6e7f7a7c7ba88d8bac9da7a3aa93a9b6c4b5ceb0bab1afc9cfb4e9f1f2edf3d0,871386:def4dfd8d1,87:0307,86f887:080a0d09233b1e252e1a3e48343129373f82227d7e7b60704c6e8b53637c64596593afa8d2,9a:5a5b5c5d5e5f606162636465666768696a6b7283898d8e949599a6a9aaabacadaeafb2b3b4b5b9bbbdbebfc3c4c6c7c8c9cacdcecfd0d2d4d5d6d7d9dadbdc#dddee0e2e3e4e5e7e8e9eaeceef0f1f2f3f4f5f6f7f8fafcfdfeff,9b:000102040506,87:c68885ad9783abe5acb5b3cbd3bdd1c0cadbeae0ee,88:1613,87fe88:0a1b21393c,7f:36424445,82107a:fafd,7b:080304150a2b0f47382a192e31202524333e1e585a45754c5d606e7b62727190a6a7b8ac9da885aa9ca2abb4d1c1ccdddae5e6ea,7c0c7b:fefc,7c:0f160b,9b:07090a0b0c0d0e1011121415161718191a1b1c1d1e2021222425262728292a2b2c2d2e3031333435363738393a3d3e3f40464a4b4c4e50525355565758595a#5b5c5d5e5f606162636465666768696a6b6c6d6e6f707172737475767778797a7b,7c:1f2a26384140,81fe82:010204,81ec884482:2122232d2f282b383b33343e44494b4f5a5f68,88:7e8588d8df,895e7f:9d9fa7afb0b2,7c7c65497c:919d9c9ea2b2bcbdc1c7cccdc8c5d7e8,826e66a87f:bfced5e5e1e6e9eef3,7cf87d:77a6ae,7e:479b,9e:b8b4,8d:73849491b1676d,8c:4749,91:4a504e4f64,9b:7c7d7e7f808182838485868788898a8b8c8d8e8f909192939495969798999a9b9c9d9e9fa0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9ba#bbbcbdbebfc0c1c2c3c4c5c6c7c8c9cacbcccdcecfd0d1d2d3d4d5d6d7d8d9dadb,91:626170696f7d7e7274798c85908d91a2a3aaadaeafb5b4ba,8c559e7e8d:b8eb,8e:055969,8d:b5bfbcbac4d6d7dadececfdbc6ecf7f8e3f9fbe4,8e098dfd8e:141d1f2c2e232f3a4039353d3149414251524a70767c6f74858f94909c9e,8c:78828a859894,659b89:d6dedadc,9b:dcdddedfe0e1e2e3e4e5e6e7e8e9eaebecedeeeff0f1f2f3f4f5f6f7f8f9fafbfcfdfeff,9c:000102030405060708090a0b0c0d0e0f101112131415161718191a#1b1c1d1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b,89:e5ebef,8a3e8b26975396:e9f3ef,97:0601080f0e2a2d303e,9f:808385868788898a8c,9efe9f:0b0d,96:b9bcbdced2,77bf96e092:8eaec8,93:3e6aca8f,94:3e6b,9c:7f8285868788,7a239c:8b8e90919294959a9b9e9fa0a1a2a3a5a6a7a8a9abadaeb0b1b2b3b4b5b6b7babbbcbdc4c5c6c7cacb3c3d3e3f404142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f707172737475767778797a#7b7d7e808384898a8c8f93969798999daaacafb9bebfc0c1c2c8c9d1d2dadbe0e1cccdcecfd0d3d4d5d7d8d9dcdddfe2,97:7c85919294afaba3b2b4,9a:b1b0b7,9e589a:b6babcc1c0c5c2cbccd1,9b:45434749484d51,98e899:0d2e5554,9a:dfe1e6efebfbedf9,9b:080f131f23,9e:bdbe,7e3b9e:8287888b92,93d69e:9d9fdbdcdde0dfe2e9e7e5eaef,9f:222c2f39373d3e44,9c:e3e4e5e6e7e8e9eaebecedeeeff0f1f2f3f4f5f6f7f8f9fafbfcfdfeff,9d:000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f2021#22232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f404142#92$434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f707172737475767778797a7b7c7d7e7f8081#82838485868788898a8b8c8d8e8f909192939495969798999a9b9c9d9e9fa0a1a2#92$a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebfc0c1c2c3c4c5c6c7c8c9cacbcccdcecfd0d1d2d3d4d5d6d7d8d9dadbdcdddedfe0e1#e2e3e4e5e6e7e8e9eaebecedeeeff0f1f2f3f4f5f6f7f8f9fafbfcfdfeff,9e:000102#92$030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e24272e30343b3c404d5052535456595d5f606162656e6f727475767778797a7b7c7d80#8183848586898a8c8d8e8f90919495969798999a9b9c9ea0a1a2a3a4a5a7a8a9aa#92$abacadaeafb0b1b2b3b5b6b7b9babcbfc0c1c2c3c5c6c7c8cacbccd0d2d3d5d6d7d9dadee1e3e4e6e8ebecedeef0f1f2f3f4f5f6f7f8fafdff,9f:000102030405#060708090a0c0f1112141516181a1b1c1d1e1f21232425262728292a2b2d2e3031#92$3233343536383a3c3f4041424345464748494a4b4c4d4e4f52535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f707172737475767778#797a7b7c7d7e81828d8e8f9091929394959697989c9d9ea1a2a3a4a5,f9:2c7995e7f1#92$,fa:0c0d0e0f111314181f20212324272829,e8:15161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f40414243#4445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f6061626364",f.init_data=function(){var i=f.zipData.replace(/#(\d+)\$/g,function(i,t){return Array(+t+3).join("#")}).replace(/#/g,"####").replace(/(\w\w):([\w#]+)(?:,|$)/g,function(i,t,s){return s.replace(/../g,function(i){return"##"!=i?t+i:i})}),t=0;i=i.match(/..../g);for(var s=129;s<=254;s++)for(var e=64;e<=254;e++)if(t>=i.length||"####"==i[t])t++;else{var h=parseInt("0x"+i[t]),a=s<<8|e;f.U2Ghash[h]=a,t++}for(var n in f.U2Ghash)f.G2Uhash[f.U2Ghash[n]]=parseInt(n)},f.init_data(),f.tmp_ui8=new ArrayBuffer(1024),f.tmp_dv=new DataView(f.tmp_ui8),f.gb2312a_to_utf8=function(i){for(var t="",s=0;s<i.length;s++){var e=i[s]<<8|i[s+1];e in f.G2Uhash?(t+=String.fromCharCode(f.G2Uhash[e]),s+=1):t+=String.fromCharCode(i[s])}return t},f.utf8_to_gb2312a=function(i){for(var t=0,s=0;s<i.length;s++){var e=i.charCodeAt(s);if(e in f.U2Ghash){var h=f.U2Ghash[e];f.tmp_dv.setUint8(t++,h>>8&255),f.tmp_dv.setUint8(t++,255&h)}else f.tmp_dv.setUint8(t++,e)}return new Uint8Array(f.tmp_ui8,0,t)};class u{constructor(i){null==i&&(i=4194304),this.bLoadSuccess=!1,this.MAXDATALENGTH=i,this.databuf=new ArrayBuffer(this.MAXDATALENGTH),this.pdataview=new DataView(this.databuf),this.iLength=0,this.b64c=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/","="],this._BASE64CODE=new ArrayBuffer(65),this._BASE64DECODE=new ArrayBuffer(256);for(var t=0;t<65;t++)this._BASE64CODE[t]=this.b64c[t].charCodeAt(0),this._BASE64DECODE[this._BASE64CODE[t]]=t;this.obd=new ArrayBuffer(65536)}SetDataAndOffset(i,t,s){for(var e=0;e<s;e++)this.databuf[e]=i[e];this.iLength=s,this.iOffset=t}xordata(i){for(var t=0;t<i;t++)this.databuf[t]=255^this.databuf[t]}SetData(i,t){for(var s=0;s<t;s++)this.databuf[s]=i[s];this.iLength=t,this.iOffset=0}GetData2(i){this.iLength=i.length;for(var t=0;t<this.iLength;t++)this.databuf[t]=i.charCodeAt(t),this.databuf[t]=255&this.databuf[t];this.iOffset=0}GetData3(i){var t,s=new Laya.Byte;s.clear(),s.writeArrayBuffer(i),s.pos=0;for(var e=0;e<s.length;e++)(t=s.getByte())<0&&(t+=256),this.databuf[e]=255&t;this.iOffset=0,this.iLength=s.length}GetData(i){null!=i?(bn.sop("load success "+this.load_fn),this.GetData3(i),this.iOffset=0,this.bLoadSuccess=!0,null!=this._plsbackcallfunc&&this._plsbackcallfunc()):bn.sop("load failed "+this.load_fn)}GetProc(i){bn.sop("Loading Proc : "+i)}InitDataFromURL(i,t){this._plsbackcallfunc=t,this.bLoadSuccess=!1,this.load_fn=i,Ld(i,Laya.Handler.create(this,this.GetData),Laya.Handler.create(this,this.GetProc),Laya.Loader.BUFFER)}InitDataFromFile(i,t){this._plsbackcallfunc=t,this.bLoadSuccess=!1,this.load_fn=i,Ld(bn.BASE_URL+i,Laya.Handler.create(this,this.GetData),Laya.Handler.create(this,this.GetProc),Laya.Loader.BUFFER)}JS_DataFromLocal(i){var t=localStorage.getItem(i);if(null==t||""==t)return!1;this.iLength=t.length,this.iOffset=0;for(var s=0;s<this.iLength;s++)this.databuf[s]=t.charCodeAt(s),this.databuf[s]=255&this.databuf[s];return this.Decode_base64(),!0}JS_DataToLocal(i){this.Encode_base64(),localStorage.setItem(i,this.obs)}Encode_base64(){var i,t,s=(this.iLength-this.iLength%3)/3;this.iLength%3!=0&&s++,s*=4,t=0;var e=this.obd;for(i=0;i<e.length;i++)e[i]=0;for(i=0;i<this.iLength;i++)switch(i%3){case 0:e[t]=this.databuf[i]>>2,e[++t]=(3&this.databuf[i])<<4;break;case 1:e[t]=e[t]|this.databuf[i]>>4,e[++t]=(15&this.databuf[i])<<2;break;case 2:e[t]=e[t]|this.databuf[i]>>6,e[++t]=63&this.databuf[i],t++}for(this.obs="",i=0;i<s;i++)i>t?(this.databuf[i]=64,this.obs+=this.b64c[64]):e[i]<64?(this.databuf[i]=this._BASE64CODE[e[i]],this.obs+=this.b64c[e[i]]):printf("error");this.iLength=s}Decode_base64(){if(this.iLength%4==0){var i,t=0,s=0;for(i=0;i<this.iLength;i++){if(this.databuf[i]===this._BASE64CODE[64])return void(this.iLength=t);switch(s=this._BASE64DECODE[this.databuf[i]],i%4){case 0:this.databuf[t]=s<<2;break;case 1:this.databuf[t]|=s>>4,t++,this.databuf[t]=(15&s)<<4;break;case 2:this.databuf[t]|=s>>2,t++,this.databuf[t]=(3&s)<<6;break;case 3:this.databuf[t]|=s,t++}}for(this.iLength=t,i=0;i<t;i++)this.databuf[i]=255&this.databuf[i]}}_GetNextString(){if(this.obs="",this.iOffset<0||this.iOffset+3>this.MAXDATALENGTH)return this.iErrorID=u.PTEID_OUTOFMEMORY,0;if(!this.bCompress&&this.databuf[this.iOffset++]!==u.PTDT_STRING)return this.iErrorID=u.PTEID_TYPEMISMATCH,0;if(this.obi=this.databuf[this.iOffset++],(this.obi<0||this.obi>256)&&(this.obi=0),this.obi>0){for(var i=new Uint8Array(this.obi),t=0;t<this.obi;t++)i[t]=this.databuf[this.iOffset+t];this.obs=f.gb2312a_to_utf8(i)}return this.iOffset+=this.obi,this.obi}DataToString(){return this.obs}str2UTF8(i){var t,s,e=new Array;t=i.length;for(var h=0;h<t;h++)(s=i.charCodeAt(h))>=65536&&s<=1114111?(e.push(s>>18&7|240),e.push(s>>12&63|128),e.push(s>>6&63|128),e.push(63&s|128)):s>=2048&&s<=65535?(e.push(s>>12&15|224),e.push(s>>6&63|128),e.push(63&s|128)):s>=128&&s<=2047?(e.push(s>>6&31|192),e.push(63&s|128)):e.push(255&s);return e}unicode_to_utf8(i,t){i<0&&(i=256+i),t<0&&(t=256+t);var s=i<<8|t,e="";return e+=s<128?String.fromCharCode(s):s<2048?String.fromCharCode(192+(s>>6),128+(63&s)):s<65536?String.fromCharCode(224+(s>>12),128+(s>>6&63),128+(63&s)):String.fromCharCode(240+(s>>18),128+(s>>12&63),128+(s>>6&63),128+(63&s))}StringToBuffer(i,t){for(var s=0;s<i.length;s++)t[s]=i.charCodeAt(s);return s}BufferToString(i,t){for(var s=new Int8Array(t),e=0;e<t;e++)s[e]=i[e];return this.byteToString(s)}byteToString(i){var t,s,e,h,a,n;for(t="",e=i.length,s=0;s<e;)switch((h=i[s++])>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:t+=String.fromCharCode(h);break;case 12:case 13:a=i[s++],t+=String.fromCharCode((31&h)<<6|63&a);break;case 14:a=i[s++],n=i[s++],t+=String.fromCharCode((15&h)<<12|(63&a)<<6|(63&n)<<0)}return t}InsertString(i){var t=f.utf8_to_gb2312a(i);if(this.iOffset<0||this.iOffset+t.length+2>this.MAXDATALENGTH)return this.iErrorID=u.PTEID_OUTOFMEMORY,0;var s=this.iOffset;this.bCompress||(this.databuf[this.iOffset++]=u.PTDT_STRING),this.databuf[this.iOffset++]=t.length;for(var e=0;e<t.length;e++)this.databuf[this.iOffset++]=t[e];return this.iOffset-s}GetNextString(){return this._GetNextString(),this.obs}InsertInt(i){if(this.iOffset<0||this.iOffset+5>this.MAXDATALENGTH)return this.iErrorID=u.PTEID_OUTOFMEMORY,0;var t=this.iOffset;return this.bCompress||(this.databuf[this.iOffset++]=u.PTDT_INT),this.databuf[this.iOffset++]=i>>24&255,this.databuf[this.iOffset++]=i>>16&255,this.databuf[this.iOffset++]=i>>8&255,this.databuf[this.iOffset++]=255&i,this.iOffset-t}GetNextInt(){if(this.iOffset<0||this.iOffset+3>this.MAXDATALENGTH)return this.iErrorID=u.PTEID_OUTOFMEMORY,0;if(!this.bCompress){if(this.databuf[this.iOffset]!=u.PTDT_INT)return this.iErrorID=u.PTEID_TYPEMISMATCH,0;this.iOffset++}return this.obi=this.databuf[this.iOffset]<<24|this.databuf[this.iOffset+1]<<16|this.databuf[this.iOffset+2]<<8|this.databuf[this.iOffset+3],this.obi>=2147483648&&(this.obi=this.obi-4294967296),this.iOffset+=4,this.obi}InsertByte(i){if(this.iOffset<0||this.iOffset+2>this.MAXDATALENGTH)return this.iErrorID=u.PTEID_OUTOFMEMORY,0;var t=this.iOffset;return this.bCompress||(this.databuf[this.iOffset++]=u.PTDT_BYTE),this.databuf[this.iOffset++]=255&i,this.iOffset-t}GetNextByte(){if(this.iOffset<0||this.iOffset+2>this.MAXDATALENGTH)return this.iErrorID=u.PTEID_OUTOFMEMORY,-1;if(!this.bCompress){if(this.databuf[this.iOffset]!=u.PTDT_BYTE)return this.iErrorID=u.PTEID_TYPEMISMATCH,-1;this.iOffset++}return this.obi=this.databuf[this.iOffset],this.obi>=128&&(this.obi=this.obi-256),this.iOffset++,this.obi}InsertShort(i){if(this.iOffset<0||this.iOffset+3>this.MAXDATALENGTH)return this.iErrorID=u.PTEID_OUTOFMEMORY,0;var t=this.iOffset;return this.bCompress||(this.databuf[this.iOffset++]=u.PTDT_SHORT),this.databuf[this.iOffset++]=i>>8&255,this.databuf[this.iOffset++]=255&i,this.iOffset-t}GetNextShort(){if(this.iOffset<0||this.iOffset+3>this.MAXDATALENGTH)return this.iErrorID=u.PTEID_OUTOFMEMORY,0;if(!this.bCompress){if(this.databuf[this.iOffset]!=u.PTDT_SHORT)return this.iErrorID=u.PTEID_TYPEMISMATCH,0;this.iOffset++}return this.obi=this.databuf[this.iOffset]<<8|this.databuf[this.iOffset+1],this.obi>=32768&&(this.obi=this.obi-65536),this.iOffset+=2,this.obi}InsertData(i,t){if(this.iOffset<0||this.iOffset+t+2>this.MAXDATALENGTH)return this.iErrorID=u.PTEID_OUTOFMEMORY,0;var s=this.iOffset;this.bCompress||(this.databuf[this.iOffset++]=u.PTDT_DATA),this.databuf[this.iOffset++]=t>>8&255,this.databuf[this.iOffset++]=255&t;for(var e=0;e<t;e++)this.databuf[this.iOffset++]=i[e];return this.iOffset-s}GetNextData(){if(this.iOffset<0||this.iOffset+3>this.MAXDATALENGTH)return this.iErrorID=u.PTEID_OUTOFMEMORY,0;if(!this.bCompress&&this.databuf[this.iOffset++]!=u.PTDT_DATA)return this.iErrorID=u.PTEID_TYPEMISMATCH,0;this.obi=this.databuf[this.iOffset]<<8|this.databuf[this.iOffset+1],this.iOffset+=2;for(var i=new Uint8Array(this.obi),t=0;t<this.obi;t++)this.obd[t]=this.databuf[this.iOffset+t],i[t]=this.databuf[this.iOffset+t];return this.obs=f.gb2312a_to_utf8(i),this.iOffset+=this.obi,this.obi}InsertFloat(i){if(this.iOffset<0||this.iOffset+5>this.MAXDATALENGTH)return this.iErrorID=u.PTEID_OUTOFMEMORY,0;var t=this.iOffset;this.bCompress||(this.databuf[this.iOffset++]=u.PTDT_FLOAT),this.pdataview.setFloat32(0,i,!0);for(var s=0;s<4;s++)this.databuf[this.iOffset++]=this.pdataview.getInt8(s);return this.iOffset-t}GetNextFloat(){if(this.iOffset<0||this.iOffset+5>this.MAXDATALENGTH)return this.iErrorID=u.PTEID_OUTOFMEMORY,0;if(!this.bCompress&&this.databuf[this.iOffset++]!=u.PTDT_FLOAT)return this.iErrorID=u.PTEID_TYPEMISMATCH,0;for(var i=0;i<4;i++)this.pdataview.setInt8(i,this.databuf[this.iOffset+i]);return this.obf=this.pdataview.getFloat32(0,!0),this.iOffset+=4,this.obf}InsertLong(i){if(this.iOffset<0||this.iOffset+5>this.MAXDATALENGTH)return this.iErrorID=u.PTEID_OUTOFMEMORY,0;var t,s=this.iOffset;this.bCompress||(this.databuf[this.iOffset++]=u.PTDT_LONG);for(var e=0;e<8;e++)t=i%256,this.databuf[this.iOffset+7-e]=t,i-=t,i/=256;return this.iOffset+=8,this.iOffset-s}GetNextLong(){if(this.iOffset<0||this.iOffset+3>this.MAXDATALENGTH)return this.iErrorID=u.PTEID_OUTOFMEMORY,0;if(!this.bCompress){if(this.databuf[this.iOffset]!=u.PTDT_LONG)return this.iErrorID=u.PTEID_TYPEMISMATCH,0;this.iOffset++}this.obi=0;var i,t=1;for(i=0;i<8;i++)this.obi+=this.databuf[this.iOffset+7-i]*t,t*=256;return this.iOffset+=8,this.obi}}u.PTEID_NON=0,u.PTEID_OUTOFMEMORY=1,u.PTEID_TYPEMISMATCH=2,u.PTDT_BYTE=1,u.PTDT_SHORT=2,u.PTDT_INT=3,u.PTDT_STRING=4,u.PTDT_DATA=5,u.PTDT_FLOAT=6,u.PTDT_LONG=7,u.pls=null,u.gi=function(){return null==u.pls&&(u.pls=new u),u.pls};class d{constructor(){this.iRid=-1,this.sResName="",this.iLoadStat=0}}class p{constructor(){this.iCp=0,this.iMx=0,this.iMy=0,this.iSw=0,this.iSh=0,this.iRa=0,this.bFlip=!1}}class m{constructor(){this.iFid=0,this.iDelay=0,this.iBlockCount=0,this.blocklist=null}}class g{constructor(){this.iAnimaId=0,this.sAnimaName="",this.iOx=0,this.iOy=0,this.iFrameCount=0,this.rect=[0,0,0,0],this.framelist=null}}class w{constructor(){this.iRp=0,this.iX=0,this.iY=0,this.iW=0,this.iH=0}}class S{constructor(){this.pm3f=c.gi(),this.iResCount=0,this.reslist=null,this.iAnimaCount=0,this.animalist=null,this.iCutCount=0,this.cutlist=null,this.pathname="",this.bLocal=null}LoadInitRes(i){var t,s=0;for(t=0;t<this.iResCount;t++){for(var e=0;e<i.length&&this.reslist[t].sResPath!=i[e];e++);if(e<i.length){if(_.iLoadingCount>=_.iMaxLoadThread)return s;-1==this.reslist[t].iRid?(this.reslist[t].iRid=c.gi().LoadImage(this.reslist[t].sResPath,this.bLocal),_.iLoadingCount++):null==c.gi().FindImage(this.reslist[t].iRid)?_.iLoadingCount++:s++}}return s}LoadRes(){var i;for(i=0;i<this.iResCount;i++){if(_.iLoadingCount>=_.iMaxLoadThread)return;-1==this.reslist[i].iRid?(this.reslist[i].iRid=c.gi().LoadImage(this.reslist[i].sResPath,this.bLocal),this.reslist[i].iLoadStat=1,_.iLoadingCount++):null==c.gi().FindImage(this.reslist[i].iRid)&&_.iLoadingCount++}}GetResLoadedCount(){var i,t=0;for(i=0;i<this.iResCount;i++)-1!=this.reslist[i].iRid&&null!=c.gi().FindImage(this.reslist[i].iRid)&&t++;return t}IsResLoadedFinish(){return this.GetResLoadedCount()==this.iResCount}LoadAnima_fullpath(i,t,s,e=null){return this.bLocal=s,this.pathname=i,S._PUT(this.pathname,this),this.GetAnimaData(this.pathname,this,0),this.load_finished=e,this.bLoadSuccess=!1,!0}GetAnimaData(i,t,s,e){if(null==e)return s>0&&bn.sop("retry "+s+","+i),void Laya.loader.load(bn.BASE_URL+i+"/xa.ax",Laya.Handler.create(t,t.GetAnimaData,[i,t,s+1]),null,Laya.Loader.BUFFER);var h=u.gi();h.GetData3(e),t._LoadAnima(i,h,t.bLocal),null!=this.load_finished&&this.load_finished(),this.bLoadSuccess=!0}_LoadAnima(i,t,s){var e,h,a;this.bLocal=s,this.pathname=i;var n,o,r,c,l,b,f=t.GetNextByte();for(t.GetNextByte(),this.iResCount=t.GetNextShort(),this.reslist=new Array(this.iResCount),e=0;e<this.iResCount;e++)this.reslist[e]=new d,this.reslist[e].iRid=t.GetNextShort(),this.reslist[e].sResName=t.GetNextString(),this.reslist[e].sResPath=this.pathname+"/"+this.reslist[e].sResName,this.reslist[e].iRid=-1,this.reslist[e].bNotUsed=!0;for(this.iAnimaCount=t.GetNextShort(),this.animalist=new Array(this.iAnimaCount),e=0;e<this.iAnimaCount;e++)for(this.animalist[e]=new g,this.animalist[e].iAnimaId=t.GetNextShort(),this.animalist[e].sAnimaName=t.GetNextString(),t.GetNextString(),this.animalist[e].iOx=t.GetNextShort(),this.animalist[e].iOy=t.GetNextShort(),t.GetNextShort(),t.GetNextShort(),this.animalist[e].iFrameCount=t.GetNextShort(),this.animalist[e].framelist=new Array(this.animalist[e].iFrameCount),h=0;h<this.animalist[e].iFrameCount;h++)for(this.animalist[e].framelist[h]=new m,this.animalist[e].framelist[h].iFid=t.GetNextShort(),this.animalist[e].framelist[h].iDelay=t.GetNextShort(),this.animalist[e].framelist[h].iBlockCount=t.GetNextShort(),this.animalist[e].framelist[h].blocklist=new Array(this.animalist[e].framelist[h].iBlockCount),a=0;a<this.animalist[e].framelist[h].iBlockCount;a++)this.animalist[e].framelist[h].blocklist[a]=new p,this.animalist[e].framelist[h].blocklist[a].iCp=t.GetNextShort(),10==f?(this.animalist[e].framelist[h].blocklist[a].iMx=t.GetNextShort(),this.animalist[e].framelist[h].blocklist[a].iMy=t.GetNextShort(),this.animalist[e].framelist[h].blocklist[a].iSw=t.GetNextShort(),this.animalist[e].framelist[h].blocklist[a].iSh=t.GetNextShort(),this.animalist[e].framelist[h].blocklist[a].iRa=t.GetNextShort(),this.animalist[e].framelist[h].blocklist[a].fAlpha=t.GetNextShort()/100,4096==(4096&this.animalist[e].framelist[h].blocklist[a].iRa)&&(this.animalist[e].framelist[h].blocklist[a].bFlip=!0,this.animalist[e].framelist[h].blocklist[a].iRa-=4096)):(this.animalist[e].framelist[h].blocklist[a].iMx=t.GetNextFloat(),this.animalist[e].framelist[h].blocklist[a].iMy=t.GetNextFloat(),this.animalist[e].framelist[h].blocklist[a].iSw=t.GetNextFloat(),this.animalist[e].framelist[h].blocklist[a].iSh=t.GetNextFloat(),this.animalist[e].framelist[h].blocklist[a].iRa=t.GetNextFloat(),this.animalist[e].framelist[h].blocklist[a].fAlpha=t.GetNextShort()/100,1==t.GetNextByte()&&(this.animalist[e].framelist[h].blocklist[a].bFlip=!0));for(this.iCutCount=t.GetNextShort(),this.cutlist=new Array(this.iCutCount),e=0;e<this.iCutCount;e++)this.cutlist[e]=new w,this.cutlist[e].iRp=t.GetNextShort(),this.cutlist[e].iX=t.GetNextShort(),this.cutlist[e].iY=t.GetNextShort(),this.cutlist[e].iW=t.GetNextShort(),this.cutlist[e].iH=t.GetNextShort();for(n=0;n<this.iAnimaCount;n++)for(this.animalist[n].rect[0]=99999999,this.animalist[n].rect[1]=99999999,this.animalist[n].rect[2]=-99999999,this.animalist[n].rect[3]=-99999999,e=0;e<this.animalist[n].iFrameCount;e++)for(h=0;h<this.animalist[n].framelist[e].iBlockCount;h++)o=this.animalist[n].framelist[e].blocklist[h].iCp,r=this.animalist[n].framelist[e].blocklist[h].iMx,c=this.animalist[n].framelist[e].blocklist[h].iMy,l=parseInt(.01*this.animalist[n].framelist[e].blocklist[h].iSw*this.cutlist[o].iW),b=parseInt(.01*this.animalist[n].framelist[e].blocklist[h].iSh*this.cutlist[o].iH),0==e&&0==h?this.animalist[n].rect[0]=r:r<this.animalist[n].rect[0]&&(this.animalist[n].rect[0]=r),0==e&&0==h?this.animalist[n].rect[2]=r+l:r+l>this.animalist[n].rect[2]&&(this.animalist[n].rect[2]=r+l),0==e&&0==h?this.animalist[n].rect[1]=c:c<this.animalist[n].rect[1]&&(this.animalist[n].rect[1]=c),0==e&&0==h?this.animalist[n].rect[3]=c+b:c+b>this.animalist[n].rect[3]&&(this.animalist[n].rect[3]=c+b);_.gi().PushAnima(this)}iAnimaX(i){return this.animalist[i.iAnimaPoint].rect[0]}iAnimaY(i){return this.animalist[i.iAnimaPoint].rect[1]}iAnimaH(i){return this.animalist[i.iAnimaPoint].rect[3]-this.animalist[i.iAnimaPoint].rect[1]}iAnimaW(i){return this.animalist[i.iAnimaPoint].rect[2]-this.animalist[i.iAnimaPoint].rect[0]}InitAnimaWithName(i,t){var s;for(null==this.aaa&&(this.aaa=new l),this.aaa.iAnimaPoint=-1,this.aaa.pani=this,s=0;s<this.iAnimaCount;s++)if(this.animalist[s].sAnimaName==i)return this.aaa.iAnimaPoint=s,this.aaa.iFrame=0,this.aaa.iDelay=0,this.aaa.iRect[0]=this.animalist[s].rect[0],this.aaa.iRect[1]=this.animalist[s].rect[1],this.aaa.iRect[2]=this.animalist[s].rect[2],this.aaa.iRect[3]=this.animalist[s].rect[3],null==t&&(t=new l),t.copyfrom(this.aaa),t;return this.aaa.iDelay=-1,bn.sop("cant find anima "+i+" from "+this.pathname),null==t&&(t=new l),t.pani=this,this.aaa}DrawAnima(i,t,s,e){"object"!=typeof s?(null==this.aaa&&(this.aaa=new l),this.InitAnimaWithName(s),this.DrawAnimaEx_ByOffset(i,t,this.aaa.iAnimaPoint,e,101,1,1,0,0,0)):this.DrawAnimaEx_ByOffset(i,t,s.iAnimaPoint,s.iFrame,101,1,1,0,0,0)}DrawAnima_aa(i,t,s,e){"string"!=typeof s?"number"!=typeof s?this.DrawAnimaEx_ByOffset(i,t,s.iAnimaPoint,s.iFrame,101,1,1,0,0,0):this.DrawAnimaEx_ByOffset(i,t,s,e,101,1,1,0,0,0):this.DrawAnima(i,t,s,e)}DrawAnimaEx(i,t,s,e,h,a,n,o,r,c){"object"!=typeof s?(null==this.aaa&&(this.aaa=new l),this.InitAnimaWithName(s),this.DrawAnimaEx_ByOffset(i,t,this.aaa.iAnimaPoint,e,h,a,n,o,r,c)):this.DrawAnimaEx_ByOffset(i,t,s.iAnimaPoint,s.iFrame,e,h,a,n,o,r)}DrawAnimaEx_ByName(i,t,s,e,h,a,n,o,r,c,b){null==this.aaa&&(this.aaa=new l),this.InitAnimaWithName(s),this.DrawAnimaEx_ByOffset(i,t,this.aaa.iAnimaPoint,e,h,a,n,o,r,c,b)}DrawAnimaEx_ByOffset(i,t,s,e,h,a,n,o,r,l,b){var _,f,u,d,p,m,g,w;if(e=parseInt(e),b=b||!1,4096==(4096&o)&&(b=!b,o-=4096),!(s<0||s>this.iAnimaCount||e<0||this.animalist[s].iFrameCount<=0))for(e%=this.animalist[s].iFrameCount,_=0;_<this.animalist[s].framelist[e].iBlockCount;_++)f=this.animalist[s].framelist[e].blocklist[_].iCp,w=b,this.animalist[s].framelist[e].blocklist[_].bFlip&&(w=!w),p=.01*this.animalist[s].framelist[e].blocklist[_].iSw*a,m=.01*this.animalist[s].framelist[e].blocklist[_].iSh*n,u=-2==r?i+this.animalist[s].framelist[e].blocklist[_].iMx:(i+this.animalist[s].framelist[e].blocklist[_].iMx+(w?1:0)*this.cutlist[f].iW)/p,d=-2==l?t+this.animalist[s].framelist[e].blocklist[_].iMy:(t+this.animalist[s].framelist[e].blocklist[_].iMy)/m,w&&(u=-u),g=this.animalist[s].framelist[e].blocklist[_].iRa+o,-1!=this.reslist[this.cutlist[f].iRp].iRid?(c.gi()._DrawImageEx(u,d,this.reslist[this.cutlist[f].iRp].iRid,this.cutlist[f].iX,this.cutlist[f].iY,this.cutlist[f].iW,this.cutlist[f].iH,h*this.animalist[s].framelist[e].blocklist[_].fAlpha,p,m,g,0==g||r>0?r:-2,0==g||l>0?l:-2,w),this.reslist[this.cutlist[f].iRp].bNotUsed&&(this.reslist[this.cutlist[f].iRp].bNotUsed=!1)):this.reslist[this.cutlist[f].iRp].iRid=c.gi().LoadImage(this.reslist[this.cutlist[f].iRp].sResPath,this.bLocal)}bInAnima(i,t,s,e,h){if(null==i)return!1;if(i.iAnimaPoint<0||i.iAnimaPoint>=this.iAnimaCount)return!1;var a=this.animalist[i.iAnimaPoint].rect[0],n=this.animalist[i.iAnimaPoint].rect[1],o=this.animalist[i.iAnimaPoint].rect[2],r=this.animalist[i.iAnimaPoint].rect[3];return e>t+a&&e<t+o&&h>s+n&&h<s+r}RotationVertex_2D2(i,t,s,e,h){var a,n,o,r;o=t-e,0==(n=i-s)&&(n=1e-7),r=Math.atan(o/n),n<0&&(r+=Math.PI),r+=Math.PI*h/180,a=Math.sqrt(n*n+o*o),this.rdx=Math.cos(r)*a+s,this.rdy=Math.sin(r)*a+e}NextFrame(i){return i.iDelay++,!(i.iAnimaPoint<0||i.iAnimaPoint>=this.iAnimaCount)&&((i.iFrame<0||i.iFrame>=this.animalist[i.iAnimaPoint].iFrameCount)&&(i.iFrame=0,i.iDelay=0),0!=this.animalist[i.iAnimaPoint].iFrameCount&&(i.iDelay>this.animalist[i.iAnimaPoint].framelist[i.iFrame].iDelay&&(i.iDelay=0,i.iFrame++,i.iFrame>=this.animalist[i.iAnimaPoint].iFrameCount)&&(i.iFrame=0,!0)))}SetFrame(i,t){var s,e,h,a=0,n=this.animalist[i.iAnimaPoint];for(s=0;s<n.iFrameCount;s++)a+=n.framelist[s].iDelay+1;if(0!=a)for(e=t%a,h=0,s=0;s<n.iFrameCount;s++)if((h+=n.framelist[s].iDelay+1)>=e)return void(i.iFrame=s)}}S._ALL=new Array,S._GET=function(i){for(var t=0;t<S._ALL.length;t++)if(S._ALL[t].fn==i)return S._ALL[t].ani;return null},S._PUT=function(i,t){var s=S._ALL.length;S._ALL[s]=new Object,S._ALL[s].fn=i,S._ALL[s].ani=t};class D{constructor(i){this.pani=i,this.pm3f=c.gi(),this.bSingleButton=!1,this.bCheckByRect=!1,this.bCheckByRect1=!1,this.ReleaseButton(),this.sName="",this.iNameColor=4294967295,this.Move(0,0,100,100),this.iFingerLocker=-1,this.iNameSize=-1}SetCheckRect(i,t,s,e){this.bCheckByRect1=!0,this.iCheckX=i,this.iCheckY=t,this.iCheckW=s,this.iCheckH=e}InitButton(i){null!=this.pani&&(this.pani.InitAnimaWithName(i,gn.aaa),gn.aaa.iFrame=0,this.SetAnimaNormal(gn.aaa,!1),gn.aaa.iFrame=1,this.SetAnimaMouseon(gn.aaa,!1),this.SetAnimaMousedown(gn.aaa,!1),gn.aaa.iFrame=0,this.SetAnimaDisable(gn.aaa,!1))}ReleaseButton(){this.aa_normal=null,this.act_normal=!1,this.aa_mouseon=null,this.act_mouseon=!1,this.aa_mousedown=null,this.act_mousedown=!1,this.bMouseIn=!1,this.bMouseDown=!1,this.bVisible=!0,this.bDisable=!1,this.iX=0,this.iY=0}SetAnimaNormal(i,t){null==this.aa_normal&&(this.aa_normal=new l),this.aa_normal.copyfrom(i),this.act_normal=t}SetAnimaMouseon(i,t){null==this.aa_mouseon&&(this.aa_mouseon=new l),this.aa_mouseon.copyfrom(i),this.act_mouseon=t}SetAnimaMousedown(i,t){null==this.aa_mousedown&&(this.aa_mousedown=new l),this.aa_mousedown.copyfrom(i),this.act_mousedown=t}SetAnimaDisable(i,t){null==this.aa_disable&&(this.aa_disable=new l),this.aa_disable.copyfrom(i),this.act_disable=t}Move(i,t,s,e){this.iX=i,this.iY=t,this.iW=s,this.iH=e}ProcTouch(i,t,s){if(-1!=this.iFingerLocker&&this.iFingerLocker!=Gh.iFingerId)return!1;if(!this.bVisible)return!1;if(this.bDisable)return!1;if(3==i&&(this.iFingerLocker=-1),!this.bMoveIn(t,s))return this.iFingerLocker=-1,this.bMouseDown=!1,!1;switch(i){case 1:this.iFingerLocker=Gh.iFingerId,this.bMouseDown=!0;break;case 2:break;case 3:this.bMouseDown&&(this.bMouseDown=!1,this.bChecked=!0),this.iFingerLocker=-1}return!0}bCheck(){return!!this.bChecked&&(this.bChecked=!1,!0)}bMoveIn(i,t){return this.bMouseIn=!1,this.bCheckByRect1?i>=this.iCheckX&&i<=this.iCheckX+this.iCheckW&&t>=this.iCheckY&&t<=this.iCheckY+this.iCheckH?this.bMouseIn=!0:this.bMouseIn=!1:this.bSingleButton||this.bCheckByRect?i>=this.iX&&i<=this.iX+this.iW&&t>=this.iY&&t<=this.iY+this.iH?this.bMouseIn=!0:this.bMouseIn=!1:this.pani.bInAnima(this.aa_normal,this.iX,this.iY,i,t)?this.bMouseIn=!0:this.bMouseIn=!1,this.bMouseIn}Draw(){if(null!=this.pani&&this.bVisible){for(;fn.gi().bInBound(this.iX,this.iY,this.iW,this.iH);)this.iX--;var i,t;if(this.bDisable?this.bSingleButton?this.pm3f.FillRect_2D(this.iX,this.iY,this.iX+this.iW,this.iY+this.iH,3238002687):this.pani.DrawAnima_aa(this.iX,this.iY,this.aa_disable):this.bMouseIn?this.bMouseDown?this.bSingleButton?(this.pm3f.FillRect_2D(this.iX,this.iY,this.iX+this.iW,this.iY+this.iH,2164260863),this.pm3f.DrawRect_2D(this.iX,this.iY,this.iX+this.iW,this.iY+this.iH,4294967295)):this.pani.DrawAnima_aa(this.iX,this.iY,this.aa_mousedown):this.bSingleButton?(this.pm3f.FillRect_2D(this.iX,this.iY,this.iX+this.iW,this.iY+this.iH,1090519039),this.pm3f.DrawRect_2D(this.iX,this.iY,this.iX+this.iW,this.iY+this.iH,4294967295)):this.pani.DrawAnima_aa(this.iX,this.iY,this.aa_normal):this.bSingleButton?this.pm3f.FillRect_2D(this.iX,this.iY,this.iX+this.iW,this.iY+this.iH,553648127):this.pani.DrawAnima_aa(this.iX,this.iY,this.aa_normal),this.bMouseDown?(i=2,t=2):(i=0,t=-2),this.bSingleButton||this.sName.length>0){var s=this.iNameColor;this.bDisable&&(s=4286611584),this.iNameSize>0?this.pm3f.DrawTextEx(this.iX+this.iW/2,this.iY+this.iH/2,this.sName,s,this.iNameSize,101,1,1,0,-2,-2):this.iH<=30?this.pm3f.DrawTextEx(this.iX+this.iW/2+i,this.iY+this.iH/2+t,this.sName,s,20,101,1,1,0,-2,-2):this.iH<=40?this.pm3f.DrawTextEx(this.iX+this.iW/2+i,this.iY+this.iH/2+t,this.sName,s,28,101,1,1,0,-2,-2):this.pm3f.DrawTextEx(this.iX+this.iW/2+i,this.iY+this.iH/2+t,this.sName,s,30,101,1,1,0,-2,-2)}}}}class T{constructor(i){this.pani=i,this.pm3f=i.pm3f,this.bTrue=!1,this.sDetail="",this.bInited=!1}InitBox(i){this.pani.InitAnimaWithName(i,gn.aaa),this.aa_true=new l,this.aa_false=new l,gn.aaa.iFrame=0,this.aa_true.copyfrom(gn.aaa),gn.aaa.iFrame=1,this.aa_false.copyfrom(gn.aaa),this.bInited=!0}Move(i,t,s,e){this.iX=i,this.iY=t,this.iW=s,this.iH=e}Draw(){this.bInited?this.bTrue?this.pani.DrawAnima_aa(this.iX,this.iY,this.aa_true):this.pani.DrawAnima_aa(this.iX,this.iY,this.aa_false):(this.pm3f.DrawRect_2D(this.iX,this.iY,this.iX+this.iW,this.iY+this.iH,4294967295),this.bTrue&&this.pm3f.FillRect_2D(this.iX+2,this.iY+2,this.iX+this.iW-4,this.iY+this.iH-4,4294967295)),this.pm3f.DrawTextEx(this.iX+this.iW+3,this.iY+(this.iH-30)/2,this.sDetail,4278206039,30,101,1,1,0,0,0)}ProcTouch(i,t,s){if(this.bInited){if(this.pani.bInAnima(this.aa_true,this.iX,this.iY,t,s))return i==Gh.TOUCH_UP&&(this.bTrue=!this.bTrue),!0}else if(bn.bInRect(t,s,this.iX,this.iY,this.iW+30*this.sDetail.length,this.iH))return i==Gh.TOUCH_UP&&(this.bTrue=!this.bTrue),!0;return!1}checkStatus(){return this.bTrue}}class C{constructor(){this.x=0,this.y=0,this.z=0}copyfrom(i){x=i.x,y=i.y,z=i.z}toString(){return"x="+x+",y="+y+",z="+z}To(i,t,s){x=i,y=t,z=s}Move(i){x+=i.x,y+=i.y,z+=i.z}Move(i,t,s){x+=i,y+=t,z+=s}scale(i){x*=i,y*=i,z*=i}Rotate(i,t){var s,e;switch(t=t*Math.PI/180,i){case"0":case"x":case"X":s=Math.sqrt(y*y+z*z),0==y&&(y=1e-7),e=Math.atan(z/y),y<0&&(e+=Math.PI),e+=t,z=Math.sin(e)*s,y=Math.cos(e)*s;break;case"1":case"y":case"Y":s=Math.sqrt(z*z+x*x),0==x&&(x=1e-7),e=Math.atan(z/x),x<0&&(e+=Math.PI),e+=t,z=Math.sin(e)*s,x=Math.cos(e)*s;break;case"2":case"z":case"Z":s=Math.sqrt(y*y+x*x),0==x&&(x=1e-7),e=Math.atan(y/x),x<0&&(e+=Math.PI),e+=t,y=Math.sin(e)*s,x=Math.cos(e)*s}}LengthTo(i){return Math.sqrt((i.x-x)*(i.x-x)+(i.y-y)*(i.y-y)+(i.z-z)*(i.z-z))}LengthTo(i,t,s){return Math.sqrt((i-x)*(i-x)+(t-y)*(t-y)+(s-z)*(s-z))}}class k{constructor(){this.vTmpVertex=new C}GetLineEquation(i,t,s){return t.x==s.x?(i.bFixedx=!0,i.x=t.x):i.bFixedx=!1,t.y==s.y?(i.bFixedy=!0,i.y=t.y):i.bFixedy=!1,t.z==s.z?(i.bFixedz=!0,i.z=t.z):i.bFixedz=!1,i.bFixedy?i.a=9999999:i.a=(t.x-s.x)/(t.y-s.y),i.b=t.x-i.a*t.y,i.bFixedz?i.c=9999999:i.c=(t.y-s.y)/(t.z-s.z),i.d=t.y-i.c*t.z,!0}GetVertexInLine(i,t,s,e){switch(s){case 0:case"x":case"X":if(t.bFixedx)return!1;i.x=e,i.y=(i.x-t.b)/t.a,i.z=(i.y-t.d)/t.c;break;case 1:case"y":case"Y":if(t.bFixedy)return!1;i.y=e,i.x=t.a*i.y+t.b,i.z=(i.y-t.d)/t.c;break;case 2:case"z":case"Z":if(t.bFixedz)return!1;i.z=e,i.y=t.c*i.z+t.d,i.x=t.a*i.y+t.b}return t.bFixedx&&(i.x=t.x),t.bFixedy&&(i.y=t.y),t.bFixedz&&(i.z=t.z),!0}GetLineIntersect(i,t,s){return t.bFixedx?this.GetVertexInLine(i,s,"x",t.x):t.bFixedy?this.GetVertexInLine(i,s,"y",t.y):t.bFixedz?this.GetVertexInLine(i,s,"z",t.z):s.bFixedx?this.GetVertexInLine(i,t,"x",s.x):s.bFixedy?this.GetVertexInLine(i,t,"y",s.y):s.bFixedz?this.GetVertexInLine(i,t,"z",s.z):(i.y=(s.b-t.b)/(t.a-s.a),i.x=t.a+i.y+t.b,i.z=(i.y-t.d)/t.c,!0)}InsertValue(i,t,s,e,h){i.x=t.x+(s.x-t.x)*e/h,i.y=t.y+(s.y-t.y)*e/h,i.z=t.z+(s.z-t.z)*e/h}GetAngleZ(i,t){var s;return this.vTmpVertex.x=i.x-t.x,this.vTmpVertex.y=i.y-t.y,this.vTmpVertex.z=i.z-t.z,s=Math.atan(this.vTmpVertex.y/this.vTmpVertex.x),this.vTmpVertex.x<0&&(s+=k.PI),s}GetVertexDistance(i,t){return Math.sqrt((i.x-t.x)*(i.x-t.x)+(i.y-t.y)*(i.y-t.y)+(i.z-t.z)*(i.z-t.z))}RotationAngle(i,t,s){for(var e;t>2*k.PI;)t-=2*k.PI;for(;t<0;)t+=2*k.PI;for(;s>2*k.PI;)s-=2*k.PI;for(;s<0;)s+=2*k.PI;return t>s?(e=t-s)<k.PI?e<i?-e:-i:2*k.PI-e<i?e:i:(e=s-t)<k.PI?e<i?e:i:2*k.PI-e<i?-e:-i}RotationVertex_2D(i,t,s){var e,h,a,n;h=i.x-t.x,a=i.y-t.y,0==h&&(h=1e-7),n=Math.atan(a/h),h<0&&(n+=k.PI),n+=k.PI*s/180,e=Math.sqrt(h*h+a*a),i.x=Math.cos(n)*e+t.x,i.y=Math.sin(n)*e+t.y}GetAngleXY(i,t){var s,e,h;return s=i.x-t.x,e=i.y-t.y,0==s&&(s=1e-7),h=Math.atan(e/s),s<0&&(h+=k.PI),180*h/k.PI}GetAngleXY(i,t,s,e){var h,a,n;return a=t-e,0==(h=i-s)&&(h=1e-7),n=Math.atan(a/h),h<0&&(n+=k.PI),180*n/k.PI}}k.PI=3.1415926,k.m=new k,k.GetAngleXZ=function(i,t){var s,e,h;return s=i.x-t.x,e=i.z-t.z,0==s&&(s=1e-7),h=Math.atan(e/s),s<0&&(h+=k.PI),h<0&&(h+=2*k.PI),180*h/k.PI},k.GetAngleY=function(i,t){var s;return 0==(s=i.LengthTo(t))&&(s=1e-7),180*Math.asin((i.y-t.y)/s)/k.PI},k.xmax=function(i,t){return i>t?i:t},k.xmin=function(i,t){return i<t?i:t},k.intersect=function(i,t,s,e,h,a,n,o){return(i>s?i:s)>=(h<n?h:n)&&(h>n?h:n)>=(i<s?i:s)&&(t>e?t:e)>=(a<o?a:o)&&(a>o?a:o)>=(t<e?t:e)&&k.multiply(h,a,s,e,i,t)*k.multiply(s,e,n,o,i,t)>=0&&k.multiply(i,t,n,o,h,a)*k.multiply(n,o,s,e,h,a)>=0},k.multiply=function(i,t,s,e,h,a){return(i-h)*(e-a)-(s-h)*(t-a)};class A{constructor(){this.sName="",this.aa=new l}}class I{constructor(i){this.iPathCount=i,this.path=new Array(i);for(var t=0;t<i;t++)this.path[t]=new Int32Array(2)}}class P{constructor(){this.pps=new I(P.MAXPATHCOUNT)}InitCutLevel(){var i,t,s;for(this.cutlevel=null,this.animalevel=null,this.cutlevel=new Array(3),this.animalevel=new Array(3),i=0;i<3;i++)for(this.cutlevel[i]=new Array(this.iBCH),this.animalevel[i]=new A(256),t=0;t<this.iBCH;t++)for(this.cutlevel[i][t]=new Array(this.iBCW),s=0;s<this.iBCW;s++)this.cutlevel[i][t][s]=new Int16Array(2);for(i=0;i<3;i++){for(t=0;t<this.iBCH;t++)for(s=0;s<this.iBCW;s++)this.cutlevel[i][t][s][0]=-1;for(t=0;t<256;t++)this.animalevel[i][t]=null}for(i=0;i<P.MAXPATHCOUNT;i++)this.pps[i]=null}bCanMove(i,t,s,e){var h,a;for(h=0;h<P.MAXPATHCOUNT;h++)if(null!=this.pps[h])for(a=1;a<this.pps[h].iPathCount;a++)if(P.llcollision_ai(i,t,s,e,this.pps[h].path[a-1][0],this.pps[h].path[a-1][1],this.pps[h].path[a][0],this.pps[h].path[a][1]))return!1;return!0}}P.bInNumber=function(i,t,s){if(t<s){if(t<=i&&i<=s)return!0}else if(t>=i&&i>=s)return!0;return!1},P.lJx,P.lJy,P.iJx,P.iJy,P.fJx,P.fJy,P.iD1,P.iD2,P.llcollision_ext=function(i,t,s,e,h,a,n,o){var r,c,l,b;if(c=1*t-(r=i==s?0:t==e?0:1*(e-t)/(s-i))*i,b=1*a-(l=h==n?0:a==o?0:1*(o-a)/(n-h))*h,i==s){if(h==n)return i==h&&(P.fJx=i,t>=a&&t<=o||t>=o&&t<=a?(P.fJy=t,!0):e>=a&&e<=o||e>=o&&e<=a?(P.fJy=e,!0):a>=t&&a<=e||a>=t&&a<=e?(P.fJy=a,!0):(o>=t&&o<=e||o>=t&&o<=e)&&(P.fJy=o,!0));P.fJx=i,P.fJy=l*P.fJx+b}else h==n?(P.fJx=h,P.fJy=r*P.fJx+c):(P.fJx=-(c-b)/(r-l),P.fJy=r*P.fJx+c);return!(P.fJx<i&&P.fJx<s)&&(!(P.fJx<h&&P.fJx<n)&&(!(P.fJx>i&&P.fJx>s)&&(!(P.fJx>h&&P.fJx>n)&&(!(P.fJy<t&&P.fJy<e)&&(!(P.fJy<a&&P.fJy<o)&&(!(P.fJy>t&&P.fJy>e)&&!(P.fJy>a&&P.fJy>o)))))))},P.llcollision_ai=function(i,t,s,e,h,a,n,o){if(!k.intersect(i,t,s,e,h,a,n,o))return!1;var r=1*((h-i)*(o-t)-(a-t)*(n-i))/((i-n)*(e-o)-(t-o)*(s-n)-((i-h)*(e-a)-(t-a)*(s-h)));return P.iJx=parseInt(r*(s-i)+i),P.iJy=parseInt(r*(e-t)+t),!0},P.llcollision_ai1=function(i,t,s,e,h,a,n,o){var r=(i-h)*(e-a)-(t-a)*(s-h),c=(i-n)*(e-o)-(t-o)*(s-n);if(r>0&&c>0||r<0&&c<0)return!1;var l=(h-i)*(o-t)-(a-t)*(n-i),b=l+r-c;if(l>0&&b>0||l<0&&b<0)return!1;var _=1*l/(c-r);return P.iJx=parseInt(_*(s-i)+i),P.iJy=parseInt(_*(e-t)+t),!0},P.llcollision=function(i,t,s,e,h,a,n,o){var r=llcollision_ext(i,t,s,e,h,a,n,o);return r&&(P.iJx=parseInt(P.fJx),P.iJy=parseInt(P.fJy)),r},P.llcollision_=function(i,t,s,e,h,a,n,o){var r,c,l;if(i==s)return h==n?!(i!=h||!bInNumber(t,a,o)&&!bInNumber(e,a,o))&&(P.lJx=i,P.lJy=t,!0):a==o?!(!P.bInNumber(i,h,n)||!P.bInNumber(a,t,e))&&(P.lJx=i,P.lJy=a,!0):!!P.bInNumber(i,h,n)&&(c=((r=i)-h)*(a-o)/(h-n)+a,!!bInNumber(c,t,e)&&(!!bInNumber(c,a,o)&&(P.lJx=i,P.lJy=c,!0)));if(h==n)return t==e?!(!P.bInNumber(h,i,s)||!P.bInNumber(t,a,o))&&(P.lJx=h,P.lJy=t,!0):!!P.bInNumber(h,i,s)&&(c=((r=h)-i)*(t-e)/(i-s)+t,!!P.bInNumber(c,t,e)&&(!!P.bInNumber(c,a,o)&&(P.lJx=h,P.lJy=c,!0)));if(t==e)return a==o?!(t!=a||(P.lJx=i,!P.bInNumber(i,h,n)&&!P.bInNumber(s,h,n)))&&(P.lJy=t,!0):!!P.bInNumber(t,a,o)&&(r=((c=t)-a)*(h-n)/(a-o)+h,!!P.bInNumber(r,i,s)&&(!!P.bInNumber(r,h,n)&&(lJx=r,lJy=t,!0)));if(a==o)return!!P.bInNumber(a,t,e)&&(r=((c=a)-t)*(i-s)/(t-e)+i,!!P.bInNumber(r,i,s)&&(!!P.bInNumber(r,h,n)&&(P.lJx=r,P.lJy=a,!0)));if(0==(l=(t-e)*(h-n)-(a-o)*(i-s)))return(t-a)*(i-s)*(h-n)+h*(a-o)*(i-s)-i*(t-e)*(h-n)==0&&(!!P.bInNumber(i,h,n)&&(P.lJx=i,P.lJy=t,!0));return!((r=-((t-a)*(i-s)*(h-n)-i*(t-e)*(h-n)+h*(a-o)*(i-s))/l)>i+20&&r>s+20||r<i-20&&r<s-20)&&(!(r>h+20&&r>n+20||r<h-20&&r<n-20)&&(!((c=((t-a)*(i-s)*(h-n)-i*(t-e)*(h-n)+h*(a-o)*(i-s)+i*l)*(e-t)/(l*(i-s))+t)>t+20&&c>e+20||c<t-20&&c<e-20)&&(!(c>a+20&&c>o+20||c<a-20&&c<o-20)&&(P.lJx=r,P.lJy=c,!0))))},P.MAXPATHCOUNT=128;class N{constructor(){}}N.WeapFlag=function(i){var t,s;if(null==N._WEAPSORT)for(N._WEAPSORT=new Int32Array(512),t=0;t<3;t++)for(s=0;s<10;s++)N._WEAPSORT[N._WEAPID[t][s]]=s;return N._WEAPSORT[i]},N._WEAPSORT=null,N._WEAPID=[[9,47,48,49,50,51,52,248,290,291],[1,53,54,55,56,57,58,249,292,293],[10,59,60,61,62,63,64,250,294,295]],N._CHANGECOLOR=[["头发","衣服","裙子","鞋子"],["头发","上身","下身"],["头发","衣服","手腕","鞋子","尾巴"],["头发","上身","下身","肩甲"],["头发","袖子","裙子","鞋子"],["头发","衣服","盔甲","头饰","披风"]],N._CHANGECOLORCOST=[[10,8,8,4],[10,10,10],[8,8,4,4,6],[6,10,6,8],[8,6,12,4],[6,6,10,4,4]],N._ANIMASORT_MOUNT=[[[[["前","人前","后","人后","武器"],["武器","人右","身体","人左"],["武器","人右","身体","人左","左翅膀"],["武器","人右","身体","人左","左翅膀"],["后","人","武器","前"],["人左","身体","人右","右翅膀","武器"],["人左","身体","人右","右翅膀","武器"],["人左","身体","人右","武器"]],[["前","人前","后","人后","武器"],["武器","人右","身体","人左"],["武器","人右","身体","人左","左翅膀"],["武器","人右","身体","人左","左翅膀"],["后","人","武器","前"],["人左","身体","人右","右翅膀","武器"],["人左","身体","人右","右翅膀","武器"],["人左","身体","人右","武器"]]],[[["前","人前","后","人后","武器","飘带"],["武器","右翅膀","人右","身体","人左","左翅膀"],["武器","右翅膀","人右","身体","人左","左翅膀"],["武器","右翅膀","人右","身体","人左","左翅膀"],["后","人","武器","前"],["左翅膀","人左","身体","人右","右翅膀","武器"],["左翅膀","人左","身体","人右","右翅膀","武器"],["左翅膀","人左","身体","人右","右翅膀","武器"]],[["前","人前","后","人后","武器","飘带"],["武器","右翅膀","人右","身体","人左","左翅膀"],["武器","右翅膀","人右","身体","人左","左翅膀"],["武器","右翅膀","人右","身体","人左","左翅膀"],["后","人","武器","前"],["左翅膀","人左","身体","人右","右翅膀","武器"],["左翅膀","人左","身体","人右","右翅膀","武器"],["左翅膀","人左","身体","人右","右翅膀","武器"]]],[[["前","人前","后","人后","武器","飘带"],["武器","右翅膀","人右","身体","人左","左翅膀"],["武器","右翅膀","人右","身体","人左","左翅膀"],["武器","右翅膀","人右","身体","人左","左翅膀"],["后","人","武器","前"],["左翅膀","人左","身体","人右","右翅膀","武器"],["左翅膀","人左","身体","人右","右翅膀","武器"],["左翅膀","人左","身体","人右","右翅膀","武器"]],[["前","人前","后","人后","武器","飘带"],["武器","右翅膀","人右","身体","人左","左翅膀"],["武器","右翅膀","人右","身体","人左","左翅膀"],["武器","右翅膀","人右","身体","人左","左翅膀"],["后","人","武器","前"],["左翅膀","人左","身体","人右","右翅膀","武器"],["左翅膀","人左","身体","人右","右翅膀","武器"],["左翅膀","人左","身体","人右","右翅膀","武器"]]]],[[[["前","人前","后","人后","武器"],["武器","人右","身体","人左"],["武器","人右","身体","人左"],["武器","人右","身体","人左"],["后","人","武器","前"],["人左","身体","人右","武器"],["人左","身体","人右","武器"],["人左","身体","人右","武器"]],[["前","人前","后","人后","武器"],["武器","人右","身体","人左"],["武器","人右","身体","人左"],["武器","人右","身体","人左"],["后","人","武器","前"],["人左","身体","人右","武器"],["人左","身体","人右","武器"],["人左","身体","人右","武器"]]],[[["前","人前","后","人后","武器","飘带"],["武器","右翅膀","人右","身体","人左","左翅膀"],["武器","右翅膀","人右","身体","人左","左翅膀"],["武器","右翅膀","人右","身体","人左","左翅膀"],["后","人","武器","前"],["左翅膀","人左","身体","人右","右翅膀","武器"],["左翅膀","人左","身体","人右","右翅膀","武器"],["左翅膀","人左","身体","人右","右翅膀","武器"]],[["前","人前","后","人后","武器","飘带"],["武器","右翅膀","人右","身体","人左","左翅膀"],["武器","右翅膀","人右","身体","人左","左翅膀"],["武器","右翅膀","人右","身体","人左","左翅膀"],["后","人","武器","前"],["左翅膀","人左","身体","人右","右翅膀","武器"],["左翅膀","人左","身体","人右","右翅膀","武器"],["左翅膀","人左","身体","人右","右翅膀","武器"]]],[[["前","人前","后","人后","武器","飘带"],["武器","右翅膀","人右","身体","人左","左翅膀"],["武器","右翅膀","人右","身体","人左","左翅膀"],["武器","右翅膀","人右","身体","人左","左翅膀"],["后","人","武器","前"],["左翅膀","人左","身体","人右","右翅膀","武器"],["左翅膀","人左","身体","人右","右翅膀","武器"],["左翅膀","人左","身体","人右","右翅膀","武器"]],[["前","人前","后","人后","武器","飘带"],["武器","右翅膀","人右","身体","人左","左翅膀"],["武器","右翅膀","人右","身体","人左","左翅膀"],["武器","右翅膀","人右","身体","人左","左翅膀"],["后","人","武器","前"],["左翅膀","人左","身体","人右","右翅膀","武器"],["左翅膀","人左","身体","人右","右翅膀","武器"],["左翅膀","人左","身体","人右","右翅膀","武器"]]]],[[[["前","人前","后","人后","武器"],["武器","人右","身体","人左"],["武器","人右","身体","人左"],["武器","人右","身体","人左"],["后","人","武器","前"],["人左","身体","人右","武器"],["人左","身体","人右","武器"],["人左","身体","人右","武器"]],[["前","人前","后","人后","武器"],["武器","人右","身体","人左"],["武器","人右","身体","人左"],["武器","人右","身体","人左"],["后","人","武器","前"],["人左","身体","人右","武器"],["人左","身体","人右","武器"],["人左","身体","人右","武器"]]],[[["前","人前","后","人后","武器"],["武器","右翅膀","人右","身体","人左","左翅膀"],["武器","右翅膀","人右","身体","人左","左翅膀"],["武器","右翅膀","人右","身体","人左","左翅膀"],["后","人","武器","前"],["左翅膀","人左","身体","人右","右翅膀","武器"],["左翅膀","人左","身体","人右","右翅膀","武器"],["左翅膀","人左","身体","人右","右翅膀","武器"]],[["前","人前","后","人后","武器"],["武器","右翅膀","人右","身体","人左","左翅膀"],["武器","右翅膀","人右","身体","人左","左翅膀"],["武器","右翅膀","人右","身体","人左","左翅膀"],["后","人","武器","前"],["左翅膀","人左","身体","人右","右翅膀","武器"],["左翅膀","人左","身体","人右","右翅膀","武器"],["左翅膀","人左","身体","人右","右翅膀","武器"]]],[[["前","人前","后","人后","武器"],["武器","右翅膀","人右","身体","人左","左翅膀"],["武器","右翅膀","人右","身体","人左","左翅膀"],["武器","右翅膀","人右","身体","人左","左翅膀"],["后","人","武器","前"],["左翅膀","人左","身体","人右","右翅膀","武器"],["左翅膀","人左","身体","人右","右翅膀","武器"],["左翅膀","人左","身体","人右","右翅膀","武器"]],[["前","人前","后","人后","武器"],["武器","右翅膀","人右","身体","人左","左翅膀"],["武器","右翅膀","人右","身体","人左","左翅膀"],["武器","右翅膀","人右","身体","人左","左翅膀"],["后","人","武器","前"],["左翅膀","人左","身体","人右","右翅膀","武器"],["左翅膀","人左","身体","人右","右翅膀","武器"],["左翅膀","人左","身体","人右","右翅膀","武器"]]]]],N._ANIMASORT=[[[["人物","武器"],["武器","人物"],["武器","人物"],["武器","人物"],["武器","人物"],["人物","武器"],["人物","武器"],["人物","武器"]],[["武器","人物"],["武器","人物"],["武器","人物"],["武器","人物"],["武器","人物"],["人物","武器"],["人物","武器"],["人物","武器"]],[[],["人物","武器"],[],[],[],["武器","人物"],[],[]],[[],["武器","人物"],[],[],[],["人物","武器"],[],[]],[[],["武器","人物"],[],[],[],["人物","武器"],[],[]],[[],["武器","人物"],[],[],[],["人物","武器"],[],[]],[[],["武器","人物"],[],[],[],["人物","武器"],[],[]]],[[["人物","武器"],["武器","人物"],["武器","人物"],["武器","人物"],["武器","人物"],["人物","武器"],["人物","武器"],["人物","武器"]],[["武器","人物"],["武器","人物"],["武器","人物"],["武器","人物"],["武器","人物"],["人物","武器"],["人物","武器"],["人物","武器"]],[[],["人物","武器"],[],[],[],["武器","人物"],[],[]],[[],["武器","人物"],[],[],[],["人物","武器"],[],[]],[[],["武器","人物"],[],[],[],["人物","武器"],[],[]],[[],["武器","人物"],[],[],[],["人物","武器"],[],[]],[[],["武器","人物"],[],[],[],["人物","武器"],[],[]]],[[["人物","武器"],["武器","人物"],["武器","人物"],["武器","人物"],["武器","人物"],["人物","武器"],["人物","武器"],["人物","武器"]],[["武器","人物"],["武器","人物"],["武器","人物"],["武器","人物"],["武器","人物"],["人物","武器"],["人物","武器"],["人物","武器"]],[[],["人物","武器"],[],[],[],["武器","人物"],[],[]],[[],["武器","人物"],[],[],[],["人物","武器"],[],[]],[[],["武器","人物"],[],[],[],["人物","武器"],[],[]],[[],["武器","人物"],[],[],[],["人物","武器"],[],[]],[[],["武器","人物"],[],[],[],["人物","武器"],[],[]]],[[["人物","武器"],["武器","人物"],["武器","人物"],["武器","人物"],["武器","人物"],["人物","武器"],["人物","武器"],["人物","武器"]],[["武器","人物"],["武器","人物"],["武器","人物"],["武器","人物"],["武器","人物"],["人物","武器"],["人物","武器"],["人物","武器"]],[[],["人物","武器"],[],[],[],["武器","人物"],[],[]],[[],["武器","人物"],[],[],[],["人物","武器"],[],[]],[[],["武器","人物"],[],[],[],["人物","武器"],[],[]],[[],["武器","人物"],[],[],[],["人物","武器"],[],[]],[[],["武器","人物"],[],[],[],["人物","武器"],[],[]]],[[["人物","武器"],["人物","武器"],["武器","人物"],["武器","人物"],["武器","人物"],["人物","武器"],["人物","武器"],["人物","武器"]],[["人物","武器"],["人物","武器"],["人物","武器"],["武器","人物"],["武器","人物"],["人物","武器"],["人物","武器"],["人物","武器"]],[[],["人物","武器"],[],[],[],["武器","人物"],[],[]],[[],["武器","人物"],[],[],[],["人物","武器"],[],[]],[[],["武器","人物"],[],[],[],["人物","武器"],[],[]],[[],["武器","人物"],[],[],[],["人物","武器"],[],[]],[[],["武器","人物"],[],[],[],["人物","武器"],[],[]]],[[["人物","武器"],["人物","武器"],["武器","人物"],["武器","人物"],["武器","人物"],["人物","武器"],["人物","武器"],["人物","武器"]],[["人物","武器"],["人物","武器"],["人物","武器"],["武器","人物"],["武器","人物"],["人物","武器"],["人物","武器"],["人物","武器"]],[[],["人物","武器"],[],[],[],["武器","人物"],[],[]],[[],["武器","人物"],[],[],[],["人物","武器"],[],[]],[[],["武器","人物"],[],[],[],["人物","武器"],[],[]],[[],["武器","人物"],[],[],[],["人物","武器"],[],[]],[[],["武器","人物"],[],[],[],["人物","武器"],[],[]]]];class v{constructor(){this.aa=new l,this.sStr="12345"}}class M{constructor(){var i;for(this.xm3f=c.gi(),this.bfs=new Array(M.MAXONEBUFFER),this.sort=new Int32Array(M.MAXONEBUFFER),i=0;i<M.MAXONEBUFFER;i++)this.bfs[i]=new v}ClearBuffer(){this.ibfp=0,this.igfp=0,this.bGroup=!1}BeginGroup(){this.igfp++,this.bGroup=!0}EndGroup(){this.bGroup=!1}DrawAnima_aa(i,t,s,e,h){null!=h.pani&&(this.bfs[this.ibfp].iLockY=i,this.bfs[this.ibfp].iX=s,this.bfs[this.ibfp].iY=e,this.bfs[this.ibfp].iType=0,this.bGroup?this.bfs[this.ibfp].iGroupId=this.igfp:this.bfs[this.ibfp].iGroupId=0,this.bfs[this.ibfp].aa.copyfrom(h),this.ibfp++)}DrawImage(i,t,s,e,h,a,n){this.bfs[this.ibfp].iLockY=t+n,this.bfs[this.ibfp].iX=i,this.bfs[this.ibfp].iY=t,this.bfs[this.ibfp].iType=1,this.bGroup?this.bfs[this.ibfp].iGroupId=this.igfp:this.bfs[this.ibfp].iGroupId=0,this.bfs[this.ibfp].iRid_dest_ra=s,this.bfs[this.ibfp].iBx_type_x2_ratx=e,this.bfs[this.ibfp].iBy_size_y2_raty=h,this.bfs[this.ibfp].iBw_color_alpha=a,this.bfs[this.ibfp].iBh_c2=n,this.ibfp++}DrawText(i,t,s,e,h,a,n){this.bfs[this.ibfp].iLockY=i,this.bfs[this.ibfp].iX=s,this.bfs[this.ibfp].iY=e,this.bfs[this.ibfp].iType=2,this.bGroup?this.bfs[this.ibfp].iGroupId=this.igfp:this.bfs[this.ibfp].iGroupId=0,this.bfs[this.ibfp].sStr=h,this.bfs[this.ibfp].iRid_dest_ra=t,this.bfs[this.ibfp].iBw_color_alpha=a,this.bfs[this.ibfp].iBy_size_y2_raty=n,this.bfs[this.ibfp].iBx_type_x2_ratx=0,this.ibfp++}DrawText_2(i,t,s,e,h,a,n,o,r){this.bfs[this.ibfp].iLockY=i,this.bfs[this.ibfp].iX=s,this.bfs[this.ibfp].iY=e,this.bfs[this.ibfp].iType=2,this.bGroup?this.bfs[this.ibfp].iGroupId=this.igfp:this.bfs[this.ibfp].iGroupId=0,this.bfs[this.ibfp].sStr=h,this.bfs[this.ibfp].iRid_dest_ra=t,this.bfs[this.ibfp].iBw_color_alpha=a,this.bfs[this.ibfp].iBy_size_y2_raty=n,this.bfs[this.ibfp].iBx_type_x2_ratx=o,this.bfs[this.ibfp].iBh_c2=r,this.ibfp++}FillRect(i,t,s,e,h,a){this.bfs[this.ibfp].iLockY=i,this.bfs[this.ibfp].iX=t,this.bfs[this.ibfp].iY=s,this.bfs[this.ibfp].iType=3,this.bGroup?this.bfs[this.ibfp].iGroupId=this.igfp:this.bfs[this.ibfp].iGroupId=0,this.bfs[this.ibfp].iBx_type_x2_ratx=e,this.bfs[this.ibfp].iBy_size_y2_raty=h,this.bfs[this.ibfp].iBw_color_alpha=a,this.ibfp++}DrawAnimaEx(i,t,s,e,h,a,n,o,r,c){null!=e.pani&&(this.bfs[this.ibfp].iLockY=i,this.bfs[this.ibfp].iX=t,this.bfs[this.ibfp].iY=s,this.bfs[this.ibfp].iType=4,this.bGroup?this.bfs[this.ibfp].iGroupId=this.igfp:this.bfs[this.ibfp].iGroupId=0,this.bfs[this.ibfp].aa.copyfrom(e),this.bfs[this.ibfp].iBw_color_alpha=h,this.bfs[this.ibfp].sw=a,this.bfs[this.ibfp].sh=n,this.bfs[this.ibfp].iRid_dest_ra=o,this.bfs[this.ibfp].iBx_type_x2_ratx=r,this.bfs[this.ibfp].iBy_size_y2_raty=c,this.ibfp++)}SortAndDraw(){var i,t,s,e,h;for(s=0,this.bfs[this.ibfp].iGroupId=0,i=0;i<this.ibfp;i++)if(this.sort[s]=i,s++,this.bfs[i].iGroupId>0)for(t=this.bfs[i].iGroupId;this.bfs[i+1].iGroupId==t;)i++;for(i=0;i<s-1;i++)for(t=i+1;t<s;t++)this.bfs[this.sort[i]].iLockY>this.bfs[this.sort[t]].iLockY&&(e=this.sort[i],this.sort[i]=this.sort[t],this.sort[t]=e);for(i=0;i<s;i++)for(t=this.sort[i],e=this.bfs[t].iGroupId;;){switch(h=this.bfs[t],this.bfs[t].iType){case 0:this.bfs[t].aa.Draw(this.bfs[t].iX,this.bfs[t].iY);break;case 1:this.xm3f.DrawImageEx(0,this.bfs[t].iX,this.bfs[t].iY,this.bfs[t].iRid_dest_ra,this.bfs[t].iBx_type_x2_ratx,this.bfs[t].iBy_size_y2_raty,this.bfs[t].iBw_color_alpha,this.bfs[t].iBh_c2,100,1,1,0,0,0);break;case 2:0==this.bfs[t].iBx_type_x2_ratx?0==h.iRid_dest_ra?this.xm3f.DrawTextEx(this.bfs[t].iX,this.bfs[t].iY,h.sStr,h.iBw_color_alpha,h.iBy_size_y2_raty,101,1,1,0,-1,-1):1==h.iRid_dest_ra?this.xm3f.DrawTextEx(this.bfs[t].iX,this.bfs[t].iY,h.sStr,h.iBw_color_alpha,h.iBy_size_y2_raty,101,1,1,0,-2,-2):this.xm3f.DrawTextEx(this.bfs[t].iX,this.bfs[t].iY,h.sStr,h.iBw_color_alpha,h.iBy_size_y2_raty,101,1,1,0,-3,-3):0==h.iRid_dest_ra?this.xm3f.DrawText_2(this.bfs[t].iX,this.bfs[t].iY,h.sStr,h.iBw_color_alpha,h.iBy_size_y2_raty,101,1,1,0,-1,-1,h.iBx_type_x2_ratx,h.iBh_c2):1==h.iRid_dest_ra?this.xm3f.DrawText_2(this.bfs[t].iX,this.bfs[t].iY,h.sStr,h.iBw_color_alpha,h.iBy_size_y2_raty,101,1,1,0,-2,-2,h.iBx_type_x2_ratx,h.iBh_c2):this.xm3f.DrawText_2(this.bfs[t].iX,this.bfs[t].iY,h.sStr,h.iBw_color_alpha,h.iBy_size_y2_raty,101,1,1,0,-3,-3,h.iBx_type_x2_ratx,h.iBh_c2);break;case 3:this.xm3f.FillRect_2D(this.bfs[t].iX,this.bfs[t].iY,h.iBx_type_x2_ratx,h.iBy_size_y2_raty,h.iBw_color_alpha);break;case 4:h.aa.DrawEx(this.bfs[t].iX,this.bfs[t].iY,h.iBw_color_alpha,h.sw,h.sh,h.iRid_dest_ra,h.iBx_type_x2_ratx,h.iBy_size_y2_raty)}if(!(e>0&&this.bfs[t+1].iGroupId==e))break;t++}}}M.MAXONEBUFFER=1024,M.dbf=null,M.gi=function(){return null==M.dbf&&(M.dbf=new M),M.dbf};class R{constructor(){this.bUseing=!1,this.aa=new l}}class G{constructor(){var i;for(this.flist=new Array(G.MAXFIREWORKS),i=0;i<G.MAXFIREWORKS;i++)this.flist[i]=new R;this.iShadow=0}Draw(){var i,t,s,e=!1;for(i=0;i<G.MAXFIREWORKS;i++)if(this.flist[i].bUseing){if(this.flist[i].iDelay>0){this.flist[i].iDelay--;continue}switch(t=Ih.gi().iOffx+this.flist[i].iX,s=Ih.gi().iOffy+this.flist[i].iY,!e&&t>0&&s>0&&t<h.SCRW&&s<h.SCRH&&(c.gi().FillRect_2D(0,0,h.SCRW,h.SCRH,this.iShadow<<24),e=!0),this.flist[i].iMode){case 0:this.flist[i].aa.Draw(t,s);break;case 1:this.flist[i].iLoop<=3&&(this.flist[i].iAlpha-=1),this.flist[i].aa.DrawEx(t,s,this.flist[i].iAlpha,1,1,0,0,0),this.flist[i].iX=this.flist[i].iX+this.flist[i].iCs1-1e3,this.flist[i].iY=this.flist[i].iY+this.flist[i].iCs2-1e3;break;case 2:this.flist[i].aa.DrawEx(t,s,101,.1*this.flist[i].iCs1,.1*this.flist[i].iCs2,0,0,0)}this.flist[i].aa.NextFrame()&&(this.flist[i].iLoop>1?this.flist[i].iLoop--:this.flist[i].bUseing=!1)}e?this.iShadow<100&&(this.iShadow+=10):this.iShadow>0&&(c.gi().FillRect_2D(0,0,h.SCRW,h.SCRH,this.iShadow<<24),this.iShadow-=10)}AddFireworks(i,t,s,e,h,a,n,o,r){var c;for(c=0;c<G.MAXFIREWORKS;c++)if(!this.flist[c].bUseing){if(this.flist[c].aa.iAnimaPoint=0,0==s?gn.xani_skill.InitAnimaWithName(e,this.flist[c].aa):1==s?gn.xani_effect.InitAnimaWithName(e,this.flist[c].aa):s>=10&&s<=12&&gn.xani_skills[s-10].InitAnimaWithName(e,this.flist[c].aa),gn.sop(",,,"+e+",,,"+this.flist[c].aa.iAnimaPoint),0==this.flist[c].aa.iAnimaPoint)return;return this.flist[c].iX=i,this.flist[c].iY=t,this.flist[c].iDelay=h,this.flist[c].iLoop=a,this.flist[c].iMode=n,this.flist[c].iCs1=o,this.flist[c].iCs2=r,this.flist[c].iAlpha=101,void(this.flist[c].bUseing=!0)}}}G.MAXFIREWORKS=64,G.fe=new G,G.DrawAura=function(i,t,s,e,h){i<0||i>=128||(null==e?gn.aa_auras[i].Draw(t,s):e.DrawAnima_aa(h,null,t,s,gn.aa_auras[i]))};class E{constructor(){}}E.aa_tmp=new l,E.dm=new E,E.ui3_frame1=null,E.ui3_frame2=null,E.ui3_frame3=null,E.ui3_frame4=null,E.ui3_frame5=null,E.ui3_text2=null,E.ui4_frame1=null,E.ui4_frame2=null,E.ui4_FrameUp=function(i,t,s){null==E.ui4_frame1&&(E.ui4_frame1=gn.xani_ui4.InitAnimaWithName("对话框上",null)),E.ui4_frame1.iFrame=1,E.ui4_frame1.DrawEx(i+40,t,101,1*(s-80)/40,1,0,0,0),E.ui4_frame1.iFrame=0,E.ui4_frame1.Draw(i,t),E.ui4_frame1.iFrame=2,E.ui4_frame1.Draw(i+s-40,t)},E.ui4_FrameDown=function(i,t,s,e){null==E.ui4_frame2&&(E.ui4_frame2=gn.xani_ui4.InitAnimaWithName("对话框下",null)),E.ui4_frame2.iFrame=8,E.ui4_frame2.DrawEx(i+40,t+40,101,1*(s-80)/40,1*(e-80)/40,0,0,0),E.ui4_frame2.iFrame=0,E.ui4_frame2.Draw(i,t),E.ui4_frame2.iFrame=2,E.ui4_frame2.Draw(i+s-40,t),E.ui4_frame2.iFrame=4,E.ui4_frame2.Draw(i+s-40,t+e-40),E.ui4_frame2.iFrame=6,E.ui4_frame2.Draw(i,t+e-40),E.ui4_frame2.iFrame=1,E.ui4_frame2.DrawEx(i+40,t,101,1*(s-80)/40,1,0,0,0),E.ui4_frame2.iFrame=5,E.ui4_frame2.DrawEx(i+40,t+e-40,101,1*(s-80)/40,1,0,0,0),E.ui4_frame2.iFrame=3,E.ui4_frame2.DrawEx(i+s-40,t+40,101,1,1*(e-80)/40,0,0,0),E.ui4_frame2.iFrame=7,E.ui4_frame2.DrawEx(i,t+40,101,1,1*(e-80)/40,0,0,0)},E.ui3_DefineFrame=function(i,t,s,e){null==E.ui3_frame5&&(E.ui3_frame5=gn.xani_ui3.InitAnimaWithName("基本框5",null)),c.gi().SetViewClip(i+5,t+5,i+s-5,t+e-5),gn.xani_ui3.DrawAnima(i+s/2-400,t+e/2-240,"基本大框",0),c.gi().NoClip(),E.ui3_frame5.iFrame=0,E.ui3_frame5.DrawEx(i,t,101,1,1,0,0,0),E.ui3_frame5.iFrame=2,E.ui3_frame5.DrawEx(i+s-50,t,101,1,1,0,0,0),E.ui3_frame5.iFrame=4,E.ui3_frame5.DrawEx(i+s-50,t+e-50,101,1,1,0,0,0),E.ui3_frame5.iFrame=6,E.ui3_frame5.DrawEx(i,t+e-50,101,1,1,0,0,0),s>100&&(E.ui3_frame5.iFrame=1,E.ui3_frame5.DrawEx(i+50,t,101,1*(s-100)/200,1,0,0,0),E.ui3_frame5.iFrame=5,E.ui3_frame5.DrawEx(i+50,t+e-11,101,1*(s-100)/200,1,0,0,0)),e>100&&(E.ui3_frame5.iFrame=3,E.ui3_frame5.DrawEx(i+s-11,t+50,101,1,1*(e-100)/200,0,0,0),E.ui3_frame5.iFrame=7,E.ui3_frame5.DrawEx(i,t+50,101,1,1*(e-100)/200,0,0,0))},E.ui3_TagText4=function(i,t,s,e,h,a){c.gi().DrawText_2(i+15,t+5+0,s,4291338240,17,101,1,1,0,-2,0,3,4278190080),c.gi().DrawText_2(i+15,t+5+18,e,4291338240,17,101,1,1,0,-2,0,3,4278190080),c.gi().DrawText_2(i+15,t+5+36,h,4291338240,17,101,1,1,0,-2,0,3,4278190080),c.gi().DrawText_2(i+15,t+5+54,a,4291338240,17,101,1,1,0,-2,0,3,4278190080)},E.ui3_TagText3=function(i,t,s,e,h){c.gi().DrawText_2(i+15,t+10+0,s,4291338240,17,101,1,1,0,-2,0,3,4278190080),c.gi().DrawText_2(i+15,t+10+22,e,4291338240,17,101,1,1,0,-2,0,3,4278190080),c.gi().DrawText_2(i+15,t+10+44,h,4291338240,17,101,1,1,0,-2,0,3,4278190080)},E.ui3_TagText2=function(i,t,s,e){c.gi().DrawText_2(i+15,t+18+0,s,4291338240,17,101,1,1,0,-2,0,3,4278190080),c.gi().DrawText_2(i+15,t+18+26,e,4291338240,17,101,1,1,0,-2,0,3,4278190080)},E.ui3_BaseFrame2=function(i,t,s,e){gn.xani_ui3.DrawAnima(i,t,"基本大框",0),c.gi().DrawText_2(i+21,t+130-23,s,4294967295,20,101,1,1,0,-2,-2,3,4278190080),c.gi().DrawText_2(i+21,t+130+23,e,4294967295,20,101,1,1,0,-2,-2,3,4278190080)},E.ui3_BaseFrame3=function(i,t,s,e,h){gn.xani_ui3.DrawAnima(i,t,"基本大框",0),c.gi().DrawText_2(i+21,t+130-35,s,4294967295,20,101,1,1,0,-2,-2,3,4278190080),c.gi().DrawText_2(i+21,t+130,e,4294967295,20,101,1,1,0,-2,-2,3,4278190080),c.gi().DrawText_2(i+21,t+130+35,h,4294967295,20,101,1,1,0,-2,-2,3,4278190080)},E.ui3_BaseFrame4=function(i,t,s,e,h,a){gn.xani_ui3.DrawAnima(i,t,"基本大框",0),c.gi().DrawText_2(i+21,t+130-45,s,4294967295,20,101,1,1,0,-2,-2,3,4278190080),c.gi().DrawText_2(i+21,t+130-15,e,4294967295,20,101,1,1,0,-2,-2,3,4278190080),c.gi().DrawText_2(i+21,t+130+15,h,4294967295,20,101,1,1,0,-2,-2,3,4278190080),c.gi().DrawText_2(i+21,t+130+45,a,4294967295,20,101,1,1,0,-2,-2,3,4278190080)},E.ui3_Frame1=function(i,t,s,e){null==E.ui3_frame1&&(E.ui3_frame1=gn.xani_ui3.InitAnimaWithName("基本框1",null)),gn.xani_ui3.DrawAnima_aa(i,t,E.ui3_frame1.iAnimaPoint,0),gn.xani_ui3.DrawAnimaEx(i+10,t,E.ui3_frame1.iAnimaPoint,1,101,1*(s-20)/10,1,0,0,0),gn.xani_ui3.DrawAnima_aa(i+s-10,t,E.ui3_frame1.iAnimaPoint,2),gn.xani_ui3.DrawAnimaEx(i+s-10,t+10,E.ui3_frame1.iAnimaPoint,3,101,1,1*(e-20)/10,0,0,0),gn.xani_ui3.DrawAnima_aa(i+s-10,t+e-10,E.ui3_frame1.iAnimaPoint,4),gn.xani_ui3.DrawAnimaEx(i+10,t+e-10,E.ui3_frame1.iAnimaPoint,5,101,1*(s-20)/10,1,0,0,0),gn.xani_ui3.DrawAnima_aa(i,t+e-10,E.ui3_frame1.iAnimaPoint,6),gn.xani_ui3.DrawAnimaEx(i,t+10,E.ui3_frame1.iAnimaPoint,7,101,1,1*(e-20)/10,0,0,0),gn.xani_ui3.DrawAnimaEx(i+10,t+10,E.ui3_frame1.iAnimaPoint,8,101,1*(s-20)/10,1*(e-20)/10,0,0,0)},E.ui3_Frame2=function(i,t,s,e){null==E.ui3_frame2&&(E.ui3_frame2=gn.xani_ui3.InitAnimaWithName("基本框2",null)),gn.xani_ui3.DrawAnima_aa(i,t,E.ui3_frame2.iAnimaPoint,0),gn.xani_ui3.DrawAnimaEx(i+10,t,E.ui3_frame2.iAnimaPoint,1,101,1*(s-20)/10,1,0,0,0),gn.xani_ui3.DrawAnima_aa(i+s-10,t,E.ui3_frame2.iAnimaPoint,2),gn.xani_ui3.DrawAnimaEx(i+s-10,t+10,E.ui3_frame2.iAnimaPoint,3,101,1,1*(e-20)/10,0,0,0),gn.xani_ui3.DrawAnima_aa(i+s-10,t+e-10,E.ui3_frame2.iAnimaPoint,4),gn.xani_ui3.DrawAnimaEx(i+10,t+e-10,E.ui3_frame2.iAnimaPoint,5,101,1*(s-20)/10,1,0,0,0),gn.xani_ui3.DrawAnima_aa(i,t+e-10,E.ui3_frame2.iAnimaPoint,6),gn.xani_ui3.DrawAnimaEx(i,t+10,E.ui3_frame2.iAnimaPoint,7,101,1,1*(e-20)/10,0,0,0),gn.xani_ui3.DrawAnimaEx(i+10,t+10,E.ui3_frame2.iAnimaPoint,8,101,1*(s-20)/10,1*(e-20)/10,0,0,0)},E.ui3_Frame3=function(i,t,s,e){null==E.ui3_frame3&&(E.ui3_frame3=gn.xani_ui3.InitAnimaWithName("基本框3",null)),gn.xani_ui3.DrawAnima_aa(i,t,E.ui3_frame3.iAnimaPoint,0),gn.xani_ui3.DrawAnimaEx(i+13,t,E.ui3_frame3.iAnimaPoint,1,101,1*(s-26)/13,1,0,0,0),gn.xani_ui3.DrawAnima_aa(i+s-13,t,E.ui3_frame3.iAnimaPoint,2),gn.xani_ui3.DrawAnimaEx(i+s-13,t+13,E.ui3_frame3.iAnimaPoint,3,101,1,1*(e-26)/13,0,0,0),gn.xani_ui3.DrawAnima_aa(i+s-13,t+e-13,E.ui3_frame3.iAnimaPoint,4),gn.xani_ui3.DrawAnimaEx(i+13,t+e-13,E.ui3_frame3.iAnimaPoint,5,101,1*(s-26)/13,1,0,0,0),gn.xani_ui3.DrawAnima_aa(i,t+e-13,E.ui3_frame3.iAnimaPoint,6),gn.xani_ui3.DrawAnimaEx(i,t+13,E.ui3_frame3.iAnimaPoint,7,101,1,1*(e-26)/13,0,0,0)},E.ui3_Frame4=function(i,t,s,e){null==E.ui3_frame4&&(E.ui3_frame4=gn.xani_ui3.InitAnimaWithName("基本框4",null)),gn.xani_ui3.DrawAnima_aa(i,t,E.ui3_frame4.iAnimaPoint,0),gn.xani_ui3.DrawAnimaEx(i+30,t,E.ui3_frame4.iAnimaPoint,1,101,1*(s-60)/30,1,0,0,0),gn.xani_ui3.DrawAnima_aa(i+s-30,t,E.ui3_frame4.iAnimaPoint,2),gn.xani_ui3.DrawAnimaEx(i+s-30,t+30,E.ui3_frame4.iAnimaPoint,3,101,1,1*(e-60)/30,0,0,0),gn.xani_ui3.DrawAnima_aa(i+s-30,t+e-30,E.ui3_frame4.iAnimaPoint,4),gn.xani_ui3.DrawAnimaEx(i+30,t+e-30,E.ui3_frame4.iAnimaPoint,5,101,1*(s-60)/30,1,0,0,0),gn.xani_ui3.DrawAnima_aa(i,t+e-30,E.ui3_frame4.iAnimaPoint,6),gn.xani_ui3.DrawAnimaEx(i,t+30,E.ui3_frame4.iAnimaPoint,7,101,1,1*(e-60)/30,0,0,0),gn.xani_ui3.DrawAnimaEx(i+30,t+30,E.ui3_frame4.iAnimaPoint,8,101,1*(s-60)/30,1*(e-60)/30,0,0,0)},E.ui3_Text1=function(i,t,s,e,h,a){E.frame_type1("3号框20_30",i,t,s,20),E.frame_type1("4号框20_30",i+s,t,e,20),c.gi().DrawText_2(i+s/2,t+16,h,4294967295,20,101,1,1,0,-2,-2,0,4278190080),c.gi().DrawText_2(i+s+e/2,t+16,a,4294967295,20,101,1,1,0,-2,-2,0,4278190080)},E.ui3_Text1_=function(i,t,s,e,h,a){gn.xani_nui2.DrawAnima(i,t,"提示1",0),gn.xani_nui2.DrawAnimaEx(i+s,t,"可变长文字框",0,101,1,1,0,0,0),gn.xani_nui2.DrawAnimaEx(i+s+15,t,"可变长文字框",1,101,1*(e-30)/20,1,0,0,0),gn.xani_nui2.DrawAnimaEx(i+s+e-20,t,"可变长文字框",2,101,1,1,0,0,0),c.gi().DrawText_2(i+s/2,t+16,h,4294967295,20,101,1,1,0,-2,-2,3,4278190080),c.gi().DrawText_2(i+s+e/2,t+16,a,4294967295,20,101,1,1,0,-2,-2,3,4278190080)},E.ui3_Text1__=function(i,t,s,e,h,a){gn.xani_nui2.DrawAnima(i,t,"提示1",0),gn.xani_nui2.DrawAnimaEx(i+s,t,"可变长文字框",0,101,1,1,0,0,0),gn.xani_nui2.DrawAnimaEx(i+s+20,t,"可变长文字框",1,101,(e-40)/20,1,0,0,0),gn.xani_nui2.DrawAnimaEx(i+s+20+e-40,t,"可变长文字框",2,101,1,1,0,0,0),c.gi().DrawText_2(i+s/2,t+16,h,4294967295,20,101,1,1,0,-2,-2,3,4278190080),c.gi().DrawText_2(i+s+e/2,t+16,a,4294967295,20,101,1,1,0,-2,-2,3,4278190080)},E.ui3_Text1_4word=function(i,t,s,e,h,a){gn.xani_nui2.DrawAnima(i,t,"提示1",2),gn.xani_nui2.DrawAnimaEx(i+s,t,"可变长文字框",0,101,1,1,0,0,0),gn.xani_nui2.DrawAnimaEx(i+s+18,t,"可变长文字框",1,101,1*(e-36)/20,1,0,0,0),gn.xani_nui2.DrawAnimaEx(i+s+e-20,t,"可变长文字框",2,101,1,1,0,0,0),c.gi().DrawText_2(i+s/2,t+16,h,4294967295,20,101,1,1,0,-2,-2,3,4278190080),c.gi().DrawText_2(i+s+e/2,t+16,a,4294967295,20,101,1,1,0,-2,-2,3,4278190080)},E.ui3_Text1_4word_=function(i,t,s,e,h,a){gn.xani_nui2.DrawAnima(i,t,"提示1",2),gn.xani_nui2.DrawAnimaEx(i+s,t,"可变长文字框",0,101,1,1,0,0,0),gn.xani_nui2.DrawAnimaEx(i+s+20,t,"可变长文字框",1,101,(e-40)/20,1,0,0,0),gn.xani_nui2.DrawAnimaEx(i+s+20+e-40,t,"可变长文字框",2,101,1,1,0,0,0),c.gi().DrawText_2(i+s/2,t+16,h,4294967295,20,101,1,1,0,-2,-2,3,4278190080),c.gi().DrawText_2(i+s+e/2,t+16,a,4294967295,20,101,1,1,0,-2,-2,3,4278190080)},E.new_bgbar=function(i,t,s,e,h){gn.xani_nui2.DrawAnimaEx(i,t,h,0,101,1,1,0,0,0),gn.xani_nui2.DrawAnimaEx(i+e,t,h,1,101,(s-2*e)/e,1,0,0,0),gn.xani_nui2.DrawAnimaEx(i+s-e,t,h,2,101,1,1,0,0,0)},E.ui3_Text2=function(i,t,s,e,h,a){null==E.ui3_text2&&(E.ui3_text2=gn.xani_ui3.InitAnimaWithName("标签文本2",null)),e<124?(gn.xani_ui3.DrawAnima_aa(i+s,t+4,E.ui3_text2.iAnimaPoint,2),gn.xani_ui3.DrawAnima_aa(i+s+e-64,t+4,E.ui3_text2.iAnimaPoint,3)):(gn.xani_ui3.DrawAnima_aa(i+s,t+4,E.ui3_text2.iAnimaPoint,0),gn.xani_ui3.DrawAnima_aa(i+s+e-122,t+4,E.ui3_text2.iAnimaPoint,1)),c.gi().DrawText_2(i+s/2,t+20,h,4286643968,22,101,1,1,0,-2,-2,3,4278190080),c.gi().DrawText_2(i+s+e/2,t+20,a,4286643968,22,101,1,1,0,-2,-2,3,4278190080)},E.ui3_Text2_=function(i,t,s,e,h,a){gn.xani_nui2.DrawAnima(i+10,t+33,"快捷提示分割条",0),c.gi().DrawTextEx(i+s/2,t+20,h,4278206039,20,101,1,1,0,-2,-2),c.gi().DrawTextEx(i+s+e/2,t+20,a,4278206039,20,101,1,1,0,-2,-2)},E.Tag1_TW=function(i,t,s){},E.Data1_BR=function(i,t,s,e,h,a){c.gi().DrawTextEx(i,t+10,s,4294967295,20,101,1,1,0,0,-2),E.Text1_BR(i+h,t,a),c.gi().DrawTextEx(i+h+a/2,t+10,e,4294967295,20,101,1,1,0,-2,-2)},E.Text1_BR=function(i,t,s){gn.xani_ui.InitAnimaWithName("统一文本框1",E.aa_tmp),gn.xani_ui.DrawAnimaEx(i,t,E.aa_tmp.iAnimaPoint,0,101,1,1,0,0,0),gn.xani_ui.DrawAnimaEx(i+s-20,t,E.aa_tmp.iAnimaPoint,1,101,1,1,0,0,0),gn.xani_ui.DrawAnimaEx(i+20,t,E.aa_tmp.iAnimaPoint,2,101,1*(s-40)/20,1,0,0,0)},E.Frame1_BR=function(i,t,s,e){gn.xani_ui.InitAnimaWithName("统一红黑框",E.aa_tmp),gn.xani_ui.DrawAnimaEx(i,t,E.aa_tmp.iAnimaPoint,0,101,1*s/404,1*e/222,0,0,0),gn.xani_ui.DrawAnimaEx(i,t,E.aa_tmp.iAnimaPoint,2,101,1*s/10,1,0,0,0),gn.xani_ui.DrawAnimaEx(i,t+e-3,E.aa_tmp.iAnimaPoint,6,101,1*s/10,1,0,0,0),gn.xani_ui.DrawAnimaEx(i,t,E.aa_tmp.iAnimaPoint,8,101,1,1*e/10,0,0,0),gn.xani_ui.DrawAnimaEx(i+s-3,t,E.aa_tmp.iAnimaPoint,4,101,1,1*e/10,0,0,0),gn.xani_ui.DrawAnima_aa(i,t,E.aa_tmp.iAnimaPoint,1),gn.xani_ui.DrawAnima_aa(i+s-10,t,E.aa_tmp.iAnimaPoint,3),gn.xani_ui.DrawAnima_aa(i+s-10,t+e-10,E.aa_tmp.iAnimaPoint,5),gn.xani_ui.DrawAnima_aa(i,t+e-10,E.aa_tmp.iAnimaPoint,7)},E.Frame2_MD=function(i,t,s,e){E.new_framein(i,t,s,e,4294694536)},E.Frame3_BK=function(i,t,s,e,h){var a,n;for(gn.xani_ui.InitAnimaWithName("统一背景框",E.aa_tmp),c.gi().SetViewClip(i,t,i+s,t+e),a=0;a<s/64+1;a++)for(n=0;n<e/64+1;n++)gn.xani_ui.DrawAnimaEx(i+64*a,t+64*n,E.aa_tmp.iAnimaPoint,0,101,1,1,0,0,0);c.gi().NoClip(),gn.xani_ui.DrawAnimaEx(i,t,E.aa_tmp.iAnimaPoint,8,101,1*s/192,1*e/192,0,0,0),gn.xani_ui.DrawAnimaEx(i,t,E.aa_tmp.iAnimaPoint,1,101,1*s/250,1,0,0,0),gn.xani_ui.DrawAnimaEx(i,t,E.aa_tmp.iAnimaPoint,2,101,1*s/250,1,0,0,0),gn.xani_ui.DrawAnimaEx(i,t+e,E.aa_tmp.iAnimaPoint,2,101,1*s/250,1,0,0,0),gn.xani_ui.DrawAnimaEx(i,t,E.aa_tmp.iAnimaPoint,3,101,1,1*e/250,0,0,0),gn.xani_ui.DrawAnimaEx(i+s,t,E.aa_tmp.iAnimaPoint,3,101,1,1*e/250,0,0,0),gn.xani_ui.DrawAnima_aa(i,t,E.aa_tmp.iAnimaPoint,4),gn.xani_ui.DrawAnima_aa(i+s,t,E.aa_tmp.iAnimaPoint,5),gn.xani_ui.DrawAnima_aa(i+s,t+e,E.aa_tmp.iAnimaPoint,7),gn.xani_ui.DrawAnima_aa(i,t+e,E.aa_tmp.iAnimaPoint,6),c.gi().DrawTextEx(i+10-2,t+10,h,4278190080,40,101,1,1,0,0,0),c.gi().DrawTextEx(i+10+2,t+10,h,4278190080,40,101,1,1,0,0,0),c.gi().DrawTextEx(i+10,t+10-2,h,4278190080,40,101,1,1,0,0,0),c.gi().DrawTextEx(i+10,t+10+2,h,4278190080,40,101,1,1,0,0,0),c.gi().DrawTextEx(i+10,t+10,h,4294967295,40,101,1,1,0,0,0)},E.DrawFrame3=function(i,t,s){gn.xani_ui.DrawAnimaEx(i,t,"提示对话框",0,101,1,1*s/222,0,0,0),gn.xani_ui.DrawAnimaEx(i,t,"提示对话框",1,101,1,1,0,0,0),gn.xani_ui.DrawAnimaEx(i,t+s-5,"提示对话框",2,101,1,1,0,-1,-1)},E.DrawFrame1=function(i,t,s,e){DrawFrame("公共框1",i,t,s,e)},E.DrawFrame2=function(i,t,s,e){DrawFrame("公共框2",i,t,s,e)},E.DrawFrame=function(i,t,s,e,h){gn.xani_ui.DrawAnima_aa(t,s,i,0),gn.xani_ui.DrawAnima_aa(t+e-50,s,i,2),gn.xani_ui.DrawAnima_aa(t+e-50,s+h-50,i,4),gn.xani_ui.DrawAnima_aa(t,s+h-50,i,6),e>100&&(gn.xani_ui.DrawAnimaEx(t+50,s,i,1,101,1*(e-100)/50,1,0,0,0),gn.xani_ui.DrawAnimaEx(t+50,s+h-50,i,5,101,1*(e-100)/50,1,0,0,0)),h>100&&(gn.xani_ui.DrawAnimaEx(t,s+50,i,7,101,1,1*(h-100)/50,0,0,0),gn.xani_ui.DrawAnimaEx(t+e-50,s+50,i,3,101,1,1*(h-100)/50,0,0,0)),e>100&&h>100&&gn.xani_ui.DrawAnimaEx(t+50,s+50,i,8,101,1*(e-100)/50,1*(h-100)/50,0,0,0)},E.DrawTextFrame1=function(i,t,s){E.DrawTextFrame("大文本框",i,t,s)},E.DrawTextFrame=function(i,t,s,e){e<=50?(gn.xani_ui.DrawAnimaEx(t,s,i,0,101,1,1,0,0,0),gn.xani_ui.DrawAnimaEx(t,s,i,1,101,1,1,0,0,0)):(gn.xani_ui.DrawAnimaEx(t,s,i,0,101,1,1,0,0,0),gn.xani_ui.DrawAnimaEx(t+25-25*(e-50)/30,s,i,2,101,1*(e-50)/30,1,0,0,0),gn.xani_ui.DrawAnimaEx(t+e-50,s,i,1,101,1,1,0,0,0))},E.local_frameani=null,E.local_titleframe=function(i,t,s,e,h){null==E.local_frameani&&(E.local_frameani=gn.xani_local.InitAnimaWithName("提示框",null)),c.gi().FillRect_2D(i,t,i+s,t+e,1493172224),E.local_frameani.iFrame=0,E.local_frameani.Draw(i,t),E.local_frameani.iFrame=1,E.local_frameani.DrawEx(i,t+80,101,1,1*(e-80-57)/183,0,0,0),E.local_frameani.iFrame=2,E.local_frameani.Draw(i,t+e),E.local_frameani.iFrame=3,E.local_frameani.DrawEx(i+42,t+e,101,1*(s-42-42)/373,1,0,0,0),E.local_frameani.iFrame=4,E.local_frameani.Draw(i+s,t+e),E.local_frameani.iFrame=5,E.local_frameani.DrawEx(i+s,t+80,101,1,1*(e-80-57)/183,0,0,0),E.local_frameani.iFrame=6,E.local_frameani.Draw(i+s,t),E.local_frameani.iFrame=7,E.local_frameani.DrawEx(i+35,t,101,1*(s-35-35)/373,1,0,0,0),h&&gn.xani_local.DrawAnimaEx(i+s/6,t+yh.WordSize(80),"分隔条",0,101,2*s/3/400,1,0,0,0)},E.local_frameani1=null,E.local_frame1=function(i,t,s,e){null==E.local_frameani1&&(E.local_frameani1=gn.xani_nui1.InitAnimaWithName("背景框1",null)),c.gi().FillRect_2D(i,t,i+s,t+e,1493172224),E.local_frameani1.iFrame=0,E.local_frameani1.Draw(i,t),E.local_frameani1.iFrame=1,E.local_frameani1.DrawEx(i,t+50,101,1,1*(e-100)/50,0,0,0),E.local_frameani1.iFrame=2,E.local_frameani1.Draw(i,t+e),E.local_frameani1.iFrame=3,E.local_frameani1.DrawEx(i+50,t+e,101,1*(s-100)/50,1,0,0,0),E.local_frameani1.iFrame=4,E.local_frameani1.Draw(i+s,t+e),E.local_frameani1.iFrame=5,E.local_frameani1.DrawEx(i+s,t+50,101,1,1*(e-100)/50,0,0,0),E.local_frameani1.iFrame=6,E.local_frameani1.Draw(i+s,t),E.local_frameani1.iFrame=7,E.local_frameani1.DrawEx(i+50,t,101,1*(s-100)/50,1,0,0,0),E.local_frameani1.iFrame=8,E.local_frameani1.DrawEx(i+50,t+50,101,1*(s-100)/50,1*(e-100)/50,0,0,0)},E.local_frameani2=null,E.local_frame2=function(i,t,s,e){null==E.local_frameani2&&(E.local_frameani2=gn.xani_nui1.InitAnimaWithName("背景框2",null)),c.gi().FillRect_2D(i,t,i+s,t+e,1493172224),E.local_frameani2.iFrame=0,E.local_frameani2.Draw(i,t),E.local_frameani2.iFrame=1,E.local_frameani2.DrawEx(i,t+81,101,1,1*(e-81-39)/28,0,0,0),E.local_frameani2.iFrame=2,E.local_frameani2.Draw(i,t+e),E.local_frameani2.iFrame=3,E.local_frameani2.DrawEx(i+65,t+e,101,1*(s-65-65)/32,1,0,0,0),E.local_frameani2.iFrame=4,E.local_frameani2.Draw(i+s,t+e),E.local_frameani2.iFrame=5,E.local_frameani2.DrawEx(i+s,t+81,101,1,1*(e-81-39)/28,0,0,0),E.local_frameani2.iFrame=6,E.local_frameani2.Draw(i+s,t),E.local_frameani2.iFrame=7,E.local_frameani2.DrawEx(i+65,t,101,1*(s-65-65)/32,1,0,0,0)},E.new_frame1=null,E.new_frame2,E.new_frame3=null,E.new_bigframe=function(i,t,s,e){null==E.new_frame1&&(E.new_frame1=gn.xani_nui2.InitAnimaWithName("大边框",null),E.new_frame2=gn.xani_nui2.InitAnimaWithName("梅竹",null)),c.gi().FillRect_2D(i,t,i+s,t+e,4290764502),E.new_frame2.iFrame=0,E.new_frame2.Draw(i+s-12,t+12),E.new_frame2.iFrame=1,E.new_frame2.Draw(i+12,t+e-12),E.new_frame1.iFrame=0,E.new_frame1.Draw(i,t),E.new_frame1.iFrame=1,E.new_frame1.Draw(i+s,t),E.new_frame1.iFrame=2,E.new_frame1.Draw(i+s,t+e),E.new_frame1.iFrame=3,E.new_frame1.Draw(i,t+e),s>=400&&(E.new_frame1.iFrame=4,E.new_frame1.DrawEx(i+200,t,101,1*(s-400)/40,1,0,0,0),E.new_frame1.iFrame=5,E.new_frame1.DrawEx(i+200,t+e-1,101,1*(s-400)/40,1,0,0,0)),e>=400&&(E.new_frame1.iFrame=6,E.new_frame1.DrawEx(i,t+200,101,1,1*(e-400)/40,0,0,0),E.new_frame1.iFrame=7,E.new_frame1.DrawEx(i+s,t+200,101,1,1*(e-400)/40,0,0,0))},E.new_framein=function(i,t,s,e,h=2155787942){null==E.new_frame3&&(E.new_frame3=gn.xani_nui2.InitAnimaWithName("内框",null)),c.gi().FillRect_2D(i,t,i+s,t+e,h),E.new_frame3.iFrame=0,E.new_frame3.Draw(i,t),E.new_frame3.iFrame=1,E.new_frame3.Draw(i+s,t),E.new_frame3.iFrame=3,E.new_frame3.Draw(i+s,t+e),E.new_frame3.iFrame=2,E.new_frame3.Draw(i,t+e),s>=80&&(E.new_frame3.iFrame=4,E.new_frame3.DrawEx(i+40,t,101,1*(s-80)/17,1,0,0,0),E.new_frame3.iFrame=4,E.new_frame3.DrawEx(i+40,t+e-3,101,1*(s-80)/17,1,0,0,0)),e>=80&&(E.new_frame3.iFrame=5,E.new_frame3.DrawEx(i,t+40,101,1,1*(e-80)/14,0,0,0),E.new_frame3.iFrame=6,E.new_frame3.DrawEx(i+s,t+40,101,1,1*(e-80)/14,0,0,0))},E.new_baseframe2=function(i,t,s,e,h,a){E.new_bigframe(i,t,s,e),gn.xani_nui2.DrawAnima(i,t,"卷轴",0),c.gi().DrawText_2(i-11,t+190,h,4278206039,30,101,1,1,0,-2,-2,4,4287496191),c.gi().DrawText_2(i-11,t+270,a,4278206039,30,101,1,1,0,-2,-2,4,4287496191)},E.new_baseframe3=function(i,t,s,e,h,a,n){E.new_bigframe(i,t,s,e),gn.xani_nui2.DrawAnima(i,t,"卷轴",0),c.gi().DrawText_2(i-11,t+180,h,4278206039,30,101,1,1,0,-2,-2,4,4287496191),c.gi().DrawText_2(i-11,t+230,a,4278206039,30,101,1,1,0,-2,-2,4,4287496191),c.gi().DrawText_2(i-11,t+280,n,4278206039,30,101,1,1,0,-2,-2,4,4287496191)},E.new_baseframe4=function(i,t,s,e,h,a,n,o){E.new_bigframe(i,t,s,e),gn.xani_nui2.DrawAnima(i,t,"卷轴",0),c.gi().DrawText_2(i-11,t+165,h,4278206039,30,101,1,1,0,-2,-2,4,4287496191),c.gi().DrawText_2(i-11,t+205,a,4278206039,30,101,1,1,0,-2,-2,4,4287496191),c.gi().DrawText_2(i-11,t+245,n,4278206039,30,101,1,1,0,-2,-2,4,4287496191),c.gi().DrawText_2(i-11,t+285,o,4278206039,30,101,1,1,0,-2,-2,4,4287496191)},E.new_lableword2=function(i,t,s,e,h,a,n){h?(c.gi().DrawText_2(i+s/2-2,t+e/3,a,4294967040,22,101,1,1,0,-2,-2,3,4278206039),c.gi().DrawText_2(i+s/2-2,t+e/3*2,n,4294967040,22,101,1,1,0,-2,-2,3,4278206039)):(c.gi().DrawTextEx(i+s/2-2,t+e/3,a,4278206039,22,101,1,1,0,-2,-2),c.gi().DrawTextEx(i+s/2-2,t+e/3*2,n,4278206039,22,101,1,1,0,-2,-2))},E.new_lableword3=function(i,t,s,e,h,a,n,o){h?(c.gi().DrawText_2(i+s/2-2,t+e/3,a,4294967040,22,101,1,1,0,-2,-2,3,4278206039),c.gi().DrawText_2(i+s/2-2,t+e/3*2,n,4294967040,22,101,1,1,0,-2,-2,3,4278206039),c.gi().DrawText_2(i+s/2-2,t+e/3*3,o,4294967040,22,101,1,1,0,-2,-2,3,4278206039)):(c.gi().DrawTextEx(i+s/2-2,t+e/3,a,4278206039,22,101,1,1,0,-2,-2),c.gi().DrawTextEx(i+s/2-2,t+e/3*2,n,4278206039,22,101,1,1,0,-2,-2),c.gi().DrawTextEx(i+s/2-2,t+e/3*3,o,4278206039,22,101,1,1,0,-2,-2))},E.new_lableword4=function(i,t,s,e,h,a,n,o,r){h?(c.gi().DrawText_2(i+s/2-2,t+e/3,a,4294967040,22,101,1,1,0,-2,-2,3,4278206039),c.gi().DrawText_2(i+s/2-2,t+e/3*2,n,4294967040,22,101,1,1,0,-2,-2,3,4278206039),c.gi().DrawText_2(i+s/2-2,t+e/3*3,o,4294967040,22,101,1,1,0,-2,-2,3,4278206039),c.gi().DrawText_2(i+s/2-2,t+e/3*4,r,4294967040,22,101,1,1,0,-2,-2,3,4278206039)):(c.gi().DrawTextEx(i+s/2-2,t+e/3,a,4278206039,22,101,1,1,0,-2,-2),c.gi().DrawTextEx(i+s/2-2,t+e/3*2,n,4278206039,22,101,1,1,0,-2,-2),c.gi().DrawTextEx(i+s/2-2,t+e/3*3,o,4278206039,22,101,1,1,0,-2,-2),c.gi().DrawTextEx(i+s/2-2,t+e/3*4,r,4278206039,22,101,1,1,0,-2,-2))},E.new_frame4=null,E.new_frame5=null,E.new_frameon=function(i,t,s,e,h){var a,n;if(null==E.new_frame4&&(E.new_frame4=gn.xani_nui2.InitAnimaWithName("特殊奖励框",null)),null==E.new_frame5&&(E.new_frame5=gn.xani_nui2.InitAnimaWithName("特殊奖励框2",null)),0==h)a=E.new_frame4,n=4281963410;else{if(1!=h)return;a=E.new_frame5,n=4282151834}c.gi().FillRect_2D(i+5,t+5,i+s-10,t+e-10,n),a.iFrame=0,a.Draw(i,t),a.iFrame=1,a.Draw(i+s,t),a.iFrame=2,a.Draw(i+s,t+e),a.iFrame=3,a.Draw(i,t+e),a.iFrame=4,a.DrawEx(i+20,t,101,1*(s-20-20)/20,1,0,0,0),a.iFrame=5,a.DrawEx(i,t+20,101,1,1*(e-20-20)/20,0,0,0),a.iFrame=6,a.DrawEx(i+s,t+20,101,1,1*(e-20-20)/20,0,0,0),a.iFrame=7,a.DrawEx(i+20,t+e,101,1*(s-20-20)/20,1,0,0,0)},E.new_frame6=null,E.new_framepc=function(i,t,s,e){null==E.new_frame6&&(E.new_frame6=gn.xani_nui3.InitAnimaWithName("公共聊天外框",null)),c.gi().FillRect_2D(i+3,t+3,i+s-3,t+e-3,2147483648),E.new_frame6.iFrame=0,E.new_frame6.Draw(i+s,t),E.new_frame6.iFrame=1,E.new_frame6.DrawEx(i+19,t,101,1*(s-38)/20,1,0,0,0),E.new_frame6.iFrame=2,E.new_frame6.Draw(i,t),E.new_frame6.iFrame=3,E.new_frame6.DrawEx(i,t+19,101,1,1*(e-38)/20,0,0,0),E.new_frame6.iFrame=4,E.new_frame6.Draw(i,t+e),E.new_frame6.iFrame=5,E.new_frame6.DrawEx(i+19,t+e,101,1*(s-38)/20,1,0,0,0),E.new_frame6.iFrame=6,E.new_frame6.Draw(i+s,t+e),E.new_frame6.iFrame=7,E.new_frame6.DrawEx(i+s,t+19,101,1,1*(e-38)/20,0,0,0)},E.new_TagText2=function(i,t,s,e,h){gn.xani_nui2.DrawAnima(i,t,"提示1",0),E.new_Text(i+67,t,s,h),c.gi().DrawText_2(i+33.5,t+16,e,4294967295,20,101,1,1,0,-2,-2,3,4278190080)},E.new_Text=function(i,t,s,e){gn.xani_nui2.DrawAnimaEx(i,t,"可变长文字框",0,101,1,1,0,0,0),gn.xani_nui2.DrawAnimaEx(i+15,t,"可变长文字框",1,101,1*(s-30)/20,1,0,0,0),gn.xani_nui2.DrawAnimaEx(i+s-20,t,"可变长文字框",2,101,1,1,0,0,0),c.gi().DrawText_2(i+s/2,t+16,e,4294967295,20,101,1,1,0,-2,-2,3,4278190080)},E.new_frame7=null,E.new_framewatch=function(i,t,s,e){null==E.new_frame7&&(E.new_frame7=gn.xani_nui3.InitAnimaWithName("公共内框1",null)),E.new_frame7.iFrame=8,E.new_frame7.DrawEx(i+29,t+29,101,1*(s-58)/20,1*(e-29-21)/20,0,0,0),E.new_frame7.iFrame=1,E.new_frame7.DrawEx(i+29,t,101,1*(s-58)/20,1,0,0,0),E.new_frame7.iFrame=5,E.new_frame7.DrawEx(i+29,t+e,101,1*(s-58)/20,1,0,0,0),E.new_frame7.iFrame=7,E.new_frame7.DrawEx(i,t+29,101,1,1*(e-29-21)/20,0,0,0),E.new_frame7.iFrame=3,E.new_frame7.DrawEx(i+s,t+29,101,1,1*(e-29-21)/20,0,0,0),E.new_frame7.iFrame=0,E.new_frame7.Draw(i,t),E.new_frame7.iFrame=2,E.new_frame7.Draw(i+s,t),E.new_frame7.iFrame=4,E.new_frame7.Draw(i+s,t+e),E.new_frame7.iFrame=6,E.new_frame7.Draw(i,t+e)},E.new_frame8=null,E.new_numberframe=function(i,t,s,e){null==E.new_frame8&&(E.new_frame8=gn.xani_nui3.InitAnimaWithName("数字输入框",null)),E.new_frame8.iFrame=1,E.new_frame8.DrawEx(i+15,t,101,1*(s-30)/20,1,0,0,0),E.new_frame8.iFrame=0,E.new_frame8.Draw(i,t),E.new_frame8.iFrame=2,E.new_frame8.Draw(i+s-20,t),c.gi().DrawTextEx(i+s/2,t+25,e,4278206039,30,101,1,1,0,-2,-2)},E.frame_type1=function(i,t,s,e,h){e<2*h?(gn.xani_frame.DrawAnimaEx(t,s,i,0,101,1*e/2/h,1,0,0,0),gn.xani_frame.DrawAnimaEx(t+e/2,s,i,2,101,1*e/2/h,1,0,0,0)):(gn.xani_frame.DrawAnimaEx(t+h/2,s,i,1,101,1*(e-h)/h,1,0,0,0),gn.xani_frame.DrawAnima(t,s,i,0),gn.xani_frame.DrawAnima(t+e-h,s,i,2))},E.frame_type2=function(i,t,s,e,h,a,n){gn.xani_frame.DrawAnima(t,s,i,0),gn.xani_frame.DrawAnimaEx(t+a,s,i,1,101,1*(e-a-a)/a,1,0,0,0),gn.xani_frame.DrawAnima(t+e-a,s,i,2),gn.xani_frame.DrawAnimaEx(t+e-a,s+n,i,3,101,1,1*(h-n-n)/n,0,0,0),gn.xani_frame.DrawAnima(t+e-a,s+h-n,i,4),gn.xani_frame.DrawAnimaEx(t+a,s+h-n,i,5,101,1*(e-a-a)/a,1,0,0,0),gn.xani_frame.DrawAnima(t,s+h-n,i,6),gn.xani_frame.DrawAnimaEx(t,s+n,i,7,101,1,1*(h-n-n)/n,0,0,0)},E.frame_type3=function(i,t,s,e,h,a,n){gn.xani_frame.DrawAnimaEx(t,s,i,1,101,1*e/a,1*h/n,0,0,0)},E.frame_type4=function(i,t,s,e,h,a,n){e-a-a>0&&h-n-n>0&&gn.xani_frame.DrawAnimaEx(t+a-2,s+n-2,i,8,101,1*(e-a-a+4)/a,1*(h-n-n+4)/n,0,0,0),e-a-a>0&&gn.xani_frame.DrawAnimaEx(t+a-2,s,i,1,101,1*(e-a-a+4)/a,1,0,0,0),h-n-n>0&&gn.xani_frame.DrawAnimaEx(t+e-a,s+n-2,i,3,101,1,1*(h-n-n+4)/n,0,0,0),e-a-a>0&&gn.xani_frame.DrawAnimaEx(t+a-2,s+h-n,i,5,101,1*(e-a-a+4)/a,1,0,0,0),h-n-n>0&&gn.xani_frame.DrawAnimaEx(t,s+n-2,i,7,101,1,1*(h-n-n+4)/n,0,0,0),gn.xani_frame.DrawAnimaEx(t,s,i,0,101,1,1,0,0,0),gn.xani_frame.DrawAnimaEx(t+e-1*a,s,i,2,101,1,1,0,0,0),gn.xani_frame.DrawAnimaEx(t+e-1*a,s+h-1*n,i,4,101,1,1,0,0,0),gn.xani_frame.DrawAnimaEx(t,s+h-1*n,i,6,101,1,1,0,0,0)};class O{constructor(){this.iX=-1,this.iY=-1,this.iW=-1,this.iH=-1}Set(i,t,s,e){this.iX=i,this.iY=t,this.iW=s,this.iH=e}bIn(i,t){return!(i<this.iX)&&(!(t<this.iY)&&(!(i>this.iX+this.iW)&&!(t>this.iY+this.iH)))}CopyFrom(i){this.iX=i.iX,this.iY=i.iY,this.iW=i.iW,this.iH=i.iH}}class F{constructor(){this.rs=new Array(3);for(var i=0;i<3;i++)this.rs[i]=new O}bIn(i,t){return this.rs[0].bIn(i,t)||this.rs[1].bIn(i,t)||this.rs[2].bIn(i,t)}Clear(){this.rs[0].Set(-1,-1,-1,-1),this.rs[1].Set(-1,-1,-1,-1),this.rs[2].Set(-1,-1,-1,-1),this.iCount=0}Add(i,t,s,e){this.iCount>=3||(this.rs[this.iCount].Set(i,t,s,e),this.iCount++)}CopyFrom(i){this.iCount=i.iCount,this.rs[0].CopyFrom(i.rs[0]),this.rs[1].CopyFrom(i.rs[1]),this.rs[2].CopyFrom(i.rs[2])}}class X{constructor(){this.sDetail=""}copyfrom(i){this.iType=i.iType,this.iLp=i.iLp,this.iX=i.iX,this.iY=i.iY,this.iW=i.iW,this.iH=i.iH,this.iColor=i.iColor,this.sDetail=i.sDetail}}class Y{constructor(){var i;for(this.iLineY=new Int32Array(Y.MAXUNIT),this.iLineH=new Int32Array(Y.MAXUNIT),this.pm3f=c.gi(),this.uls=new Array(Y.MAXUNIT),i=0;i<Y.MAXUNIT;i++)this.uls[i]=new X;for(this.aa_face=new l,this.lrs=new Array(10),i=0;i<10;i++)this.lrs[i]=new F;this.ilp=0}InsertLocker(i,t,s,e,h){return t.indexOf(e+s)>=0?t.replace(e+s,h+"#L"+i+"["+s+"#]"):t}CheckOutRect(){var i,t=-1,s=-1,e=-1,h=-1;for(i=0;i<10;i++)this.lrs[i].Clear();for(i=0;i<Y.MAXUNIT&&-1!=this.uls[i].iLp;i++)switch(this.uls[i].iType){case 2:e=this.uls[i].iColor,h=this.uls[i].iLp,this.lrs[e].Clear(),t=this.uls[i].iX,s=this.iLineY[h];break;case 3:e>=0&&(this.lrs[e].Add(t,s,this.uls[i].iX-t,this.iLineH[h]),e=-1);break;default:e>=0&&this.uls[i].iLp!=h&&(this.lrs[e].Add(t,s,this.iW-t,this.iLineH[h]),h=this.uls[i].iLp,t=this.uls[i].iX,s=this.iLineY[h])}}hto(i){switch(i){case"0":return 0;case"1":return 1;case"2":return 2;case"3":return 3;case"4":return 4;case"5":return 5;case"6":return 6;case"7":return 7;case"8":return 8;case"9":return 9;case"a":case"A":return 10;case"b":case"B":return 11;case"c":case"C":return 12;case"d":case"D":return 13;case"e":case"E":return 14;case"f":case"F":return 15}return-1}NextUnit(i,t){var s,e,h,a=i[t];if(a==Y.KEY){if(this.iCurrentType=999,t+1>=i.length)return this.sCurrentString="",t+1;if(" "==(a=i[t+1]))return this.iSpaceWidth+=this.WORDSIZE,t+2;if("o"==a||"O"==a)return this.iCurrentColor=this.iOldColor,this.iCurrentType=999,t+2;if("|"==a)return t+2;if("l"==a||"L"==a)return this.iLockRectPoint=i.charAt(t+2)-"0",this.iCurrentType=3,this.sCurrentString="",t+4;if("]"==a)return this.iCurrentType=4,this.sCurrentString="",t+2;if("e"==a||"E"==a)return this.iCurrentType=2,this.sCurrentString="",t+2;if("f"==a||"F"==a){for(this.sCurrentString="",t+=2,e=0,h=0;h<3&&!(t>=i.length)&&-1!=(s=this.hto(i[t]));h++)e=10*e+s,t++;return e>=0&&e<900&&(this.iCurrentType=1,this.sCurrentString="表情"+e),t}if("c"==a||"C"==a){for(this.iCurrentType=999,t+=2,this.iOldColor=this.iCurrentColor,this.iCurrentColor=0,s=0;s<6;s++){if(t>=i.length)return this.sCurrentString="",t;if(a=i.charAt(t),-1==(e=this.hto(a)))return this.iCurrentColor|=4278190080,t;this.iCurrentColor=this.iCurrentColor<<4|e,t++}return this.iCurrentColor|=4278190080,t}return this.iCurrentType=0,this.sCurrentString=""+Y.KEY,t+1}return this.iCurrentType=0,this.sCurrentString=""+a,++t}AddUnit(i,t,s,e,h,a,n){return this.uls[t].iType=s,this.uls[t].sDetail=n,this.uls[t].iColor=e,this.uls[t].iX=h,this.uls[t].iH=a,this.uls[t].iLp=i,++t}AddLine(i,t){var s,e=0;for(s=0;s<Y.MAXUNIT;s++)this.uls[s].iLp==i&&e<this.uls[s].iH&&(e=this.uls[s].iH);for(this.bEx&&e<this.iExLineGap&&(e=this.iExLineGap),this.iLineH[i]=e,this.iLineY[i+1]=this.iLineY[i]+e,s=0;s<Y.MAXUNIT;s++)this.uls[s].iLp==i&&(e<this.uls[s].iH&&(e=this.uls[s].iH),this.uls[s].iY=this.iLineY[i]+e-this.uls[s].iH)}FormatEx(i,t,s,e,h,a){var n;this.bEx=!0,this.iExType=e,this.iExColor=h,this.iExLineGap=a,this.WORDSIZE=s;var o=0,r=0,c="",l=4294967295;for(this.iW=0,this.ilp=0,n=0;n<Y.MAXUNIT;n++)this.uls[n].iLp=-1,this.iLineY[n]=0,this.iLineH[n]=0;for(this.iCurrentColor=4294967295,this.iOldColor=4294967295,this.iSpaceWidth=0;o<i.length;)if(o=this.NextUnit(i,o),0==this.iCurrentType)this.iW+this.pm3f.GetTextWidth(c+this.sCurrentString,this.WORDSIZE)>=t?(this.pm3f.GetTextWidth(c,this.WORDSIZE),r=this.AddUnit(this.ilp,r,0,l,this.iW,this.pm3f.GetTextHeight(),c),this.AddLine(this.ilp,r),this.ilp++,c=this.sCurrentString,this.iW=0):this.iCurrentColor!=l||this.iSpaceWidth>0?(c.length>0&&(this.pm3f.GetTextWidth(c,this.WORDSIZE),r=this.AddUnit(this.ilp,r,0,l,this.iW,this.pm3f.GetTextHeight(),c),this.iW+=this.pm3f.GetTextWidth(c,this.WORDSIZE)),c=this.sCurrentString,l=this.iCurrentColor,this.iW+=this.iSpaceWidth,this.iSpaceWidth=0):c+=this.sCurrentString;else if(1==this.iCurrentType){if(gn.xani_face.InitAnimaWithName(this.sCurrentString,this.aa_face),this.aa_face.iDelay<0)continue;c.length>0&&(this.pm3f.GetTextWidth(c,this.WORDSIZE),r=this.AddUnit(this.ilp,r,0,l,this.iW,this.pm3f.GetTextHeight(),c),this.iW+=this.pm3f.GetTextWidth(c,this.WORDSIZE));var b=gn.xani_face.iAnimaW(this.aa_face),_=gn.xani_face.iAnimaH(this.aa_face);this.iW+b>t&&(this.AddLine(this.ilp,r),this.ilp++,this.iW=0),r=this.AddUnit(this.ilp,r,1,l,this.iW,_,this.sCurrentString),this.iW+=b,this.iW>=t&&(this.pm3f.GetTextWidth(c,this.WORDSIZE),this.AddLine(this.ilp,r),this.ilp++,this.iW=0),c=""}else 2==this.iCurrentType?(this.pm3f.GetTextWidth(c,this.WORDSIZE),r=this.AddUnit(this.ilp,r,0,l,this.iW,this.pm3f.GetTextHeight(),c),this.AddLine(this.ilp,r),this.ilp++,c=this.sCurrentString,this.iW=0):3==this.iCurrentType?(c.length>0&&(this.pm3f.GetTextWidth(c,this.WORDSIZE),r=this.AddUnit(this.ilp,r,0,l,this.iW,this.pm3f.GetTextHeight(),c),this.iW+=this.pm3f.GetTextWidth(c,this.WORDSIZE)),c=this.sCurrentString,r=this.AddUnit(this.ilp,r,2,this.iLockRectPoint,this.iW,0,"")):4==this.iCurrentType&&(c.length>0&&(this.pm3f.GetTextWidth(c,this.WORDSIZE),r=this.AddUnit(this.ilp,r,0,l,this.iW,this.pm3f.GetTextHeight(),c),this.iW+=this.pm3f.GetTextWidth(c,this.WORDSIZE)),c=this.sCurrentString,r=this.AddUnit(this.ilp,r,3,this.iLockRectPoint,this.iW,0,""));""!=c&&(this.pm3f.GetTextWidth(c,this.WORDSIZE),r=this.AddUnit(this.ilp,r,0,l,this.iW,this.pm3f.GetTextHeight(),c),this.iW+=this.pm3f.GetTextWidth(c,this.WORDSIZE)),this.AddLine(this.ilp,r),this.ilp++,this.iH=this.ilp*this.WORDSIZE,this.iH=this.iLineY[this.ilp],this.ilp>=2&&(this.iW=t)}Format(i,t,s){var e;this.bEx=!1,this.WORDSIZE=s;var h=0,a=0,n="",o=4294967295;for(this.iW=0,this.ilp=0,e=0;e<Y.MAXUNIT;e++)this.uls[e].iLp=-1,this.iLineY[e]=0,this.iLineH[e]=0;for(this.iCurrentColor=4294967295,this.iSpaceWidth=0;h<i.length;)if(h=this.NextUnit(i,h),0==this.iCurrentType)this.iW+this.pm3f.GetTextWidth(n+this.sCurrentString,this.WORDSIZE)>=t?(this.pm3f.GetTextWidth(n,this.WORDSIZE),a=this.AddUnit(this.ilp,a,0,o,this.iW,this.pm3f.GetTextHeight(),n),this.AddLine(this.ilp,a),this.ilp++,n=this.sCurrentString,this.iW=0):this.iCurrentColor!=o||this.iSpaceWidth>0?(n.length>0&&(this.pm3f.GetTextWidth(n,this.WORDSIZE),a=this.AddUnit(this.ilp,a,0,o,this.iW,this.pm3f.GetTextHeight(),n),this.iW+=this.pm3f.GetTextWidth(n,this.WORDSIZE)),n=this.sCurrentString,o=this.iCurrentColor,this.iW+=this.iSpaceWidth,this.iSpaceWidth=0):n+=this.sCurrentString;else if(1==this.iCurrentType){if(gn.xani_face.InitAnimaWithName(this.sCurrentString,this.aa_face),this.aa_face.iDelay<0)continue;n.length>0&&(this.pm3f.GetTextWidth(n,this.WORDSIZE),a=this.AddUnit(this.ilp,a,0,o,this.iW,this.pm3f.GetTextHeight(),n),this.iW+=this.pm3f.GetTextWidth(n,this.WORDSIZE));var r=gn.xani_face.iAnimaW(this.aa_face),c=gn.xani_face.iAnimaH(this.aa_face);this.iW+r>t&&(this.AddLine(this.ilp,a),this.ilp++,this.iW=0),a=this.AddUnit(this.ilp,a,1,o,this.iW,c,this.sCurrentString),this.iW+=r,this.iW>=t&&(this.pm3f.GetTextWidth(n,this.WORDSIZE),this.AddLine(this.ilp,a),this.ilp++,this.iW=0),n=""}else 2==this.iCurrentType?(this.pm3f.GetTextWidth(n,this.WORDSIZE),a=this.AddUnit(this.ilp,a,0,o,this.iW,this.pm3f.GetTextHeight(),n),this.AddLine(this.ilp,a),this.ilp++,n=this.sCurrentString,this.iW=0):3==this.iCurrentType?(n.length>0&&(this.pm3f.GetTextWidth(n,this.WORDSIZE),a=this.AddUnit(this.ilp,a,0,o,this.iW,this.pm3f.GetTextHeight(),n),this.iW+=this.pm3f.GetTextWidth(n,this.WORDSIZE)),n=this.sCurrentString,a=this.AddUnit(this.ilp,a,2,this.iLockRectPoint,this.iW,0,"")):4==this.iCurrentType&&(n.length>0&&(this.pm3f.GetTextWidth(n,this.WORDSIZE),a=this.AddUnit(this.ilp,a,0,o,this.iW,this.pm3f.GetTextHeight(),n),this.iW+=this.pm3f.GetTextWidth(n,this.WORDSIZE)),n=this.sCurrentString,a=this.AddUnit(this.ilp,a,3,this.iLockRectPoint,this.iW,0,""));""!=n&&(this.pm3f.GetTextWidth(n,this.WORDSIZE),a=this.AddUnit(this.ilp,a,0,o,this.iW,this.pm3f.GetTextHeight(),n),this.iW+=this.pm3f.GetTextWidth(n,this.WORDSIZE)),this.AddLine(this.ilp,a),this.ilp++,this.iH=this.ilp*this.WORDSIZE,this.iH=this.iLineY[this.ilp],this.ilp>=2&&(this.iW=t)}Draw(i,t){var s;for(s=0;s<Y.MAXUNIT;s++){if(-1==this.uls[s].iLp)return;switch(this.uls[s].iType){case 0:this.bEx?this.pm3f.DrawText_2(i+this.uls[s].iX,t+this.uls[s].iY,this.uls[s].sDetail,this.uls[s].iColor,this.WORDSIZE,101,1,1,0,0,0,this.iExType,this.iExColor):this.pm3f.DrawTextEx(i+this.uls[s].iX,t+this.uls[s].iY,this.uls[s].sDetail,this.uls[s].iColor,this.WORDSIZE,101,1,1,0,0,0);break;case 1:gn.xani_face.InitAnimaWithName(this.uls[s].sDetail,this.aa_face),this.aa_face.SetFrame(gn.iDelay),this.aa_face.DrawEx(i+this.uls[s].iX,t+this.uls[s].iY,101,1,1,0,-1,-1)}}}DrawToBuffer(i,t,s){var e;for(e=0;e<Y.MAXUNIT;e++){if(-1==this.uls[e].iLp)return;switch(this.uls[e].iType){case 0:M.gi().DrawText(i,0,t+this.uls[e].iX,s+this.uls[e].iY,this.uls[e].sDetail,this.uls[e].iColor,this.WORDSIZE);break;case 1:gn.xani_face.InitAnimaWithName(this.uls[e].sDetail,this.aa_face),this.aa_face.SetFrame(gn.iDelay),M.gi().DrawAnimaEx(i,t+this.uls[e].iX,s+this.uls[e].iY,this.aa_face,101,1,1,0,-1,-1)}}}}Y.KEY="#",Y.MAXUNIT=64,Y.fs=null,Y.gi=function(){return null==Y.fs&&(Y.fs=new Y),Y.fs};class W{constructor(){this.sMessage=""}}class L{constructor(){var i;for(this.pm3f=c.xm3f,this.iMessageCount=0,this.messages=new Array(L.MAXMESSAGE),i=0;i<L.MAXMESSAGE;i++)this.messages[i]=new W;this.snap_atts=new Int32Array(6),this.iShowDelay=-1,this.bDisable=!1}snapatt(){this.snap_atts[0]=xh.me.rbs.iMaxHp,this.snap_atts[1]=xh.me.rbs.iMaxMp,this.snap_atts[2]=xh.me.rbs.iAttack,this.snap_atts[3]=xh.me.rbs.iDefence,this.snap_atts[4]=xh.me.rbs.iSpirit,this.snap_atts[5]=xh.me.rbs.iSpeed}calcattchanged(){this.snap_atts[0]=xh.me.rbs.iMaxHp-this.snap_atts[0],this.snap_atts[1]=xh.me.rbs.iMaxMp-this.snap_atts[1],this.snap_atts[2]=xh.me.rbs.iAttack-this.snap_atts[2],this.snap_atts[3]=xh.me.rbs.iDefence-this.snap_atts[3],this.snap_atts[4]=xh.me.rbs.iSpirit-this.snap_atts[4],this.snap_atts[5]=xh.me.rbs.iSpeed-this.snap_atts[5],this.iShowCount=0;for(var i=0;i<6;i++)0!=this.snap_atts[i]&&(this.iShowCount++,this.AddMessage(this.getdetail(i,this.snap_atts[i])))}addflag(i){return i>0?"+"+i:""+i}getdetail(i,t){switch(i){case 0:return"气血上限"+this.addflag(t);case 1:return"魔法上限"+this.addflag(t);case 2:return"攻击力"+this.addflag(t);case 3:return"防御力"+this.addflag(t);case 4:return"灵力"+this.addflag(t);case 5:return"速度"+this.addflag(t);default:return"null"}}drawattchanged(){if(!(this.iShowDelay<=0)){for(var i=h.SCRH/2-80*this.iShowCount/2,t=0,s=0;s<6;s++)0!=this.snap_atts[s]&&(this.pm3f.DrawTextEx(h.SCRW/2-2,i+80*t,this.getdetail(s,this.snap_atts[s]),4278190080,60,this.iShowDelay,1,1,0,-2,0),this.pm3f.DrawTextEx(h.SCRW/2+2,i+80*t,this.getdetail(s,this.snap_atts[s]),4278190080,60,this.iShowDelay,1,1,0,-2,0),this.pm3f.DrawTextEx(h.SCRW/2,i+80*t-2,this.getdetail(s,this.snap_atts[s]),4278190080,60,this.iShowDelay,1,1,0,-2,0),this.pm3f.DrawTextEx(h.SCRW/2,i+80*t+2,this.getdetail(s,this.snap_atts[s]),4278190080,60,this.iShowDelay,1,1,0,-2,0),this.pm3f.DrawTextEx(h.SCRW/2,i+80*t,this.getdetail(s,this.snap_atts[s]),this.snap_atts[s]>0?4278255360:4294901760,60,this.iShowDelay>101?101:this.iShowDelay,1,1,0,-2,0),t++);this.iShowDelay-=5}}Clear(){this.iMessageCount=0}AddMessage(i){var t;for(this.iMessageCount>=L.MAXMESSAGE&&(this.iMessageCount=L.MAXMESSAGE-1),t=this.iMessageCount;t>0;t--)this.messages[t].sMessage=this.messages[t-1].sMessage,this.messages[t].iDelay=this.messages[t-1].iDelay;this.messages[0].sMessage=i,this.messages[0].iDelay=L.MESSAGEDELAY,this.iMessageCount++}Draw(){if(this.bDisable)ln.gi().iXStat!=ln.GS_PROMPTACTIVITY&&(this.bDisable=!1);else{var i,t,s,e;for(this.drawattchanged(),i=0;i<this.iMessageCount;i++)Y.gi().Format("#cffff00"+this.messages[i].sMessage,800,26),e=Y.gi().iW,32,t=(h.SCRW-e-4)/2,s=h.SCRH-32*(i+1)-1,L.new_Text(t,s,e+4),Y.gi().Draw(t+2,s+3),this.messages[i].iDelay--;this.iMessageCount>0&&this.messages[this.iMessageCount-1].iDelay<=0&&this.iMessageCount--}}ProcTouch(i,t,s){return!1}}L.MAXMESSAGE=10,L.MESSAGEDELAY=100,L.easymsg=new L,L.new_Text=function(i,t,s){gn.xani_nui2.DrawAnimaEx(i,t,"可变长文字框",0,60,1,1,0,0,0),gn.xani_nui2.DrawAnimaEx(i+15,t,"可变长文字框",1,60,1*(s-30)/20,1,0,0,0),gn.xani_nui2.DrawAnimaEx(i+s-20,t,"可变长文字框",2,60,1,1,0,0,0)};class H{constructor(){}}H.bAway=function(){var i;for(i=1;i<5;i++)if(H.iTmpTeamRid[i]==xh.me.iRid&&H.iTeamRid[i]<=0)return!0;return!1},H.bNoTeam=function(){return H.iTmpTeamRid[0]<=0},H.bInTeam=function(){return H.iTmpTeamRid[0]>0},H.bTeamLeader=function(){return H.iTmpTeamRid[0]==xh.me.iRid},H.bInTmpTeam=function(i){var t;if(H.iTmpTeamRid[0]<=0)return!1;for(t=0;t<5;t++)if(H.iTmpTeamRid[t]==i)return!0;return!1},H.bFullTeam=function(){var i;for(i=0;i<5;i++)if(H.iTeamRid[i]<=0)return!1;return!0},H.iTeamRid=[0,0,0,0,0],H.iTmpTeamRid=[0,0,0,0,0],H.sName=["","","","",""],H.iRas=[0,0,0,0,0],H.iSchoolId=[0,0,0,0,0],H.iLev=[0,0,0,0,0],H.iColor=new Array(5);for(var B=0;B<5;B++)H.iColor[B]=new Int32Array(10);H.iWeapTid=[0,0,0,0,0],H.sMapName=["","","","",""],H.iTeamTarget=0,H.iLev1=0,H.iLev2=100,H.bLeaderAutoTeaming=!1,H.bSingleAutoTeaming=!1;class V{_EXTDATA(){this.iShowDelay=0}copyfrom(i){this.type=i.type,this.eid=i.eid,this.tid=i.tid,this.name=i.name,this.detail=i.detail,this.iShowDelay=i.iShowDelay}}class U{constructor(){var i;for(this.iRid=0,this.sName="",this.sTime="",this.sDetail="",this.bFriend=!1,this.exts=new Array(5),this.lrs_small=new Array(5),i=0;i<5;i++)this.exts[i]=new V,this.lrs_small[i]=new F}copyfrom(i){this.iSession=i.iSession,this.iRid=i.iRid,this.sName=i.sName,this.iDRid=i.iDRid,this.sTime=i.sTime,this.sDetail=i.sDetail,this.bFriend=i.bFriend,this.iRax=i.iRax,this.iFlag=i.iFlag,this.exts[0].copyfrom(i.exts[0]),this.exts[1].copyfrom(i.exts[1]),this.exts[2].copyfrom(i.exts[2]),this.exts[3].copyfrom(i.exts[3]),this.exts[4].copyfrom(i.exts[4])}}class J{constructor(){}}class Q{constructor(){this.MAXT=32,this.t=new Array(this.MAXT);for(var i=0;i<this.MAXT;i++)this.t[i]=new J,this.t[i].bUseing=!1;this.aa_t=null}Add(i,t){for(var s=0;s<this.MAXT;s++)if(this.t[s].bUseing&&bn.llength(i,t,this.t[s].iX,this.t[s].iY)<30)return;for(s=0;s<this.MAXT;s++)if(!this.t[s].bUseing){this.t[s].bUseing=!0,this.t[s].iX=i,this.t[s].iY=t,this.t[s].iFrame=0;break}}Draw(){var i;for(null==this.aa_t&&(this.aa_t=gn.xani_nui3.InitAnimaWithName("点击效果",null)),i=0;i<this.MAXT;i++)this.t[i].bUseing&&(this.aa_t.iFrame=this.t[i].iFrame,this.aa_t.Draw(Ih.gi().iOffx+this.t[i].iX,Ih.gi().iOffy+this.t[i].iY),this.t[i].iFrame++,this.t[i].iFrame>=13&&(this.t[i].bUseing=!1))}}Q.te=new Q;class q{constructor(){this.iType=0}}class K extends q{constructor(){var i;for(super(),this.sHead="",this.iCount=0,this.sQuestion="",this.sAnswers=new Array(K.MAXSELECTCOUNT),this.next=new Array(K.MAXSELECTCOUNT),i=0;i<K.MAXSELECTCOUNT;i++)this.next[i]=null,this.sAnswers[i]=""}copyfrom(i){this.iCount=i.iCount,this.sHead=i.sHead,this.sQuestion=i.sQuestion;for(var t=0;t<K.MAXSELECTCOUNT;t++)this.sAnswers[t]=i.sAnswers[t],this.next[t]=i.next[t]}AddSelect(i,t){this.iCount>=K.MAXSELECTCOUNT||(this.sAnswers[this.iCount]=i,this.next[this.iCount]=t,this.iCount++)}}K.MAXSELECTCOUNT=6;class Z{FrameMessage(){this.iW=300,this.iH=200,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.pm3f=c.xm3f,this.bShow=!1}Open(i){this.sDetail=i,this.bShow=!0,this.iW=h.SCRW/2,this.iH=200,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.iY=h.SCRH/2-10,this.bLock=!0}Draw(){this.bShow&&(this.iW=500,this.iH=200,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2+40,Y.gi().FormatEx("#cffff00"+this.sDetail,this.iW-50,30,1,4278190080,35),this.iH=240,Y.gi().iH+50>this.iH&&(this.iH=Y.gi().iH+50),this.iY=(h.SCRH-this.iH)/2+40,E.new_framewatch(this.iX,this.iY,this.iW,this.iH),Y.gi().Draw(this.iX+25,this.iY+25))}ProcTouch(i,t,s){return!!this.bShow&&(1==i&&(this.bLock=!1),3!=i||this.bLock||(this.bShow=!1),!0)}}Z.fm=new Z;class ${constructor(){}}class ii{constructor(){}}class ti{constructor(){}}class si{constructor(i,t){var s;for(this.xm3f=i,this.vbk=t,this.bDialoging=!1,this.iW=410,this.iH=200,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.iY=h.SCRH/2-10,this.drs=new Array(16),s=0;s<16;s++)this.drs[s]=new $;for(this.iDRCount=0,this.aa_head=new l,this.nd1=new ii,this.nd2=new ti,this.nd2.btn_sel=new Array(8),s=0;s<8;s++)this.nd2.btn_sel[s]=null;si.md=this,this.aa_f1=null,this.aa_f2=null,this.res_shadow=-1}btstring(i,t,s){for(var e="",h=0;h<s;h++)e+=i[t+h];return e}InitDialog(i,t){var s,e,a,n;gn.sop("head==="+i.sHead),this.iW=h.SCRW/2,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.pSelect=i,this.iPoint=-1,this.bDown=!1,this.iY=h.SCRH/2-10;var o=i.sQuestion.split("");if("@"!=o[0]||"0"!=o[1])if("@"!=o[0]||"1"!=o[1])if("@"!=o[0]||"2"!=o[1]){if("@"==o[0]&&":"==o[1]){for(this.bDialoging&&1==this.iDialogType||(this.iDRCount=0,this.iH=60),this.drs[this.iDRCount].sName="",this.drs[this.iDRCount].sHead="",this.drs[this.iDRCount].sDetail="",e=0;e<o.length;e++)if("@"==o[e]&&":"==o[e+1]){for(a=e+3,n=0;a+n<o.length&&("@"!=o[a+n]||":"!=o[a+n+1]);)n++;gn.sop1("len="+o.length+",j="+a+",k="+n),"n"==o[e+2]?(this.drs[this.iDRCount].sName=this.btstring(o,a,n),gn.sop1("name="+this.drs[this.iDRCount].sName)):"h"==o[e+2]?(this.drs[this.iDRCount].sHead=this.btstring(o,a,n),gn.sop1("head="+this.drs[this.iDRCount].sHead)):"d"==o[e+2]&&(this.drs[this.iDRCount].sDetail=this.btstring(o,a,n),gn.sop1("detail="+this.drs[this.iDRCount].sDetail),this.tmwait=200+50*this.drs[this.iDRCount].sDetail.length,this.tmwait=50)}return this.bDialoging=!0,this.iDialogType=1,this.iDRCount++,void(this.tm1=bn.get_ms())}if("!"==o[0]&&":"==o[1]){for(this.drs[0].sName="",this.drs[0].sHead="",this.drs[0].sDetail="",e=0;e<o.length;e++)if("!"==o[e]&&":"==o[e+1]){for(a=e+3,n=0;a+n<o.length&&("!"!=o[a+n]||":"!=o[a+n+1]);)n++;gn.sop1("len="+o.length+",j="+a+",k="+n),"n"==o[e+2]?(this.drs[0].sName=this.btstring(o,a,n),gn.sop1("name="+this.drs[0].sName)):"h"==o[e+2]?(this.drs[0].sHead=this.btstring(o,a,n),gn.sop1("head="+this.drs[0].sHead)):"d"==o[e+2]&&(this.drs[0].sDetail=this.btstring(o,a,n),gn.sop1("detail="+this.drs[0].sDetail))}return this.bDialoging=!0,this.iDialogType=2,this.iX=(h.SCRW-this.iW)/2,void(this.iY=(h.SCRH-this.iH)/2)}this.iW=h.SCRW/2,this.iH=200,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.bDialoging=!0,this.iDialogType=0}else Z.fm.Open(this.btstring(o,2,o.length-2));else{if(this.pSelect.iCount>0)for(e=0;e<this.pSelect.iCount;e++)null==this.nd2.btn_sel[e]&&(this.nd2.btn_sel[e]=new Eh(gn.xani_nui4),this.nd2.btn_sel[e].InitButton("操作选项按钮")),this.nd2.btn_sel[e].sName=this.pSelect.sAnswers[e],this.nd2.btn_sel[e].Move(h.SCRW-40-30-272,h.SCRH-160-20-(20*(this.pSelect.iCount-1)+40+54*this.pSelect.iCount)+20+74*e,272,54);for(this.nd2.aa_shot=null,this.bDialoging=!0,this.iDialogType=3,e=0;e<o.length;e++)"n"==o[e]&&(this.nd2.iNpcId=parseInt(""+o[e+1]+o[e+2]+o[e+3]),500==this.nd2.iNpcId?(this.nd2.sName=xh.me.sName,s=xh.sRace(xh.me.iRace)+"_"+xh.sSex(xh.me.iSex),this.nd2.aa_shot=gn.xani_shot[0].InitAnimaWithName(s,null)):(this.nd2.sName=gn.de_npc.strValue(this.nd2.iNpcId,0,1),null!=t&&t.length>0&&(this.nd2.sName=t),(a=gn.de_npc.intValue(this.nd2.iNpcId,0,9))>=0&&a<=1&&(this.nd2.aa_shot=gn.xani_shot[a].InitAnimaWithName(gn.de_npc.strValue(this.nd2.iNpcId,0,10),null)),gn.sop(this.nd2.iNpcId+this.nd2.sName+a)),i.sHead.length>0&&(this.nd2.sName=i.sHead),e+=3),"t"==o[e]&&(this.nd2.sDetail=this.btstring(o,e+1,o.length-e-1))}else for(this.nd1.aa_shot=null,this.bDialoging=!0,this.iDialogType=4,this.bDown=!1,e=0;e<o.length;e++)"n"==o[e]&&(this.nd1.iNpcId=parseInt(""+o[e+1]+o[e+2]+o[e+3]),501==this.nd1.iNpcId?(this.nd1.sName=xh.me.sName+"(未来)",s=xh.sRace(xh.me.iRace)+"_"+xh.sSex(xh.me.iSex)+"未来",this.nd1.aa_shot=gn.xani_shot[0].InitAnimaWithName(s,null)):500==this.nd1.iNpcId?(this.nd1.sName=xh.me.sName,s=xh.sRace(xh.me.iRace)+"_"+xh.sSex(xh.me.iSex),this.nd1.aa_shot=gn.xani_shot[0].InitAnimaWithName(s,null)):(this.nd1.sName=gn.de_npc.strValue(this.nd1.iNpcId,0,1),null!=t&&t.length>0&&(this.nd1.sName=t),(a=gn.de_npc.intValue(this.nd1.iNpcId,0,9))>=0&&a<=1&&(this.nd1.aa_shot=gn.xani_shot[a].InitAnimaWithName(gn.de_npc.strValue(this.nd1.iNpcId,0,10),null)),gn.sop(this.nd1.iNpcId+this.nd1.sName+a)),i.sHead.length>0&&(this.nd1.sName=i.sHead),e+=3),"t"==o[e]&&(this.nd1.sDetail=this.btstring(o,e+1,o.length-e-1))}Draw_0(){var i;for(this.fRate=1*h.SCRH/720,this.iTextSize=parseInt(32*this.fRate),this.iW=h.SCRW/2,this.iW>750&&(this.iW=750),this.iH=200,Y.gi().FormatEx(this.pSelect.sQuestion,this.iW-20,this.iTextSize,1,4278190080,7*this.iTextSize/6),this.iH=Y.gi().iH+20+this.pSelect.iCount*(7*this.iTextSize/6)+this.iTextSize/2,this.iH<h.SCRH/4&&(this.iH=h.SCRH/4),this.iY=h.SCRH/2,this.iY+this.iH+20>h.SCRH&&(this.iY=h.SCRH-this.iH-20),E.ui4_FrameUp(this.iX,this.iY-40,this.iW),E.ui4_FrameDown(this.iX,this.iY,this.iW,this.iH),Y.gi().Draw(this.iX+15,this.iY+10),this.iOffX=this.iX+15,this.iOffY=this.iY+10+Y.gi().iH+this.iTextSize/2,i=0;i<this.pSelect.iCount;i++)this.iPoint==i&&gn.xani_ui4.DrawAnimaEx(this.iOffX,this.iOffY+i*this.iTextSize*7/6+this.iTextSize/2,"对话框条",0,101,1*(this.iW-30)/250,this.fRate,0,0,0),this.xm3f.DrawTextEx(this.iOffX,this.iOffY+i*this.iTextSize*7/6+this.iTextSize/2,this.pSelect.sAnswers[i],4294504568,this.iTextSize,101,1,1,0,0,-2)}DrawChatFrame(i,t,s,e,h){1==i?(null==this.aa_f1&&(this.aa_f1=gn.xani_nui2.InitAnimaWithName("左侧框",null)),c.gi().FillRect_2D(t+2,s-h/2+2,t+e-2,s+h/2-2,4282875759),this.aa_f1.iFrame=0,this.aa_f1.Draw(t,s-h/2),this.aa_f1.iFrame=1,this.aa_f1.Draw(t+e,s-h/2),this.aa_f1.iFrame=2,this.aa_f1.Draw(t+e,s+h/2),this.aa_f1.iFrame=3,this.aa_f1.Draw(t,s+h/2),this.aa_f1.iFrame=4,this.aa_f1.DrawEx(t+10,s-h/2,101,1*(e-20)/10,1,0,0,0),this.aa_f1.iFrame=7,this.aa_f1.DrawEx(t+10,s+h/2,101,1*(e-20)/10,1,0,0,0),this.aa_f1.iFrame=5,this.aa_f1.DrawEx(t,s-h/2+10,101,1,1*(h-20)/10,0,0,0),this.aa_f1.iFrame=6,this.aa_f1.DrawEx(t+e,s-h/2+10,101,1,1*(h-20)/10,0,0,0),this.aa_f1.iFrame=8,this.aa_f1.Draw(t,s)):2==i&&(null==this.aa_f2&&(this.aa_f2=gn.xani_nui2.InitAnimaWithName("右侧框",null)),c.gi().FillRect_2D(t+2,s-h/2+2,t+e-2,s+h/2-2,4286216011),this.aa_f2.iFrame=0,this.aa_f2.Draw(t,s-h/2),this.aa_f2.iFrame=1,this.aa_f2.Draw(t+e,s-h/2),this.aa_f2.iFrame=2,this.aa_f2.Draw(t+e,s+h/2),this.aa_f2.iFrame=3,this.aa_f2.Draw(t,s+h/2),this.aa_f2.iFrame=4,this.aa_f2.DrawEx(t+10,s-h/2,101,1*(e-20)/10,1,0,0,0),this.aa_f2.iFrame=7,this.aa_f2.DrawEx(t+10,s+h/2,101,1*(e-20)/10,1,0,0,0),this.aa_f2.iFrame=5,this.aa_f2.DrawEx(t,s-h/2+10,101,1,1*(h-20)/10,0,0,0),this.aa_f2.iFrame=6,this.aa_f2.DrawEx(t+e,s-h/2+10,101,1,1*(h-20)/10,0,0,0),this.aa_f2.iFrame=8,this.aa_f2.Draw(t+e,s))}DrawSpeek(i,t,s,e,h){var a,n,o,r,c=650,l=0;if(Y.gi().FormatEx(h,c-20,30,1,4278190080,32),l<Y.gi().iH+20+20&&(l=Y.gi().iH+20+20),Y.gi().iW+20<c&&(c=Y.gi().iW+20),"我"==e){if(gn.xani_head.InitAnimaWithName("新头像"+(2*xh.me.iRace+xh.me.iSex),this.aa_head),a=this.iX+this.iW-80-20,n=this.iY+i+l/2-40,this.aa_head.Draw(a-3,n),o=this.iX+this.iW-20-80-20-c,r=this.iY+i+l/2-Y.gi().iH/2-10,this.DrawChatFrame(2,o,this.iY+i+l/2,c,Y.gi().iH+20),Y.gi().Draw(o+10,r+10),t){if(this.tm2=bn.get_ms()-this.tm1,this.tm2>this.tmwait)return l;this.tm2<this.tmwait/2?(gn.xani_head.DrawAnima(o-50,n+40,"进度红",0),gn.xani_head.DrawAnimaEx(o-50,n+40,"进度绿",0,101,1,1,180-360*this.tm2/this.tmwait,o-50,n+40),gn.xani_head.DrawAnimaEx(o-50,n+40,"进度红",0,101,1,1,180,o-50,n+40)):(gn.xani_head.DrawAnimaEx(o-50,n+40,"进度红",0,101,1,1,180,o-50,n+40),gn.xani_head.DrawAnima(o-50,n+40,"进度绿",0),gn.xani_head.DrawAnimaEx(o-50,n+40,"进度绿",0,101,1,1,540-360*this.tm2/this.tmwait,o-50,n+40))}}else if("未来"==e?gn.xani_head.InitAnimaWithName("新头像"+(2*xh.me.iRace+xh.me.iSex),this.aa_head):gn.xani_head.InitAnimaWithName(s,this.aa_head),a=this.iX+20,n=this.iY+i+l/2-40,this.aa_head.Draw(a+3,n),o=this.iX+20+80+20,r=this.iY+i+l/2-Y.gi().iH/2-10,this.DrawChatFrame(1,o,this.iY+i+l/2,c,Y.gi().iH+20),Y.gi().Draw(o+10,r+10),t){if(this.tm2=bn.get_ms()-this.tm1,this.tm2>this.tmwait)return l;this.tm2<this.tmwait/2?(gn.xani_head.DrawAnima(o+c+50,n+40,"进度红",0),gn.xani_head.DrawAnimaEx(o+c+50,n+40,"进度绿",0,101,1,1,180-360*this.tm2/this.tmwait,o+c+50,n+40),gn.xani_head.DrawAnimaEx(o+c+50,n+40,"进度红",0,101,1,1,180,o+c+50,n+40)):(gn.xani_head.DrawAnimaEx(o+c+50,n+40,"进度红",0,101,1,1,180,o+c+50,n+40),gn.xani_head.DrawAnima(o+c+50,n+40,"进度绿",0),gn.xani_head.DrawAnimaEx(o+c+50,n+40,"进度绿",0,101,1,1,540-360*this.tm2/this.tmwait,o+c+50,n+40))}return l}Draw_1(){var i,t,s,e;for(this.iW=1e3,this.iH>300?(t=this.iH-300,e=300):(t=0,e=this.iH),this.iX=(h.SCRW-this.iW)/2,this.iY=h.SCRH-e-10,c.gi().SetViewClip(this.iX,this.iY,this.iX+this.iW,this.iY+e),E.new_bigframe(this.iX,this.iY,this.iW,e),E.new_framein(this.iX+15,this.iY+15,this.iW-30,e-30),c.gi().NoClip(),c.gi().SetViewClip(this.iX+20,this.iY+20,this.iX+this.iW-20,this.iY+e-20),s=0,i=0;i<this.iDRCount;i++)s+=this.DrawSpeek(s+20-t,i==this.iDRCount-1,this.drs[i].sHead,this.drs[i].sName,this.drs[i].sDetail);this.iH<s+40-20?this.iH+=20:this.iH=s+40,c.gi().NoClip()}Draw_2(){var i;for(this.fRate=1*h.SCRH/720,this.iTextSize=parseInt(32*this.fRate),this.iW=h.SCRW/2,this.iW>750&&(this.iW=750),this.iH=200,this.iX=(h.SCRW-this.iW)/2,Y.gi().FormatEx(this.drs[0].sDetail,this.iW-20,this.iTextSize,1,4278190080,7*this.iTextSize/6),this.iH=Y.gi().iH+20+this.pSelect.iCount*(7*this.iTextSize/6)+this.iTextSize/2,this.iH<h.SCRH/4&&(this.iH=h.SCRH/4),this.iY=h.SCRH/2,gn.sop(""+this.iY),this.iY+this.iH+20>h.SCRH&&(this.iY=h.SCRH-this.iH-20),E.ui4_FrameUp(this.iX,this.iY-40,this.iW),E.ui4_FrameDown(this.iX,this.iY,this.iW,this.iH),"我"==this.drs[0].sHead?(gn.xani_head.InitAnimaWithName("新头像"+(2*xh.me.iRace+xh.me.iSex),this.aa_head),this.aa_head.Draw(this.iX+this.iW-80-30,this.iY-80),this.xm3f.DrawTextEx(this.iX+this.iW-60-30-10,this.iY-20,xh.me.sName,4294504568,32,101,1,1,0,-3,-2)):(gn.xani_head.InitAnimaWithName(this.drs[0].sHead,this.aa_head),this.aa_head.Draw(this.iX+30,this.iY-80),this.xm3f.DrawTextEx(this.iX+30+60+10,this.iY-20,this.drs[0].sName,4294504568,32,101,1,1,0,0,-2)),Y.gi().Draw(this.iX+15,this.iY+10),this.iOffX=this.iX+15,this.iOffY=this.iY+10+Y.gi().iH+this.iTextSize/2,i=0;i<this.pSelect.iCount;i++)this.iPoint==i&&gn.xani_ui4.DrawAnimaEx(this.iOffX,this.iOffY+i*this.iTextSize*7/6+this.iTextSize/2,"对话框条",0,101,1*(this.iW-30)/250,this.fRate,0,0,0),this.xm3f.DrawTextEx(this.iOffX,this.iOffY+i*this.iTextSize*7/6+this.iTextSize/2,this.pSelect.sAnswers[i],4294504568,this.iTextSize,101,1,1,0,0,-2)}DrawBack(){if(!(this.pSelect.iCount<=0)){this.iFx=h.SCRW-40-30-272-30,this.iFy=h.SCRH-160-20-(20*(this.pSelect.iCount-1)+40+54*this.pSelect.iCount),this.iFw=332,this.iFh=20*(this.pSelect.iCount-1)+40+54*this.pSelect.iCount;var i=this.iFx+this.iFw/2,t=this.iFy+this.iFh;null==this.aa_frame&&(this.aa_frame=gn.xani_nui3.InitAnimaWithName("键盘框",null)),this.aa_frame.iFrame=0,this.aa_frame.Draw(this.iFx,this.iFy),this.aa_frame.iFrame=1,this.aa_frame.DrawEx(this.iFx+10,this.iFy,101,1*(this.iFw-20)/20,1,0,0,0),this.aa_frame.iFrame=2,this.aa_frame.Draw(this.iFx+this.iFw,this.iFy),this.aa_frame.iFrame=3,this.aa_frame.DrawEx(this.iFx+this.iFw,this.iFy+10,101,1,1*(this.iFh-20)/20,0,0,0),this.aa_frame.iFrame=4,this.aa_frame.Draw(this.iFx+this.iFw,this.iFy+this.iFh),this.aa_frame.iFrame=5,this.aa_frame.DrawEx(this.iFx+10,this.iFy+this.iFh,101,1*(this.iFw-20)/20,1,0,0,0),this.aa_frame.iFrame=6,this.aa_frame.Draw(this.iFx,this.iFy+this.iFh),this.aa_frame.iFrame=7,this.aa_frame.DrawEx(this.iFx,this.iFy+10,101,1,1*(this.iFh-20)/20,0,0,0),this.aa_frame.iFrame=8,this.aa_frame.DrawEx(this.iFx+10,this.iFy+10,101,1*(this.iFw-20)/20,1*(this.iFh-20)/20,0,0,0),this.aa_frame.iFrame=9,this.aa_frame.Draw(i,t)}}Draw_3(){var i;if(E.new_framewatch(40,h.SCRH-160,h.SCRW-80,150),gn.xani_nui4.DrawAnima(220,h.SCRH-10-37,"形象台",0),c.gi().DrawTextEx(220,h.SCRH-10-15,this.nd2.sName,4278206039,26,101,1,1,0,-2,-2),gn.xani_nui4.DrawAnima(220,h.SCRH-10-37,"形象背光",0),null==this.nd2.aa_shot?(this.res_shadow<0&&(this.res_shadow=c.gi().LoadFromFile("bk/sss.xxx",-1,!1)),c.gi().DrawImageEx(0,125,h.SCRH-10-37-251,this.res_shadow,2,0,183,251,101,1,1,0,0,0)):this.nd2.aa_shot.Draw(220,h.SCRH-10-37),Y.gi().FormatEx("#cc8f3f3"+this.nd2.sDetail,800,28,0,0,32),Y.gi().Draw(400,h.SCRH-160+(150-Y.gi().iH)/2),this.DrawBack(),this.pSelect.iCount>0)for(i=0;i<this.pSelect.iCount;i++)this.nd2.btn_sel[i].Move(h.SCRW-40-30-272,h.SCRH-160-20-(20*(this.pSelect.iCount-1)+40+54*this.pSelect.iCount)+20+74*i,272,54),this.nd2.btn_sel[i].Draw()}Draw_4(){if(gn.xani_nui4.DrawAnimaEx(0,0,"阴影",1,101,1*h.SCRW/20,1,0,0,0),gn.xani_nui4.DrawAnimaEx(0,h.SCRH,"阴影",0,101,1*h.SCRW/20,1,0,0,0),c.gi().DrawTextEx(h.SCRW-50,50,"点击屏幕继续 》",4285443272,30,101,1,1,0,-3,-3),500==this.nd1.iNpcId)return gn.xani_nui4.DrawAnima(h.SCRW-220,h.SCRH-10-37,"名字框",0),c.gi().DrawTextEx(h.SCRW-220,h.SCRH-10-15,this.nd1.sName,4285443272,26,101,1,1,0,-2,-2),gn.xani_nui4.DrawAnima(h.SCRW-220,h.SCRH-10-37,"形象背光",0),null!=this.nd1.aa_shot&&this.nd1.aa_shot.Draw(h.SCRW-220,h.SCRH-10-37),Y.gi().FormatEx("#cc8f3f3"+this.nd1.sDetail,800,28,0,0,32),void Y.gi().Draw(h.SCRW-400-Y.gi().iW,h.SCRH-160+(150-Y.gi().iH)/2);gn.xani_nui4.DrawAnima(220,h.SCRH-10-37,"名字框",0),c.gi().DrawTextEx(220,h.SCRH-10-15,this.nd1.sName,4285443272,26,101,1,1,0,-2,-2),gn.xani_nui4.DrawAnima(220,h.SCRH-10-37,"形象背光",0),null==this.nd1.aa_shot?(this.res_shadow<0&&(this.res_shadow=c.gi().LoadFromFile("bk/sss.xxx",-1,!1)),c.gi().DrawImageEx(0,125,h.SCRH-10-37-251,this.res_shadow,2,0,183,251,101,1,1,0,0,0)):this.nd1.aa_shot.Draw(220,h.SCRH-10-37),Y.gi().FormatEx("#cc8f3f3"+this.nd1.sDetail,800,28,0,0,32),Y.gi().Draw(400,h.SCRH-160+(150-Y.gi().iH)/2)}bHideUI(){return!(!this.bDialoging||4!=this.iDialogType)}Draw(){this.bDialoging&&(0==this.iDialogType?this.Draw_0():1==this.iDialogType?this.Draw_1():2==this.iDialogType?this.Draw_2():3==this.iDialogType?this.Draw_3():4==this.iDialogType&&this.Draw_4())}LockPoint(i,t){var s;for(this.iPoint=-1,s=0;s<this.pSelect.iCount;s++)if(this.bInRect(i,t,this.iOffX,this.iOffY+s*this.iTextSize*7/6,this.iW,7*this.iTextSize/6))return void(this.iPoint=s)}ProcTouch(i,t,s){if(!this.bDialoging)return!1;var e;if(3==this.iDialogType){if(this.pSelect.iCount>0&&bn.bInRect(t,s,this.iFx,this.iFy,this.iFw,this.iFh)){for(e=0;e<this.pSelect.iCount;e++)if(this.nd2.btn_sel[e].ProcTouch(i,t,s))return this.nd2.btn_sel[e].bCheck()&&(this.nd2.btn_sel[e].SetNormal(),this.bDialoging=!1,this.vbk.ProcBase(this.pSelect.next[e])),!0;return!0}return 3==i&&(this.bDialoging=!1),!0}if(4==this.iDialogType)return 1==i&&(this.bDown=!0),!this.bDown||(3==i&&(null==this.pSelect.next[0]?this.bDialoging=!1:4!=this.pSelect.next[0].iType&&(this.bDialoging=!1),this.vbk.ProcBase(this.pSelect.next[0]),this.bDown=!1),!0);if(1==this.iDialogType)return bn.get_ms()-this.tm1<this.tmwait||(1==i&&(this.bDown=!0),!this.bDown||(3==i&&(null==this.pSelect.next[0]?this.bDialoging=!1:4!=this.pSelect.next[0].iType&&(this.bDialoging=!1),this.vbk.ProcBase(this.pSelect.next[0])),!0));if(1==i&&(this.bDown=!0),!this.bDown)return!0;if(this.bInRect(t,s,this.iX,this.iY,this.iW,this.iH))switch(i){case 1:case 2:this.LockPoint(t,s);break;case 3:-1!=this.iPoint&&(this.bDialoging=!1,this.vbk.ProcBase(this.pSelect.next[this.iPoint]))}else 3==i&&(this.bDialoging=!1);return!0}bInRect(i,t,s,e,h,a){return!(i<=s)&&(!(t<=e)&&(!(i>=s+h)&&!(t>=e+a)))}}class ei extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=350,this.iH=200,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_ok=new Eh(gn.xani_nui3),this.btn_ok.InitButton("内框按钮"),this.btn_ok.Move(this.iX+10,this.iY+this.iH-60,70,40),this.btn_ok.sName="确定",this.btn_cancel=new Eh(gn.xani_nui3),this.btn_cancel.InitButton("内框按钮"),this.btn_cancel.Move(this.iX+this.iW-90,this.iY+this.iH-60,70,40),this.btn_cancel.sName="取消",ei.bFinished=!1}Draw(){Y.gi().FormatEx(ei.sDetail,this.iW-40,26,0,0,30),this.iH=20+Y.gi().iH+20+55+20,this.iY=(h.SCRH-this.iH)/2,this.btn_ok.Move(this.iX+20,this.iY+this.iH-70,98,55),this.btn_cancel.Move(this.iX+this.iW-98-20,this.iY+this.iH-70,98,55),E.new_framewatch(this.iX,this.iY,this.iW,this.iH),Y.gi().Draw(this.iX+20,this.iY+20),this.btn_ok.Draw(),this.btn_cancel.Draw()}ProcTouch(i,t,s){return this.btn_ok.ProcTouch(i,t,s)&&this.btn_ok.bCheck()&&(ei.bFinished=!0,ei.bConfirm=!0,ln.gi().PopStat(1)),this.btn_cancel.ProcTouch(i,t,s)&&this.btn_cancel.bCheck()&&(ei.bFinished=!0,ei.bConfirm=!1,ln.gi().PopStat(1)),!1}}ei.CONFIRM_UPGRADE=10,ei.CONFIRM_DROPGOODS=20,ei.CONFIRM_BREAKGOODS=21,ei.CONFIRM_DROPPET=30,ei.CONFIRM_INVITE=40,ei.CONFIRM_MYBUY=50,ei.CONFIRM_LEAVEGOV=60,ei.CONFIRM_UPGRADEGOV=61,ei.CONFIRM_SWAPGOV=62,ei.CONFIRM_GOVKICK=70,ei.CONFIRM_BUYSTORE=80,ei.CONFIRM_DROPMOUNTS=90,ei.CONFIRM_JJMOUNTS=100,ei.CONFIRM_ESCAPE=110,ei.CONFIRM_LEAVEFUBEN=120,ei.CONFIRM_STARTFUBEN=130,ei.CONFIRM_VIP=140,ei.CONFIRM_LOCK=150,ei.CONFIRM_UNLOCK=160,ei.CONFIRM_NOWAR=200,ei.CONFIRM_SWADD=201,ei.CONFIRM_FTDISMISS=202,ei.CONFIRM_FTKICK=203,ei.CONFIRM_FTTRANFER=204,ei.CONFIRM_FTMJ1=210,ei.CONFIRM_FTMJ2=211,ei.CONFIRM_FTMJ3=212,ei.CONFIRM_FTMJ4=213,ei.CONFIRM_FTMJ5=214,ei.CONFIRM_MERGEONE=250,ei.CONFIRM_MERGEALL=251,ei.CONFIRM_IMPROVEEQUIP=260,ei.CONFIRM_EXITAQ=270,ei.CONFIRM_FUSEPET=280,ei.CONFIRM_APPROVEPET=281,ei.CONFIRM_CHANGECOLOR=290,ei.CONFIRM_BACKGOV=300,ei.CONFIRM_GOVAPPOINT=301,ei.CONFIRM_GOVKICKMEMBER=302,ei.CONFIRM_GOVRELEASEENTRUST=303,ei.CONFIRM_GOVCANCELENTRUST=304,ei.CONFIRM_GOVGETENTRUST=305,ei.CONFIRM_GOVUPGRADE=306,ei.CONFIRM_GOVDISBAND=307,ei.CONFIRM_GOVCONVEY1=[310,311,312,313,314,315,316],ei.CONFIRM_GOVCONVEY2=[320,321,322,323,324,325,326],ei.CONFIRM_BACKTOSCHOOL=400,ei.CONFIRM_WASHROLEPOINT=500,ei.CONFIRM_OPENPOINTPLAN=501,ei.CONFIRM_SWAPPOINTPLAN=502,ei.CONFIRM_WASHPET=600,ei.CONFIRM_WASHPETBYINGOT=601,ei.CONFIRM_CANCELMISSION=700,ei.iCid,ei.bFinished=!1,ei.bConfirm,ei.iCid,ei.sDetail,ei.start=function(i,t){ln.gi().LastStatType(0)!=ln.GS_CONFIRM1&&(ei.iCid=i,ei.sDetail=t,ei.bFinished=!1,ln.gi().PushStat(ln.GS_CONFIRM1))},ei.end=function(i){return!(!ei.bFinished||ei.iCid!=i)&&(ei.iCid=0,ei.bFinished=!1,!0)};class hi{constructor(){this.MAXAAO=1024,this.iUseFlag=new Int32Array(this.MAXAAO),this.sName=new Array(this.MAXAAO),this.aa=new Array(this.MAXAAO);for(var i=0;i<this.MAXAAO;i++)this.iUseFlag[i]=0,this.aa[i]=new l,this.sName[i]=""}ClearFlag(){for(var i=0;i<this.MAXAAO;i++)this.iUseFlag[i]=0}AddAA(i,t){for(var s=0;s<this.MAXAAO;s++)if(0==this.iUseFlag[s])return this.iUseFlag[s]++,this.aa[s].copyfrom(i),this.sName[s]=t,s;return 0}GetAA(i,t){return i<0||i>=this.MAXAAO?null:this.sName[i]!=t?null:this.aa[i]}}class ai{constructor(){this.sMark="",this.xani=null,this.pnext=null}}class ni{constructor(){this.phead=null,this.pend=null}ReleaseAll(){this.phead=null,this.pend=null}LoadOleAnima(i,t){t="res/datapackage/"+t;for(var s=this.phead;null!=s;){if(s.sMark==i)return;s=s.pnext}if((s=new ai).xani=S._GET(t),null==s.xani);s.sMark=i,null==this.phead?(this.phead=s,this.pend=s):(this.pend.pnext=s,this.pend=s)}FindAnima(i){for(var t=this.phead;null!=t;){if(t.sMark==i)return t.xani;t=t.pnext}return null}}class oi{constructor(){this.iType=0,this.iX=0,this.iY=0,this.sName="",this.iLen=0,this.iXID=0,this.pup=null,this.pback=null,this.pfront=null,this.pdown=null}Init(){this.iType=0}SetName(i){this.sName=i}SetPos(i,t){this.iX=i,this.iY=t}GetBase(i){return null==i&&(i=this),null==i.pback?i:this.GetBase(i.pback)}copyfrom(i){this.iX=i.iX,this.iY=i.iY,this.sName=i.sName}GetCopy(){}}class ri extends oi{constructor(i){super(),this.phead=null,this.pend=null,this.pnext=null,this.pback=i}copyfrom(i){for(var t=i.phead;null!==t;)this.LinkFirst(t.GetCopy()),t=t.pdown;null!=i.pnext&&new ri(pback).copyfrom(i.pnext)}UnLinkFirst(i){if(null===this.phead)return null;if(this.phead===i)this.pend===i?(this.phead=null,this.pend=null,this.pfront=null):(this.phead=phead.pdown,this.pfront=this.phead,this.phead.pup=null);else{for(var t=this.phead.pdown;t!==i&&t!==this.pend;)t=t.pdown;t===i&&(t===this.pend&&(this.pend=t.pup),t.pup.pdown=t.pdown,null!==t.pdown&&(t.pdown.pup=t.pup))}return i.pup=null,i.pdown=null,i.pback=null,i}LinkFirst(i){null!==i&&(i.pback=this.pback,null===this.phead?(this.phead=i,this.pend=i,this.pfront=i,i.pup=null,i.pdown=null):(this.pend.pdown=i,i.pup=this.pend,i.pdown=null,this.pend=i))}AddClass(i){var t=null;switch(i){case 10:t=new X10_NUMBER;break;case 20:t=new X20_FLOAT;break;case 30:t=new X30_WORD;break;case 40:t=new X40_CLASS;break;case 50:t=new X50_CODE;break;case 60:t=new X60_DATA}return null!==t&&(SetXid(t),t.pback=this.pback,null===this.phead?(this.phead=t,this.pend=t,this.pfront=t,t.pup=null,t.pdown=null):(this.pend.pdown=t,t.pup=this.pend,t.pdown=null,this.pend=t)),t}FindFirst(i,t){for(var s=this.phead;null!==s;){if(s.sName===i)return s;if(t>0&&40===s.iType){var e=s.pca.FindFirst(i,t-1);if(null!==e)return e}s=s.pdown}return null}FindNumber(i,t){for(var s=this.phead;null!==s;){if(10===s.iType&&s.sName===i)return s;if(t>0&&40===s.iType){var e=s.pca.FindNumber(i,t-1);if(null!==e)return e}s=s.pdown}return null}FindFloat(i,t){for(var s=this.phead;null!==s;){if(20===s.iType&&s.sName===i)return s;if(t>0&&40===s.iType){var e=s.pca.FindFloat(i,t-1);if(null!==e)return e}s=s.pdown}return null}FindWord(i,t){for(var s=this.phead;null!==s;){if(30===s.iType&&s.sName===i)return s;if(t>0&&40===s.iType){var e=s.pca.FindWord(i,t-1);if(null!==e)return e}s=s.pdown}return null}FindClass(i,t){for(var s=this.phead;null!==s;){if(40===s.iType&&s.sName===i)return s;if(t>0&&40===s.iType){var e=s.pca.FindClass(i,t-1);if(null!==e)return e}s=s.pdown}return null}FindCode(i,t){for(var s=this.phead;null!==s;){if(50===s.iType&&s.sName===i)return s;if(t>0&&40===s.iType){var e=s.pca.FindCode(i,t-1);if(null!==e)return e}s=s.pdown}return null}FindData(i,t){for(var s=this.phead;null!==s;){if(60===s.iType&&s.sName===i)return s;if(t>0&&40===s.iType){var e=s.pca.FindData(i,t-1);if(null!==e)return e}s=s.pdown}return null}FindPoint(i,t){for(var s=this.phead;null!==s;){if(70===s.iType&&s.sName===i)return s;if(t>0&&40===s.iType){var e=s.pca.FindPoint(i,t-1);if(null!==e)return e}s=s.pdown}return null}FindMark(i){for(var t=this.phead;null!==t;){if(40===t.iType){var s=t;if(null===s.pca.phead)return null;if("唯一处理标识"===s.pca.phead.sName)if(10===s.pca.phead.iType)if(s.pca.phead.iNumber===i)return s;if(null!==(s=s.FindMark(i)))return s}t=t.pdown}return null}DeleteObj(){}}class ci extends oi{constructor(){super(),this.iType=40,this.iLen=8,this.sName="",this.iArray=1,this.pobj=null,this.pca=new ri(this),this.bOpenTree=!1}copyfrom(i){this.iX=i.iX,this.iY=i.iY,this.sName=i.sName,this.iArray=i.iArray}_NEW_x40(){var i,t,s,e;for(s=this.pca,i=1;i<this.iArray;i++){for(e=new ri(this),t=this.pca.phead;null!==t;)e.LinkFirst(t.GetCopy()),t=t.pdown;s.pnext=e,s=e}for(i=0;i<iArray;i++)for(t=pca.phead;null!=t;)40==t.iType&&t._NEW_x40(),t=t.pdown}MoveUpFirst(i){pca.MoveUpFirst(i)}MoveDownFirst(i){}UnLinkFirst(i){return this.pca.UnLinkFirst(i)}LinkFirst(i){this.pca.LinkFirst(i)}AddClass(i){return this.pca.AddClass(i)}FindFirst(i,t){return null==t&&(t=0),this.pca.FindFirst(i,t)}FindFirstByPath(i){for(var t=i.split("/"),s=null,e=1;e<t.length;e++)s=null==s?this.FindFirst(t[e]):s.FindFirst(t[e]);return s}FindNumber(i){return this.pca.FindNumber(i,0)}FindFloat(i){return this.pca.FindFloat(i,0)}FindWord(i){return this.pca.FindWord(i,0)}FindCode(i){return this.pca.FindCode(i,0)}FindClass(i){return this.pca.FindClass(i,0)}FindPoint(i){return this.pca.FindPoint(i,0)}FindMark(i){return this.pca.FindMark(i)}DeleteObj(){}GetCopy(){var i=new ci;i.copyfrom(this);for(var t=this.pca.phead;null!=t;)i.LinkFirst(t.GetCopy()),t=t.pdown;return i}}class li extends oi{constructor(){super(),this.iNumber=0,this.iType=10,this.iLen=4,this.iNumber=0}Set(i){this.iNumber=i}Get(){return this.iNumber}copyfrom(i){this.iX=i.iX,this.iY=i.iY,this.sName=i.sName,this.iNumber=i.iNumber}GetCopy(){var i=new li;return i.copyfrom(this),i}}class bi extends oi{constructor(){super(),this.fFloat=0,this.iType=20,this.iLen=4,this.sName="",this.fFloat=0}Set(i){this.fFloat=i}Get(){return this.fFloat}copyfrom(i){this.iX=i.iX,this.iY=i.iY,this.sName=i.sName,this.fFloat=i.fFloat}GetCopy(){var i=new bi;return i.copyfrom(this),i}}class _i extends oi{constructor(){super(),this.pword="",this.iType=30,this.iLen=8,this.sName="",this.pword=""}Set(i){this.pword=i}Get(){return this.pword}copyfrom(i){this.iX=i.iX,this.iY=i.iY,this.sName=i.sName,this.pword=i.pword}GetCopy(){var i=new _i;return i.copyfrom(this),i}}class fi{constructor(){}Draw(){}Draw(i,t){}ProcTouch(i,t,s){return!1}bInConrtolRect(i,t){return bn.bInRect(i,t,this.iOffX+this.iX,this.iOffY+this.iY,this.iW,this.iH)}DrawControlRect(i){var t,s=this.iX+this.iOffX,e=this.iY+this.iOffY,h=this.iW,a=this.iH;for(t=0;t<5;t++)i.DrawRect_2D(s-t,e-t,h+2*t,a+2*t,4294901760|255-50*t<<8)}}class ui extends fi{constructor(i,t,s){super(),this.iX=0,this.iY=0,this.pm3f=c.xm3f,this.pclass=t,this.prun=s,this.ReLoad()}ReLoad(){var i,t,s,e,h;null!=(s=this.pclass.FindClass("动画指向"))&&(i=s.FindWord("动画分类名"),t=s.FindWord("动画名"),null!=i&&null!=t&&this.Init(Ei.panimaole.FindAnima(i.pword),t.pword)),null!=(e=this.pclass.FindNumber("坐标X"))&&(this.iX=e.iNumber),null!=(e=this.pclass.FindNumber("坐标Y"))&&(this.iY=e.iNumber),null!=(e=this.pclass.FindNumber("绘制第几帧"))&&(this.xaa.iFrame=e.iNumber),null!=(e=this.pclass.FindNumber("透明度"))&&(this.iAlpha=e.iNumber),null!=(h=this.pclass.FindFloat("水平缩放"))&&(this.fSw=h.fFloat),null!=(h=this.pclass.FindFloat("垂直缩放"))&&(this.fSh=h.fFloat),null!=(e=this.pclass.FindNumber("旋转角度"))&&(this.iRa=e.iNumber),null!=(e=this.pclass.FindNumber("旋转锚点X"))&&(this.iRax=e.iNumber),null!=(e=this.pclass.FindNumber("旋转锚点Y"))&&(this.iRay=e.iNumber)}Init(i,t){this.xaa=i.InitAnimaWithName(t,null)}Move(i,t,s,e){this.iX=i,this.iY=t,this.iW=s,this.iH=e}Draw(i,t){this.xaa.DrawEx(this.iX+i,this.iY+t,this.iAlpha,this.fSw,this.fSh,this.iRa,this.iRax,this.iRay)}}class di extends fi{constructor(i,t,s){super(),this.exts=new Int32Array(16),this.pm3f=i,this.ClearButton(),this.pclass=t,this.prun=s,this.ReLoad()}ReLoad(){var i,t,s,e,h,a,n;null!=(t=this.pclass.FindWord("按钮文字"))&&(this.sName=t.pword),null!=(i=this.pclass.FindClass("动画指向"))&&(t=i.FindWord("动画分类名"),s=i.FindWord("动画名"),null!=t&&null!=s&&this.Init(Ei.panimaole.FindAnima(t.pword),s.pword)),null!=(i=this.pclass.FindMark(10))&&(e=i.FindNumber("坐标X"),h=i.FindNumber("坐标Y"),a=i.FindNumber("宽度"),n=i.FindNumber("高度"),null!=e&&null!=h&&null!=a&&null!=n&&this.Move(e.iNumber,h.iNumber,a.iNumber,n.iNumber))}ClearButton(){this.bSingleButton=!0,this.bMouseIn=!1,this.bMouseDown=!1,this.bVisible=!0,this.bDisable=!1,this.bChecked=!1,this.sName="",this.iX=0,this.iY=0,this.iOffX=0,this.iOffY=0}Init(i,t){this.xaa=i.InitAnimaWithName(t,null),this.xaa.iDelay>=0&&(this.bSingleButton=!1)}Move(i,t,s,e){this.iX=i,this.iY=t,this.iW=s,this.iH=e}Draw(i,t){if(this.iOffX=i,this.iOffY=t,this.bVisible)if(this.bDisable)this.pm3f.FillRect_2D(this.iX+this.iOffX,this.iY+this.iOffY,this.iX+this.iW,this.iY+this.iH,3238002687);else{for(;fn.gi().bInBound(this.iX,this.iY,this.iW,this.iH);)this.iX--;this.prun.RunCode(this.pclass.FindCode("自动执行")),this.bMouseIn?this.bMouseDown?this.bSingleButton?(this.pm3f.FillRect_2D(this.iX+this.iOffX,this.iY+this.iOffY,this.iX+this.iOffX+this.iW,this.iY+this.iOffY+this.iH,2164260863),this.pm3f.DrawRect_2D(this.iX+this.iOffX,this.iY+this.iOffY,this.iX+this.iOffX+this.iW,this.iY+this.iOffY+this.iH,4294967295)):this.xaa.Draw(this.iX+this.iOffX,this.iY+this.iOffY,1):this.bSingleButton?(this.pm3f.FillRect_2D(this.iX+this.iOffX,this.iY+this.iOffY,this.iX+this.iOffX+this.iW,this.iY+this.iOffY+this.iH,1090519039),this.pm3f.DrawRect_2D(this.iX+this.iOffX,this.iY+this.iOffY,this.iX+this.iOffX+this.iW,this.iY+this.iOffY+this.iH,4294967295)):this.xaa.Draw(this.iX+this.iOffX,this.iY+this.iOffY,0):this.bSingleButton?this.pm3f.DrawRect_2D(this.iX+this.iOffX,this.iY+this.iOffY,this.iX+this.iW+this.iOffX,this.iY+this.iH+this.iOffY,4294967295):this.xaa.Draw(this.iX+this.iOffX,this.iY+this.iOffY,0),this.sName.length>0&&(this.bSingleButton?this.pm3f.DrawTextEx(this.iX+this.iW/2+this.iOffX,this.iY+this.iH/2+this.iOffY,this.sName,4294967295,15,101,1,1,0,-2,-2):this.pm3f.DrawTextEx(this.iX+this.iW/2+this.iOffX,this.iY+this.iH/2+this.iOffY,this.sName,4294967040,30,101,1,1,0,-2,-2))}}ProcTouch(i,t,s){if(!this.bVisible)return!1;if(this.bDisable)return!1;if(!this.bMoveIn(t,s))return this.bMouseDown=!1,!1;switch(i){case 1:this.bMouseDown=!0;break;case 2:break;case 3:this.bMouseDown&&(this.bMouseDown=!1,this.bChecked=!0,this.prun.RunCode(this.pclass.FindCode("点击执行")))}return!0}bMoveIn(i,t){return this.bMouseIn=!1,this.bSingleButton,i>=this.iX+this.iOffX&&i<=this.iX+this.iW+this.iOffX&&t>=this.iY+this.iOffY&&t<=this.iY+this.iH+this.iOffY?this.bMouseIn=!0:this.bMouseIn=!1,this.bMouseIn}IsChecked(){return!!this.bChecked&&(this.bChecked=!1,!0)}}class pi{constructor(i){this.pani=i,this.pm3f=i.pm3f,this.bMouseDown=!1,this.sDetail="",this.sBackPrompt="",this.bDetailChanged=!1,this.bFinished=!1,this.bHideText=!1,this.iTextSize=30,this.iBackSize=30,this.bNumber=!1,this.iMaxNumber=2147483647,this.iLength=64,this.iTextColor=4294967295,this.bShowing=!1}onscr(){this.ph=pi.GetFreeHandle(this),this.ph.handle.focus||(this.ph.handle.pos(this.iX,this.iY),this.ph.handle.width=this.iW,this.ph.handle.height=this.iH),this.ph.iLife=3}Draw(){this.bShowing=!0,this.bMouseDown&&this.pm3f.FillRect_2D(this.iX,this.iY,this.iX+this.iW,this.iY+this.iH,1090519039),this.pm3f.DrawRect_2D(this.iX,this.iY,this.iX+this.iW,this.iY+this.iH,4294967295),this.DrawText()}DrawText(){this.bShowing=!0,this.bHideText||(this.pm3f.SetViewClip(this.iX,this.iY,this.iX+this.iW,this.iY+this.iH),this.sDetail.length<=0?this.sBackPrompt.length>0&&this.pm3f.DrawTextEx(this.iX+5,this.iY+this.iH/2,this.sBackPrompt,805306368,this.iBackSize,101,1,1,0,0,-2):this.pm3f.DrawTextEx(this.iX+5,this.iY+this.iH/2,this.sDetail,this.iTextColor,this.iTextSize,101,1,1,0,0,-2),this.pm3f.NoClip())}OpenInput(){this.bDetailChanged=!1,this.bFinished=!1,this.bMouseDown=!1,this.ph=pi.GetFreeHandle(this),this.ph.handle.text=this.sDetail,bn.sop("OpenInput")}bChanged(){return!!this.bDetailChanged&&(this.bDetailChanged=!1,!0)}ProcTouch(i,t,s){if(!bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH))return this.bMouseDown=!1,!1;switch(i){case Gh.TOUCH_DOWN:this.bMouseDown=!0;break;case Gh.TOUCH_UP:this.OpenInput()}return!0}Move(i,t,s,e){this.iX=i,this.iY=t,this.iW=s,this.iH=e}}pi.init_handle=function(){var i=new Laya.TextInput(this.sDetail);return i.width=200,i.height=50,i.pos(0,-50),i.maxChars=64,i.color="#ffffff",i.bgColor="#303030",i.fontSize=22,i.alpha=.01,i.textField.alpha=.01,Laya.stage.addChild(i),i},pi.input_handle=null,pi.lock_x=null,pi.move_handle=function(i,t,s,e){pi.input_handle.width=s,pi.input_handle.height=e,pi.input_handle.pos(i,t)};class mi{constructor(){this.bUseing=!1,this.handle=pi.init_handle(),this.iLife=3,this.pinput=null}Logic(){this.iLife>0?(this.iLife--,this.pinput.sDetail=this.handle.text):(this.bUseing=!1,this.iLife=3,this.handle.pos(-5,-5),this.handle.width=1,this.handle.height=1,this.handle.text="")}Logic2(){this.handle.focus&&(this.handle.pos(-5,-5),this.handle.width=1,this.handle.height=1)}}mi.pp=new Array,pi.make_handle=function(){for(var i=0;i<10;i++)mi.pp[i]=new mi},pi.GetFreeHandle=function(i){for(var t=0;t<mi.pp.length;t++)if(mi.pp[t].bUseing&&mi.pp[t].pinput==i)return mi.pp[t];for(t=0;t<mi.pp.length;t++)if(0==mi.pp[t].bUseing)return mi.pp[t].bUseing=!0,mi.pp[t].pinput=i,mi.pp[t].handle.text="",mi.pp[t];return mi.pp[t]=new mi,mi.pp[t].bUseing=!0,mi.pp[t].pinput=i,mi.pp[t].handle.text="",mi.pp[t]},pi.HandleLogic=function(){for(var i=0;i<mi.pp.length;i++)mi.pp[i].bUseing&&mi.pp[i].Logic()},pi.HandleLogic2=function(){for(var i=0;i<mi.pp.length;i++)mi.pp[i].bUseing&&mi.pp[i].Logic2()};class gi extends fi{constructor(i,t,s){super(),this.iX=0,this.iY=0,this.pm3f=i,this.pclass=t,this.prun=s,this.ReLoad()}ReLoad(){var i,t,s,e;if(null!=(i=this.pclass.FindNumber("坐标X"))&&(this.iX=i.iNumber),null!=(i=this.pclass.FindNumber("坐标Y"))&&(this.iY=i.iNumber),null!=(s=this.pclass.FindWord("文字内容"))&&(this.sText=s.pword),gn.sop("Reload Text = "+this.sText),null!=(s=this.pclass.FindWord("颜色"))){var h=0;for(this.iColor=0;s.pword.length>h;)s.pword.charAt(h)>="0"&&s.pword.charAt(h)<="9"?this.iColor=this.iColor<<4|s.pword.charAt(h)-"0":s.pword.charAt(h)>="a"&&s.pword.charAt(h)<="f"?this.iColor=this.iColor<<4|s.pword.charAt(h)-"a"+10:s.pword.charAt(h)>="A"&&s.pword.charAt(h)<="F"&&(this.iColor=this.iColor<<4|s.pword.charAt(h)-"A"+10),h++;this.iColor|=4278190080}if(null!=(i=this.pclass.FindNumber("文字大小"))&&(this.iSize=i.iNumber),null!=(i=this.pclass.FindNumber("透明度"))&&(this.iAlpha=i.iNumber),null!=(t=this.pclass.FindFloat("水平缩放"))&&(this.fSw=t.fFloat),null!=(t=this.pclass.FindFloat("垂直缩放"))&&(this.fSh=t.fFloat),null!=(i=this.pclass.FindNumber("旋转角度"))&&(this.iRa=i.iNumber),null!=(i=this.pclass.FindNumber("旋转锚点X"))&&(this.iRax=i.iNumber),null!=(i=this.pclass.FindNumber("旋转锚点Y"))&&(this.iRay=i.iNumber),null==e)this.bStroke=!1;else if(this.bStroke=!0,null!=(i=e.FindNumber("类型"))&&(this.iStrokeType=i.iNumber),null!=(s=e.FindWord("颜色"))){h=0;for(this.iStrokeColor=0;s.pword.length>h;)s.pword.charAt(h)>="0"&&s.pword.charAt(h)<="9"?this.iStrokeColor=this.iStrokeColor<<4|s.pword.charAt(h)-"0":s.pword.charAt(h)>="a"&&s.pword.charAt(h)<="f"?this.iStrokeColor=this.iStrokeColor<<4|s.pword.charAt(h)-"a"+10:s.pword.charAt(h)>="A"&&s.pword.charAt(h)<="F"&&(this.iStrokeColor=this.iStrokeColor<<4|s.pword.charAt(h)-"A"+10),h++;this.iStrokeColor|=4278190080}null==(e=this.pclass.FindClass("格式化输出"))?this.bFormat=!1:(this.bFormat=!0,null!=(i=e.FindNumber("行宽"))&&(this.iFormatW=i.iNumber),null!=(i=e.FindNumber("行高"))&&(this.iFormatH=i.iNumber))}Move(i,t,s,e){this.iX=i,this.iY=t,this.iW=s,this.iH=e}Draw(i,t){this.iOffX=i,this.iOffY=t,this.bFormat?(Y.gi().FormatEx(this.sText,this.iFormatW,this.iSize,this.bStroke?this.iStrokeType:0,this.iStrokeColor,this.iFormatH),Y.gi().Draw(this.iX+i,this.iY+t),this.iTextX=this.iX+i,this.iTextY=this.iY+t,this.iTextW=Y.gi().iW,this.iTextH=Y.gi().iH):(this.bStroke?this.pm3f.DrawText_2(this.iX+i,this.iY+t,this.sText,this.iColor,this.iSize,this.iAlpha,this.fSw,this.fSh,this.iRa,this.iRax,this.iRay,this.iStrokeType,this.iStrokeColor):this.pm3f.DrawTextEx(this.iX+i,this.iY+t,this.sText,this.iColor,this.iSize,this.iAlpha,this.fSw,this.fSh,this.iRa,this.iRax,this.iRay),this.iTextX=this.pm3f.drawrect[0],this.iTextY=this.pm3f.drawrect[1],this.iTextW=this.pm3f.drawrect[2]-this.pm3f.drawrect[0],this.iTextH=this.pm3f.drawrect[3]-this.pm3f.drawrect[1])}bInConrtolRect(i,t){return bn.bInRect(i,t,this.iTextX,this.iTextY,this.iTextW,this.iTextH)}DrawControlRect(i){var t,s=this.iTextX,e=this.iTextY,h=this.iTextW,a=this.iTextH;for(t=0;t<5;t++)this.pm3f.DrawRect_2D(s-t,e-t,h+2*t,a+2*t,4294901760|255-50*t<<8)}}class wi extends fi{constructor(i,t,s){super(),this.pm3f=i,this.xin=null,this.pclass=t,this.prun=s,this.ReLoad()}ReLoad(){var i,t,s,e,h,a,n;null!=(i=this.pclass.FindClass("框体区域"))&&(t=i.FindNumber("坐标X"),s=i.FindNumber("坐标Y"),e=i.FindNumber("宽度"),h=i.FindNumber("高度"),null!=t&&null!=s&&null!=e&&null!=h&&this.Move(t.iNumber,s.iNumber,e.iNumber,h.iNumber)),null!=(i=this.pclass.FindClass("动画指向"))&&(a=i.FindWord("动画分类名"),n=i.FindWord("动画名"),null!=a&&null!=n&&this.Init(Ei.panimaole.FindAnima(a.pword),n.pword)),null!=(a=this.pclass.FindWord("框体类型"))&&("整框"==a.pword?this.iFrameType=0:"横向框"==a.pword&&(this.iFrameType=1)),null!=(t=this.pclass.FindNumber("动画单位宽"))&&(this.iBw=t.iNumber),null!=(t=this.pclass.FindNumber("动画单位高"))&&(this.iBh=t.iNumber),null!=(i=this.pclass.FindClass("可输入"))?(this.bCanInput=!0,i.pobj=new gi(this.pm3f,i,this.prun),this.pinput=i.pobj,this.px30_word=i.FindWord("文字内容")):this.bCanInput=!1,a=this.pclass.FindWord("默认隐藏"),this.bHide=null!=a}Init(i,t){this.faa=i.InitAnimaWithName(t,null)}Move(i,t,s,e){this.iX=i,this.iY=t,this.iW=s,this.iH=e}SetDetail(i){this.px30_word.Set(i),this.pinput.sText=i}Draw(i,t){if(!this.bHide){this.iOffX=i,this.iOffY=t;var s=this.iX+i,e=this.iY+t,h=1,a=1;this.iBw+this.iBw>this.iW&&(h=.5*this.iW/this.iBw),this.iBh+this.iBh>this.iH&&(a=.5*this.iH/this.iBh),0==this.iFrameType?(this.iW-this.iBw-this.iBw>0&&this.iH-this.iBh-this.iBh>0&&this.faa.DrawEx(s+this.iBw-2,e+this.iBh-2,8,101,1*(this.iW-this.iBw-this.iBw+4)/this.iBw,1*(this.iH-this.iBh-this.iBh+4)/this.iBh,0,0,0),this.iW-this.iBw-this.iBw>0&&this.faa.DrawEx(s+this.iBw-2,e,1,101,1*(this.iW-this.iBw-this.iBw+4)/this.iBw,1,0,0,0),this.iH-this.iBh-this.iBh>0&&this.faa.DrawEx(s+this.iW-this.iBw,e+this.iBh-2,3,101,1,1*(this.iH-this.iBh-this.iBh+4)/this.iBh,0,0,0),this.iW-this.iBw-this.iBw>0&&this.faa.DrawEx(s+this.iBw-2,e+this.iH-this.iBh,5,101,1*(this.iW-this.iBw-this.iBw+4)/this.iBw,1,0,0,0),this.iH-this.iBh-this.iBh>0&&this.faa.DrawEx(s,e+this.iBh-2,7,101,1,1*(this.iH-this.iBh-this.iBh+4)/this.iBh,0,0,0),this.faa.DrawEx(s,e,0,101,h,a,0,0,0),this.faa.DrawEx(s+this.iW-h*this.iBw,e,2,101,h,a,0,0,0),this.faa.DrawEx(s+this.iW-h*this.iBw,e+this.iH-a*this.iBh,4,101,h,a,0,0,0),this.faa.DrawEx(s,e+this.iH-a*this.iBh,6,101,h,a,0,0,0)):1==this.iFrameType&&(this.faa.Draw(s,e,0),this.iW-this.iBw-this.iBw>0&&this.faa.DrawEx(s+this.iBw,e,1,101,1*(this.iW-this.iBw-this.iBw)/this.iBw,1,0,0,0),this.faa.Draw(s+this.iW-this.iBw,e,2)),this.bCanInput&&(this.pinput.Draw(s,e),null!=this.xin&&this.xin.bChanged()&&this.SetDetail(this.xin.sDetail)),null!=this.xin&&this.xin.onscr()}}ProcTouch(i,t,s){return!this.bHide&&(!(!this.bCanInput||!bn.bInRect(t,s,this.iOffX+this.iX,this.iOffY+this.iY,this.iW,this.iH))&&(3==i&&(null==this.xin&&(this.xin=new pi(gn.xani_ui)),this.xin.sDetail=this.pinput.sText,this.xin.OpenInput()),!0))}}class xi{constructor(){this.pnext=null,this.pfiled=new Array(32),this.pcoverframe=new Array(32)}}class Si{constructor(){pframe=null,bDown=!1}}class Di extends fi{constructor(i,t,s){super(),this.iX=0,this.iY=0,this.plines=null,this.iScrollY=0,this.bTouchDown=!1,this.bLockScroll=!1,this.iSelectLine=-1,this.pm3f=c.xm3f,this.pclass=t,this.prun=s,this.ReLoad()}ReLoad(){var i,t,s,e,h,a,n,o,r,c;if(null!=(s=this.pclass.FindClass("列表区域"))&&(a=s.FindNumber("坐标X"),n=s.FindNumber("坐标Y"),o=s.FindNumber("宽度"),r=s.FindNumber("高度"),null!=a&&null!=n&&null!=o&&null!=r&&this.Move(a.iNumber,n.iNumber,o.iNumber,r.iNumber)),null!=(a=this.pclass.FindNumber("列数"))&&(this.iTitleCount=a.iNumber),null!=(a=this.pclass.FindNumber("标题高度"))&&(this.iTitleHeight=a.iNumber),this.ptitles=new Array(this.iTitleCount),null!=(e=this.pclass.FindClass("标题")))for(i=0;i<this.iTitleCount;i++)this.ptitles[i]=new Si,null!=(s=e.FindClass("标题"+(i+1)))&&(null!=(a=s.FindNumber("宽度"))&&(this.ptitles[i].iWidth=a.iNumber),null!=(c=s.FindWord("标题名"))&&(this.ptitles[i].sName=c.pword),null!=(c=s.FindWord("类型"))&&"容器"==c.pword&&(this.ptitles[i].iType=2),null!=(c=s.FindWord("对齐方式"))&&"中"==c.pword&&(this.ptitles[i].iLocate=1),null!=(h=s.FindClass("背景框"))&&this.iTitleHeight>0&&(this.ptitles[i].pframe=new XmsCFrame(this.pm3f,h,this.prun),h.pobj=this.ptitles[i].pframe));if(t=0,null!=(e=this.pclass.FindClass("行内容")))for(;null!=(s=e.FindClass("行内容"+(t+1)));){var l=s.pca.phead,b=this.AddLine();for(i=0;i<this.iTitleCount;i++)switch(this.ptitles[i].iType){case 2:b.pfiled[i]=new XmsCOle(this.pm3f,l,this.prun),null!=(h=s.FindFirst("选中覆盖框",5))&&(b.pcoverframe[i]=h.pobj)}l=l.pdown,t++}null==(c=this.pclass.FindWord("标题可开关"))?this.iSwitch=0:"开"==c.pword?this.iSwitch=1:this.iSwitch=2}Move(i,t,s,e){this.iX=i,this.iY=t,this.iW=s,this.iH=e}AddLine(){if(null==this.plines)return this.plines=new xi,this.plines;for(var i=this.plines;null!=i.pnext;)i=i.pnext;return i.pnext=new xi,i.pnext}Draw(i,t){var s,e,h,a,n;if(this.iOffX=i,this.iOffY=t,a=this.iX+i,n=this.iY+t,this.pm3f.DrawRect_2D(a,n,a+this.iW,n+this.iH,4294967295),this.iTitleHeight>0){for(e=0,s=0;s<this.iTitleCount;s++)this.iTitleHeight>0&&null!=this.ptitles[s].pframe&&this.ptitles[s].pframe.Draw(a+e,n),this.ptitles[s].sName.length>0&&this.pm3f.DrawTextEx(a+e+this.ptitles[s].iWidth/2,n+this.iTitleHeight/2,this.ptitles[s].sName,4294967295,30,101,1,1,0,-2,-2),e+=this.ptitles[s].iWidth;n+=this.iTitleHeight,this.pm3f.DrawLine(a,n,a+this.iW,n,4294967295)}if(2!=this.iSwitch){this.pm3f.SetViewClip(a,n,a+this.iW,n+this.iH-this.iTitleHeight);var o,r=this.plines;for(e=0,h=0;null!=r;){if(this.iSelectLine==h)for(o=0,s=0;s<this.iTitleCount;s++){if(2==this.ptitles[s].iType)o<(c=r.pfiled[s]).iH+(c.bHaveExtend&c.bShowExtend?c.pExtend.iH:0)&&(o=c.iH+(c.bHaveExtend&c.bShowExtend?c.pExtend.iH:0))}for(o=0,s=0;s<this.iTitleCount;s++)if(2==this.ptitles[s].iType){var c=r.pfiled[s];this.iSelectLine==h?(null!=r.pcoverframe[s]&&(r.pcoverframe[s].bHide=!1),c.bShowExtend=!0):this.iSelectLine>=0&&(c.bShowExtend=!1,null!=r.pcoverframe[s]&&(r.pcoverframe[s].bHide=!0)),c.Draw(a,n+e+this.iScrollY),o<c.iH+(c.bHaveExtend&c.bShowExtend?c.pExtend.iH:0)&&(o=c.iH+(c.bHaveExtend&c.bShowExtend?c.pExtend.iH:0))}e+=o,h++,r=r.pnext}this.iDetailHeight=e,this.pm3f.NoClip(),1==this.iSwitch&&(this.iH=this.iTitleHeight+this.iDetailHeight),this.bLockScroll||(this.iDetailHeight<this.iH-this.iTitleHeight?this.iScrollY>10||this.iScrollY<-10?this.iScrollY/=2:this.iScrollY=0:(e=-(this.iDetailHeight-(this.iH-this.iTitleHeight)),this.iScrollY<e&&((s=e-this.iScrollY)>10&&(s/=2),this.iScrollY+=s),this.iScrollY>0&&(this.iScrollY>10?this.iScrollY/=2:this.iScrollY=0)))}else this.iH=this.iTitleHeight}CleanSelect(){for(var i,t=this.plines;null!=t;){for(i=0;i<this.iTitleCount;i++)2==this.ptitles[i].iType&&null!=t.pcoverframe[i]&&(t.pcoverframe[i].bHide=!0);t=t.pnext}this.iSelectLine=-1}ProcTouch(i,t,s){if(t-=this.iOffX,s-=this.iOffY,this.bTouchDown){if(2==i){if(this.bLockScroll)return 0==this.iSwitch&&(this.iScrollY-=this.iLockY-s,this.iLockY=s),!0;Math.abs(this.iLockY-s)>10&&(0==this.iSwitch?(this.iLockY=s,this.bLockScroll=!0):this.bTouchDown=!1)}if(3==i){if(this.bLockScroll)return this.bLockScroll=!1,this.bTouchDown=!1,!0;this.iSelectLine=this.iSelectLineTmp,this.bTouchDown=!1}}if(bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)){var e,h,a=this.plines,n=0,o=0;if(this.iTitleHeight>0)for(e=0;e<this.iTitleCount;e++)null!=this.ptitles[e].pframe&&this.ptitles[e].pframe.bInConrtolRect(this.iOffX+t,this.iOffY+s)&&(1==i?this.ptitles[e].bDown=!0:3==i&&this.ptitles[e].bDown&&(this.ptitles[e].bDown=!1,1==this.iSwitch?this.iSwitch=2:2==this.iSwitch&&(this.iSwitch=1)));if(2==this.iSwitch)return!1;for(this.iSelectLineTmp=-1;null!=a;){for(h=0,e=0;e<this.iTitleCount;e++)if(2==this.ptitles[e].iType){var r=a.pfiled[e];if(r.ProcTouch(i,t+this.iOffX,s+this.iOffY))return!0;h<r.iH+(r.bHaveExtend&r.bShowExtend?r.pExtend.iH:0)&&(h=r.iH+(r.bHaveExtend&r.bShowExtend?r.pExtend.iH:0))}s-this.iTitleHeight>=this.iY+n+this.iScrollY&&s-this.iTitleHeight<=this.iY+n+this.iScrollY+h&&(this.iSelectLineTmp=o),n+=h,o++,a=a.pnext}return 1==i&&(this.bTouchDown=!0,this.iLockY=s),!(this.iSwitch>0)}return this.bTouchDown=!1,!1}}class Ti{constructor(){this.pobj=null,this.pnext=null}}class Ci extends fi{SetPos(i){this.iPos=i}SetRange(i){this.iRange=i,this.iMax=i}IsChanged(){return!!this.bChanged&&(this.bChanged=!1,!0)}constructor(i,t,s){super(),this.pm3f=i,this.bLock=!1,this.iRange=1e4,this.iPos=0,this.iMin=0,this.iMax=1e4,this.bChanged=!1,this.pclass=t,this.prun=s,this.ReLoad()}ReLoad(){var i,t,s,e,h;null!=(i=this.pclass.FindClass("背景条"))&&(i.pobj=new wi(this.pm3f,i,this.prun),this.pline=i.pobj),null!=(i=this.pclass.FindClass("滑块"))&&(i.pobj=new ui(this.pm3f,i,this.prun),this.pblock=i.pobj),null!=(i=this.pclass.FindClass("滑杆区域"))&&(t=i.FindNumber("坐标X"),s=i.FindNumber("坐标Y"),e=i.FindNumber("宽度"),h=i.FindNumber("高度"),null!=t&&null!=s&&null!=e&&null!=h&&this.Move(t.iNumber,s.iNumber,e.iNumber,h.iNumber)),null!=(i=this.pclass.FindClass("滑块大小"))&&(e=i.FindNumber("宽度"),h=i.FindNumber("高度"),null!=e&&null!=h&&(this.iBlockW=e.iNumber,this.iBlockH=h.iNumber))}Move(i,t,s,e){this.iX=i,this.iY=t,this.iW=s,this.iH=e}Draw(i,t){this.iOffX=i,this.iOffX=t,this.pline.Draw(i+this.iX,t+this.iY),this.pblock.Draw(i+this.iX-this.iBlockW/2+this.iPos*this.iW/this.iRange,t+this.iY+this.iH/2-this.iBlockH/2)}ProcTouch(i,t,s){if(3==i)return this.bLock=!1,!1;t-=(h.SCRW-1280)/2;var e=this.iPos;if(this.bLock&&2==i){var a=(this.iLockX-t)*this.iRange/this.iW;return gn.sop("this.iPos="+this.iPos+"this.iLockX="+this.iLockX+"x="+t+"j="+a+"---------"+this.iRange+"=mmmmm="+this.iW),0!=a&&(this.iPos-=(this.iLockX-t)*this.iRange/this.iW,this.iPos<this.iMin&&(this.iPos=this.iMin),this.iPos>this.iRange&&(this.iPos=this.iRange),this.iPos>this.iMax&&(this.iPos=this.iMax),this.iLockX=t),gn.sop("this.iPos="+this.iPos),e!=this.iPos&&(this.bChanged=!0),!0}if(bn.bInRect(t,s,this.iOffX+this.iX-this.iBlockW/2,this.iOffX+this.iY,this.iW+this.iBlockW,this.iH)&&1==i)return this.bLock=!0,this.iLockX=t,(t<(a=this.iOffX+this.iX+this.iPos*this.iW/this.iRange)-this.iBlockW/2||t>a+this.iBlockW/2)&&(this.iPos=(t-this.iOffX-this.iX)*this.iRange/this.iW,this.iPos<this.iMin&&(this.iPos=this.iMin),this.iPos>this.iRange&&(this.iPos=this.iRange),this.iPos>this.iMax&&(this.iPos=this.iMax)),e!=this.iPos&&(this.bChanged=!0),!0;return!1}}class ki extends fi{constructor(i,t,s){super(),this.iX=0,this.iY=0,this.plc=null,this.pm3f=i,this.pclass=t,this.prun=s,this.ReLoad()}ReLoad(){var i,t,s,e,h,a;if(null!=(i=this.pclass.FindClass("容器区域"))&&(s=i.FindNumber("坐标X"),e=i.FindNumber("坐标Y"),h=i.FindNumber("宽度"),a=i.FindNumber("高度"),null!=s&&null!=e&&null!=h&&null!=a&&this.Move(s.iNumber,e.iNumber,h.iNumber,a.iNumber)),null!=(i=this.pclass.FindClass("内容")))for(var n=i.pca.phead;null!=n;){if(40==n.iType&&null!=(t=n).pca.phead&&10==t.pca.phead.iType&&"唯一处理标识"==t.pca.phead.sName)switch((s=t.pca.phead).iNumber){case 101:t.pobj=new di(this.pm3f,t,this.prun),this.AddControl(ki.CTYPE_BUTTON,t.pobj);break;case 201:t.pobj=new wi(this.pm3f,t,this.prun),this.AddControl(ki.CTYPE_FRAME,t.pobj);break;case 203:t.pobj=new gi(this.pm3f,t,this.prun),this.AddControl(ki.CTYPE_TEXT,t.pobj);break;case 202:t.pobj=new ui(this.pm3f,t,this.prun),this.AddControl(ki.CTYPE_ANIMA,t.pobj);break;case 102:t.pobj=new Di(this.pm3f,t,this.prun),this.AddControl(ki.CTYPE_LIST,t.pobj);break;case 105:t.pobj=new Ci(this.pm3f,t,this.prun),this.AddControl(ki.CTYPE_SLIDER,t.pobj);break;case 103:t.pobj=new ki(this.pm3f,t,this.prun),this.AddControl(ki.CTYPE_OLE,t.pobj)}n=n.pdown}null!=(i=this.pclass.FindClass("扩展下拉容器"))?(this.pExtend=new ki(this.pm3f,i,this.prun),this.bHaveExtend=!0):this.bHaveExtend=!1,this.bShowExtend=!0}Move(i,t,s,e){this.iX=i,this.iY=t,this.iW=s,this.iH=e}AddControl(i,t){var s;if(null==this.plc)this.plc=new Ti,s=this.plc;else{for(s=this.plc;null!=s.pnext;)s=s.pnext;s.pnext=new Ti,s=s.pnext}s.iType=i,s.pobj=t}Draw(i,t){this.iOffX=i,this.iOffY=t;var s,e,h=this.plc,a=i+this.iX,n=t+this.iY;for(this.pm3f.DrawRect_2D(a,n,a+this.iW,n+this.iH,4294967295),this.bHaveExtend&&this.bShowExtend&&this.pExtend.Draw(i,t),this.iH=0;null!=h;)(s=h.pobj).Draw(a,n),(e=s.iY+s.iH)>this.iH&&(this.iH=e),h=h.pnext}ProcTouch(i,t,s){t-=this.iOffX,s-=this.iOffY;for(var e=this.plc;null!=e;){switch(e.iType){case CTYPE_BUTTON:case CTYPE_FRAME:case CTYPE_LIST:case CTYPE_SLIDER:case CTYPE_OLE:if(e.pobj.ProcTouch(i,t+this.iOffX,s+this.iOffY))return!0}e=e.pnext}return!(!this.bHaveExtend||!this.bShowExtend)&&this.pExtend.ProcTouch(i,t,s)}}fi.CTYPE_BUTTON=1,fi.CTYPE_FRAME=2,fi.CTYPE_TEXT=3,fi.CTYPE_ANIMA=4,fi.CTYPE_LIST=5,fi.CTYPE_SLIDER=6,fi.CTYPE_OLE=7;class Ai{constructor(){}}class Ii extends fi{constructor(i,t,s){super(),this.iX=0,this.iY=0,this.pm3f=i,this.ptablist=new Array(16);for(var e=0;e<16;e++)this.ptablist[e]=new Ai;this.iTabPoint=0,this.pclass=t,this.prun=s,this.ReLoad()}ReLoad(){for(var i,t,s,e=0;null!=(i=this.pclass.FindClass("标签"+(e+1)))&&null!=(t=i.FindClass("标签按钮"))&&null!=(s=i.FindClass("标签容器"));)t.pobj=new XmsCButton(this.pm3f,t,this.prun),s.pobj=new XmsCOle(this.pm3f,s,this.prun),this.AddTab(t.pobj,s.pobj),e++}Move(i,t,s,e){this.iX=i,this.iY=t,this.iW=s,this.iH=e}Draw(i,t){var s;for(this.iOffX=i,this.iOffY=t,s=0;s<this.iTabListCount;s++)s==this.iTabPoint&&this.ptablist[s].pole.Draw(i,t),this.ptablist[s].pbtn.Draw(i,t)}ProcTouch(i,t,s){var e;for(e=0;e<this.iTabListCount;e++){if(e==this.iTabPoint&&this.ptablist[e].pole.ProcTouch(i,t,s))return!0;if(this.ptablist[e].pbtn.ProcTouch(i,t,s))return this.ptablist[e].pbtn.IsChecked()&&(this.iTabPoint=e),!0}return!1}AddTab(i,t){this.iTabListCount<16&&(this.ptablist[this.iTabListCount].pbtn=i,this.ptablist[this.iTabListCount].pole=t,this.iTabListCount++)}}class Pi extends s{constructor(){super(),this.bClose=!1}_Init(){Pi.paaole=Ei.paaole,Pi.panimaole=Ei.panimaole,this.pm3f=c.gi(),this.pbaseclass=this.prunclass.GetBase(),this.prunclass=this.prunclass.GetCopy(),this.pface=this.prunclass,this.InitBefore(),this.InitMemory(this.pbaseclass.FindFirst("初始化",3)),this.InitMemory(this.prunclass),this.InitAfter()}InitBefore(){}InitAfter(){this.RunCode(this.prunclass.FindCode("初始化后执行"))}Draw(){this._Draw()}ProcTouch(i,t,s){return!!this._ProcTouch(i,t,s)}InitMemory(i){var t,s,e,a;if(10==i.iType&&"唯一处理标识"==i.sName){var n=i;switch(t=n.pback,n.iNumber){case 301:Pi.panimaole.LoadOleAnima(t.FindWord("载入到索引").pword,t.FindWord("动画文件").pword);break;case 501:Pi.SCRW=t.FindNumber("屏幕宽度").iNumber,Pi.SCRH=t.FindNumber("屏幕高度").iNumber,Pi.SCRW=h.SCRW,Pi.SCRH=h.SCRH;break;case 101:return t.pobj=new di(this.pm3f,t,this),!0;case 102:return t.pobj=new Di(this.pm3f,t,this),!0;case 103:return t.pobj=new ki(this.pm3f,t,this),!0;case 104:return t.pobj=new Ii(this.pm3f,t,this),!0;case 105:return t.pobj=new Ci(this.pm3f,t,this),!0;case 201:return t.pobj=new wi(this.pm3f,t,this),!0;case 202:return t.pobj=new ui(this.pm3f,t,this),!0;case 203:return t.pobj=new gi(this.pm3f,t,this),!0}}if(40==i.iType)for(a=(t=i).pca,s=0;s<t.iArray;s++){for(e=a.phead;null!=e&&!this.InitMemory(e);)e=e.pdown;a=a.pnext}return!1}_Draw(){null!=this.pface&&this.DrawFirst(this.pface,0,0)}DrawFirst(i,t,s){var e;if(10==i.iType&&"唯一处理标识"==i.sName){var h=i;switch(e=h.pback,h.iNumber){case 400:return this.Draw_Interface400(e),!0;case 101:return this.Draw_CButton(e.pobj,this.iInterfaceX,this.iInterfaceY),!0;case 102:return this.Draw_CList(e.pobj,this.iInterfaceX,this.iInterfaceY),!0;case 104:return this.Draw_CTab104(e.pobj,this.iInterfaceX,this.iInterfaceY),!0;case 105:return this.Draw_Slider105(e.pobj,this.iInterfaceX,this.iInterfaceY),!0;case 201:return this.Draw_CFrame201(e.pobj,this.iInterfaceX,this.iInterfaceY),!0;case 202:return this.Draw_CAnima202(e.pobj,this.iInterfaceX,this.iInterfaceY),!0;case 203:return this.Draw_CText203(e.pobj,this.iInterfaceX,this.iInterfaceY),!0}}if(40==i.iType){var a,n,o=(e=i).pca;for(a=0;a<e.iArray;a++){for(n=o.phead;null!=n;){if(this.DrawFirst(n,t,s))return!1;n=n.pdown}o=o.pnext}}return!1}Draw_Interface400(i){var t,s;null!=(t=i.FindClass("界面区域"))&&(this.iInterfaceX=t.FindNumber("坐标X").iNumber,this.iInterfaceY=t.FindNumber("坐标X").iNumber,this.iInterfaceW=t.FindNumber("宽度").iNumber,this.iInterfaceH=t.FindNumber("高度").iNumber),null!=(s=i.FindWord("对齐方式"))&&("上"==s.pword?(this.iInterfaceX=(Pi.SCRW-this.iInterfaceW)/2,this.iInterfaceY=0):"左上"==s.pword?(this.iInterfaceX=0,this.iInterfaceY=0):"左"==s.pword?(this.iInterfaceX=0,this.iInterfaceY=(Pi.SCRH-this.iInterfaceH)/2):"左下"==s.pword?(this.iInterfaceX=0,this.iInterfaceY=Pi.SCRH-this.iInterfaceH):"下"==s.pword?(this.iInterfaceX=(Pi.SCRW-this.iInterfaceW)/2,this.iInterfaceY=Pi.SCRH-this.iInterfaceH):"右下"==s.pword?(this.iInterfaceX=Pi.SCRW-this.iInterfaceW,this.iInterfaceY=Pi.SCRH-this.iInterfaceH):"右"==s.pword?(this.iInterfaceX=Pi.SCRW-this.iInterfaceW,this.iInterfaceY=(Pi.SCRH-this.iInterfaceH)/2):"右上"==s.pword?(this.iInterfaceX=Pi.SCRW-this.iInterfaceW,this.iInterfaceY=0):"居中"==s.pword&&(this.iInterfaceX=(Pi.SCRW-this.iInterfaceW)/2,this.iInterfaceY=(Pi.SCRH-this.iInterfaceH)/2))}Draw_CList(i,t,s){i.Draw(t,s)}Draw_COle(i,t,s){i.Draw(t,s)}Draw_CButton(i,t,s){i.Draw(t,s)}Draw_CTab104(i,t,s){i.Draw(t,s)}Draw_Slider105(i,t,s){i.Draw(t,s)}Draw_CFrame201(i,t,s){null!=i&&i.Draw(t,s)}Draw_CText203(i,t,s){i.Draw(t,s)}Draw_CAnima202(i,t,s){i.Draw(t,s)}_ProcTouch(i,t,s){if(null!=this.pface){this.ProcTouchFirst(this.pface,i,t,s);return!!this.bClose&&(ln.x_stat.PopStat(1),!0)}return!1}ProcTouchFirst(i,t,s,e){var h;if(10==i.iType&&"唯一处理标识"==i.sName){var a=i;switch(h=a.pback,a.iNumber){case 400:return!1;case 101:return!!this.Touch_CButton(h,t,s,e);case 102:return!!this.Touch_CList(h,t,s,e);case 104:return!!this.Touch_CTab(h,t,s,e);case 105:return!!this.Touch_Control(h,t,s,e);case 201:return!!this.Touch_CFrame(h,t,s,e)}}if(40==i.iType){var n,o,r=(h=i).pca;for(n=0;n<h.iArray;n++){for(o=r.phead;null!=o;){if(this.ProcTouchFirst(o,t,s,e))return!0;o=o.pdown}r=r.pnext}}return!1}Touch_CButton(i,t,s,e){return null!=i.pobj&&!!i.pobj.ProcTouch(t,s,e)}Touch_CTab(i,t,s,e){return null!=i.pobj&&!!i.pobj.ProcTouch(t,s,e)}Touch_CList(i,t,s,e){return!!i.pobj.ProcTouch(t,s,e)}Touch_CFrame(i,t,s,e){return null!=i.pobj&&!!i.pobj.ProcTouch(t,s,e)}Touch_Control(i,t,s,e){return null!=i.pobj&&!!i.pobj.ProcTouch(t,s,e)}FindControl(i,t){return null==(i=i.FindFirst(t,10))?null:(gn.sop("find"+t),i.pobj)}ReloadControl(i){if(null==i)return!1;var t,s,e,h;if(10==i.iType&&"唯一处理标识"==i.sName){var a=i;switch(t=a.pback,gn.sop("Reload Type = "+a.iNumber),a.iNumber){case 101:case 102:case 103:case 104:case 105:case 201:case 202:case 203:return t.pobj.ReLoad(),!0}}if(40==i.iType)for(h=(t=i).pca,s=0;s<t.iArray;s++){for(e=h.phead;null!=e&&!this.ReloadControl(e);)e=e.pdown;h=h.pnext}return!1}atoi(i){return parseInt(i)}getnextword(i,t,s){var e,h=0,a=new Array;for(e=0;e<s-t&&(" "==i[t+e]||"\r"==i[t+e]||"\n"==i[t+e]);e++);if(this.out="",e>=s-t)return 1024;for(e=e;e<s-t&&0!=i[t+e];e++){if(" "==i[t+e]||"\r"==i[t+e]||"\n"==i[t+e])return e;a[h++]=i[t+e],this.out+=i[t+e]}return h>0?e:1024}RunCode(i){if(null!=i)for(var t,s,e,h,a=0,n=0,o=new Array(5),r=0,c="",l=0,b=0,_="",f=0,u=0,d=2,p=null;;)switch(a){case 0:if(n+=this.getnextword(i.Get(),n,i.iLen),"set"==this.out?a=100:"string"==this.out?a=300:"reload"==this.out?a=200:"if"==this.out?a=400:"button"==this.out?a=500:"run"==this.out?a=600:"send"==this.out?a=700:"close"==this.out&&(this.bClose=!0),n>=i.iLen)return;break;case 700:var m=new Array(7);for(t=0;t<7;t++)n+=this.getnextword(i.Get(),n,i.iLen),"string1"==this.out?m[t]=o[1]:"string2"==this.out?m[t]=o[2]:m[t]=this.out;Mh.pt.xms_send(m[0],m[1],m[2],m[3],m[4],m[5],m[6]),a=0;break;case 600:if(n+=this.getnextword(i.Get(),n,i.iLen),null==(p=this.prunclass.FindFirstByPath(this.out)))return;50==p.iType&&this.RunCode(p);break;case 500:n+=this.getnextword(i.Get(),n,i.iLen),c=this.out,a=501;break;case 501:if(n+=this.getnextword(i.Get(),n,i.iLen),"pressdown"==this.out){if(null==(p=this.prunclass.FindFirstByPath(c)))return;40==p.iType&&((h=p).pobj.bMouseIn=!0,h.pobj.bMouseDown=!0)}a=0;break;case 400:if(n+=this.getnextword(i.Get(),n,i.iLen),"compint"==this.out)u=0;else{if("compstr"!=this.out)return;u=1}a=410;break;case 410:n+=this.getnextword(i.Get(),n,i.iLen),"fromdirect"==this.out&&(a=411);break;case 411:n+=this.getnextword(i.Get(),n,i.iLen),c=this.out,a=420;break;case 420:if(n+=this.getnextword(i.Get(),n,i.iLen),"<"==this.out)d=0;else if("<="==this.out)d=1;else if("="==this.out)d=2;else if(">="==this.out)d=3;else{if(">"!=this.out)return;d=4}a=430;break;case 430:n+=this.getnextword(i.Get(),n,i.iLen),"tocurrent"==this.out&&(b=1,a=431);break;case 431:if(n+=this.getnextword(i.Get(),n,i.iLen),10==(p=this.prunclass.FindFirstByPath(this.out)).iType)_=""+(s=p).iNumber;else{if(30!=p.iType)return;_=(e=p).Get()}a=440;break;case 440:if(t=0,0==u?(0==d&&this.atoi(c)<this.atoi(_)&&(t=1),1==d&&this.atoi(c)<=this.atoi(_)&&(t=1),2==d&&this.atoi(c)==this.atoi(_)&&(t=1),3==d&&this.atoi(c)>=this.atoi(_)&&(t=1),4==d&&this.atoi(c)>this.atoi(_)&&(t=1)):1==u&&(0==d&&c<_&&(t=1),2==d&&c==_&&(t=1),4==d&&c>_&&(t=1)),0==t)for(;;){if((n+=this.getnextword(i.Get(),n,i.iLen))>=i.iLen)return;if("endif"==this.out)break}a=0;break;case 300:n+=this.getnextword(i.Get(),n,i.iLen),a="append"==this.out?310:0;break;case 310:if(n+=this.getnextword(i.Get(),n,i.iLen),"string1"==this.out)f=1;else{if("string2"!=this.out)return;f=2}a=311;break;case 311:n+=this.getnextword(i.Get(),n,i.iLen),"fromdirect"==this.out?(r=2,a=312):"frommemory"==this.out&&(r=3,a=313);break;case 312:n+=this.getnextword(i.Get(),n,i.iLen),c=this.out,a=320;break;case 313:if(n+=this.getnextword(i.Get(),n,i.iLen),"string1"==this.out)l=1;else{if("string2"!=this.out)return;l=2}a=320;break;case 320:2==r?this.out=c:3==r&&(this.out=o[l]),o[f]+=this.out,a=0;break;case 200:n+=this.getnextword(i.Get(),n,i.iLen),gn.sop("???????="+this.out),"all"==this.out?(this.ReloadControl(this.prunclass),a=0):a=0;break;case 100:n+=this.getnextword(i.Get(),n,i.iLen),"string"==this.out?(1,a=110):a=0;break;case 110:n+=this.getnextword(i.Get(),n,i.iLen),"fromsource"==this.out?(a=111,r=0):"frommemory"==this.out?(a=112,r=3):"fromdirect"==this.out?(a=111,r=2):"fromcurrent"==this.out?(a=111,r=1):a=0;break;case 111:n+=this.getnextword(i.Get(),n,i.iLen),c=this.out,a=120;break;case 112:if(n+=this.getnextword(i.Get(),n,i.iLen),"string1"==this.out)l=1;else{if("string2"!=this.out)return;l=2}a=120;break;case 120:n+=this.getnextword(i.Get(),n,i.iLen),"tocurrent"==this.out?(a=121,b=1):"tomemory"==this.out&&(b=2,a=122);break;case 121:n+=this.getnextword(i.Get(),n,i.iLen),_=this.out,a=130;break;case 122:if(n+=this.getnextword(i.Get(),n,i.iLen),"string1"==this.out)f=1;else{if("string2"!=this.out)return;f=2}a=130;break;case 130:if(0==r||1==r){if(0==r&&(p=this.pbaseclass.FindFirstByPath(c)),1==r&&(p=this.prunclass.FindFirstByPath(c)),null==p)return;if(10==p.iType)s=p,this.out=""+s.iNumber;else{if(30!=p.iType)return;e=p,this.out=e.Get()}}else 2==r?this.out=c:3==r&&(this.out=o[l]);if(1==b){if(null==(p=this.prunclass.FindFirstByPath(_)))return;if(10==p.iType)(s=p).iNumber=this.atoi(this.out);else{if(30!=p.iType)return;(e=p).Set(this.out)}}else 2==b&&(o[f]=this.out);a=0}}}Pi.paaole,Pi.panimaole,Pi.SCRW,Pi.SCRH;class Ni extends s{constructor(i){super()}Draw(){Y.gi().FormatEx(this.sDetail,500,20,0,0,25),this.iW=580,this.iH=Y.gi().iH+20+30+30+30,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,E.frame_type4("提示框a32_32",this.iX,this.iY,this.iW,this.iH,32,32),c.gi().DrawText_2(this.iX+this.iW/2,this.iY+30+15,this.sTitle,4294967040,30,101,1,1,0,-2,-2,4,4289034305),Y.gi().Draw(this.iX+40,this.iY+30+30+20)}ProcTouch(i,t,s){return bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||3!=i||ln.gi().PopStat(1),!1}}Ni.Open=function(i,t){var s=ln.gi().PushStat(ln.GS_PROMPTMESSAGE);s.sTitle=i,s.sDetail=t};class vi extends Pi{constructor(){super(),this._RMD=["10级前自动升级加点，10级拜师后方可自己分配属性点数","#c0000ff4力量1体质# #cffffff常用加点，站得稳生存强 有输出#e#c0000ff5力量# #cffffff高物理输出，克制法系#e#c0000ff4力量1敏捷# #cffffff适用于竞技玩法，出手快输出强","#c0000ff3敏捷2耐力# #cffffff常用加点，出手快，站得稳，生存强#e#c0000ff4敏捷1体/5敏捷# #cffffff高端玩法，出手快，生存弱，适合高端玩家","#c0000ff2体力3耐力/3体力2耐力# #cffffff主流加点，站得住，生存强#e#c0000ff3灵力/1体力/1耐力# #cffffff任务加点，输出高，生存强","#c0000ff4力量1体质# #cffffff常用加点，站得稳生存强 有输出#e#c0000ff5力量# #cffffff高物理输出，克制法系#e#c0000ff4力量1敏捷# #cffffff适用于竞技玩法，出手快输出强","#c0000ff4灵力1体力/5灵力# #cffffff任务加点，输出高#e#c0000ff3灵力 2耐力# #cffffff竞技玩法，有输出，双抗高","#c0000ff\t3敏捷2体力# #cffffff常用加点，出手快，站得稳，生存强#e#c0000ff4敏捷1体/5敏捷# #cffffff高端玩法，出手快，生存弱，适合高端玩家#e#c0000ff4力量1体力# #cffffff适合任务，能输出，生存强","#c0000ff4灵力1体力/5灵力# #cffffff任务加点，输出高#e#c0000ff3灵力 2耐力# #cffffff竞技玩法，有输出，双抗高","#c0000ff2体力2耐力1法力# #cffffff任务型加点，站的住，蓝量够#e#c0000ff2体3耐# #cffffff钢板型仙人，团队中流砥柱的辅助人才","#c0000ff4力量1体力/4力量1耐力/5力量# #cffffff常用加点，物理伤害影响高#e#c0000ff3力量2灵力# #cffffff主流加点，双输出影响高，抗性高#e#c0000ff3体2耐力/2体力2耐力1敏# #cffffff高防御，生存强，辅助路线"]}InitBefore(){}InitAfter(){var i;for(console.log("什么鬼:",this.prunclass),this.ptxt_base=new Array(7),i=0;i<7;i++)this.ptxt_base[i]=this.FindControl(this.prunclass,"显示"+i),this.ptxt_base[i].iY-=30;for(this.pbtn_sub=new Array(5),this.psli_point=new Array(5),this.pbtn_add=new Array(5),this.ptxt_value=new Array(5),i=0;i<5;i++)this.pbtn_sub[i]=this.FindControl(this.prunclass,"减按钮"+i),this.psli_point[i]=this.FindControl(this.prunclass,"滑杆"+i),this.pbtn_add[i]=this.FindControl(this.prunclass,"加按钮"+i),this.ptxt_value[i]=this.FindControl(this.prunclass,"数值"+i),this.ptxt_value[i].iY-=30,this.psli_point[i].SetRange(6*xh.me.rbs.iLev);for(this.pbtn_confirm=this.FindControl(this.prunclass,"确认加点"),this.pbtn_wash=this.FindControl(this.prunclass,"洗点"),this.iAddAtt=new Int32Array(5),i=0;i<5;i++)this.iAddAtt[i]=0;this.pbtn_plan=this.FindControl(this.prunclass,"加点方案"),this.pbtn_recommend=this.FindControl(this.prunclass,"推荐加点"),this.iOldFlag=new Int32Array(6),this.InitValue()}InitValue(){var i,t=xh.me.iRace,s=e.iBaseAttAdd[t][0]+xh.me.rbs.iBaseAtt[0]+xh.me.rbs.iLev,h=e.iBaseAttAdd[t][1]+xh.me.rbs.iBaseAtt[1]+xh.me.rbs.iLev,a=e.iBaseAttAdd[t][2]+xh.me.rbs.iBaseAtt[2]+xh.me.rbs.iLev,n=e.iBaseAttAdd[t][3]+xh.me.rbs.iBaseAtt[3]+xh.me.rbs.iLev,o=e.iBaseAttAdd[t][4]+xh.me.rbs.iBaseAtt[4]+xh.me.rbs.iLev;for(this.ptxt_value[0].sText="#c003e57"+s,this.ptxt_value[1].sText="#c003e57"+h,this.ptxt_value[2].sText="#c003e57"+a,this.ptxt_value[3].sText="#c003e57"+n,this.ptxt_value[4].sText="#c003e57"+o,i=0;i<5;i++)this.psli_point[i].SetPos(xh.me.rbs.iBaseAtt[i]+this.iAddAtt[i]),this.iAddAtt[i]>0&&(this.ptxt_value[i].sText+="#c00ff00+"+this.iAddAtt[i]);for(i=0;i<5;i++)xh.me.rbs.iBaseAtt[i]+=this.iAddAtt[i];xh.me.CalcFightAtt();var r=xh.me.rbs.iMaxHp,c=xh.me.rbs.iMaxMp,l=xh.me.rbs.iSpirit,b=xh.me.rbs.iAttack,_=xh.me.rbs.iDefence,f=xh.me.rbs.iSpeed,u=xh.me.rbs.nut;for(i=0;i<5;i++)xh.me.rbs.iBaseAtt[i]-=this.iAddAtt[i];xh.me.CalcFightAtt(),this.ptxt_base[0].sText="#c003e57气  血："+xh.me.rbs.iMaxHp,xh.me.rbs.iMaxHp>r?this.ptxt_base[0].sText+="#c00ff00-"+(xh.me.rbs.iMaxHp-r):xh.me.rbs.iMaxHp<r&&(this.ptxt_base[0].sText+="#c00ff00+"+(r-xh.me.rbs.iMaxHp)),this.ptxt_base[1].sText="#c003e57魔  法："+xh.me.rbs.iMaxMp,xh.me.rbs.iMaxMp>c?this.ptxt_base[1].sText+="#c00ff00-"+(xh.me.rbs.iMaxMp-c):xh.me.rbs.iMaxMp<c&&(this.ptxt_base[1].sText+="#c00ff00+"+(c-xh.me.rbs.iMaxMp)),this.ptxt_base[2].sText="#c003e57灵  力："+xh.me.rbs.iSpirit,xh.me.rbs.iSpirit>l?this.ptxt_base[2].sText+="#c00ff00-"+(xh.me.rbs.iSpirit-l):xh.me.rbs.iSpirit<l&&(this.ptxt_base[2].sText+="#c00ff00+"+(l-xh.me.rbs.iSpirit)),this.ptxt_base[3].sText="#c003e57伤  害："+xh.me.rbs.iAttack,xh.me.rbs.iAttack>b?this.ptxt_base[3].sText+="#c00ff00-"+(xh.me.rbs.iAttack-b):xh.me.rbs.iAttack<b&&(this.ptxt_base[3].sText+="#c00ff00+"+(b-xh.me.rbs.iAttack)),this.ptxt_base[4].sText="#c003e57防  御："+xh.me.rbs.iDefence,xh.me.rbs.iDefence>_?this.ptxt_base[4].sText+="#c00ff00-"+(xh.me.rbs.iDefence-_):xh.me.rbs.iDefence<_&&(this.ptxt_base[4].sText+="#c00ff00+"+(_-xh.me.rbs.iDefence)),this.ptxt_base[5].sText="#c003e57速  度："+xh.me.rbs.iSpeed,xh.me.rbs.iSpeed>f?this.ptxt_base[5].sText+="#c00ff00-"+(xh.me.rbs.iSpeed-f):xh.me.rbs.iSpeed<f&&(this.ptxt_base[5].sText+="#c00ff00+"+(f-xh.me.rbs.iSpeed)),this.ptxt_base[6].sText="#c003e57潜  能："+xh.me.rbs.nut,xh.me.rbs.nut>u?this.ptxt_base[6].sText+="#c00ff00-"+(xh.me.rbs.nut-u):xh.me.rbs.nut<u&&(this.ptxt_base[6].sText+="#c00ff00+"+(u-xh.me.rbs.nut)),0!=(2&xh.me.iFlagExt[11])?this.pbtn_plan.sName="方案1":0!=(2&xh.me.iFlagExt[13])?this.pbtn_plan.sName="方案2":0!=(2&xh.me.iFlagExt[15])&&(this.pbtn_plan.sName="方案3")}Draw(){var i,t=!1;for(i=0;i<6;i++)this.iOldFlag[i]!=xh.me.iFlagExt[11+i]&&(this.iOldFlag[i]=xh.me.iFlagExt[11+i],t=!0);t&&this.InitValue(),this._Draw(),ei.end(ei.CONFIRM_WASHROLEPOINT)&&ei.bConfirm&&Mh.gi().s_UseGoods(ht.gi().GetGid(191),1,"")}setatt(i,t){var s,e=t;for(s=0;s<5;s++)i!=s&&(e+=this.iAddAtt[s]);t<0?t=0:e>xh.me.rbs.nut&&(t-=e-xh.me.rbs.nut),this.iAddAtt[i]=t,this.InitValue()}ProcTouch(i,t,s){var e;for(this._ProcTouch(i,t,s),e=0;e<5;e++)this.pbtn_sub[e].IsChecked()&&this.setatt(e,this.iAddAtt[e]-1),this.psli_point[e].IsChanged()&&this.setatt(e,this.psli_point[e].iPos-xh.me.rbs.iBaseAtt[e]),this.pbtn_add[e].IsChecked()&&this.setatt(e,this.iAddAtt[e]+1);if(this.pbtn_confirm.IsChecked()){for(e=0;e<5;e++)xh.me.rbs.iBaseAtt[e]+=this.iAddAtt[e];for(xh.me.CalcFightAtt(),Mh.gi().s_AddPoint(this.iAddAtt[0],this.iAddAtt[1],this.iAddAtt[2],this.iAddAtt[3],this.iAddAtt[4]),e=0;e<5;e++)this.iAddAtt[e]=0;this.InitValue()}return this.pbtn_wash.IsChecked()&&(ht.bHaveGoods(191,1)?ei.start(ei.CONFIRM_WASHROLEPOINT,"是否消耗一颗涅槃丹#e重置属性点？"):Z.fm.Open("背包中没有可消耗的涅槃丹（可在商城购买）")),this.pbtn_plan.IsChecked()&&Ei.pxe.RunXms("人物加点方案"),this.pbtn_recommend.IsChecked()&&Ni.Open("加点说明","#c0000ff体质# #cffffff影响# 气血，灵力，速度# #c0000ff已分配:"+xh.me.rbs.iBaseAtt[0]+"点#e#c0000ff法力# #cffffff影响# 灵力，魔法# #c0000ff已分配:"+xh.me.rbs.iBaseAtt[1]+"点#e#c0000ff力量# #cffffff影响# 灵力，伤害，速度# #c0000ff已分配:"+xh.me.rbs.iBaseAtt[2]+"点#e#c0000ff耐力# #cffffff影响# 灵力，防御，速度# #c0000ff已分配:"+xh.me.rbs.iBaseAtt[3]+"点#e#c0000ff敏捷# #cffffff影响# 速度# #c0000ff已分配:"+xh.me.rbs.iBaseAtt[4]+"点#e#cffff00加点方案推荐#e"+this._RMD[xh.me.rbs.iSchoolId]),!0}}class Mi extends Pi{constructor(){super()}InitBefore(){}InitAfter(){var i;for(this.ptxt_atts=new Array(3),this.pbtn_proc=new Array(3),i=0;i<3;i++)this.pbtn_proc[i]=this.FindControl(this.prunclass,"方案"+i+"按钮"),this.ptxt_atts[i]=this.FindControl(this.prunclass,"方案"+i+"点数");for(this.iOldFlag=new Int32Array(6),i=0;i<6;i++)this.iOldFlag[i]=xh.me.iFlagExt[11+i];this.InitValue()}InitValue(){var i;for(i=0;i<3;i++)0==(1&xh.me.iFlagExt[11+2*i])?(this.pbtn_proc[i].sName="开启",this.ptxt_atts[i].sText="未开启"):(0==(2&xh.me.iFlagExt[11+2*i])?this.pbtn_proc[i].sName="切换":this.pbtn_proc[i].sName="使用中",this.ptxt_atts[i].sText="体质:"+(xh.me.iFlagExt[11+2*i]>>20&1023)+"，法力:"+(xh.me.iFlagExt[11+2*i]>>10&1023)+"，力量:"+(xh.me.iFlagExt[12+2*i]>>20&1023)+"，耐力:"+(xh.me.iFlagExt[12+2*i]>>10&1023)+"，敏捷:"+(1023&xh.me.iFlagExt[12+2*i]))}Draw(){var i,t=!1;for(i=0;i<6;i++)this.iOldFlag[i]!=xh.me.iFlagExt[11+i]&&(this.iOldFlag[i]=xh.me.iFlagExt[11+i],t=!0);t&&this.InitValue(),this._Draw(),ei.end(ei.CONFIRM_OPENPOINTPLAN)&&ei.bConfirm&&Mh.gi().s_SeverEvent(32,0,this.iPlanPoint,0,0),ei.end(ei.CONFIRM_SWAPPOINTPLAN)&&ei.bConfirm&&Mh.gi().s_SeverEvent(32,1,this.iPlanPoint,0,0)}ProcTouch(i,t,s){var e;for(this._ProcTouch(i,t,s),e=0;e<3;e++)this.pbtn_proc[e].IsChecked()&&(0==(1&xh.me.iFlagExt[11+2*e])?(1==e&&ei.start(ei.CONFIRM_OPENPOINTPLAN,"开启方案2需要消耗800元宝，是否确认开启？"),2==e&&ei.start(ei.CONFIRM_OPENPOINTPLAN,"开启方案3需要消耗1600元宝，是否确认开启？"),this.iPlanPoint=e):0==(2&xh.me.iFlagExt[11+2*e])&&((xh.me.iFlag[60]>>6)%3==0?ei.start(ei.CONFIRM_SWAPPOINTPLAN,"本次切换方案免费，是否确认切换？"):ei.start(ei.CONFIRM_SWAPPOINTPLAN,"切换方案需要消耗"+(xh.me.iFlag[60]>>6)%3*10+"万铜币，是否确认切换？"),this.iPlanPoint=e));return!0}}class yi extends oi{constructor(){super(),this.iType=50,this.iLen=7,this.pcode=""}Set(i,t){for(var s=new Uint8Array(t),e=0;e<t;e++)s[e]=i[e];this.pcode=f.gb2312a_to_utf8(s),this.iLen=this.pcode.length}Get(){return this.pcode}copyfrom(i){this.iX=i.iX,this.iY=i.iY,this.sName=i.sName,this.pcode=i.pcode,this.iLen=i.iLen}GetCopy(){var i=new yi;return i.copyfrom(this),i}}class Ri extends oi{constructor(){super(),this.iType=30,this.iLen=8,this.sName="",this.pdata=""}SetPos(i,t){this.iX=i,this.iY=t}Set(i){this.pdata=i}Get(){return this.pdata}copyfrom(i){this.iX=i.iX,this.iY=i.iY,this.sName=i.sName,this.pdata=i.pdata}GetCopy(){var i=new Ri;return i.copyfrom(this),i}}class Gi{constructor(){this.MAXMAIN=256,gn.sop("new first 1"),this.pmains=new Array(this.MAXMAIN),gn.sop("new first 2"),this.Clear(),gn.sop("new first 3")}Clear(){for(var i=0;i<this.MAXMAIN;i++)this.pmains[i]=null}LockMain(i){for(var t=0;t<this.MAXMAIN;t++)if(null!=this.pmains[t]&&this.pmains[t].sName==i)return this.pmains[t];return null}LoadFile(i,t){gn.sop("load "+i+" 1"),t&&Laya.loader.load(bn.BASE_URL+i,Laya.Handler.create(this,this._LoadFile,[this,i]),null,Laya.Loader.BUFFER)}_LoadFile(i,t,s){var e=gn.gi().pls;e.GetData3(s),gn.sop("load "+t+" 2");var h,a,n,o=e.GetNextString();if("xf"==o)for(e.GetNextInt(),h=0;h<this.MAXMAIN;h++)if(null==this.pmains[h]){a=e.GetNextInt(),n=e.GetNextInt(),this.pmains[h]=this.LoadFirst(e),this.pmains[h].SetPos(a,n);break}if("xal"==o){for(gn.sop("load "+t+" 3"),e.GetNextInt();!(e.GetNextInt()<0);)for(h=0;h<this.MAXMAIN;h++)if(null==this.pmains[h]){a=e.GetNextInt(),n=e.GetNextInt(),this.pmains[h]=this.LoadFirst(e),this.pmains[h].SetPos(a,n);break}gn.sop("load "+t+" 4")}}LoadFirst(i){var t,s,e,h,a,n,o,r=null,c=i.GetNextInt();switch(c){case 10:(r=t=new li).iType=c,r.sName=i.GetNextString(),r.iLen=i.GetNextInt(),t.iNumber=i.GetNextInt();break;case 20:(r=s=new bi).iType=c,r.sName=i.GetNextString(),r.iLen=i.GetNextInt(),s.fFloat=i.GetNextFloat();break;case 30:(r=e=new _i).iType=c,r.sName=i.GetNextString(),i.GetNextInt(),i.GetNextData(),e.Set(i.DataToString());break;case 40:for((r=h=new ci).iType=c,r.sName=i.GetNextString(),r.iLen=i.GetNextInt(),h.iArray=i.GetNextInt();null!=(o=this.LoadFirst(i));)h.LinkFirst(o);break;case 50:(r=a=new yi).iType=c,r.sName=i.GetNextString(),i.GetNextInt(),i.GetNextData(),a.Set(i.obd,i.obi);break;case 60:(r=n=new Ri).iType=c,r.sName=i.GetNextString(),i.GetNextInt(),i.GetNextData(),n.Set(i.obd,i.obi)}return r}}class Ei{constructor(){this.pfole=new Gi,gn.sop("Ｘｍｓ　ＩｎｉｔＦｉｎｉｓｈ1"),this.pfole.LoadFile("res/datapackage/data/7gol.xal",!0),gn.sop("Ｘｍｓ　ＩｎｉｔＦｉｎｉｓｈ2"),Ei.panimaole=new ni,gn.sop("Ｘｍｓ　ＩｎｉｔＦｉｎｉｓｈ3"),Ei.paaole=new hi,Ei.pxe=this,gn.sop("Ｘｍｓ　ＩｎｉｔＦｉｎｉｓｈ4"),this.iStatPoint=0}FindMain(i){return this.pfole.LockMain(i)}FindLink(i){for(var t=0;t<Ei._STATLINK.length;t++)if(Ei._STATLINK[t][0]==i)return t;return-1}IsStat(i){var t=this.FindLink(i);return-1!=t&&ln.x_stat.iXStat==Ei.XS_BASESTAT+t}RunXms(i){if("string"!=typeof i){var t,s=Ei._STATLINK[i][1],e=Ei._STATLINK[i][2],h=null;switch(i){case 0:h=new vi;break;case 1:h=new Mi}null!=(t=this.FindMain(s))&&null!=(t=t.FindFirst(e,5))&&this.Run(Ei.XS_BASESTAT+i,t,h)}else{var a=this.FindLink(i);if(-1==a)return;this.RunXms(a)}}Run(i,t,s){ln.x_stat.PushXmsStat(i,s),s.prunclass=t,s.XMS_MYSTAT=i,s._Init()}RunByPls(i){var t=this.FindMain("七国");if(null!=t){var s=i.GetNextString();if(null!=(t=t.FindFirstByPath(s))){var e=new Pi;e.prunclass=t,e._Init(),ln.x_stat.PushXmsStat(Ei.XS_BASESTAT+2e3,e),e.XMS_MYSTAT=Ei.XS_BASESTAT+2e3}}}}Ei.XS_BASESTAT=1e5,Ei.panimaole,Ei.paaole,Ei.pxe,Ei._STATLINK=[["人物加点","七国","人物加点界面"],["人物加点方案","七国","人物加点方案"]];class Oi{Clean(){this.iOffY=0,this.iSortType=-1,this.iSortUD=0,this.iLockPoint=-1}constructor(i,t,s,e){this.iType=i,this.iTitleCount=t,this.iW=s,this.iH=e,this.sTitleName=new Array(this.iTitleCount),this.iTitleWidth=new Int32Array(this.iTitleCount),this.iTitleOffx=new Int32Array(this.iTitleCount),this.bCanSort=new Array(this.iTitleCount),this.iAlign=new Int32Array(this.iTitleCount);for(var h=0;h<this.iTitleCount;h++)this.sTitleName[h]="",this.iTitleWidth[h]=0,this.iAlign[h]=-2;this.iTitleHeight=50,this.iRowHeight=40,this.iOffY=0,this.bTouchLock=!1,this.iCheckPoint=-1,this.iLockPoint=-1,this.iSortLock=-1,this.iSortType=-1,this.iSortUD=0,this.btn_list=new Array(3)}SetTitle(i,t,s,e){i<0||i>=this.iTitleCount||(this.sTitleName[i]=t,this.iTitleWidth[i]=s,this.bCanSort[i]=e)}BeginDraw(i,t){var s,e,h,a;for(this.iTitleOffx[0]=0,s=1;s<this.iTitleCount;s++)this.iTitleOffx[s]=this.iTitleOffx[s-1]+this.iTitleWidth[s-1];for(this.iX=i,this.iY=t,c.gi().SetViewClip(i,t,i+this.iW,t+this.iH),h=this.iX,a=this.iY+this.iTitleHeight-this.iOffY%(2*this.iRowHeight)-2*this.iRowHeight,e=(this.iH-this.iTitleHeight)/this.iRowHeight+4,s=0;s<e;s++)s%2==0?E.frame_type3("纯色a10_10",h,a,this.iW,this.iRowHeight,10,10):E.frame_type3("纯色b10_10",h,a,this.iW,this.iRowHeight,10,10),a+=this.iRowHeight;this.iLockPoint>=0&&(a=this.iY+this.iTitleHeight+this.iLockPoint*this.iRowHeight-this.iOffY,E.frame_type4("19号框20_20",h,a,this.iW,40,20,20)),this.iMaxLine=0,this.iBtnCount=0}DrawUnitEx_Anima(i,t,s,e,h){var a,n;(this.iMaxLine<t&&(this.iMaxLine=t),this.bShow(t))&&(a=this.iTitleOffx[i],this.iTitleWidth[i],n=this.iTitleHeight-this.iOffY+t*this.iRowHeight,s.Draw(this.iX+a+e,this.iY+n+h))}DrawUnitEx_Button(i,t,s,e,h){var a,n;(this.iMaxLine<t&&(this.iMaxLine=t),this.bShow(t))&&(a=this.iTitleOffx[i],this.iTitleWidth[i],n=this.iTitleHeight-this.iOffY+t*this.iRowHeight,s.Move(this.iX+a+e,this.iY+n+h,s.iW,s.iH),s.Draw(),this.btn_list[this.iBtnCount++]=s)}DrawUnit(i,t,s){var e,h,a;(this.iMaxLine<t&&(this.iMaxLine=t),this.bShow(t))&&(s.length<=0||(e=this.iTitleOffx[i],a=this.iTitleWidth[i],h=this.iTitleHeight-this.iOffY+t*this.iRowHeight,0==this.iAlign[i]||-1==this.iAlign[i]?c.gi().DrawTextEx(this.iX+e,this.iY+h+this.iRowHeight/2,s,4294967295,20,101,1,1,0,this.iAlign[i],-2):-2==this.iAlign[i]?c.gi().DrawTextEx(this.iX+e+a/2,this.iY+h+this.iRowHeight/2,s,4294967295,20,101,1,1,0,this.iAlign[i],-2):-3==this.iAlign[i]&&c.gi().DrawTextEx(this.iX+e+a,this.iY+h+this.iRowHeight/2,s,4294967295,20,101,1,1,0,this.iAlign[i],-2)))}OffX(i){var t,s;return t=this.iTitleOffx[i],s=this.iTitleWidth[i],0==this.iAlign[i]||-1==this.iAlign[i]?this.iX+t:-2==this.iAlign[i]?this.iX+t+s/2:-3==this.iAlign[i]?this.iX+t+s:0}bShow(i){var t=-this.iOffY+i*this.iRowHeight;return!(t<-this.iRowHeight||t>this.iH)}FinishDraw(){var i,t;if(c.gi().NoClip(),E.frame_type2("内阴影a10_10",this.iX,this.iY,this.iW,this.iH,10,10),this.iTitleHeight>0)for(E.frame_type1("列表标题a20_50",this.iX,this.iY,this.iW,20),i=0;i<this.iTitleCount;i++)this.iTitleWidth[i]>0&&(i>0&&gn.xani_frame.DrawAnima(this.iX+this.iTitleOffx[i],this.iY+3,"列表分割线a3_44",0),this.iSortType==i?c.gi().DrawText_2(this.iX+this.iTitleOffx[i]+this.iTitleWidth[i]/2,this.iY+25,this.sTitleName[i],4294967040,26,101,1,1,0,-2,-2,4,4278222848):c.gi().DrawText_2(this.iX+this.iTitleOffx[i]+this.iTitleWidth[i]/2,this.iY+25,this.sTitleName[i],4294967040,25,101,1,1,0,-2,-2,4,4286578688));this.bTouchLock||(this.iOffY<0&&(this.iOffY/=2),t=(this.iH-this.iTitleHeight)/this.iRowHeight-1,(i=this.iMaxLine*this.iRowHeight-this.iRowHeight*t)<0&&(i=0),this.iOffY>i&&(this.iOffY-=(this.iOffY-i)/2))}iChecked(){var i=this.iCheckPoint;return this.iCheckPoint=-1,i>=0?i:-1}ProcTouch(i,t,s){var e,h,a;for(e=0;e<this.iBtnCount;e++)if(this.btn_list[e].ProcTouch(i,t,s))return!0;for(e=0;e<this.iTitleCount;e++)if(this.bCanSort[e]&&bn.bInRect(t,s,this.iX+this.iTitleOffx[e],this.iY,this.iTitleWidth[e],this.iTitleHeight)){1==i&&(this.iSortLock=e),3==i&&this.iSortLock==e&&(this.iSortType==e?this.iSortUD=1-this.iSortUD:(this.iSortType=e,this.iSortUD=0),this.iSortLock=-1);break}if(e>=this.iTitleCount&&(this.iSortLock=-1),2==i&&this.bTouchLock&&(Math.abs(this.iLockY-s)>=10&&(this.bTouchMoving=!0),this.bTouchMoving))return this.iOffY+=this.iLockY-s,this.iLockY=s,!0;if(3==i&&this.bTouchLock){if(this.bTouchLock=!1,!this.bTouchMoving){for(this.iLockPoint=parseInt((this.iLockY-this.iY-this.iTitleHeight+this.iOffY)/this.iRowHeight),(this.iLockPoint<0||this.iLockPoint>this.iMaxLine)&&(this.iLockPoint=-1),this.iLockPoint>=0&&(this.iCheckPoint=this.iLockPoint),h=t-this.iX,a=0,e=0;e<this.iTitleCount&&!(h<(a+=this.iTitleWidth[e]));e++);this.iCheckX=e}return!0}return!(!bn.bInRect(t,s,this.iX,this.iY+this.iTitleHeight,this.iW,this.iH-this.iTitleHeight)||1!=i)&&(this.iLockY=s,this.bTouchLock=!0,this.bTouchMoving=!1,!0)}}class Fi{constructor(){var i;for(this.sName="",this.iGovSkillLev=new Int32Array(10),this.GOVPOWER_0=0,this.GOVPOWER_1=1,this.GOVPOWER_2=2,this.iRealGid=-1,i=0;i<Fi.MAXGOVBUILDINGLEV;i++)Fi.iBuildingUpgrad[i]=0==i?1500:Fi.iBuildingUpgrad[i-1]+200*(i-1)+600,Fi.iBuildingTotal[i]=0==i?Fi.iBuildingUpgrad[i]:Fi.iBuildingTotal[i-1]+Fi.iBuildingUpgrad[i];for(i=0;i<21;i++)Fi.iGovUpgrad[i]=4*Fi.iBuildingTotal[5*i+4]}bCheckPower(i){return!(this.iRealGid<0)&&0!=(this.iPower&1<<i)}initmygov(i){this.iRealGid=i.GetNextInt(),this.iJob=i.GetNextInt(),this.iTick=i.GetNextInt(),this.sName=i.GetNextString(),this.iPower=i.GetNextShort(),this.iZhuQueLev=i.GetNextShort(),this.iShsLev=i.GetNextShort()}govoperateframe(i){var t;switch(i.GetNextByte()){case 0:for(this.iGovTick=i.GetNextInt(),t=0;t<8;t++)this.iGovSkillLev[t]=i.GetNextInt();ln.gi().iXStat!=ln.GS_LEARNGOVSKILL&&ln.gi().PushStat(ln.GS_LEARNGOVSKILL);break;case 1:this.iGovTick=i.GetNextInt(),ln.gi().iXStat!=ln.GS_GOVXIU&&ln.gi().PushStat(ln.GS_GOVXIU)}}}Fi.MAXGOVBUILDINGLEV=120,Fi.MAXGOVLEV=25,Fi.iBuildingUpgrad=new Int32Array(Fi.MAXGOVBUILDINGLEV),Fi.iBuildingTotal=new Int32Array(Fi.MAXGOVBUILDINGLEV),Fi.iGovUpgrad=new Int32Array(Fi.MAXGOVLEV),Fi.mg=new Fi,Fi._GOVBUILDINGS=["青龙堂","白虎堂","朱雀堂","玄武堂","学院","金库","商会","厢房","药房"],Fi._GOVSKILLS=["强身术","炼丹术","烹饪","锻造","冶金","剪裁","健体","修心"],Fi._GOVMTLEV=["低级维护","中级维护","高级维护"],Fi._GOVJOBS=["帮主","副帮主","左护法","右护法","长老","堂主","精英","帮众"],Fi._JOBIDS=[0,1,2,3,4,5,6,10],Fi.sJob=function(i){switch(i){case 0:return"帮主";case 1:return"副帮主";case 2:return"左护法";case 3:return"右护法";case 4:return"长老";case 5:return"堂主";case 6:return"精英";case 10:return"帮众";default:return"未知"+i}};class Xi extends s{constructor(i){super(),this.sAttName=["体质","法力","力量","耐力","敏捷"],this.sAttDetail=["提高气血上限","提高灵力","提高伤害值","提高防御","提高速度"],this.pani=i,this.pm3f=i.pm3f,this.iW=574,this.iH=504,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_ok=new Eh(gn.xani_nui2),this.btn_ok.InitButton("按钮1_110"),this.btn_ok.sName="确 定",this.btn_cancel=new Eh(gn.xani_nui2),this.btn_cancel.InitButton("按钮1_110"),this.btn_cancel.sName="取 消",this.btn_sub=new Array(5),this.btn_add=new Array(5);for(var t=0;t<5;t++)this.btn_sub[t]=new Eh(gn.xani_nui2),this.btn_sub[t].InitButton("加点按钮-"),this.btn_add[t]=new Eh(gn.xani_nui2),this.btn_add[t].InitButton("加点按钮+")}Draw(){var i,t;for(E.new_bigframe(this.iX,this.iY,this.iW,this.iH),i=0;i<5;i++)this.pm3f.DrawTextEx(this.iX+40,this.iY+65+65*i,this.sAttName[i],4278206039,30,101,1,1,0,0,-2),this.pm3f.DrawTextEx(this.iX+350+50,this.iY+65+65*i,this.sAttDetail[i],4278206039,25,101,1,1,0,0,-2),t=Xi.iModifys[i]>0?Xi.iAtts[i]+"+"+Xi.iModifys[i]:""+Xi.iAtts[i],this.pm3f.DrawTextEx(this.iX+200,this.iY+65+65*i,t,4278206039,30,101,1,1,0,0,-2),this.btn_sub[i].Move(this.iX+124,this.iY+65+65*i-30,59,60),this.btn_sub[i].Draw(),this.btn_add[i].Move(this.iX+280+50,this.iY+65+65*i-30,59,60),this.btn_add[i].Draw();this.pm3f.DrawTextEx(this.iX+40,this.iY+65+65*i,"潜能",4278206039,30,101,1,1,0,0,-2),this.pm3f.DrawTextEx(this.iX+200,this.iY+65+65*i,""+(Xi.iNut-Xi.iModifys[0]-Xi.iModifys[1]-Xi.iModifys[2]-Xi.iModifys[3]-Xi.iModifys[4]),4278206039,30,101,1,1,0,0,-2),this.btn_ok.Move(this.iX+45,this.iY+347+15+60,110,52),this.btn_ok.Draw(),this.btn_cancel.Move(this.iX+this.iW-110-45,this.iY+347+15+60,110,52),this.btn_cancel.Draw()}ProcTouch(i,t,s){var e;for(e=0;e<5;e++)this.btn_sub[e].ProcTouch(i,t,s)&&this.btn_sub[e].bCheck()&&Xi.iModifys[e]>0&&Xi.iModifys[e]--,this.btn_add[e].ProcTouch(i,t,s)&&this.btn_add[e].bCheck()&&Xi.iNut-Xi.iModifys[0]-Xi.iModifys[1]-Xi.iModifys[2]-Xi.iModifys[3]-Xi.iModifys[4]>0&&Xi.iModifys[e]++;return this.btn_ok.ProcTouch(i,t,s)&&this.btn_ok.bCheck()&&(Xi.bConfirm=!0,Xi.bFinished=!0,ln.gi().PopStat(1)),this.btn_cancel.ProcTouch(i,t,s)&&this.btn_cancel.bCheck()&&(Xi.bConfirm=!1,Xi.bFinished=!0,ln.gi().PopStat(1)),!1}}Xi.ADDPOINT_USER=10,Xi.ADDPOINT_PET=20,Xi.ADDPOINT_MOUNTS=30,Xi.iCid,Xi.iModifys=new Int32Array(5),Xi.iAtts=new Int32Array(5),Xi.iNut,Xi.bFinished=!1,Xi.bConfirm,Xi.start=function(i,t,s,e,h,a,n){Xi.iCid=i,Xi.iAtts[0]=t,Xi.iAtts[1]=s,Xi.iAtts[2]=e,Xi.iAtts[3]=h,Xi.iAtts[4]=a,Xi.iModifys[0]=0,Xi.iModifys[1]=0,Xi.iModifys[2]=0,Xi.iModifys[3]=0,Xi.iModifys[4]=0,Xi.iNut=n,ln.gi().PushStat(ln.GS_ADDPOINT),Xi.bFinished=!1},Xi.end=function(i){return!(!Xi.bFinished||Xi.iCid!=i)&&(Xi.bFinished=!1,!0)};class Yi extends s{constructor(i){var t;for(super(),this._SVIPT=[["特权","剩余天数<=30","剩余天数<=60","剩余天数>60"],["大表情","可使用","可使用","可使用"],["自动回合数","无限","无限","无限"],["使用三倍卡","+1次","+1次","+1次"],["活跃度","+6点","+8点","+10点"],["门派奖励","+20%","+30%","+40%"],["签到奖励","","+50%","+100%"],["体力恢复速度","","+1点","+2点"],["实时仓库","","","可使用"]],this.list_vip=null,this.pm3f=c.gi(),Yi.iW=916,Yi.iH=608,Yi.iX=(h.SCRW-Yi.iW)/2,Yi.iY=(h.SCRH-Yi.iH)/2,this.btn_close=new Eh(gn.xani_button),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(Yi.iX+Yi.iW-35,Yi.iY-25,60,60),this.iPage=0,this.iPage_jn=1,this.btn_page=new Array(4),t=0;t<4;t++)this.btn_page[t]=new Eh(gn.xani_nui2),this.btn_page[t].InitButton("右侧标签"),this.btn_page[t].Move(Yi.iX+Yi.iW-15,Yi.iY+40+125*t,50,140);for(this.btn_title=new Eh(gn.xani_nui2),this.btn_title.InitButton("宠物改名按钮"),this.btn_upgrade=new Eh(gn.xani_nui2),this.btn_upgrade.sName="升 级",this.btn_upgrade.InitButton("按钮1_110"),this.btn_addpoint=new Eh(gn.xani_nui2),this.btn_addpoint.sName="加 点",this.btn_addpoint.InitButton("按钮1_110"),this.btn_vip=new Eh(gn.xani_nui2),this.btn_vip.sName="开通/续费",this.btn_vip.InitButton("按钮3"),this.btn_vip.iNameSize=25,this.btn_vip.iNameColor=4294956800,this.btn_mpjn=new Eh(gn.xani_nui2),this.btn_mpjn.sName="门派技能",this.btn_mpjn.InitButton("按钮2"),this.btn_mpjn.iNameSize=25,this.btn_mpjn.iNameColor=4294956800,this.btn_fzjn=new Eh(gn.xani_nui2),this.btn_fzjn.sName="辅助技能",this.btn_fzjn.InitButton("按钮2"),this.btn_fzjn.iNameSize=25,this.btn_fzjn.iNameColor=4294956800,this.btn_jqjn=new Eh(gn.xani_nui2),this.btn_jqjn.sName="剧情技能",this.btn_jqjn.InitButton("按钮2"),this.btn_jqjn.iNameSize=25,this.btn_jqjn.iNameColor=4294956800,this.iMainSkillPoint=0,this.btn_mainskill=new Array(6),t=0;t<6;t++)this.btn_mainskill[t]=new D(gn.xani_ui),this.btn_mainskill[t].bCheckByRect=!0;for(this.iGovSkillPoint=-1,this.btn_govskill=new Array(10),t=0;t<10;t++)this.btn_govskill[t]=new D(gn.xani_ui),this.btn_govskill[t].bCheckByRect=!0;this.aa_body=new l,this.aa_weapon=new l,this.iWeapTid=ht.gi().GetWeaponTid();var s=2*xh.me.iRace+xh.me.iSex;for(gn.xani_newrole[s].InitAnimaWithName("站立_下",this.aa_body),this.iWeapTid>=0&&gn.xani_weap[2*xh.me.iRace+xh.me.iSex][N.WeapFlag(this.iWeapTid)].InitAnimaWithName("站立_下",this.aa_weapon),this.aa_cls=new Array(5),t=0;t<N._CHANGECOLOR[s].length;t++)xh.me.iColor[t]<=0||xh.me.iColor[t]>=6||(this.aa_cls[t]=new l,gn.xani_color[s][xh.me.iColor[t]-1].InitAnimaWithName(N._CHANGECOLOR[s][t]+"_站立_下",this.aa_cls[t]))}Draw_0(i,t){var s;E.new_framein(Yi.iX+28,Yi.iY+28,397,552),E.new_framein(Yi.iX+435,Yi.iY+28,451,552);var h=Yi.iX+28,a=Yi.iY+28;Yi.wordframe(h+198.5-100,a+30,200),c.gi().DrawText_2(h+198.5,a+30+16,xh.me.sName,4294967295,22,101,1,1,0,-2,-2,3,4278190080),xh.me.CalcUserScore(),c.gi().DrawText_2(h+198.5,a+30+16+40,"评分:"+xh.me.iScore,4294967295,26,101,1,1,0,-2,-2,3,4278190080),gn.xani_nui2.DrawAnima(h+198.5-130,a+90,"宠物背景",0),G.DrawAura(0,h+198.5,a+280,null,0),this.aa_body.Draw(h+198.5,a+280);var n=2*xh.me.iRace+xh.me.iSex;for(s=0;s<N._CHANGECOLOR[n].length;s++)xh.me.iColor[s]<=0||xh.me.iColor[s]>=6||(this.aa_cls[s].iFrame=this.aa_body.iFrame,this.aa_cls[s].Draw(h+198.5,a+280));this.aa_body.NextFrame(),this.iWeapTid>=0&&(this.aa_weapon.Draw(h+198.5,a+280),this.aa_weapon.NextFrame()),s=370,E.ui3_Text1_(h+20,a+s+0,67,100,"号码",""+xh.me.iRid),E.ui3_Text1_(h+20,a+s+40,67,100,"等级",""+xh.me.rbs.iLev),E.ui3_Text1_(h+198.5+10,a+s+0,67,100,"门派",""+e.sSchools[xh.me.rbs.iSchoolId]),-1==Fi.mg.iRealGid?E.ui3_Text1_(h+198.5+10,a+s+40,67,100,"帮派","无帮派"):E.ui3_Text1_(h+198.5+10,a+s+40,67,100,"帮派",Fi.mg.sName),xh.me.rbs.sTitle.length<=0?E.ui3_Text1_(h+20,a+s+80+30,67,200,"称谓","无"):E.ui3_Text1_(h+20,a+s+80+30,67,200,"称谓",xh.me.rbs.sTitle),this.btn_title.Move(h+290,a+s+80+30+16-30,60,60),this.btn_title.Draw();var o=Yi.iX+470,r=Yi.iY+56;gn.xani_nui2.DrawAnima(o,r,"提示1",0),c.gi().DrawText_2(o+33.5,r+16,"气血",4294967295,20,101,1,1,0,-2,-2,3,4278190080),gn.xani_nui2.DrawAnima(o,r+38,"提示1",0),c.gi().DrawText_2(o+33.5,r+38+16,"魔法",4294967295,20,101,1,1,0,-2,-2,3,4278190080),gn.xani_nui2.DrawAnima(o,r+76,"提示1",0),c.gi().DrawText_2(o+33.5,r+76+16,"经验",4294967295,20,101,1,1,0,-2,-2,3,4278190080),gn.xani_nui2.DrawAnima(o,r+114,"提示1",0),c.gi().DrawText_2(o+33.5,r+114+16,"愤怒",4294967295,20,101,1,1,0,-2,-2,3,4278190080),gn.xani_nui2.DrawAnima(o,r+152,"提示1",0),c.gi().DrawText_2(o+33.5,r+152+16,"体力",4294967295,20,101,1,1,0,-2,-2,3,4278190080);var l=67,b=38;gn.xani_nui2.DrawAnima(o+l,r,"宠物大血条",0),gn.xani_nui2.DrawAnima(o+l,r+b,"宠物大血条",0),gn.xani_nui2.DrawAnima(o+l,r+76,"宠物大血条",0),gn.xani_nui2.DrawAnima(o+l,r+114,"宠物大血条",0),gn.xani_nui2.DrawAnima(o+l,r+152,"宠物大血条",0),c.gi().SetViewClip(o,r,o+l+311*xh.me.rbs.iHp/xh.me.rbs.iMaxHp,r+480),gn.xani_nui2.DrawAnima(o+l+2,r+3,"宠物大血条",1),c.gi().NoClip(),c.gi().SetViewClip(o,r,o+l+311*xh.me.rbs.iMp/xh.me.rbs.iMaxMp,r+480),gn.xani_nui2.DrawAnima(o+l+2,r+b+3,"宠物大血条",2),c.gi().NoClip();var _=311;_=_*xh.me.rbs.iExp/e.iUpgradeExp[xh.me.rbs.iLev],c.gi().SetViewClip(o,r,o+l+_,r+480),gn.xani_nui2.DrawAnima(o+l+2,r+76+3,"宠物大血条",3),c.gi().NoClip(),c.gi().SetViewClip(o,r,o+l+311*xh.me.rbs.iAnger/150,r+480),gn.xani_nui2.DrawAnima(o+l+2,r+114+3,"宠物大血条",5),c.gi().NoClip(),c.gi().SetViewClip(o,r,o+l+311*xh.me.rbs.iPower/xh.me.rbs.iMaxPower,r+480),gn.xani_nui2.DrawAnima(o+l+2,r+152+3,"宠物大血条",4),c.gi().NoClip(),c.gi().DrawTextEx(o+l+155.5,r+15,xh.me.rbs.iHp+"/"+xh.me.rbs.iMaxHp,4294967295,20,101,1,1,0,-2,-2),c.gi().DrawTextEx(o+l+155.5,r+40+13,xh.me.rbs.iMp+"/"+xh.me.rbs.iMaxMp,4294967295,20,101,1,1,0,-2,-2),c.gi().DrawTextEx(o+l+155.5,r+80+12,xh.me.rbs.iExp+"/"+e.iUpgradeExp[xh.me.rbs.iLev],4294967295,20,101,1,1,0,-2,-2),c.gi().DrawTextEx(o+l+155.5,r+120+13,xh.me.rbs.iAnger+"/150",4294967295,20,101,1,1,0,-2,-2),c.gi().DrawTextEx(o+l+155.5,r+160+12,xh.me.rbs.iPower+"/"+xh.me.rbs.iMaxPower,4294967295,20,101,1,1,0,-2,-2),i=Yi.iX+472,t=Yi.iY+242+35,E.ui3_Text1_(i,t,67,100,"体质",""+xh.me.rbs.tz),E.ui3_Text1_(i,t+40,67,100,"法力",""+xh.me.rbs.fl),E.ui3_Text1_(i,t+80,67,100,"力量",""+xh.me.rbs.ll),E.ui3_Text1_(i,t+120,67,100,"耐力",""+xh.me.rbs.nl),E.ui3_Text1_(i,t+160,67,100,"敏捷",""+xh.me.rbs.mj),E.ui3_Text1_(i+210,t,67,100,"灵力",""+xh.me.rbs.iSpirit),E.ui3_Text1_(i+210,t+40,67,100,"伤害",""+xh.me.rbs.iAttack),E.ui3_Text1_(i+210,t+80,67,100,"防御",""+xh.me.rbs.iDefence),E.ui3_Text1_(i+210,t+120,67,100,"速度",""+xh.me.rbs.iSpeed),E.ui3_Text1_(i+210,t+160,67,100,"潜能",""+xh.me.rbs.nut),this.btn_upgrade.Move(Yi.iX+472,Yi.iY+503,110,52),this.btn_addpoint.Move(Yi.iX+733,Yi.iY+503,110,52),this.btn_upgrade.Draw(),this.btn_addpoint.Draw()}Draw_12(i,t){var s,e,h,a;s=Yi.iX+28,e=Yi.iY+28,h=Yi.iW-28-28,a=Yi.iH-28-28,E.new_framein(s,e,h,a),1==this.iPage_jn?(this.btn_mpjn.iNameColor=4294956800,this.btn_fzjn.iNameColor=4289781990,this.btn_jqjn.iNameColor=4289781990,this.Draw_1(i,t)):2==this.iPage_jn?(this.btn_mpjn.iNameColor=4289781990,this.btn_fzjn.iNameColor=4294956800,this.btn_jqjn.iNameColor=4289781990,this.Draw_2(i,t)):3==this.iPage_jn&&(this.btn_mpjn.iNameColor=4289781990,this.btn_fzjn.iNameColor=4289781990,this.btn_jqjn.iNameColor=4294956800),this.btn_mpjn.Move(Yi.iX+53,Yi.iY+53,145,56),this.btn_mpjn.Draw(),this.btn_fzjn.Move(Yi.iX+209,Yi.iY+53,145,56),this.btn_fzjn.Draw()}Draw_1(i,t){if(xh.me.rbs.iSchoolId<=0)this.pm3f.DrawTextEx(i+150,t+150,"你还未加入门派",4294967295,20,101,1,1,0,-2,-2);else{var s,h,a,n=xh.me.rbs.iSchoolId;for(E.new_frameon(Yi.iX+459,Yi.iY+115,408,109,0),E.new_frameon(Yi.iX+459,Yi.iY+235,408,324,0),s=0;s<6;s++){a=e.iSchoolSkillId[n][s];var o=0,r=0;switch(s){case 0:o=Yi.iX+200,r=Yi.iY+115+11;break;case 1:o=Yi.iX+350,r=Yi.iY+188+11;break;case 2:o=Yi.iX+350,r=Yi.iY+341+11;break;case 3:o=Yi.iX+200,r=Yi.iY+414+11;break;case 4:o=Yi.iX+50,r=Yi.iY+341+11;break;case 5:o=Yi.iX+50,r=Yi.iY+188+11}gn.xani_nui2.DrawAnima(o,r,"技能框",0),gn.xani_nicon.DrawAnima_aa(o,r,gn.de_skill.strValue(a,0,5),0),gn.xani_nui2.DrawAnimaEx(o+1,r+87,"可变长文字框",0,101,1,1,0,0,0),gn.xani_nui2.DrawAnimaEx(o+20+1,r+87,"可变长文字框",1,101,2,1,0,0,0),gn.xani_nui2.DrawAnimaEx(o+20+40+1,r+87,"可变长文字框",2,101,1,1,0,0,0),c.gi().DrawTextEx(o+42,r+92+12,""+xh.me.rbs.iSchoolSkill[s],4294967295,20,101,1,1,0,-2,-2),c.gi().DrawText_2(o+42,r+92+40,gn.de_skill.strValue(a,0,6),4294944e3,20,101,1,1,0,-2,-2,3,4278190080),this.btn_mainskill[s].Move(o,r,92,92)}var l=5;for(a=e.iSchoolSkillId[n][this.iMainSkillPoint],gn.xani_nui2.DrawAnima(Yi.iX+466+5,Yi.iY+123+l,"技能框",0),gn.xani_nicon.DrawAnima_aa(Yi.iX+466+5,Yi.iY+123+l,gn.de_skill.strValue(a,0,5),0),c.gi().DrawText_2(Yi.iX+466+42+5,Yi.iY+123+90+l-10,gn.de_skill.strValue(a,0,6),4294944e3,20,101,1,1,0,-2,-2,3,4278190080),Y.gi().Format("#cffe0c0"+gn.de_skill.strValue(a,0,3),309,20),Y.gi().Draw(Yi.iX+560+5,Yi.iY+121+l),l=8,s=0;s<3;s++)gn.xani_nui2.DrawAnima(Yi.iX+466+5,Yi.iY+238+109*s+l,"技能框",0);if(this.iMainSkillPoint>=0&&this.iMainSkillPoint<6)for(a=e.iSchoolSkillId[n][this.iMainSkillPoint],s=0;s<10&&!((h=gn.de_skill.intValue(a,s,4))<=0);s++)gn.xani_nicon.DrawAnima_aa(Yi.iX+466+5,Yi.iY+238+109*s+l,gn.de_skill.strValue(h,0,5),0),c.gi().DrawText_2(Yi.iX+466+42+5,Yi.iY+238+109*s+90+l-10,gn.de_skill.strValue(h,0,6),4294959296,20,101,1,1,0,-2,-2,3,4278190080),Y.gi().Format("#cffe0c0"+gn.de_skill.strValue(h,0,3),309,20),Y.gi().Draw(Yi.iX+560+5,Yi.iY+238+109*s+l)}}Draw_2(i,t){var s,h,a,n,o;for(E.new_frameon(Yi.iX+537,Yi.iY+118,331,269,0),E.new_frameon(Yi.iX+537,Yi.iY+417,331,144,0),gn.xani_nui2.DrawAnima(Yi.iX+554,Yi.iY+127,"背景图案",0),s=0;s<12;s++)gn.xani_nui2.DrawAnima(Yi.iX+52+s%4*120,Yi.iY+119+150*parseInt(s/4),"技能框",0);for(s=0;s<10;s++){if(a=0,n=Yi.iX+52+s%4*120,o=Yi.iY+119+150*parseInt(s/4),this.btn_govskill[s].Move(-100,-100,60,60),s<8){if(xh.me.rbs.iGovSkill[s]<=0)continue;a=e.iGovSkillId[s],gn.xani_nicon.DrawAnima_aa(n,o,gn.de_skill.strValue(a,0,5),0),gn.xani_nui2.DrawAnimaEx(n+1,o+87,"可变长文字框",0,101,1,1,0,0,0),gn.xani_nui2.DrawAnimaEx(n+20+1,o+87,"可变长文字框",1,101,2,1,0,0,0),gn.xani_nui2.DrawAnimaEx(n+20+40+1,o+87,"可变长文字框",2,101,1,1,0,0,0),c.gi().DrawTextEx(n+42,o+92+12,""+xh.me.rbs.iGovSkill[s],4294967295,20,101,1,1,0,-2,-2),c.gi().DrawText_2(n+42,o+92+38,gn.de_skill.strValue(a,0,6),4294944e3,20,101,1,1,0,-2,-2,3,4278190080)}else if(8==s){if((h=xh.me.iFlag[33]%10)<=0)continue;a=203,gn.xani_nicon.DrawAnima_aa(n,o,gn.de_skill.strValue(a,0,5),0),gn.xani_nui2.DrawAnimaEx(n+1,o+87,"可变长文字框",0,101,1,1,0,0,0),gn.xani_nui2.DrawAnimaEx(n+20+1,o+87,"可变长文字框",1,101,2,1,0,0,0),gn.xani_nui2.DrawAnimaEx(n+20+40+1,o+87,"可变长文字框",2,101,1,1,0,0,0),c.gi().DrawTextEx(n+42,o+92+12,""+h,4294967295,20,101,1,1,0,-2,-2),c.gi().DrawText_2(n+42,o+92+38,gn.de_skill.strValue(a,0,6),4294944e3,20,101,1,1,0,-2,-2,3,4278190080)}else{if(9!=s)continue;if((h=parseInt(xh.me.iFlag[33]/10)%10)<=0)continue;a=204,gn.xani_nicon.DrawAnima_aa(n,o,gn.de_skill.strValue(a,0,5),0),gn.xani_nui2.DrawAnimaEx(n+1,o+87,"可变长文字框",0,101,1,1,0,0,0),gn.xani_nui2.DrawAnimaEx(n+20+1,o+87,"可变长文字框",1,101,2,1,0,0,0),gn.xani_nui2.DrawAnimaEx(n+20+40+1,o+87,"可变长文字框",2,101,1,1,0,0,0),c.gi().DrawTextEx(n+42,o+92+12,""+h,4294967295,20,101,1,1,0,-2,-2),c.gi().DrawText_2(n+42,o+92+38,gn.de_skill.strValue(a,0,6),4294944e3,20,101,1,1,0,-2,-2,3,4278190080)}this.btn_govskill[s].Move(n,o,92,92),0,this.iGovSkillPoint==s&&0!=a&&(c.gi().DrawTextEx(Yi.iX+542,Yi.iY+421,gn.de_skill.strValue(a,0,6),4294967295,22,101,1,1,0,0,0),Y.gi().Format("#cffe0c0"+gn.de_skill.strValue(a,0,3),320,20),Y.gi().Draw(Yi.iX+542,Yi.iY+458))}}Draw_3(i,t){var s,h,a,n,o;for(s=Yi.iX+28,h=Yi.iY+28,a=Yi.iW-28-28,n=Yi.iH-28-28,E.new_framein(s,h,a,n),E.new_frameon(Yi.iX+55,Yi.iY+54,84,294,0),E.new_frameon(Yi.iX+55,Yi.iY+344,84,211,0),gn.xani_nui2.DrawAnima(Yi.iX+81,Yi.iY+126,"人物宠物修炼",0),gn.xani_nui2.DrawAnima(Yi.iX+81,Yi.iY+383,"人物宠物修炼",1),gn.xani_nui2.DrawAnimaEx(Yi.iX+135,Yi.iY+56,"标题条",0,101,1,1,0,0,0),gn.xani_nui2.DrawAnimaEx(Yi.iX+135+20,Yi.iY+56,"标题条",1,101,34,1,0,0,0),gn.xani_nui2.DrawAnimaEx(Yi.iX+135+720-20,Yi.iY+56,"标题条",2,101,1,1,0,0,0),c.gi().DrawText_2(Yi.iX+258,Yi.iY+82,"修炼选项",4293848576,30,101,1,1,0,-2,-2,3,4291639040),c.gi().DrawText_2(Yi.iX+496,Yi.iY+82,"等级",4293848576,30,101,1,1,0,-2,-2,3,4291639040),c.gi().DrawText_2(Yi.iX+737,Yi.iY+82,"修炼经验",4293848576,30,101,1,1,0,-2,-2,3,4291639040),o=0;o<6;o++)o%2==0?E.new_bgbar(Yi.iX+135,Yi.iY+107+40*o,720,20,"内容条1"):E.new_bgbar(Yi.iX+135,Yi.iY+107+40*o,720,20,"内容条2"),c.gi().DrawTextEx(Yi.iX+258,Yi.iY+129+40*o,gn.de_skill.strValue(e.iGovXiuId[o],0,5),4294967295,20,101,1,1,0,-2,-2),c.gi().DrawTextEx(Yi.iX+496,Yi.iY+129+40*o,xh.me.rbs.iGovXiu[o][0]+"/"+parseInt(xh.me.rbs.iLev/5),4294967295,20,101,1,1,0,-2,-2),c.gi().DrawTextEx(Yi.iX+737,Yi.iY+129+40*o,xh.me.rbs.iGovXiu[o][1]+"/"+parseInt(Fi.iBuildingUpgrad[xh.me.rbs.iGovXiu[o][0]]/10),4294967295,20,101,1,1,0,-2,-2);for(gn.xani_nui2.DrawAnimaEx(Yi.iX+135,Yi.iY+346,"标题条",0,101,1,1,0,0,0),gn.xani_nui2.DrawAnimaEx(Yi.iX+135+20,Yi.iY+346,"标题条",1,101,34,1,0,0,0),gn.xani_nui2.DrawAnimaEx(Yi.iX+135+720-20,Yi.iY+346,"标题条",2,101,1,1,0,0,0),c.gi().DrawText_2(Yi.iX+258,Yi.iY+373,"修炼选项",4293848576,30,101,1,1,0,-2,-2,3,4291639040),c.gi().DrawText_2(Yi.iX+496,Yi.iY+373,"等级",4293848576,30,101,1,1,0,-2,-2,3,4291639040),c.gi().DrawText_2(Yi.iX+737,Yi.iY+373,"修炼经验",4293848576,30,101,1,1,0,-2,-2,3,4291639040),o=6;o<10;o++)o%2==0?E.new_bgbar(Yi.iX+135,Yi.iY+107+40*o+50,720,20,"内容条1"):E.new_bgbar(Yi.iX+135,Yi.iY+107+40*o+50,720,20,"内容条2"),c.gi().DrawTextEx(Yi.iX+258,Yi.iY+129+40*o+50,gn.de_skill.strValue(e.iGovXiuId[o],0,5),4294967295,20,101,1,1,0,-2,-2),c.gi().DrawTextEx(Yi.iX+496,Yi.iY+129+40*o+50,xh.me.rbs.iGovXiu[o][0]+"/"+parseInt(xh.me.rbs.iLev/5),4294967295,20,101,1,1,0,-2,-2),c.gi().DrawTextEx(Yi.iX+737,Yi.iY+129+40*o+50,xh.me.rbs.iGovXiu[o][1]+"/"+parseInt(Fi.iBuildingUpgrad[xh.me.rbs.iGovXiu[o][0]]/10),4294967295,20,101,1,1,0,-2,-2);gn.xani_nui2.DrawAnima(Yi.iX+55+2,Yi.iY+344,"分隔条1",0),gn.xani_nui2.DrawAnima(Yi.iX+376,Yi.iY+56,"分隔条1",1),gn.xani_nui2.DrawAnima(Yi.iX+618,Yi.iY+56,"分隔条1",1),gn.xani_nui2.DrawAnima(Yi.iX+376,Yi.iY+346,"分隔条1",1),gn.xani_nui2.DrawAnima(Yi.iX+618,Yi.iY+346,"分隔条1",1)}Draw_4(i,t){var s,e,h,a,n,o;for(h=Yi.iX+28,a=Yi.iY+28,n=Yi.iW-28-28,o=Yi.iH-28-28,E.new_framein(h,a,n,o),null==this.list_vip&&(this.list_vip=new Oi(0,4,Yi.iW-28-28-30-30,370),this.list_vip.SetTitle(0,"特权",200,!1),this.list_vip.SetTitle(1,"剩余天数<=30",200,!0),this.list_vip.SetTitle(2,"剩余天数<=60",200,!0),this.list_vip.SetTitle(3,"剩余天数>60",200,!0)),this.list_vip.BeginDraw(Yi.iX+28+30,Yi.iY+28+80),s=0;s<8;s++)for(e=0;e<4;e++)this.list_vip.DrawUnit(e,s,this._SVIPT[s+1][e]);this.list_vip.FinishDraw(),xh.me.iFlag[20]>60?E.frame_type2("黄色透明框a25_25",Yi.iX+28+30+600,Yi.iY+28+80+50,200,320,25,25):xh.me.iFlag[20]>30?E.frame_type2("黄色透明框a25_25",Yi.iX+28+30+400,Yi.iY+28+80+50,200,320,25,25):xh.me.iFlag[20]>0&&E.frame_type2("黄色透明框a25_25",Yi.iX+28+30+200,Yi.iY+28+80+50,200,320,25,25),c.gi().DrawText_2(Yi.iX+Yi.iW/2,Yi.iY+28+40,"会员特权",4278206039,40,101,1,1,0,-2,-2,3,4287496191),xh.me.iFlag[20]<=0?c.gi().DrawTextEx(Yi.iX+Yi.iW/2+80,Yi.iY+28+40+20,"（还未开通）",4294901760,25,101,1,1,0,0,-3):c.gi().DrawTextEx(Yi.iX+Yi.iW/2+80,Yi.iY+28+40+20,"（已开通：剩余"+xh.me.iFlag[20]+"天）",4294901760,25,101,1,1,0,0,-3),this.btn_vip.Move(Yi.iX+Yi.iW-28-30-141,Yi.iY+Yi.iH-28-30-49,141,49),this.btn_vip.Draw(),ei.end(ei.CONFIRM_VIP)&&ei.bConfirm&&Mh.gi().s_SeverEvent(7,0,0,0,0)}Draw(){var i;for(E.new_baseframe2(Yi.iX,Yi.iY,Yi.iW,Yi.iH,"人","物"),this.btn_close.Draw(),i=0;i<4;i++)this.iPage==i&&(this.btn_page[i].bMouseIn=!0,this.btn_page[i].bMouseDown=!0),this.btn_page[i].Draw();switch(E.new_lableword4(Yi.iX+Yi.iW-15,Yi.iY+50+0-4,40,70,0==this.iPage,"人","物","属","性"),E.new_lableword4(Yi.iX+Yi.iW-15,Yi.iY+50+130-8,40,70,1==this.iPage,"人","物","技","能"),E.new_lableword2(Yi.iX+Yi.iW-15,Yi.iY+50+260+7,40,70,2==this.iPage,"修","炼"),E.new_lableword2(Yi.iX+Yi.iW-15,Yi.iY+50+390-4,40,70,3==this.iPage,"会","员"),this.iPage){case 0:this.Draw_0(Yi.iX,Yi.iY);break;case 1:this.Draw_12(Yi.iX,Yi.iY);break;case 2:this.Draw_3(Yi.iX,Yi.iY);break;case 3:this.Draw_4(Yi.iX,Yi.iY)}if(ei.end(ei.CONFIRM_UPGRADE)&&ei.bConfirm&&Mh.gi().s_UpgradeMe(xh.me.rbs.iLev),Xi.end(Xi.ADDPOINT_USER)&&Xi.bConfirm){for(i=0;i<5;i++)xh.me.rbs.iBaseAtt[i]+=Xi.iModifys[i];xh.me.CalcFightAtt(),Mh.gi().s_AddPoint(Xi.iModifys[0],Xi.iModifys[1],Xi.iModifys[2],Xi.iModifys[3],Xi.iModifys[4])}}ProcTouch(i,t,s){var h;for(h=0;h<4;h++)this.btn_page[h].ProcTouch(i,t,s)&&this.btn_page[h].bCheck()&&(this.iPage=h);if(this.btn_mpjn.ProcTouch(i,t,s)&&this.btn_mpjn.bCheck()&&(this.iPage_jn=1),this.btn_fzjn.ProcTouch(i,t,s)&&this.btn_fzjn.bCheck()&&(this.iPage_jn=2),this.btn_close.ProcTouch(i,t,s))return this.btn_close.bCheck()&&ln.gi().PopStat(1),!0;switch(this.iPage){case 0:if(this.btn_upgrade.ProcTouch(i,t,s))return this.btn_upgrade.bCheck()&&(xh.me.rbs.iLev>=80?L.easymsg.AddMessage("等级已到达上限"):xh.me.rbs.iLev>=10&&xh.me.rbs.iSchoolId<=0?Z.fm.Open("少侠先去找个靠谱的门派拜师后再升级吧"):xh.me.rbs.iLev>=70&&0==(4&xh.me.iFlag[39])?Z.fm.Open("你的等级上限还未突破70，请先完成修仙灵丹任务"):xh.me.rbs.iExp<e.iUpgradeExp[xh.me.rbs.iLev]?L.easymsg.AddMessage("经验不足，先去练练吧"):xh.me.rbs.iLev>=10&&xh.me.rbs.iLev<=25?ei.start(ei.CONFIRM_UPGRADE,"10~25级之间可以拜师#e是否确认升级？"):ei.start(ei.CONFIRM_UPGRADE,"是否确认升级？")),!0;if(this.btn_addpoint.ProcTouch(i,t,s))return this.btn_addpoint.bCheck()&&Ei.pxe.RunXms("人物加点"),!0;if(this.btn_title.ProcTouch(i,t,s))return this.btn_title.bCheck()&&(Mh.gi().s_proctitle(100,""),ln.gi().PushStat(ln.GS_SETTITLE)),!1;break;case 1:switch(this.iPage_jn){case 1:for(h=0;h<6;h++)this.btn_mainskill[h].ProcTouch(i,t,s)&&this.btn_mainskill[h].bCheck()&&(this.iMainSkillPoint=h);break;case 2:for(h=0;h<10;h++)this.btn_govskill[h].ProcTouch(i,t,s)&&this.btn_govskill[h].bCheck()&&(this.iGovSkillPoint=h)}break;case 2:break;case 3:if(this.btn_vip.ProcTouch(i,t,s))return this.btn_vip.bCheck()&&ei.start(ei.CONFIRM_VIP,"是否确定花费300元宝增加30天会员期限？"),!0}return!!bn.bOnRect(t,s,Yi.iX,Yi.iY,Yi.iW,Yi.iH)}}Yi.iX,Yi.iY,Yi.iW,Yi.iH,Yi.Open=function(i){var t=ln.gi().PushStat(ln.GS_MYATTFRAME);return t.iPage=i,t},Yi.wordframe=function(i,t,s){gn.xani_nui2.DrawAnimaEx(i,t,"可变长文字框",0,101,1,1,0,0,0),gn.xani_nui2.DrawAnimaEx(i+15,t,"可变长文字框",1,101,1*(s-30)/20,1,0,0,0),gn.xani_nui2.DrawAnimaEx(i+s-20,t,"可变长文字框",2,101,1,1,0,0,0)},Yi.Skill_Detail=function(i,t,s,e){var h,a,n;a=300,Y.gi().FormatEx(gn.de_skill.strValue(i,0,3),270,24,0,0,28),(n=110+Y.gi().iH+10+20)<120&&(n=120),s-=n-85,(t-=a)<0&&(t=t+a+85),E.new_framewatch(t,s,a,n),gn.xani_nicon.DrawAnima_aa(t+20,s+20,gn.de_skill.strValue(i,0,5),0),c.gi().DrawTextEx(t+20+80+10,s+20,gn.de_skill.strValue(i,0,6),4294967040,30,101,1,1,0,0,0),1==(h=gn.de_skill.intValue(i,0,7))?c.gi().DrawTextEx(t+20+80+10,s+20+32,"战斗中使用",4294967040,22,101,1,1,0,0,0):0==h?c.gi().DrawTextEx(t+20+80+10,s+20+32,"漫游中使用",4294967040,22,101,1,1,0,0,0):3==h&&c.gi().DrawTextEx(t+20+80+10,s+20+32,"被动技能",4294967040,22,101,1,1,0,0,0),e>=0&&c.gi().DrawTextEx(t+20+80+10,s+20+56,"等级"+e,4294967040,22,101,1,1,0,0,0),Y.gi().Draw(t+20,s+20+80+10)};class Wi{constructor(i){this.pani=i,this.pm3f=c.gi(),this.bSingleButton=!1,this.bCheckByRect=!1,this.ReleaseButton(),this.sName="",this.iNameColor=4294967295,this.Move(0,0,100,100),this.iFingerLocker=-1,this.iAnimaStat=0,this.fScale=1,this.iNameSize=30}InitButton(i){this.pani.InitAnimaWithName(i,gn.aaa),gn.aaa.iFrame=0,this.SetAnimaNormal(gn.aaa,!1),gn.aaa.iFrame=1,this.SetAnimaMouseon(gn.aaa,!1),this.SetAnimaMousedown(gn.aaa,!1),gn.aaa.iFrame=0,this.SetAnimaDisable(gn.aaa,!1)}ReleaseButton(){this.aa_normal=null,this.act_normal=!1,this.aa_mouseon=null,this.act_mouseon=!1,this.aa_mousedown=null,this.act_mousedown=!1,this.bMouseIn=!1,this.bMouseDown=!1,this.bVisible=!0,this.bDisable=!1,this.iX=0,this.iY=0}SetAnimaNormal(i,t){null==this.aa_normal&&(this.aa_normal=new l),this.aa_normal.copyfrom(i),this.act_normal=t}SetAnimaMouseon(i,t){null==this.aa_mouseon&&(this.aa_mouseon=new l),this.aa_mouseon.copyfrom(i),this.act_mouseon=t}SetAnimaMousedown(i,t){null==this.aa_mousedown&&(this.aa_mousedown=new l),this.aa_mousedown.copyfrom(i),this.act_mousedown=t}SetAnimaDisable(i,t){null==this.aa_disable&&(this.aa_disable=new l),this.aa_disable.copyfrom(i),this.act_disable=t}Move(i,t,s,e){this.iX=i,this.iY=t,this.iW=s,this.iH=e}ProcTouch(i,t,s){if(-1!=this.iFingerLocker&&this.iFingerLocker!=Gh.iFingerId)return!1;if(!this.bVisible)return!1;if(this.bDisable)return!1;if(3==i&&(this.iFingerLocker=-1),!this.bMoveIn(t,s))return this.iFingerLocker=-1,this.bMouseDown=!1,0==this.iAnimaStat&&1!=this.fScale&&(this.iAnimaStat=11),!1;switch(i){case 1:this.iFingerLocker=Gh.iFingerId,this.bMouseDown=!0,this.iAnimaStat=1;break;case 2:break;case 3:this.bMouseDown&&(this.bMouseDown=!1,this.bChecked=!0,this.iAnimaStat=11),this.iFingerLocker=-1}return!0}bCheck(){return!!this.bChecked&&(this.bChecked=!1,!0)}bMoveIn(i,t){return this.bMouseIn=!1,this.bSingleButton||this.bCheckByRect?i>=this.iX&&i<=this.iX+this.iW&&t>=this.iY&&t<=this.iY+this.iH?this.bMouseIn=!0:this.bMouseIn=!1:this.pani.bInAnima(this.aa_normal,this.iX,this.iY,i,t)?this.bMouseIn=!0:this.bMouseIn=!1,this.bMouseIn}Draw(){for(;fn.gi().bInBound(this.iX,this.iY,this.iW,this.iH);)this.iX--;switch(this.iAnimaStat){case 0:break;case 1:this.fScale+=.2,this.fScale>1.3&&(this.iAnimaStat=2);break;case 2:this.fScale-=.2,this.iAnimaStat=0;break;case 11:this.fScale-=.2,this.fScale<1&&(this.iAnimaStat=12);break;case 12:this.fScale=1,this.iAnimaStat=0}if(this.bVisible&&(this.bDisable?this.bSingleButton?this.pm3f.FillRect_2D(this.iX,this.iY,this.iX+this.iW,this.iY+this.iH,3238002687):this.pani.DrawAnima_aa(this.iX,this.iY,this.aa_disable):this.bMouseDown?this.pani.DrawAnimaEx(this.iX-(this.fScale-1)*this.iW/2,this.iY-(this.fScale-1)*this.iH/2,this.aa_mousedown,101,this.fScale,this.fScale,0,0,0):this.pani.DrawAnimaEx(this.iX-(this.fScale-1)*this.iW/2,this.iY-(this.fScale-1)*this.iH/2,this.aa_normal,101,this.fScale,this.fScale,0,0,0),this.bSingleButton||this.sName.length>0)){this.iNameColor;this.bDisable&&4286611584,this.pm3f.DrawText_2(this.iX+this.iW/2,this.iY+this.iH/2,this.sName,4284539104,this.iNameSize,101,this.fScale,this.fScale,0,-2,-2,2,4278190080)}}}class Li{constructor(){var i;for(this.iGid=-1,this.iAtts=new Int32Array(8),this.aa=new l,i=0;i<8;i++)this.iAtts[i]=0}copyfrom(i){var t;for(this.iGid=i.iGid,this.iTid=i.iTid,this.iCount=i.iCount,t=0;t<8;t++)this.iAtts[t]=i.iAtts[t];this.aa.copyfrom(i.aa)}SetAtt(i,t,s,e,h,a,n,o,r,c,l){this.iGid=i,this.iTid=t,this.iCount=s,this.iAtts[0]=e,this.iAtts[1]=h,this.iAtts[2]=a,this.iAtts[3]=n,this.iAtts[4]=o,this.iAtts[5]=r,this.iAtts[6]=c,this.iAtts[7]=l,gn.xani_ngoods.InitAnimaWithName(gn.de_goods.strValue(t,-1,10),this.aa)}CalcSetScore(){var i=gn.de_goods.intValue(this.iTid,0,16);if(i>=0){if(this.iAtts[1]<=0)return this.iScore=0,0;var t,s,e,h=0,a=0;switch(i){case 0:a=1.2*(gn.de_goods.intValue(this.iTid,0,21)+this.iAtts[0]/1e4)+.5*(gn.de_goods.intValue(this.iTid,0,22)+this.iAtts[0]%1e4);break;case 1:a=2*(gn.de_goods.intValue(this.iTid,0,23)+this.iAtts[0]);break;case 2:a=1.5*(gn.de_goods.intValue(this.iTid,0,3)+this.iAtts[0]);break;case 3:a=1.2*(gn.de_goods.intValue(this.iTid,0,21)+this.iAtts[0]);break;case 4:a=1.2*(gn.de_goods.intValue(this.iTid,0,21)+this.iAtts[0]/1e4)+1*(gn.de_goods.intValue(this.iTid,0,24)+this.iAtts[0]%1e4);break;case 5:a=1.2*(gn.de_goods.intValue(this.iTid,0,21)+this.iAtts[0]/1e4)+1.5*(gn.de_goods.intValue(this.iTid,0,25)+this.iAtts[0]%1e4)}return a+=2*(this.iAtts[1]/1e4%100+this.iAtts[1]%1e4%100),s=gn.de_goods.intValue(this.iTid,0,9),(t=this.iAtts[4]>>20&1023)>0&&(h+=gn.de_skill.intValue(t,0,38),a*=1.05),(t=this.iAtts[4]>>10&1023)>0&&(h+=gn.de_skill.intValue(t,0,38),a*=1.05),(t=1023&this.iAtts[4])>0&&(h+=gn.de_skill.intValue(t,0,38),a*=1.05),e=15*(this.iAtts[2]/1e4%100+this.iAtts[2]%1e4%100),this.iScore=parseInt(a+s+h+e),this.iScore}return 0}}Li.GetSetNJ=function(i){var t=100+5*i;return 1e5*t+20*t};class Hi{bHaveSkill(i){for(var t=0;t<12;t++)if(this.jn[t]==i)return!0;return!1}constructor(){this.iPid=-1,this.sName="",this.aa_body=new l,this.iBaseAtt=new Int32Array(5),this.zz=new Int32Array(5),this.jn=new Int32Array(12)}copyfrom(i){var t;for(this.iPid=i.iPid,this.iTid=i.iTid,this.iLife=i.iLife,this.iAddAtt=i.iAddAtt,this.iBaobao=i.iBaobao,this.iFlag=i.iFlag,this.iHp=i.iHp,this.iMp=i.iMp,this.iMaxHp=i.iMaxHp,this.iMaxMp=i.iMaxMp,this.iExp=i.iExp,this.iLev=i.iLev,t=0;t<5;t++)this.iBaseAtt[t]=i.iBaseAtt[t];for(this.nut=i.nut,this.tz=i.tz,this.fl=i.fl,this.ll=i.ll,this.nl=i.nl,this.mj=i.mj,this.iSpirit=i.iSpirit,this.iAttack=i.iAttack,this.iDefence=i.iDefence,this.iSpeed=i.iSpeed,t=0;t<5;t++)this.zz[t]=i.zz[t];for(this.cz=i.cz,t=0;t<12;t++)this.jn[t]=i.jn[t];this.sName=i.sName,this.iStar=i.iStar,this.aa_body.copyfrom(i.aa_body)}CalcPetScore(){var i,t=gn.de_pet.intValue(this.iTid,0,2),s=((this.zz[0]+this.zz[1])/10+(this.zz[2]+this.zz[3]+this.zz[4])/6)*this.cz/1e3,e=1e5*this.iStar/(2e3-this.cz),h=1,a=0;for(i=0;i<8;i++)this.jn[i]>0&&(h*=1.05,a+=gn.de_skill.intValue(this.jn[i],0,37));return(i=parseInt(h*(s+a)+t+e))!=this.iScore&&(this.iScore=i),this.iScore}}class Bi{constructor(){var i;for(this.pm3f=c.xm3f,this.pets=new Array(8),i=0;i<8;i++)this.pets[i]=new Hi;this.RETPET_HPMPLIFE=1,this.RETPET_ATT=2,this.RETPET_SKILL=4,this.RETPET_ZZCZ=8,this.RETPET_EXPLEV=16,this.RETPET_OTHER=128}FindPet(i){var t;if(i<=0)return null;for(t=0;t<8;t++)if(this.pets[t].iPid>0&&i==this.pets[t].iPid)return this.pets[t];return null}GetUseingPet(){var i;for(i=0;i<8;i++)if(-1!=this.pets[i].iPid&&xh.me.iFightPid==this.pets[i].iPid)return this.pets[i];return null}RemovePet(i){var t;for(t=0;t<8&&this.pets[t].iPid!=i;t++);if(!(t>=8)){for(var s=this.pets[t];t<7;t++)this.pets[t]=this.pets[t+1];for(this.pets[7]=s,this.pets[7].iPid=-1,this.iPetCount=0,t=0;t<8;t++)this.pets[t].iPid>0&&this.iPetCount++}}ProcTouch(i,t,s){return!1}GetPetBaseAtt(i){var t,s,e=i.GetNextInt();for(t=0;t<8&&this.pets[t].iPid!=e;t++);if(!(t>=8)){var h=this.pets[t];if(0!=((s=i.GetNextByte())&this.RETPET_HPMPLIFE)&&(h.iHp=i.GetNextShort(),h.iMaxHp=i.GetNextShort(),h.iMp=i.GetNextShort(),h.iMaxMp=i.GetNextShort(),h.iLife=i.GetNextShort()),0!=(s&this.RETPET_ATT))for(t=0;t<5;t++)h.iBaseAtt[t]=i.GetNextShort();if(0!=(s&this.RETPET_SKILL))for(t=0;t<8;t++)h.jn[t]=i.GetNextShort();if(0!=(s&this.RETPET_ZZCZ)){for(t=0;t<5;t++)h.zz[t]=i.GetNextShort();h.cz=i.GetNextShort()}0!=(s&this.RETPET_EXPLEV)&&(h.iExp=i.GetNextInt(),h.iLev=i.GetNextShort()),Bi.CalcFightAtt(h)}}UpdateOnePet(i){var t,s,e,h,a=i.GetNextByte();if(0==a)h=i.GetNextInt(),this.RemovePet(h);else if(1==a){for(h=i.GetNextInt(),t=0;t<8&&!(this.pets[t].iPid>0&&this.pets[t].iPid==h);t++);if(t>=8)for(t=0;t<8&&!(this.pets[t].iPid<=0);t++);for(s=t,this.pets[s].iPid=h,this.pets[s].iTid=i.GetNextShort(),this.pets[s].sName=i.GetNextString(),this.pets[s].iLev=i.GetNextShort(),this.pets[s].iExp=i.GetNextInt(),this.pets[s].iHp=i.GetNextShort(),this.pets[s].iMp=i.GetNextShort(),this.pets[s].iLife=i.GetNextShort(),e=0;e<5;e++)this.pets[s].iBaseAtt[e]=i.GetNextShort();for(e=0;e<5;e++)this.pets[s].zz[e]=i.GetNextShort();for(this.pets[s].cz=i.GetNextShort(),e=0;e<12;e++)this.pets[s].jn[e]=i.GetNextShort();if(this.pets[s].iAddAtt=i.GetNextByte(),this.pets[s].iBaobao=i.GetNextByte(),this.pets[s].iFlag=i.GetNextShort(),0==(2&this.pets[s].iBaobao)?gn.xani_pets[this.pets[s].iTid].InitAnimaWithName("站立_右下",this.pets[s].aa_body):gn.xani_pets[this.pets[s].iTid].InitAnimaWithName("变异_站立_右下",this.pets[s].aa_body),Bi.CalcFightAtt(this.pets[s]),ln.gi().iXStat==ln.GS_PETSFRAME)ln.gi().LastStat(0).iPetPoint=s}for(this.iPetCount=0,t=0;t<8;t++)this.pets[t].iPid>0&&this.iPetCount++}GetPets(i){var t,s,e,h;for(t=0;t<8;t++)this.pets[t].iPid=-1;if(2==i.GetNextByte()){for(s=0;-1!=(h=i.GetNextInt());){for(this.pets[s].iPid=h,this.pets[s].iTid=i.GetNextShort(),this.pets[s].sName=i.GetNextString(),this.pets[s].iLev=i.GetNextShort(),this.pets[s].iExp=i.GetNextInt(),this.pets[s].iHp=i.GetNextShort(),this.pets[s].iMp=i.GetNextShort(),this.pets[s].iLife=i.GetNextShort(),e=0;e<5;e++)this.pets[s].iBaseAtt[e]=i.GetNextShort();for(e=0;e<5;e++)this.pets[s].zz[e]=i.GetNextShort();for(this.pets[s].cz=i.GetNextShort(),e=0;e<12;e++)this.pets[s].jn[e]=i.GetNextShort();this.pets[s].iAddAtt=i.GetNextByte(),this.pets[s].iBaobao=i.GetNextByte(),this.pets[s].iFlag=i.GetNextShort(),0==(2&this.pets[s].iBaobao)?gn.xani_pets[this.pets[s].iTid].InitAnimaWithName("站立_右下",this.pets[s].aa_body):gn.xani_pets[this.pets[s].iTid].InitAnimaWithName("变异_站立_右下",this.pets[s].aa_body),Bi.CalcFightAtt(this.pets[s]),s++}this.iPetCount=s}}CalcAll(){var i;for(i=0;i<8;i++)-1!=this.pets[i].iPid&&Bi.CalcFightAtt(this.pets[i])}}Bi.mp=new Bi,Bi.bHavePetCount=function(){var i,t=0;for(i=0;i<8;i++)-1!=Bi.mp.pets[i].iPid&&t++;return t},Bi.bHavePet=function(i,t){var s;for(s=0;s<8;s++)if(-1!=Bi.mp.pets[s].iPid&&Bi.mp.pets[s].iTid==i){if(0!=(1&t)&&0==(1&Bi.mp.pets[s].iBaobao))continue;if(0!=(2&t)&&0==(2&Bi.mp.pets[s].iBaobao))continue;return!0}return!1},Bi.swapcz=function(i){var t=parseInt(i/1e3)+".";return parseInt(i/100)%10==0?t+="0":t+=parseInt(i/100)%10,parseInt(i/10)%10==0?t+="0":t+=parseInt(i/10)%10,t+=i%10==0?"":i%10},Bi.CalcFightAtt=function(i){var t,s,e=0;Bi.mp.FindPet(i.iPid)==i&&xh.me.iFlagExt[10]>0&&(e=xh.me.iFlagExt[6]>>18&31),0==(4&i.iBaobao)?i.iStar=0:0==(8&i.iBaobao)?i.iStar=1:0==(16&i.iBaobao)?i.iStar=2:0==(32&i.iBaobao)?i.iStar=3:0==(64&i.iBaobao)?i.iStar=4:i.iStar=5,0==(128&i.iBaobao)?i.iSkillBlock=8:i.iSkillBlock=9,t=5*i.iLev+i.iAddAtt+25*i.iStar,s=i.iBaseAtt[0]+i.iBaseAtt[1]+i.iBaseAtt[2]+i.iBaseAtt[3]+i.iBaseAtt[4],i.nut=t-s,0!=(1&i.iBaobao)&&(i.nut+=50);var h=10+i.iBaseAtt[0]+i.iLev+5*i.iStar+e,a=10+i.iBaseAtt[1]+i.iLev+5*i.iStar+e,n=10+i.iBaseAtt[2]+i.iLev+5*i.iStar+e,o=10+i.iBaseAtt[3]+i.iLev+5*i.iStar+e,r=10+i.iBaseAtt[4]+i.iLev+5*i.iStar+e,c=i.cz;i.iMaxHp=i.iLev*i.zz[0]+h*c*6,i.iMaxMp=i.iLev*i.zz[1]+a*c*6,i.iSpirit=i.iLev*(i.zz[1]+1640)*(c+1e3)/7500+300*h+700*a+400*n+200*o,i.iSpeed=i.zz[4]*r,i.iAttack=i.iLev*i.zz[2]*(1400+i.cz)/750+i.cz*n,i.iDefence=i.iLev*i.zz[3]*(1900/3+i.cz)/750+i.cz*o*4/3,i.bHaveSkill(282)?i.iMaxHp+=3600*i.iLev:i.bHaveSkill(281)?i.iMaxHp+=2400*i.iLev:i.bHaveSkill(280)&&(i.iMaxHp+=1200*i.iLev),i.bHaveSkill(212)?i.iDefence+=1800*i.iLev:i.bHaveSkill(211)?i.iDefence+=1200*i.iLev:i.bHaveSkill(210)&&(i.iDefence+=600*i.iLev),i.bHaveSkill(215)?i.iAttack+=1500*i.iLev:i.bHaveSkill(214)?i.iAttack+=1e3*i.iLev:i.bHaveSkill(213)&&(i.iAttack+=500*i.iLev),i.tz=h,i.fl=a,i.ll=n,i.nl=o,i.mj=r,i.iMaxHp=parseInt((i.iMaxHp+500)/1e3),i.iMaxMp=parseInt((i.iMaxMp+500)/1e3),i.iSpirit=parseInt((i.iSpirit+500)/1e3),i.iAttack=parseInt((i.iAttack+500)/1e3),i.iDefence=parseInt((i.iDefence+500)/1e3),i.iSpeed=parseInt((i.iSpeed+500)/1e3),i.iHp<=0&&(i.iHp=i.iMaxHp,i.iMp=i.iMaxMp),i.iHp>i.iMaxHp&&(i.iHp=i.iMaxHp),i.iMp>i.iMaxMp&&(i.iMp=i.iMaxMp)};class Vi extends s{constructor(i){var t;for(super(),this.iW=885,this.iH=460,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_select=new Eh(gn.xani_nui2),this.btn_select.InitButton("按钮1"),this.btn_select.sName="确定",this.btn_petlist=new Array(8),t=0;t<8;t++)this.btn_petlist[t]=new D(gn.xani_ui),this.btn_petlist[t].bSingleButton=!0;this.iPetPoint=0}Draw(){var i,t,s,e,h;for(E.new_bigframe(this.iX,this.iY,this.iW,this.iH),t=this.iX+30,s=this.iY+30,E.new_framein(t,s,392,400),i=0;i<8;i++)e=t+20+i%4*92,h=s+20+92*parseInt(i/4),gn.xani_nui2.DrawAnima(e,h,"宠物头像框",0),this.btn_petlist[i].Move(e,h,83,83),i>=Bi.mp.iPetCount||(gn.xani_head.DrawAnima_aa(e,h,gn.de_pet.strValue(Bi.mp.pets[i].iTid,0,1),0),parseInt(Bi.mp.pets[i].iFlag/100)%10!=0&&c.gi().DrawText_2(e-6,h+80,"绑",4285267956,26,101,1,1,0,0,-3,4,4278190080),this.iPetPoint==i&&(gn.xani_nui2.DrawAnimaEx(e,h,"头像选中框",0,101,1,1,0,0,0),c.gi().DrawTextEx(t+20,s+210,"宠物名称："+Bi.mp.pets[i].sName,4278206039,22,101,1,1,0,0,0),c.gi().DrawTextEx(t+20,s+210+30,"体质资质："+Bi.mp.pets[i].zz[0],4278206039,22,101,1,1,0,0,0),c.gi().DrawTextEx(t+20,s+210+60,"法力资质："+Bi.mp.pets[i].zz[1],4278206039,22,101,1,1,0,0,0),c.gi().DrawTextEx(t+20,s+210+90,"力量资质："+Bi.mp.pets[i].zz[2],4278206039,22,101,1,1,0,0,0),c.gi().DrawTextEx(t+20,s+210+120,"耐力资质："+Bi.mp.pets[i].zz[3],4278206039,22,101,1,1,0,0,0),c.gi().DrawTextEx(t+20,s+210+150,"敏捷资质："+Bi.mp.pets[i].zz[4],4278206039,22,101,1,1,0,0,0),c.gi().DrawTextEx(t+20+200,s+210+30,"等级："+Bi.mp.pets[i].iLev,4278206039,22,101,1,1,0,0,0),c.gi().DrawTextEx(t+20+200,s+210+60,"成长："+Bi.swapcz(Bi.mp.pets[i].cz),4278206039,22,101,1,1,0,0,0),c.gi().DrawTextEx(t+20+200,s+210+90,"寿命："+Bi.mp.pets[i].iLife,4278206039,22,101,1,1,0,0,0),c.gi().DrawTextEx(t+20+200,s+210+120,"进阶："+Bi.mp.pets[i].iStar,4278206039,22,101,1,1,0,0,0)));for(t+=412,E.new_framein(t,s,415,400),i=0;i<12;i++)e=t+20+i%4*99,h=s+20+97*parseInt(i/4),gn.xani_nui2.DrawAnima(e,h,"技能框",0),this.iPetPoint>=Bi.mp.iPetCount||(i>=Bi.mp.pets[this.iPetPoint].iSkillBlock&&gn.xani_nui2.DrawAnima(e,h,"技能框",1),Bi.mp.pets[this.iPetPoint].jn[i]>0&&gn.xani_nicon.DrawAnima_aa(e,h,gn.de_skill.strValue(Bi.mp.pets[this.iPetPoint].jn[i],0,5),0));this.btn_select.Move(t+127,s+325,161,53),this.btn_select.Draw(),this.btn_close.Draw()}ProcTouch(i,t,s){var e;for(e=0;e<Bi.mp.iPetCount;e++)if(this.btn_petlist[e].ProcTouch(i,t,s))return this.btn_petlist[e].bCheck()&&(this.iPetPoint=e),!0;return this.btn_select.ProcTouch(i,t,s)&&this.btn_select.bCheck()&&(this.iPetPoint<Bi.mp.iPetCount&&(Vi.bSelect=!0,Vi.selpet=Bi.mp.pets[this.iPetPoint]),ln.gi().PopStat(1)),this.btn_close.ProcTouch(i,t,s)&&this.btn_close.bCheck()&&ln.gi().PopStat(1),!1}}Vi.wo,Vi.selpet,Vi.bSelect=!1,Vi.iFlag=0,Vi.Open=function(i,t){ln.gi().PushStat(ln.GS_SELECTMYPET),Vi.wo=i,Vi.iFlag=t};class Ui extends s{constructor(i){super(),this.pets=new Array(2),this.pets[0]=null,this.pets[1]=null,this.btn_selpet=new Array(2),this.btn_selpet[0]=new D(gn.xani_nui1),this.btn_selpet[0].bSingleButton=!0,this.btn_selpet[1]=new D(gn.xani_nui1),this.btn_selpet[1].bSingleButton=!0,this.chk_uselock=new Array(2),this.chk_uselock[0]=new T(gn.xani_nui3),this.chk_uselock[0].InitBox("统一勾选"),this.chk_uselock[0].bTrue=!1,this.chk_uselock[0].sDetail="使用定形符",this.chk_uselock[1]=new T(gn.xani_nui3),this.chk_uselock[1].InitBox("统一勾选"),this.chk_uselock[1].bTrue=!1,this.chk_uselock[1].sDetail="使用定形符",this.iW=920,this.iH=630,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_fuse=new Eh(gn.xani_nui2),this.btn_fuse.InitButton("按钮4"),this.btn_fuse.Move(this.iX+(this.iW-141)/2,this.iY+this.iH-30-49,141,49),this.btn_fuse.sName="炼妖"}Draw(){var i,t;E.new_baseframe2(this.iX,this.iY,this.iW,this.iH,"炼","妖"),i=this.iX+30,t=this.iY+30,this.DrawSide(i,t,0),this.DrawSide(i+420+20,t,1),Vi.bSelect&&(Vi.bSelect=!1,this.pets[Vi.iFlag]=Vi.selpet),this.btn_close.Draw()}DrawSide(i,t,s){var e,h,a;for(E.new_framein(i,t,420,510),gn.xani_nui2.DrawAnima(i+20,t+15,"宠物头像框",0),null!=this.pets[s]&&gn.xani_head.DrawAnima_aa(i+20,t+15,gn.de_pet.strValue(this.pets[s].iTid,0,1),0),this.btn_selpet[s].Move(i+20,t+15,83,83),null==this.pets[s]?c.gi().DrawTextEx(i+20+83+20,t+15,"宠物：",4278206039,22,101,1,1,0,0,0):c.gi().DrawTextEx(i+20+83+20,t+15,"宠物："+this.pets[s].sName+(0==(2&this.pets[s].iBaobao)?"":"(变异)"),4278206039,22,101,1,1,0,0,0),c.gi().DrawTextEx(i+20+83+20,t+15+30,"等级："+(null==this.pets[s]?"":this.pets[s].iLev),4278206039,22,101,1,1,0,0,0),this.chk_uselock[s].Move(i+20+83+20,t+15+30+30,50,50),this.chk_uselock[s].Draw(),c.gi().DrawTextEx(i+20,t+15+83+30,"体质资质："+(null==this.pets[s]?"":this.pets[s].zz[0]),4278206039,22,101,1,1,0,0,0),c.gi().DrawTextEx(i+20,t+15+83+30+30,"法力资质："+(null==this.pets[s]?"":this.pets[s].zz[1]),4278206039,22,101,1,1,0,0,0),c.gi().DrawTextEx(i+20,t+15+83+30+60,"力量资质："+(null==this.pets[s]?"":this.pets[s].zz[2]),4278206039,22,101,1,1,0,0,0),c.gi().DrawTextEx(i+20+180,t+15+83+30,"耐力资质："+(null==this.pets[s]?"":this.pets[s].zz[3]),4278206039,22,101,1,1,0,0,0),c.gi().DrawTextEx(i+20+180,t+15+83+30+30,"敏捷资质："+(null==this.pets[s]?"":this.pets[s].zz[4]),4278206039,22,101,1,1,0,0,0),c.gi().DrawTextEx(i+20+180,t+15+83+30+60,"成长："+(null==this.pets[s]?"":Bi.swapcz(this.pets[s].cz)),4278206039,22,101,1,1,0,0,0),e=0;e<12;e++)h=i+20+e%4*99,a=t+215+97*parseInt(e/4),gn.xani_nui2.DrawAnima(h,a,"技能框",0),e>=(null==this.pets[s]?8:this.pets[s].iSkillBlock)&&gn.xani_nui2.DrawAnima(h,a,"技能框",1),null!=this.pets[s]&&this.pets[s].jn[e]>0&&gn.xani_nicon.DrawAnima_aa(h,a,gn.de_skill.strValue(this.pets[s].jn[e],0,5),0);this.btn_fuse.Draw(),ei.end(ei.CONFIRM_FUSEPET)&&ei.bConfirm&&null!=this.pets[0]&&null!=this.pets[1]&&(e=this.chk_uselock[0].bTrue?0:this.chk_uselock[1].bTrue?1:2,Mh.gi().s_SeverEvent(26,0,this.pets[0].iPid,this.pets[1].iPid,e),ln.gi().PopStat(1))}ProcTouch(i,t,s){return this.btn_selpet[0].ProcTouch(i,t,s)&&this.btn_selpet[0].bCheck()&&(null==this.pets[0]?Vi.Open(this.pets[1],0):this.pets[0]=null),this.btn_selpet[1].ProcTouch(i,t,s)&&this.btn_selpet[1].bCheck()&&(null==this.pets[1]?Vi.Open(this.pets[0],1):this.pets[1]=null),this.chk_uselock[0].ProcTouch(i,t,s)&&this.chk_uselock[0].bTrue&&(this.chk_uselock[1].bTrue=!1),this.chk_uselock[1].ProcTouch(i,t,s)&&this.chk_uselock[1].bTrue&&(this.chk_uselock[0].bTrue=!1),this.btn_close.ProcTouch(i,t,s)&&this.btn_close.bCheck()&&ln.gi().PopStat(1),this.btn_fuse.ProcTouch(i,t,s)&&this.btn_fuse.bCheck()&&(null==this.pets[0]||null==this.pets[1]?Z.fm.Open("请选择参与炼妖的宠物"):this.pets[0].iLev<20||this.pets[1].iLev<20?Z.fm.Open("20级以上的宠物才能参与炼妖"):this.pets[0]==this.pets[1]?Z.fm.Open("不能选择同一个宠物"):0!=(2&this.pets[0].iBaobao)||0!=(2&this.pets[1].iBaobao)?Z.fm.Open("变异宠物无法炼妖"):this.chk_uselock[0].bTrue||this.chk_uselock[1].bTrue?ht.bHaveGoods(315,1)?ei.start(ei.CONFIRM_FUSEPET,"本次炼妖将消耗一枚定形符，生成形象为所选形象"):Z.fm.Open("背包中没有可消耗的定形符"):ei.start(ei.CONFIRM_FUSEPET,"本次炼妖没有使用定形符，炼妖形象将随机生成")),!1}}Ui.Open=function(){ln.gi().PushStat(ln.GS_FUSEPET)};class zi{constructor(){}}class ji{constructor(){var i;for(this.grow=new Array(6),i=0;i<6;i++)this.grow[i]=new zi;ji.ml=this}Init(i){var t;for(ji.iMaxArable=i.GetNextByte(),gn.sop("MyLand.iMaxArable"+ji.iMaxArable),t=0;t<ji.iMaxArable;t++)ji.iArableOff[t][0]=i.GetNextInt(),ji.iArableOff[t][1]=i.GetNextInt(),gn.sop(""+ji.iArableOff[t][0]);ji.iArableGrow=i.GetNextInt(),ji.bShowBlock=!1}}ji.bShowBlock=!1,ji.iMaxArable=6,ji.iArableOff=new Array(12);for(var Ji=0;Ji<12;Ji++)ji.iArableOff[Ji]=new Int32Array(2);ji.iArableGrow=0,ji.sLandName=["雪域高原","碧湖翠陵","神秘楼兰","琼玉天宫","迷幻鬼蜮"],ji.ml;class Qi{constructor(){Qi.iTmpGoodsCount=0}}Qi.iTmpGoodsCount=0,Qi.iDelay=0,Qi.tgs=new Qi,Qi.getgoods=function(i){Qi.iTmpGoodsCount=i.GetNextByte()},Qi.Draw=function(){var i,t;Qi.iTmpGoodsCount<=0||(i=h.SCRW/2,t=2*h.SCRH/3,parseInt(Qi.iDelay/3)%2==0&&(i+=2,t+=2),gn.xani_ui.DrawAnima(i,t,"物品格",0),c.gi().DrawTextEx(i+30,t+30-15,"临时",4278190080,20,101,1,1,0,-2,-2),c.gi().DrawTextEx(i+30,t+30+15,"("+Qi.iTmpGoodsCount+")",4278190080,20,101,1,1,0,-2,-2),Qi.iDelay++)},Qi.ProcTouch=function(i,t,s){var e,a;return e=h.SCRW/2,a=2*h.SCRH/3,!(Qi.iTmpGoodsCount<=0)&&(!!bn.bInRect(t,s,e,a,60,60)&&(3==i&&(Qi.iTmpGoodsCount=0,Mh.gi().s_SeverEvent(4,0,0,0,0)),!0))};class qi{}qi.bLocked=!1,qi.GOODSEACHLINE=5,qi.lockgoods,qi.iTouchDelay,qi.iLockX,qi.iLockY,qi.iOffX,qi.iOffY,qi.iMoveX,qi.iMoveY,qi.bDrawing,qi.bMoving,qi.lastlock=null,qi.swaplock=null,qi.bUse=!1,qi.bSwap=!1,qi.aa_block=null,qi.Reset=function(){qi.bLocked=!1,qi.lockgoods=null,qi.iTouchDelay=0,qi.bDrawing=!1,qi.bMoving=!1,qi.lastlock=null,qi.swaplock=null,qi.bUse=!1,qi.bSwap=!1},qi.new_DrawOneGoods_ext=function(i,t,s,e){s.aa.Draw(i,t),gn.de_goods.intValue(s.iTid,0,28)>1&&c.gi().DrawTextEx(i+5,t+5,""+e,4294967295,30,101,1,1,0,0,0)},qi.new_DrawOneGoods=function(i,t,s,e,h){var a,n;if(qi.bMoving&&qi.lockgoods==s&&(i=qi.iMoveX-qi.iOffX,t=qi.iMoveY-qi.iOffY),gn.de_goods.intValue(s.iTid,0,28)>1){if(n=s.iCount,null!=e)for(a=0;a<e.length;a++)s==e[a]&&h[a]>0&&(n-=h[a]);if(n<=0)return;s.aa.Draw(i,t),c.gi().DrawTextEx(i+5,t+5,""+n,4294967295,24,101,1,1,0,0,0)}else{if(null!=e)for(a=0;a<e.length;a++)if(s==e[a]&&h[a]>0)return;s.aa.Draw(i,t)}},qi.new_block=null,qi.FRAMEW=430,qi.FRAMEH=345,qi.new_DrawGoods=function(i,t,s,e,h){var a,n,o,r;null==qi.new_block&&(qi.new_block=gn.xani_nui3.InitAnimaWithName("物品格子",null));var c=0,l=0;E.new_frameon(i,t,430,345,0),i+=5,t+=5;var b=null;for(a=0;a<qi.GOODSEACHLINE;a++)for(n=0;n<4;n++)o=i+85*a,r=t+85*n,qi.new_block.Draw(o,r),qi.bMoving&&qi.lockgoods==s[n*qi.GOODSEACHLINE+a]&&(c=qi.iMoveX-qi.iOffX,l=qi.iMoveY-qi.iOffY,b=qi.lockgoods),-1!=s[n*qi.GOODSEACHLINE+a].iGid&&qi.new_DrawOneGoods(o,r,s[n*qi.GOODSEACHLINE+a],e,h);null!=b&&qi.new_DrawOneGoods(c,l,b,e,h)},qi.new_LockPos=function(i,t,s,e){var h,a;for(i+=5,t+=5,h=0;h<qi.GOODSEACHLINE;h++)for(a=0;a<4;a++)s[a*qi.GOODSEACHLINE+h]==e&&(qi.iLockX=i+85*h,qi.iLockY=t+85*a,qi.lastlock=e,qi.lockgoods=e)},qi.new_LockGoods=function(i,t,s,e,h,a){var n,o,r,c;if(s+=5,e+=5,3==a&&qi.bLocked){if(qi.bMoving)for(qi.bMoving=!1,n=0;n<qi.GOODSEACHLINE;n++)for(o=0;o<4;o++)if(r=s+85*n,c=e+85*o,bn.bInRect(i,t,r,c,80,80)&&h[o*qi.GOODSEACHLINE+n]!=qi.lockgoods)return qi.bSwap=!0,qi.swaplock=h[o*qi.GOODSEACHLINE+n],qi.lastlock=null,qi.lockgoods;qi.lastlock==qi.lockgoods?(qi.bUse=!0,qi.lastlock=null,qi.lockgoods=null,qi.bLocked=!1):(qi.lastlock=qi.lockgoods,qi.bUse=!1)}if(1==a&&(qi.bLocked=!1,qi.bMoving=!1),1==a&&(qi.bDrawing=!1),2==a&&qi.bLocked)return qi.iMoveX=i,qi.iMoveY=t,qi.bMoving=!0,qi.lockgoods;for(n=0;n<qi.GOODSEACHLINE;n++)for(o=0;o<4;o++)if(r=s+85*n,c=e+85*o,bn.bInRect(i,t,r,c,80,80))return h[o*qi.GOODSEACHLINE+n].iGid<=0?(qi.lastlock=null,null):(1==a&&(qi.bLocked=!0,qi.lockgoods=h[o*qi.GOODSEACHLINE+n],qi.iLockX=r,qi.iLockY=c,qi.iOffX=i-r,qi.iOffY=t-c,qi.iTouchDelay=0),h[o*qi.GOODSEACHLINE+n]);return qi.lastlock=null,null},qi.new_DrawRect=function(i,t,s,e,h){var a,n,o,r;if(null!=e)for(i+=5,t+=5,a=0;a<qi.GOODSEACHLINE;a++)for(n=0;n<4;n++)o=i+85*a,r=t+85*n,-1!=s[n*qi.GOODSEACHLINE+a].iGid&&s[n*qi.GOODSEACHLINE+a]==e&&(0==h?gn.xani_nui3.DrawAnimaEx(o,r,"物品选中框",0,101,1,1,0,0,0):gn.xani_nui3.DrawAnimaEx(o,r,"物品选中框",1,101,1,1,0,0,0))},qi.NoMove=function(){qi.bMoving=!1},qi.Lock_Goods=function(i,t,s,e,h,a){var n,o,r,c;if(3==a&&qi.bLocked){if(qi.bMoving)for(qi.bMoving=!1,n=0;n<qi.GOODSEACHLINE;n++)for(o=0;o<4;o++)if(r=s+64*n,c=e+64*o,bn.bInRect(i,t,r,c,60,60)&&h[o*qi.GOODSEACHLINE+n]!=qi.lockgoods)return qi.bSwap=!0,qi.swaplock=h[o*qi.GOODSEACHLINE+n],qi.lastlock=null,qi.lockgoods;qi.lastlock==qi.lockgoods?(qi.bUse=!0,qi.lastlock=null,qi.lockgoods=null,qi.bLocked=!1):(qi.lastlock=qi.lockgoods,qi.bUse=!1)}if(1==a&&(qi.bLocked=!1,qi.bMoving=!1),1==a&&(qi.bDrawing=!1),2==a&&qi.bLocked)return qi.iMoveX=i,qi.iMoveY=t,qi.bMoving=!0,qi.lockgoods;for(n=0;n<qi.GOODSEACHLINE;n++)for(o=0;o<4;o++)if(r=s+64*n,c=e+64*o,bn.bInRect(i,t,r,c,60,60))return h[o*qi.GOODSEACHLINE+n].iGid<=0?(qi.lastlock=null,null):(1==a&&(qi.bLocked=!0,qi.lockgoods=h[o*qi.GOODSEACHLINE+n],qi.iLockX=r,qi.iLockY=c,qi.iOffX=i-r,qi.iOffY=t-c,qi.iTouchDelay=0),h[o*qi.GOODSEACHLINE+n]);return qi.lastlock=null,null},qi.bCanMove=function(){return!!qi.bSwap&&(qi.bSwap=!1,!0)},qi.bCanProc=function(){return!!qi.bUse&&(qi.bUse=!1,!0)},qi.bShowDetail=function(){return null!=qi.lastlock&&(qi.iTouchDelay++,!0)},qi.new_DrawDetailEx1=function(i,t,s,e){qi.iDetailW=320,Y.gi().FormatEx(e,qi.iDetailW-30,24,0,0,28),qi.iDetailH=110+Y.gi().iH+20,t<qi.iDetailW+20?t+=80:t-=qi.iDetailW,(s=s+40-qi.iDetailH/2)<0&&(s=0),s+qi.iDetailH>h.SCRH&&(s=h.SCRH-qi.iDetailH),qi.iDetailX=t,qi.iDetailY=s,E.new_framewatch(t,s,qi.iDetailW,qi.iDetailH),null==qi.new_block&&(qi.new_block=gn.xani_nui3.InitAnimaWithName("物品格子",null)),qi.new_block.Draw(t+20,s+20),gn.xani_ngoods.DrawAnima_aa(t+20,s+20,gn.de_goods.strValue(i,0,10),0),c.gi().DrawTextEx(t+20+80+10,s+20,gn.de_goods.strValue(i,0,4),4294967040,30,101,1,1,0,0,0),Y.gi().Draw(t+20,s+20+80+10)},qi.detail_add="",qi.new_DrawDetail=function(i,t,s,a){null==i&&(i=qi.lockgoods),-1==t&&(t=qi.iLockX),-1==s&&(s=qi.iLockY);var n,o,r,l,b,_,f="",u="",d="";if(n=gn.de_goods.strValue(i.iTid,-1,4),-1!=(_=gn.de_goods.intValue(i.iTid,-1,16))){var p,m;d="基本属性",u="等级："+gn.de_goods.strValue(i.iTid,-1,9);var g=[8,12,40,8,6],w=[0,0,0,0,0];switch(p=parseInt(i.iAtts[0]/1e4),m=i.iAtts[0]%1e4,(o=parseInt(i.iAtts[2]/1e4))>0&&(w[parseInt(o/1e3)]=g[parseInt(o/1e3)]*(o%1e3)),(o=i.iAtts[2]%1e4)>0&&(w[parseInt(o/1e3)]=g[parseInt(o/1e3)]*(o%1e3)),_){case 0:f="类型：头盔",d+="#e# #cffff00防御 +"+(gn.de_goods.intValue(i.iTid,-1,21)+p+w[1]),d+="#e# #cffff00魔法 +"+(gn.de_goods.intValue(i.iTid,-1,22)+m),w[1]=0;break;case 1:f="类型：饰品",d+="#e# #cffff00灵力 +"+(gn.de_goods.intValue(i.iTid,-1,23)+m+w[4]),w[4]=0;break;case 2:f=0==(r=gn.de_goods.intValue(i.iTid,-1,19))?"类型：武器(剑)":1==r?"类型：武器(刀)":"类型：武器(枪)",d+="#e# #cffff00伤害 +"+(gn.de_goods.intValue(i.iTid,-1,3)+m+w[0]),w[0]=0;break;case 3:f=0==(r=gn.de_goods.intValue(i.iTid,-1,20))?"类型：女衣":"类型：铠甲",d+="#e# #cffff00防御 +"+(gn.de_goods.intValue(i.iTid,-1,21)+m+w[1]),w[1]=0;break;case 4:f="类型：腰带",d+="#e# #cffff00防御 +"+(gn.de_goods.intValue(i.iTid,-1,21)+p+w[1]),d+="#e# #cffff00气血 +"+(gn.de_goods.intValue(i.iTid,-1,24)+m+w[2]),w[1]=0,w[2]=0;break;case 5:f="类型：鞋子",d+="#e# #cffff00防御 +"+(gn.de_goods.intValue(i.iTid,-1,21)+p+w[1]),d+="#e# #cffff00速度 +"+(gn.de_goods.intValue(i.iTid,-1,25)+m+w[3]),w[1]=0,w[3]=0}w[0]>0&&(d+="#e# 伤害 +"+w[0]),w[1]>0&&(d+="#e# 防御 +"+w[1]),w[2]>0&&(d+="#e# 气血 +"+w[2]),w[3]>0&&(d+="#e# 速度 +"+w[3]),w[4]>0&&(d+="#e# 灵力 +"+w[4]),p=parseInt(i.iAtts[1]/1e4),m=i.iAtts[1]%1e4,p>0&&(0==parseInt(p/1e3)?d+="#e# #c00ff00体质 +"+p%1e3:1==parseInt(p/1e3)?d+="#e# #c00ff00法力 +"+p%1e3:2==parseInt(p/1e3)?d+="#e# #c00ff00力量 +"+p%1e3:3==parseInt(p/1e3)?d+="#e# #c00ff00耐力 +"+p%1e3:4==parseInt(p/1e3)&&(d+="#e# #c00ff00敏捷 +"+p%1e3)),m>0&&(d+=p<=0?"#e# #c00ff00":" ",0==parseInt(m/1e3)?d+="体质 +"+m%1e3:1==parseInt(m/1e3)?d+="法力 +"+m%1e3:2==parseInt(m/1e3)?d+="力量 +"+m%1e3:3==parseInt(m/1e3)?d+="耐力 +"+m%1e3:4==parseInt(m/1e3)&&(d+="敏捷 +"+m%1e3)),i.iAtts[4]>0&&((o=i.iAtts[4]>>20&1023)>0&&(d+="#e# #cff8020"+gn.de_skill.strValue(o,0,6)),(o=i.iAtts[4]>>10&1023)>0&&(d+="#e# #c80c0ff特效 : "+gn.de_skill.strValue(o,0,6)),(o=1023&i.iAtts[4])>0&&(d+="#e# #c80c0ff特技 : "+gn.de_skill.strValue(o,0,6))),d+="#e# #cffffff耐久度"+parseInt((i.iAtts[5]%1e5+19)/20)+"/"+parseInt(i.iAtts[5]/1e5),l=parseInt(i.iAtts[2]/1e4),b=i.iAtts[2]%1e4,(l>0||b>0)&&(d+="#e#cb48cc8镶嵌等级 "+(l%1e3+b%1e3),d+="#e# 已镶嵌 ",l>0&&(d+=gn.de_goods.strValue(parseInt(l/1e3)+101,0,4)),b>0&&(d+=","+gn.de_goods.strValue(parseInt(b/1e3)+101,0,4))),i.CalcSetScore(),i.iScore>0&&(d+="#e# #cffffff评分："+i.iScore),(o=parseInt(i.iAtts[3]/1e4))>0&&(n+=" +"+o)}if((_=gn.de_goods.intValue(i.iTid,-1,31))>0&&(f="类型：材料",1==_&&(u="等级：一级"),2==_&&(u+="等级：二级"),3==_&&(u+="等级：三级")),-1!=(_=gn.de_goods.intValue(i.iTid,-1,27))){f="类型："+e.sBigNum[_]+"级草药";var x=gn.de_goods.intValue(i.iTid,-1,1),S=gn.de_goods.intValue(i.iTid,-1,2);if(-1!=x&&(d+="#e# #c00ff00恢复气血"+x),-1!=S&&(d+="#e# #c00ff00恢复魔法"+S),3==_)switch(i.iTid){case 85:d+="#e# #c00ff00随机增加5~20点临时愤怒(进入战斗时恢复)",d+="#e# #cb48cc8效果持续24小时";break;case 86:d+="#e# #c00ff00随机增加5~20点敏捷",d+="#e# #cb48cc8效果持续24小时";break;case 87:d+="#e# #c00ff00随机增加5%~10%治疗能力",d+="#e# #cb48cc8效果持续24小时";break;case 88:d+="#e# #c00ff00随机增加5~20点力量",d+="#e# #cb48cc8效果持续24小时";break;case 89:d+="#e# #c00ff00随机增加5~20点耐力",d+="#e# #cb48cc8效果持续24小时";break;case 90:d+="#e# #c00ff00随机增加5%~20%固定伤害",d+="#e# #cb48cc8效果持续24小时";break;case 91:d+="#e# #c00ff00随机增加5%~10%物理和法术命中",d+="#e# #cb48cc8效果持续24小时";break;case 92:d+="#e# #c00ff00随机增加5~20点魔力",d+="#e# #cb48cc8效果持续24小时";break;case 93:d+="#e# #c00ff00随机增加5~20点体质",d+="#e# #cb48cc8效果持续24小时";break;case 94:d+="#e# #c00ff00随机增加1%~5%物理和法术暴击",d+="#e# #cb48cc8效果持续24小时"}d.length>0&&(d="#cffff00功效："+d)}if(-1!=(_=gn.de_goods.intValue(i.iTid,-1,33)))switch(1==_&&(f="一级丹药",u="品质："+i.iAtts[0]),2==_&&(f="二级丹药"),3==_&&(f="三级丹药",u=i.iAtts[0]<40?"品质：低":i.iAtts[0]<80?"品质：中":"品质：高"),4==_&&(f="四级丹药"),302!=i.iTid&&303!=i.iTid&&304!=i.iTid&&305!=i.iTid&&306!=i.iTid&&307!=i.iTid&&308!=i.iTid&&309!=i.iTid&&310!=i.iTid&&311!=i.iTid||(d+="#e#cff0000只能在擂台使用"),i.iTid){case 185:i.iAtts[0]<40?d+="#e# #c00ff00临时提高人物修炼一级":i.iAtts[0]<80?d+="#e# #c00ff00临时提高人物修炼二级":d+="#e# #c00ff00临时提高人物修炼三级",d+="#e# #cb48cc8效果持续24小时";break;case 187:i.iAtts[0]<40?d+="#e# #c00ff00临时提高伤害结果20点":i.iAtts[0]<80?d+="#e# #c00ff00临时提高伤害结果40点":d+="#e# #c00ff00临时提高伤害结果60点",d+="#e# #cb48cc8效果持续24小时";break;case 188:i.iAtts[0]<40?d+="#e# #c00ff00临时提高宠物全属性8点":i.iAtts[0]<80?d+="#e# #c00ff00临时提高宠物全属性13点":d+="#e# #c00ff00临时提高宠物全属性18点",d+="#e# #cb48cc8效果持续24小时";break;case 165:case 302:d+="#e#cffffff恢复气血"+(6*i.iAtts[0]+300),d+="#e#cffffff恢复魔法"+(2*i.iAtts[0]+100);break;case 166:case 303:d+="#e#cffffff恢复气血"+(9*i.iAtts[0]+450);break;case 167:case 311:d+="#e#cffffff恢复气血"+(12*i.iAtts[0]+600);break;case 168:case 310:d+="#e#cffffff恢复魔法"+(3*i.iAtts[0]+150);break;case 169:case 309:d+="#e#cffffff恢复魔法"+(5*i.iAtts[0]+200);break;case 170:case 308:d+="#e#cffffff恢复气血"+(9*i.iAtts[0]+450),d+="#e#cffffff恢复魔法"+(3*i.iAtts[0]+150);break;case 171:case 307:d+="#e#cffffff解封并恢复气血"+(2*i.iAtts[0]+100);break;case 172:case 306:d+="#e#cffffff解封并恢复气血"+(6*i.iAtts[0]+300);break;case 173:case 305:d+="#e#cffffff复活并恢复气血"+(2*i.iAtts[0]+100);break;case 174:case 304:d+="#e#cffffff复活并恢复气血"+(6*i.iAtts[0]+300);break;case 175:d+="#e#cffffff增加坐骑力量资质";break;case 176:d+="#e#cffffff增加坐骑敏捷资质";break;case 177:d+="#e#cffffff增加坐骑法力资质";break;case 178:d+="#e#cffffff增加坐骑耐力资质";break;case 179:d+="#e#cffffff增加坐骑体质资质";break;case 180:d+="#e#cffffff增加200点宠物寿命";break;case 181:d+="#e#cffffff恢复坐骑灵气";break;case 182:d+="#e#cffffff增加坐骑成长";break;case 183:d+="#e#cffffff使用后立即恢复50点体力，3小时内恢复体力速度翻倍";break;case 184:d+="#e#cffffff使用后立即恢复人物等级*4+50体力值";break;case 191:d+="#e#c00ff00重置人物属性点"}if(-1!=(_=gn.de_goods.intValue(i.iTid,-1,34)))switch(f="类型：烹饪",u="品质："+i.iAtts[0],i.iTid){case 197:d+="#e#c00ff00增加宠物寿命=品质*2，有几率被噎住降低资质";break;case 198:d+="#e#c00ff00使用后增加愤怒=15，只能在漫游中使用";break;case 199:d+="#e#c00ff00恢复自身愤怒=品质*1.2，减少自身防御=品质*1，只能在战斗中使用";break;case 200:d+="#e#c00ff00增加宠物寿命=品质/2";break;case 201:d+="#e#c00ff00增加宠物寿命=品质*2，有几率被噎住降低资质";break;case 202:d+="#e#c00ff00使用后增加愤怒=15，只能在战斗中使用";break;case 203:d+="#e#c00ff00使用后增加愤怒=品质*0.5，只能在战斗中使用";break;case 204:d+="#e#c00ff00使用后增加愤怒=品质*0.8，附加中毒状态，只能在战斗中使用";break;case 205:d+="#e#c00ff00使用后增加愤怒=品质*1，附加疯狂状态3~4回合，只能在战斗中使用";break;case 206:d+="#e#c00ff00使用后增加愤怒=品质/2，只能在漫游中使用"}if(-1!=(_=gn.de_goods.intValue(i.iTid,-1,30)))switch(f="类型：道具",i.iTid){case 116:d+="#e#c00ff00+1万血池上限";break;case 117:d+="#e#c00ff00+1万蓝池上限";break;case 377:d+="#e#c00ff00+10万血池上限";break;case 378:d+="#e#c00ff00+10万蓝池上限";break;case 240:d+="#e#c00ff00含有"+i.iAtts[0]+"绑铜";break;case 96:case 230:d+="#e#c00ff00"+gn.de_map.strValue(i.iAtts[0],0,1)+"("+parseInt(i.iAtts[1]/16)+","+parseInt(i.iAtts[2]/16)+")";break;case 97:for(d+="#e#cffff00等级 "+gn.de_goods.intValue(i.iAtts[0],-1,9),0==(o=gn.de_goods.intValue(i.iAtts[0],-1,16))?d+="#e种类 头盔":1==o?d+="#e种类 项链":2==o?0==(o=gn.de_goods.intValue(i.iAtts[0],-1,19))?d+="#e种类 剑":1==o?d+="#e种类 刀":2==o&&(d+="#e种类 枪"):3==o?0==(o=gn.de_goods.intValue(i.iAtts[0],-1,20))?d+="#e种类 女衣":1==o&&(d+="#e种类 男衣"):4==o?d+="#e种类 腰带":5==o&&(d+="#e种类 靴子"),o=1;o<6&&0!=i.iAtts[o];o++)d+="#e材料"+o+" "+gn.de_goods.strValue(i.iAtts[o],-1,4);break;case 98:case 99:case 100:98==i.iTid?d+="#e#c00ff00制造 头盔，腰带":99==i.iTid?d+="#e#c00ff00制造 武器，项链":100==i.iTid&&(d+="#e#c00ff00制造 衣服，靴子"),d+="#e等级 "+i.iAtts[0],d+="#e熟练度 "+i.iAtts[1];break;case 101:case 102:case 103:case 104:case 105:101==i.iTid?d+="#e#cb48cc8镶嵌部位 头盔,武器#e#c00ff00伤害 +8":102==i.iTid?d+="#e#cb48cc8镶嵌部位 头盔,衣服#e#c00ff00防御 +12":103==i.iTid?d+="#e#cb48cc8镶嵌部位 衣服,腰带#e#c00ff00气血 +40":104==i.iTid?d+="#e#cb48cc8镶嵌部位 腰带,鞋子#e#c00ff00速度 +8":105==i.iTid&&(d+="#e#cb48cc8镶嵌部位 项链,鞋子#e#c00ff00灵力 +6"),d+="#e#cffff00"+i.iAtts[0]+"级";break;case 119:0==i.iAtts[0]?d+="#e#c00ff00未定目的地":(d+="#e#c00ff00剩余使用次数 "+i.iAtts[1],d+="#e#c00ff00"+gn.de_map.strValue(i.iAtts[2],0,1)+"("+Math.floor(i.iAtts[3]/16)+","+Math.floor(i.iAtts[4]/16)+")");break;case 154:case 155:case 156:d+="#e#c00ff00"+gn.de_skill.strValue(i.iAtts[0],0,5),d+="#e#cffffff"+gn.de_skill.strValue(i.iAtts[0],0,3);break;case 162:d+="#e#c00ff00等级到达"+i.iAtts[0]+"级可开启";break;case 195:case 328:case 329:case 330:case 331:if(u="等级："+e.sBigNum[i.iAtts[0]]+"级",i.iAtts[2]>0)for(d+="#e#c00ff00"+gn.de_goods.strValue(i.iAtts[1],0,4),d+="#e#cb48cc8剩余使用次数:"+i.iAtts[2],o=3;o<7&&!(i.iAtts[o]<=0);o++)d+="#e#cffff00配料"+(o-2)+":"+gn.de_goods.strValue(i.iAtts[o],0,4);break;case 342:case 343:case 344:case 345:case 346:u="等级："+e.sBigNum[i.iTid-341]+"级",i.iAtts[1]>0&&(d+="#e#cb48cc8剩余使用次数："+i.iAtts[1],0==i.iAtts[2]?d+="#e#c00ff00品质：随机":d+="#e#c00ff00品质："+i.iAtts[2],d+="#e#c00ff00增加炼药成功率："+i.iAtts[3]+"%");break;case 196:d+="#e#c00ff00"+e.sZhenName[i.iAtts[0]];break;case 226:case 227:0==i.iAtts[0]?d+="#e#c00ff00属性：木":1==i.iAtts[0]?d+="#e#c00ff00属性：火":2==i.iAtts[0]?d+="#e#c00ff00属性：金":3==i.iAtts[0]?d+="#e#c00ff00属性：土":4==i.iAtts[0]&&(d+="#e#c00ff00属性：水");break;case 231:case 232:case 233:case 234:case 235:if(d+="#e#c00ff00卡片类型："+gn.de_pet.strValue(i.iAtts[0],0,1),231==i.iTid?d+="#e#c00ff00技能要求：一级变身术":232==i.iTid?d+="#e#c00ff00技能要求：二级变身术":233==i.iTid?d+="#e#c00ff00技能要求：三级变身术":234==i.iTid?d+="#e#c00ff00技能要求：四级变身术":235==i.iTid&&(d+="#e#c00ff00技能要求：五级变身术"),i.iAtts[1]>0&&(d+="#e#c00ff00附加技能："+gn.de_skill.strValue(i.iAtts[1],0,6)),i.iAtts[3]>0)switch(o=i.iAtts[3]%1e3-100,i.iAtts[3]/1e3%10){case 0:d+="#e#c00ff00属性影响："+(o>0?"+"+o:o)+"%气血";break;case 1:d+="#e#c00ff00属性影响："+(o>0?"+"+o:o)+"%灵力";break;case 2:d+="#e#c00ff00属性影响："+(o>0?"+"+o:o)+"%伤害";break;case 3:d+="#e#c00ff00属性影响："+(o>0?"+"+o:o)+"%防御";break;case 4:d+="#e#c00ff00属性影响："+(o>0?"+"+o:o)+"%速度"}d+="#e#cb48cc8剩余使用次数："+i.iAtts[2];break;case 255:case 256:case 257:case 258:case 259:d+="#e#c00ff00种类:"+gn.de_grow.strValue(i.iAtts[0],0,1),d+="#e#c00ff00等级:"+gn.de_grow.strValue(i.iAtts[0],0,2),d+="#e#c00ff00品质:"+i.iAtts[1],d+="#e#c00ff00五行:"+e.sWuXing[i.iAtts[2]];break;case 261:0==i.iAtts[0]?d+="#e#c00ff00空白地契，可将土地登记其中，便于交易":(d+="#e#c00ff00风格:"+ji.sLandName[i.iAtts[1]/100],d+="#e#c00ff00风水:"+i.iAtts[2],d+="#e#c00ff00金灵气"+i.iAtts[3]/1e3+"#e木灵气"+i.iAtts[3]%1e3+"#e水灵气"+i.iAtts[4]/1e3+"#e火灵气"+i.iAtts[4]%1e3+"#e土灵气"+i.iAtts[5]/1e3);break;case 265:d+="#e#c00ff00可提高一，二级植物的品质";break;case 266:case 267:case 268:case 269:case 270:o=i.iTid-266,d+="#e#c00ff00可提高"+e._sWXS[o]+"灵石的灵气",d+="#e#c00ff00可降低"+e._sWXK[o]+"灵石的灵气";break;case 271:case 272:case 273:case 274:case 275:d+="#e#c00ff00"+e.sWeek[i.iTid-270]+"级果实",d+="#e#c00ff00种类:"+gn.de_grow.strValue(i.iAtts[0],0,1),d+="#e#c00ff00品质:"+i.iAtts[1];break;case 276:case 277:d+="#e#c00ff00品质:"+i.iAtts[0];break;case 397:d+="#e#c00ff00打开后获得一个宠物经验丹，赠送2个二级材料";break;case 398:d+="#e#c00ff00打开后获得一个低级人物经验丹，赠送2个七国旗"}var D=gn.de_goods.strValue(i.iTid,-1,29);if("-1"!=D&&(d+="#e#c99d9ea"+D),0!=(1&i.iAtts[7])&&(d+="#e#ca0a0a0系统绑定"),d+=qi.detail_add,qi.iDetailW=320,d.length>2)do{if("#e"!=d.substring(0,2))break;d=d.substring(2,d.length)}while(d.length>2);Y.gi().FormatEx(d,qi.iDetailW-30,24,0,0,28),qi.iDetailH=110+Y.gi().iH+20+a,t<qi.iDetailW+20?t+=80:t-=qi.iDetailW,(s=s+40-qi.iDetailH/2)<0&&(s=0),s+qi.iDetailH>h.SCRH&&(s=h.SCRH-qi.iDetailH),qi.iDetailX=t,qi.iDetailY=s,E.new_framewatch(t,s,qi.iDetailW,qi.iDetailH),null==qi.new_block&&(qi.new_block=gn.xani_nui3.InitAnimaWithName("物品格子",null)),qi.new_block.Draw(t+20,s+20),i.aa.Draw(t+20,s+20),c.gi().DrawTextEx(t+20+80+10,s+20,n,4294967040,30,101,1,1,0,0,0),c.gi().DrawTextEx(t+20+80+10,s+20+32,f,4294967040,22,101,1,1,0,0,0),c.gi().DrawTextEx(t+20+80+10,s+20+56,u,4294967040,22,101,1,1,0,0,0),Y.gi().Draw(t+20,s+20+80+10)},qi.bUseGoods=function(){return qi.bUse?(qi.bUse=!1,qi.lastlock):qi.lastlock},qi.iDetailX,qi.iDetailY,qi.iDetailW,qi.iDetailH;class Ki extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=490,this.iH=512,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_learn=new Eh(gn.xani_nui2),this.btn_learn.InitButton("按钮1_110"),this.btn_learn.sName="学习",this.btn_learn.Move(this.iX+this.iW-110-30,this.iY+this.iH-52-30,110,52),this.lockgoods=null}Draw(){E.new_bigframe(this.iX,this.iY,this.iW,this.iH),c.gi().DrawTextEx(this.iX+30,this.iY+30,"选择宠物技能书",4278206039,30,101,1,1,0,0,0),qi.new_DrawGoods(this.iX+30,this.iY+30+30+15,ht.gi().goods[2],null,null),null!=this.lockgoods&&(qi.new_DrawRect(this.iX+30,this.iY+30+30+15,ht.gi().goods[2],this.lockgoods,0),154!=this.lockgoods.iTid&&155!=this.lockgoods.iTid&&156!=this.lockgoods.iTid||(c.gi().DrawTextEx(this.iX+20,this.iY+this.iH-30-26,"学习:"+gn.de_skill.strValue(this.lockgoods.iAtts[0],0,6),4278190080,30,101,1,1,0,0,-2),this.btn_learn.Draw())),qi.bShowDetail()&&qi.new_DrawDetail(null,-1,-1,0)}ProcTouch(i,t,s){return null==this.lockgoods||154!=this.lockgoods.iTid&&155!=this.lockgoods.iTid&&156!=this.lockgoods.iTid||!this.btn_learn.ProcTouch(i,t,s)?(this.lockgoods=qi.new_LockGoods(t,s,this.iX+30,this.iY+30+30+15,ht.gi().goods[2],i),qi.NoMove(),3!=i||bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||ln.gi().PopStat(1),!1):(this.btn_learn.bCheck()&&(Mh.gi().s_LearnPetSkill(this.lpet.iPid,this.lockgoods.iGid),ln.gi().PopStat(1)),!0)}}Ki.Open=function(i){ln.gi().PushStat(ln.GS_LEARNPETSKILL),ln.gi().LastStat(0).lpet=i};class Zi extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=200,this.iH=24*MyPets.mp.iPetCount+40+50,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_selectpet=new D(gn.xani_ui),this.btn_selectpet.InitButton("统一中按钮2"),this.btn_selectpet.sName="选择",this.btn_selectpet.Move(this.iX+this.iW-70-20,this.iY+this.iH-40-20,70,40),this.iSelectPoint=-1}Draw(){var i,t,s;for(E.Frame2_MD(this.iX,this.iY,this.iW,this.iH),i=0;i<MyPets.mp.iPetCount;i++)t=this.iX+20,s=this.iY+20+24*i,this.iSelectPoint==i?(this.pm3f.FillRect_2D(t,s,t+(this.iW-40),s+24,4278190335),this.pm3f.DrawTextEx(t,s+12,MyPets.mp.pets[i].sName,4294967295,20,101,1,1,0,0,-2)):this.pm3f.DrawTextEx(t,s+12,MyPets.mp.pets[i].sName,4278190080,20,101,1,1,0,0,-2);this.iSelectPoint>=0&&this.btn_selectpet.Draw()}ProcTouch(i,t,s){var e;for(e=0;e<MyPets.mp.iPetCount;e++)bn.bInRect(t,s,this.iX+20,this.iY+20+24*e,this.iW-40,24)&&(this.iSelectPoint=e);return this.iSelectPoint>=0&&this.btn_selectpet.ProcTouch(i,t,s)?(this.btn_selectpet.bCheck()&&(Mh.gi().s_WashPet(MyPets.mp.pets[this.iSelectPoint].iPid,this.lockgoods.iGid),ln.gi().PopStat(1)),!0):(3!=i||bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||ln.gi().PopStat(1),!1)}}Zi.Open=function(i){ln.gi().PushStat(ln.GS_WASHPET),ln.gi().LastStat(0).lockgoods=i};class $i extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=490,this.iH=512,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_learn=new Eh(gn.xani_nui2),this.btn_learn.InitButton("按钮1_110"),this.btn_learn.sName="食用",this.btn_learn.Move(this.iX+this.iW-110-30,this.iY+this.iH-52-30,110,52),this.lockgoods=null}Draw(){E.new_bigframe(this.iX,this.iY,this.iW,this.iH),c.gi().DrawTextEx(this.iX+30,this.iY+30,"选择仙露，仙桃，丹药或烹饪",4278206039,30,101,1,1,0,0,0),qi.new_DrawGoods(this.iX+30,this.iY+30+30+15,ht.gi().goods[2],null,null),null!=this.lockgoods&&(qi.new_DrawRect(this.iX+30,this.iY+30+30+15,ht.gi().goods[2],this.lockgoods,0),this.btn_learn.Draw()),qi.bShowDetail()&&qi.new_DrawDetail(null,-1,-1,0)}ProcTouch(i,t,s){return null!=this.lockgoods&&this.btn_learn.ProcTouch(i,t,s)?(this.btn_learn.bCheck()&&(Mh.gi().s_LearnPetSkill(this.lpet.iPid,this.lockgoods.iGid),ln.gi().PopStat(1)),!0):(this.lockgoods=qi.new_LockGoods(t,s,this.iX+30,this.iY+30+30+15,ht.gi().goods[2],i),qi.NoMove(),3!=i||bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||ln.gi().PopStat(1),!1)}}$i.Open=function(i){ln.gi().PushStat(ln.GS_PETEAT),ln.gi().LastStat(0).lpet=i};class it{constructor(i){this.func=i,this.pool=[]}clear(){this.pool=[]}size(){return this.pool.length}get(){return this.pool.length?this.pool.shift():new this.func}put(i){i&&this.pool.indexOf(i)<0&&this.pool.push(i)}}class tt{constructor(){this.reset()}reset(){this.callback=void 0,this.target=void 0,this.once=!1}}const st=new class{constructor(){this.pool=new it(tt),this.listeners={}}_on(i,t,s){let e=this.pool.get();e.callback=t,e.target=s,e.once=!1,this._off(e.target,i),this.listeners[i].push(e)}_off(i,t){let s=this.listeners[t];if(s)for(let t=s.length-1;t>=0;t--)if(s[t].target===i){let i=s.splice(t,1)[0];i.reset(),this.pool.put(i)}}_once(i,t,s){let e=this.pool.get();e.callback=t,e.target=s,e.once=!0,this._off(e.target,i),this.listeners[i].push(e)}_emit(i,...t){let s=this.listeners[i].filter(i=>i.callback&&i.target);for(let e of s)e.callback.call(e.target,...t),e.once&&this._off(e.target,i)}addListener(i,t,s){this.listeners[i]||(this.listeners[i]=[]),this._on(String(i),t,s)}removeListener(i,t){if(void 0===t)for(let t in this.listeners)this._off(i,t);else this._off(i,String(t))}eventOnce(i,t,s){this.listeners[i]||(this.listeners[i]=[]),this._once(String(i),t,s)}dispatchEvent(i,...t){i&&this.listeners[i]&&this._emit(String(i),...t)}};class et extends s{constructor(i){var t;for(super(),this.pani=i,this.pm3f=i.pm3f,this.iW=915,this.iH=610,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_skilllist=new Array(12),this.btn_page=new Array(2),t=0;t<2;t++)this.btn_page[t]=new Eh(gn.xani_nui2),this.btn_page[t].Move(this.iX+this.iW-15,this.iY+40+130*t,50,140),this.btn_page[t].InitButton("右侧标签");for(this.btn_petlist=new Array(8),t=0;t<8;t++)this.btn_petlist[t]=new D(gn.xani_ui),this.btn_petlist[t].bSingleButton=!0,this.btn_petlist[t].Move(this.iX+56+t%4*92,this.iY+391+92*parseInt(t/4),83,83),this.btn_petlist[t].iNameSize=25;this.iPetPoint=0,this.aa_pet=null,this.btn_joinfight=new Eh(gn.xani_nui2),this.btn_joinfight.InitButton("按钮1_110"),this.btn_joinfight.sName="参 战",this.btn_joinfight.Move(this.iX+471,this.iY+446,110,52),this.btn_fusepet=new Eh(gn.xani_nui2),this.btn_fusepet.InitButton("按钮1_110"),this.btn_fusepet.sName="炼 妖",this.btn_fusepet.Move(this.iX+603,this.iY+446,110,52),this.btn_follow=new Eh(gn.xani_nui2),this.btn_follow.InitButton("按钮1_110"),this.btn_follow.sName="观 看",this.btn_follow.Move(this.iX+471,this.iY+512,110,52),this.btn_changename=new Eh(gn.xani_nui2),this.btn_changename.InitButton("宠物改名按钮"),this.btn_changename.Move(this.iX+300,this.iY+50,60,60),this.iPage=0,this.btn_drop=new Eh(gn.xani_nui2),this.btn_drop.InitButton("按钮1_110"),this.btn_drop.sName="放 生",this.btn_drop.Move(this.iX+735,this.iY+512,110,52),this.btn_addpoint=new Eh(gn.xani_nui2),this.btn_addpoint.InitButton("按钮1_110"),this.btn_addpoint.sName="加 点",this.btn_addpoint.Move(this.iX+735,this.iY+446,110,52),this.btn_learn=new Eh(gn.xani_nui2),this.btn_learn.InitButton("按钮1_110"),this.btn_learn.sName="学技能",this.btn_learn.Move(this.iX+460,this.iY+260,110,52),this.btn_wash=new Eh(gn.xani_nui2),this.btn_wash.InitButton("按钮1_110"),this.btn_wash.sName="洗 炼",this.btn_wash.Move(this.iX+460+145,this.iY+260,110,52),this.btn_eat=new Eh(gn.xani_nui2),this.btn_eat.InitButton("按钮1_110"),this.btn_eat.sName="喂 养",this.btn_eat.Move(this.iX+460+290,this.iY+260,110,52),this.in_name=new pi(gn.xani_ui),this.in_name.Move(h.SCRW,h.SCRH,10,10),this.in_name.sDetail="",this.bEditingName=!1,this.iScrollY=0,this.iLockScroll=-1}Draw(){if(Bi.mp.iPetCount<=0)ln.gi().PopStat(1);else{var i,t,s,e,h,a,n,o;for(E.new_baseframe2(this.iX,this.iY,this.iW,this.iH,"宠","物"),s=this.iX+28,e=this.iY+28,h=395,a=553,E.new_framein(s,e,h,a),0==this.iPage?(s=s+h+15,h=450,a=385,E.new_framein(s,e,h,a),e=e+a+15,a=153,E.new_framein(s,e,h,a)):(s=s+h+15,h=450,a=553,E.new_framein(s,e,h,a)),i=0;i<2;i++)this.iPage==i&&(this.btn_page[i].bMouseIn=!0,this.btn_page[i].bMouseDown=!0),this.btn_page[i].Draw(),0==this.iPage?(E.new_lableword4(this.iX+this.iW-15,this.iY+50+0,40,70,!0,"宠","物","属","性"),E.new_lableword4(this.iX+this.iW-15,this.iY+50+130,40,70,!1,"资","质","技","能")):(E.new_lableword4(this.iX+this.iW-15,this.iY+50+0,40,70,!1,"宠","物","属","性"),E.new_lableword4(this.iX+this.iW-15,this.iY+50+130,40,70,!0,"资","质","技","能"));for(this.btn_close.Draw(),this.iPetPoint>=Bi.mp.iPetCount&&(this.iPetPoint=0),t=Bi.mp.pets[this.iPetPoint],i=0;i<8;i++)gn.xani_nui2.DrawAnima(this.iX+56+i%4*92,this.iY+391+92*parseInt(i/4),"宠物头像框",0),i>=Bi.mp.iPetCount||(n=this.iX+56+i%4*92,o=this.iY+391+92*parseInt(i/4),gn.xani_head.DrawAnima_aa(n,o,gn.de_pet.strValue(Bi.mp.pets[i].iTid,0,1),0),xh.me.iFightPid==Bi.mp.pets[i].iPid&&gn.xani_nui2.DrawAnima(n,o,"宠物头像框",1),parseInt(Bi.mp.pets[i].iFlag/100)%10!=0&&c.gi().DrawText_2(n-6,o+80,"绑",4285267956,26,101,1,1,0,0,-3,4,4278190080),this.iPetPoint==i&&gn.xani_nui2.DrawAnimaEx(n,o,"头像选中框",0,101,1,1,0,0,0));for(gn.xani_nui2.DrawAnima(this.iX+28+197.5-130,this.iY+112,"宠物背景",0),G.DrawAura(0,this.iX+220,this.iY+280,null,0),t.aa_body.Draw(this.iX+220,this.iY+280),t.aa_body.NextFrame(),et.wordframe(this.iX+28+197.5-80,this.iY+63,160),c.gi().DrawText_2(this.iX+28+197.5,this.iY+63+16,Bi.mp.pets[this.iPetPoint].sName,4294967295,22,101,1,1,0,-2,-2,3,4278190080),this.btn_changename.Draw(),Bi.mp.pets[this.iPetPoint].CalcPetScore(),c.gi().DrawText_2(this.iX+28+197.5,this.iY+63+16+40,"评分:"+Bi.mp.pets[this.iPetPoint].iScore,4294967295,26,101,1,1,0,-2,-2,3,4278190080),i=0;i<5;i++)i<t.iStar?gn.xani_nui2.DrawAnima(this.iX+54,this.iY+129+40*i,"宠物进阶星星",1):gn.xani_nui2.DrawAnima(this.iX+54,this.iY+129+40*i,"宠物进阶星星",0);if(gn.xani_nui2.DrawAnima(this.iX+380,this.iY+173,"宠物类型红印",3&t.iBaobao),c.gi().DrawText_2(this.iX+224,this.iY+340,t.iLev+"级",4294967295,22,101,1,1,0,-2,-2,3,4278190080),c.gi().DrawText_2(this.iX+340,this.iY+340,"仙露仙桃："+t.iFlag%100,4294967295,20,101,1,1,0,-2,-2,3,4278190080),0==this.iPage?(et.Draw_Base1(this.iX+470,this.iY+60,t),et.Draw_Base2(this.iX+470,this.iY+190,t),this.btn_drop.Draw(),this.btn_addpoint.Draw(),xh.me.iFightPid==t.iPid?this.btn_joinfight.sName="休 息":this.btn_joinfight.sName="参 战",this.btn_joinfight.Draw(),this.btn_fusepet.Draw(),xh.me.iFollowPid==t.iPid?this.btn_follow.sName="隐 藏":this.btn_follow.sName="跟 随",this.btn_follow.Draw()):1==this.iPage&&(this.btn_eat.Draw(),this.btn_learn.Draw(),this.btn_wash.Draw(),this.Draw_Base3(this.iX+460,this.iY+58,t)),this.bEditingName&&(this.in_name.onscr(),t.sName=this.in_name.sDetail,this.in_name.bFinished&&(this.bEditingName=!1,this.in_name.bFinished=!1,Mh.gi().s_ChangePetName(t.iPid,this.in_name.sDetail))),ei.end(ei.CONFIRM_DROPPET)&&ei.bConfirm&&(xh.me.bHaveLock&&xh.me.bLocked?L.easymsg.AddMessage("未解锁不能放生"):(xh.me.iFightPid==t.iPid&&(xh.me.iFightPid=0),Mh.gi().s_DropPet(t.iPid),Bi.mp.RemovePet(t.iPid),this.iPetPoint=0)),(ei.end(ei.CONFIRM_WASHPET)||ei.end(ei.CONFIRM_WASHPETBYINGOT))&&ei.bConfirm&&Mh.gi().s_WashPet(Bi.mp.pets[this.iPetPoint].iPid,this.iWashGid),Xi.end(Xi.ADDPOINT_PET)&&Xi.bConfirm){for(Mh.gi().s_AddPetPoint(t.iPid,Xi.iModifys[0],Xi.iModifys[1],Xi.iModifys[2],Xi.iModifys[3],Xi.iModifys[4]),i=0;i<5;i++)t.iBaseAtt[i]+=Xi.iModifys[i];Bi.CalcFightAtt(t)}}}Draw_Base3(i,t,s){var e,h,a;E.ui3_Text1_4word(i+3,t,110,100,"体质资质",""+s.zz[0]),E.ui3_Text1_4word(i+3,t+40,110,100,"法力资质",""+s.zz[1]),E.ui3_Text1_4word(i+3,t+80,110,100,"力量资质",""+s.zz[2]),E.ui3_Text1_4word(i+3,t+120,110,100,"耐力资质",""+s.zz[3]),E.ui3_Text1_4word(i+3,t+160,110,100,"敏捷资质",""+s.zz[4]),E.ui3_Text1_(i+236,t,67,100,"成长",""+Bi.swapcz(s.cz)),s.iLife>3e4?E.ui3_Text1_(i+236,t+40,67,100,"寿命","永生"):E.ui3_Text1_(i+236,t+40,67,100,"寿命",""+s.iLife),t+=223,i+=6,t+=47,this.iScrollRectX=i,this.iScrollRectY=t,this.iScrollRectW=408,this.iScrollRectH=234;var n=-1,o=-1,r=-1;for(c.gi().SetViewClip(i-6,t-6,i+400,t+194+40),e=0;e<12;e++)h=i+e%4*102,a=t+97*parseInt(e/4)-this.iScrollY,null==this.btn_skilllist[e]&&(this.btn_skilllist[e]=new Eh(gn.xani_nui2),this.btn_skilllist[e].bSingleButton=!0),this.btn_skilllist[e].Move(h,a,92,92),gn.xani_nui2.DrawAnima(h,a,"技能框",0),e<s.iSkillBlock&&s.jn[e]>0&&(gn.xani_nicon.DrawAnima_aa(h,a,gn.de_skill.strValue(s.jn[e],0,5),0),this.btn_skilllist[e].bMouseDown&&(r=e,n=h,o=a)),e>=s.iSkillBlock&&gn.xani_nui2.DrawAnima(h,a,"技能框",1);c.gi().NoClip(),r>=0&&Yi.Skill_Detail(s.jn[r],n,o,-1)}ProcTouch(i,t,s){var e;for(e=0;e<2;e++)this.btn_page[e].ProcTouch(i,t,s)&&this.btn_page[e].bCheck()&&(this.iPage=e);if(this.btn_close.ProcTouch(i,t,s))return this.btn_close.bCheck()&&ln.gi().PopStat(1),!0;for(e=0;e<Bi.mp.iPetCount;e++)this.btn_petlist[e].ProcTouch(i,t,s)&&this.btn_petlist[e].bCheck()&&(this.iPetPoint=e);if(this.btn_changename.ProcTouch(i,t,s)&&this.btn_changename.bCheck()&&(console.log("改名"),this.bEditingName=!0,this.in_name.Move(this.btn_changename.iX,this.btn_changename.iY,this.btn_changename.iW,this.btn_changename.iH),this.in_name.sDetail=Bi.mp.pets[this.iPetPoint].sName,this.in_name.ProcTouch(3,h.SCRW+1,h.SCRH+1),st.eventOnce("onKeyboardComplete",()=>{""!=this.in_name.sDetail?this.in_name.bFinished=!0:(this.bEditingName=!1,this.in_name.sDetail=Bi.mp.pets[this.iPetPoint].sName)},this)),0==this.iPage){if(this.btn_fusepet.ProcTouch(i,t,s)&&this.btn_fusepet.bCheck()&&(ln.gi().PopStat(1),Ui.Open()),this.btn_joinfight.ProcTouch(i,t,s)&&this.btn_joinfight.bCheck()&&(xh.me.iFightPid==Bi.mp.pets[this.iPetPoint].iPid?(xh.me.iFightPid=0,Mh.gi().s_ChangeFightPet(xh.me.iFightPid)):Bi.mp.pets[this.iPetPoint].iLev>xh.me.rbs.iLev+10?Z.fm.Open("宠物超过人物10级不会出战"):xh.me.rbs.iLev<gn.de_pet.intValue(Bi.mp.pets[this.iPetPoint].iTid,0,2)?Z.fm.Open("参战要求人物达到"+gn.de_pet.intValue(Bi.mp.pets[this.iPetPoint].iTid,0,2)+"级"):(xh.me.iFightPid=Bi.mp.pets[this.iPetPoint].iPid,Mh.gi().s_ChangeFightPet(xh.me.iFightPid))),this.btn_follow.ProcTouch(i,t,s)&&this.btn_follow.bCheck()&&(xh.me.iFollowPid==Bi.mp.pets[this.iPetPoint].iPid?xh.me.iFollowPid=0:xh.me.iFollowPid=Bi.mp.pets[this.iPetPoint].iPid,Mh.gi().s_ChangeFollowPet(xh.me.iFollowPid)),this.btn_drop.ProcTouch(i,t,s)&&this.btn_drop.bCheck()&&ei.start(ei.CONFIRM_DROPPET,"是否确认把#c00ff00["+Bi.mp.pets[this.iPetPoint].sName+"]#o放生？"),this.btn_addpoint.ProcTouch(i,t,s)&&this.btn_addpoint.bCheck()){var a=Bi.mp.pets[this.iPetPoint];Bi.mp.pets[this.iPetPoint].nut<=0?L.easymsg.AddMessage("当前没有剩余点数可以加"):Xi.start(Xi.ADDPOINT_PET,a.tz,a.fl,a.ll,a.nl,a.mj,a.nut)}}else if(1==this.iPage)for(this.btn_learn.ProcTouch(i,t,s)&&this.btn_learn.bCheck()&&Ki.Open(Bi.mp.pets[this.iPetPoint]),this.btn_eat.ProcTouch(i,t,s)&&this.btn_eat.bCheck()&&$i.Open(Bi.mp.pets[this.iPetPoint]),this.btn_wash.ProcTouch(i,t,s)&&this.btn_wash.bCheck()&&(Bi.mp.pets[this.iPetPoint].iPid==xh.me.iFightPid?Z.fm.Open("不能洗练参战宠物"):0==(2&Bi.mp.pets[this.iPetPoint].iBaobao)?ht.bHaveGoods(160,1)?(this.iWashGid=ht.gi().GetGid(160),ei.start(ei.CONFIRM_WASHPET,"是否确定消耗一个仙灵果对#c00ff00["+Bi.mp.pets[this.iPetPoint].sName+"]#o进行洗练？")):xh.me.rbs.iInGot>=10?(this.iWashGid=0,ei.start(ei.CONFIRM_WASHPETBYINGOT,"背包中没有仙灵果，是否花费10元宝购买仙灵果对#c00ff00["+Bi.mp.pets[this.iPetPoint].sName+"]#o进行洗练？")):Z.fm.Open("背包中没有仙灵果"):ht.bHaveGoods(161,1)?(this.iWashGid=ht.gi().GetGid(161),ei.start(ei.CONFIRM_WASHPET,"是否确定消耗一个高级仙灵果对#c00ff00["+Bi.mp.pets[this.iPetPoint].sName+"]#o进行洗练？")):xh.me.rbs.iInGot>=50?(this.iWashGid=0,ei.start(ei.CONFIRM_WASHPETBYINGOT,"背包中没有高级仙灵果，是否花费50元宝购买高级仙灵果对#c00ff00["+Bi.mp.pets[this.iPetPoint].sName+"]#o进行洗练？")):Z.fm.Open("背包中没有高级仙灵果")),this.iLockScroll>0&&(2==i&&(e=this.iLockScroll-s,this.iLockScroll=s,this.iScrollY+=e,this.iScrollY<0&&(this.iScrollY=0),this.iScrollY>50&&(this.iScrollY=50)),3==i&&(this.iLockScroll=-1)),bn.bInRect(t,s,this.iScrollRectX,this.iScrollRectY,this.iScrollRectW,this.iScrollRectH)&&1==i&&(this.iLockScroll=s),e=0;e<12;e++)null!=this.btn_skilllist[e]&&this.btn_skilllist[e].ProcTouch(i,t,s);return!1}}et.Open=function(){var i=null;if(Bi.mp.iPetCount>0){i=ln.gi().PushStat(ln.GS_PETSFRAME);var t=Bi.mp.GetUseingPet();if(null==t){for(var s=0;s<Bi.mp.iPetCount;s++)if(Bi.mp.pets[s].iLife>50){i.iPetPoint=s;break}}else for(s=0;s<Bi.mp.iPetCount;s++)if(Bi.mp.pets[s]==t){i.iPetPoint=s;break}}else L.easymsg.AddMessage("你还没有宠物");return i},et.wordframe=function(i,t,s){gn.xani_nui2.DrawAnimaEx(i,t,"可变长文字框",0,101,1,1,0,0,0),gn.xani_nui2.DrawAnimaEx(i+15,t,"可变长文字框",1,101,1*(s-30)/20,1,0,0,0),gn.xani_nui2.DrawAnimaEx(i+s-20,t,"可变长文字框",2,101,1,1,0,0,0)},et.Draw_Base2=function(i,t,s){t+=105,E.ui3_Text1_(i,t-60-45,67,100,"体质",""+s.tz),E.ui3_Text1_(i,t-20-45,67,100,"法力",""+s.fl),E.ui3_Text1_(i,t+20-45,67,100,"力量",""+s.ll),E.ui3_Text1_(i,t+60-45,67,100,"耐力",""+s.nl),E.ui3_Text1_(i,t+100-45,67,100,"敏捷",""+s.mj),E.ui3_Text1_(i+210,t-60-45,67,100,"灵力",""+s.iSpirit),E.ui3_Text1_(i+210,t-20-45,67,100,"伤害",""+s.iAttack),E.ui3_Text1_(i+210,t+20-45,67,100,"防御",""+s.iDefence),E.ui3_Text1_(i+210,t+60-45,67,100,"速度",""+s.iSpeed),E.ui3_Text1_(i+210,t+100-45,67,100,"潜能",""+s.nut)},et.Draw_Base1=function(i,t,s){gn.xani_nui2.DrawAnima(i,t,"提示1",0),c.gi().DrawText_2(i+33.5,t+16,"气血",4294967295,20,101,1,1,0,-2,-2,3,4278190080),gn.xani_nui2.DrawAnima(i,t+38,"提示1",0),c.gi().DrawText_2(i+33.5,t+38+16,"魔法",4294967295,20,101,1,1,0,-2,-2,3,4278190080),gn.xani_nui2.DrawAnima(i,t+76,"提示1",0),c.gi().DrawText_2(i+33.5,t+76+16,"经验",4294967295,20,101,1,1,0,-2,-2,3,4278190080);var h=67;gn.xani_nui2.DrawAnima(i+h,t,"宠物大血条",0),gn.xani_nui2.DrawAnima(i+h,t+38,"宠物大血条",0),gn.xani_nui2.DrawAnima(i+h,t+76,"宠物大血条",0),c.gi().SetViewClip(i,t,i+h+311*s.iHp/s.iMaxHp,t+480),gn.xani_nui2.DrawAnima(i+h+2,t+3,"宠物大血条",1),c.gi().NoClip(),c.gi().SetViewClip(i,t,i+h+311*s.iMp/s.iMaxMp,t+480),gn.xani_nui2.DrawAnima(i+h+2,t+38+3,"宠物大血条",2),c.gi().NoClip();var a=311;a=a*s.iExp/(e.iUpgradeExp[s.iLev]/3),c.gi().SetViewClip(i,t,i+h+a,t+480),gn.xani_nui2.DrawAnima(i+h+2,t+76+3,"宠物大血条",3),c.gi().NoClip(),c.gi().DrawTextEx(i+h+155.5,t+15,s.iHp+"/"+s.iMaxHp,4294967295,20,101,1,1,0,-2,-2),c.gi().DrawTextEx(i+h+155.5,t+40+13,s.iMp+"/"+s.iMaxMp,4294967295,20,101,1,1,0,-2,-2),c.gi().DrawTextEx(i+h+155.5,t+80+12,s.iExp+"/"+parseInt(e.iUpgradeExp[s.iLev]/3),4294967295,20,101,1,1,0,-2,-2)};class ht{constructor(){var i,t;for(this.pm3f=c.xm3f,ht.iW=750,ht.iH=450,ht.iX=(h.SCRW-ht.iW)/2,ht.iY=(h.SCRH-ht.iH)/2,this.iW1=2*ht.GW,this.iH1=3*ht.GW,this.iX1=ht.iX-this.iW1,this.iY1=ht.iY+(this.iH-this.iH1)/2,this.bShow=!1,this.btn_close=new D(gn.xani_ui),this.btn_close.InitButton("属性关闭按钮"),this.btn_close.sName="",this.btn_bag1=new D(gn.xani_ui),this.btn_bag1.InitButton("亮蓝按钮"),this.btn_bag1.sName="背包",this.btn_bag2=new D(gn.xani_ui),this.btn_bag2.InitButton("亮蓝按钮"),this.btn_bag2.sName="行囊",this.goods=new Array(30),this.goods[1]=new Array(6),i=0;i<6;i++)this.goods[1][i]=new Li,this.goods[1][i].iOid=1,this.goods[1][i].iPos=i;for(this.goods[2]=new Array(20),this.goods[3]=new Array(20),i=0;i<20;i++)this.goods[2][i]=new Li,this.goods[2][i].iOid=2,this.goods[2][i].iPos=i,this.goods[3][i]=new Li,this.goods[3][i].iOid=3,this.goods[3][i].iPos=i;for(t=10;t<30;t++)for(this.goods[t]=new Array(20),i=0;i<20;i++)this.goods[t][i]=new Li,this.goods[t][i].iOid=t,this.goods[t][i].iPos=i;this.swapgoods=new Li,this.bLocked=!1,this.bDested=!1,this.bTiming=!1,this.iTouchDelay=0,this.bShowDetail=!1}GetGid(i){var t;for(t=0;t<20;t++)if(this.goods[2][t].iGid>0&&this.goods[2][t].iTid==i)return this.goods[2][t].iGid;return-1}UseGoods(){var i,t;if(1==this.lockgoods.iOid)for(i=0;i<20;i++)if(-1==this.goods[2][i].iGid)return this.destgoods=this.goods[2][i],void this.MoveGoods(this.lockgoods,this.destgoods);if(2==this.lockgoods.iOid){if(-1!=(t=gn.de_goods.intValue(this.lockgoods.iTid,-1,16)))return this.destgoods=this.goods[1][t],void this.MoveGoods(this.lockgoods,this.destgoods);if(t=gn.de_goods.intValue(this.lockgoods.iTid,-1,33),gn.sop(this.lockgoods.iTid+",,,"+t),-1==t)if(-1==(t=gn.de_goods.intValue(this.lockgoods.iTid,-1,27)))if(-1==(t=gn.de_goods.intValue(this.lockgoods.iTid,-1,30)))-1==(t=gn.de_goods.intValue(this.lockgoods.iTid,-1,31))?L.easymsg.AddMessage("未知物品使用失败"):L.easymsg.AddMessage("不能直接使用");else if(1==t)if(160==this.lockgoods.iTid||161==this.lockgoods.iTid){var s=et.Open();null!=s&&(s.iPage=1)}else 122==this.lockgoods.iTid?Z.fm.Open("请在公聊发送窗口选择喇叭频道"):(Mh.gi().s_UseGoods(this.lockgoods.iGid,1,""),119==this.lockgoods.iTid&&(this.bShow=!1),237==this.lockgoods.iTid&&(Yi.Open(3),this.bShow=!1));else 97==this.lockgoods.iTid?Z.fm.Open("请前往乡水镇找铁匠打造装备"):L.easymsg.AddMessage("不能直接使用");else{i=0;for(var e=1,h=gn.de_goods.intValue(this.lockgoods.iTid,0,1),a=gn.de_goods.intValue(this.lockgoods.iTid,0,2);(-1!=h&&xh.me.rbs.iHp<xh.me.rbs.iMaxHp||-1!=a&&xh.me.rbs.iMp<xh.me.rbs.iMaxMp)&&!(e<=0);)-1!=h&&(xh.me.rbs.iHp+=h),-1!=a&&(xh.me.rbs.iMp+=a),e--,i++;i<=0?L.easymsg.AddMessage("您的状态很好，不需要恢复"):(Mh.gi().s_UseGoods(this.lockgoods.iGid,i,""),this.lockgoods.iCount-=i,this.lockgoods.iCount<=0&&(this.lockgoods.iGid=-1,this.bLocked=!1),xh.me.CalcFightAtt())}else Mh.gi().s_UseGoods(this.lockgoods.iGid,1,"")}}MoveGoods(i,t){var s,e;if((1!=t.iOid||bCheckEquipment(i,t.iPos))&&(1!=i.iOid||-1==t.iGid||bCheckEquipment(t,i.iPos)))if(318!=i.iTid&&319!=i.iTid&&320!=i.iTid&&321!=i.iTid&&322!=i.iTid&&323!=i.iTid||2!=i.iOid||2==t.iOid){if(Mh.gi().s_MoveGoods(i.iGid,i.iOid,i.iPos,t.iGid,t.iOid,t.iPos),-1==t.iGid)t.copyfrom(i),i.iGid=-1;else if(s=gn.de_goods.intValue(i.iTid,0,28),i.iTid==t.iTid&&s>1)if(t.iCount>=s)for(var h=0;h<100;h++)gn.sop("zzzzzzzzzzzzzzz");else i.iCount+t.iCount<=s?(t.iCount+=i.iCount,i.iGid=-1):(e=i.iCount+t.iCount,t.iCount=s,i.iCount=e-s);else this.swapgoods.copyfrom(t),t.copyfrom(i),i.copyfrom(this.swapgoods);1!=i.iOid&&1!=t.iOid||((1==i.iOid&&2==i.iPos||1==t.iOid&&2==t.iPos)&&(xh.me.bwc=!0),xh.me.CalcFightAtt())}else Z.fm.Open("礼包不能移动到行囊和仓库")}GetWeaponTid(){return this.goods[1][2].iGid<=0?-1:this.goods[1][2].iTid}Open(){ln.gi().PushStat(ln.GS_MYGOODSFRAME)}UpdateOneGoods(i){var t,s,e,h,a,n,o=i.GetNextByte(),r=null;switch(gn.sop("rt="+o),o){case 0:s=i.GetNextInt(),h=i.GetNextByte(),a=i.GetNextByte(),1==h&&2==a&&(xh.me.bwc=!0),s==this.goods[h][a].iGid&&(this.goods[h][a].iGid=-1);break;case 1:for(s=i.GetNextInt(),e=i.GetNextShort(),i.GetNextInt(),h=i.GetNextByte(),a=i.GetNextByte(),n=i.GetNextByte(),1==h&&2==a&&(xh.me.bwc=!0),(r=this.goods[h][a]).iGid=s,r.iTid=e,r.iCount=n,t=0;t<8;t++)r.iAtts[t]=i.GetNextInt();gn.xani_ngoods.InitAnimaWithName(gn.de_goods.strValue(e,-1,10),r.aa)}}GetGoods(i){var t,s,e,h,a=i.GetNextByte(),n=null;for(gn.sop("get this.goods oid="+a),t=0;t<this.goods[a].length;t++)this.goods[a][t].iGid=-1;for(;-1!=(s=i.GetNextInt());){for(e=i.GetNextShort(),h=i.GetNextByte(),1==a&&2==h&&(xh.me.bwc=!0),(n=this.goods[a][h]).iGid=s,n.iTid=e,n.iPos=h,n.iCount=i.GetNextByte(),t=0;t<8;t++)n.iAtts[t]=i.GetNextInt();gn.xani_ngoods.InitAnimaWithName(gn.de_goods.strValue(e,-1,10),n.aa)}ln.gi().iXStat==ln.GS_LOADING1&&ln.gi().PopStat(1)}}ht.mg=null,ht.gi=function(){return null==ht.mg&&(ht.mg=new ht),ht.mg},ht.bCheckEquipment=function(i,t){var s=gn.de_goods.intValue(i.iTid,-1,16);if(-1==s)return L.easymsg.AddMessage("不是装备"),!1;if(s!=t)return L.easymsg.AddMessage("穿戴装备种类不符"),!1;var e=gn.de_goods.intValue(i.iTid,-1,9);if(-1!=e&&xh.me.rbs.iLev<e){var h=i.iAtts[4]>>10&1023,a=i.iAtts[4]>>20&1023;if(266==h||265==h&&xh.me.rbs.iLev+5>=e);else if(!(266==a||265==a&&xh.me.rbs.iLev+5>=e))return L.easymsg.AddMessage("装备等级太高"),!1}var n=gn.de_goods.intValue(i.iTid,-1,19);if(-1!=n&&n!=xh.me.iRace)return L.easymsg.AddMessage("装备种族不匹配"),!1;var o=gn.de_goods.intValue(i.iTid,-1,20);return-1==o||o==xh.me.iSex||(L.easymsg.AddMessage("装备性别不匹配"),!1)},ht.iHaveGoodsCount=function(){var i,t=0;for(i=0;i<20;i++)ht.mg.goods[2][i].iGid>0&&t++;return t},ht.bHaveGoods=function(i,t){var s;for(s=0;s<20;s++)if(ht.mg.goods[2][s].iGid>0&&ht.mg.goods[2][s].iTid==i&&ht.mg.goods[2][s].iCount>=t)return!0;return!1},ht.iX,ht.iY,ht.iW,ht.iH,ht.GW=60,ht.GH=60;class at{constructor(i){var t;for(this.iDownFlag=i,this.iR=30,this.sNpcName="",this.sBaseAniName="",this.sAniName="",this.pss=new Array(at.MAXBASESEQUENCE),t=0;t<at.MAXBASESEQUENCE;t++)this.pss[t]=null;this.aa_body=new l,this.aa_weapon=new l,this.iFlag=0,this.iAnimaType=0,this.iPopoDelay=0}ResetStandAnima(i,t){var s;this.iStandFlag<0||(1==parseInt(this.iStandFlag/1e4)&&(this.iFaceTo=this.GetFace4(i,t),s=this.iStandFlag%1e4,s%=1e3,gn.xani_pets[s].InitAnimaWithName("站立_"+this.FaceTo(this.iFaceTo),this.aa_body)),0!=this.iStandFlag&&1!=this.iStandFlag&&2!=this.iStandFlag||(this.iFaceTo=this.GetFace4(i,t),gn.xani_stand[this.iStandFlag].InitAnimaWithName(this.sStandName+"_"+this.FaceTo(this.iFaceTo),this.aa_body)))}GetFace4(i,t){return i<this.iX?t<this.iY?1:3:t<this.iY?7:5}GetFace8(i,t){var s;return s=360-bn.GetAngleXY(this.iDx,this.iDy,this.iX,this.iY),22<(s%=360)&&s<68?7:67<s&&s<113?0:112<s&&s<158?1:157<s&&s<203?2:202<s&&s<248?3:247<s&&s<293?4:292<s&&s<338?5:6}FaceTo(i){switch(i){case 0:return"上";case 1:return"左上";case 2:return"左";case 3:return"左下";case 4:return"下";case 5:return"右下";case 6:return"右";case 7:return"右上"}return"下"}ToFace(i){return"上"==i?0:"左上"==i?1:"左"==i?2:"左下"==i?3:"下"==i?4:"右下"==i?5:"右"==i?6:"右上"==i?7:0}ToX(i){return 0==i||4==i?this.iX:1==i||2==i||3==i?this.iX-10:this.iX+10}ToY(i){return 2==i||6==i?this.iY:0==i||1==i||7==i?this.iY-10:this.iY+10}}at.MAXBASESEQUENCE=16;class nt{E_DATA(){}fitem(i){var t;for(t=0;t<this.iItemCount;t++)if(this.items[t].iItemId==i)return this.items[t];return null}intValue(i){return parseInt(this.strValue(i))}strValue(i){var t,s;for(t=0;t<this.iItemCount;t++)for(s=0;s<this.items[t].iValueCount;s++)if(this.items[t].values[s].iVid==i)return this.items[t].values[s].sValue;return"-1"}}class ot{constructor(){this.iGid=0,this.gp=null}}class rt{constructor(){this.iPid=0}}class ct{constructor(){var i;if(this.bSelling=!1,null==ct.sg){for(ct.sg=new Array(20),ct.sp=new Array(8),i=0;i<20;i++)ct.sg[i]=new ot;for(i=0;i<8;i++)ct.sp[i]=new rt}this.iW=900,this.iH=580,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_changename=new Eh(gn.xani_nui2),this.btn_changename.InitButton("宠物改名按钮"),this.in_name=new pi(gn.xani_ui),this.in_name.Move(h.SCRW,h.SCRH,10,10),this.in_name.sDetail="",this.in_name.iLength=8,this.bEditingName=!1,this.btn_putup=new Eh(gn.xani_nui2),this.btn_putup.InitButton("按钮1_110"),this.btn_putup.sName="上架",this.btn_record=new Eh(gn.xani_nui2),this.btn_record.InitButton("按钮1_110"),this.btn_record.sName="记录",this.btn_exit=new Eh(gn.xani_nui2),this.btn_exit.InitButton("按钮1_110"),this.btn_exit.sName="收摊"}Draw(){var i,t,s,e,a,n;if(this.bShow){for(this.iX=Math.floor(h.SCRW-this.iW)/2,this.iY=Math.floor(h.SCRH-this.iH)/2,E.new_baseframe2(this.iX,this.iY,this.iW,this.iH,"摆","摊"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_close.Draw(),E.new_framein(this.iX+30,this.iY+30,this.iW-60,this.iH-60),E.new_numberframe(this.iX+30+20,this.iY+30+30-5,700,this.sSellName),this.btn_changename.Move(this.iX+30+20+700,this.iY+30+20,60,60),this.btn_changename.Draw(),this.bEditingName&&(this.in_name.onscr(),this.sSellName=this.in_name.sDetail,this.in_name.bFinished&&(this.bEditingName=!1,this.in_name.bFinished=!1,Mh.gi().s_StartSell(6,0,0,this.sSellName))),a=this.iX+30+20,n=this.iY+30+30+40+30,gn.xani_nui3.DrawAnima(a,n,"摊位分类框",0),c.gi().DrawTextEx(a+52.5,n+16.5,"物品",4294967295,25,101,1,1,0,-2,-2),n+=43,this.iGx=a,this.iGy=n,qi.new_DrawGoods(a,n,ht.gi().goods[2],null,null),i=0;i<20;i++)ct.sg[i].iGid>0&&qi.new_DrawRect(a,n,ht.gi().goods[2],ct.sg[i].gp,1);for(a=this.iX+30+20+430+20,n=this.iY+30+30+40+30,gn.xani_nui3.DrawAnima(a,n,"摊位分类框",0),c.gi().DrawTextEx(a+52.5,n+16.5,"宠物",4294967295,25,101,1,1,0,-2,-2),n+=43,this.iPx=a,this.iPy=n,E.new_frameon(a,n,345,175,0),i=0;i<8;i++)if(s=a+5+i%4*85,e=n+5+85*Math.floor(i/4),gn.xani_nui3.DrawAnima(s,e,"基本头像框",0),!(i>=Bi.mp.iPetCount))for(gn.xani_head.DrawAnima_aa(s+3,e+3,gn.de_pet.strValue(Bi.mp.pets[i].iTid,0,1),0),parseInt(Bi.mp.pets[i].iFlag/100)%10!=0&&c.gi().DrawText_2(s-6+3,e+80+3,"绑",4285267956,26,101,1,1,0,0,-3,4,4278190080),this.lockpet==Bi.mp.pets[i]&&(gn.xani_nui3.DrawAnimaEx(s,e,"物品选中框",0,101,1,1,0,0,0),E.new_TagText2(this.iPx,this.iPy+175+15,150,"名称",Bi.mp.pets[i].sName)),t=0;t<8;t++)ct.sp[t].iPid>0&&Bi.mp.pets[i].iPid==ct.sp[t].iPid&&(gn.xani_nui3.DrawAnimaEx(s,e,"物品选中框",1,101,1,1,0,0,0),this.lockpet==Bi.mp.pets[i]&&(0==ct.sp[t].iPrice?E.new_TagText2(this.iPx,this.iPy+175+15+52,150,"价格","观赏"):E.new_TagText2(this.iPx,this.iPy+175+15+52,150,"单价",""+ct.sp[t].iPrice)));if(this.btn_putup.Move(this.iPx+345-110,this.iPy+175+15,110,52),this.btn_record.Move(this.iPx,this.iPy+175+15+104,110,52),this.btn_exit.Move(this.iPx+345-110,this.iPy+175+15+104,110,52),null!=this.lockgoods){for(qi.new_DrawRect(this.iGx,this.iGy,ht.gi().goods[2],this.lockgoods,0),E.new_TagText2(this.iPx,this.iPy+175+15,150,"名称",gn.de_goods.strValue(this.lockgoods.iTid,-1,4)),this.bPutUp=!0,i=0;i<20;i++)0!=ct.sg[i].iGid&&ct.sg[i].iGid==this.lockgoods.iGid&&(0==ct.sg[i].iPrice?E.new_TagText2(this.iPx,this.iPy+175+15+52,150,"价格","观赏"):E.new_TagText2(this.iPx,this.iPy+175+15+52,150,"单价",""+ct.sg[i].iPrice),this.bPutUp=!1);this.bPutUp?this.btn_putup.sName="上架":this.btn_putup.sName="下架",this.btn_putup.Draw()}if(null!=this.lockpet){for(this.bPutUp=!0,i=0;i<Bi.mp.iPetCount;i++)0!=ct.sp[i].iPid&&ct.sp[i].iPid==this.lockpet.iPid&&(this.bPutUp=!1);this.bPutUp?this.btn_putup.sName="上架":this.btn_putup.sName="下架",this.btn_putup.Draw()}this.btn_exit.Draw(),this.btn_record.Draw(),qi.bShowDetail()&&qi.new_DrawDetail(null,-1,-1,0)}}ProcTouch(i,t,s){var e,a,n;if(null!=this.lockgoods&&this.btn_putup.ProcTouch(i,t,s)){if(this.btn_putup.bCheck())if(this.bPutUp){if(0!=this.lockgoods.iAtts[7])return L.easymsg.AddMessage("绑定物品不可上架"),!0;ln.gi().PushStat(ln.GS_SHELVESFRAME),this.lockpet=null}else Mh.gi().s_StartSell(2,this.lockgoods.iGid,0,"");return!0}if(null!=this.lockpet&&this.btn_putup.ProcTouch(i,t,s))return this.btn_putup.bCheck()&&(this.bPutUp?parseInt(this.lockpet.iFlag/100)%10==0?(ln.gi().PushStat(ln.GS_SHELVESFRAME),this.lockgoods=null):L.easymsg.AddMessage("绑定宠物不能上架"):Mh.gi().s_StartSell(4,this.lockpet.iPid,0,"")),!0;for(this.lockgoods=qi.new_LockGoods(t,s,this.iGx,this.iGy,ht.gi().goods[2],i),qi.NoMove(),3==i&&null!=this.lockgoods&&qi.bCanProc(),this.lockpet=null,e=0;e<Bi.mp.iPetCount;e++)if(a=this.iPx+5+e%4*85,n=this.iPy+5+e/4*85,bn.bInRect(t,s,a,n,80,80)){this.lockpet=Bi.mp.pets[e];break}if(this.btn_close.ProcTouch(i,t,s))return this.btn_close.bCheck()&&(this.bShow=!1),!0;if(this.btn_exit.ProcTouch(i,t,s))return this.btn_exit.bCheck()&&(this.bSelling=!1,Mh.gi().s_StartSell(5,0,0,"")),!0;if(this.btn_changename.ProcTouch(i,t,s)&&this.btn_changename.bCheck()&&(this.in_name.Move(this.btn_changename.iX,this.btn_changename.iY,this.btn_changename.iW,this.btn_changename.iH),this.in_name.sDetail=this.sSellName,this.in_name.Move(h.SCRW,h.SCRH,10,10),this.in_name.ProcTouch(3,h.SCRW+1,h.SCRH+1),this.bEditingName=!0),this.btn_record.ProcTouch(i,t,s)){if(this.btn_record.bCheck()){var o="";for(e=0;e<10;e++)o+=ct.sSellRecord[e],e<9&&(o+="#e");Z.fm.Open(o)}return!0}return!1}IndexSell(i){var t,s;for(t=0;t<20;t++)ct.sg[t].iGid=0;for(t=0;t<8;t++)ct.sp[t].iPid=0;for(t=0;t<20&&0!=(s=i.GetNextByte());t++)for(ct.sg[t].iGid=i.GetNextInt(),ct.sg[t].iPrice=i.GetNextInt(),ct.sg[t].iTid=i.GetNextInt(),ct.sg[t].gp=null,s=0;s<20;s++)ht.gi().goods[2][s].iGid>0&&ht.gi().goods[2][s].iGid==ct.sg[t].iGid&&(ct.sg[t].gp=ht.gi().goods[2][s]);for(t=0;t<8&&0!=(s=i.GetNextByte());t++)ct.sp[t].iPid=i.GetNextInt(),ct.sp[t].iPrice=i.GetNextInt(),ct.sp[t].iTid=i.GetNextInt()}InitSell(i){var t;for(this.sSellName=i.GetNextString(),this.bSelling=!0,t=0;t<20;t++)ct.sg[t].iGid>0&&(null==ct.sg[t].gp?ct.sg[t].iGid=0:ct.sg[t].gp.iGid!=ct.sg[t].iGid?ct.sg[t].iGid=0:2!=ct.sg[t].gp.iOid?ct.sg[t].iGid=0:ct.sg[t].gp.iTid>=101&&ct.sg[t].gp.iTid<=105?ct.sg[t].iGid=0:Mh.gi().s_StartSell(1,ct.sg[t].iGid,ct.sg[t].iPrice,""));for(t=0;t<8;t++)ct.sp[t].iPid>0&&(null==Bi.mp.FindPet(ct.sp[t].iPid)?ct.sp[t].iPid=0:Mh.gi().s_StartSell(3,ct.sp[t].iPid,ct.sp[t].iPrice,""));this.bShow=!0,this.lockgoods=null}AddSellRecord(i){var t;for(t=9;t>0;t--)ct.sSellRecord[t]=ct.sSellRecord[t-1];ct.sSellRecord[t]=i.GetNextString()}}ct.sSellRecord=["","","","","","","","","",""],ct.ms=null,ct.gi=function(){return null==ct.ms&&(ct.ms=new ct),ct.ms};class lt{constructor(){var i,t;for(this.MAXMARK=8,this.aa_body=new l,this.aa_weapon=new l,this.aa_mounts=new l,this.iSpeed=8,this.bUseing=!1,this.iPopoDelay=0,this.iWeapTid=0,this.iDWeapTid=0,this.iMountsTid=0,this.iDMountsTid=0,this.iChangeType=0,this.iDChangeType=0,this.bsc=!0,this.bfc8=!1,this.bfc6=!1,this.sStat="站立",this.sFace8="左",this.aa_team=new l,gn.xani_ui.InitAnimaWithName("队伍图标",this.aa_team),this.aa_fighting=new l,gn.xani_ui.InitAnimaWithName("战斗中头顶",this.aa_fighting),this.sTitle="",this.iFollowPid=0,this.iFollowTid=1e4,this.aa_follow=new l,this.iMarks=new Array(this.MAXMARK),i=0;i<this.MAXMARK;i++)this.iMarks[i]=new Int32Array(2);for(this.aa_mts=new Array(6),this.aa_bds=new Array(6),this.iColor=new Int32Array(6),this.aa_cls=new Array(6),i=0;i<6;i++)for(this.aa_mts[i]=new l,this.aa_bds[i]=new l,this.aa_cls[i]=new Array(6),this.iColor[i]=0,t=0;t<6;t++)this.aa_cls[i][t]=new l;this.iFace6=0}SetMarks(){var i;for(i=0;i<8;i++)this.iMarks[i][0]=this.iX,this.iMarks[i][1]=this.iY}Go(){var i;if(this.iX==this.iDx&&this.iY==this.iDy)return this.IsStat("跑步")&&this.ChangeStat("站立"),this.iDFaceTo!=this.iFaceTo&&(this.bfc8=!0,this.bfc4=!0),void(this.iFaceTo=this.iDFaceTo);var t=parseInt(bn.llength(this.iX,this.iY,this.iDx,this.iDy)/this.iSpeed);if(t<=0){for(i=this.MAXMARK-1;i>0;i--)this.iMarks[i][0]=this.iMarks[i-1][0],this.iMarks[i][1]=this.iMarks[i-1][1];return this.iMarks[0][0]=this.iX,this.iMarks[0][1]=this.iY,this.iX=this.iDx,this.iY=this.iDy,this.iDFaceTo!=this.iFaceTo&&(this.bfc8=!0,this.bfc4=!0),void(this.iFaceTo=this.iDFaceTo)}for(this.FaceTo(),i=this.MAXMARK-1;i>0;i--)this.iMarks[i][0]=this.iMarks[i-1][0],this.iMarks[i][1]=this.iMarks[i-1][1];this.iMarks[0][0]=this.iX,this.iMarks[0][1]=this.iY,this.iX=this.iX+(this.iDx-this.iX)/t,this.iY=this.iY+(this.iDy-this.iY)/t,this.IsStat("站立")&&this.ChangeStat("跑步")}FaceTo(){var i,t,s,e;i=360-bn.GetAngleXY(this.iDx,this.iDy,this.iX,this.iY),(s=0<=(i%=360)&&i<=90?0:90<=i&&i<=180?3:180<=i&&i<=270?2:1)!=parseInt(this.iFaceTo/10)&&(this.bfc4=!0),t=this.iFace6,this.iFace6=0<=i&&i<=30?0:30<i&&i<=90?5:90<i&&i<=150?4:150<i&&i<=210?3:210<i&&i<=270?2:270<i&&i<=330?1:0,t!=this.iFace6&&(this.bfc6=!0),e=this.sFace8,22<i&&i<68?(this.iFaceTo=1,this.sFace8="右上"):67<i&&i<113?(this.iFaceTo=2,this.sFace8="上"):112<i&&i<158?(this.iFaceTo=3,this.sFace8="左上"):157<i&&i<203?(this.iFaceTo=4,this.sFace8="左"):202<i&&i<248?(this.iFaceTo=5,this.sFace8="左下"):247<i&&i<293?(this.iFaceTo=6,this.sFace8="下"):292<i&&i<338?(this.iFaceTo=7,this.sFace8="右下"):(this.iFaceTo=0,this.sFace8="右"),this.iFaceTo=10*s+this.iFaceTo,e!=this.sFace8&&(this.bfc8=!0)}bFaceChanged6(){return!!this.bfc6&&(this.bfc6=!1,!0)}bFaceChanged4(){if(this.bfc4){switch(parseInt(this.iFaceTo/10)){case 0:this.sFace4="右";break;case 1:this.sFace4="右下";break;case 2:this.sFace4="左下";break;case 3:this.sFace4="左"}return this.bfc4=!1,!0}return!1}bFaceChanged8(){if(this.bfc8){switch(this.iFaceTo%10){case 0:this.sFace8="右";break;case 1:this.sFace8="右上";break;case 2:this.sFace8="上";break;case 3:this.sFace8="左上";break;case 4:this.sFace8="左";break;case 5:this.sFace8="左下";break;case 6:this.sFace8="下";break;case 7:this.sFace8="右下"}return this.bfc8=!1,!0}return!1}bStatChanged(){return!!this.bsc&&(this.bsc=!1,!0)}ChangeStat(i){this.sStat!=i&&(this.sStat=i,this.bsc=!0)}IsStat(i){return this.sStat==i}sSex(){return 0==this.iSex?"女":"男"}sRace(){return 0==this.iRace?"人":1==this.iRace?"魔":"仙"}DrawMounts(i,t,s,e,h){var a,n=0,o=2*this.iRace+this.iSex,r=xh.face_sti(s),c=xh.stat_sti(e),l=parseInt(this.iMountsTid/100)-1,b=this.iMountsTid%100,_=b-1,f=0;h&&(this.iOffY=0);var u=0;for(2==parseInt(this.iMountsTid/100)&&(u=12),a=0;a<N._ANIMASORT_MOUNT[l][_][c][r].length;a++)"左翅膀"==N._ANIMASORT_MOUNT[l][_][c][r][a]?(h&&gn.xani_nmounts[l][_].InitAnimaWithName(b+"_"+e+"_"+s+"_左翅膀",this.aa_mts[2]),M.gi().DrawAnima_aa(t+f,null,i,t+u,this.aa_mts[2]),this.aa_mts[2].NextFrame(),f++):"右翅膀"==N._ANIMASORT_MOUNT[l][_][c][r][a]?(h&&gn.xani_nmounts[l][_].InitAnimaWithName(b+"_"+e+"_"+s+"_右翅膀",this.aa_mts[3]),M.gi().DrawAnima_aa(t+f,null,i,t+u,this.aa_mts[3]),this.aa_mts[3].NextFrame(),f++):"前"==N._ANIMASORT_MOUNT[l][_][c][r][a]?(h&&gn.xani_nmounts[l][_].InitAnimaWithName(b+"_"+e+"_"+s+"_前",this.aa_mts[0]),M.gi().DrawAnima_aa(t+f,null,i,t+u,this.aa_mts[0]),this.aa_mts[0].NextFrame(),f++):"后"==N._ANIMASORT_MOUNT[l][_][c][r][a]?(h&&gn.xani_nmounts[l][_].InitAnimaWithName(b+"_"+e+"_"+s+"_后",this.aa_mts[1]),M.gi().DrawAnima_aa(t+f,null,i,t+u,this.aa_mts[1]),this.aa_mts[1].NextFrame(),f++):"身体"==N._ANIMASORT_MOUNT[l][_][c][r][a]?(h&&gn.xani_nmounts[l][_].InitAnimaWithName(b+"_"+e+"_"+s+"_身体",this.aa_mts[4]),M.gi().DrawAnima_aa(t+f,null,i,t+u,this.aa_mts[4]),this.aa_mts[4].NextFrame(),f++):"飘带"==N._ANIMASORT_MOUNT[l][_][c][r][a]?(h&&gn.xani_nmounts[l][_].InitAnimaWithName(b+"_"+e+"_"+s+"_飘带",this.aa_mts[5]),M.gi().DrawAnima_aa(t+f,null,i,t+u,this.aa_mts[5]),this.aa_mts[5].NextFrame(),f++):"人前"==N._ANIMASORT_MOUNT[l][_][c][r][a]?(h&&(gn.xani_newrole[o].InitAnimaWithName("骑"+e+"_"+s+"_前",this.aa_bds[0]),this.ChangeColor(o,"骑"+e+"_"+s+"_前",0),n=this.aa_bds[0].pani.iAnimaY(this.aa_bds[0])-30,this.iOffY>n&&(this.iOffY=n)),M.gi().DrawAnima_aa(t+f,null,i,t+u,this.aa_bds[0]),this.DrawColor(o,this.aa_bds[0].iFrame,t+f,i,t+u,0),this.aa_bds[0].NextFrame(),f++):"人后"==N._ANIMASORT_MOUNT[l][_][c][r][a]?(h&&(gn.xani_newrole[o].InitAnimaWithName("骑"+e+"_"+s+"_后",this.aa_bds[1]),this.ChangeColor(o,"骑"+e+"_"+s+"_后",1),n=this.aa_bds[1].pani.iAnimaY(this.aa_bds[1])-30,this.iOffY>n&&(this.iOffY=n)),M.gi().DrawAnima_aa(t+f,null,i,t+u,this.aa_bds[1]),this.DrawColor(o,this.aa_bds[1].iFrame,t+f,i,t+u,1),this.aa_bds[1].NextFrame(),f++):"人左"==N._ANIMASORT_MOUNT[l][_][c][r][a]?(h&&(gn.xani_newrole[o].InitAnimaWithName("骑"+e+"_"+s+"_左",this.aa_bds[2]),this.ChangeColor(o,"骑"+e+"_"+s+"_左",2),n=this.aa_bds[2].pani.iAnimaY(this.aa_bds[2])-30,this.iOffY>n&&(this.iOffY=n)),M.gi().DrawAnima_aa(t+f,null,i,t+u,this.aa_bds[2]),this.DrawColor(o,this.aa_bds[2].iFrame,t+f,i,t+u,2),this.aa_bds[2].NextFrame(),f++):"人右"==N._ANIMASORT_MOUNT[l][_][c][r][a]?(h&&(gn.xani_newrole[o].InitAnimaWithName("骑"+e+"_"+s+"_右",this.aa_bds[3]),this.ChangeColor(o,"骑"+e+"_"+s+"_右",3),n=this.aa_bds[3].pani.iAnimaY(this.aa_bds[3])-30,this.iOffY>n&&(this.iOffY=n)),M.gi().DrawAnima_aa(t+f,null,i,t+u,this.aa_bds[3]),this.DrawColor(o,this.aa_bds[3].iFrame,t+f,i,t+u,3),this.aa_bds[3].NextFrame(),f++):"人"==N._ANIMASORT_MOUNT[l][_][c][r][a]?(h&&(gn.xani_newrole[o].InitAnimaWithName("骑"+e+"_"+s,this.aa_bds[4]),this.ChangeColor(o,"骑"+e+"_"+s,4),n=this.aa_bds[4].pani.iAnimaY(this.aa_bds[4])-30,this.iOffY>n&&(this.iOffY=n)),M.gi().DrawAnima_aa(t+f,null,i,t+u,this.aa_bds[4]),this.DrawColor(o,this.aa_bds[4].iFrame,t+f,i,t+u,4),this.aa_bds[4].NextFrame(),f++):"武器"==N._ANIMASORT_MOUNT[l][_][c][r][a]&&(h&&(this.iWeapTid=this.iDWeapTid,this.iWeapTid>=0&&gn.xani_weap[o][N.WeapFlag(this.iWeapTid)].InitAnimaWithName("骑"+e+"_"+s,this.aa_weapon)),this.iWeapTid>=0&&(yh.bShowWeapon&&M.gi().DrawAnima_aa(t+f,null,i,t+u,this.aa_weapon),this.aa_weapon.NextFrame()),f++)}ChangeColor(i,t,s){var e;if(yh.bShowColor)for(e=0;e<N._CHANGECOLOR[i].length;e++)this.iColor[e]<=0||this.iColor[e]>=6||gn.xani_color[i][this.iColor[e]-1].InitAnimaWithName(N._CHANGECOLOR[i][e]+"_"+t,this.aa_cls[s][e])}DrawColor(i,t,s,e,h,a){var n;if(yh.bShowColor)for(n=0;n<N._CHANGECOLOR[i].length;n++)this.iColor[n]<=0||this.iColor[n]>=6||(this.aa_cls[a][n].iFrame=t,M.gi().DrawAnima_aa(s,null,e,h,this.aa_cls[a][n]))}DrawRole(i,t,s,e,h){var a,n=2*this.iRace+this.iSex,o=xh.face_sti(s),r=xh.stat_sti(e)+0,c=0;for(a=0;a<N._ANIMASORT[n][r][o].length;a++)"人物"==N._ANIMASORT[n][r][o][a]?(h&&(gn.xani_newrole[n].InitAnimaWithName(e+"_"+s,this.aa_body),this.ChangeColor(n,e+"_"+s,0),this.iOffY=this.aa_body.pani.iAnimaY(this.aa_body)-30),M.gi().DrawAnima_aa(t+c,null,i,t,this.aa_body),this.DrawColor(n,this.aa_body.iFrame,t+c,i,t,0),this.aa_body.NextFrame(),c++):"武器"==N._ANIMASORT[n][r][o][a]&&(h&&(this.iWeapTid=this.iDWeapTid,this.iWeapTid>=0&&gn.xani_weap[n][N.WeapFlag(this.iWeapTid)].InitAnimaWithName(e+"_"+s,this.aa_weapon)),this.iWeapTid>=0&&(yh.bShowWeapon&&M.gi().DrawAnima_aa(t+c,null,i,t,this.aa_weapon),this.aa_weapon.NextFrame()),c++)}Draw(){if(!xs.jq.bJQLock()){var i,t=!1;if(this.iDMountsTid!=this.iMountsTid&&(t=!0),this.iMountsTid=this.iDMountsTid,this.iDChangeType!=this.iChangeType&&(t=!0),this.iChangeType=this.iDChangeType,this.iChangeType>0?(t=this.bStatChanged()|t,(t=this.bFaceChanged6()|t)&&(0==this.iFace6?this.sFace6="右":1==this.iFace6?this.sFace6="右下":2==this.iFace6?this.sFace6="左下":3==this.iFace6?this.sFace6="左":4==this.iFace6?this.sFace6="左上":5==this.iFace6&&(this.sFace6="右上"),this.iChangeType>=1e4?gn.xani_pets[this.iChangeType%1e4].InitAnimaWithName("变异_"+this.sStat+"_"+this.sFace6,this.aa_body):gn.xani_pets[this.iChangeType%1e4].InitAnimaWithName(this.sStat+"_"+this.sFace6,this.aa_body),this.iOffY=this.aa_body.pani.iAnimaY(this.aa_body)-30)):this.iMountsTid>0&&0==this.iIsSelling&&yh.bShowMount?(t=this.bWeapChanged()|t,t=this.bFaceChanged8()|t,t=this.bStatChanged()|t):(t=this.bStatChanged()|t,t=this.bFaceChanged8()|t,t=this.bWeapChanged()|t),yh.bShowRole&&this.iFollowPid>0&&yh.bShowFollow){var s=this.iMarks[5][0],e=this.iMarks[5][1],h="";h=0==parseInt(this.iFollowTid/1e3)?"":"变异_",s>this.iX?h+=this.sStat+"_左":h+=this.sStat+"_右",gn.xani_pets[this.iFollowTid%1e3].InitAnimaWithName(h,this.aa_follow),this.aa_follow.SetFrame(gn.iDelay),M.gi().DrawAnima_aa(Ih.gi().iOffy+e,null,Ih.gi().iOffx+s,Ih.gi().iOffy+e,this.aa_follow),G.DrawAura(0,Ih.gi().iOffx+s,Ih.gi().iOffy+e,M.gi(),Ih.gi().iOffy+e-1),M.gi().DrawText_2(Ih.gi().iOffy+e-1,1,Ih.gi().iOffx+s,Ih.gi().iOffy+e+30,this.sFollowName,4294946944,20,1,4278190080)}M.gi().BeginGroup(),(yh.bShowName||H.bInTmpTeam(this.iRid))&&(this.sTitle.length>0&&yh.bShowTitle?(M.gi().DrawText_2(Ih.gi().iOffy+this.iY,1,Ih.gi().iOffx+this.iX,Ih.gi().iOffy+this.iY+20,this.sTitle,4286628095,20,1,4278190080),M.gi().DrawText_2(Ih.gi().iOffy+this.iY,1,Ih.gi().iOffx+this.iX,Ih.gi().iOffy+this.iY+20+20,this.sName,4286644096,20,1,4278190080)):M.gi().DrawText_2(Ih.gi().iOffy+this.iY,1,Ih.gi().iOffx+this.iX,Ih.gi().iOffy+this.iY+30,this.sName,4286644096,20,1,4278190080)),(yh.bShowRole||H.bInTmpTeam(this.iRid))&&(G.DrawAura(this.iAura,Ih.gi().iOffx+this.iX,Ih.gi().iOffy+this.iY,M.gi(),Ih.gi().iOffy+this.iY),this.iChangeType>0?(M.gi().DrawAnima_aa(Ih.gi().iOffy+this.iY,this.aa_body.xani,Ih.gi().iOffx+this.iX,Ih.gi().iOffy+this.iY,this.aa_body),this.aa_body.NextFrame()):this.iMountsTid>0&&0==this.iIsSelling&&yh.bShowMount?this.DrawMounts(Ih.gi().iOffx+this.iX,Ih.gi().iOffy+this.iY,this.sFace8,this.sStat,t):this.DrawRole(Ih.gi().iOffx+this.iX,Ih.gi().iOffy+this.iY,this.sFace8,this.sStat,t),1==this.iIsLeader&&(M.gi().DrawAnima_aa(Ih.gi().iOffy+this.iY,gn.xani_ui,Ih.gi().iOffx+this.iX,Ih.gi().iOffy+this.iY+this.iOffY,this.aa_team),gn.xani_ui.NextFrame(this.aa_team)),1==this.iFighting&&(M.gi().DrawAnima_aa(Ih.gi().iOffy+this.iY,gn.xani_ui,Ih.gi().iOffx+this.iX,Ih.gi().iOffy+this.iY+this.iOffY,this.aa_fighting),gn.xani_ui.NextFrame(this.aa_fighting)),this.DrawPopo(Ih.gi().iOffx+this.iX,Ih.gi().iOffy+this.iY)),1==this.iIsSelling&&yh.bShowSell&&(this.iSellWidth=c.gi().GetTextWidth(this.sSellName,25),(i=(this.iSellWidth-60)/30+2)<2?i=2:i>6&&(i=6),gn.xani_ui2.InitAnimaWithName("普通摊位",gn.aaa),gn.aaa.iFrame=0,M.gi().DrawAnimaEx(Ih.gi().iOffy+this.iY-2,Ih.gi().iOffx+this.iX-this.iSellWidth/2-9,Ih.gi().iOffy+this.iY-140+5,gn.aaa,101,1,1,0,0,0),gn.aaa.iFrame=1,M.gi().DrawAnimaEx(Ih.gi().iOffy+this.iY-2,Ih.gi().iOffx+this.iX-this.iSellWidth/2,Ih.gi().iOffy+this.iY-140+5,gn.aaa,101,1*this.iSellWidth/10,1,0,0,0),gn.aaa.iFrame=2,M.gi().DrawAnimaEx(Ih.gi().iOffy+this.iY-2,Ih.gi().iOffx+this.iX+this.iSellWidth/2,Ih.gi().iOffy+this.iY-140+5,gn.aaa,101,1,1,0,0,0),M.gi().DrawText(Ih.gi().iOffy+this.iY-1,1,Ih.gi().iOffx+this.iX,Ih.gi().iOffy+this.iY-120,this.sSellName,4282433791,25)),M.gi().EndGroup()}}DrawPopo(i,t){if(!(this.iPopoDelay<=0)){this.iPopoDelay--,Y.gi().Format(this.sPopoString,151,25),i-=Y.gi().iW/2;var s=t+this.iOffY+40-Y.gi().iH;M.gi().FillRect(t,i,s,i+Y.gi().iW,s+Y.gi().iH,1342177280),Y.gi().DrawToBuffer(t+1,i,s)}}bWeapChanged(){return!!this.bwc&&(this.bwc=!1,!0)}}class bt extends s{constructor(i){super()}Draw(){ei.end(ei.CONFIRM_BACKTOSCHOOL)&&(ei.bConfirm&&xh.me.rbs.iSchoolId>0&&Ue.gi().FindNpc(bt.iNpcId,!0,!0),ln.gi().PopStat(1))}ProcTouch(i,t,s){return!1}}bt.iNpcId,bt.Open=function(i){ln.gi().PushStat(ln.GS_BACKTOSCHOOL),bt.iNpcId=i.GetNextInt(),ei.start(ei.CONFIRM_BACKTOSCHOOL,i.GetNextString())};class _t{Init(){this.iSelectStat=0}constructor(){this.aa_face=new l,_t.iSelectPage=0,this.btn_up=null,this.btn_down=null}Draw(){var i,t,s;for(null==this.btn_up&&(this.btn_up=new D(gn.xani_button),this.btn_up.bSingleButton=!0,this.btn_up.sName="普通",this.btn_down=new D(gn.xani_button),this.btn_down.bSingleButton=!0,this.btn_down.sName="会员"),this.BW=80,this.BH=80,this.WW=5,this.HH=5,this.iW=this.BW*this.WW,this.iH=this.BH*this.HH+60,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,c.gi().FillRect_2D(this.iX,this.iY,this.iX+this.iW,this.iY+this.iH,2147483648),this.btn_up.Move(this.iX,this.iY+this.BH*this.HH,120,60),this.btn_up.Draw(),this.btn_down.Move(this.iX+120,this.iY+this.BH*this.HH,120,60),this.btn_down.Draw(),i=0;i<this.WW;i++)for(t=0;t<this.HH;t++)s=i+t*this.WW,0==_t.iSelectPage&&s>=0&&s<=21&&(gn.xani_face.InitAnimaWithName("表情"+s,this.aa_face),this.aa_face.SetFrame(gn.iDelay),gn.xani_face.DrawAnima_aa(this.iX+this.BW/2-gn.xani_face.iAnimaW(this.aa_face)/2+i*this.BW,this.iY+this.BH/2-gn.xani_face.iAnimaH(this.aa_face)/2+t*this.BH,this.aa_face)),1==_t.iSelectPage&&s>=0&&s<=12&&(s+=100,gn.xani_face.InitAnimaWithName("表情"+s,this.aa_face),this.aa_face.SetFrame(gn.iDelay),gn.xani_face.DrawAnima_aa(this.iX+this.BW/2-gn.xani_face.iAnimaW(this.aa_face)/2+i*this.BW,this.iY+this.BH/2-gn.xani_face.iAnimaH(this.aa_face)/2+t*this.BH,this.aa_face))}ProcTouch(i,t,s){var e,h,a;if(this.btn_up.ProcTouch(i,t,s)&&this.btn_up.bCheck()&&(_t.iSelectPage=0),this.btn_down.ProcTouch(i,t,s)&&this.btn_down.bCheck()&&(_t.iSelectPage=1),3==i&&!bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH))return this.iSelectStat=10,!0;for(e=0;e<this.WW;e++)for(h=0;h<this.HH;h++)if(a=e+h*this.WW,(0==_t.iSelectPage&&a>=0&&a<=21||1==_t.iSelectPage&&a>=0&&a<=12)&&bn.bInRect(t,s,this.iX+e*this.BW,this.iY+h*this.BH,this.BW,this.BH)&&(this.iSelectPoint=a+100*_t.iSelectPage,3==i))return this.iSelectStat=1,!0;return!1}}_t.iSelectPage,_t.sf=null,_t.gi=function(){return null==_t.sf&&(_t.sf=new _t),_t.sf};class ft{tostr(){for(var i=parseInt(this.iColor,16);i.length<6;)i="0"+i;return i.length>6&&i.substring(i.length-6,i.length),i}Init(i){i>=0&&(this.iColor=i,this.iR=i>>16&255,this.iG=i>>8&255,this.iB=255&i),this.iSelectStat=0}SelectColor(){this.iR=255,this.iG=255,this.iB=255,this.iColor=4294967295}Draw(){var i,t,s,e;null==this.btn_ok&&(this.btn_ok=new D(gn.xani_nui2),this.btn_ok.InitButton("按钮1_110"),this.btn_ok.sName="选择"),this.iW=436,this.iH=378,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,E.new_bigframe(this.iX,this.iY,this.iW,this.iH),s=this.iX+25,e=this.iY+25,i=4278190080|this.iB,t=15,c.gi().FillRect_2D_ex(s,e,s+256,e+256,i,65280|i,16776960|i,16711680|i),c.gi().DrawCircle(s+this.iR,e+255-this.iG,16,16,4278190080),c.gi().DrawCircle(s+this.iR,e+255-this.iG,t,t,4294967295),c.gi().DrawCircle(s+this.iR,e+255-this.iG,14,14,4278190080),s+=276,i=4278190080|this.iR<<16|this.iG<<8,c.gi().FillRect_2D_ex(s,e,s+110,e+256,i,255|i,255|i,i),c.gi().DrawCircle(s+35,e+255-this.iB,16,16,4278190080),c.gi().DrawCircle(s+35,e+255-this.iB,t,t,4294967295),c.gi().DrawCircle(s+35,e+255-this.iB,14,14,4278190080),s=this.iX+25,e=this.iY+25+256+20,c.gi().FillRect_2D(s+80,e,s+256,e+52,4278190080|this.iColor),c.gi().DrawTextEx(s,e+26,"颜色：",4278206039,30,101,1,1,0,0,-2),s=this.iX+25+256+20,e=this.iY+25+256+20,this.btn_ok.Move(s,e,110,52),this.btn_ok.Draw()}ProcTouch(i,t,s){return 3!=i||bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)?this.btn_ok.ProcTouch(i,t,s)?!!this.btn_ok.bCheck()&&(this.iSelectStat=1,!0):(bn.bInRect(t,s,this.iX+25,this.iY+25,256,256)&&(this.iR=t-(this.iX+25),this.iG=255-(s-(this.iY+25)),this.iColor=this.iR<<16|this.iG<<8|this.iB),bn.bInRect(t,s,this.iX+25+256+20,this.iY+25,70,256)&&(this.iB=255-(s-(this.iY+25)),this.iColor=this.iR<<16|this.iG<<8|this.iB),!1):(this.iSelectStat=10,!0)}}ft.sc=new ft;class ut extends s{constructor(i){var t;if(super(),this.pani=i,this.pm3f=i.pm3f,this.iW=310,this.iH=50*Bi.mp.iPetCount+40,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,null==this.btn_sel)for(this.btn_sel=new Array(Bi.mp.iPetCount),t=0;t<Bi.mp.iPetCount;t++)this.btn_sel[t]=new Eh(gn.xani_button),this.btn_sel[t].InitButton("3号按钮250_42"),this.btn_sel[t].Move(this.iX+30,this.iY+20+50*t,250,42),this.btn_sel[t].sName=Bi.mp.pets[t].sName}Draw(){var i;for(E.frame_type4("10号框20_20",this.iX,this.iY,this.iW,this.iH,20,20),i=0;i<Bi.mp.iPetCount;i++)this.btn_sel[i].Draw()}ProcTouch(i,t,s){var e;for(e=0;e<Bi.mp.iPetCount;e++)if(this.btn_sel[e].ProcTouch(i,t,s))return this.btn_sel[e].bCheck()&&(0==ut.iType?$t.AddPet(Bi.mp.pets[e]):1==ut.iType&&dt.AddPet(Bi.mp.pets[e]),ln.gi().PopStat(1)),!0;return 3!=i||bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||ln.gi().PopStat(1),!1}}ut.iType=0,ut.Open=function(i){Bi.mp.iPetCount<=0?L.easymsg.AddMessage("当前没有宠物"):(ut.iType=i,ln.gi().PushStat(ln.GS_SELECTPET))};class dt extends s{constructor(i){if(super(),this.bSend=!1,this.bSelectColor=!1,this.bSelectFace=!1,this.btn_voice=new Eh(gn.xani_button),this.btn_voice.InitButton("发送语音"),this.btn_face=new Eh(gn.xani_button),this.btn_face.InitButton("发送表情"),this.btn_goods=new Eh(gn.xani_button),this.btn_goods.InitButton("发送物品"),this.btn_pet=new Eh(gn.xani_button),this.btn_pet.InitButton("发送宠物"),this.btn_team=new Eh(gn.xani_button),this.btn_team.InitButton("发送队伍"),this.btn_send=new Eh(gn.xani_button),this.btn_send.InitButton("发送聊天按钮"),this.btn_send.sName="发送",this.btn_record=new Eh(gn.xani_button),this.btn_record.InitButton("发送聊天按钮"),this.btn_record.sName="记录",this.btn_watch=new Eh(gn.xani_button),this.btn_watch.InitButton("发送聊天按钮"),this.btn_watch.sName="查看",null==dt.in_speak&&(dt.in_speak=new pi(gn.xani_nui3),dt.in_speak.bHideText=!0),dt.in_speak.sDetail="",this.ResetSize(),null==dt.cext){dt.cext=new Array(5);for(var t=0;t<5;t++)dt.cext[t]=new V;dt.ClearCext()}this.iCurrentColor=16777215,this.iRecordStat=0,this.iRecordingShow=0,this.iRecordDelay=0,this.iScrollY=0}ResetSize(){this.iW=590,0==ph.iPrivateChatMode?(this.iH=360,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2-50,dt.in_speak.Move(this.iX+25,this.iY+25+60+10,this.iW-50,this.iH-25-65-10-25-60-10),this.btn_voice.Move(this.iX+25,this.iY+this.iH-25-65,64,65),this.btn_face.Move(this.iX+25+150,this.iY+this.iH-25-65,64,65),this.btn_goods.Move(this.iX+25+225,this.iY+this.iH-25-65,64,65),this.btn_pet.Move(this.iX+25+300,this.iY+this.iH-25-65,64,65),this.btn_team.Move(this.iX+25+375,this.iY+this.iH-25-65,64,65),this.btn_send.Move(this.iX+this.iW-90-25,this.iY+this.iH-25-65+2,90,60),this.btn_record.Move(this.iX+this.iW-90-25,this.iY+25,90,60),this.btn_watch.Move(this.iX+this.iW-90-25-90-10,this.iY+25,90,60)):(this.iH=h.SCRH,this.iX=(h.SCRW-this.iW)/2,this.iY=0,dt.in_speak.Move(this.iX+25,this.iY+this.iH-20-65-10-100,this.iW-50,100),this.btn_voice.Move(this.iX+25,this.iY+this.iH-20-65,64,65),this.btn_face.Move(this.iX+25+150,this.iY+this.iH-20-65,64,65),this.btn_goods.Move(this.iX+25+225,this.iY+this.iH-20-65,64,65),this.btn_pet.Move(this.iX+25+300,this.iY+this.iH-20-65,64,65),this.btn_team.Move(this.iX+25+375,this.iY+this.iH-20-65,64,65),this.btn_send.Move(this.iX+this.iW-90-25,this.iY+this.iH-20-65+2,90,60),this.btn_record.Move(this.iX+this.iW-90-25,this.iY+20,90,60),this.btn_watch.Move(this.iX+this.iW-90-25-90-10,this.iY+20,90,60))}DrawSelect(i,t,s){var e;for(e=0;e<5;e++)switch(s.exts[e].type){case 0:case 1:case 2:if(s.lrs_small[e].CopyFrom(Y.gi().lrs[e]),s.exts[e].iShowDelay>0){for(var h=0;h<s.lrs_small[e].iCount;h++){var a=i+s.lrs_small[e].rs[h].iX,n=t+s.lrs_small[e].rs[h].iY,o=i+s.lrs_small[e].rs[h].iX+s.lrs_small[e].rs[h].iW,r=t+s.lrs_small[e].rs[h].iY+s.lrs_small[e].rs[h].iH;c.gi().FillRect_2D(a,n,o,r,16711935|s.exts[e].iShowDelay<<24)}s.exts[e].iShowDelay>200?s.exts[e].iShowDelay-=3:s.exts[e].iShowDelay>150?s.exts[e].iShowDelay-=6:s.exts[e].iShowDelay>100?s.exts[e].iShowDelay-=9:s.exts[e].iShowDelay>50?s.exts[e].iShowDelay-=12:s.exts[e].iShowDelay=0}}}DrawPms(i,t,s,h){var a,n="#c176b51"+h.sDetail;for(a=1;a<5;a++)switch(h.exts[a].type){case 0:n=Y.gi().InsertLocker(a,n,"["+gn.de_goods.strValue(h.exts[a].tid,0,4)+"]",e.EXTCOLOR,"#c00c000");break;case 1:n=Y.gi().InsertLocker(a,n,"["+gn.de_pet.strValue(h.exts[a].tid,0,1)+"]",e.EXTCOLOR,"#c00c000");break;case 2:n=Y.gi().InsertLocker(a,n,"[语音:"+h.exts[a].detail+"]",e.EXTCOLOR,"#c00c000")}for(Y.gi().Format(n,s-90,yh.WordSize(24)),Y.gi().CheckOutRect(),a=0;a<5;a++)switch(h.exts[a].type){case 0:case 1:case 2:case 3:h.lrs_small[a].CopyFrom(Y.gi().lrs[a])}var o=Y.gi().iH+10+10;o<52&&(o=52);var r=t-o;return h.iRid==xh.me.iRid?(h.ox=i+s-52-10-Y.gi().iW-10,h.oy=r+10,h.ow=Y.gi().iW,h.oh=Y.gi().iH,h.headx=i+s-52,h.heady=r,gn.xani_head.DrawAnimaEx(i+s-52,r,"新头像"+h.iRax,0,101,.65,.65,0,0,0),E.frame_type4("聊天内容框20_20",i+s-52-10-(Y.gi().iW+20),r,Y.gi().iW+20,Y.gi().iH+20,20,20),gn.xani_frame.DrawAnima(i+s-52-10,r+10,"聊天内容框20_20",10),this.DrawSelect(i+s-52-10-Y.gi().iW-10,r+10,h),Y.gi().Draw(i+s-52-10-Y.gi().iW-10,r+10)):(h.ox=i+52+10+10,h.oy=r+10,h.ow=Y.gi().iW,h.oh=Y.gi().iH,h.headx=i,h.heady=r,gn.xani_head.DrawAnimaEx(i,r,"新头像"+h.iRax,0,101,.65,.65,0,0,0),E.frame_type4("聊天内容框20_20",i+52+10,r,Y.gi().iW+20,Y.gi().iH+20,20,20),gn.xani_frame.DrawAnima(i+52+10,r+10,"聊天内容框20_20",9),this.DrawSelect(i+52+10+10,r+10,h),Y.gi().Draw(i+52+10+10,r+10)),o}DrawMessage(i,t,s,e){var h;i+=10,t+=10,s-=20,e-=20,this.iMx=i,this.iMy=t,this.iMw=s,this.iMh=e;var a=t+e+this.iScrollY,n=dh.gi();for(h=0;h<n.iMessageCount;h++)n.pms[h].ox=-1;for(c.gi().SetViewClip(i,t,i+s,t+e),h=0;h<n.iMessageCount;h++){if(n.pms[h].iRid==dt.iRid);else if(n.pms[h].iRid!=xh.me.iRid||n.pms[h].iDRid!=dt.iRid)continue;if(0==n.pms[h].bWatched&&(n.pms[h].bWatched=!0,gn.x_record.SavePrivateChat(),Mh.gi().s_ReviewPrivateChat(n.pms[h].iSession)),(a-=this.DrawPms(i,a,s,n.pms[h])+5)<=t)break}h<n.iMessageCount?this.bCanScroll=!0:this.bCanScroll=!1,c.gi().NoClip()}Draw(){dt.in_speak.onscr(),E.frame_type4("中等框a52_50",this.iX,this.iY,this.iW,this.iH,52,50),E.frame_type4("聊天显示框亮20_20",dt.in_speak.iX,dt.in_speak.iY,dt.in_speak.iW,dt.in_speak.iH,20,20),0==ph.iPrivateChatMode?(gn.xani_head.DrawAnimaEx(this.iX+25,this.iY+25,"新头像"+dt.iRax,0,101,.75,.75,0,0,0),1e4==dt.iRid?c.gi().DrawTextEx(this.iX+25+65,this.iY+25,"帮派群发:"+dt.sName,4278190080,30,101,1,1,0,0,0):c.gi().DrawTextEx(this.iX+25+65,this.iY+25,"名字:"+dt.sName,4278190080,30,101,1,1,0,0,0),c.gi().DrawTextEx(this.iX+25+65,this.iY+25+35+5,"号码:"+dt.iRid,4278190080,25,101,1,1,0,0,0)):(gn.xani_head.DrawAnimaEx(this.iX+25,this.iY+20,"新头像"+dt.iRax,0,101,.75,.75,0,0,0),1e4==dt.iRid?c.gi().DrawTextEx(this.iX+25+65,this.iY+20,"帮派群发:"+dt.sName,4278190080,30,101,1,1,0,0,0):c.gi().DrawTextEx(this.iX+25+65,this.iY+20,"名字:"+dt.sName,4278190080,30,101,1,1,0,0,0),c.gi().DrawTextEx(this.iX+25+65,this.iY+20+35+5,"号码:"+dt.iRid,4278190080,25,101,1,1,0,0,0),E.frame_type4("聊天显示框暗20_20",this.iX+25,this.iY+20+60+10,this.iW-50,this.iH-20-60-10-20-65-10-100-10,20,20),this.DrawMessage(this.iX+25,this.iY+20+60+10,this.iW-50,this.iH-20-60-10-20-65-10-100-10));for(var i="#c176b51"+dt.in_speak.sDetail,t=0;t<4;t++)dt.cext[t].type>=100||(i.indexOf("#x"+(t+1))>=0?i=3==t?i.replace("#x"+(t+1),"#c00c000[语音:"+dt.cext[t].detail+"]#o"):i.replace("#x"+(t+1),"#c00c000["+dt.cext[t].name+"]#o"):dt.cext[t].type=100);switch(Y.gi().FormatEx(i,dt.in_speak.iW-30,29,0,0,35),Y.gi().Draw(dt.in_speak.iX+15,dt.in_speak.iY+10),this.btn_voice.Draw(),this.btn_face.Draw(),this.btn_goods.Draw(),this.btn_pet.Draw(),this.btn_team.Draw(),this.btn_send.Draw(),this.btn_record.Draw(),this.btn_watch.Draw(),this.bSelectFace&&_t.gi().Draw(),this.iRecordStat){case 0:break;case 1:E.frame_type4("语音输入背景20_20",h.SCRW/2-120,h.SCRH/2-120,240,305,20,20),E.frame_type1("语音输入字底框20_35",h.SCRW/2-100,h.SCRH/2+100+20,200,20);var s=h.SCRW/2-100,a=h.SCRH/2+100+20;c.gi().FillRect_2D(s,a,s+200*(e.VOICETIMEOUT-this.iRecordDelay)/e.VOICETIMEOUT,a+35,822083583),1==this.iRecordingShow?(gn.xani_other.DrawAnima(h.SCRW/2-100,h.SCRH/2-100,"录音中",0),c.gi().DrawTextEx(h.SCRW/2,h.SCRH/2+100+20+17.5,"手指划开，取消录制",4294967295,18,101,1,1,0,-2,-2)):2==this.iRecordingShow&&(gn.xani_other.DrawAnima(h.SCRW/2-100,h.SCRH/2-100,"移开手指",0),c.gi().DrawTextEx(h.SCRW/2,h.SCRH/2+100+20+17.5,"手指划开，取消发送",4294967295,18,101,1,1,0,-2,-2));break;case 2:if("empty"!=gn.m_vi.sRecordName){if(gn.m_vi.iRecordTime<=1e3){L.easymsg.AddMessage("录音时间太短"),this.iRecordStat=0;break}this.iRecordDelay=e.VOICETIMEOUT,dt.cext[3].type=2,dt.cext[3].eid=gn.m_vi.iRecordTime,-1==dt.in_speak.sDetail.indexOf("#x4")&&(dt.in_speak.sDetail+="#x4",dt.in_speak.OpenInput()),dt.cext[3].name="",dt.cext[3].detail="",gn.m_vi.UpLoad(),this.iRecordStat=3}break;case 3:"empty"!=gn.m_vi.sUrlName&&(this.iRecordDelay=e.VOICETIMEOUT,dt.cext[3].name=gn.m_vi.sUrlName,gn.m_vi.StartRecognize(),this.iRecordStat=4);break;case 4:"empty"!=gn.m_vi.sRecognizeResult&&(dt.cext[3].detail=gn.m_vi.sRecognizeResult,this.iRecordStat=0)}this.iRecordStat>0&&(this.iRecordDelay--,this.iRecordDelay<=0&&(this.iRecordStat=0,gn.m_vi.StopRecord(),L.easymsg.AddMessage("录音超时取消"))),this.bSend&&0==this.iRecordStat&&(this.bSend=!1,this.SendMessage())}ProcTouch(i,t,s){if(this.bSelectFace)return _t.gi().ProcTouch(i,t,s)&&0!=_t.gi().iSelectStat&&(1==_t.gi().iSelectStat&&(dt.in_speak.sDetail+="#f"+_t.gi().iSelectPoint,dt.in_speak.OpenInput()),this.bSelectFace=!1),!0;if(this.bSelectColor)return ft.sc.ProcTouch(i,t,s)&&0!=ft.sc.iSelectStat&&(1==ft.sc.iSelectStat&&(dt.in_speak.sDetail+="#c"+ft.sc.tostr(),this.iCurrentColor=ft.sc.iColor,dt.in_speak.OpenInput()),this.bSelectColor=!1),!0;if(this.btn_face.ProcTouch(i,t,s))return this.btn_face.bCheck()&&(this.bSelectFace=!0,_t.gi().Init()),!0;if(this.btn_record.ProcTouch(i,t,s))return this.btn_record.bCheck()&&(0==ph.iPrivateChatMode?ph.iPrivateChatMode=1:ph.iPrivateChatMode=0,this.ResetSize()),!0;if(this.btn_watch.ProcTouch(i,t,s))return this.btn_watch.bCheck()&&Mh.gi().s_WatchOn(0,dt.iRid,0,""),!0;if(this.btn_goods.ProcTouch(i,t,s))return this.btn_goods.bCheck()&&pt.Open(1),!0;if(this.btn_pet.ProcTouch(i,t,s))return this.btn_pet.bCheck()&&ut.Open(1),!0;if(this.btn_team.ProcTouch(i,t,s))return this.btn_team.bCheck()&&dt.AddTeam(),!0;if(bn.bInRect(t,s,this.btn_voice.iX,this.btn_voice.iY,this.btn_voice.iW,this.btn_voice.iH)){if(1==i){if(0==this.iRecordStat){if(!gn.m_vi.StartRecord())return L.easymsg.AddMessage("启动录音失败"),!0;this.iRecordStat=1,this.iRecordDelay=e.VOICETIMEOUT}}else 3==i&&1==this.iRecordStat&&(gn.m_vi.StopRecord(),this.iRecordStat=2);return this.iRecordingShow=1,!0}if(1==this.iRecordStat)return 3==i&&(gn.m_vi.StopRecord(),this.iRecordStat=0),this.iRecordingShow=2,!0;if(this.iRecordingShow=0,dt.in_speak.ProcTouch(i,t,s),this.btn_send.ProcTouch(i,t,s))return this.btn_send.bCheck()&&(this.bSend=!0,0!=this.iRecordStat&&L.easymsg.AddMessage("正在处理中，请稍后...")),!0;if(1==ph.iPrivateChatMode){if(3==i){var h,a,n=dh.gi();for(h=0;h<n.iMessageCount;h++)if(-1!=n.pms[h].ox&&(bn.bInRect(t,s,n.pms[h].headx,n.pms[h].heady,52,52)&&n.pms[h].iRid>1e3&&Mh.gi().s_WatchOn(0,n.pms[h].iRid,0,""),bn.bInRect(t,s,n.pms[h].ox,n.pms[h].oy,n.pms[h].ow,n.pms[h].oh)))for(a=1;a<5;a++)if(!(n.pms[h].exts[a].type>=100)&&!(n.pms[h].exts[a].iShowDelay>0)&&n.pms[h].lrs_small[a].bIn(t-n.pms[h].ox,s-n.pms[h].oy))switch(n.pms[h].exts[a].type){case 0:Mh.gi().s_WatchOn(1,n.pms[h].exts[a].eid,0,""),n.pms[h].exts[a].iShowDelay=255;break;case 1:Mh.gi().s_WatchOn(2,n.pms[h].exts[a].eid,0,""),n.pms[h].exts[a].iShowDelay=255;break;case 2:gn.m_vi.PlayUrlVoice(n.pms[h].exts[a].name),n.pms[h].exts[a].iShowDelay=255}}bn.bInRect(t,s,this.iMx,this.iMy,this.iMw,this.iMh)&&1==i&&(this.bScrolling=!0,this.iLockY=s),this.bScrolling&&(2==i&&(s>this.iLockY?this.bCanScroll&&(this.iScrollY+=s-this.iLockY):this.iScrollY+=s-this.iLockY,this.iScrollY<0&&(this.iScrollY=0),this.iLockY=s),3==i&&(this.bScrolling=!1))}return 3!=i||bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||ln.gi().PopStat(1),!1}SendMessage(){if(dt.in_speak.sDetail.length>100)L.easymsg.AddMessage("文字太长"),dt.in_speak.sDetail="";else if(dt.in_speak.sDetail.length>0){for(var i=dt.in_speak.sDetail,t=0;t<4;t++)dt.cext[t].type>=100||(i.indexOf("#x"+(t+1))>=0?i=3==t?i.replace("#x"+(t+1),e.EXTCOLOR+"[语音:"+dt.cext[t].detail+"]#o"):i.replace("#x"+(t+1),e.EXTCOLOR+"["+dt.cext[t].name+"]#o"):dt.cext[t].type=100);Mh.gi().s_PrivateChat(dt.iRid,dt.sName,i),uh.gi().Close(),uh.gi().AddTmpChat(dt.iRid,dt.sName,dt.iRax),dt.in_speak.sDetail="",dt.in_speak.OpenInput(),dt.ClearCext(),0==ph.iPrivateChatMode&&ln.gi().PopStat(1)}else L.easymsg.AddMessage("请先输入文字")}}dt.iRid,dt.sName,dt.iRax,dt.in_speak=null,dt.cext=null,dt.AddTeam=function(){var i;if(H.bTeamLeader()){for(null==dt.cext&&dt.ClearCext(),i=0;i<3;i++)if(100==dt.cext[i].type)return dt.cext[i].type=4,dt.cext[i].eid=xh.me.iRid,dt.cext[i].tid=0,dt.cext[i].name="申请入队",dt.in_speak.sDetail+="#x"+(i+1),void dt.in_speak.OpenInput();L.easymsg.AddMessage("最多添加3个发送项目")}else L.easymsg.AddMessage("队长才能添加")},dt.AddGoods=function(i){var t;for(null==dt.cext&&dt.ClearCext(),t=0;t<3;t++)if(100==dt.cext[t].type)return dt.cext[t].type=0,dt.cext[t].eid=i.iGid,dt.cext[t].tid=i.iTid,dt.cext[t].name=gn.de_goods.strValue(i.iTid,0,4),dt.in_speak.sDetail+="#x"+(t+1),void dt.in_speak.OpenInput();L.easymsg.AddMessage("最多添加3个物品或宠物")},dt.AddPet=function(i){var t;for(null==dt.cext&&dt.ClearCext(),t=0;t<3;t++)if(100==dt.cext[t].type)return dt.cext[t].type=1,dt.cext[t].eid=i.iPid,dt.cext[t].tid=i.iTid,dt.cext[t].name=gn.de_pet.strValue(i.iTid,0,1),dt.in_speak.sDetail+="#x"+(t+1),void dt.in_speak.OpenInput();L.easymsg.AddMessage("最多添加3个物品或宠物")},dt.OpenChat=function(i,t,s){dt.iRid=i,dt.sName=t,dt.iRax=s,(dt.iRax<0||dt.iRax>6)&&(dt.iRax=6),ln.gi().PushStat(ln.GS_PRIVATECHAT)},dt.ClearCext=function(){if(null==dt.cext){dt.cext=new Array(5);for(var i=0;i<5;i++)dt.cext[i]=new V}for(i=0;i<5;i++)dt.cext[i].type=100};class pt extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=490,this.iH=472,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_sel=new Eh(gn.xani_nui2),this.btn_sel.InitButton("按钮1_110"),this.btn_sel.sName="选择",this.btn_sel.Move(this.iX+this.iW-110-30,this.iY+this.iH-52-30,110,52),this.lockgoods=null}Draw(){E.new_bigframe(this.iX,this.iY,this.iW,this.iH),qi.new_DrawGoods(this.iX+30,this.iY+30,ht.gi().goods[2],null,null),c.gi().DrawTextEx(this.iX+30,this.iY+this.iH-30-26,"选择物品添加到聊天",4278206039,30,101,1,1,0,0,-2),null!=this.lockgoods&&(qi.new_DrawRect(this.iX+30,this.iY+30,ht.gi().goods[2],this.lockgoods,0),this.btn_sel.Draw()),qi.bShowDetail()&&qi.new_DrawDetail(null,-1,-1,0)}ProcTouch(i,t,s){return null!=this.lockgoods&&this.btn_sel.ProcTouch(i,t,s)?(this.btn_sel.bCheck()&&(0==pt.iType?$t.AddGoods(this.lockgoods):1==pt.iType&&dt.AddGoods(this.lockgoods),ln.gi().PopStat(1)),!0):(this.lockgoods=qi.new_LockGoods(t,s,this.iX+30,this.iY+30,ht.gi().goods[2],i),qi.NoMove(),3!=i||bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||ln.gi().PopStat(1),!1)}}pt.iType=0,pt.Open=function(i){pt.iType=i,ln.gi().PushStat(ln.GS_SELECTGOODS)};class mt{constructor(){}Init3(i,t,s,e){var h;for(this.iType=3,this.iCount=e,this.starlist=new Array(this.iCount),h=0;h<this.iCount;h++)this.starlist[h]=new Int32Array(4);for(this.iX=i,this.iY=t,this.iR=s,this.iNowX=i,this.iNowY=t,h=0;h<this.iCount;h++)this.starlist[h][0]=-1;this.iStat=0,this.fJd=0}Init1(i,t,s,e,h){var a;for(this.iType=1,this.iCount=h,this.starlist=new Array(this.iCount),this.iX=i,this.iY=t,this.iW=s,this.iH=e,this.iNowX=i,this.iNowY=t,a=0;a<this.iCount;a++)this.starlist[a]=new Int32Array(3),this.starlist[a][0]=-1;this.iStat=0}Init2(i,t,s,e){var h;for(this.iType=2,this.iCount=e,this.starlist=new Array(this.iCount),this.iX=i,this.iY=t,this.iR=s,h=0;h<this.iCount;h++)this.starlist[h]=new Int32Array(3),this.starlist[h][0]=-1}Logic(){var i,t,s,e,h;if(1==this.iType){for(t=0,s=2,i=0;i<this.iCount&&!(-1==this.starlist[i][0]&&(this.starlist[i][0]=12,this.starlist[i][1]=bn.GetRand(0,2*t)+this.iNowX-t,this.starlist[i][2]=bn.GetRand(0,2*t)+this.iNowY-t,++s>=2));i++);for(i=0;i<this.iCount;i++)this.starlist[i][0]>=0&&(this.starlist[i][0]++,this.starlist[i][0]>=40&&(this.starlist[i][0]=-1));switch(t=10,this.iStat){case 0:this.iNowY<this.iY+this.iH?this.iNowY+=t:this.iStat=1;break;case 1:this.iNowX<this.iX+this.iW?this.iNowX+=t:this.iStat=2;break;case 2:this.iNowY>this.iY?this.iNowY-=t:this.iStat=3;break;case 3:this.iNowX>this.iX?this.iNowX-=t:this.iStat=0}}else if(2==this.iType){if(gn.iDelay%2==0)for(i=0;i<this.iCount;i++)if(-1==this.starlist[i][0]){this.starlist[i][0]=0;do{e=bn.GetRand(0,2*this.iR)-this.iR,h=bn.GetRand(0,2*this.iR)-this.iR}while(e*e+h*h>this.iR*this.iR);this.starlist[i][1]=e,this.starlist[i][2]=h/2;break}}else if(3==this.iType){for(this.fJd+=.15,t=0,s=0,i=0;i<this.iCount&&!(-1==this.starlist[i][0]&&(this.starlist[i][0]=16,this.starlist[i][1]=this.iX+Math.sin(this.fJd+.1*s)*(this.iR+s)+bn.GetRand(0,2*t)-t,this.starlist[i][2]=this.iY+Math.cos(this.fJd+.1*s)*(this.iR+s)+bn.GetRand(0,2*t)-t,this.starlist[i][3]=bn.GetRand(0,360),++s>=1));i++);for(i=0;i<this.iCount;i++)this.starlist[i][0]>=0&&(this.starlist[i][0]++,this.starlist[i][0]>=40&&(this.starlist[i][0]=-1))}}Draw(i,t){var s,e,h;if(1==this.iType){for(s=0;s<this.iCount;s++)this.starlist[s][0]>=0&&gn.xani_nui1.DrawAnimaEx(i+this.starlist[s][1],t+this.starlist[s][2],"黄金星光",this.starlist[s][0]/2,101,1,1,0,0,0);for(s=0;s<this.iCount;s++)this.starlist[s][0]>=0&&gn.xani_nui1.DrawAnimaEx(i+this.starlist[s][1],t+this.starlist[s][2],"星星心",this.starlist[s][0]/2,101,1,1,0,0,0)}else if(2==this.iType){if(gn.iDelay%2==0)for(s=0;s<this.iCount;s++)if(-1==this.starlist[s][0]){this.starlist[s][0]=0;do{e=bn.GetRand(0,2*this.iR)-this.iR,h=bn.GetRand(0,2*this.iR)-this.iR}while(e*e+h*h>this.iR*this.iR);this.starlist[s][1]=e,this.starlist[s][2]=h/2;break}for(s=0;s<this.iCount;s++)this.starlist[s][0]>=0&&this.starlist[s][2]<0&&(gn.xani_nui1.DrawAnimaEx(i+this.starlist[s][1],t+this.starlist[s][2],"单线",this.starlist[s][0]/2,101,1,.5,0,0,0),this.starlist[s][0]++,this.starlist[s][0]>=18&&(this.starlist[s][0]=-1))}else if(3==this.iType){for(s=0;s<this.iCount;s++)this.starlist[s][0]>=0&&gn.xani_nui1.DrawAnimaEx(i+this.starlist[s][1],t+this.starlist[s][2],"黄金星光",this.starlist[s][0]/2,101,1,1,0,0,0);for(s=0;s<this.iCount;s++)this.starlist[s][0]>=0&&gn.xani_nui1.DrawAnimaEx(i+this.starlist[s][1],t+this.starlist[s][2],"星星心",this.starlist[s][0]/2,101,1,1,this.starlist[s][3],i+this.starlist[s][1],t+this.starlist[s][2])}}DrawFront(i,t){var s;if(2==this.iType)for(s=0;s<this.iCount;s++)this.starlist[s][0]>=0&&this.starlist[s][2]>=0&&(gn.xani_nui1.DrawAnimaEx(i+this.starlist[s][1],t+this.starlist[s][2],"单线",this.starlist[s][0]/2,101,1,.5,0,0,0),this.starlist[s][0]++,this.starlist[s][0]>=18&&(this.starlist[s][0]=-1))}}class gt extends s{constructor(i){super(),this.btn_start=new Eh(gn.xani_nui2),this.btn_start.InitButton("按钮1"),this.btn_start.sName="立刻参加",this.btn_later=new Eh(gn.xani_nui2),this.btn_later.InitButton("按钮1"),this.btn_later.sName="稍后再去",this.iW=800,this.iH=500,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2}Draw(){E.new_bigframe(this.iX,this.iY,this.iW,this.iH),c.gi().DrawTextEx(this.iX+this.iW/2,this.iY+30,"趣味答题",4278206039,40,101,1,1,0,-2,0),c.gi().DrawTextEx(this.iX+this.iW/2,this.iY+30+50,"答题活动已经开启，少侠是否参加？",4278206039,30,101,1,1,0,-2,0),c.gi().DrawTextEx(this.iX+this.iW/2,this.iY+30+50+40,"(活动时间12:00:00~13:00:00)",4278206039,30,101,1,1,0,-2,0),Y.gi().FormatEx("#c003e57活动介绍：#e1，共15道题，每次答对可获得经验和绑铜奖励，每题限20秒内回答#e2，累计答错3题计算为失败#e3，完成答题（至少答对12个），可参与额外抽奖#e3，答题途中离开答题页面视为放弃活动，计算为失败",this.iW-60,30,0,0,35),Y.gi().Draw(this.iX+30,this.iY+30+50+40+40),this.btn_start.Move(this.iX+40,this.iY+this.iH-40-53,161,53),this.btn_start.Draw(),this.btn_later.Move(this.iX+this.iW-40-161,this.iY+this.iH-40-53,161,53),this.btn_later.Draw()}ProcTouch(i,t,s){return this.btn_start.ProcTouch(i,t,s)?(this.btn_start.bCheck()&&(ws.bFighting?Z.fm.Open("战斗中不能开始答题活动，请在战斗结束后，点击答题图标重新参与"):H.bInTeam()?Z.fm.Open("队伍中不能开始答题活动，请离开队伍后，点击答题图标重新参与"):(gt.bShow=!1,Mh.gi().s_AfternoooQuestion(0,0,0)),ln.gi().PopStat(1)),!0):!!this.btn_later.ProcTouch(i,t,s)&&(this.btn_later.bCheck()&&ln.gi().PopStat(1),!0)}}gt.bShow=!1,gt.Open=function(){ln.gi().PushStat(ln.GS_AQSTART)};class wt{constructor(){}}wt.OpenCreate=function(i){var t,s;for(ln.gi().iXStat==ln.GS_LOADING1&&ln.gi().PopStat(1),(s=ln.gi().iXStat==ln.GS_CREATEFUBEN?ln.gi().LastStat(0):ln.gi().PushStat(ln.GS_CREATEFUBEN)).iCount=i.GetNextByte(),t=0;t<s.iCount;t++)s.ifblist[t]=i.GetNextInt()},wt.OpenManage=function(i){var t,s;for(ln.gi().iXStat==ln.GS_LOADING1&&ln.gi().PopStat(1),(s=ln.gi().iXStat==ln.GS_MANAGEFUBEN?ln.gi().LastStat(0):ln.gi().PushStat(ln.GS_MANAGEFUBEN)).fuben.iFid=i.GetNextInt(),s.fuben.iType=i.GetNextByte(),s.fuben.iRid=i.GetNextInt(),s.fuben.sName=i.GetNextString(),s.fuben.iLev=i.GetNextShort(),s.fuben.ras=i.GetNextByte(),s.fuben.tm=i.GetNextString(),s.fuben.sDetail=i.GetNextString(),s.fuben.iOnLine=i.GetNextByte(),i.GetNextByte(),s.iMemberCount=i.GetNextShort(),t=0;t<s.iMemberCount;t++)s.members[t].sName=i.GetNextString(),s.members[t].iRid=i.GetNextInt(),s.members[t].iOnLine=i.GetNextByte();for(s.iApplyCount=i.GetNextShort(),t=0;t<s.iApplyCount;t++)s.applyers[t].sName=i.GetNextString(),s.applyers[t].iRid=i.GetNextInt(),s.applyers[t].iOnLine=i.GetNextByte()},wt.OpenApply=function(i){var t,s;for(ln.gi().iXStat==ln.GS_LOADING1&&ln.gi().PopStat(1),(s=ln.gi().iXStat==ln.GS_APPLYFUBEN?ln.gi().LastStat(0):ln.gi().PushStat(ln.GS_APPLYFUBEN)).iTotalLine=i.GetNextShort(),s.iPage=i.GetNextByte(),s.iCount=i.GetNextByte(),s.iTotalPage=(s.iTotalLine-1)/10+1,t=0;t<s.iCount;t++)s.fblist[t].iFid=i.GetNextInt(),s.fblist[t].iType=i.GetNextByte(),s.fblist[t].iRid=i.GetNextInt(),s.fblist[t].sName=i.GetNextString(),s.fblist[t].iLev=i.GetNextShort(),s.fblist[t].ras=i.GetNextByte(),s.fblist[t].tm=i.GetNextString(),s.fblist[t].sDetail=i.GetNextString(),s.fblist[t].iOnLine=i.GetNextByte()},wt.iStat=0,wt.iFbid,wt.iFbType,wt.iHead,wt.iFbProc,wt.GetStat=function(i){wt.iStat=i.GetNextShort(),wt.iFbid=i.GetNextInt(),wt.iFbType=i.GetNextInt(),wt.iHead=i.GetNextInt(),wt.iFbProc=i.GetNextInt()},wt.sDetail,wt.sTarget,wt.GetTarget=function(i){wt.sDetail=i.GetNextString(),wt.sTarget=i.GetNextString(),Z.fm.Open("#cffffff"+wt.sDetail+"#e#c00ff00"+wt.sTarget)};class xt extends s{constructor(i){var t;for(super(),this.sType=["成长历程","装备大全","技能大全","宠物大全","宝石大全"],this.s0_levs=["0~9级","10~19级","20~29级","30~39级","40~49级"],this.s0_detail=[["1.背包中有新手大礼包，打开后获得丰厚的奖励","2.找到乡水镇铁匠，打造适合自己的装备"],["1.【为民除害任务】：【西阳城】的【西阳城守卫】 接取任务，完成后获得大量经验奖励。","2.【门派任务】：每10次任务为一轮，每天前两轮任务双倍奖励，完成任务获得大量经验铜币","3.【每日签到】：根据提示完成所有加活跃的任务，当活跃度满20以后，方可签到。奖励有强化符等商城道具，会员获得奖励更多哦。","4.【手艺任务】：【郢城】的【铁匠】接取任务，每10次为一轮，完成后获得大量经验和铜币，一轮任务后可随机获得一项手艺","5.【每日赛跑】：【临淄城】的【田忌】接取任务，完成后获得大量经验和铜币，并获得一个三级草药。前10名可额外获得商城道具奖励。","6.【师徒任务】：师徒二人组队至【临淄城】的【慎到】处领取。完成后师傅获得宠物修炼积分，徒弟获得大量经验和铜币。","7.【活动答题】：每周一至周五中午12点至1点可参与，答题可获得大量经验和储备。","8.【世界答题】：答出世界频道刷新的题目，即有机会获得丰厚的奖励。","9.【智者答题】：找到城镇中的【智者】，答对他提出的问题，有几率获得宝石奖励。"],["1.【强盗任务】：【郢城】的【栾千盛】处接取任务。10次为一轮，完成后获得大量经验和铜币。","2.【护法任务】：【咸阳】的【商鞅】处接取任务，10次为一轮，完成后获得大量的经验和铜币","3.【帮派山贼】：周一至周五13:00至13:40，打败帮派内刷出的山贼，获得大量帮贡。","4.【押镖任务】：【临淄城】的【程镖头】处接取任务，完成后获得大量铜币奖励，并有一定几率获得阵法书，还有可能获得红包（里面有200元宝哦）。","5.【帮派任务】：【青龙任务】【朱雀任务】【玄武任务】，【郢城】的【帮派总管】处进入帮派，完成任务可获取大量帮贡。"],["1.【门派闯关】，每周四晚上8点在【咸阳】、【临淄】或者【郢城】的【门派使者】处领取任务，挑战门派护卫。每过一关都有丰厚的奖励，过关最快的队伍更有高等级宝石领取","2.【山贼宝图】，山贼于每个整点在野外地图刷出，组队3人或3人以上前往挑战。战斗胜利后获得大量经验和铜币，并有一定几率获得藏宝图","3.【妖怪叔叔】，可以组队3人或3人以上前往野外挑战妖怪叔叔。战斗胜利后获得大量经验和铜币，并有一定几率获得一级宝石。","4.【坐骑任务】，咸阳城坐骑仙子处领取。完成后获得酷炫坐骑一只"],["1.【嚣张任务】：在城镇中找到嚣张， 必须5人组队才能进行战斗。战斗胜利后获得大量经验、铜钱、高级宠书、宝石等等 。","2.【匈奴入侵】：每周一至周四，19:00~20:00，在长城，阴山，云蒙山，匈奴营寨，打败匈奴后获得大量经验和金钱奖励，和一些物品奖励，可能获得匈奴情报，上交还能获得奖励。","3.【执法任务】：【咸阳城】的【商鞅】接取任务，10次为一轮，任务完成后可以得到1级或2级材料。","4.【副本】：【咸阳】的【副本官】处创建副本，打败副本主怪可获得大量经验和副本积分，副本积分可以换取高等级装备图纸，二级材料，三级材料，宠物修炼果。","5.【战队竞技】：在【咸阳】的【神威将军】处创建战队后，战队队长可以挑战比自己排名高的战队，挑战胜利可以提升战队排名。排名越靠前，战队每日声望增长越多。","6.【战队秘境】：在【咸阳】的【神威将军】处，点击【战队属性】中的【战队秘境】进入秘境，击败秘境主怪可以获得不同等级的封印兽魂（兽魂用于宠物进阶）。","7.【比武大会】：每周五中午12点~周六中午12点，玩家可以在【咸阳】的【比武接引人】报名，周六和周日下午13点~15点之间分别进行两场比武，比武获胜方可领取宝箱，即使失败也有其他丰厚奖励。"]],this.i0LevPoint=0,this.s1_levs=["0级装备","10级装备","20级装备","30级装备","40级装备","50级装备","60级装备","70级装备","80级装备"],this.s1_setids=[[9,1,10,3,4,5,6,7,8],[47,53,59,11,19,25,31,37,13],[48,54,60,12,20,26,32,38,14],[49,55,61,43,21,27,33,39,15],[50,56,62,44,22,28,34,40,16],[51,57,63,45,23,29,35,41,17],[52,58,64,46,24,30,36,42,18],[248,249,250,244,245,251,252,253,254],[290,291,292,293,294,295,296,297,298,299,300,301]],this.s2_page=["门派技能","宠物技能","装备特效","装备特技","辅助技能"],this.s2_sort1=["剑侠居","茅蓬坞","庐医崖","武安阁","溶洞","鬼谷","封神台","仙人洞","神女峰"],this.s2_skills1=[[7,8,9,10,11,13],[21,22,23,24,25,26],[34,35,36,37,38,39],[47,48,49,50,51,52],[60,61,62,63,64,65],[73,74,75,76,77,78],[86,87,88,89,90,91],[99,100,101,102,103,104],[112,113,114,115,116,117]],this.s2_sort2=["主动技能","被动技能"],this.s2_skills2=[[192,193,194,195,196,284,206,283],[134,137,140,143,146,149,152,155,158,161,164,167,170,173,176,179,182,185,188,191,205,209,212,215,218,221,224,276,279,282]],this.s2_2ext=[[["烈火","以法术攻击一人","嚣张任务、交易、商店购买宠物技能包"],["水剑","以法术攻击二人","嚣张任务、交易、商店购买宠物技能包"],["风刃","以法术攻击三人","嚣张任务、交易、商店购买宠物技能包"],["流沙","以法术攻击单人,同时有20%几率将其困住一回合","嚣张任务、交易、商店购买宠物技能包"],["招魂","对处于龟息状态的怪物使用,可使其离开战场,如果目标未死亡,吸取其部分气血和魔法","嚣张任务、交易、商店购买宠物技能包"],["奋力一击","物理攻击技能,对目标造成110%物理伤害,忽视目标防御状态","蛮将特有技能,福缘积分兑换"],["生死决","物理攻击技能,70%几率造成双倍伤害,30%几率恢复其气血。消耗等级*2+30魔法","仙女特有技能,福缘积分兑换"],["巫毒","以法术攻击单人,并有几率降低目标物理和法术抗性持续三回合","萨满特有技能,福缘积分兑换"]],[["死守","低级宠物技能书：降低5%所受法术和物理伤害，同时降低5%自身法术和物理伤害#e中级宠物技能书：降低10%所受法术和物理伤害，同时降低10%自身法术和物理伤害#e高级宠物技能书：降低20%所受法术和物理伤害，同时降低20%自身法术和物理伤害，","嚣张活动、交易、商店购买宠物技能书"],["致命","低级宠物技能书：物理攻击时增加5%几率出现伤害结果加倍#e中级宠物技能书：物理攻击时增加10%几率出现伤害结果加倍#e高级宠物技能书：物理攻击时增加20%几率出现伤害结果加倍","嚣张活动、交易、商店购买宠物技能书"],["追击","低级宠物技能书：45%几率连续两次物理攻击，物理伤害降低25%#e中级宠物技能书：55%几率连续两次物理攻击，物理伤害降低25%#e高级宠物技能书：60%几率连续两次物理攻击，物理伤害降低20%","嚣张活动、交易、商店购买宠物技能书"],["急袭","低级宠物技能书：物理攻击效果提高5%#e中级宠物技能书：物理攻击效果提高10%#e高级宠物技能书：物理攻击效果提高20%","嚣张活动、交易、商店购买宠物技能书"],["嗜杀","低级宠物技能书：物理攻击伤害会在85%-115%之间波动#e中级宠物技能书：物理攻击伤害会在85%-120%之间波动#e高级宠物技能书：物理攻击伤害会在90%-120%之间波动","嚣张活动、交易、商店购买宠物技能书"],["吸血","低级宠物技能书：可以将物理攻击效果的10%转化为自身气血#e中级宠物技能书：可以将物理攻击效果的20%转化为自身气血#e高级宠物技能书：可以将物理攻击效果的30%转化为自身气血","嚣张活动、交易、商店购买宠物技能书"],["聚灵","低级宠物技能书：法术攻击时增加5%几率出现伤害结果1.5倍#e中级宠物技能书：法术攻击时增加10%几率出现伤害结果1.5倍#e高级宠物技能书：法术攻击时增加20%几率出现伤害结果1.5倍","嚣张活动、交易、商店购买宠物技能书"],["逆灵","低级宠物技能书：5%几率连续两次法术攻击#e中级宠物技能书：10%几率连续两次法术攻击#e高级宠物技能书：20%几率连续两次法术攻击","嚣张活动、交易、商店购买宠物技能书"],["灵体","低级宠物技能书：法术攻击效果提高5%#e中级宠物技能书：法术攻击效果提高10%#e高级宠物技能书：法术攻击效果提高20%","嚣张活动、交易、商店购买宠物技能书"],["魔魂","低级宠物技能书：法术攻击伤害会在85%-115%之间波动#e中级宠物技能书：法术攻击伤害会在85%-120%之间波动#e高级宠物技能书：法术攻击伤害会在90%-120%之间波动","嚣张活动、交易、商店购买宠物技能书"],["吞灵","低级宠物技能书：受到法术攻击时，有10%几率将所受法术伤害转化为气血#e中级宠物技能书：受到法术攻击时，有20%几率将所受法术伤害转化为气血#e高级宠物技能书：受到法术攻击时，有30%几率将所受法术伤害转化为气血","嚣张活动、交易、商店购买宠物技能书"],["隐身","低级宠物技能书：进入战斗时能隐身2-3回合，拥有此技能物理和法术伤害降低25%#e中级宠物技能书：进入战斗时能隐身3-4回合，拥有此技能物理和法术伤害降低20%#e高级宠物技能书：进入战斗时能隐身4-5回合，拥有此技能物理和法术伤害降低15%","嚣张活动、交易、商店购买宠物技能书"],["火眼","低级宠物技能书：能识破敌人的隐身#e中级宠物技能书：能识破敌人的隐身，同时增加10%的物理命中率#e高级宠物技能书：能识破敌人的隐身，同时增加20%的物理命中率","嚣张活动、交易、商店购买宠物技能书"],["反击","低级宠物技能书：受到物理攻击时有10%几率反击，反击伤害为正常伤害的50%#e中级宠物技能书：受到物理攻击时有20%几率反击，反击伤害为正常伤害的75%#e高级宠物技能书：受到物理攻击时有30%几率反击，反击伤害为正常伤害的100%","嚣张活动、交易、商店购买宠物技能书"],["反噬","低级宠物技能书：受到物理攻击时有20%几率反噬，反噬伤害为所受伤害的20%#e中级宠物技能书：受到物理攻击时有30%几率反噬，反噬伤害为所受伤害的30%#e高级宠物技能书：受到物理攻击时有40%几率反噬，反噬伤害为所受伤害的40%","嚣张活动、交易、商店购买宠物技能书"],["龟息","低级宠物技能书：战斗死亡时不会离开战场#e中级宠物技能书：战斗死亡时不会离开战场，10回合后复活#e高级宠物技能书：战斗死亡时不会离开战场，5回合后复活","嚣张活动、交易、商店购买宠物技能书"],["神恩","低级宠物技能书：战斗死亡时有10%几率复活，恢复50%气血#e中级宠物技能书：战斗死亡时有20%几率复活，恢复75%气血#e高级宠物技能书：战斗死亡时有30%几率复活，恢复100%气血","嚣张活动、交易、商店购买宠物技能书"],["凝神","低级宠物技能书：抵御封印类技能，降低30%自身物理和法术伤害#e中级宠物技能书：抵御封印类技能，降低20%自身物理和法术伤害#e高级宠物技能书：抵御封印类技能，降低10%自身物理和法术伤害","嚣张活动、交易、商店购买宠物技能书"],["幸运","低级宠物技能书：不会受到聚灵攻击，法术攻击能力降低5%#e中级宠物技能书：不会受到聚灵和逆灵攻击，法术攻击能力降低10%#e高级宠物技能书：不会受到聚灵和逆灵攻击，20%几率躲避法术攻击，法术攻击能力降低20%","嚣张活动、交易、商店购买宠物技能书"],["专注","低级宠物技能书：不会受到致命攻击，物理攻击能力降低5%#e中级宠物技能书：不会受到致命和追击攻击，物理攻击能力降低10%#e高级宠物技能书：不会受到致命和追击攻击，20%几率躲避物理攻击，物理攻击能力降低20%","嚣张活动、交易、商店购买宠物技能书"],["迟钝","低级宠物技能书：速度降低5%#e中级宠物技能书：速度降低10%#e高级宠物技能书：速度降低20%","嚣张活动、交易、商店购买宠物技能书"],["敏捷","低级宠物技能书：速度提升5%#e中级宠物技能书：速度提升10%#e高级宠物技能书：速度提升20%","嚣张活动、交易、商店购买宠物技能书"],["防御","低级宠物技能书：防御力增加等级*0.6，法术伤害降低20%#e中级宠物技能书：防御力增加等级*1.2，法术伤害降低15%#e高级宠物技能书：防御力增加等级*1.8，法术伤害降低10%","嚣张活动、交易、商店购买宠物技能书"],["巨力","低级宠物技能书：攻击力增加等级*0.5，如果对方有防御技能，伤害减少20%#e中级宠物技能书：攻击力增加等级*1，如果对方有防御技能，伤害减少20%#e高级宠物技能书：攻击力增加等级*1.5，如果对方有防御技能，伤害减少20%","嚣张活动、交易、商店购买宠物技能书"],["撕裂","低级宠物技能书：物理攻击时，有5%几率使对方流血不止#e中级宠物技能书：物理攻击时，有10%几率使对方流血不止#e高级宠物技能书：物理攻击时，有20%几率使对方流血不止","嚣张活动、交易、商店购买宠物技能书"],["冥思","低级宠物技能书：每回合结束时，自动恢复等级/4魔法#e中级宠物技能书：每回合结束时，自动恢复等级/3魔法#e高级宠物技能书：每回合结束时，自动恢复等级/1.5魔法","嚣张活动、交易、商店购买宠物技能书"],["自愈","低级宠物技能书：每回合结束时，自动恢复等级/2气血#e中级宠物技能书：每回合结束时，自动恢复等级/1.5气血#e高级宠物技能书：每回合结束时，自动恢复等级/1气血","嚣张活动、交易、商店购买宠物技能书"],["招架","低级宠物技能书：有30%的几率招架物理攻击，降低30%所受物理伤害#e中级宠物技能书：有40%的几率招架物理攻击，降低40%所受物理伤害#e高级宠物技能书：有50%的几率招架物理攻击，降低50%所受物理伤害","嚣张活动、交易、商店购买宠物技能书"],["噬魂","低级宠物技能书：对带有龟息术技能怪物的物理、法术伤害效果提高125%#e中级宠物技能书：对带有龟息术技能怪物的物理、法术伤害效果提高150%#e高级宠物技能书：对带有龟息术技能怪物的物理、法术伤害效果提高200%","噬魂豹特有技能、福缘积分兑换"],["血魄","低级宠物技能书：气血增加等级*1.2，物理伤害降低20%#e中级宠物技能书：气血增加等级*1.2，物理伤害降低15%#e高级宠物技能书：气血增加等级*3.6，物理伤害降低10%","嚣张活动、交易、商店购买宠物技能书"]]],this.s2_skills3=[267,268,269,270,271,272,273],this.s2_3ext=["腰带","武器"," 项链","鞋子","鞋子","衣服","帽子"],this.s2_skills4=[225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266],this.s2_skills5=[122,121,123,119,118,120,124,125],this.s2_details=[["冶金术","学习后可以提高制作武器和项链的能力#e可在【快捷】按钮中使用,使用需消耗体力,且不同等级的锻造术消耗的体力也不同,每使用一次,会增加相应的熟练度,熟练度越高,越容易打造出好的装备。","郢城铁匠-手艺制作技巧、帮派学院-学技能 "],["锻造术","学习后可以提高锻造头盔和腰带的能力#e可在【快捷】按钮中使用,使用需消耗体力,且不同等级的锻造术消耗的体力也不同,每使用一次,会增加相应的熟练度,熟练度越高,越容易打造出好的装备。","郢城铁匠-手艺制作技巧、帮派学院-学技能"],["裁剪术","学习后可以提高制作衣服和靴子的能力#e可在【快捷】按钮中使用,使用需消耗体力,且不同等级的锻造术消耗的体力也不同,每使用一次,会增加相应的熟练度,熟练度越高,越容易打造出好的装备","郢城铁匠-手艺制作技巧、帮派学院-学技能"],["炼丹术","学习后可以提高炼丹的能力#e可在【快捷】按钮中使用,炼丹术等级越高,炼丹成功率也越高,丹药品质也越高","郢城铁匠-手艺制作技巧、帮派学院-学技能"],["强身术","学习后能增加气血上限","郢城陈子枫-辅助技能、帮派学院-学技能"],["烹饪","学习后可以提高制作食物的能力#e可在【快捷】按钮中使用,使用需消耗体力","郢城陈子枫-辅助技能、帮派学院-学技能"],["健体","学习后能增加体力上限","郢城陈子枫-辅助技能、帮派学院-学技能"],["修心","学习后能增加魔法上限","郢城陈子枫-辅助技能、帮派学院-学技能"]],this.s3_type=["物攻宠物","法攻宠物","辅助宠物","神兽"],this.s3_petids=[[1,10,4,7,14,6,18,20,24,22,27],[11,13,5,15,6,19,21,26,27],[3,8,9,12,2,4,5,7,14,15,6,18,19,20,21,24,22,23,25,26],[16,28]],this.s3_details=[[["攻","攻","攻血","攻速","攻防","攻法血","攻血防","攻速","攻速","攻血","攻法"],["法","法","法血","法血","攻法血","法速","法速","法速","法血","攻法"],["防","速","血","血速","血","攻血","法血","攻速","攻防","法血","攻法血","攻血防","法速","攻速","法速","攻速","攻血","法防","血防","法血"],["攻法","攻法"]],[["5力","5力","5力,3耐2血","5力,4力1速","5力,3耐2血","5力,5法,3血2耐","5力,3耐2血,3血2耐","5力,2血2耐1速","5力,2耐2血1速","5力,3血2耐","5力,5法"],["5法","5法","5法,3血2耐","5法,3血2耐","5力,5法,3血2耐","5法,2血2耐1速","5法,2血2耐1速","5法,3血2耐","5力,5法"],["4耐1血","3敏2耐","3血2耐","3耐2血,3速2血","3血2耐","5力,3耐2血","5法,3血2耐","5力,4力1速","5力,3耐2血","5法,3血2耐","5力,5法,3血2耐","5力,3耐2血,3血2耐","5法,2血2耐1速","5力,2血2耐1速","5法,2血2耐1速","5力,2耐2血1速","5力,3血2耐","5法,3耐2血","3血2耐,3耐2血","5法,3血2耐"],["5力,5法","5力,5法"]],[["郊外、西阳山道抓获，交易","大禹水道、平原山陵抓获，交易","云蒙山、烈焰峰抓获，交易","函谷关、长城抓获，交易","长城、阴山抓获，交易","阴山抓获，交易","地下藏宝洞一层、地下藏宝洞二层抓获，交易","古战场抓获，交易","古战场抓获，交易","匈奴营寨、古战场抓获，交易","蜀山抓获，交易"],["平原山陵、巫山抓获，交易","巫山抓获，交易","烈焰峰、函谷关抓获，交易","阴山、地下藏宝洞一层抓获，交易","阴山抓获，交易","地下藏宝洞二层抓获，交易","匈奴营寨抓获，交易","蜀山抓获，交易","蜀山抓获，交易"],["乡水镇郊抓获，交易","西阳山道、渡口抓获，交易","渡口、大禹水道抓获，交易","巫山、太行山抓获，交易","太行山、云蒙山抓获，交易","云蒙山、烈焰峰抓获，交易","烈焰峰、函谷关抓获，交易","函谷关、长城抓获，交易","长城、阴山抓获，交易","阴山、地下藏宝洞一层抓获，交易","阴山抓获，交易","地下藏宝洞一层、地下藏宝洞二层抓获，交易","地下藏宝洞二层抓取，交易","古战场抓获，交易","匈奴营寨抓获，交易","古战场抓获，交易","匈奴营寨、古战场抓获，交易","泰山抓获，交易","泰山、蜀山抓获，交易","蜀山抓获，交易"],["神兽抽奖活动、新区充值活动、福袋兑换","神兽抽奖活动"]]],this.i4_ids=[103,105,104,101,102],this.s4_detail=["基础属性：1级宝石，血量+40#e升级效果：每升一级血量+40，宝石等级没有上限#e镶嵌部位：衣服，腰带#e合成宝石有概率失败，失败后损失一颗宝石#e郢城铁匠处进行宝石合成和镶嵌操作","基础属性：1级宝石，灵力+6#e升级效果：每升一级灵力+6，宝石等级没有上限#e镶嵌部位：项链，鞋子#e合成宝石有概率失败，失败后损失一颗宝石#e郢城铁匠处进行宝石合成和镶嵌操作","基础属性：1级宝石，速度+8#e升级效果：每升一级速度+8，宝石等级没有上限#e镶嵌部位：腰带，靴子#e合成宝石有概率失败，失败后损失一颗宝石#e郢城铁匠处进行宝石合成和镶嵌操作","基础属性：1级宝石，攻击力+8#e升级效果：每升一级攻击力+8，宝石等级没有上限#e镶嵌部位：武器，头盔#e合成宝石有概率失败，失败后损失一颗宝石#e郢城铁匠处进行宝石合成和镶嵌操作","基础属性：1级宝石，防御+12#e升级效果：每升一级防御+12，宝石等级没有上限#e镶嵌部位：衣服，头盔#e合成宝石有概率失败，失败后损失一颗宝石#e郢城铁匠处进行宝石合成和镶嵌操作"],this.pani=i,this.pm3f=i.pm3f,this.iW=950,this.iH=550,this.iX=(h.SCRW-this.iW)/2+50,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_type=new Array(5),t=0;t<5;t++)this.btn_type[t]=new Eh(gn.xani_nui5),this.btn_type[t].Move(this.iX-100+1,this.iY+40+90*t,110,90),this.btn_type[t].InitButton(this.sType[t]);this.iTypePoint=0,this.Init_0(),this.Init_1(),this.Init_2(),this.Init_3(),this.Init_4()}Draw(){var i;for(i=0;i<5;i++)this.btn_type[i].Draw(),this.pm3f.DrawText_2(this.btn_type[i].iX+54,this.btn_type[i].iY+68,this.sType[i],4278190080,22,101,1,1,0,-2,-2,4,4278190080);switch(E.new_bigframe(this.iX,this.iY,this.iW,this.iH),i=this.iTypePoint,gn.xani_nui5.DrawAnima_aa(this.btn_type[i].iX,this.btn_type[i].iY,this.sType[i],1),this.pm3f.DrawText_2(this.btn_type[i].iX+54,this.btn_type[i].iY+68,this.sType[i],4294967295,24,101,1,1,0,-2,-2,4,4278190080),this.bScorlling=!1,this.iTypePoint){case 0:c.gi().FillRect_2D(this.iX+25,this.iY+25,this.iX+this.iW-25,this.iY+this.iH-25,2155787942),this.DrawPublicFrame(this.iX+25,this.iY+25,this.iW-50,this.iH-50,this.aa_f4,20,20),this.Draw_0();break;case 1:c.gi().FillRect_2D(this.iX+25,this.iY+25,this.iX+this.iW-25,this.iY+this.iH-25,2155787942),this.DrawPublicFrame(this.iX+25,this.iY+25,this.iW-50,this.iH-50,this.aa_f4,20,20),this.Draw_1();break;case 2:this.Draw_2();break;case 3:c.gi().FillRect_2D(this.iX+25,this.iY+25,this.iX+this.iW-25,this.iY+this.iH-25,2155787942),this.DrawPublicFrame(this.iX+25,this.iY+25,this.iW-50,this.iH-50,this.aa_f4,20,20),this.Draw_3();break;case 4:this.Draw_4()}this.btn_close.Draw()}Init_0(){var i;for(this.btn0_levs=new Array(5),i=0;i<5;i++)this.btn0_levs[i]=new Eh(gn.xani_nui5),this.btn0_levs[i].Move(this.iX+50,this.iY+50+65*i,146,57),this.btn0_levs[i].InitButton("新大按钮"),this.btn0_levs[i].sName=this.s0_levs[i];this.aa_f1=gn.xani_frame.InitAnimaWithName("单色内框a20_20",null),this.aa_f2=gn.xani_frame.InitAnimaWithName("单色内框b20_20",null),this.aa_f3=gn.xani_nui5.InitAnimaWithName("内框3",null),this.aa_f4=gn.xani_nui5.InitAnimaWithName("内框4",null),this.i0LevPoint=0}Draw_0(){var i,t,s;for(i=0;i<5;i++)this.i0LevPoint==i&&(this.btn0_levs[i].bMouseDown=!0),this.btn0_levs[i].Draw();for(this.DrawPublicFrame(this.iX+220,this.iY+50,680,450,this.aa_f1,20,20),this.iSRX=this.iX+220+20,this.iSRY=this.iY+50+20,this.iSRW=640,this.iSRH=410,this.pm3f.SetViewClip(this.iSRX,this.iSRY,this.iSRX+this.iSRW,this.iSRY+this.iSRH),this.iSHeight=94*this.s0_detail[this.i0LevPoint].length,this.bScorlling=!0,i=0;i<this.s0_detail[this.i0LevPoint].length;i++)t=this.iX+220+20,(s=this.iY+50+20+94*i-this.iSOffY)+94<this.iY+50||s>this.iY+50+450||(this.DrawPublicFrame(t,s,640,90,this.aa_f2,20,20),gn.xani_nui5.DrawAnima_aa(t+10,s+5,this.s0_levs[this.i0LevPoint],i),Y.gi().Format(this.s0_detail[this.i0LevPoint][i],500,20),Y.gi().Draw(t+110,s+45-Y.gi().iH/2));this.pm3f.NoClip()}Init_1(){var i;for(this.i1LevPoint=0,this.bChangeLev=!1,this.btn1_clev=new Eh(gn.xani_nui5),this.btn1_clev.Move(this.iX+170,this.iY+50,109,61),this.btn1_clev.InitButton("新中按钮"),this.btn1_clev.sName=this.s1_levs[0],this.btn1_clev.iNameSize=20,this.btn1_levs=new Array(9),i=0;i<9;i++)this.btn1_levs[i]=new Eh(gn.xani_nui5),this.btn1_levs[i].Move(this.iX+170+i%3*114,this.iY+50+66*parseInt(i/3),109,61),this.btn1_levs[i].InitButton("新中按钮"),this.btn1_levs[i].sName=this.s1_levs[i],this.btn1_levs[i].iNameSize=20;for(this.btn1_sets=new Array(12),i=0;i<12;i++)this.btn1_sets[i]=new Eh(gn.xani_nui5),this.btn1_sets[i].InitButton("最大按钮");this.i1SetPoint=0}Draw_1(){var i,t,s,e,h;for(this.iSRX=this.iX+50,this.iSRY=this.iY+130,this.iSRW=236,this.iSRH=380,this.pm3f.SetViewClip(this.iSRX,this.iSRY,this.iSRX+this.iSRW,this.iSRY+this.iSRH),this.iSHeight=92*this.s1_setids[this.i1LevPoint].length,this.bScorlling=!0,i=0;i<this.s1_setids[this.i1LevPoint].length;i++)e=this.iX+50,h=this.iY+130+92*i-this.iSOffY,this.btn1_sets[i].Move(e,h,236,87),h+94<this.iSRY||h>this.iSRY+this.iSRH||(this.i1SetPoint==i&&(this.btn1_sets[i].bMouseDown=!0),this.btn1_sets[i].Draw(),gn.xani_nui3.DrawAnima(e+4,h+3,"物品格子",0),gn.xani_ngoods.DrawAnima_aa(e+4,h+3,gn.de_goods.strValue(this.s1_setids[this.i1LevPoint][i],0,10),0),this.pm3f.DrawTextEx(e+100,h+43.5,gn.de_goods.strValue(this.s1_setids[this.i1LevPoint][i],0,4),4294967295,25,101,1,1,0,0,-2));this.pm3f.NoClip(),this.DrawPublicFrame(this.iX+290,this.iY+45,610,460,this.aa_f1,20,20),e=this.iX+290,h=this.iY+45,gn.xani_nui3.DrawAnima(e+15,h+15,"物品格子",0),gn.xani_ngoods.DrawAnima_aa(e+15,h+15,gn.de_goods.strValue(this.s1_setids[this.i1LevPoint][this.i1SetPoint],0,10),0),this.pm3f.DrawTextEx(e+110,h+15+40,gn.de_goods.strValue(this.s1_setids[this.i1LevPoint][this.i1SetPoint],0,4),4294967295,30,101,1,1,0,0,-2),gn.xani_nui5.DrawAnimaEx(e+15,h+15+80+15,"分隔线",0,101,55,1,0,0,0),h+=125;var a="未知";i=gn.de_goods.intValue(this.s1_setids[this.i1LevPoint][this.i1SetPoint],-1,16),t=gn.de_goods.intValue(this.s1_setids[this.i1LevPoint][this.i1SetPoint],-1,19),s=gn.de_goods.intValue(this.s1_setids[this.i1LevPoint][this.i1SetPoint],-1,20),0==i?a="头盔":1==i?a="饰品":2==i?0==t?a="剑":1==t?a="刀":2==t&&(a="枪"):3==i?a=0==s?"女衣":"铠甲":4==i?a="腰带":5==i&&(a="鞋子"),a="类型："+a;if(this.pm3f.DrawTextEx(e+15,h,a,4278190080,25,101,1,1,0,0,0),h+=31,this.pm3f.DrawTextEx(e+15,h,"基础属性范围：",4278190080,25,101,1,1,0,0,0),h+=31,t=gn.de_goods.intValue(this.s1_setids[this.i1LevPoint][this.i1SetPoint],-1,9),this.pm3f.DrawTextEx(e+15,h,"等级："+t,4278190080,25,101,1,1,0,0,0),h+=31,(i=gn.de_goods.intValue(this.s1_setids[this.i1LevPoint][this.i1SetPoint],-1,21))>0&&(this.pm3f.DrawTextEx(e+15,h,"防御：+"+i+"~"+2*i+"（图纸打造+"+11*i/10+"~"+11*i/5+"）",4278190080,25,101,1,1,0,0,0),h+=31),(i=gn.de_goods.intValue(this.s1_setids[this.i1LevPoint][this.i1SetPoint],-1,22))>0&&(this.pm3f.DrawTextEx(e+15,h,"魔法：+"+i+"~"+2*i+"（图纸打造+"+11*i/10+"~"+11*i/5+"）",4278190080,25,101,1,1,0,0,0),h+=31),(i=gn.de_goods.intValue(this.s1_setids[this.i1LevPoint][this.i1SetPoint],-1,23))>0&&(this.pm3f.DrawTextEx(e+15,h,"灵力：+"+i+"~"+2*i+"（图纸打造+"+11*i/10+"~"+11*i/5+"）",4278190080,25,101,1,1,0,0,0),h+=31),(i=gn.de_goods.intValue(this.s1_setids[this.i1LevPoint][this.i1SetPoint],-1,24))>0&&(this.pm3f.DrawTextEx(e+15,h,"气血：+"+i+"~"+2*i+"（图纸打造+"+11*i/10+"~"+11*i/5+"）",4278190080,25,101,1,1,0,0,0),h+=31),(i=gn.de_goods.intValue(this.s1_setids[this.i1LevPoint][this.i1SetPoint],-1,25))>0&&(this.pm3f.DrawTextEx(e+15,h,"速度：+"+i+"~"+2*i+"（图纸打造+"+11*i/10+"~"+11*i/5+"）",4278190080,25,101,1,1,0,0,0),h+=31),(i=gn.de_goods.intValue(this.s1_setids[this.i1LevPoint][this.i1SetPoint],-1,3))>0&&(this.pm3f.DrawTextEx(e+15,h,"攻击：+"+i+"~"+2*i+"（图纸打造+"+11*i/10+"~"+11*i/5+"）",4278190080,25,101,1,1,0,0,0),h+=31),s=5*t+100,this.pm3f.DrawTextEx(e+15,h,"耐久度："+s+"/"+s,4278190080,25,101,1,1,0,0,0),h=this.iY+this.iH-150,this.pm3f.DrawTextEx(e+15,h-20-15,"【郢城】【铁匠】处强化装备，可提升装备属性",4278190080,25,101,1,1,0,0,0),gn.xani_nui5.DrawAnimaEx(e+15,h,"分隔线",0,101,55,1,0,0,0),h+=10,this.pm3f.DrawTextEx(e+15,h,"主要获取途径",4294967295,20,101,1,1,0,0,0),h+=30,this.DrawPublicFrame(e+15,h,580,50,this.aa_f2,20,20),0==t?this.pm3f.DrawTextEx(e+15+290,h+25,"装备打造，乡水镇装备店购买，交易",4294967295,20,101,1,1,0,-2,-2):10==t?this.pm3f.DrawTextEx(e+15+290,h+25,"装备打造，西阳城装备店购买，交易",4294967295,20,101,1,1,0,-2,-2):20==t?this.pm3f.DrawTextEx(e+15+290,h+25,"装备打造，郢城装备店购买，交易",4294967295,20,101,1,1,0,-2,-2):30==t?this.pm3f.DrawTextEx(e+15+290,h+25,"装备打造，临淄装备店购买，交易",4294967295,20,101,1,1,0,-2,-2):40==t?this.pm3f.DrawTextEx(e+15+290,h+25,"装备打造，咸阳装备店购买，交易",4294967295,20,101,1,1,0,-2,-2):50==t||60==t?this.pm3f.DrawTextEx(e+15+290,h+25,"装备打造，挖宝，交易",4294967295,20,101,1,1,0,-2,-2):this.pm3f.DrawTextEx(e+15+290,h+25,"装备打造，交易",4294967295,20,101,1,1,0,-2,-2),this.pm3f.DrawTextEx(this.btn1_clev.iX-120,this.btn1_clev.iY+30.5,"选择等级",4294967295,25,101,1,1,0,0,-2),this.DrawPublicFrame(this.btn1_clev.iX-5,this.btn1_clev.iY-5,119,71,this.aa_f3,20,20),this.btn1_clev.sName=this.s1_levs[this.i1LevPoint],this.btn1_clev.Draw(),this.bChangeLev)for(this.DrawPublicFrame(this.btn1_clev.iX-5,this.btn1_clev.iY-5,347,203,this.aa_f3,20,20),i=0;i<9;i++)this.btn1_levs[i].Draw()}Init_2(){var i;for(this.btn2_page=new Array(5),i=0;i<5;i++)this.btn2_page[i]=new Eh(gn.xani_nui5),this.btn2_page[i].Move(this.iX+230+130*i,this.iY+20,130,44),this.btn2_page[i].InitButton("标签按钮"),this.btn2_page[i].sName=this.s2_page[i],this.btn2_page[i].iNameSize=20;for(this.i2PagePoint=0,this.btn2_cschool=new Eh(gn.xani_nui5),this.btn2_cschool.Move(this.iX+170,this.iY+80,109,61),this.btn2_cschool.InitButton("新中按钮"),this.btn2_cschool.sName=this.s2_sort1[0],this.btn2_cschool.iNameSize=20,this.i2SchoolPoint=0,this.btn2_schools=new Array(9),i=0;i<9;i++)this.btn2_schools[i]=new Eh(gn.xani_nui5),this.btn2_schools[i].Move(this.iX+170+i%3*114,this.iY+80+66*parseInt(i/3),109,61),this.btn2_schools[i].InitButton("新中按钮"),this.btn2_schools[i].sName=this.s2_sort1[i],this.btn2_schools[i].iNameSize=20;for(this.bChangeSchool=!1,this.btn2_czb=new Eh(gn.xani_nui5),this.btn2_czb.Move(this.iX+170,this.iY+80,109,61),this.btn2_czb.InitButton("新中按钮"),this.btn2_czb.sName=this.s2_sort1[0],this.btn2_czb.iNameSize=20,this.i2ZbPoint=0,this.btn2_zbs=new Array(9),i=0;i<2;i++)this.btn2_zbs[i]=new Eh(gn.xani_nui5),this.btn2_zbs[i].Move(this.iX+170+i%3*114,this.iY+80+66*parseInt(i/3),109,61),this.btn2_zbs[i].InitButton("新中按钮"),this.btn2_zbs[i].sName=this.s2_sort2[i],this.btn2_zbs[i].iNameSize=20;for(this.bChangeZb=!1,this.btn2_jnlist=new Array(64),i=0;i<64;i++)this.btn2_jnlist[i]=new Eh(gn.xani_nui5),this.btn2_jnlist[i].InitButton("最大按钮");this.i2SkillPoint=0}Draw_2(){var i,t,s;for(i=0;i<5;i++)this.btn2_page[i].Draw();switch(t=this.iX+25,s=this.iY+20+35,this.DrawPublicFrame(t,s,this.iW-50,this.iH-20-35-25,this.aa_f4,20,20),i=this.i2PagePoint,this.btn2_page[i].bMouseDown=!0,this.btn2_page[i].Draw(),this.i2PagePoint){case 0:for(this.iSRX=this.iX+50,this.iSRY=this.iY+160,this.iSRW=236,this.iSRH=350,this.pm3f.SetViewClip(this.iSRX,this.iSRY,this.iSRX+this.iSRW,this.iSRY+this.iSRH),this.iSHeight=92*this.s2_skills1[this.i2SchoolPoint].length,this.bScorlling=!0,i=0;i<this.s2_skills1[this.i2SchoolPoint].length;i++)t=this.iX+50,s=this.iY+160+92*i-this.iSOffY,this.btn2_jnlist[i].Move(t,s,236,87),s+94<this.iSRY||s>this.iSRY+this.iSRH||(this.i2SkillPoint==i&&(this.btn2_jnlist[i].bMouseDown=!0),this.btn2_jnlist[i].Draw(),gn.xani_nui2.DrawAnimaEx(t+4+6,s+3+7,"技能框",0,101,.85,.85,0,0,0),gn.xani_nicon.DrawAnimaEx(t+4+6,s+3+7,gn.de_skill.strValue(this.s2_skills1[this.i2SchoolPoint][i],0,5),0,101,.85,.85,0,0,0),this.pm3f.DrawTextEx(t+100,s+43.5,gn.de_skill.strValue(this.s2_skills1[this.i2SchoolPoint][i],0,6),4294967295,25,101,1,1,0,0,-2));if(this.pm3f.NoClip(),i=this.i2SkillPoint,t=this.iX+290,s=this.iY+75,this.DrawPublicFrame(t,s,610,430,this.aa_f1,20,20),gn.xani_nui2.DrawAnimaEx(t+20,s+20,"技能框",0,101,1,1,0,0,0),gn.xani_nicon.DrawAnimaEx(t+20,s+20,gn.de_skill.strValue(this.s2_skills1[this.i2SchoolPoint][i],0,5),0,101,1,1,0,0,0),this.pm3f.DrawTextEx(t+120,s+20+40,gn.de_skill.strValue(this.s2_skills1[this.i2SchoolPoint][i],0,6),4294967295,30,101,1,1,0,0,-2),gn.xani_nui5.DrawAnimaEx(t+15,s+20+80+20,"分隔线",0,101,55,1,0,0,0),this.pm3f.DrawTextEx(t+20,s+20+80+20+20,"技能描述：",4278190080,25,101,1,1,0,0,0),Y.gi().FormatEx("#c000000"+gn.de_skill.strValue(this.s2_skills1[this.i2SchoolPoint][i],0,3),570,25,0,0,40),Y.gi().Draw(t+20,s+20+80+20+40),s=this.iY+this.iH-150,gn.xani_nui5.DrawAnimaEx(t+15,s,"分隔线",0,101,55,1,0,0,0),s+=10,this.pm3f.DrawTextEx(t+15,s,"主要获取途径",4294967295,20,101,1,1,0,0,0),s+=30,this.DrawPublicFrame(t+15,s,580,50,this.aa_f2,20,20),this.pm3f.DrawTextEx(t+15+290,s+25,"使用遁地术回门派学习",4294967295,20,101,1,1,0,-2,-2),this.pm3f.DrawTextEx(this.btn2_cschool.iX-120,this.btn2_cschool.iY+30.5,"选择门派",4294967295,25,101,1,1,0,0,-2),this.DrawPublicFrame(this.btn2_cschool.iX-5,this.btn2_cschool.iY-5,119,71,this.aa_f3,20,20),this.btn2_cschool.sName=this.s2_sort1[this.i2SchoolPoint],this.btn2_cschool.Draw(),this.bChangeSchool)for(this.DrawPublicFrame(this.btn2_cschool.iX-5,this.btn2_cschool.iY-5,347,203,this.aa_f3,20,20),i=0;i<9;i++)this.btn2_schools[i].Draw();break;case 1:for(this.iSRX=this.iX+50,this.iSRY=this.iY+160,this.iSRW=236,this.iSRH=350,this.pm3f.SetViewClip(this.iSRX,this.iSRY,this.iSRX+this.iSRW,this.iSRY+this.iSRH),this.iSHeight=92*this.s2_skills2[this.i2ZbPoint].length,this.bScorlling=!0,i=0;i<this.s2_skills2[this.i2ZbPoint].length;i++)t=this.iX+50,s=this.iY+160+92*i-this.iSOffY,this.btn2_jnlist[i].Move(t,s,236,87),s+94<this.iSRY||s>this.iSRY+this.iSRH||(this.i2SkillPoint==i&&(this.btn2_jnlist[i].bMouseDown=!0),this.btn2_jnlist[i].Draw(),gn.xani_nui2.DrawAnimaEx(t+4+6,s+3+7,"技能框",0,101,.85,.85,0,0,0),gn.xani_nicon.DrawAnimaEx(t+4+6,s+3+7,gn.de_skill.strValue(this.s2_skills2[this.i2ZbPoint][i],0,5),0,101,.85,.85,0,0,0),this.pm3f.DrawTextEx(t+100,s+43.5,this.s2_2ext[this.i2ZbPoint][i][0],4294967295,25,101,1,1,0,0,-2));if(this.pm3f.NoClip(),i=this.i2SkillPoint,t=this.iX+290,s=this.iY+75,this.DrawPublicFrame(t,s,610,430,this.aa_f1,20,20),gn.xani_nui2.DrawAnimaEx(t+20,s+20,"技能框",0,101,1,1,0,0,0),gn.xani_nicon.DrawAnimaEx(t+20,s+20,gn.de_skill.strValue(this.s2_skills2[this.i2ZbPoint][i],0,5),0,101,1,1,0,0,0),this.pm3f.DrawTextEx(t+120,s+20+40,this.s2_2ext[this.i2ZbPoint][i][0],4294967295,30,101,1,1,0,0,-2),gn.xani_nui5.DrawAnimaEx(t+15,s+20+80+20,"分隔线",0,101,55,1,0,0,0),s+=130,Y.gi().FormatEx("#c000000"+this.s2_2ext[this.i2ZbPoint][i][1],570,25,0,0,30),Y.gi().Draw(t+20,s),s=this.iY+this.iH-150,gn.xani_nui5.DrawAnimaEx(t+15,s,"分隔线",0,101,55,1,0,0,0),s+=10,this.pm3f.DrawTextEx(t+15,s,"主要获取途径",4294967295,20,101,1,1,0,0,0),s+=30,this.DrawPublicFrame(t+15,s,580,50,this.aa_f2,20,20),this.pm3f.DrawTextEx(t+15+290,s+25,this.s2_2ext[this.i2ZbPoint][i][2],4294967295,20,101,1,1,0,-2,-2),this.pm3f.DrawTextEx(this.btn2_czb.iX-120,this.btn2_czb.iY+30.5,"选择分类",4294967295,25,101,1,1,0,0,-2),this.DrawPublicFrame(this.btn2_czb.iX-5,this.btn2_czb.iY-5,119,71,this.aa_f3,20,20),this.btn2_czb.sName=this.s2_sort2[this.i2ZbPoint],this.btn2_czb.Draw(),this.bChangeZb)for(this.DrawPublicFrame(this.btn2_czb.iX-5,this.btn2_czb.iY-5,233,71,this.aa_f3,20,20),i=0;i<2;i++)this.btn2_zbs[i].Draw();break;case 2:for(this.iSRX=this.iX+50,this.iSRY=this.iY+80,this.iSRW=236,this.iSRH=430,this.pm3f.SetViewClip(this.iSRX,this.iSRY,this.iSRX+this.iSRW,this.iSRY+this.iSRH),this.iSHeight=92*this.s2_skills3.length,this.bScorlling=!0,i=0;i<this.s2_skills3.length;i++)t=this.iX+50,s=this.iY+80+92*i-this.iSOffY,this.btn2_jnlist[i].Move(t,s,236,87),s+94<this.iSRY||s>this.iSRY+this.iSRH||(this.i2SkillPoint==i&&(this.btn2_jnlist[i].bMouseDown=!0),this.btn2_jnlist[i].Draw(),gn.xani_nui2.DrawAnimaEx(t+4+6,s+3+7,"技能框",0,101,.85,.85,0,0,0),gn.xani_nicon.DrawAnimaEx(t+4+6,s+3+7,gn.de_skill.strValue(this.s2_skills3[i],0,5),0,101,.85,.85,0,0,0),this.pm3f.DrawTextEx(t+100,s+43.5,gn.de_skill.strValue(this.s2_skills3[i],0,6),4294967295,25,101,1,1,0,0,-2));this.pm3f.NoClip(),i=this.i2SkillPoint,t=this.iX+290,s=this.iY+75,this.DrawPublicFrame(t,s,610,430,this.aa_f1,20,20),gn.xani_nui2.DrawAnimaEx(t+20,s+20,"技能框",0,101,1,1,0,0,0),gn.xani_nicon.DrawAnimaEx(t+20,s+20,gn.de_skill.strValue(this.s2_skills3[i],0,5),0,101,1,1,0,0,0),this.pm3f.DrawTextEx(t+120,s+20+40,gn.de_skill.strValue(this.s2_skills3[i],0,6),4294967295,30,101,1,1,0,0,-2),gn.xani_nui5.DrawAnimaEx(t+15,s+20+80+20,"分隔线",0,101,55,1,0,0,0),s+=140,this.pm3f.DrawTextEx(t+20,s,"对应装备："+this.s2_3ext[i],4278190080,25,101,1,1,0,0,0),s+=40,this.pm3f.DrawTextEx(t+20,s,"技能描述：",4278190080,25,101,1,1,0,0,0),s+=20,Y.gi().FormatEx("#c000000"+gn.de_skill.strValue(this.s2_skills3[i],0,3),570,25,0,0,40),Y.gi().Draw(t+20,s),s=this.iY+this.iH-150,gn.xani_nui5.DrawAnimaEx(t+15,s,"分隔线",0,101,55,1,0,0,0),s+=10,this.pm3f.DrawTextEx(t+15,s,"主要获取途径",4294967295,20,101,1,1,0,0,0),s+=30,this.DrawPublicFrame(t+15,s,580,50,this.aa_f2,20,20),this.pm3f.DrawTextEx(t+15+290,s+25,"装备打造",4294967295,20,101,1,1,0,-2,-2);break;case 3:for(this.iSRX=this.iX+50,this.iSRY=this.iY+80,this.iSRW=236,this.iSRH=430,this.pm3f.SetViewClip(this.iSRX,this.iSRY,this.iSRX+this.iSRW,this.iSRY+this.iSRH),this.iSHeight=92*this.s2_skills4.length,this.bScorlling=!0,i=0;i<this.s2_skills4.length;i++)t=this.iX+50,s=this.iY+80+92*i-this.iSOffY,this.btn2_jnlist[i].Move(t,s,236,87),s+94<this.iSRY||s>this.iSRY+this.iSRH||(this.i2SkillPoint==i&&(this.btn2_jnlist[i].bMouseDown=!0),this.btn2_jnlist[i].Draw(),gn.xani_nui2.DrawAnimaEx(t+4+6,s+3+7,"技能框",0,101,.85,.85,0,0,0),gn.xani_nicon.DrawAnimaEx(t+4+6,s+3+7,gn.de_skill.strValue(this.s2_skills4[i],0,5),0,101,.85,.85,0,0,0),this.pm3f.DrawTextEx(t+100,s+43.5,gn.de_skill.strValue(this.s2_skills4[i],0,6),4294967295,25,101,1,1,0,0,-2));this.pm3f.NoClip(),i=this.i2SkillPoint,t=this.iX+290,s=this.iY+75,this.DrawPublicFrame(t,s,610,430,this.aa_f1,20,20),gn.xani_nui2.DrawAnimaEx(t+20,s+20,"技能框",0,101,1,1,0,0,0),gn.xani_nicon.DrawAnimaEx(t+20,s+20,gn.de_skill.strValue(this.s2_skills4[i],0,5),0,101,1,1,0,0,0),this.pm3f.DrawTextEx(t+120,s+20+40,gn.de_skill.strValue(this.s2_skills4[i],0,6),4294967295,30,101,1,1,0,0,-2),gn.xani_nui5.DrawAnimaEx(t+15,s+20+80+20,"分隔线",0,101,55,1,0,0,0),s+=140,this.pm3f.DrawTextEx(t+20,s,"消耗愤怒："+gn.de_skill.strValue(this.s2_skills4[i],0,35),4278190080,25,101,1,1,0,0,0),s+=40,this.pm3f.DrawTextEx(t+20,s,"技能描述：",4278190080,25,101,1,1,0,0,0),s+=20,Y.gi().FormatEx("#c000000"+gn.de_skill.strValue(this.s2_skills4[i],0,3),570,25,0,0,40),Y.gi().Draw(t+20,s),s=this.iY+this.iH-150,gn.xani_nui5.DrawAnimaEx(t+15,s,"分隔线",0,101,55,1,0,0,0),s+=10,this.pm3f.DrawTextEx(t+15,s,"主要获取途径",4294967295,20,101,1,1,0,0,0),s+=30,this.DrawPublicFrame(t+15,s,580,50,this.aa_f2,20,20),this.pm3f.DrawTextEx(t+15+290,s+25,"装备打造",4294967295,20,101,1,1,0,-2,-2);break;case 4:for(this.iSRX=this.iX+50,this.iSRY=this.iY+80,this.iSRW=236,this.iSRH=430,this.pm3f.SetViewClip(this.iSRX,this.iSRY,this.iSRX+this.iSRW,this.iSRY+this.iSRH),this.iSHeight=92*this.s2_skills5.length,this.bScorlling=!0,i=0;i<this.s2_skills5.length;i++)t=this.iX+50,s=this.iY+80+92*i-this.iSOffY,this.btn2_jnlist[i].Move(t,s,236,87),s+94<this.iSRY||s>this.iSRY+this.iSRH||(this.i2SkillPoint==i&&(this.btn2_jnlist[i].bMouseDown=!0),this.btn2_jnlist[i].Draw(),gn.xani_nui2.DrawAnimaEx(t+4+6,s+3+7,"技能框",0,101,.85,.85,0,0,0),gn.xani_nicon.DrawAnimaEx(t+4+6,s+3+7,gn.de_skill.strValue(this.s2_skills5[i],0,5),0,101,.85,.85,0,0,0),this.pm3f.DrawTextEx(t+100,s+43.5,gn.de_skill.strValue(this.s2_skills5[i],0,6),4294967295,25,101,1,1,0,0,-2));this.pm3f.NoClip(),i=this.i2SkillPoint,t=this.iX+290,s=this.iY+75,this.DrawPublicFrame(t,s,610,430,this.aa_f1,20,20),gn.xani_nui2.DrawAnimaEx(t+20,s+20,"技能框",0,101,1,1,0,0,0),gn.xani_nicon.DrawAnimaEx(t+20,s+20,gn.de_skill.strValue(this.s2_skills5[i],0,5),0,101,1,1,0,0,0),this.pm3f.DrawTextEx(t+120,s+20+40,gn.de_skill.strValue(this.s2_skills5[i],0,6),4294967295,30,101,1,1,0,0,-2),gn.xani_nui5.DrawAnimaEx(t+15,s+20+80+20,"分隔线",0,101,55,1,0,0,0),s+=140,this.pm3f.DrawTextEx(t+20,s,"技能描述：",4278190080,25,101,1,1,0,0,0),s+=20,Y.gi().FormatEx("#c000000"+this.s2_details[i][1],570,25,0,0,40),Y.gi().Draw(t+20,s),s=this.iY+this.iH-150,gn.xani_nui5.DrawAnimaEx(t+15,s,"分隔线",0,101,55,1,0,0,0),s+=10,this.pm3f.DrawTextEx(t+15,s,"主要获取途径",4294967295,20,101,1,1,0,0,0),s+=30,this.DrawPublicFrame(t+15,s,580,50,this.aa_f2,20,20),this.pm3f.DrawTextEx(t+15+290,s+25,this.s2_details[i][2],4294967295,20,101,1,1,0,-2,-2)}}Init_3(){var i;for(this.i3Type=0,this.bChangePT=!1,this.btn3_cpt=new Eh(gn.xani_nui5),this.btn3_cpt.Move(this.iX+170,this.iY+50,109,61),this.btn3_cpt.InitButton("新中按钮"),this.btn3_cpt.sName=this.s3_type[0],this.btn3_cpt.iNameSize=20,this.btn3_pts=new Array(4),i=0;i<4;i++)this.btn3_pts[i]=new Eh(gn.xani_nui5),this.btn3_pts[i].Move(this.iX+170+i%2*114,this.iY+50+66*parseInt(i/2),109,61),this.btn3_pts[i].InitButton("新中按钮"),this.btn3_pts[i].sName=this.s3_type[i],this.btn3_pts[i].iNameSize=20;for(this.btn3_pets=new Array(36),i=0;i<36;i++)this.btn3_pets[i]=new Eh(gn.xani_nui5),this.btn3_pets[i].InitButton("最大按钮");for(this.i3PetPoint=0,this.btn3_skills=new Array(5),i=0;i<5;i++)this.btn3_skills[i]=new Eh(gn.xani_nui5),this.btn3_skills[i].bSingleButton=!0;this.i3ShowSkillDetail=-1}Draw_3(){var i,t,s,e,h;for(this.iSRX=this.iX+50,this.iSRY=this.iY+130,this.iSRW=236,this.iSRH=380,this.pm3f.SetViewClip(this.iSRX,this.iSRY,this.iSRX+this.iSRW,this.iSRY+this.iSRH),this.iSHeight=92*this.s3_petids[this.i3Type].length,this.bScorlling=!0,i=0;i<this.s3_petids[this.i3Type].length;i++)e=this.iX+50,h=this.iY+130+92*i-this.iSOffY,this.btn3_pets[i].Move(e,h,236,87),h+94<this.iSRY||h>this.iSRY+this.iSRH||(this.i3PetPoint==i&&(this.btn3_pets[i].bMouseDown=!0),this.btn3_pets[i].Draw(),gn.xani_nui2.DrawAnima(e+7,h+5,"宠物头像框",0),gn.xani_head.DrawAnima_aa(e+7,h+5,gn.de_pet.strValue(this.s3_petids[this.i3Type][i],0,1),0),this.pm3f.DrawTextEx(e+100,h+43.5,gn.de_pet.strValue(this.s3_petids[this.i3Type][i],0,1),4294967295,25,101,1,1,0,0,-2));this.pm3f.NoClip(),this.DrawPublicFrame(this.iX+290,this.iY+45,610,460,this.aa_f1,20,20),e=this.iX+290,h=this.iY+45,this.DrawPublicFrame(e+15,h+15,130,180,this.aa_f2,20,20),this.pm3f.DrawTextEx(e+15+65,h+15+20,gn.de_pet.strValue(this.s3_petids[this.i3Type][this.i3PetPoint],0,1),4278190080,20,101,1,1,0,-2,-2),gn.xani_nui2.DrawAnima(e+15+65-40,h+15+40,"宠物头像框",0),gn.xani_head.DrawAnima_aa(e+15+65-40,h+15+40,gn.de_pet.strValue(this.s3_petids[this.i3Type][this.i3PetPoint],0,1),0),this.pm3f.DrawTextEx(e+15+65,h+15+20+80+35,"培养方向:"+this.s3_details[0][this.i3Type][this.i3PetPoint],4278190080,20,101,1,1,0,-2,-2),this.pm3f.DrawTextEx(e+15+65,h+15+20+80+35+25,"携带等级:"+gn.de_pet.strValue(this.s3_petids[this.i3Type][this.i3PetPoint],0,2),4278190080,20,101,1,1,0,-2,-2),e+=145,this.pm3f.DrawTextEx(e+120,h+5,"普通资质",4278190080,25,101,1,1,0,-2,0),E.ui3_Text1_4word(e+10,h+30,110,110,"体质资质",gn.de_pet.strValue(this.s3_petids[this.i3Type][this.i3PetPoint],0,3)+"~"+gn.de_pet.strValue(this.s3_petids[this.i3Type][this.i3PetPoint],0,24)),E.ui3_Text1_4word(e+10,h+30+38,110,110,"法力资质",gn.de_pet.strValue(this.s3_petids[this.i3Type][this.i3PetPoint],0,9)+"~"+gn.de_pet.strValue(this.s3_petids[this.i3Type][this.i3PetPoint],0,25)),E.ui3_Text1_4word(e+10,h+30+76,110,110,"力量资质",gn.de_pet.strValue(this.s3_petids[this.i3Type][this.i3PetPoint],0,10)+"~"+gn.de_pet.strValue(this.s3_petids[this.i3Type][this.i3PetPoint],0,22)),E.ui3_Text1_4word(e+10,h+30+114,110,110,"耐力资质",gn.de_pet.strValue(this.s3_petids[this.i3Type][this.i3PetPoint],0,11)+"~"+gn.de_pet.strValue(this.s3_petids[this.i3Type][this.i3PetPoint],0,23)),E.ui3_Text1_4word(e+10,h+30+152,110,110,"敏捷资质",gn.de_pet.strValue(this.s3_petids[this.i3Type][this.i3PetPoint],0,12)+"~"+gn.de_pet.strValue(this.s3_petids[this.i3Type][this.i3PetPoint],0,36)),E.ui3_Text1_4word(e+10,h+30+190,110,110,"成长",Bi.swapcz(gn.de_pet.intValue(this.s3_petids[this.i3Type][this.i3PetPoint],0,13))+"~"+Bi.swapcz(gn.de_pet.intValue(this.s3_petids[this.i3Type][this.i3PetPoint],0,21))),e+=225,this.pm3f.DrawTextEx(e+110,h+5,"变异资质",4278190080,25,101,1,1,0,-2,0),i=gn.de_pet.intValue(this.s3_petids[this.i3Type][this.i3PetPoint],0,3),t=gn.de_pet.intValue(this.s3_petids[this.i3Type][this.i3PetPoint],0,24),E.ui3_Text1_4word(e+10,h+30,110,110,"体质资质",i+(t-i)/2+"~"+(t+300)),i=gn.de_pet.intValue(this.s3_petids[this.i3Type][this.i3PetPoint],0,9),t=gn.de_pet.intValue(this.s3_petids[this.i3Type][this.i3PetPoint],0,25),E.ui3_Text1_4word(e+10,h+30+38,110,110,"法力资质",i+(t-i)/2+"~"+(t+200)),i=gn.de_pet.intValue(this.s3_petids[this.i3Type][this.i3PetPoint],0,10),t=gn.de_pet.intValue(this.s3_petids[this.i3Type][this.i3PetPoint],0,22),E.ui3_Text1_4word(e+10,h+30+76,110,110,"力量资质",i+(t-i)/2+"~"+(t+100)),i=gn.de_pet.intValue(this.s3_petids[this.i3Type][this.i3PetPoint],0,11),t=gn.de_pet.intValue(this.s3_petids[this.i3Type][this.i3PetPoint],0,23),E.ui3_Text1_4word(e+10,h+30+114,110,110,"耐力资质",i+(t-i)/2+"~"+(t+100)),i=gn.de_pet.intValue(this.s3_petids[this.i3Type][this.i3PetPoint],0,12),t=gn.de_pet.intValue(this.s3_petids[this.i3Type][this.i3PetPoint],0,36),E.ui3_Text1_4word(e+10,h+30+152,110,110,"敏捷资质",i+(t-i)/2+"~"+(t+100)),E.ui3_Text1_4word(e+10,h+30+190,110,110,"成长",Bi.swapcz(gn.de_pet.intValue(this.s3_petids[this.i3Type][this.i3PetPoint],0,13))+"~"+Bi.swapcz(gn.de_pet.intValue(this.s3_petids[this.i3Type][this.i3PetPoint],0,21))),e=this.iX+290,h+=238,this.pm3f.DrawTextEx(e+15,h-5,"可能携带技能：",4278190080,20,101,1,1,0,0,0),this.DrawPublicFrame(e+15,h+25,580,100,this.aa_f2,20,20),s=0;var a=-1,n=-1,o=-1;for(i=0;i<5;i++)(t=gn.de_pet.intValue(this.s3_petids[this.i3Type][this.i3PetPoint],0,14+i))<=0||(gn.xani_nui2.DrawAnimaEx(e+20+95*s+5,h+35,"技能框",0,101,1,1,0,0,0),gn.xani_nicon.DrawAnimaEx(e+20+95*s+5,h+35,gn.de_skill.strValue(t,0,5),0,101,1,1,0,0,0),this.btn3_skills[i].Move(e+20+95*s+5,h+35,90,90),this.btn3_skills[i].bMouseDown&&(o=t,a=e+20+95*s+5,n=h+35),s++);if(this.i3SkillCount=s,h+=107,this.pm3f.DrawTextEx(e+15,h+35,"加点推荐：",4278190080,20,101,1,1,0,0,0),this.DrawPublicFrame(e+15+130,h+30,450,30,this.aa_f2,20,20),this.pm3f.DrawTextEx(e+15+130+225,h+30+15,this.s3_details[1][this.i3Type][this.i3PetPoint],4294967295,20,101,1,1,0,-2,-2),h+=42,this.pm3f.DrawTextEx(e+15,h+35,"宠物获取途径：",4278190080,20,101,1,1,0,0,0),this.DrawPublicFrame(e+15+130,h+30,450,30,this.aa_f2,20,20),this.pm3f.DrawTextEx(e+15+130+225,h+30+15,this.s3_details[2][this.i3Type][this.i3PetPoint],4294967295,20,101,1,1,0,-2,-2),this.pm3f.DrawTextEx(this.btn3_cpt.iX-120,this.btn3_cpt.iY+30.5,"选择类型",4294967295,25,101,1,1,0,0,-2),this.DrawPublicFrame(this.btn3_cpt.iX-5,this.btn3_cpt.iY-5,119,71,this.aa_f3,20,20),this.btn3_cpt.sName=this.s3_type[this.i3Type],this.btn3_cpt.Draw(),this.bChangePT)for(this.DrawPublicFrame(this.btn3_cpt.iX-5,this.btn3_cpt.iY-5,233,137,this.aa_f3,20,20),i=0;i<4;i++)this.btn3_pts[i].Draw();o>=0&&Yi.Skill_Detail(o,a,n,-1)}Init_4(){var i;for(this.btn4_stone=new Array(5),i=0;i<5;i++)this.btn4_stone[i]=new Eh(gn.xani_nui5),this.btn4_stone[i].InitButton("最大按钮");this.i4StonePoint=0}Draw_4(){var i,t,s;for(this.iSRX=this.iX+50,this.iSRY=this.iY+50,this.iSRW=236,this.iSRH=460,this.pm3f.SetViewClip(this.iSRX,this.iSRY,this.iSRX+this.iSRW,this.iSRY+this.iSRH),this.iSHeight=92*this.i4_ids.length,this.bScorlling=!0,i=0;i<this.i4_ids.length;i++)t=this.iX+50,s=this.iY+50+92*i-this.iSOffY,this.btn4_stone[i].Move(t,s,236,87),s+94<this.iSRY||s>this.iSRY+this.iSRH||(this.i4StonePoint==i&&(this.btn4_stone[i].bMouseDown=!0),this.btn4_stone[i].Draw(),gn.xani_nui3.DrawAnima(t+4,s+3,"物品格子",0),gn.xani_ngoods.DrawAnima_aa(t+4,s+3,gn.de_goods.strValue(this.i4_ids[i],0,10),0),this.pm3f.DrawTextEx(t+100,s+43.5,gn.de_goods.strValue(this.i4_ids[i],0,4),4294967295,25,101,1,1,0,0,-2));this.pm3f.NoClip(),this.DrawPublicFrame(this.iX+290,this.iY+45,610,460,this.aa_f1,20,20);var e=this.i4_ids[this.i4StonePoint];t=this.iX+290,s=this.iY+45,gn.xani_nui3.DrawAnima(t+15,s+15,"物品格子",0),gn.xani_ngoods.DrawAnima_aa(t+15,s+15,gn.de_goods.strValue(e,0,10),0),this.pm3f.DrawTextEx(t+110,s+15+40,gn.de_goods.strValue(e,0,4),4294967295,30,101,1,1,0,0,-2),gn.xani_nui5.DrawAnimaEx(t+15,s+15+80+15,"分隔线",0,101,55,1,0,0,0),s+=125,Y.gi().FormatEx("#c000000"+this.s4_detail[this.i4StonePoint],570,25,0,0,40),Y.gi().Draw(t+20,s),s=this.iY+this.iH-150,gn.xani_nui5.DrawAnimaEx(t+15,s,"分隔线",0,101,55,1,0,0,0),s+=10,this.pm3f.DrawTextEx(t+15,s,"主要获取途径",4294967295,20,101,1,1,0,0,0),s+=30,this.DrawPublicFrame(t+15,s,580,50,this.aa_f2,20,20),this.pm3f.DrawTextEx(t+15+290,s+25,"封印叔叔任务，保卫西阳活动，交易",4294967295,20,101,1,1,0,-2,-2)}DrawPublicFrame(i,t,s,e,h,a,n){h!=this.aa_f1?h!=this.aa_f2?h!=this.aa_f3?h!=this.aa_f4?(h.iFrame=0,h.DrawEx(-i,t,101,1,1,0,-2,-2),h.iFrame=1,h.DrawEx(i+s/2-a/2,t,101,1*(s-2*a)/a,1,0,-2,-2),h.iFrame=2,h.DrawEx(i+s-a,t,101,1,1,0,-2,-2),h.iFrame=3,h.DrawEx(i+s-a,t+e/2-n/2,101,1,1*(e-2*n)/n,0,-2,-2),h.iFrame=4,h.DrawEx(-(i+s-a),t+e-n,101,1,1,0,-2,-2),h.iFrame=5,h.DrawEx(i+s/2-a/2,t+e-n,101,1*(s-2*a)/a,1,0,-2,-2),h.iFrame=6,h.DrawEx(i,t+e-n,101,1,1,0,-2,-2),h.iFrame=7,h.DrawEx(-i,t+e/2-n/2,101,1,1*(e-2*n)/n,0,-2,-2),h==this.aa_f1?c.gi().FillRect_2D(i,t,i+s,t+e,4285052333):(h.iFrame=8,h.DrawEx(i+a-1,t+n-1,101,1*(s-2*a+2)/a,1*(e-2*n+2)/n,0,-1,-1))):c.gi().FillRect_2D(i,t,i+s,t+e,4288401112):c.gi().FillRect_2D(i,t,i+s,t+e,4278190080):c.gi().FillRect_2D(i,t,i+s,t+e,4281844424):c.gi().FillRect_2D(i,t,i+s,t+e,4285052333)}ProcTouch(i,t,s){var e,h;if(this.bScorlling&&this.iSHeight>this.iSRH){if(1==i&&bn.bInRect(t,s,this.iSRX,this.iSRY,this.iSRW,this.iSRH)&&(0==this.iTypePoint&&(this.bLockScorll=!0),this.iLockX=t,this.iLockY=s),2==i&&1==this.iTypePoint&&Math.abs(this.iLockY-s)>10&&bn.bInRect(t,s,this.iSRX,this.iSRY,this.iSRW,this.iSRH))for(this.bLockScorll=!0,e=0;e<this.s1_setids[this.i1LevPoint].length;e++)this.btn1_sets[e].SetNormal();if(2==i&&2==this.iTypePoint&&Math.abs(this.iLockY-s)>10&&bn.bInRect(t,s,this.iSRX,this.iSRY,this.iSRW,this.iSRH))for(this.bLockScorll=!0,e=0;e<64;e++)this.btn2_jnlist[e].SetNormal();if(2==i&&3==this.iTypePoint&&Math.abs(this.iLockY-s)>10&&bn.bInRect(t,s,this.iSRX,this.iSRY,this.iSRW,this.iSRH))for(this.bLockScorll=!0,e=0;e<36;e++)this.btn3_pets[e].SetNormal();if(2==i&&4==this.iTypePoint&&Math.abs(this.iLockY-s)>10&&bn.bInRect(t,s,this.iSRX,this.iSRY,this.iSRW,this.iSRH))for(this.bLockScorll=!0,e=0;e<5;e++)this.btn4_stone[e].SetNormal();if(this.bLockScorll)return 2==i&&(h=this.iSHeight-this.iSRH,this.iSOffY-=s-this.iLockY,this.iLockX=t,this.iLockY=s,this.iSOffY<0&&(this.iSOffY=0),this.iSOffY>h&&(this.iSOffY=h)),3==i&&(this.bLockScorll=!1),!0}switch(this.iTypePoint){case 0:for(e=0;e<5;e++)this.btn0_levs[e].ProcTouch(i,t,s)&&this.btn0_levs[e].bCheck()&&(this.i0LevPoint=e,this.iSOffY=0);break;case 1:if(this.bChangeLev){for(e=0;e<9;e++)this.btn1_levs[e].ProcTouch(i,t,s)&&this.btn1_levs[e].bCheck()&&(this.btn1_levs[e].SetNormal(),this.bChangeLev=!1,this.i1LevPoint=e,this.i1SetPoint=0,this.iSOffY=0);return bn.bInRect(t,s,this.btn1_clev.iX,this.btn1_clev.iY,342,198)||(this.bChangeLev=!1),!0}if(bn.bInRect(t,s,this.iSRX,this.iSRY,this.iSRW,this.iSRH))for(e=0;e<this.s1_setids[this.i1LevPoint].length;e++)this.btn1_sets[e].ProcTouch(i,t,s)&&this.btn1_sets[e].bCheck()&&(this.i1SetPoint=e);if(this.btn1_clev.ProcTouch(i,t,s))return this.btn1_clev.bCheck()&&(this.btn1_clev.SetNormal(),this.bChangeLev=!0),!0;break;case 2:for(e=0;e<5;e++)this.btn2_page[e].ProcTouch(i,t,s)&&this.btn2_page[e].bCheck()&&(this.i2PagePoint=e,this.i2SkillPoint=0,this.iSOffY=0);switch(this.i2PagePoint){case 0:if(this.bChangeSchool){for(e=0;e<9;e++)this.btn2_schools[e].ProcTouch(i,t,s)&&this.btn2_schools[e].bCheck()&&(this.btn2_schools[e].SetNormal(),this.bChangeSchool=!1,this.i2SchoolPoint=e,this.i2SkillPoint=0,this.iSOffY=0);return bn.bInRect(t,s,this.btn2_cschool.iX,this.btn2_cschool.iY,342,198)||(this.bChangeSchool=!1),!0}if(bn.bInRect(t,s,this.iSRX,this.iSRY,this.iSRW,this.iSRH))for(e=0;e<this.s2_skills1[this.i2SchoolPoint].length;e++)this.btn2_jnlist[e].ProcTouch(i,t,s)&&this.btn2_jnlist[e].bCheck()&&(this.i2SkillPoint=e);this.btn2_cschool.ProcTouch(i,t,s)&&this.btn2_cschool.bCheck()&&(this.btn2_cschool.SetNormal(),this.bChangeSchool=!0);break;case 1:if(this.bChangeZb){for(e=0;e<2;e++)this.btn2_zbs[e].ProcTouch(i,t,s)&&this.btn2_zbs[e].bCheck()&&(this.btn2_zbs[e].SetNormal(),this.bChangeZb=!1,this.i2ZbPoint=e,this.i2SkillPoint=0,this.iSOffY=0);return bn.bInRect(t,s,this.btn2_czb.iX,this.btn2_czb.iY,228,66)||(this.bChangeZb=!1),!0}if(bn.bInRect(t,s,this.iSRX,this.iSRY,this.iSRW,this.iSRH))for(e=0;e<this.s2_skills2[this.i2ZbPoint].length;e++)this.btn2_jnlist[e].ProcTouch(i,t,s)&&this.btn2_jnlist[e].bCheck()&&(this.i2SkillPoint=e);this.btn2_czb.ProcTouch(i,t,s)&&this.btn2_czb.bCheck()&&(this.btn2_czb.SetNormal(),this.bChangeZb=!0);break;case 2:if(bn.bInRect(t,s,this.iSRX,this.iSRY,this.iSRW,this.iSRH))for(e=0;e<this.s2_skills3.length;e++)this.btn2_jnlist[e].ProcTouch(i,t,s)&&this.btn2_jnlist[e].bCheck()&&(this.i2SkillPoint=e);break;case 3:if(bn.bInRect(t,s,this.iSRX,this.iSRY,this.iSRW,this.iSRH))for(e=0;e<this.s2_skills4.length;e++)this.btn2_jnlist[e].ProcTouch(i,t,s)&&this.btn2_jnlist[e].bCheck()&&(this.i2SkillPoint=e);break;case 4:if(bn.bInRect(t,s,this.iSRX,this.iSRY,this.iSRW,this.iSRH))for(e=0;e<this.s2_skills5.length;e++)this.btn2_jnlist[e].ProcTouch(i,t,s)&&this.btn2_jnlist[e].bCheck()&&(this.i2SkillPoint=e)}break;case 3:if(this.i3ShowSkillDetail=-1,this.bChangePT){for(e=0;e<4;e++)this.btn3_pts[e].ProcTouch(i,t,s)&&this.btn3_pts[e].bCheck()&&(this.btn3_pts[e].SetNormal(),this.bChangePT=!1,this.i3Type=e,this.i3PetPoint=0,this.iSOffY=0);return bn.bInRect(t,s,this.btn3_cpt.iX,this.btn3_cpt.iY,228,132)||(this.bChangePT=!1),!0}if(bn.bInRect(t,s,this.iSRX,this.iSRY,this.iSRW,this.iSRH))for(e=0;e<this.s3_petids[this.i3Type].length;e++)this.btn3_pets[e].ProcTouch(i,t,s)&&this.btn3_pets[e].bCheck()&&(this.i3PetPoint=e);for(e=0;e<this.i3SkillCount;e++)this.btn3_skills[e].ProcTouch(i,t,s)&&this.btn3_skills[e].bCheck()&&(this.i3ShowSkillDetail=e);if(this.btn3_cpt.ProcTouch(i,t,s))return this.btn3_cpt.bCheck()&&(this.btn3_cpt.SetNormal(),this.bChangePT=!0),!0;break;case 4:if(bn.bInRect(t,s,this.iSRX,this.iSRY,this.iSRW,this.iSRH))for(e=0;e<this.i4_ids.length;e++)this.btn4_stone[e].ProcTouch(i,t,s)&&this.btn4_stone[e].bCheck()&&(this.i4StonePoint=e)}for(e=0;e<5;e++)if(this.btn_close.ProcTouch(i,t,s))return this.btn_close.bCheck()&&ln.gi().PopStat(1),!0;for(e=0;e<5;e++)this.btn_type[e].ProcTouch(i,t,s)&&this.btn_type[e].bMouseDown&&(this.iTypePoint=e,this.iSOffY=0);return!1}}xt.Open=function(){ln.gi().PushStat(ln.GS_MAINHELP)};class St{constructor(){}InitData(i,t,s){this.sName=i,this.sMD5=t,this.iFileSize=s,this.iFlag=0}bProcing(){return 10==iFlag}bSuccress(){return 20==iFlag}bFailed(){return 30==iFlag}}class Dt{constructor(){this.iFingerId=Dt.FREEFINGER,this.m_TouchStack=new Array(Dt.MAXTOUCHSTACK);for(var i=0;i<Dt.MAXTOUCHSTACK;i++)this.m_TouchStack[i]=new Object;this.iStackPoint=-1,this.iProcPoint=-1}Push(i,t,s){this.iStackPoint++;var e=this.iStackPoint%Dt.MAXTOUCHSTACK;this.m_TouchStack[e].type=i,this.m_TouchStack[e].x=t,this.m_TouchStack[e].y=s}Pop(){if(this.iProcPoint>=this.iStackPoint)return null;this.iProcPoint++;var i=this.iProcPoint%Dt.MAXTOUCHSTACK;return this.m_TouchStack[i].type==Tt.TYPE_UP&&(this.iFingerId=Dt.FREEFINGER),this.m_TouchStack[i]}TouchDown(i,t,s){this.iFingerId=i,this.Push(Tt.TYPE_DOWN,t,s)}TouchMove(i,t){this.Push(Tt.TYPE_MOVE,i,t)}TouchUp(i,t){this.Push(Tt.TYPE_UP,i,t)}}Dt.FREEFINGER=-1,Dt.MAXTOUCHSTACK=16;class Tt{constructor(){}Init(){this.fingers=new Array(Tt.MAXFINGERCOUNT);for(var i=0;i<Tt.MAXFINGERCOUNT;i++)this.fingers[i]=new Dt}FindSinger(i){for(var t=0;t<Tt.MAXFINGERCOUNT;t++)if(this.fingers[t].iFingerId==i)return this.fingers[t];return null}_test(){for(var i=0,t=0;t<Tt.MAXFINGERCOUNT;t++)this.fingers[t].iFingerId==Dt.FREEFINGER&&i++;return i+","+this.fingers[0].iProcPoint+","+this.fingers[0].iStackPoint}TouchDown(i,t,s){var e=this.FindSinger(Dt.FREEFINGER);null!=e&&e.TouchDown(i,t,s),Tt.TOUCH_STAT=1}TouchMove(i,t,s){var e=this.FindSinger(i);null!=e&&e.TouchMove(t,s),3!=Tt.TOUCH_STAT&&(Tt.TOUCH_STAT=2)}TouchUp(i,t,s){var e=this.FindSinger(i);null!=e&&e.TouchUp(t,s),Tt.TOUCH_STAT=3}PopTouch(){var i;for(i=0;i<Tt.MAXFINGERCOUNT;i++){var t=this.fingers[i].Pop();if(null!=t)return t}return null}}Tt.TOUCH_STAT=3,Tt.MAXFINGERCOUNT=8,Tt.TYPE_DOWN=1,Tt.TYPE_MOVE=2,Tt.TYPE_UP=3,Tt.TOUCH_DOWN=1,Tt.TOUCH_MOVE=2,Tt.TOUCH_UP=3,Tt.ptouch=null,Tt.gi=function(){return null==Tt.ptouch&&(Tt.ptouch=new Tt),Tt.ptouch};class Ct{constructor(){this.startTime=Date.now(),this.frameCount=0}SetError(i){this.iErrorDelay=150,this.sErrorDetail=i}Init(){pi.make_handle(),Laya.timer.frameLoop(3,this,this.OnTimer),Laya.stage.on(Laya.Event.MOUSE_DOWN,this,_mouse_down_func),Laya.stage.on(Laya.Event.MOUSE_MOVE,this,_mouse_move_func),Laya.stage.on(Laya.Event.MOUSE_UP,this,_mouse_up_func),Laya.stage.on(Laya.Event.FOCUS,this,_onFocus),Laya.stage.on(Laya.Event.BLUR,this,_onBlur),Tt.gi().Init()}OnTimer(){pi.HandleLogic2(),fn.gi().Logic(),Ct.iDelay++,h.SYSW=Laya.stage.width,h.SYSH=Laya.stage.height,h.OX=(h.SYSW-1280)/2,yh.BASEW=Laya.stage.width,yh.BASEH=Laya.stage.height,yh.SetScreenMode(6),c.gi().Clear(),gn.gi().GmTimer(),fn.gi().DrawBoundRect(),pi.HandleLogic()}get_file_string(i){var t=this.get_file_data(i);return t.byteToString(t.databuf,t.iLength)}get_file_data(i){for(var t=0;t<Ct.data_all.length;t+=2)if(i==Ct.data_all[t]){var s=u.gi();return s.GetData2(Ct.data_all[t+1]),s.Decode_base64(),s}return null}}function _mouse_down_func(){Gh.gi().touch_down(0,Laya.stage.mouseX,Laya.stage.mouseY)}function _mouse_move_func(){Gh.gi().touch_move(Laya.stage.mouseX,Laya.stage.mouseY)}function _mouse_up_func(){Gh.gi().touch_up(0,Laya.stage.mouseX,Laya.stage.mouseY)}function _onFocus(){}function _onBlur(){}Ct._float=function(i,t){var s=(Ct.iDelay+t)%(2*i);return s<i?s:2*i-s},Ct.data_all=null,Ct.iSlowRate=1,Ct.iSlowDelay=0,Ct.iDelay=0,Ct.pole=null,Ct.gi=function(){return null==Ct.pole&&(Ct.pole=new Ct),Ct.pole};class kt extends s{GetFreeDownload(){var i;for(i=0;i<this.MAXTHREAD;i++)if(this.downlist[i].bwaiting())return this.downlist[i];return null}constructor(){var i;for(super(),this.iStat=0,kt.sLeadAddr="http://"+e.sDSURL+":9999/",kt.sResAddr="http://"+e.sDSURL+":7999/7gol_test/",kt.sLeadAddr=bn.BASE_URL,this.pls=new u(262144),kt.sResSeverList=new Array(16),this.MAXTHREAD=8,this.background=-1,this.iLocalApkVersion=e.APKVersion,this.iLocalResVersion=0,this.iNewApkVersion=-1,this.iNewResVersion=-1,this.downlist=new Array(this.MAXTHREAD),i=0;i<this.MAXTHREAD;i++)this.downlist[i]=new At;this.bCheckFinish=!1,this.btn_ok=new Eh(gn.xani_local),this.btn_ok.InitButton("通用按钮1"),this.btn_ok.sName="确  定",this.btn_ok.iNameSize=yh.WordSize(30),this.btn_cancel=new Eh(gn.xani_local),this.btn_cancel.InitButton("通用按钮1"),this.btn_cancel.sName="取  消",this.btn_cancel.iNameSize=yh.WordSize(30),this.sDetail="",this.iProcTo=-1,this.iRetry=5,this.sError="",this.MAXBUF=65536,this.iThreadStat=0,this.iCheckProc=0}dpics(i){if(this.background<0){var t=bn.grnd(0,5);this.background=c.gi().LoadFromFile("localres/logo/kj"+t+".xxx",-1,!0)}c.gi().DrawImageEx(0,0,0,this.background,0,0,1280,720,101,yh.BASEW/1280,1,0,0,0)}LoadProc(i){console.log("proc to : "+i)}LoadLeadData(i,s){if(null!=s){this.bLoadFinished20=!0,this.pls.GetData3(s),this.iNewApkVersion=this.pls.GetNextInt(),this.iNewResVersion=this.pls.GetNextInt();var e=this.pls.GetNextInt();0==t.QUDAO&&(this.iNewResVersion=e),gn.sLoginIp=this.pls.GetNextString(),gn.iLoginPort=this.pls.GetNextInt(),bn.sop(gn.sLoginIp+"==="+gn.iLoginPort)}else Laya.loader.load(i,Laya.Handler.create(this,this.LoadLeadData,[i]),null,Laya.Loader.BUFFER)}Draw(){if(this.dpics(0),c.gi().CheckImageLoaded(),c.gi().DrawTextEx(12,18,"当前版本：1."+this.iLocalApkVersion+"."+this.iLocalResVersion,4294967295,28,101,1,1,0,0,0),this.iNewApkVersion>=0&&c.gi().DrawTextEx(12,58,"最新版本：1."+this.iNewApkVersion+"."+this.iNewResVersion,4294967295,28,101,1,1,0,0,0),c.gi().DrawTextEx(h.SCRW-168,0,"健康游戏忠告",4294967295,25,101,1,1,0,-2,0),c.gi().DrawTextEx(h.SCRW,30,"抵制不良游戏，拒绝盗版游戏。",4294967295,25,101,1,1,0,-3,0),c.gi().DrawTextEx(h.SCRW,60,"注意自我保护，谨防受骗上当。",4294967295,25,101,1,1,0,-3,0),c.gi().DrawTextEx(h.SCRW,90,"适度游戏益脑，沉迷游戏伤身。",4294967295,25,101,1,1,0,-3,0),c.gi().DrawTextEx(h.SCRW,120,"合理安排时间，享受健康生活。",4294967295,25,101,1,1,0,-3,0),!kt.bInited)return c.gi().DrawTextEx(5,h.SCRH-5,"正在初始化",4294967295,28,101,1,1,0,0,-3),void(kt.bInited=!0);switch(this.iStat){case 0:this.iStat=20,this.sDetail="正在打开";break;case 20:bn.sop(kt.sLeadAddr+"lead.dat"),this.LoadLeadData(kt.sLeadAddr+"lead.dat"),this.bLoadFinished20=!1,this.iStat=21,this.sDetail="正在获取版本信息，请保持网络畅通";break;case 21:this.bLoadFinished20&&(this.iStat=102),this.sDetail="正在对比版本信息，请保持网络畅通";break;case 22:this.bLoadFinished22&&(this.iStat=102),this.sDetail="载入中";break;case 102:gn.gi().InitAnimaAndData()&&(this.iStat=103),this.sDetail="正在载入数据，请保持网络畅通";break;case 103:if(0!=fn.QUDAO)fn.gi().iStat;else if(gn.xntf.bConnected)return ln.gi().PopStat(1),void ln.gi().PushStat(ln.GS_FASTLOGIN);this.sDetail="正在登陆";break;case 200:E.local_titleframe(h.SCRW/2-200,h.SCRH/2-150,400,300,!0),c.gi().DrawText_2(h.SCRW/2,h.SCRH/2-150+yh.WordSize(40),"提  示",4294639564,yh.WordSize(50),101,1,1,0,-2,-2,4,4278542448),Y.gi().FormatEx("#cfaffcc"+this.sDetail,340,yh.WordSize(30),0,0,yh.WordSize(35)),Y.gi().Draw(h.SCRW/2-170,h.SCRH/2-150+100),this.btn_ok.Move(h.SCRW/2-100-70.5,h.SCRH/2+150-49-40,141,49),this.btn_ok.Draw(),this.btn_cancel.Move(h.SCRW/2+100-70.5,h.SCRH/2+150-49-40,141,49),this.btn_cancel.Draw(),this.sDetail=this.sError}if(this.iProcTo>=0&&(this.iProcTo>100&&(this.iProcTo=100),gn.xani_local.DrawAnima(h.SCRW-100,h.SCRH-50,"跑步载入",gn.iDelay),c.gi().DrawTextEx(h.SCRW-100,h.SCRH-50+20,this.iProcTo+"%",4294967295,28,101,1,1,0,-2,-2),c.gi().FillRect_2D(0,h.SCRH-2,this.iProcTo*h.SCRW/100,h.SCRH,4294967040)),200!=this.iStat)switch(gn.iDelay/5%3){case 0:this.sDetail+=".";break;case 1:this.sDetail+="..";break;case 2:this.sDetail+="..."}c.gi().DrawTextEx(5,h.SCRH-5,this.sDetail,4294967295,28,101,1,1,0,0,-3)}ProcTouch(i,t,s){return 200==this.iStat&&(this.btn_ok.ProcTouch(i,t,s)&&this.btn_ok.bCheck()&&(this.iStat=0),this.btn_cancel.ProcTouch(i,t,s)&&this.btn_cancel.bCheck()&&fn.gi().Exit()),!1}run(){for(var i,t;kt.bProcThread;){if(1==this.iThreadStat){var s,h;for(i=0;i<this.iNewFileCount;i++){for(this.iProcTo=100*i/this.iNewFileCount,h=this.pls.mRes.getAssets().open("datapackage/"+this.newfiles[i].sName),s=new FileOutputStream(e.sSDTo+this.newfiles[i].sName);!((t=h.read(this.pls.databuf,0,262144))<=0);)s.write(this.pls.databuf,0,t);s.close(),h.close()}this.iThreadStat=0,this.bCheckFinish=!0}if(2==this.iThreadStat){for(this.iUpdateLength=0,this.iUpdateFileCount=this.iNewFileCount,this.iProcLength=0,this.iProcFileCount=0,i=0;i<this.iNewFileCount;i++)"7gol.apk"!=this.newfiles[i].sName?(this.newfiles[i].iFlag=0,this.iUpdateLength+=this.newfiles[i].iFileSize):(this.newfiles[i].iFlag=50,this.iUpdateFileCount--);this.iCheckProc=0,this.indir(new File(e.sSDTo)),this.iThreadStat=0,this.bCheckFinish=!0}3==this.iThreadStat&&(gn.gp.InitAnimaAndData(),this.iThreadStat=0,this.bCheckFinish=!0),Thread.sleep(100)}}indir(i){var t,s=i.listFiles();for(t=0;t<s.length;t++)s[t].isDirectory()?this.indir(s[t]):kt.checkfile(s[t])}checkfile(i){var t;this.iCheckProc++,this.iProcTo=100*this.iCheckProc/this.iNewFileCount;var s,h,a=i.getPath(),n=0,o=null;for(a=a.substring(e.sSDTo.length,a.length),this.sChecking=a,o=new FileInputStream(i),kt.digest.reset();-1!=(h=o.read(kt.mybuf));)kt.digest.update(kt.mybuf,0,h),n+=h;for(s=bn.toHexString(kt.digest.LeadPage.digest()),o.close(),t=0;t<this.iNewFileCount;t++)if(50!=this.newfiles[t].iFlag&&this.newfiles[t].iFileSize==n&&this.newfiles[t].sMD5.equals(s)&&this.newfiles[t].sName.equals(a))return this.newfiles[t].iFlag=50,this.iUpdateFileCount--,void(this.iUpdateLength-=this.newfiles[t].iFileSize)}savecurrentversion(){var i;for(this.pls.iOffset=0,this.pls.InsertInt(this.iLocalResVersion),this.pls.SaveDataToSD(e.sSDTo+"currentversion.dat"),this.pls.iOffset=0,this.pls.InsertInt(this.iNewFileCount),i=0;i<this.iNewFileCount;i++)this.pls.InsertString(this.newfiles[i].sName),this.pls.InsertString(this.newfiles[i].sMD5);this.pls.SaveDataToSD(e.sSDTo+"currentcheck.dat")}}kt.iCheckCount,kt.iProcDest,kt.iResSeverCount=0,kt.iResSeverPoint=0,kt.apk_path,kt.apk_name,kt.checkfile,kt.CheckFile=function(i){var t,s=getFileMD5(new File(e.sSDTo+i));for(t=0;t<kt.iCheckCount;t++)if(i==kt.checkfile[t].sName){if(s==kt.checkfile[t].sMd5)return!0;break}return new File(e.sSDTo+"currentversion.dat").delete(),fn.gi().Exit(),!1},kt.getFileMD5=function(i){if(!i.isFile())return"false";var t,s,e=null;for(e=new FileInputStream(i),kt.digest.reset();-1!=(s=e.read(kt.mybuf));)kt.digest.update(kt.mybuf,0,s);return t=bn.toHexString(kt.digest.LeadPage.digest()),e.close(),t},kt.iProcDest,kt.sLeadSeverList=["http://"+e.sDSURL+":6666/","http://115.28.16.199:9999/"],kt.iResSeverCount=0,kt.iResSeverPoint=0,kt.sResSeverList=new Array(6),kt.digest,kt.bInited=!1,kt.mybuf=new Int8Array(65536),kt.bProcThread=!0;class At{constructor(){}}class It{constructor(){}}class Pt extends s{constructor(i){super(),Pt.pics=new Array(3);for(var t=0;t<3;t++)Pt.pics[t]=new Int32Array(2);for(Pt.pics[0][0]=-1,Pt.pics[0][1]=-1,this.pm3f=c.xm3f,this.iStat=10,this.downlist=new Array(this.MAXTHREAD),t=0;t<this.MAXTHREAD;t++)this.downlist[t]=new At;this.down_version=new St,this.down_version.InitData("updateversion.dat",null,0),this.down_detail=new St,this.down_detail.InitData("updatedetail.dat",null,0),this.down_apkversion=new St,this.down_apkversion.InitData("apkversion.dat",null,0),this.down_apk=new St,this.down_apk.InitData("7gol.apk",null,0),Pt.digest=MessageDigest.getInstance("MD5"),this.pls=new u(131072),this.fPath=new File(e.sSDTo),this.fPath.exists()||(this.fPath.mkdir(),this.iStat=0),this.fPath.isDirectory()||(this.fPath.delete(),this.fPath.mkdir()),gn.bCheckRes&&(this.fPath=new File(e.sSDTo+"currentcheck.dat"),this.fPath.exists()&&this.fPath.delete(),this.fPath=new File(e.sSDTo+"updateversion.dat"),this.fPath.exists()&&this.fPath.delete(),yh.iNearRoleCount=25),this.fPath=new File(e.sSDTo+"7gol.apk"),this.fPath.exists()&&this.fPath.isDirectory()&&this.fPath.delete(),Pt.mybuf=new Array(this.MAXBUF),this.bCheckFinish=!1,this.thread_check=new Thread(this),this.btn_update=null,this.btn_exit=null,this.bm=!0,this.iRetry=10,this.iDecPoint,this.xdown,this.sError=""}checkfile(i){var t,s,h,a=i.getPath(),n=0,o=null;for(a=a.substring(e.sSDTo.length,a.length),this.sChecking=a,o=new FileInputStream(i),Pt.digest.reset();-1!=(h=o.read(Pt.mybuf));)Pt.digest.update(Pt.mybuf,0,h),n+=h;for(s=bn.toHexString(Pt.digest.MainMenu.digest()),o.close(),t=0;t<this.iNewFileCount;t++)if(50!=this.newfiles[t].iFlag&&this.newfiles[t].iFileSize==n&&this.newfiles[t].sMD5.equals(s)&&this.newfiles[t].sName.equals(a))return this.newfiles[t].iFlag=50,this.iUpdateFileCount--,void(this.iUpdateLength-=this.newfiles[t].iFileSize);gn.sop("delete "+a)}indir(i){var t,s=i.listFiles();for(t=0;t<s.length;t++)s[t].isDirectory()?this.indir(s[t]):Pt.checkfile(s[t])}savecurrentversion(){var i;for(this.pls.iOffset=0,this.pls.InsertInt(this.iOldVersion),this.pls.SaveDataToSD(e.sSDTo+"currentversion.dat"),this.pls.iOffset=0,this.pls.InsertInt(this.iNewFileCount),i=0;i<this.iNewFileCount;i++)this.pls.InsertString(this.newfiles[i].sName),this.pls.InsertString(this.newfiles[i].sMD5);this.pls.SaveDataToSD(e.sSDTo+"currentcheck.dat")}run(){var i;for(this.iUpdateLength=0,this.iUpdateFileCount=this.iNewFileCount,this.iProcLength=0,this.iProcFileCount=0,i=0;i<this.iNewFileCount;i++)"7gol.apk"!=this.newfiles[i].sName?(this.newfiles[i].iFlag=0,this.iUpdateLength+=this.newfiles[i].iFileSize):(this.newfiles[i].iFlag=50,this.iUpdateFileCount--);this.indir(new File(e.sSDTo)),this.bCheckFinish=!0}GetFreeDownload(){var i;for(i=0;i<this.MAXTHREAD;i++)if(this.downlist[i].bwaiting())return this.downlist[i];return null}Draw(){var i,s,a,n,o,r,c,l;switch(null==this.btn_update&&(this.btn_update=new D(gn.xani_back),this.btn_update.InitButton("统一中按钮4"),this.btn_exit=new D(gn.xani_back),this.btn_exit.InitButton("统一中按钮4")),dMainMenu.pics(0),this.iW=h.SCRW/2,this.iH=h.SCRH/2,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.pm3f.FillRect_2D(this.iX,this.iY,this.iX+this.iW,this.iY+this.iH,2147483648),o=this.iX+30,r=this.iY+30,this.iStat){case 0:if(this.pls.InitDataFromResFile("datapackage/updatedetail.dat")){for(this.pls.GetNextInt(),this.pls.GetNextInt(),s=this.pls.GetNextInt(),this.iNewFileCount=this.pls.GetNextInt(),i=0;i<s;i++)this.fPath=new File(e.sSDTo+this.pls.GetNextString()),this.fPath.exists()?this.fPath.isDirectory()||(this.fPath.delete(),this.fPath.mkdir()):this.fPath.mkdir();for(this.newfiles=new Array(this.iNewFileCount),i=0;i<this.iNewFileCount;i++)this.newfiles[i]=new St,this.newfiles[i].sName=this.pls.GetNextString(),this.newfiles[i].sMD5=this.pls.GetNextString(),this.newfiles[i].iFileSize=this.pls.GetNextInt();this.iStat=1,this.iDecPoint=0,this.pm3f.DrawTextEx(this.iX+this.iW/2,this.iY+this.iH/2,"正在解压文件...",4294967295,30,101,1,1,0,-2,-2)}else this.iStat=10;break;case 1:var b,_;for(s=0;s<10;s++){if(this.iDecPoint>=this.iNewFileCount){this.iStat=10;break}for(_=this.pls.mRes.getAssets().open("datapackage/"+this.newfiles[this.iDecPoint].sName),b=new FileOutputStream(e.sSDTo+this.newfiles[this.iDecPoint].sName);!((i=_.read(this.pls.databuf,0,131072))<=0);)b.write(this.pls.databuf,0,i);b.close(),_.close(),this.iDecPoint++}this.pm3f.DrawTextEx(this.iX+this.iW/2,this.iY+this.iH/2,"正在解压文件"+100*this.iDecPoint/this.iNewFileCount+"%",4294967295,30,101,1,1,0,-2,-2);break;case 10:null!=(c=this.GetFreeDownload())&&(c.downloadstart(e.sUpdateSeverList[Pt.iSeverPoint],this.down_version),this.iStat=11,this.xdown=c),this.pm3f.DrawTextEx(this.iX+this.iW/2,this.iY+this.iH/2,"正在检测客户端版本...",4294967295,30,101,1,1,0,-2,-2);break;case 11:if(this.down_version.bSuccress()&&(this.pls.InitDataFromSD(this.xdown.sWriteTo)?(this.iNewVersion=this.pls.GetNextInt(),this.iApkVersion=this.pls.GetNextInt(),this.iStat=12):(this.iStat=200,this.sError="E1:"+this.xdown.sWriteTo)),this.down_version.bFailed()){if(this.iRetry>0){this.iStat=10,this.iRetry--;break}this.iStat=200,this.sError="E2:校验失败"}this.pm3f.DrawTextEx(this.iX+this.iW/2,this.iY+this.iH/2,"正在检测客户端版本...",4294967295,30,101,1,1,0,-2,-2),this.down_version.bProcing()&&this.down_version.iFileSize>0&&this.pm3f.DrawTextEx(this.iX+this.iW/2,this.iY+this.iH/2+40,100*this.down_version.iProc/this.down_version.iFileSize+"%",4294967295,20,101,1,1,0,-2,-2);break;case 12:this.pls.InitDataFromSD(e.sSDTo+"currentversion.dat")?(this.iOldVersion=this.pls.GetNextInt(),this.iNewVersion!=this.iOldVersion?(null!=(c=this.GetFreeDownload())&&(c.downloadstart(e.sUpdateSeverList[Pt.iSeverPoint],this.down_detail),this.iStat=20,this.xdown=c),this.pm3f.DrawTextEx(this.iX+this.iW/2,this.iY+this.iH/2,"正在进行数据校验...",4294967295,30,101,1,1,0,-2,-2)):this.iStat=100):(null!=(c=this.GetFreeDownload())&&(c.downloadstart(e.sUpdateSeverList[Pt.iSeverPoint],this.down_detail),this.iStat=20,this.xdown=c),this.pm3f.DrawTextEx(this.iX+this.iW/2,this.iY+this.iH/2,"正在进行数据校验...",4294967295,30,101,1,1,0,-2,-2));break;case 20:if(this.down_detail.bSuccress())if(this.pls.InitDataFromSD(this.xdown.sWriteTo)){if(this.pls.GetNextInt(),this.pls.GetNextInt(),s=this.pls.GetNextInt(),this.iNewFileCount=this.pls.GetNextInt(),this.iNewFileCount<500){this.iStat=200,this.sError="E8";break}for(i=0;i<s;i++)this.fPath=new File(e.sSDTo+this.pls.GetNextString()),this.fPath.exists()?this.fPath.isDirectory()||(this.fPath.delete(),this.fPath.mkdir()):this.fPath.mkdir();for(this.newfiles=new Array(this.iNewFileCount),i=0;i<this.iNewFileCount;i++)this.newfiles[i]=new St,this.newfiles[i].sName=this.pls.GetNextString(),this.newfiles[i].sMD5=this.pls.GetNextString(),this.newfiles[i].iFileSize=this.pls.GetNextInt();this.sChecking="无",this.bCheckFinish=!1,this.thread_check.start(),this.iStat=21}else this.iStat=200,this.sError="E3:"+this.xdown.sWriteTo;this.pm3f.DrawTextEx(this.iX+this.iW/2,this.iY+this.iH/2,"正在进行数据校验...",4294967295,30,101,1,1,0,-2,-2),this.down_detail.bProcing()&&this.down_detail.iFileSize>0&&this.pm3f.DrawTextEx(this.iX+this.iW/2,this.iY+this.iH/2+40,100*this.down_detail.iProc/this.down_detail.iFileSize+"%",4294967295,20,101,1,1,0,-2,-2),this.down_detail.bFailed()&&(this.iStat=200,this.sError="E4");break;case 21:this.bCheckFinish&&(0==this.iUpdateFileCount?(this.iOldVersion=this.iNewVersion,this.savecurrentversion(),this.iStat=100):this.iStat=30),this.pm3f.DrawTextEx(this.iX+this.iW/2,this.iY+this.iH/2,"正在进行数据校验...",4294967295,30,101,1,1,0,-2,-2),this.pm3f.DrawTextEx(this.iX+this.iW/2,this.iY+this.iH/2+40,this.sChecking,4294967295,20,101,1,1,0,-2,-2);break;case 30:this.pm3f.DrawTextEx(o,r,"有 "+this.iUpdateFileCount+" 个文件需要更新",4294967295,20,101,1,1,0,0,0),this.pm3f.DrawTextEx(o,r+30,"合计下载"+this.iUpdateLength/1024+"K("+this.iUpdateLength/10486*1/100+"M)",4294967295,20,101,1,1,0,0,0),this.pm3f.DrawTextEx(o,r+60,"是否马上更新？",4294967295,20,101,1,1,0,0,0),this.btn_update.Move(this.iX+20,this.iY+this.iH-40-20,130,40),this.btn_update.sName="马上更新",this.btn_update.Draw(),this.btn_exit.Move(this.iX+this.iW-20-130,this.iY+this.iH-40-20,130,40),this.btn_exit.sName="退出游戏",this.btn_exit.Draw();break;case 31:for(s=0,i=0;i<this.iNewFileCount;i++)if(0==this.newfiles[i].iFlag){if(null==(c=this.GetFreeDownload()))break;c.downloadstart(e.sUpdateSeverList[Pt.iSeverPoint],this.newfiles[i])}for(a=0,i=0;i<this.iNewFileCount;i++)10==this.newfiles[i].iFlag?s+=this.newfiles[i].iProc:20==this.newfiles[i].iFlag?(this.iProcLength+=this.newfiles[i].iFileSize,this.iProcFileCount++,this.newfiles[i].iFlag=40):30==this.newfiles[i].iFlag&&(this.newfiles[i].iFlag=0),this.newfiles[i].iFlag<20&&a++;0==a&&(this.iOldVersion=this.iNewVersion,this.savecurrentversion(),this.iStat=100),this.pm3f.DrawTextEx(o,r+0,"总文件数："+this.iProcFileCount+"/"+this.iUpdateFileCount,4294967295,20,101,1,1,0,0,0),i=this.iProcLength+s,s=this.iUpdateLength,this.pm3f.DrawTextEx(o,r+30,"已完成："+i/1024+"K("+i/10486*1/100+"M)",4294967295,20,101,1,1,0,0,0),this.pm3f.DrawTextEx(o,r+60,"总大小："+s/1024+"K("+s/10486*1/100+"M)",4294967295,20,101,1,1,0,0,0),s=this.iUpdateLength-i,i>0&&(this.lnow=bn.get_ms(),this.lcalc=(this.lnow-this.lstart)/1e3,this.lcalc<=0&&(this.lcalc=1),this.pm3f.DrawTextEx(o,r+90,"平均速度："+i/this.lcalc/1024+"K/s",4294967295,20,101,1,1,0,0,0),this.pm3f.DrawTextEx(o,r+120,"已用时间："+bn.SecondToTime(this.lcalc),4294967295,20,101,1,1,0,0,0),this.pm3f.DrawTextEx(o,r+150,"预计还需："+bn.SecondToTime(this.lcalc*s/i),4294967295,20,101,1,1,0,0,0));break;case 32:this.pm3f.DrawTextEx(o,r,"下载出错，检查网络连接是否正常("+this.downlist[0].iEid+")",4294967295,20,101,1,1,0,0,0),this.btn_update.Move(this.iX+20,this.iY+this.iH-40-20,130,40),this.btn_update.sName="重试",this.btn_update.Draw(),this.btn_exit.Move(this.iX+this.iW-20-130,this.iY+this.iH-40-20,130,40),this.btn_exit.sName="退出游戏",this.btn_exit.Draw();break;case 110:if(this.down_apkversion.bSuccress())if(this.pls.InitDataFromSD(e.sSDTo+"apkversion.dat")){for(s=this.pls.GetNextShort(),i=0;i<s;i++)if(a=this.pls.GetNextShort(),n=this.pls.GetNextShort(),this.pls.GetNextString(),a==i&&a==t.QUDAO){e.APKVersion<n?(this.iStat=111,null!=(c=this.GetFreeDownload())&&c.downloadstart(e.sUpdateClientList[Pt.iSeverPoint]+t.QUDAO+"/",this.down_apk)):this.iStat=102;break}}else this.iStat=200,this.sError="E5";this.down_apkversion.bFailed()&&(this.iStat=200,this.sError="E6"),this.pm3f.DrawTextEx(this.iX+this.iW/2,this.iY+this.iH/2,"正在检测客户端版本...",4294967295,30,101,1,1,0,-2,-2),this.down_apkversion.bProcing()&&this.down_apkversion.iFileSize>0&&this.pm3f.DrawTextEx(this.iX+this.iW/2,this.iY+this.iH/2+40,100*this.down_apkversion.iProc/this.down_apkversion.iFileSize+"%",4294967295,20,101,1,1,0,-2,-2);break;case 111:this.down_apk.bSuccress()&&((l=new Intent(Intent.ACTION_VIEW)).setDataAndType(Uri.fromFile(new File(e.sSDTo+"7gol.apk")),"application/vnd.android.package-archive"),fn.mMain.startActivity(l),fn.gi().Exit()),this.down_apk.bFailed()&&(this.iStat=200,this.sError="E7"),this.pm3f.DrawTextEx(this.iX+this.iW/2,this.iY+this.iH/2,"正在下载最新客户端...",4294967295,30,101,1,1,0,-2,-2),this.down_apk.bProcing()&&this.down_apk.iFileSize>0&&this.pm3f.DrawTextEx(this.iX+this.iW/2,this.iY+this.iH/2+40,100*this.down_apk.iProc/this.down_apk.iFileSize+"%",4294967295,20,101,1,1,0,-2,-2);break;case 100:if(t.bAutoUpdateAPK&&(gn.sop1("版本:"+e.APKVersion+","+this.iApkVersion),e.APKVersion<this.iApkVersion)){null!=(c=this.GetFreeDownload())&&c.downloadstart(e.sUpdateClientList[Pt.iSeverPoint],this.down_apkversion),this.pm3f.DrawTextEx(this.iX+this.iW/2,this.iY+this.iH/2,"正在检测客户端版本...",4294967295,30,101,1,1,0,-2,-2),this.iStat=110;break}case 102:if(this.iStat=101,this.pm3f.DrawTextEx(this.iX+this.iW/2,this.iY+this.iH/2,"载入中...",4294967295,30,101,1,1,0,-2,-2),this.pls.InitDataFromSD(e.sSDTo+"currentcheck.dat"))for(Pt.iCheckCount=this.pls.GetNextInt(),Pt.checkfile=new Array(Pt.iCheckCount),i=0;i<Pt.iCheckCount;i++)Pt.checkfile[i]=new It,Pt.checkfile[i].sName=this.pls.GetNextString(),Pt.checkfile[i].sMd5=this.pls.GetNextString();else null!=(c=this.GetFreeDownload())&&(c.downloadstart(e.sUpdateSeverList[Pt.iSeverPoint],this.down_detail),this.iStat=20);break;case 101:Pt.bExitThread=!0,gn.gp.InitAnimaAndData(),this.pm3f.DrawTextEx(this.iX+this.iW/2,this.iY+this.iH/2,"载入中...",4294967295,30,101,1,1,0,-2,-2),ln.gi().PopStat(1),ln.gi().PushStat(ln.GS_FASTLOGIN);break;case 200:this.pm3f.DrawTextEx(o,r,"连接出错，检查网络连接是否正常",4294967295,20,101,1,1,0,0,0),this.sError.length>0&&this.pm3f.DrawTextEx(o,r+50,this.sError,4294967295,20,101,1,1,0,0,0),Pt.iSeverPoint<3&&(Pt.iSeverPoint++,this.iStat=10,this.iRetry=10)}}ProcTouch(i,t,s){if(30==this.iStat||32==this.iStat){if(this.btn_update.ProcTouch(i,t,s))return this.btn_update.bCheck()&&(this.lstart=bn.get_ms(),this.iStat=31),!0;if(this.btn_exit.ProcTouch(i,t,s))return this.btn_exit.bCheck()&&fn.gi().Exit(),!0}return!1}}Pt.iCheckCount,Pt.checkfile,Pt.digest,Pt.mybuf,Pt.bExitThread=!1,Pt.pics,Pt.dpics=function(i){Pt.pics[0][0]<0&&(Pt.pics[0][0]=c.gi().LoadFromFile("bk/aa.xxx",-1,!1)),Pt.pics[0][1]<0&&(Pt.pics[0][1]=c.gi().LoadFromFile("bk/ab.xxx",-1,!1)),c.gi().DrawImageEx(0,0,0,Pt.pics[0][0],0,0,512,480,101,1,1,0,0,0),c.gi().DrawImageEx(0,512,0,Pt.pics[0][1],0,0,288,480,101,1,1,0,0,0)},Pt.CheckFile=function(i){var t,s=getFileMD5(new File(e.sSDTo+i));for(t=0;t<Pt.iCheckCount;t++)if(i==Pt.checkfile[t].sName){if(s==Pt.checkfile[t].sMd5)return!0;break}return new File(e.sSDTo+"currentversion.dat").delete(),fn.gi().Exit(),!1},Pt.getFileMD5=function(i){if(!i.isFile())return"false";var t,s,e=null;for(e=new FileInputStream(i),Pt.digest.reset();-1!=(s=e.read(Pt.mybuf));)Pt.digest.update(Pt.mybuf,0,s);return t=bn.toHexString(Pt.digest.MainMenu.digest()),e.close(),t},Pt.iSeverPoint=0;class Nt{constructor(){}}class vt{constructor(){this.iStat=200,this.down_post=new St,this.down_post.InitData("post.dat",null,0),this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_up=new Eh(gn.xani_nui2),this.btn_up.InitButton("按钮1"),this.btn_up.sName="上一条",this.btn_down=new Eh(gn.xani_nui2),this.btn_down.InitButton("按钮1"),this.btn_down.sName="下一条",this.bLock=!1}Draw(){var i,t;if(!(xh.me.iRid<=0))switch(this.iStat){case 0:kt.bProcThread=!0,this.dproc=new At,this.dproc.downloadstart(kt.sResSeverList[kt.iResSeverPoint],this.down_post),this.iStat=10;break;case 10:if(this.down_post.bSuccress())if((t=gn.gp.pls).InitDataFromSD(this.down_post.sWriteTo)){for(t.GetNextByte(),this.iPostCount=t.GetNextInt(),this.posts=new Array(this.iPostCount),i=0;i<this.iPostCount;i++)this.posts[i]=new Nt,this.posts[i].sTitle=t.GetNextString(),t.GetNextData(),this.posts[i].sDetail=t.DataToString(),this.posts[i].sDate=t.GetNextString(),this.posts[i].sAuthor=t.GetNextString(),this.posts[i].iSeverID=t.GetNextInt(),0!=this.posts[i].iSeverID&&this.posts[i].iSeverID!=ph.iLastSever&&(i--,this.iPostCount--);this.iPostCount>0?(this.iStat=20,this.iPostPoint=this.iPostCount-1,this.iW=400,this.iH=400,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.iTextOff=0,xh.me.rbs.iLev<25&&(this.iStat=200)):this.iStat=200}else this.iStat=200;this.down_post.bFailed()&&(this.iStat=200),this.down_post.bProcing();break;case 20:this.DrawDetail();break;case 200:kt.bProcThread=!1,this.iStat=300}}Clear(){this.iStat<200&&(this.iStat=200)}DrawDetail(){var i,t,s,e;this.iW=800,this.iH=480,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,E.new_bigframe(this.iX,this.iY,this.iW,this.iH),E.new_framein(this.iX+25,this.iY+35,this.iW-50,this.iH-65),gn.xani_nui2.DrawAnima(this.iX+this.iW/2,this.iY,"公告栏标题",0),c.gi().DrawTextEx(this.iX+this.iW/2,this.iY+70,this.posts[this.iPostPoint].sTitle,4294901760,32,101,1,1,0,-2,-2),i=this.iX+25,t=this.iY+95,s=this.iW-50,e=this.iH-200,c.gi().SetViewClip(i,t+5,i+s,t+e-5),Y.gi().FormatEx("#c1e5c6b"+this.posts[this.iPostPoint].sDetail,s-50,25,0,4278190080,32),this.iTextH=Y.gi().iH,this.iTextH+this.iTextOff<e-10&&(this.iTextOff=e-10-this.iTextH),this.iTextOff>0&&(this.iTextOff=0),Y.gi().Draw(i+25,t+5+this.iTextOff),c.gi().NoClip(),this.btn_up.Move(this.iX+100,this.iY+this.iH-100,161,53),this.btn_up.Draw(),this.btn_down.Move(this.iX+this.iW-100-161,this.iY+this.iH-100,161,53),this.btn_down.Draw(),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_close.Draw()}ProcTouch(i,t,s){if(20==this.iStat){if(this.btn_up.ProcTouch(i,t,s))return this.btn_up.bCheck()&&this.iPostPoint>0&&this.iPostPoint--,!0;if(this.btn_down.ProcTouch(i,t,s))return this.btn_down.bCheck()&&this.iPostPoint<this.iPostCount-1&&this.iPostPoint++,!0;if(this.btn_close.ProcTouch(i,t,s))return this.btn_close.bCheck()&&(this.iStat=200),!0;if(2==i&&this.bLock)return this.iTextOff+=s-this.iLockY,this.iLockY=s,!0;if(3==i&&this.bLock)return this.bLock=!1,!0;var e,h,a,n;if(bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH))e=this.iX+20,h=this.iY+60,a=this.iW-40,n=this.iH-60-40-20-10,bn.bInRect(t,s,e,h,a,n)&&1==i&&(this.bLock=!0,this.iLockY=s);else this.iStat=200;return!0}return!1}}vt.gp=null,vt.gi=function(){return null==vt.gp&&(vt.gp=new vt),vt.gp};class Mt{constructor(){}}class yt extends s{constructor(i){var t;for(super(),this.extsel=new Array(3),this.extsel[0]=new _EXTSEL,this.extsel[1]=new _EXTSEL,this.extsel[2]=new _EXTSEL,this.iX=h.SCRW/4,this.iW=3*h.SCRW/5,this.iH=5*h.SCRH/16,this.iY=h.SCRH-this.iH,720==h.SCRH?this.fRate=1:this.fRate=1*h.SCRH/720,this.fRate=1,this.aa=gn.xani_ui4.InitAnimaWithName("琴清",null),this.btn1_aa=gn.xani_ui4.InitAnimaWithName("引导按钮1",null),this.btn2_aa=gn.xani_ui4.InitAnimaWithName("引导按钮2",null),this.btn_sel=new Array(3),t=0;t<3;t++)this.btn_sel[t]=new D(gn.xani_ui),this.btn_sel[t].bSingleButton=!0}Draw(){var i,t,s;for(Z.fm.bShow=!1,L.easymsg.Clear(),i=1,E.ui4_FrameDown(this.iX,this.iY,this.iW,this.iH),this.aa.DrawEx(this.iX,h.SCRH,101,this.fRate,this.fRate,0,0,0),Y.gi().FormatEx("#c00ff00"+this.sDetail,this.iW-100*this.fRate,this.fRate*yt.iWordSize,1,4278190080,this.fRate*(yt.iWordSize+yt.iWordSize/6));Y.gi().iH>this.iH-54*this.fRate-20;)yt.iWordSize--,Y.gi().FormatEx("#c00ff00"+this.sDetail,this.iW-100*this.fRate,this.fRate*yt.iWordSize,1,4278190080,this.fRate*(yt.iWordSize+yt.iWordSize/6));for(Y.gi().Draw(this.iX+90*this.fRate,this.iY+10),t=168*this.fRate,s=54*this.fRate,i=0;i<3;i++)0!=this.extsel[i].type&&(this.btn_sel[i].Move(this.iX+180*this.fRate+(t+10)*i,h.SCRH-s-10,t,s),this.btn_sel[i].bMouseDown?(this.btn1_aa.iFrame=1,this.btn2_aa.iFrame=1):(this.btn1_aa.iFrame=0,this.btn2_aa.iFrame=0),i<2?this.btn1_aa.DrawEx(this.btn_sel[i].iX,this.btn_sel[i].iY,101,this.fRate,this.fRate,0,0,0):this.btn2_aa.DrawEx(this.btn_sel[i].iX,this.btn_sel[i].iY,101,this.fRate,this.fRate,0,0,0),c.gi().DrawText_2(this.btn_sel[i].iX+this.btn_sel[i].iW/2,this.btn_sel[i].iY+this.btn_sel[i].iH/2,this.extsel[i].sel,2147483648,38*this.fRate,101,1,1,0,-2,-2,1,4294967295))}ProcTouch(i,t,s){var e;for(e=0;e<3;e++)if(this.btn_sel[e].ProcTouch(i,t,s)){if(this.btn_sel[e].bCheck())switch(this.extsel[e].type){case 1:1==this.extsel[e].cs&&(Hs.iEventGuide=74),ph.iExtHelp=this.extsel[e].cs,gn.x_record.SaveTo(bn.RECORDFILENAME),ln.gi().PopStat(1);break;case 2:ln.gi().PopStat(1);break;case 3:ln.gi().PopStat(1),Ye.iLastProcBase=-1,Ue.gi().FindNpc(this.extsel[e].cs,!1,!1);break;case 4:PreviousHelp();break;case 5:Hs.iEventGuide=this.extsel[e].cs,ln.gi().PopStat(1)}return!0}return!0}}yt.iWordSize,yt.iShowDelay=0,yt.iHead,yt.iTall,yt.iPrev,yt.extbuf=null,yt.eh,yt.Open=function(){var i,t;if(null==yt.extbuf)for(yt.iHead=0,yt.iTall=0,yt.iPrev=0,yt.extbuf=new Array(8),i=0;i<8;i++)yt.extbuf[i]=new Mt;ln.gi().iXStat!=ln.GS_GAMEING&&ln.gi().iXStat!=ln.GS_MYGOODSFRAME||ws.bFighting||-1==Hs.gi().iGuideing&&(ln.gi().bHaveStat(ln.GS_EXTHELP)||(yt.iShowDelay>0?yt.iShowDelay--:yt.iHead<yt.iTall&&(t=yt.iHead%8,yt.iHead++,yt.eh=ln.gi().PushStat(ln.GS_EXTHELP),_Init(yt.extbuf[t].detail,yt.extbuf[t].type1,yt.extbuf[t].cs1,yt.extbuf[t].s1,yt.extbuf[t].type2,yt.extbuf[t].cs2,yt.extbuf[t].s2,yt.extbuf[t].type3,yt.extbuf[t].cs3,yt.extbuf[t].s3),yt.iShowDelay=20)))},yt.PreviousHelp=function(){if(ln.gi().iXStat==ln.GS_EXTHELP&&!(yt.iPrev<=0||yt.iPrev<=yt.iTall-6)){yt.iPrev--;var i=yt.iPrev%8;0==yt.extbuf[i].type1&&(yt.extbuf[i].type1=4,yt.extbuf[i].s1="上一条"),_Init(yt.extbuf[i].detail,yt.extbuf[i].type1,yt.extbuf[i].cs1,yt.extbuf[i].s1,yt.extbuf[i].type2,yt.extbuf[i].cs2,yt.extbuf[i].s2,yt.extbuf[i].type3,yt.extbuf[i].cs3,yt.extbuf[i].s3)}},yt.Init=function(i){},yt.Initex=function(i,t,s,e,h,a,n,o,r,c){},yt._Init=function(i,t,s,e,h,a,n,o,r,c){yt.eh.sDetail=i,yt.eh.extsel[0].type=t,yt.eh.extsel[0].cs=s,yt.eh.extsel[0].sel=e,yt.eh.extsel[1].type=h,yt.eh.extsel[1].cs=a,yt.eh.extsel[1].sel=n,yt.eh.extsel[2].type=o,yt.eh.extsel[2].cs=r,yt.eh.extsel[2].sel=c,yt.iWordSize=38};class Rt{constructor(){}intValue(i){return parseInt(this.strValue(i))}strValue(i){var t;for(t=0;t<this.iValueCount;t++)if(this.values[t].iVid==i)return this.values[t].sValue;return"-1"}}class Gt{constructor(){}}class Et{constructor(){var i;for(this.bUseing=!1,this.sName="",this.iItemCount=0,this.ni=new Array(Et.MAXNORMALITEM),i=0;i<Et.MAXNORMALITEM;i++)this.ni[i]=new Gt;this.bDetailed=!1}}Et.MAXNORMALITEM=10;class Ot{constructor(){this.sDetail=""}}class Ft{constructor(){var i;for(this.bUseing=!1,this.iItemCount=0,this.si=new Array(Ft.MAXSPECIALITEM),i=0;i<Ft.MAXSPECIALITEM;i++)this.si[i]=new Ot;this.sName="",this.bDetailed=!1}}Ft.MAXSPECIALITEM=10;class Xt extends s{constructor(i){var t;for(super(),this.pani=i,this.pm3f=i.pm3f,Xt.iW=800,Xt.iH=600,Xt.iX=(h.SCRW-Xt.iW)/2,Xt.iY=(h.SCRH-Xt.iH)/2,this.iNameW=130,this.iPoint=-1,this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(Xt.iX+Xt.iW-35,Xt.iY-25,60,60),this.btn_missionNamelist=new Array(Us.MAXMISSIONCOUNT),t=0;t<Us.MAXMISSIONCOUNT;t++)this.btn_missionNamelist[t]=new Eh(gn.xani_nui2),this.btn_missionNamelist[t].InitButton("按钮2");for(this.btn_sort=new Array(3),t=0;t<3;t++)this.btn_sort[t]=new D(gn.xani_ui),this.btn_sort[t].InitButton("htab4"),this.btn_sort[t].Move(Xt.iX+Xt.iW-15,Xt.iY+50*t+20,140,50);for(this.btn_sort[0].sName="全部",this.btn_sort[1].sName="门派任务",this.btn_sort[2].sName="剧情任务",this.btn_cancel=new Eh(gn.xani_nui2),this.btn_cancel.InitButton("按钮1"),this.btn_cancel.sName="取消任务",this.btn_cancel.Move(Xt.iX+Xt.iW-25-20-110-195-195,Xt.iY+Xt.iH-25-20-53,161,53),this.btn_findway=new Eh(gn.xani_nui2),this.btn_findway.InitButton("按钮1"),this.btn_findway.sName="自动寻路",this.btn_findway.Move(Xt.iX+Xt.iW-25-20-110-195,Xt.iY+Xt.iH-25-20-53,161,53),this.btn_prompt=new Eh(gn.xani_nui2),this.btn_prompt.InitButton("按钮1_110"),this.btn_prompt.sName="提 示",this.btn_prompt.Move(Xt.iX+Xt.iW-25-20-110,Xt.iY+Xt.iH-25-20-53,110,53),this.bOpenPrompt=!1,this.bShowPrompt=!1,this.btn_page=new Array(2),t=0;t<2;t++)this.btn_page[t]=new Eh(gn.xani_nui2),this.btn_page[t].InitButton("右侧标签"),this.btn_page[t].Move(Xt.iX+Xt.iW-15,Xt.iY+40+125*t,50,140);for(this.btn_go=new Eh(gn.xani_button),this.btn_go.InitButton("普通按钮140_55"),this.btn_go.sName="前往",this.iPage=0,this.iScrollY=0,this.iLockStat=0,this.pc_main=Ei.pxe.FindMain("七国"),this.pc_mission=this.pc_main.FindFirst("可接任务列表",3),this.btn_price=new Array(5),t=0;t<5;t++)this.btn_price[t]=new Eh(gn.xani_button),this.btn_price[t].bSingleButton=!0;this.pc_price=new Array(5),this.ishowdetail=-1,this.gd=new Li}DrawNormalMission(i){var t,s,e=Us.de_mission.fdata(i.iMPoint);for(Y.gi().FormatEx(Us.de_mission.strValue(i.iMPoint,0,23),this.iDw-20,24,0,0,32),Y.gi().Draw(this.iDx1+10,this.iDy1+10),s="",this.bOpenPrompt&&(this.sPrompt="提示：#e"),t=0;t<i.iItemCount;t++){var h=e.fitem(i.ni[t].iItemId);if(null!=h)switch(h.iType){case 10:if(Ue.gi().iDestNpcId=e.intValue(5),Ue.gi().sDestDetail=e.strValue(16),this.bCanFindWay=!0,s+="#e#cffffff目标"+(t+1)+":#c00ff00"+h.strValue(16),this.bOpenPrompt)a=h.intValue(5),n=gn.de_npc.intValue(a,0,4),o=gn.de_npc.intValue(a,0,5),r=gn.de_npc.intValue(a,0,6),this.sPrompt+="#cff0000"+gn.de_npc.strValue(a,0,1)+"#cffffff在#cff0000"+gn.de_map.strValue(n,0,1),o>0&&r>0&&(this.sPrompt+="("+o/16+","+r/16+")");break;case 14:s+="#e#cffffff目标"+(t+1)+":#c00ff00"+h.strValue(17),this.bOpenPrompt&&(this.sPrompt+="#cff0000"+h.strValue(17));break;case 15:Ue.gi().iDestNpcId=e.intValue(33),Ue.gi().sDestDetail=e.strValue(18),this.bCanFindWay=!0,s+="#e#cffffff目标"+(t+1)+":#c00ff00"+h.strValue(18),this.bOpenPrompt&&(this.sPrompt+="#cff0000"+h.strValue(17));break;case 20:var a,n,o,r;if(Ue.gi().iDestNpcId=e.intValue(15),Ue.gi().sDestDetail=e.strValue(24),this.bCanFindWay=!0,s+="#e#cffffff目标"+(t+1)+":#c00ff00"+h.strValue(24),this.bOpenPrompt)a=h.intValue(15),n=gn.de_npc.intValue(a,0,4),o=gn.de_npc.intValue(a,0,5),r=gn.de_npc.intValue(a,0,6),this.sPrompt+="#cff0000"+gn.de_npc.strValue(a,0,1)+"#cffffff在#cff0000"+gn.de_map.strValue(n,0,1),o>0&&r>0&&(this.sPrompt+="("+o/16+","+r/16+")"),this.sPrompt+="#e#c0000ff需战斗#e建议组队前往";break;case 26:s+="#e#cffffff目标"+(t+1)+":#c00ff00"+h.strValue(32)}}if(this.bOpenPrompt&&(this.bOpenPrompt=!1,this.bShowPrompt=!0),s.length>2)do{if("#e"!=s.substring(0,2))break;s=s.substring(2,s.length)}while(s.length>2);Y.gi().FormatEx(s,this.iDw-20,24,0,0,26),Y.gi().Draw(this.iDx2+10,this.iDy2+10)}DrawSpecialMission(i){var t,s,e;for(Y.gi().FormatEx(i.sDetail,this.iDw-20,24,0,0,32),Y.gi().Draw(this.iDx1+10,this.iDy1+10),e="",this.bCC(i.iMPoint)&&(this.bCanCancel=!0,this.iCancelMid=i.iMid),this.bOpenPrompt&&(this.sPrompt="提示：#e"),t=0;t<i.iItemCount;t++)if(0==i.si[t].iMType)if(9==i.si[t].iSType)e+="#e#cffffff目标"+(t+1)+":#c00ff00"+i.si[t].sDetail+"("+i.si[t].iProc+"/"+i.si[t].iV2+")";else if(i.si[t].iProc>=100)e+="#e#cffffff目标"+(t+1)+":#c00ff00"+i.si[t].sDetail+"(已完成)";else{switch(i.si[t].iSType){case 1:case 5:case 7:case 8:Ue.gi().iDestNpcId=i.si[t].iV1,Ue.gi().sDestDetail=i.si[t].sDetail,this.bCanFindWay=!0;break;case 12:s=(i.si[t].iV1-(gn.iNowMillis-xh.iMillis)/1e3-xh.iSecond)/60,i.si[t].sDetail="剩余"+s+"分钟"}if(e+="#e#cffffff目标"+(t+1)+":#cffff00"+i.si[t].sDetail,this.bOpenPrompt)switch(i.si[t].iSType){case 0:var h;if((h=gn.de_goods.intValue(i.si[t].iV1,0,16))>=0){switch(this.sPrompt+="#e#cffffff装备可通过图纸+材料打造获得",gn.de_goods.intValue(i.si[t].iV1,0,9)){case 0:this.sPrompt+="#e#cffffff0级装备可在乡水镇装备商人处购买";break;case 10:this.sPrompt+="#e#cffffff10级装备可在西阳城装备商人处购买";break;case 20:this.sPrompt+="#e#cffffff20级装备可在郢城装备商人处购买";break;case 30:this.sPrompt+="#e#cffffff30级装备可在临淄城装备商人处购买";break;case 40:this.sPrompt+="#e#cffffff40级装备可在咸阳城装备商人处购买"}break}if((h=gn.de_goods.intValue(i.si[t].iV1,0,27))>=0){if(h<=2)switch(i.si[t].iV1){case 65:this.sPrompt+="#e#cffffff竹叶可在【乡水镇】药品商购买";break;case 66:this.sPrompt+="#e#cffffff香草可在【乡水镇】或【西阳城】药品商购买";break;case 67:this.sPrompt+="#e#cffffff薄荷可在【西阳城】或【郢城】药品商购买";break;case 68:this.sPrompt+="#e#cffffff夏枯草可在【乡水镇】药品商购买";break;case 69:this.sPrompt+="#e#cffffff石蜜可在【乡水镇】或【西阳城】药品商购买";break;case 70:this.sPrompt+="#e#cffffff止血草可在【西阳城】药品商购买";break;case 71:this.sPrompt+="#e#cffffff甘草可在【乡水镇】或【郢城】药品商购买";break;case 72:this.sPrompt+="#e#cffffff勺药可在【乡水镇】或【临淄】药品商购买";break;case 73:this.sPrompt+="#e#cffffff蜂蜜可在【西阳城】或【临淄】药品商购买";break;case 74:this.sPrompt+="#e#cffffff松脂可在【西阳城】药品商购买";break;case 75:this.sPrompt+="#e#cffffff云母可在【郢城】药品商购买";break;case 76:this.sPrompt+="#e#cffffff麝香可在【临淄】药品商购买";break;case 77:this.sPrompt+="#e#cffffff赤芝可在【咸阳】药品商购买";break;case 78:this.sPrompt+="#e#cffffff人参可在【郢城】药品商购买";break;case 79:this.sPrompt+="#e#cffffff鹿茸可在【临淄】药品商购买";break;case 80:this.sPrompt+="#e#cffffff熊胆可在【临淄】或【咸阳】药品商购买";break;case 81:this.sPrompt+="#e#cffffff雄黄可在【郢城】或【咸阳】药品商购买";break;case 82:this.sPrompt+="#e#cffffff当归可在【临淄】或【咸阳】药品商购买";break;case 83:this.sPrompt+="#e#cffffff白石英可在【郢城】或【咸阳】药品商购买";break;case 84:this.sPrompt+="#e#cffffff紫石英可在【咸阳】药品商购买"}else this.sPrompt+="3级草药通过挖宝或副本获得";break}if((h=gn.de_goods.intValue(i.si[t].iV1,0,24))>=0){this.sPrompt+=h<=2?"#e#cffffff1级和2级材料可在野外战斗中掉落，也可在挖宝时获得":"3级材料通过挖宝获得或副本掉落";break}break;case 1:case 5:case 7:case 8:var a,n,o,r;a=i.si[t].iV1,n=gn.de_npc.intValue(a,0,4),o=gn.de_npc.intValue(a,0,5),r=gn.de_npc.intValue(a,0,6),this.sPrompt+="#cff0000"+gn.de_npc.strValue(a,0,1)+"#cffffff在#cff0000"+gn.de_map.strValue(n,0,1),o>0&&r>0&&(this.sPrompt+="("+o/16+","+r/16+")");break;case 2:case 6:case 9:this.sPrompt+="仔细查看任务描述";break;case 3:switch(this.sPrompt+="#cffffff",i.si[t].iV1){case 3:this.sPrompt+="野猪在郊外抓";break;case 1:this.sPrompt+="狼在郊外或西阳山道抓";break;case 8:this.sPrompt+="盗贼在西阳山道或渡口抓";break;case 9:this.sPrompt+="僵尸在渡口或大禹水道抓";break;case 10:this.sPrompt+="鲛人在大禹水道或平原山陵抓";break;case 11:this.sPrompt+="花魅在平原山陵或巫山抓";break;case 12:this.sPrompt+="狐狸精在巫山或太行山抓";break;case 2:this.sPrompt+="阴灵在太行山或云蒙山抓";break;case 4:this.sPrompt+="机关兽在云蒙山或烈焰峰抓";break;case 5:this.sPrompt+="火妖在烈焰峰或函谷关抓";break;case 7:this.sPrompt+="修罗在函谷关或长城抓";break;case 14:this.sPrompt+="小刑天在长城或阴山抓";break;case 15:this.sPrompt+="蛟龙在阴山抓"}break;case 4:this.sPrompt+="在任务提示地图来回走动"}}for(e+="#e",t=0;t<i.iItemCount;t++)1==i.si[t].iMType&&(e+="#e任务奖励"+(t+1)+":");if(this.bOpenPrompt&&(this.bOpenPrompt=!1,this.bShowPrompt=!0),e.length>2)do{if("#e"!=e.substring(0,2))break;e=e.substring(2,e.length)}while(e.length>2);Y.gi().FormatEx(e,this.iDw-20,24,0,0,26),Y.gi().Draw(this.iDx2+10,this.iDy2+10)}Draw_0(){var i,t,s,e,h,a,n;for(i=Xt.iX+25+185+20,t=Xt.iY+25,s=Xt.iW-185-50-20,e=Xt.iH-50,this.iDw=s-40,E.new_framein(i,t,s,e),c.gi().DrawText_2(i+20,t+20,"任务描述",4294959264,28,101,1,1,0,0,0,3,4278190080),this.iDx1=i+20,this.iDy1=t+20+30,E.new_frameon(this.iDx1,this.iDy1,this.iDw,180,0),t+=230,c.gi().DrawText_2(i+20,t+20,"任务目标",4294959264,28,101,1,1,0,0,0,3,4278190080),this.iDx2=i+20,this.iDy2=t+20+30,E.new_frameon(this.iDx2,this.iDy2,this.iDw,180,0),i=Xt.iX+25,t=Xt.iY+25,s=185,e=Xt.iH-50,E.new_framein(i,t,s,e),t+=10,E.frame_type1("列表标题a20_50",i+10,t,s-20,20),c.gi().DrawTextEx(i+s/2,t+25,"剧情任务",4294967295,30,101,1,1,0,-2,-2),t+=50,this.iCount=0,h=0;h<Us.MAXMISSIONCOUNT;h++)Us.m.nmlist[h].bUseing&&(a=i+10,n=t,t+=50,this.pm3f.FillRect_2D(a,n,a+s-20,n+50,this.iCount%2==0?4282151834:4285241529),this.iPoint==this.iCount&&(this.DrawNormalMission(Us.m.nmlist[h]),E.frame_type2("黄色透明框a25_25",a,n,s-20,50,25,25)),this.pm3f.DrawTextEx(a+(s-20)/2,n+25,Us.m.nmlist[h].sName,4294967295,25,101,1,1,0,-2,-2),this.btn_missionNamelist[this.iCount].Move(a,n,s-20,50),this.iCount++);for(E.frame_type1("列表标题a20_50",i+10,t,s-20,20),c.gi().DrawTextEx(i+s/2,t+25,"普通任务",4294967295,30,101,1,1,0,-2,-2),t+=50,h=0;h<Us.MAXMISSIONCOUNT;h++)Us.m.smlist[h].bUseing&&(Us.m.smlist[h].iType,a=i+10,n=t,t+=50,this.pm3f.FillRect_2D(a,n,a+s-20,n+50,this.iCount%2==0?4282151834:4285241529),this.iPoint==this.iCount&&(this.DrawSpecialMission(Us.m.smlist[h]),E.frame_type2("黄色透明框a25_25",a,n,s-20,50,25,25)),this.pm3f.DrawTextEx(a+(s-20)/2,n+25,Us.m.smlist[h].sName,4294967295,25,101,1,1,0,-2,-2),this.btn_missionNamelist[this.iCount].Move(a,n,s-20,50),this.iCount++);this.bCanCancel&&this.btn_cancel.Draw(),this.bCanFindWay&&this.btn_findway.Draw(),this.btn_prompt.Draw()}bCC(i){for(var t,s,e,h=this.pc_mission.pca.phead;null!=h;){if(null!=(t=h.FindClass("任务id列表")))for(s=t.pca.phead;null!=s;){if(i==s.iNumber)return null!=(e=h.FindWord("是否可放弃"))&&"是"==e.pword;s=s.pdown}h=h.pdown}return!1}IsInList(i){for(var t,s=i.pca.phead;null!=s;){for(t=0;t<Us.MAXMISSIONCOUNT;t++)if(Us.m.smlist[t].bUseing&&Us.m.smlist[t].iMPoint==s.iNumber)return!0;s=s.pdown}return!1}IsFinished(i){if("门派任务"==i){if(xh.me.iFlag[1]%1e3>=20)return!0}else if("除害任务"==i){if(0!=(64&xh.me.iFlag[12]))return!0}else if("追捕强盗"==i){if(xh.me.iFlag[1]/1e3%1e3>=30)return!0}else if("押镖任务"==i){if(xh.me.iFlag[1]/1e3%1e3>=15)return!0}else if("宝图任务"==i){if((15&xh.me.iFlag[60])>=10)return!0}else if("每日赛跑"==i){if(0!=(32&xh.me.iFlag[15]))return!0}else if("护法任务"==i){if(xh.me.iFlag[9]%1e3>=30)return!0}else if("帮派-玄武任务"==i){if(0!=(2&xh.me.iFlag[15]))return!0}else if("帮派-朱雀任务"==i){if(0!=(4&xh.me.iFlag[15]))return!0}else if("帮派-青龙任务"==i){if(0!=(1&xh.me.iFlag[15]))return!0}else if("帮派-白虎任务"==i){if(0!=(128&xh.me.iFlag[15]))return!0}else if("手艺任务"==i){if(0!=(16&xh.me.iFlag[15]))return!0}else if("执法任务"==i&&xh.me.iFlag[10]%1e3>=10)return!0;return!1}Draw_1(){var i,t,s,e,h,a;i=Xt.iX+25+185+20,t=Xt.iY+25,s=Xt.iW-185-50-20,e=Xt.iH-50,this.iDw=s-40,E.new_framein(i,t,s,e),c.gi().DrawText_2(i+20,t+20,"任务简介",4294959264,28,101,1,1,0,0,0,3,4278190080),this.iDx1=i+20,this.iDy1=t+20+30,E.new_frameon(this.iDx1,this.iDy1,this.iDw,180,0),t+=230,c.gi().DrawText_2(i+20,t+20,"任务奖励",4294959264,28,101,1,1,0,0,0,3,4278190080),this.iDx2=i+20,this.iDy2=t+20+30,E.new_frameon(this.iDx2,this.iDy2,this.iDw,180,0);var n,o,r=this.pc_mission.pca.phead,l=null;for(i=Xt.iX+25,t=Xt.iY+25,s=185,e=Xt.iH-50,E.new_framein(i,t,s,e),t+=10,E.frame_type1("列表标题a20_50",i+10,t,s-20,20),c.gi().DrawTextEx(i+s/2,t+25,"可接任务",4294967295,30,101,1,1,0,-2,-2),t+=50,this.CX=Xt.iX+25,this.CY=Xt.iY+25+10+50,this.CW=185,this.CH=Xt.iH-120,c.gi().SetViewClip(this.CX,this.CY,this.CX+this.CW,this.CY+this.CH),this.iCount=0;null!=r;)n=r.FindNumber("出现等级"),xh.me.rbs.iLev<n.iNumber||this.IsInList(r.FindClass("任务id列表"))||this.IsFinished(r.sName)||(h=i+10,a=t-this.iScrollY,t+=50,this.pm3f.FillRect_2D(h,a,h+s-20,a+50,this.iCount%2==0?4282151834:4285241529),this.iPoint==this.iCount&&(l=r,E.frame_type2("黄色透明框a25_25",h,a,s-20,50,25,25)),this.pm3f.DrawTextEx(h+(s-20)/2,a+25,r.sName,4294967295,25,101,1,1,0,-2,-2),this.btn_missionNamelist[this.iCount].Move(h,a,s-20,50),this.iCount++),r=r.pdown;if(c.gi().NoClip(),this.iPriceCount=0,null!=l){for(o=l.FindWord("任务简介"),Y.gi().FormatEx(o.pword,this.iDw-20,24,0,0,32),Y.gi().Draw(this.iDx1+10,this.iDy1+10),r=(r=l.FindClass("任务奖励")).pca.phead;null!=r;)n=r.FindNumber("物品id"),o=r.FindWord("物品介绍"),gn.xani_nui3.DrawAnima(this.iDx2+50+120*this.iPriceCount,this.iDy2+50,"物品格子",0),gn.xani_ngoods.DrawAnima_aa(this.iDx2+50+120*this.iPriceCount,this.iDy2+50,gn.de_goods.strValue(n.iNumber,0,10),0),this.pc_price[this.iPriceCount]=r,this.btn_price[this.iPriceCount].Move(this.iDx2+50+120*this.iPriceCount,this.iDy2+50,80,80),this.iPriceCount++,r=r.pdown;null!=(n=l.FindNumber("前往npcid"))?(this.iGoToNpcId=n.iNumber,this.btn_go.Move(Xt.iX+Xt.iW-25-140-20,Xt.iY+Xt.iH-25-55-20,140,55),this.btn_go.Draw()):this.iGoToNpcId=-1}this.ishowdetail>=0&&(n=this.pc_price[this.ishowdetail].FindNumber("物品id"),null!=(o=this.pc_price[this.ishowdetail].FindWord("物品介绍"))?qi.new_DrawDetailEx1(n.iNumber,this.btn_price[this.ishowdetail].iX,this.btn_price[this.ishowdetail].iY,o.pword):(this.gd.SetAtt(0,n.iNumber,1,0,0,0,0,0,0,0,0),qi.new_DrawDetail(this.gd,this.btn_price[this.ishowdetail].iX,this.btn_price[this.ishowdetail].iY,0)))}Draw(){var i;for(this.bCanCancel=!1,this.bCanFindWay=!1,E.new_baseframe2(Xt.iX,Xt.iY,Xt.iW,Xt.iH,"任","务"),this.btn_close.Draw(),i=0;i<2;i++)this.iPage==i&&(this.btn_page[i].bMouseIn=!0,this.btn_page[i].bMouseDown=!0),this.btn_page[i].Draw(),E.new_lableword4(Xt.iX+Xt.iW-15,Xt.iY+50+0-4,40,70,0==this.iPage,"已","接","任","务"),E.new_lableword4(Xt.iX+Xt.iW-15,Xt.iY+50+130-8,40,70,1==this.iPage,"可","接","任","务");switch(this.iPage){case 0:this.Draw_0();break;case 1:this.Draw_1()}ei.end(ei.CONFIRM_CANCELMISSION)&&ei.bConfirm&&Mh.gi().s_CancelMission(this.iCancelMid),this.bShowPrompt&&(Z.fm.Open(this.sPrompt),this.bShowPrompt=!1)}ProcTouch(i,t,s){var h;if(this.btn_close.ProcTouch(i,t,s))return this.btn_close.bCheck()&&ln.gi().PopStat(1),!0;for(h=0;h<2;h++)this.btn_page[h].ProcTouch(i,t,s)&&this.btn_page[h].bCheck()&&(this.iPage=h,this.iPoint=0);if(0==this.iPage){if(this.bShowPrompt)return 3==i&&(this.bShowPrompt=!1),!0;for(h=0;h<this.iCount;h++)this.btn_missionNamelist[h].ProcTouch(i,t,s)&&this.btn_missionNamelist[h].bCheck()&&(this.iPoint=h);this.btn_prompt.ProcTouch(i,t,s)&&this.btn_prompt.bCheck()&&(this.bOpenPrompt=!0),this.bCanFindWay&&this.btn_findway.ProcTouch(i,t,s)&&this.btn_findway.bCheck()&&(Ue.gi().FindNpc(Ue.gi().iDestNpcId,!1,!1),ln.gi().PopStat(1)),this.bCanCancel&&this.btn_cancel.ProcTouch(i,t,s)&&this.btn_cancel.bCheck()&&ei.start(ei.CONFIRM_CANCELMISSION,"是否花费10000铜币放弃该任务?")}else if(1==this.iPage){if(this.ishowdetail=-1,2==this.iLockStat)return this.iScrollY+=this.iLockY-s,this.iLockY=s,this.iScrollY>50*this.iCount-this.CH+60&&(this.iScrollY=50*this.iCount-this.CH+60),this.iScrollY<0&&(this.iScrollY=0),3==i&&(this.iLockStat=0),!0;for(h=0;h<this.iCount;h++)this.btn_missionNamelist[h].ProcTouch(i,t,s)&&this.btn_missionNamelist[h].bCheck()&&(this.iPoint=h);for(this.iGoToNpcId>0&&this.btn_go.ProcTouch(i,t,s)&&this.btn_go.bCheck()&&(1e4==this.iGoToNpcId?Ue.gi().FindNpc(e.iMasterids[xh.me.rbs.iSchoolId],!0,!0):Ue.gi().FindNpc(this.iGoToNpcId,!0,!0),ln.gi().PopStat(1)),bn.bInRect(t,s,this.CX,this.CY,this.CW,this.CH)?(1==i&&(this.iLockY=s,this.iLockStat=1),2==i&&1==this.iLockStat&&Math.abs(this.iLockY-s)>15&&(this.iLockStat=2)):this.iLockStat=0,h=0;h<this.iPriceCount;h++)this.btn_price[h].ProcTouch(i,t,s)&&this.btn_price[h].bCheck()&&(this.ishowdetail=h)}return!1}}Xt.Open=function(i){var t=ln.gi().PushStat(ln.GS_MISSIONFRAME);t.iPage=i,t.iPoint=0},Xt.iX,Xt.iY,Xt.iW,Xt.iH;class Yt{constructor(){this.iMid=-1,this.att=new Int32Array(5),this.zz=new Int32Array(5),this.maxzz=new Int32Array(5)}CalcFightAtt(){var i=5*this.iLev,t=this.att[0]+this.att[1]+this.att[2]+this.att[3]+this.att[4];this.nut=i-t,this.tz=this.att[0]+10+this.iLev,this.fl=this.att[1]+10+this.iLev,this.ll=this.att[2]+10+this.iLev,this.nl=this.att[3]+10+this.iLev,this.mj=this.att[4]+10+this.iLev,this.iMaxHp=this.iLev*this.zz[0]+this.tz*this.cz*6,this.iMaxMp=this.iLev*this.zz[1]+this.fl*this.cz*6,this.iSpirit=this.iLev*(this.zz[1]+1640)*(this.cz+1e3)/7500+300*this.tz+700*this.fl+400*this.ll+200*this.nl,this.iSpeed=this.zz[4]*this.mj,this.iAttack=this.iLev*this.zz[2]*(1400+this.cz)/750+this.cz*this.ll,this.iDefence=this.iLev*this.zz[3]*(1900/3+this.cz)/750+this.cz*this.nl*4/3,this.iMaxHp=parseInt((this.iMaxHp+500)/1e3),this.iMaxMp=parseInt((this.iMaxMp+500)/1e3),this.iSpirit=parseInt((this.iSpirit+500)/1e3),this.iAttack=parseInt((this.iAttack+500)/1e3),this.iDefence=parseInt((this.iDefence+500)/1e3),this.iSpeed=parseInt((this.iSpeed+500)/1e3),1==this.iJjLev?this.iMaxLingQi=50:2==this.iJjLev?this.iMaxLingQi=100:3==this.iJjLev&&(this.iMaxLingQi=200)}}class Wt extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=490,this.iH=512,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_feed=new Eh(gn.xani_nui2),this.btn_feed.InitButton("按钮1_110"),this.btn_feed.sName="喂食",this.btn_feed.Move(this.iX+this.iW-110-30,this.iY+this.iH-52-30,110,52),this.lockgoods=null}Draw(){E.new_bigframe(this.iX,this.iY,this.iW,this.iH),c.gi().DrawTextEx(this.iX+30,this.iY+30,"选择丹药或烹饪",4278206039,30,101,1,1,0,0,0),qi.new_DrawGoods(this.iX+30,this.iY+30+30+15,ht.gi().goods[2],null,null),null!=this.lockgoods&&(qi.new_DrawRect(this.iX+30,this.iY+30+30+15,ht.gi().goods[2],this.lockgoods,0),this.btn_feed.Draw()),qi.bShowDetail()&&qi.new_DrawDetail(null,-1,-1,0)}ProcTouch(i,t,s){return null!=this.lockgoods&&this.btn_feed.ProcTouch(i,t,s)?(this.btn_feed.bCheck()&&(Mh.gi().s_FeedMounts(Wt.pms.iMid,this.lockgoods.iGid,this.lockgoods.iTid),ln.gi().PopStat(1)),!0):(this.lockgoods=qi.new_LockGoods(t,s,this.iX+30,this.iY+30+30+15,ht.gi().goods[2],i),qi.NoMove(),3!=i||bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||ln.gi().PopStat(1),!1)}}Wt.pms,Wt.Open=function(i){ln.gi().PushStat(ln.GS_FEEDMOUNTS),Wt.pms=i};class Lt extends s{constructor(i){var t,s;for(super(),this.iW=830,this.iH=620,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new D(gn.xani_button),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_mountslist=new Array(8),t=0;t<8;t++)this.btn_mountslist[t]=new D(gn.xani_button),this.btn_mountslist[t].InitButton("2号按钮150_60"),this.btn_mountslist[t].Move(this.iX+50,this.iY+50+65*t,150,60);for(this.iMountsPoint=0,this.btn_joinfight=new Eh(gn.xani_button),this.btn_joinfight.InitButton("1号按钮90_60"),this.btn_joinfight.Move(this.iX+270-70-30,this.iY+65+200,70,40),this.btn_joinfight.sName="骑乘",this.iPage=0,this.btn_page=new Array(3),t=0;t<3;t++)this.btn_page[t]=new Eh(gn.xani_button),this.btn_page[t].InitButton("2号按钮150_60");for(this.btn_page[0].sName="属性",this.btn_page[1].sName="资质",this.btn_page[2].sName="技能",this.btn_drop=new Eh(gn.xani_button),this.btn_drop.InitButton("1号按钮90_60"),this.btn_drop.Move(this.iX+390+10,this.iY+65+80+200,70,40),this.btn_drop.sName="放生",this.btn_addpoint=new Eh(gn.xani_button),this.btn_addpoint.InitButton("1号按钮90_60"),this.btn_addpoint.Move(this.iX+390+145-35,this.iY+65+80+200,70,40),this.btn_addpoint.sName="加点",this.btn_train=new Eh(gn.xani_button),this.btn_train.InitButton("1号按钮90_60"),this.btn_train.Move(this.iX+390+290-80,this.iY+65+80+200,70,40),this.btn_train.sName="驯养",this.btn_jj=new Eh(gn.xani_button),this.btn_jj.InitButton("1号按钮90_60"),this.btn_jj.Move(this.iX+390+10,this.iY+65+80+200,70,40),this.btn_jj.sName="进阶",this.btn_feed=new Eh(gn.xani_button),this.btn_feed.InitButton("1号按钮90_60"),this.btn_feed.Move(this.iX+390+290-80,this.iY+65+80+200,70,40),this.btn_feed.sName="喂食",this.aa_mts=new Array(6),this.aa_bds=new Array(6),this.aa_cls=new Array(6),t=0;t<6;t++)for(this.aa_mts[t]=new l,this.aa_bds[t]=new l,this.aa_cls[t]=new Array(5),s=0;s<5;s++)this.aa_cls[t][s]=new l;this.aa_weapon=new l,this.bChanged=!0,Lt.cur=this}ChangeColor(i,t,s){var e;if(yh.bShowColor)for(e=0;e<N._CHANGECOLOR[i].length;e++)xh.me.iColor[e]<=0||xh.me.iColor[e]>=6||gn.xani_color[i][xh.me.iColor[e]-1].InitAnimaWithName(N._CHANGECOLOR[i][e]+"_"+t,this.aa_cls[s][e])}DrawColor(i,t,s,e,h,a){var n;if(yh.bShowColor)for(n=0;n<N._CHANGECOLOR[i].length;n++)xh.me.iColor[n]<=0||xh.me.iColor[n]>=6||(this.aa_cls[a][n].iFrame=t,this.aa_cls[a][n].Draw(e,h))}DrawMounts(i,t,s,e,h){var a,n=2*xh.me.iRace+xh.me.iSex,o=xh.face_sti("右下"),r=xh.stat_sti("站立"),c=s.iTid-1,l=s.iJjLev-1,b=0,_=0;for(2==s.iTid&&(_=12),a=0;a<N._ANIMASORT_MOUNT[c][l][r][o].length;a++)"左翅膀"==N._ANIMASORT_MOUNT[c][l][r][o][a]?(e&&gn.xani_nmounts[c][l].InitAnimaWithName(s.iJjLev+"_站立_右下_左翅膀",this.aa_mts[2]),this.aa_mts[2].Draw(i,t+_),this.aa_mts[2].NextFrame(),b++):"右翅膀"==N._ANIMASORT_MOUNT[c][l][r][o][a]?(e&&gn.xani_nmounts[c][l].InitAnimaWithName(s.iJjLev+"_站立_右下_右翅膀",this.aa_mts[3]),this.aa_mts[3].Draw(i,t+_),this.aa_mts[3].NextFrame(),b++):"前"==N._ANIMASORT_MOUNT[c][l][r][o][a]?(e&&gn.xani_nmounts[c][l].InitAnimaWithName(s.iJjLev+"_站立_右下_前",this.aa_mts[0]),this.aa_mts[0].Draw(i,t+_),this.aa_mts[0].NextFrame(),b++):"后"==N._ANIMASORT_MOUNT[c][l][r][o][a]?(e&&gn.xani_nmounts[c][l].InitAnimaWithName(s.iJjLev+"_站立_右下_后",this.aa_mts[1]),this.aa_mts[1].Draw(i,t+_),this.aa_mts[1].NextFrame(),b++):"身体"==N._ANIMASORT_MOUNT[c][l][r][o][a]?(e&&gn.xani_nmounts[c][l].InitAnimaWithName(s.iJjLev+"_站立_右下_身体",this.aa_mts[4]),this.aa_mts[4].Draw(i,t+_),this.aa_mts[4].NextFrame(),b++):"飘带"==N._ANIMASORT_MOUNT[c][l][r][o][a]?(e&&gn.xani_nmounts[c][l].InitAnimaWithName(s.iJjLev+"_站立_右下_飘带",this.aa_mts[5]),this.aa_mts[5].Draw(i,t+_),this.aa_mts[5].NextFrame(),b++):"人前"==N._ANIMASORT_MOUNT[c][l][r][o][a]&&h?(e&&(gn.xani_newrole[n].InitAnimaWithName("骑站立_右下_前",this.aa_bds[0]),this.ChangeColor(n,"骑站立_右下_前",0)),this.aa_bds[0].Draw(i,t+_),this.DrawColor(n,this.aa_bds[0].iFrame,t+b,i,t+_,0),this.aa_bds[0].NextFrame(),b++):"人后"==N._ANIMASORT_MOUNT[c][l][r][o][a]&&h?(e&&(gn.xani_newrole[n].InitAnimaWithName("骑站立_右下_后",this.aa_bds[1]),this.ChangeColor(n,"骑站立_右下_后",1)),this.aa_bds[1].Draw(i,t+_),this.DrawColor(n,this.aa_bds[1].iFrame,t+b,i,t+_,1),this.aa_bds[1].NextFrame(),b++):"人左"==N._ANIMASORT_MOUNT[c][l][r][o][a]&&h?(e&&(gn.xani_newrole[n].InitAnimaWithName("骑站立_右下_左",this.aa_bds[2]),this.ChangeColor(n,"骑站立_右下_左",2)),this.aa_bds[2].Draw(i,t+_),this.DrawColor(n,this.aa_bds[2].iFrame,t+b,i,t+_,2),this.aa_bds[2].NextFrame(),b++):"人右"==N._ANIMASORT_MOUNT[c][l][r][o][a]&&h?(e&&(gn.xani_newrole[n].InitAnimaWithName("骑站立_右下_右",this.aa_bds[3]),this.ChangeColor(n,"骑站立_右下_右",3)),this.aa_bds[3].Draw(i,t+_),this.DrawColor(n,this.aa_bds[3].iFrame,t+b,i,t+_,3),this.aa_bds[3].NextFrame(),b++):"人"==N._ANIMASORT_MOUNT[c][l][r][o][a]&&h?(e&&(gn.xani_newrole[n].InitAnimaWithName("骑站立_右下",this.aa_bds[4]),this.ChangeColor(n,"骑站立_右下",4)),this.aa_bds[4].Draw(i,t+_),this.DrawColor(n,this.aa_bds[4].iFrame,t+b,i,t+_,4),this.aa_bds[4].NextFrame(),b++):"武器"==N._ANIMASORT_MOUNT[c][l][r][o][a]&&h&&(e&&(this.iWeapTid=ht.gi().GetWeaponTid(),this.iWeapTid>=0&&gn.xani_weap[n][N.WeapFlag(this.iWeapTid)].InitAnimaWithName("骑站立_右下",this.aa_weapon)),this.iWeapTid>=0&&(this.aa_weapon.Draw(i,t+_),this.aa_weapon.NextFrame()),b++)}Draw(){if(Ht.mm.iMountsCount<=0)ln.gi().PopStat(1);else{var i;E.new_baseframe2(this.iX,this.iY,this.iW,this.iH,"坐","骑"),this.btn_close.Draw(),E.new_framein(this.iX+25,this.iY+25,190,this.iH-50),this.iMountsPoint>=Ht.mm.iMountsCount&&(this.iMountsPoint=0);var t=Ht.mm.mounts[this.iMountsPoint];for(i=0;i<Ht.mm.iMountsCount;i++)this.btn_mountslist[i].sName=Ht.mm.mounts[i].sName,this.iMountsPoint==i&&(this.btn_mountslist[i].bMouseIn=!0,this.btn_mountslist[i].bMouseDown=!0),this.btn_mountslist[i].Draw();var s=this.iX+25+190+20,e=this.iY+25;for(E.new_framein(s,e,190,this.iH-50),G.DrawAura(0,s+95,e+240,null,0),this.btn_joinfight.Move(s+190-20-90,this.iY+this.iH-50-60,90,60),xh.me.iFightMid==t.iMid?(this.btn_joinfight.sName="下骑",this.DrawMounts(s+95,e+240,t,this.bChanged,!0)):(this.btn_joinfight.sName="骑乘",this.DrawMounts(s+95,e+240,t,this.bChanged,!1)),this.bChanged=!1,this.btn_joinfight.Draw(),E.ui3_Text1(s+10,e+300,70,100,"名称",t.sName),E.ui3_Text1(s+10,e+300+40,70,100,"等级",t.iLev+"/"+t.iMaxLev),E.ui3_Text1(s+10,e+300+80,70,100,"气血",""+t.iMaxHp),E.ui3_Text1(s+10,e+300+120,70,100,"魔法",""+t.iMaxMp),s=this.iX+25+190+20+190+20,E.new_framein(s,e,360,this.iH-50),this.btn_page[this.iPage].bMouseDown=!0,this.btn_page[this.iPage].bMouseIn=!0,0==this.iPage?(Lt.Draw_Base2(s+20,e+20+60+20+40,t),this.btn_drop.Move(s+20,this.iY+this.iH-50-60,90,60),this.btn_addpoint.Move(s+180-45,this.iY+this.iH-50-60,90,60),this.btn_train.Move(s+360-20-90,this.iY+this.iH-50-60,90,60),this.btn_drop.Draw(),this.btn_addpoint.Draw(),this.btn_train.Draw()):1==this.iPage&&(Lt.Draw_Base3(s+20,e+20+60+20,t),this.btn_jj.Move(s+20,this.iY+this.iH-50-60,90,60),this.btn_feed.Move(s+360-20-90,this.iY+this.iH-50-60,90,60),this.btn_jj.Draw(),this.btn_feed.Draw()),this.btn_page[0].Move(s+20,e+20,150,60),this.btn_page[1].Move(s+360-20-150,e+20,150,60),i=0;i<2;i++)this.btn_page[i].Draw();if(ei.end(ei.CONFIRM_DROPMOUNTS)&&ei.bConfirm&&(xh.me.bHaveLock&&xh.me.bLocked?L.easymsg.AddMessage("未解锁不能放生"):(xh.me.iFightMid==t.iMid&&(xh.me.iFightMid=0,xh.me.bsc=!0),Mh.gi().s_DropMounts(t.iMid),Ht.mm.RemoveMounts(t.iMid),this.iMountsPoint=0)),ei.end(ei.CONFIRM_JJMOUNTS)&&ei.bConfirm&&Mh.gi().s_JJMounts(t.iMid),Xi.end(Xi.ADDPOINT_MOUNTS)&&Xi.bConfirm){for(i=0;i<5;i++)t.att[i]+=Xi.iModifys[i];t.CalcFightAtt(),Mh.gi().s_AddMountsPoint(t.iMid,Xi.iModifys[0],Xi.iModifys[1],Xi.iModifys[2],Xi.iModifys[3],Xi.iModifys[4])}}}ProcTouch(i,t,s){var e,h=Ht.mm.mounts[this.iMountsPoint];if(0==this.iPage){if(this.btn_drop.ProcTouch(i,t,s))return this.btn_drop.bCheck()&&ei.start(ei.CONFIRM_DROPMOUNTS,"是否确认放生？"),!0;if(this.btn_train.ProcTouch(i,t,s)){if(this.btn_train.bCheck()){var a=4*h.iLev*10*2+100;h.iLev>=xh.me.rbs.iLev?L.easymsg.AddMessage("坐骑不能超过人物等级"):h.iLev>=h.iMaxLev?L.easymsg.AddMessage("坐骑等级已达上限"):xh.me.rbs.iPower<10?L.easymsg.AddMessage("体力不足10点"):xh.me.rbs.iExp<a?L.easymsg.AddMessage("人物经验不足"):(xh.me.rbs.iExp-=a,h.iExp+=a,xh.me.rbs.iPower-=10,Mh.gi().s_TrainMounts(h.iMid),ln.gi().PushStat(ln.GS_LOADING1))}return!0}this.btn_addpoint.ProcTouch(i,t,s)&&this.btn_addpoint.bCheck()&&(h.nut<=0?L.easymsg.AddMessage("当前没有剩余点数可以加"):Xi.start(Xi.ADDPOINT_MOUNTS,h.tz,h.fl,h.ll,h.nl,h.mj,h.nut))}else if(1==this.iPage){if(this.btn_feed.ProcTouch(i,t,s))return this.btn_feed.bCheck()&&Wt.Open(h),!0;if(this.btn_jj.ProcTouch(i,t,s))return this.btn_jj.bCheck()&&(h.iJjLev>=3?L.easymsg.AddMessage("坐骑已是最高阶"):h.iLev<h.iMaxLev||h.iLingQi<h.iMaxLingQi?Z.fm.Open("坐骑灵气和等级达到上限后才能进阶"):ei.start(ei.CONFIRM_JJMOUNTS,"进阶后#e#c00ff00资质上限=当前资质*110%#e成长上限=当前成长*110%#e#cffffff是否确认进阶？")),!0}for(e=0;e<Ht.mm.iMountsCount;e++)this.btn_mountslist[e].ProcTouch(i,t,s)&&this.btn_mountslist[e].bCheck()&&(this.iMountsPoint=e,this.bChanged=!0);if(this.btn_joinfight.ProcTouch(i,t,s)&&this.btn_joinfight.bCheck()&&(xh.me.iFightMid==h.iMid?(xh.me.iFightMid=0,Mh.gi().s_ChangeFightMounts(0),this.bChanged=!0,xh.me.CalcFightAtt()):ct.gi().bSelling?L.easymsg.AddMessage("摆摊中不能骑乘"):(xh.me.iFightMid=h.iMid,Mh.gi().s_ChangeFightMounts(h.iMid),this.bChanged=!0,xh.me.CalcFightAtt()),xh.me.bsc=!0),this.btn_close.ProcTouch(i,t,s))return this.btn_close.bCheck()&&ln.gi().PopStat(1),!0;for(e=0;e<2;e++)this.btn_page[e].ProcTouch(i,t,s)&&this.btn_page[e].bCheck()&&(this.iPage=e);return!1}}Lt.Draw_Base2=function(i,t,s){E.ui3_Text1(i,t,60,90,"体质",""+s.tz),E.ui3_Text1(i,t+40,60,90,"法力",""+s.fl),E.ui3_Text1(i,t+80,60,90,"力量",""+s.ll),E.ui3_Text1(i,t+120,60,90,"耐力",""+s.nl),E.ui3_Text1(i,t+160,60,90,"敏捷",""+s.mj),E.ui3_Text1(i+170,t,60,90,"灵力",""+s.iSpirit),E.ui3_Text1(i+170,t+40,60,90,"伤害",""+s.iAttack),E.ui3_Text1(i+170,t+80,60,90,"防御",""+s.iDefence),E.ui3_Text1(i+170,t+120,60,90,"速度",""+s.iSpeed),E.ui3_Text1(i+170,t+160,60,90,"剩余",""+s.nut),E.ui3_Text1(i,t+240,120,200,"当前经验",""+s.iExp),E.ui3_Text1(i,t+280,120,200,"升级经验",""+parseInt(e.iUpgradeExp[s.iLev]/3))},Lt.Draw_Base3=function(i,t,s){E.ui3_Text1(i,t+0,120,200,"体质资质",s.zz[0]+"/"+s.maxzz[0]),E.ui3_Text1(i,t+40,120,200,"法力资质",s.zz[1]+"/"+s.maxzz[1]),E.ui3_Text1(i,t+80,120,200,"力量资质",s.zz[2]+"/"+s.maxzz[2]),E.ui3_Text1(i,t+120,120,200,"耐力资质",s.zz[3]+"/"+s.maxzz[3]),E.ui3_Text1(i,t+160,120,200,"敏捷资质",s.zz[4]+"/"+s.maxzz[4]),E.ui3_Text1(i,t+200,120,200,"成长",Bi.swapcz(s.cz)+"/"+Bi.swapcz(s.maxcz)),1==s.iJjLev?E.ui3_Text1(i,t+240,120,200,"阶段","初级"):2==s.iJjLev?E.ui3_Text1(i,t+240,120,200,"阶段","中级"):3==s.iJjLev&&E.ui3_Text1(i,t+240,120,200,"阶段","高级"),E.ui3_Text1(i,t+280,120,200,"灵气",s.iLingQi+"/"+s.iMaxLingQi),E.ui3_Text1(i,t+320,120,200,"饱食度",s.iBSD/10+"/100")};class Ht{constructor(){var i;for(this.iMountsCount=0,this.mounts=new Array(8),i=0;i<8;i++)this.mounts[i]=new Yt}UpdateOneMounts(i){var t,s,e=i.GetNextByte(),h=i.GetNextInt();if(0==e)this.RemoveMounts(h);else{for(t=0;t<8&&this.mounts[t].iMid!=h;t++);if(t>=8)for(t=0;t<8&&!(this.mounts[t].iMid<=0);t++);if(t>=8)return;for(this.mounts[t].iMid=h,this.mounts[t].iTid=i.GetNextShort(),this.mounts[t].sName=i.GetNextString(),this.mounts[t].iJjLev=i.GetNextByte(),this.mounts[t].iLingQi=i.GetNextShort(),s=0;s<5;s++)this.mounts[t].att[s]=i.GetNextShort();for(s=0;s<5;s++)this.mounts[t].zz[s]=i.GetNextShort();for(s=0;s<5;s++)this.mounts[t].maxzz[s]=i.GetNextShort();this.mounts[t].cz=i.GetNextShort(),this.mounts[t].maxcz=i.GetNextShort(),this.mounts[t].iLev=i.GetNextShort(),this.mounts[t].iMaxLev=i.GetNextShort(),this.mounts[t].iExp=i.GetNextInt(),this.mounts[t].iBSD=i.GetNextShort(),this.mounts[t].iFlag=i.GetNextInt(),this.mounts[t].sAnimaName=gn.de_mounts.strValue(this.mounts[t].iTid,0,2),this.mounts[t].CalcFightAtt(),this.mounts[t].iMid==xh.me.iFightMid&&xh.me.CalcFightAtt(),void 0!==Lt&&Lt.cur&&(Lt.cur.bChanged=!0)}for(this.iMountsCount=0,t=0;t<8;t++)this.mounts[t].iMid>0&&this.iMountsCount++}RemoveMounts(i){var t;for(t=0;t<8&&this.mounts[t].iMid!=i;t++);if(!(t>=8)){for(var s=this.mounts[t];t<7;t++)this.mounts[t]=this.mounts[t+1];for(this.mounts[7]=s,this.mounts[7].iMid=-1,this.iMountsCount=0,t=0;t<8;t++)this.mounts[t].iMid>0&&this.iMountsCount++}}FindMounts(i){var t;for(t=0;t<8;t++)if(this.mounts[t].iMid>0&&i==this.mounts[t].iMid)return this.mounts[t];return null}}Ht.mm=new Ht;class Bt{constructor(){this.iRid=0,this.iColor=new Int32Array(10)}copyfrom(i){this.iRid=i.iRid,this.sName=i.sName,this.iRas=i.iRas,this.iSchoolId=i.iSchoolId,this.iLev=i.iLev;for(var t=0;t<10;t++)this.iColor[t]=i.iColor[t];this.iWeapTid=i.iWeapTid,this.sMapName=i.sMapName}}class Vt{constructor(){}}class Ut{constructor(){}}class zt extends s{constructor(i){var t;for(super(),this.MAXALIST=15,this.pani=i,this.pm3f=i.pm3f,this.iW=1100,this.iH=600,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.iPage=0,this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_go=new Eh(gn.xani_nui2),this.btn_go.InitButton("按钮2"),this.btn_go.sName="前往",this.iPoint=0,this.btn_list=new Array(20),t=0;t<20;t++)this.btn_list[t]=new Eh(gn.xani_nui2);for(this.InitBtnAnima(),this.se=new mt,this.se.Init3(0,0,50,50),this.btn_get=new Array(3),t=0;t<3;t++)this.btn_get[t]=new Eh(gn.xani_nui2),this.btn_get[t].bSingleButton=!0;for(this.iShowGet=-1,this.btn_gift=new Eh(gn.xani_nui2),this.btn_gift.InitButton("礼包按钮"),this.btn_gift.sName="领  取",this.btn_page=new Array(4),t=0;t<4;t++)this.btn_page[t]=new Eh(gn.xani_nui2),this.btn_page[t].InitButton("右侧标签");for(this.iPoint2=0,this.iCount2=0,this.btn_week=new Array(7),t=0;t<7;t++)this.btn_week[t]=new Eh(gn.xani_nui2),this.btn_week[t].InitButton("按钮2");for(this.btn_week[0].sName="星期日",this.btn_week[1].sName="星期一",this.btn_week[2].sName="星期二",this.btn_week[3].sName="星期三",this.btn_week[4].sName="星期四",this.btn_week[5].sName="星期五",this.btn_week[6].sName="星期六",this.iWeek=0,this.btn_cont=new Array(7),t=0;t<7;t++)this.btn_cont[t]=new Eh(gn.xani_nui2),this.btn_cont[t].InitButton("按钮2");for(this.btn_cont[0].sName="游戏背景",this.btn_cont[1].sName="新手玩法",this.btn_cont[2].sName="高手进阶",this.btn_cont[3].sName="门派介绍",this.btn_qd=new Eh(gn.xani_nui2),this.btn_qd.InitButton("按钮4"),this.btn_qd.sName="签  到",this.btn_vip=new Eh(gn.xani_nui2),this.btn_vip.InitButton("按钮3"),xh.me.iFlag[40]<=0?this.btn_vip.sName="开通vip":this.btn_vip.sName="续费vip",this.alist=new Array(this.MAXALIST),this.btn_prompt=new Array(this.MAXALIST),this.aprice=new Array(this.MAXALIST),t=0;t<this.MAXALIST;t++)this.alist[t]=new Vt,this.btn_prompt[t]=new Wi(gn.xani_ui3),this.btn_prompt[t].InitButton("统一按钮1"),this.btn_prompt[t].sName="提 示",this.aprice[t]=new Ut}InitBtnAnima(){var i;if(0==this.iPage)for(this.iCount=12,i=0;i<this.iCount;i++)this.btn_list[i].InitButton(zt._ADetail[this.iPage][i][0]);if(1==this.iPage&&(this.iCount2=0,2==this.iWeek&&(this.btn_list[this.iCount2].InitButton(zt._ADetail[this.iPage][0][0]),this.btn_list[this.iCount2].exts[0]=0,this.iCount2++),3==this.iWeek&&(this.btn_list[this.iCount2].InitButton(zt._ADetail[this.iPage][1][0]),this.btn_list[this.iCount2].exts[0]=1,this.iCount2++),6!=this.iWeek&&7!=this.iWeek&&0!=this.iWeek||(this.btn_list[this.iCount2].InitButton(zt._ADetail[this.iPage][2][0]),this.btn_list[this.iCount2].exts[0]=2,this.iCount2++),5!=this.iWeek&&6!=this.iWeek&&7!=this.iWeek&&0!=this.iWeek||(this.btn_list[this.iCount2].InitButton(zt._ADetail[this.iPage][3][0]),this.btn_list[this.iCount2].exts[0]=3,this.iCount2++),this.btn_list[this.iCount2].InitButton(zt._ADetail[this.iPage][4][0]),this.btn_list[this.iCount2].exts[0]=4,this.iCount2++,this.btn_list[this.iCount2].InitButton(zt._ADetail[this.iPage][5][0]),this.btn_list[this.iCount2].exts[0]=5,this.iCount2++,this.btn_list[this.iCount2].InitButton(zt._ADetail[this.iPage][6][0]),this.btn_list[this.iCount2].exts[0]=6,this.iCount2++,this.btn_list[this.iCount2].InitButton(zt._ADetail[this.iPage][7][0]),this.btn_list[this.iCount2].exts[0]=7,this.iCount2++),3==this.iPage)if(0==iBtn3);else if(1==iBtn3)for(this.iCount=9,i=0;i<this.iCount;i++)this.btn_list[i].InitButton(zt._ADetail[2][i][0]);else if(2==iBtn3)for(this.iCount=12,i=0;i<this.iCount;i++)this.btn_list[i].InitButton(zt._ADetail[3][i][0]);else if(3==iBtn3)for(this.iCount=9,i=0;i<this.iCount;i++)this.btn_list[i].InitButton(zt._ADetail[4][i][0])}Draw_0(){var i,t,s,e,h,a,n,o,r;for(a=this.iX+30,n=this.iY+30,o=840,r=300,E.new_framein(a,n,o,r),n=this.iY+300+30+15,r=220,E.new_framein(a,n,o,r),a=this.iX+840+30+15,n=this.iY+30,o=180,r=535,E.new_framein(a,n,o,r),i=0;i<this.iCount;i++)a=this.iX+30+20+i%7*117,n=this.iY+30+18+i/7*140,this.btn_list[i].Move(a,n,100,100),this.btn_list[i].Draw(),gn.xani_nui2.DrawAnima(a+50-39,n+100+3,"活跃进度框",0),this.alist[i].add>0?(c.gi().DrawTextEx(a+50-39+5,n+100+3+15,this.alist[i].proc+"/"+this.alist[i].max,4294967295,18,101,1,1,0,-1,-2),c.gi().DrawTextEx(a+50+39-5,n+100+3+15,"+"+this.alist[i].add,4278255360,18,101,1,1,0,-3,-2)):c.gi().DrawTextEx(a+50,n+100+3+15,this.alist[i].proc+"/"+this.alist[i].max,4294967295,18,101,1,1,0,-2,-2),this.iPoint==i&&(Y.gi().FormatEx("#c003e57"+zt._ADetail[this.iPage][i][1],800,30,0,0,40),Y.gi().Draw(this.iX+30+20,this.iY+300+30+15+20),this.se.Logic(),this.se.Draw(a+50,n+50));for(0!=this.iPoint&&1!=this.iPoint&&2!=this.iPoint&&3!=this.iPoint&&4!=this.iPoint&&6!=this.iPoint&&7!=this.iPoint&&9!=this.iPoint&&10!=this.iPoint&&11!=this.iPoint||(this.btn_go.Move(this.iX+30+840-20-145,this.iY+300+30+15+220-20-56,145,56),this.btn_go.Draw()),a=this.iX+840+30+15,n=this.iY+30,c.gi().DrawText_2(a+90,this.iY+60,"今日活跃度",4282245601,25,101,1,1,0,-2,-2,4,4278206039),c.gi().DrawText_2(a+90,this.iY+95,""+this.iNumber,4294967040,30,101,1,1,0,-2,-2,4,4278206039),s=this.iAPPoint+2>=this.iAPCount?this.iAPPoint+2-this.iAPCount:0,i=0;i<3;i++)t=i+this.iAPPoint-1-s,this.btn_get[i].SetCheckRect(-1,-1,-1,-1),t>=0&&t<this.iAPCount&&(e=a+90,h=n+90+163*i,c.gi().DrawTextEx(e,h-5,"活跃度达到"+this.aprice[t].iNeed+"可领",4278206039,20,101,1,1,0,-2,0),this.btn_get[i].SetCheckRect(a+43,n+110+163*i,94,94),this.btn_get[i].exts[0]=t,gn.xani_nui2.DrawAnima(a+43+7,n+110+163*i+7,"礼品格子",0),i<2&&gn.xani_nui2.DrawAnima(a+43,n+110+163*i,"礼品箭头",0),gn.xani_nui2.DrawAnima(a+43,n+110+163*i,"礼品包包",this.iNumber<this.aprice[t].iNeed?6:t),this.iAPPoint>t&&gn.xani_nui2.DrawAnima(a+43,n+110+163*i,"已领标记",0))}draw_get(i){var t,s,e,a,n=0;t=(h.SCRW-465)/2,s=(h.SCRH-381)/2,gn.xani_nui2.DrawAnima(t,s,"礼包背景框",0),this.aprice[i].iExp>0&&(e=t+60+n%2*190,a=s+100+n/2*100,gn.xani_nui2.DrawAnima(e,a,"礼品格子",1),gn.xani_ngoods.DrawAnima(e,a,"物品经验",0),c.gi().DrawTextEx(e+80,a+80,""+this.aprice[i].iExp,4294967295,20,101,1,1,0,-3,-3),gn.xani_nui2.DrawAnima(e+80+20,a+11,"礼包文本框",0),c.gi().DrawTextEx(e+80+20+30,a+11+11,"经验",4294967295,20,101,1,1,0,-2,-2),gn.xani_nui2.DrawAnima(e+80+20,a+45,"礼包文本框",0),c.gi().DrawTextEx(e+80+20+30,a+45+11,"x 1",4294967295,20,101,1,1,0,-2,-2),n++),this.aprice[i].iMoney>0&&(e=t+60+n%2*190,a=s+100+n/2*100,gn.xani_nui2.DrawAnima(e,a,"礼品格子",1),gn.xani_ngoods.DrawAnima(e,a,"物品钱",0),c.gi().DrawTextEx(e+80,a+80,""+this.aprice[i].iMoney,4294967295,20,101,1,1,0,-3,-3),gn.xani_nui2.DrawAnima(e+80+20,a+11,"礼包文本框",0),c.gi().DrawTextEx(e+80+20+30,a+11+11,"金钱",4294967295,20,101,1,1,0,-2,-2),gn.xani_nui2.DrawAnima(e+80+20,a+45,"礼包文本框",0),c.gi().DrawTextEx(e+80+20+30,a+45+11,"x 1",4294967295,20,101,1,1,0,-2,-2),n++),this.aprice[i].tid1>0&&this.aprice[i].tcount1>0&&(e=t+60+n%2*190,a=s+100+n/2*100,gn.xani_nui2.DrawAnima(e,a,"礼品格子",1),gn.xani_ngoods.DrawAnima_aa(e,a,gn.de_goods.strValue(this.aprice[i].tid1,-1,10),0),gn.xani_nui2.DrawAnima(e+80+20,a+11,"礼包文本框",0),c.gi().DrawTextEx(e+80+20+30,a+11+11,gn.de_goods.strValue(this.aprice[i].tid1,-1,4),4294967295,20,101,1,1,0,-2,-2),gn.xani_nui2.DrawAnima(e+80+20,a+45,"礼包文本框",0),c.gi().DrawTextEx(e+80+20+30,a+45+11,"x "+this.aprice[i].tcount1,4294967295,20,101,1,1,0,-2,-2),n++),this.aprice[i].tid2>0&&this.aprice[i].tcount2>0&&(e=t+60+n%2*190,a=s+100+n/2*100,gn.xani_nui2.DrawAnima(e,a,"礼品格子",1),gn.xani_ngoods.DrawAnima_aa(e,a,gn.de_goods.strValue(this.aprice[i].tid2,-1,10),0),gn.xani_nui2.DrawAnima(e+80+20,a+11,"礼包文本框",0),c.gi().DrawTextEx(e+80+20+30,a+11+11,gn.de_goods.strValue(this.aprice[i].tid2,-1,4),4294967295,20,101,1,1,0,-2,-2),gn.xani_nui2.DrawAnima(e+80+20,a+45,"礼包文本框",0),c.gi().DrawTextEx(e+80+20+30,a+45+11,"x "+this.aprice[i].tcount2,4294967295,20,101,1,1,0,-2,-2),n++),this.btn_gift.Move(t+165.5,s+381-44-40,134,44),this.btn_gift.Draw()}Draw_1(){var i,t,s,e,h;for(t=this.iX+30,s=this.iY+30,e=840,h=300,E.new_framein(t,s,e,h),s=this.iY+300+30+15,h=220,E.new_framein(t,s,e,h),t=this.iX+840+30+15,s=this.iY+30,e=180,h=535,E.new_framein(t,s,e,h),i=0;i<7;i++)this.btn_week[i].Move(this.iX+903,this.iY+52+73*i,145,56),this.iWeek==i&&(this.btn_week[i].bMouseDown=!0),this.btn_week[i].Draw();for(i=0;i<this.iCount2;i++)t=this.iX+30+20+i%7*117,s=this.iY+30+30+i/7*140,this.btn_list[i].Move(t,s,100,100),this.btn_list[i].Draw(),this.iPoint2==i&&(Y.gi().FormatEx("#c003e57"+zt._ADetail[this.iPage][this.btn_list[i].exts[0]][1],800,30,0,0,40),Y.gi().Draw(this.iX+30+20,this.iY+300+30+15+20),this.se.Logic(),this.se.Draw(t+50,s+50))}Draw_3(){var i,t,s,e,h;for(t=this.iX+840+30+15,s=this.iY+30,e=180,h=535,E.new_framein(t,s,e,h),i=0;i<4;i++)this.btn_cont[i].Move(this.iX+903,this.iY+52+73*i,145,56),iBtn3==i&&(this.btn_cont[i].bMouseDown=!0),this.btn_cont[i].Draw();if(0==iBtn3)t=this.iX+30,s=this.iY+30,e=840,h=535,E.new_framein(t,s,e,h),c.gi().DrawText_2(t+e/2,s+40,"游戏背景",4294967040,50,101,1,1,0,-2,-2,3,4278190080),Y.gi().FormatEx("# # #c000000春秋战国期间，七雄争霸，豪杰雄起。谋臣运筹帷幄，将士浴血沙场。战争此起彼伏，局势变化跌宕。#e# # 时代赋予三界风云人物神圣使命去掌控国家生死存亡、左右民族荣辱兴衰。#e# # 人族、魔族、仙族率领九大门派弟子卷入了这场声势浩大的征战之中。#e# # 岁月长河涤荡两千余载，那些璀璨的智慧和生命依然熠熠发光，依然动人心魄......",800,30,0,0,45),Y.gi().Draw(t+20,s+80-15);else if(1==iBtn3||2==iBtn3||3==iBtn3)for(t=this.iX+30,s=this.iY+30,e=840,h=260,E.new_framein(t,s,e,h),s=this.iY+260+30+15,h=260,E.new_framein(t,s,e,h),i=0;i<this.iCount;i++)t=this.iX+30+20+i%7*117,s=this.iY+30+18+i/7*120,this.btn_list[i].Move(t,s,100,100),this.btn_list[i].Draw(),this.iPoint3==i&&(Y.gi().FormatEx("#c003e57"+zt._ADetail[iBtn3+1][i][1],800,30,0,0,40),Y.gi().Draw(this.iX+30+20,this.iY+260+30+15+10),this.se.Logic(),this.se.Draw(t+50,s+50))}Draw_2(){var i,t,s,h,a,n,o,r,l;for(n=this.iX+30,o=this.iY+30,r=360,l=250,E.new_framein(n,o,r,l),gn.xani_nui2.DrawAnima(n+(r-80)/2,o+5,"月份底",0),c.gi().DrawText_2(n+r/2,o+5+16,e.sBigNum[this.iMonth]+"月",4282245605,24,101,1,1,0,-2,-2,3,4278206039),t=this.iTodayWeek-this.iTodayDay;;)if(t>=7)t-=7;else{if(!(t<0))break;t+=7}for(i=0;i<7;i++)c.gi().DrawTextEx(n+45*i+45,o+55,e.sWeek[i],4278206039,20,101,1,1,0,-2,-2);for(this.qdtime=0,i=1;i<=this.iMaxDay;i++)h=n+(s=i+t)%7*45+45,a=o+85+s/7*27-(6==t?27:0),i==this.iTodayDay&&c.gi().FillRect_2D(h-15,a-15,h+15,a+15,805306368),c.gi().DrawTextEx(h,a,""+i,4278190080,20,101,1,1,0,-2,-2),0!=(xh.me.iFlag[50]&1<<i-1)&&(gn.xani_nui2.DrawAnima(h-16,a-15,"签过圈",0),this.qdtime++);for(n+=375,r=380,E.new_framein(n,o,r,l),c.gi().DrawText_2(n+30,o+42,"当前活跃",4282245605,30,101,1,1,0,0,-2,3,4278206039),c.gi().DrawText_2(n+30+120+5,o+42,""+this.iNumber,4294967040,50,101,1,1,0,0,-2,3,4278206039),c.gi().DrawTextEx(n+30+120+5+50+10,o+42,"达到20可签到",4278206039,24,101,1,1,0,0,-2),h=n+35,a=o+85,gn.xani_nui2.DrawAnima(h,a,"礼品格子",0),gn.xani_ngoods.DrawAnima(h,a,"物品经验",0),c.gi().DrawTextEx(h+80,a+80,""+4*xh.me.rbs.iLev*80*2,4294967295,20,101,1,1,0,-3,-3),h+=115,gn.xani_nui2.DrawAnima(h,a,"礼品格子",0),gn.xani_ngoods.DrawAnima(h,a,"物品钱",0),c.gi().DrawTextEx(h+80,a+80,""+4*xh.me.rbs.iLev*80,4294967295,20,101,1,1,0,-3,-3),h+=115,gn.xani_nui2.DrawAnima(h,a,"礼品格子",0),gn.xani_ngoods.DrawAnima(h,a,"双倍经验卡",0),c.gi().DrawTextEx(h+80,a+80,"x1",4294967295,20,101,1,1,0,-3,-3),0!=(xh.me.iFlag[50]&1<<this.iTodayDay-1)?c.gi().DrawTextEx(n+r/2,o+l-42.5,"已签到",4278206039,40,101,1,1,0,-2,-2):(this.btn_qd.Move(n+(r-141)/2,o+l-42.5-24.5,141,49),this.btn_qd.Draw()),n+=395,r=270,E.new_framein(n,o,r,l),i=0;i<7&&!(this.qdtime<zt._SPECIALDAY[i]);i++);for(i<7&&(1==(t=zt._SPECIALDAY[i]-this.qdtime)&&0==(xh.me.iFlag[50]&1<<this.iTodayDay-1)?c.gi().DrawTextEx(n+r/2,o+42,"本次签到可获得",4278206039,24,101,1,1,0,-2,-2):c.gi().DrawTextEx(n+r/2,o+42,"继续签到"+t+"次后可获得",4278206039,24,101,1,1,0,-2,-2),h=n+35,a=o+85,gn.xani_nui2.DrawAnima(h,a,"礼品格子",0),0==i?gn.xani_ngoods.DrawAnima(h,a,"传送符",0):1==i?gn.xani_ngoods.DrawAnima(h,a,"仙灵果",0):2==i?gn.xani_ngoods.DrawAnima(h,a,"替身木偶",0):3==i?gn.xani_ngoods.DrawAnima(h,a,"装备制造图纸",0):4==i?gn.xani_ngoods.DrawAnima(h,a,"青霜丹",0):5==i?gn.xani_ngoods.DrawAnima(h,a,"高级仙灵果",0):6==i&&gn.xani_ngoods.DrawAnima(h,a,"装备制造图纸",0),h+=115,gn.xani_nui2.DrawAnima(h,a,"礼品格子",0),gn.xani_ngoods.DrawAnima(h,a,"三倍经验卡",0),gn.xani_nui2.DrawAnima(h,a,"会员专属",0),this.btn_vip.Move(n+(r-141)/2,o+l-42.5-24.5,141,49),this.btn_vip.Draw()),n=this.iX+30,o+=265,r=this.iW-60,l=280,E.new_framein(n,o,r,l),t=18,i=0;i<7;i++)this.DrawSpecial(n+t+(t+128)*i,o+15,i)}DrawSpecial(i,t,s){var e,h;null==zt.aa_specialframe&&(zt.aa_specialframe=gn.xani_nui2.InitAnimaWithName("特殊奖励框",null)),null==zt.aa_specialframe2&&(zt.aa_specialframe2=gn.xani_nui2.InitAnimaWithName("特殊奖励框2",null)),e=128,h=250,this.qdtime<zt._SPECIALDAY[s]?(c.gi().FillRect_2D(i+5,t+5,i+e-10,t+h-10,4281963410),zt.aa_specialframe.iFrame=0,zt.aa_specialframe.Draw(i,t),zt.aa_specialframe.iFrame=1,zt.aa_specialframe.Draw(i+e,t),zt.aa_specialframe.iFrame=2,zt.aa_specialframe.Draw(i+e,t+h),zt.aa_specialframe.iFrame=3,zt.aa_specialframe.Draw(i,t+h),zt.aa_specialframe.iFrame=4,zt.aa_specialframe.DrawEx(i+20,t,101,4.4,1,0,0,0),zt.aa_specialframe.iFrame=5,zt.aa_specialframe.DrawEx(i,t+20,101,1,10.5,0,0,0),zt.aa_specialframe.iFrame=6,zt.aa_specialframe.DrawEx(i+e,t+20,101,1,10.5,0,0,0),zt.aa_specialframe.iFrame=7,zt.aa_specialframe.DrawEx(i+20,t+h,101,4.4,1,0,0,0),c.gi().DrawText_2(i+64,t+20,"签到"+zt._SPECIALDAY[s]+"次获得",4294967040,20,101,1,1,0,-2,-2,3,4278190080)):(c.gi().FillRect_2D(i+5,t+5,i+e-10,t+h-10,4282151834),zt.aa_specialframe2.iFrame=0,zt.aa_specialframe2.Draw(i,t),zt.aa_specialframe2.iFrame=1,zt.aa_specialframe2.Draw(i+e,t),zt.aa_specialframe2.iFrame=2,zt.aa_specialframe2.Draw(i+e,t+h),zt.aa_specialframe2.iFrame=3,zt.aa_specialframe2.Draw(i,t+h),zt.aa_specialframe2.iFrame=4,zt.aa_specialframe2.DrawEx(i+20,t,101,4.4,1,0,0,0),zt.aa_specialframe2.iFrame=5,zt.aa_specialframe2.DrawEx(i,t+20,101,1,10.5,0,0,0),zt.aa_specialframe2.iFrame=6,zt.aa_specialframe2.DrawEx(i+e,t+20,101,1,10.5,0,0,0),zt.aa_specialframe2.iFrame=7,zt.aa_specialframe2.DrawEx(i+20,t+h,101,4.4,1,0,0,0),c.gi().DrawText_2(i+64,t+20,"已获得",4294967040,24,101,1,1,0,-2,-2,3,4278190080)),gn.xani_nui2.DrawAnima(i+24,t+45,"礼品格子",0),0==s?gn.xani_ngoods.DrawAnima(i+24,t+45,"传送符",0):1==s?gn.xani_ngoods.DrawAnima(i+24,t+45,"仙灵果",0):2==s?gn.xani_ngoods.DrawAnima(i+24,t+45,"替身木偶",0):3==s?gn.xani_ngoods.DrawAnima(i+24,t+45,"装备制造图纸",0):4==s?gn.xani_ngoods.DrawAnima(i+24,t+45,"青霜丹",0):5==s?gn.xani_ngoods.DrawAnima(i+24,t+45,"高级仙灵果",0):6==s&&gn.xani_ngoods.DrawAnima(i+24,t+45,"装备制造图纸",0),gn.xani_nui2.DrawAnima(i+24,t+150,"礼品格子",0),gn.xani_ngoods.DrawAnima(i+24,t+150,"三倍经验卡",0),gn.xani_nui2.DrawAnima(i+24,t+150,"会员专属",0)}Draw(){var i;for(E.new_baseframe2(this.iX,this.iY,this.iW,this.iH,"活","动"),i=0;i<4;i++)this.btn_page[i].Move(this.iX+this.iW-15,this.iY+40+130*i,50,130),this.iPage==i&&(this.btn_page[i].bMouseDown=!0),this.btn_page[i].Draw(),E.new_lableword2(this.iX+this.iW-15,this.iY+40+130*i,40,130,this.iPage==i,zt._ALable[i][0],zt._ALable[i][1]);switch(this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_close.Draw(),this.iPage){case 0:this.Draw_0();break;case 1:this.Draw_1();break;case 2:this.Draw_2();break;case 3:this.Draw_3()}this.iShowGet>=0&&this.iShowGet<this.iAPCount&&this.draw_get(this.iShowGet)}ProcTouch(i,t,s){var e,a,n;if(this.iShowGet>=0)return 465,381,a=(h.SCRW-465)/2,n=(h.SCRH-381)/2,3!=i||bn.bInRect(t,s,a,n,465,381)||(this.iShowGet=-1),this.btn_gift.ProcTouch(i,t,s)&&this.btn_gift.bCheck()&&(this.iNumber<this.aprice[this.iShowGet].iNeed?L.easymsg.AddMessage("活跃度未达不能领取"):this.iShowGet<this.iAPPoint?L.easymsg.AddMessage("此档奖励已领过"):Mh.gi().s_PromptActivity(1,this.iShowGet),this.iShowGet=-1),!0;if(this.btn_close.ProcTouch(i,t,s))return this.btn_close.bCheck()&&ln.gi().PopStat(1),!0;for(e=0;e<4;e++)this.btn_page[e].ProcTouch(i,t,s)&&this.btn_page[e].bCheck()&&(this.iPage=e,this.iWeek=this.iTodayWeek,iBtn3=0,this.iPoint3=0,this.InitBtnAnima());if(0==this.iPage){for(this.btn_go.ProcTouch(i,t,s)&&this.btn_go.bCheck()&&(0==this.iPoint&&(xh.me.rbs.iLev<10?Z.fm.Open("升到10级，加入门派后才能领取师门任务。#e完成引导剧情即可升到10级以上"):0==xh.me.rbs.iSchoolId?Z.fm.Open("自动寻路前往门派....#e加入门派后才能领取师门任务"):H.bNoTeam()?xh.me.rbs.iSchoolId>0&&(Mh.gi().s_UseSkill(0,0,0,0,0,0,0),ln.gi().PopStat(1),Ih.gi().iMapChangeing=100,Z.fm.Open("点击右下角“快捷”按钮，使用“遁地术”即可快速回到门派")):L.easymsg.AddMessage("队伍中不能使用遁地术")),1==this.iPoint&&(Ue.gi().FindNpc(20,!0,!0),ln.gi().PopStat(1)),2==this.iPoint&&(Ue.gi().FindNpc(56,!0,!0),ln.gi().PopStat(1)),3==this.iPoint&&(Ue.gi().FindNpc(35,!0,!0),ln.gi().PopStat(1)),4==this.iPoint&&(Ue.gi().FindNpc(62,!0,!0),ln.gi().PopStat(1)),6==this.iPoint&&(Ue.gi().FindNpc(74,!0,!0),ln.gi().PopStat(1)),7==this.iPoint&&(Ue.gi().FindNpc(34,!0,!0),Z.fm.Open("程镖头每过一段时间会改变位置，要在临淄四处找找哦"),ln.gi().PopStat(1)),9!=this.iPoint&&10!=this.iPoint&&11!=this.iPoint||(Ue.gi().FindNpc(76,!0,!0),ln.gi().PopStat(1))),e=0;e<this.iCount;e++)if(this.btn_list[e].ProcTouch(i,t,s))return this.btn_list[e].bCheck()&&(this.iPoint=e),!0;for(e=0;e<3;e++)if(this.btn_get[e].ProcTouch(i,t,s))return this.btn_get[e].bCheck()&&(this.iShowGet=this.btn_get[e].exts[0]),!0}else if(1==this.iPage){for(e=0;e<7;e++)this.btn_week[e].ProcTouch(i,t,s)&&this.btn_week[e].bCheck()&&(this.iPoint2=0,this.iWeek=e,this.InitBtnAnima());for(e=0;e<this.iCount2;e++)if(this.btn_list[e].ProcTouch(i,t,s))return this.btn_list[e].bCheck()&&(this.iPoint2=e),!0}else if(2==this.iPage){if(0==(xh.me.iFlag[50]&1<<this.iTodayDay-1)&&this.btn_qd.ProcTouch(i,t,s))return this.btn_qd.bCheck()&&(0!=(xh.me.iFlag[50]&1<<this.iTodayDay-1)?L.easymsg.AddMessage("今日已签到过"):Mh.gi().s_GetCodeReward(5,"")),!0;if(this.btn_vip.ProcTouch(i,t,s))return this.btn_vip.bCheck()&&(ln.gi().PopStat(1),Yi.Open(3)),!0}else if(3==this.iPage){for(e=0;e<4;e++)this.btn_cont[e].ProcTouch(i,t,s)&&this.btn_cont[e].bCheck()&&(this.iPoint3=0,iBtn3=e,this.InitBtnAnima());if(1==iBtn3||2==iBtn3||3==iBtn3)for(e=0;e<this.iCount;e++)if(this.btn_list[e].ProcTouch(i,t,s))return this.btn_list[e].bCheck()&&(this.iPoint3=e),!0}return!1}}zt._ADetail=[[["师门任务","人物等级>=10级#e10级加入门派后，找门派师傅领取任务，每天的前两轮（会员三轮）任务获得双倍奖励。"],["为民除害","人物等级>=10级#e在[西阳城守卫]处领取，任务完成后会获得大量的经验奖励。"],["每日赛跑","人物等级>=20级#e在[临淄城]的[田忌]处领取，完成可获得大量经验和金钱奖励，并获得一个三级草药。每天前十名更能额外获得道具奖励。#e任务可自动寻路完成"],["护法任务","人物等级>=20级#e在[咸阳]的[商鞅]处领取任务，完成获得大量的经验和金钱，10次为一轮，完成每轮的第十次任务可获得制作装备的材料。"],["追捕强盗","人物等级>=20级#e可以在[郢城]的[栾千盛]处领取追捕强盗任务，要求至少3人组队才能领取，完成获取经验金钱奖励，10次为一轮，第10次队长必定获得装备制造图纸，其他队员有几率获得道具奖励。"],["擂台切磋","在西阳城中间的擂台，跟其他玩家切磋一下，不管输赢都会获得2点活跃哦。"],["手艺任务","在郢城的铁匠接取任务，完成任务后会获得大量的经验和金钱，以及高熟练的打造手艺！"],["押镖任务","人物等级>=20级#e可前往[临淄城]找[程镖头]领取押镖任务，完成获得大量金钱奖励，并有一定几率获取阵法书，还有可能获得红包（#cff0000里面有200元宝哦#o）。"],["消灭山贼","人物等级>=30级#e每天整点，在随机野外地图刷出10只山贼，至少3人组队才能与山贼战斗，打败山贼获得大量的经验和金钱奖励，并有较大几率获得藏宝图。"],["帮派青龙","人物等级>=20级#e在[郢城]的[帮派总管]处加入帮派，进入帮派领地，在帮派的领地里面去找青龙堂总管，领取任务，完成任务可获得大量的经验、金钱和帮贡"],["帮派玄武","人物等级>=20级#e在帮派的领地里面去找玄武堂总管，领取任务，完成任务可获得大量的经验、金钱和帮贡（帮贡可在学院点帮派修炼）"],["帮派朱雀","人物等级>=20级#e在帮派的领地里面去找朱雀堂总管，领取任务，完成任务可获得大量的经验、金钱和帮贡，在第10次并能获取丹方，是炼丹的必备品。"]],[["门派闯关","每周四20:00点在[咸阳]或[临淄]的[门派活动使者]处领取任务，然后根据任务挑战门派护卫。每闯过一关都有丰厚的奖励，闯关速度最快的队伍更有高等级稀有宝石领取。"],["保卫西阳","每周一20:00点在大禹水道，平原山陵，函谷关，太行山四个地图刷新怪物向西阳城进攻，玩家阻挡怪物，阻止怪物进入西阳城，打败怪物会获得丰厚的奖励，保卫西阳城成功，在西阳城更有稀有宝箱出现。"],["比武大会","每周五中午12点~周六中午12点，玩家可以在[咸阳]的[比武接引人]报名，周六和周日下午13点~15点之间分别进行两场比武，比武获胜方可领取宝箱，即使失败也有其他丰厚奖励"],["帮派之战","每周五，周六，周日的19点~20点在[咸阳]的[帮战接引先锋]处进入帮战场地（帮主需提前报名），获胜帮派的成员将会获得100点帮贡和大量经验，并在帮战场地内刷出大量宝箱"],["封印叔叔","在挖宝时，有一定几率挖出妖怪叔叔，玩家组队去封印妖怪叔叔，会获得稀有的宝石和大量的经验金钱。"],["挑战嚣张","每天系统会在城市中刷新出4种嚣张妖怪（有点嚣张、比较嚣张、很嚣张、太嚣张）每种怪物每天可挑战一次，挑战成功，有几率获取丰厚的奖励（如高级宠物技能包）"],["战队竞技","在[咸阳]的[神威将军]处创建战队后，战队队长可以挑战比自己排名高的战队，挑战胜利可以提升战队排名。排名越靠前，战队每日声望增长越多"],["跑环","玩家在郢城的吉祥处领取跑环任务，完成跑环任务可获得相应等级的装备图纸。"]],[["师门任务","人物等级>=10级#e10级加入门派后，找门派师傅领取任务，每天的前两轮（会员三轮）任务获得双倍奖励。"],["为民除害","人物等级>=10级#e在[西阳城守卫]处领取，任务完成后会获得大量的经验奖励。"],["每日赛跑","人物等级>=10级#e在[临淄城]的[田忌]处领取，完成获得大量经验和金钱奖励，并获得一个三级草药。每天前十名更能额外获得道具奖励。#e任务可自动寻路完成"],["世界抢答","人物等级>=10级#e每隔一段时间，系统会发出一道题目，可在世界频道回答，最先答对的两名玩家各获得一颗宝石，并从前二十名答对的玩家中抽取4名给予66666铜币奖励"],["智者答题","无等级要求#e在各城市，每隔一段时间会随机出现一个智者，第一个答对智者问题的人可获得经验和金钱奖励，并有一定几率获得一颗宝石"],["押镖任务","人物等级>=20级#e可前往[临淄城]找[程镖头]领取押镖任务，完成获得大量金钱奖励，并有一定几率获取阵法书，还有可能获得红包（#cff0000里面有200元宝哦#o）。"],["追捕强盗","人物等级>=20级#e可以在[郢城]的[栾千盛]处领取追捕强盗任务，要求至少3人组队才能领取，完成获取经验金钱奖励，10次为一轮，第10次队长必定获得装备制造图纸，其他队员有几率获得道具奖励。"],["护法任务","人物等级>=20级#e在[咸阳]的[商鞅]处领取任务，完成获得大量的经验和金钱，10次为一轮，完成每轮的第十次任务可获得制作装备的材料。"],["帮派任务","人物等级>=20级#e在[郢城]的[帮派总管]处加入帮派，进入帮派领地，在帮派领地内可领取各种帮派任务，完成获得经验、金钱和帮贡，不同任务还有额外奖励"]],[["消灭山贼","人物等级>=30级#e每天整点，在随机野外地图刷出10只山贼，至少3人组队才能与山贼战斗，打败山贼获得大量的经验和金钱奖励，并有较大几率获得藏宝图。"],["封印叔叔","在挖宝时，有一定几率挖出妖怪叔叔，玩家组队去封印妖怪叔叔，会获得稀有的宝石和大量的经验金钱。"],["挑战嚣张","每天系统会在城市中刷新出4种嚣张妖怪（有点嚣张、比较嚣张、很嚣张、太嚣张）每种怪物每天可挑战一次，挑战成功，有几率获取丰厚的奖励（如高级宠物技能包）"],["门派闯关","每周二20:00点在[咸阳]或[临淄]的[门派活动使者]处领取任务，然后根据任务挑战门派护卫。每闯过一关都有丰厚的奖励，闯关速度最快的队伍更有高等级稀有宝石领取。"],["保卫西阳","每周三20:00点在大禹水道，平原山陵，函谷关，太行山四个地图刷新怪物向西阳城进攻，玩家阻挡怪物，阻止怪物进入西阳城，打败怪物会获得丰厚的奖励，保卫西阳城成功，在西阳城更有稀有宝箱出现。"],["比武大会","每周五中午12点~周六中午12点，玩家可以在[咸阳]的[比武接引人]报名，周六和周日下午13点~15点之间分别进行两场比武，比武获胜方可领取宝箱，即使失败也有其他丰厚奖励"],["帮派之战","每周五，周六，周日的19点~20点在[咸阳]的[帮战接引先锋]处进入帮战场地（帮主需提前报名），获胜帮派的成员将会获得100点帮贡和大量经验，并在帮战场地内刷出大量宝箱"],["战队竞技","在[咸阳]的[神威将军]处创建战队后，战队队长可以挑战比自己排名高的战队，挑战胜利可以提升战队排名。排名越靠前，战队每日声望增长越多"],["战队秘境","战队队长可在[咸阳]的[神威将军]处开启秘境，需要消耗战队声望，战队秘境里掉落大量的稀有道具，以及宠物进阶所必须的封印兽魂"],["副本挑战","人物等级>=40级#e在[咸阳]的[副本官]处创建自己的副本，也可申请加入其他玩家创建的副本。副本会掉落大量的稀有物品道具。"],["跑环","人物等级>=50级#e在[郢城]的[吉祥]处领取跑环任务，完成跑环任务可获得大量经验快速升级，每50环还可获得相应等级的装备图纸和手艺。"],["师徒任务","在[临淄]的[慎到]处拜师或收徒，师徒二人组队在慎到处领取师徒任务，任务会给与大量的经验和金钱奖励。徒弟出师后，师傅可获得宠物修炼积分"]],[["剑侠居","要求种族：人族#e门派特色：物理攻击型，具有超高物理输出、点杀能力。 #e推荐加点：5力、4力1敏、4力1体。#e●剑侠居算是最热门的一个门派，容易上手，输出可观，是练级不可缺少的一员，相对的装备也比较贵，后期的剑侠居，拥有较高的暴击率，在竞技玩法中更是点杀的一大利器。"],["茅棚坞","要求种族：人族#e门派特色：辅助型，具有高速度和强大的封印能力。 #e推荐加点：3敏2体、2敏3体、2敏2体1耐。#e●引以为傲的是速度，同样配置的情况下，先出手的绝对是茅棚，速度决定了竞技玩法的主动权，轮轴术也能很好的利用在卡敏战术中，迷雾让己方的胜率几率更大化，练级时，一个奇谋也能加快脚步。"],["庐医崖","要求种族：人族#e门派特色：辅助型、具有强大的加血和救人技能。#e推荐加点：3体2耐、2体2耐1法、2体2敏1耐。#e●作为七国里唯一的纯奶妈，具有强大的加血技能和救人技能，是各种高端任务、活动，竞技玩法不可缺少的一员。"],["溶洞","要求种族：魔族#e门派特色：法术攻击型，具有最高法系伤害。#e推荐加点：5法、4法1体#e●输出比封神高，但是目标数量比封神少，总伤害算起来反而不如封神了，不过做为七国的两大法系门派，溶洞更注重于多手段控制，相比封神来说没那么单调。"],["鬼谷","要求种族：魔族#e门派特色：辅助型，具有强大的封印和解封技能。#e推荐加点：3敏2体、2敏3体。#e●作为封系，鬼谷最大的特点就是可以为己方解封，还有增加封印几率的增益，在竞技玩法中也是一大强将。"],["武安阁","要求种族：魔族#e门派特色：物理攻击型、具有强大的物理攻击能力。#e推荐加点：5力、4力1敏、4力1体。#e●两大物理伤害的武安阁，点杀能力一点都不比剑侠居低，乱舞后还不用休息，单缺点就是太消耗蓝，续航能力不足。在竞技玩法和练级中，与剑侠居有同等的地位。"],["封神台","要求种族：仙族#e门派特点：法术伤害型、具有强大群秒技能#e推荐加点：5法、4法1体#e●两大法系之一，练级最受欢迎的门派，当然你要有一定的装备，不然小心免费回城。七国里的怪物理攻击较高，所以很多玩家都注重于物理防御，导致在竞技玩法中，法系的输出也相当的可观。"],["仙人洞","要求种族：仙族#e门派特点：辅助攻击型，具有固定伤害和持续恢复，以及各种增益。#e推荐加点：3体2耐、2体2耐1速#e●在前期，玩家伤害普遍不高，血量也低的时候，仙人洞的固定伤害就是一大利器，又肉又能输出，是前期练级最重要的一员。"],["神女峰","要求种族：仙族#e门派特点：辅助攻击型，具有单体高伤、复活、持续蓝恢复、封印#e推荐加点：4力1体、3力2法(攻击型)、3体2耐(辅助型)#e●神女是又能输出又能复活又能封的门派，绝对可以省下奶妈与控制的位置，多加一个输出，大大加快练级速度。"]],[["人物升级",""],["装备打造",""],["修炼提升",""],["宠物进阶",""],["坐骑养成",""]],[["辅助技能",""],["剧情技能",""],["家园种植",""]]],zt.Open=function(i){var t;ln.gi().iXStat==ln.GS_LOADING1&&ln.gi().PopStat(1),t=ln.gi().iXStat==ln.GS_PROMPTACTIVITY?ln.gi().LastStat(0):ln.gi().PushStat(ln.GS_PROMPTACTIVITY);for(var s=0;0!=i.GetNextByte();)t.alist[s].sName=i.GetNextString(),t.alist[s].proc=i.GetNextByte(),t.alist[s].max=i.GetNextByte(),t.alist[s].add=i.GetNextByte(),t.alist[s].sDetail=i.GetNextString(),s++;for(t.iACount=s,t.iNumber=i.GetNextShort(),t.iAPPoint=i.GetNextByte(),t.iAPCount=i.GetNextByte(),s=0;s<t.iAPCount;s++)t.aprice[s].iNeed=i.GetNextShort(),t.aprice[s].iExp=i.GetNextInt(),t.aprice[s].iMoney=i.GetNextInt(),t.aprice[s].tid1=i.GetNextShort(),t.aprice[s].tcount1=i.GetNextByte(),t.aprice[s].tid2=i.GetNextShort(),t.aprice[s].tcount2=i.GetNextByte();t.iTodayWeek=i.GetNextByte(),t.iTodayDay=i.GetNextByte(),t.iMaxDay=i.GetNextByte(),t.iMonth=i.GetNextByte()},zt._SPECIALDAY=[1,3,7,10,15,20,28],zt._SPECIALTID=[],zt.aa_specialframe=null,zt.aa_specialframe2=null,zt._ALable=[["活","跃"],["活","动"],["签","到"],["玩","法"]];class jt extends s{constructor(i){var t,s;for(super(),this.iW=900,this.iH=600,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_zhen=new Array(8),t=0;t<6;t++)this.btn_zhen[t]=new Eh(gn.xani_nui2),this.btn_zhen[t].InitButton("按钮2_121"),this.btn_zhen[t].sName=jt._ZHEN[t+1][0];for(this.se=new mt,this.se.Init1(0,0,120,48,50),this.aa_body=new Array(5),this.aa_weapon=new Array(5),this.aa_cls=new Array(5),t=0;t<5;t++)for(this.aa_body[t]=null,this.aa_weapon[t]=null,this.aa_cls[t]=new Array(5),s=0;s<5;s++)this.aa_cls[t][s]=new l;for(this.aa_add=gn.xani_nui2.InitAnimaWithName("增减提示",null),this.poslist=new Array(5),t=0;t<5;t++)this.poslist[t]=new Int32Array(2);this.iLockPos=-1,this.btn_ts=new Eh(gn.xani_nui2),this.btn_ts.InitButton("感叹提示"),this.btn_ts.Move(this.iX+this.iW-120,this.iY+this.iH-120,65,65),this.bShowKe=!1}Draw(){var i,t,s,e;for(E.new_baseframe2(this.iX,this.iY,this.iW,this.iH,"阵","法"),this.btn_close.Draw(),E.new_framein(this.iX+25,this.iY+25,150,this.iH-50),i=0;i<6;i++)0!=(xh.me.iFlag[14]&1<<i)&&H.bTeamLeader()||(this.btn_zhen[i].bDisable=!0),xh.iTeamZhen==i&&(this.btn_zhen[i].bMouseDown=!0,this.btn_zhen[i].bMouseIn=!0),this.btn_zhen[i].Move(this.iX+25+15,this.iY+25+15+63*i,121,48),this.btn_zhen[i].Draw(),xh.iTeamZhen==i&&(this.se.Logic(),this.se.Draw(this.iX+25+15,this.iY+25+15+63*i));for(s=this.iX+300,e=this.iY+360,E.new_framein(this.iX+25+150+25,this.iY+25,this.iW-150-75,this.iH-50),t=0;t<3;t++)for(i=0;i<5;i++)s=this.iX+300+80*i+80*t,e=this.iY+360-60*i+60*t,jt._ZHENSTAND[xh.iTeamZhen][t][i]>0?(1==jt._ZHENSTAND[xh.iTeamZhen][t][i]?gn.xani_nui2.DrawAnima(s,e,"地上格子",1):jt._ZHENSTAND[xh.iTeamZhen][t][i]>1&&gn.xani_nui2.DrawAnima(s,e,"地上格子",2),this.poslist[jt._ZHENSTAND[xh.iTeamZhen][t][i]-1][0]=s,this.poslist[jt._ZHENSTAND[xh.iTeamZhen][t][i]-1][1]=e):gn.xani_nui2.DrawAnima(s,e,"地上格子",0);for(this.iLockPos>0&&gn.xani_nui2.DrawAnima(this.poslist[this.iLockPos][0],this.poslist[this.iLockPos][1],"地上格子",3),M.gi().ClearBuffer(),t=0;t<3;t++)for(i=0;i<5;i++)s=this.iX+300+80*i+80*t,e=this.iY+360-60*i+60*t,jt._ZHENSTAND[xh.iTeamZhen][t][i]>0&&this.Draw_role(s,e,jt._ZHENSTAND[xh.iTeamZhen][t][i]-1);if(M.gi().SortAndDraw(),H.bFullTeam()?c.gi().DrawTextEx(this.iX+25+150+25+25,this.iY+this.iH-60,"提示：队长点击格子可交换队员位置",4294901760,20,101,1,1,0,0,0):c.gi().DrawTextEx(this.iX+25+150+25+25,this.iY+this.iH-60,"提示：组满5人阵型才会生效",4294901760,20,101,1,1,0,0,0),this.btn_ts.Draw(),this.bShowKe)for(s=this.iX+this.iW-120-560+30,e=this.iY+this.iH-120-210+30,c.gi().FillRect_2D(s,e,s+560,e+210,2684354560),c.gi().FillRect_2D(s,e+30*xh.iTeamZhen+30,s+560,e+30*xh.iTeamZhen+60,2701066240),i=0;i<7;i++)for(t=0;t<7;t++)c.gi().DrawTextEx(s+80*i+40,e+30*t+15,jt._ZHEN[t][i],4294967295,20,101,1,1,0,-2,-2)}Draw_role(i,t,s){var e,h,a;if(H.iTmpTeamRid[s]==rh.gameing.me.iRid){if(h=2*xh.me.iRace+xh.me.iSex,M.gi().BeginGroup(),G.DrawAura(0,i,t,M.gi(),t),null==this.aa_body[s])for(this.aa_body[s]=gn.xani_newrole[2*xh.me.iRace+xh.me.iSex].InitAnimaWithName("战斗站立_左上",null),e=0;e<N._CHANGECOLOR[h].length;e++)xh.me.iColor[e]<=0||xh.me.iColor[e]>=6||gn.xani_color[h][xh.me.iColor[e]-1].InitAnimaWithName(N._CHANGECOLOR[h][e]+"_战斗站立_左上",this.aa_cls[s][e]);for(null==this.aa_weapon[s]&&xh.me.iWeapTid>=0&&(this.aa_weapon[s]=gn.xani_weap[2*xh.me.iRace+xh.me.iSex][N.WeapFlag(xh.me.iWeapTid)].InitAnimaWithName("战斗站立_左上",null)),M.gi().DrawAnima_aa(t,null,i,t,this.aa_body[s]),e=0;e<N._CHANGECOLOR[h].length;e++)xh.me.iColor[e]<=0||xh.me.iColor[e]>=6||(this.aa_cls[s][e].iFrame=this.aa_body[s].iFrame,M.gi().DrawAnima_aa(t,null,i,t,this.aa_cls[s][e]));null!=this.aa_weapon[s]&&xh.me.iWeapTid>=0&&(M.gi().DrawAnima_aa(t,null,i,t,this.aa_weapon[s]),this.aa_weapon[s].NextFrame()),this.aa_body[s].NextFrame(),M.gi().DrawText_2(t,1,i,t+20,xh.me.sName,4286644096,20,1,4278190080),M.gi().EndGroup()}else if(null!=(a=rh.gameing.findnrs(H.iTmpTeamRid[s]))){if(h=2*a.iRace+a.iSex,M.gi().BeginGroup(),G.DrawAura(0,i,t,M.gi(),t),null==this.aa_body[s])for(this.aa_body[s]=gn.xani_newrole[2*a.iRace+a.iSex].InitAnimaWithName("战斗站立_左上",null),e=0;e<N._CHANGECOLOR[h].length;e++)a.iColor[e]<=0||a.iColor[e]>=6||gn.xani_color[h][a.iColor[e]-1].InitAnimaWithName(N._CHANGECOLOR[h][e]+"_战斗站立_左上",this.aa_cls[s][e]);for(null==this.aa_weapon[s]&&a.iWeapTid>=0&&(this.aa_weapon[s]=gn.xani_weap[2*a.iRace+a.iSex][N.WeapFlag(a.iWeapTid)].InitAnimaWithName("战斗站立_左上",null)),M.gi().DrawAnima_aa(t,null,i,t,this.aa_body[s]),e=0;e<N._CHANGECOLOR[h].length;e++)a.iColor[e]<=0||a.iColor[e]>=6||(this.aa_cls[s][e].iFrame=this.aa_body[s].iFrame,M.gi().DrawAnima_aa(t,null,i,t,this.aa_cls[s][e]));null!=this.aa_weapon[s]&&a.iWeapTid>=0&&(M.gi().DrawAnima_aa(t,null,i,t,this.aa_weapon[s]),this.aa_weapon[s].NextFrame()),this.aa_body[s].NextFrame(),M.gi().DrawText_2(t,1,i,t+20,a.sName,4286644096,20,1,4278190080),M.gi().EndGroup()}var n=0;switch(jt._ZHENADD[xh.iTeamZhen][s].length){case 1:n=25;break;case 2:n=35;break;case 3:n=45}for(e=0;e<jt._ZHENADD[xh.iTeamZhen][s].length;e++)M.gi().DrawAnima_aa(t+1,null,i,t+20*e-n,this.aa_add),M.gi().DrawText(t+2,1,i+29,t+10.5+20*e-n,jt._ZHENADD[xh.iTeamZhen][s][e],4294967295,16)}ProcTouch(i,t,s){var e;if(this.bShowKe)return 3==i&&(this.bShowKe=!1),!0;if(this.btn_ts.ProcTouch(i,t,s))return this.btn_ts.bCheck()&&(this.bShowKe=!0),!0;for(e=0;e<6;e++)this.btn_zhen[e].ProcTouch(i,t,s)&&this.btn_zhen[e].bCheck()&&(xh.iTeamZhen=e,Mh.gi().s_ChangeZhen(e));for(e=1;e<5;e++)if(bn.bInLX(t,s,this.poslist[e][0],this.poslist[e][1],148,112))return 1==i&&this.iLockPos>0&&this.iLockPos!=e?(Mh.gi().s_TeamOperate(8,this.iLockPos,e),this.iLockPos=-1):this.iLockPos=e,!0;return this.iLockPos=-1,this.btn_close.ProcTouch(i,t,s)?(this.btn_close.bCheck()&&ln.gi().PopStat(1),!0):3==i&&!bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)&&(ln.gi().PopStat(1),!0)}}jt._ZHEN=[["          ","普通阵","天罡阵","八卦阵","疾风阵","飞龙阵","聚星阵"],["普通阵","0%","-5%","-5%","-5%","-5%","-5%"],["天罡阵","5%","0%","-5%","5%","10%","-10%"],["八卦阵","5%","5%","0%","10%","-10%","-5%"],["疾风阵","5%","-5%","-10%","0%","5%","10%"],["飞龙阵","5%","-10%","10%","-5%","0%","5%"],["聚星阵","5%","10%","5%","-10%","-5%","0%"]],jt._ZHENADD=[[[],[],[],[],[]],[["+5%物攻","+5%法攻"],["+5%物攻","+5%法攻"],["+5%物攻","+5%法攻"],["+5%物攻","+5%法攻"],["+5%物攻","+5%法攻"]],[["+3%物防","+3%法防"],["+5%法防"],["+5%法防"],["+5%物防"],["+5%物防"]],[["+5%速度"],["+5%速度"],["+5%速度"],["+5%速度"],["+5%速度"]],[["+8%物暴"],["+5%法攻"],["+5%法攻"],["+5%速度"],["+5%速度"]],[["+8%法攻"],["+5%封中"],["+5%法防"],["+5%物防"],["+5%物防"]]],jt._ZHENSTAND=[[[0,0,0,0,0],[4,2,1,3,5],[0,0,0,0,0]],[[0,0,0,0,0],[4,2,0,3,5],[0,0,1,0,0]],[[0,0,0,0,0],[4,0,0,0,5],[0,2,1,3,0]],[[0,0,0,0,0],[4,0,1,0,5],[0,2,0,3,0]],[[0,0,0,0,0],[0,2,0,3,0],[4,0,1,0,5]],[[0,0,0,0,0],[0,2,0,3,0],[0,4,1,5,0]]],jt.CleanAnima=function(){var i;if(ln.gi().CheckStat(ln.GS_TEAMZHEN)){var t=ln.gi().LastStat(0);for(i=0;i<5;i++)t.aa_body[i]=null,t.aa_weapon[i]=null;t.iLockPos=-1}},jt.Open=function(){ln.gi().iXStat==ln.GS_TEAMZHEN?ln.gi().LastStat(0):ln.gi().PushStat(ln.GS_TEAMZHEN)};class Jt{copy(i){this.iRid=i.iRid,this.sName=i.sName,this.iLev=i.iLev,this.iRaX=i.iRaX,this.iSchool=i.iSchool,this.bApplyed=i.bApplyed}swap(i){var t,s,e;t=this.iRid,this.iRid=i.iRid,i.iRid=t,s=this.sName,this.sName=i.sName,i.sName=s,t=this.iLev,this.iLev=i.iLev,i.iLev=t,t=this.iRaX,this.iRaX=i.iRaX,i.iRaX=t,t=this.iSchool,this.iSchool=i.iSchool,i.iSchool=t,e=this.bApplyed,this.bApplyed=i.bApplyed,i.bApplyed=e}}class Qt extends s{_rolelist(i){var t,s;for(1==i.GetNextByte()&&(this.iNRCount=0),s=this.iNRCount;0!=(t=i.GetNextInt())&&(this.nrs[s]=new Jt,this.nrs[s].iRid=t,this.nrs[s].sName=i.GetNextString(),this.nrs[s].iLev=i.GetNextShort(),t=i.GetNextByte(),this.nrs[s].iRaX=t%10,this.nrs[s].iSchool=parseInt(t/10),this.nrs[s].bApplyed=!1,!(++s>=Qt.MAXNEARROLE)););this.iNRCount=s}remove_from_list(i){var t;for(t=0;t<this.iNRCount;t++)if(this.nrs[t].iRid==i){for(this.iNRCount--;t<this.iNRCount;t++)this.nrs[t].copy(this.nrs[t+1]);return}}constructor(i){var t,s;for(super(),this.pani=i,this.pm3f=i.pm3f,this.iW=1100,this.iH=585,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_zf=new Eh(gn.xani_nui2),this.btn_zf.InitButton("按钮2"),this.btn_zf.sName="设置阵法",this.btn_dest=new D(gn.xani_nui4),this.btn_dest.InitButton("队伍目标改变"),this.btn_dest.bSingleButton=!0,this.btn_change=new Eh(gn.xani_nui2),this.btn_change.InitButton("按钮2"),this.btn_change.sName="升为队长",this.chk_autoback=new T(gn.xani_button),this.chk_autoback.InitBox("复选框50_53"),0==(2048&xh.me.iFlag[2])?this.chk_autoback.bTrue=!0:this.chk_autoback.bTrue=!1,this.chk_autoback.sDetail="自动响应召回",this.btn_fastsend=new Eh(gn.xani_nui2),this.btn_fastsend.InitButton("按钮2"),this.btn_fastsend.sName="发送队伍",this.btn_autoteam=new Eh(gn.xani_nui2),this.btn_autoteam.InitButton("按钮2"),this.btn_autoteam.sName="自动匹配",this.bLock=!1,this.iNRCount=0,this.nrs=new Array(Qt.MAXNEARROLE),t=0;t<Qt.MAXNEARROLE;t++)this.nrs[t]=null;for(this.iOffY=0,this.iLockY=-1,this.iLockDelay=100,this.iRolePoint=-1,this.iOBCount=0,this.bResetOBC=!1,this.btn_operate=new Array(12),t=0;t<12;t++)this.btn_operate[t]=new Eh(gn.xani_nui2);for(this.iPage=0,this.btn_page=new Array(2),t=0;t<2;t++)this.btn_page[t]=new Eh(gn.xani_nui2),this.btn_page[t].InitButton("右侧标签"),this.btn_page[t].Move(this.iX+this.iW-15,this.iY+40+125*t,50,140);for(this.btn_refuse=new Array(Qt.MAXLIST),this.btn_roles=new Array(Qt.MAXLIST),this.btn_away=new Array(Qt.MAXLIST),this.aa_body=new Array(Qt.MAXLIST),this.aa_weapon=new Array(Qt.MAXLIST),this.aa_cls=new Array(Qt.MAXLIST),this.btn_watch=new Array(Qt.MAXLIST),t=0;t<Qt.MAXLIST;t++)for(this.aa_cls[t]=new Array(5),this.btn_watch[t]=new Eh(gn.xani_button),this.btn_watch[t].InitButton("队伍查看50_50"),this.btn_refuse[t]=new Eh(gn.xani_nui2),this.btn_refuse[t].sName="拒绝",this.btn_refuse[t].InitButton("按钮1_110"),this.btn_roles[t]=new D(i),this.btn_roles[t].bSingleButton=!0,this.btn_away[t]=new Eh(gn.xani_button),this.btn_away[t].InitButton("队伍暂离72_42"),this.btn_away[t].sName="暂离",this.btn_away[t].iNameSize=25,this.aa_body[t]=null,this.aa_weapon[t]=null,s=0;s<5;s++)this.aa_cls[t][s]=new l;if(this.iScrollX=0,null==Qt.trl){for(Qt.trl=new Array(Qt.MAXLIST),t=0;t<Qt.MAXLIST;t++)Qt.trl[t]=new Bt;Qt.iRequestCount=0}this.bLock=!0}DrawName(i,t,s,e,h,a){this.pm3f.DrawTextEx(i,t+55,s,4294967295,20,101,1,1,0,-2,-2),this.pm3f.DrawTextEx(i-50,t+55+40,e,4294967295,20,101,1,1,0,-1,-2),this.pm3f.DrawTextEx(i+50,t+55+40,""+h,4294967295,20,101,1,1,0,-3,-2),this.pm3f.DrawTextEx(i,t+55+80,a,4294967295,20,101,1,1,0,-2,-2)}Draw(){if(H.bNoTeam())ln.gi().PopStat(1);else if(H.bTeamLeader()?this.iW=1100:this.iW=690,this.iH=585,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,E.new_baseframe2(this.iX,this.iY,this.iW,this.iH,"队","伍"),E.new_framein(this.iX+30,this.iY+30,630,this.iH-60),this.btn_close.Move(this.iX+this.iW-35,this.iY+-25,60,60),this.btn_close.Draw(),0==this.iPage?this.Draw_0():this.Draw_1(),H.bTeamLeader()){this.Draw_near();for(var i=0;i<2;i++)this.iPage==i&&(this.btn_page[i].bMouseIn=!0,this.btn_page[i].bMouseDown=!0),this.btn_page[i].Draw();E.new_lableword4(this.iX+this.iW-15,this.iY+50+0-4,40,70,0==this.iPage,"我","的","队","伍"),E.new_lableword4(this.iX+this.iW-15,this.iY+50+125-4,40,70,1==this.iPage,"申","请","列","表")}else 1==this.iPage&&(this.iPage=0)}Draw_1(){var i,t,s,h,a;for(this.btn_zf.Move(this.iX+50,this.iY+50,145,56),this.btn_change.Move(this.iX+50+600-145-10,this.iY+50,145,56),this.btn_fastsend.Move(this.iX+50+280+10,this.iY+50+65,145,56),this.btn_autoteam.Move(this.iX+50+280+10+145+10,this.iY+50+65,145,56),this.btn_dest.Move(this.iX+50,this.iY+50+65,280,54),this.btn_zf.Draw(),H.bTeamLeader()&&(this.btn_fastsend.Draw(),H.bLeaderAutoTeaming?this.btn_autoteam.sName="匹配中...":this.btn_autoteam.sName="自动匹配",this.btn_autoteam.Draw()),this.Draw_Target(),c.gi().SetViewClip(this.iX+50,this.iY+180,this.iX+50+600,this.iY+180+300+65),i=0;i<Qt.iRequestCount;i++){if(s=this.iX+50+120*i+55-this.iScrollX,h=this.iY+180+150,gn.xani_nui2.DrawAnima(s-55,h-150,"队伍人物格子1",0),1==this.bLock&&this.iLockPoint1==i&&E.frame_type2("黄色透明框a25_25",s-55,h-150,110,180,25,25),this.btn_roles[i].Move(s-55,h-150,110,180),this.btn_refuse[i].Move(s-55,h+310-150,110,52),this.btn_away[i].Move(s-55+110-72,h+180-42-150,72,42),this.btn_watch[i].Move(s-55+110-50,h-150,50,50),gn.xani_nui1.DrawAnimaEx(s,h,"选中角色底",gn.iDelay,101,.5,.5,0,-2,-2),a=Qt.trl[i].iRas,null==this.aa_body[i])for(this.aa_body[i]=gn.xani_newrole[a].InitAnimaWithName("站立_下",null),t=0;t<N._CHANGECOLOR[a].length;t++)Qt.trl[i].iColor[t]<=0||Qt.trl[i].iColor[t]>=6||gn.xani_color[a][Qt.trl[i].iColor[t]-1].InitAnimaWithName(N._CHANGECOLOR[a][t]+"_站立_下",this.aa_cls[i][t]);for(Qt.trl[i].iWeapTid>=0&&null==this.aa_weapon[i]&&(this.aa_weapon[i]=gn.xani_weap[Qt.trl[i].iRas][N.WeapFlag(Qt.trl[i].iWeapTid)].InitAnimaWithName("站立_下",null)),this.aa_body[i].Draw(s,h),t=0;t<N._CHANGECOLOR[a].length;t++)Qt.trl[i].iColor[t]<=0||Qt.trl[i].iColor[t]>=6||(this.aa_cls[i][t].iFrame=this.aa_body[i].iFrame,this.aa_cls[i][t].Draw(s,h));null!=this.aa_weapon[i]&&Qt.trl[i].iWeapTid>=0&&(this.aa_weapon[i].Draw(s,h),this.aa_weapon[i].NextFrame()),this.aa_body[i].NextFrame(),this.DrawName(s,h,Qt.trl[i].sName,e.sSchools[Qt.trl[i].iSchoolId],Qt.trl[i].iLev,Qt.trl[i].sMapName),this.btn_refuse[i].sName="同意",this.btn_refuse[i].Draw(),this.btn_away[i].sName="拒绝",this.btn_away[i].Draw(),this.btn_watch[i].Draw()}c.gi().NoClip(),Qt.iRequestCount<=5?this.iScrollW=0:this.iScrollW=120*(Qt.iRequestCount-5),this.bLockX||(this.iScrollX<0&&(this.iScrollX=0),this.iScrollX>this.iScrollW&&(this.iScrollX=this.iScrollW))}Draw_Target(){E.frame_type1("队伍目标40_54",this.btn_dest.iX,this.btn_dest.iY,this.btn_dest.iW,40),H.iTeamTarget>=0&&H.iTeamTarget<8&&(Qt.sZz=Zt._TARGET[H.iTeamTarget]+"   "+H.iLev1+"级~"+H.iLev2+"级"),c.gi().DrawText_2(this.btn_dest.iX+20,this.btn_dest.iY+27,Qt.sZz,4278206039,24,101,1,1,0,0,-2,3,4294967295)}Draw_0(){var i,t,s,h,a;for(this.btn_zf.Move(this.iX+50,this.iY+50,145,56),this.chk_autoback.Move(this.iX+50+350,this.iY+50,50,53),this.btn_change.Move(this.iX+50+600-145-10,this.iY+50,145,56),this.btn_dest.Move(this.iX+50,this.iY+50+65,280,54),this.btn_fastsend.Move(this.iX+50+280+10,this.iY+50+65,145,56),this.btn_autoteam.Move(this.iX+50+280+10+145+10,this.iY+50+65,145,56),this.btn_zf.Draw(),H.bTeamLeader()?(this.btn_fastsend.Draw(),H.bLeaderAutoTeaming?this.btn_autoteam.sName="匹配中...":this.btn_autoteam.sName="自动匹配",this.btn_autoteam.Draw()):this.chk_autoback.Draw(),this.Draw_Target(),i=0;i<5;i++)if(h=this.iY+180,gn.xani_nui2.DrawAnima(this.iX+50+120*i,h,"队伍人物格子1",0),0!=H.iTmpTeamRid[i]){if(this.btn_roles[i].Move(this.iX+50+120*i,h,110,180),this.btn_refuse[i].Move(this.iX+50+120*i,h+310,110,52),this.btn_away[i].Move(this.iX+50+120*i+110-72,h+180-42,72,42),this.btn_watch[i].Move(this.iX+50+120*i+110-50,h,50,50),s=this.iX+50+120*i+55,h=this.iY+180+150,gn.xani_nui1.DrawAnimaEx(s,h,"选中角色底",gn.iDelay,101,.5,.5,0,-2,-2),H.iTmpTeamRid[i]==xh.me.iRid){if(a=2*xh.me.iRace+xh.me.iSex,null==this.aa_body[i])for(this.aa_body[i]=gn.xani_newrole[2*xh.me.iRace+xh.me.iSex].InitAnimaWithName("站立_下",null),t=0;t<N._CHANGECOLOR[a].length;t++)xh.me.iColor[t]<=0||xh.me.iColor[t]>=6||gn.xani_color[a][xh.me.iColor[t]-1].InitAnimaWithName(N._CHANGECOLOR[a][t]+"_站立_下",this.aa_cls[i][t]);for(null==this.aa_weapon[i]&&xh.me.iWeapTid>=0&&(this.aa_weapon[i]=gn.xani_weap[2*xh.me.iRace+xh.me.iSex][N.WeapFlag(xh.me.iWeapTid)].InitAnimaWithName("站立_下",null)),0==H.iTeamRid[i]?this.aa_body[i].DrawEx(s,h,50,1,1,0,0,0):this.aa_body[i].Draw(s,h),t=0;t<N._CHANGECOLOR[a].length;t++)xh.me.iColor[t]<=0||xh.me.iColor[t]>=6||(this.aa_cls[i][t].iFrame=this.aa_body[i].iFrame,0==H.iTeamRid[i]?this.aa_cls[i][t].DrawEx(s,h,50,1,1,0,0,0):this.aa_cls[i][t].Draw(s,h));null!=this.aa_weapon[i]&&xh.me.iWeapTid>=0&&(0==H.iTeamRid[i]?this.aa_weapon[i].DrawEx(s,h,50,1,1,0,0,0):this.aa_weapon[i].Draw(s,h),this.aa_weapon[i].NextFrame()),this.aa_body[i].NextFrame(),this.DrawName(s,h,xh.me.sName,e.sSchools[xh.me.rbs.iSchoolId],xh.me.rbs.iLev,H.sMapName[i])}else{if(a=H.iRas[i],null==this.aa_body[i])for(this.aa_body[i]=gn.xani_newrole[a].InitAnimaWithName("站立_下",null),t=0;t<N._CHANGECOLOR[a].length;t++)H.iColor[i][t]<=0||H.iColor[i][t]>=6||gn.xani_color[a][H.iColor[i][t]-1].InitAnimaWithName(N._CHANGECOLOR[a][t]+"_站立_下",this.aa_cls[i][t]);for(null==this.aa_weapon[i]&&H.iWeapTid[i]>=0&&(this.aa_weapon[i]=gn.xani_weap[H.iRas[i]][N.WeapFlag(H.iWeapTid[i])].InitAnimaWithName("站立_下",null)),0==H.iTeamRid[i]?this.aa_body[i].DrawEx(s,h,50,1,1,0,0,0):this.aa_body[i].Draw(s,h),t=0;t<N._CHANGECOLOR[a].length;t++)H.iColor[i][t]<=0||H.iColor[i][t]>=6||(this.aa_cls[i][t].iFrame=this.aa_body[i].iFrame,0==H.iTeamRid[i]?this.aa_cls[i][t].DrawEx(s,h,50,1,1,0,0,0):this.aa_cls[i][t].Draw(s,h));null!=this.aa_weapon[i]&&H.iWeapTid[i]>=0&&(this.aa_weapon[i].Draw(s,h),0==H.iTeamRid[i]?this.aa_weapon[i].DrawEx(s,h,50,1,1,0,0,0):this.aa_weapon[i].NextFrame()),this.aa_body[i].NextFrame(),this.DrawName(s,h,H.sName[i],e.sSchools[H.iSchoolId[i]],H.iLev[i],H.sMapName[i])}1==this.bLock&&(this.iLockPoint1==i?E.frame_type2("黄色透明框a25_25",this.iX+50+120*i,this.iY+180,110,180,25,25):this.iLockPoint1>=0&&this.iLockPoint1<5&&H.iTeamRid[this.iLockPoint1]>0&&c.gi().DrawTextEx(this.iX+50+120*i+55,this.iY+180+100,"点击交换",4294967040,25,101,1,1,0,-2,-2)),H.bTeamLeader()?(0==i?(this.btn_refuse[i].sName="解散",this.btn_refuse[i].Draw()):(this.btn_refuse[i].sName="请离",this.btn_refuse[i].Draw()),H.iTeamRid[i]<=0&&(this.btn_away[i].sName="召回",this.btn_away[i].Draw())):H.iTmpTeamRid[i]==xh.me.iRid&&(this.btn_refuse[i].sName="离队",this.btn_refuse[i].Draw(),H.iTeamRid[i]<=0?this.btn_away[i].sName="归队":this.btn_away[i].sName="暂离",this.btn_away[i].Draw()),this.btn_watch[i].Draw()}if(!H.bTeamLeader())return this.btn_change.Move(this.iX+50+600-145-10,this.iY+50+70,145,56),this.btn_change.sName="申请带队",void this.btn_change.Draw();this.bLock&&this.iLockPoint1>0&&(this.btn_change.sName="升为队长",this.btn_change.Draw())}Draw_near(){var i,t,s;t=this.iX+30+630+20,s=this.iY+30;for(E.new_framein(t,s,390,this.iH-60),c.gi().DrawText_2(t+195,s+30,"附 近 玩 家("+this.iNRCount+")",4278190080,30,101,1,1,0,-2,-2,3,4286644223),t+=15,s+=55,c.gi().SetViewClip(t,s,t+360,s+380),s-=this.iOffY,this.bResetOBC&&(this.iOBCount=0),i=0;i<this.iNRCount;i++)s<this.iY+85-95||s>this.iY+85+380?s+=95:(gn.xani_nui2.DrawAnima(t,s,"队伍列表标签",this.iRolePoint==i?1:0),gn.xani_head.DrawAnima(t+4,s+4,"新头像"+this.nrs[i].iRaX,0),c.gi().DrawTextEx(t+4+83+10,s+25,this.nrs[i].sName,4294967295,30,101,1,1,0,0,-2),c.gi().DrawTextEx(t+4+83+10,s+65,e.sSchools[this.nrs[i].iSchool]+" 等级"+this.nrs[i].iLev,4294967295,20,101,1,1,0,0,-2),this.bResetOBC&&(this.btn_operate[this.iOBCount].exts[0]=this.nrs[i].iRid,this.nrs[i].bApplyed?(this.iRolePoint==i?(this.btn_operate[this.iOBCount].InitButton("拒绝入队"),this.btn_operate[this.iOBCount].exts[1]=0):(this.btn_operate[this.iOBCount].InitButton("同意入队"),this.btn_operate[this.iOBCount].exts[1]=1),this.btn_operate[this.iOBCount].Move(t+390-130,s+17.5,90,60)):(this.btn_operate[this.iOBCount].InitButton("邀请入队"),this.btn_operate[this.iOBCount].Move(t+390-130,s+17.5,90,60),this.btn_operate[this.iOBCount].exts[1]=2),this.iOBCount++),s+=95);for(i=0;i<this.iOBCount;i++)this.btn_operate[i].Draw();c.gi().NoClip(),this.iLockDelay++,this.bResetOBC=!1,this.bResetOBC=!0}ProcTouch(i,t,s){var e;if(1==this.iPage&&this.bLockX)return 2==i&&(this.iScrollX+=this.iLockX-t,this.iLockX=t),3==i&&(this.bLockX=!1),!0;if(H.bTeamLeader()){for(e=0;e<2;e++)if(this.btn_page[e].ProcTouch(i,t,s))return this.btn_page[e].bCheck()&&this.iPage!=e&&(this.iPage=e,Qt.CleanAnima()),!0;if(this.btn_fastsend.ProcTouch(i,t,s))return this.btn_fastsend.bCheck()&&($t.bOpenInput=!1,$t.Open(),$t.in_speak.sDetail="",$t.ClearCext(),$t.AddTeam()),!0;if(this.btn_autoteam.ProcTouch(i,t,s))return this.btn_autoteam.bCheck()&&Mh.gi().s_TeamOperate(25,0,0),!0;if(this.bLock&&this.iLockPoint1>0&&this.btn_change.ProcTouch(i,t,s))return this.btn_change.bCheck()&&(Mh.gi().s_TeamOperate(8,this.iLockPoint1,0),this.bLock=!1),!0;if(this.btn_dest.ProcTouch(i,t,s))return this.btn_dest.bCheck()&&TeamDest.Open(),!0;var h=this.iX+30+630+20+15,a=this.iY+30+55;if(bn.bInRect(t,s,h,a,360,380)){for(e=0;e<this.iOBCount;e++)if(this.btn_operate[e].ProcTouch(i,t,s))return this.btn_operate[e].bCheck()&&(0==this.btn_operate[e].exts[1]?(Mh.gi().s_TeamOperate(5,this.btn_operate[e].exts[0],0),this.remove_from_list(this.btn_operate[e].exts[0]),this.bResetOBC=!0):1==this.btn_operate[e].exts[1]?(Mh.gi().s_TeamOperate(4,this.btn_operate[e].exts[0],0),this.remove_from_list(this.btn_operate[e].exts[0]),this.bResetOBC=!0):(Mh.gi().s_TeamOperate(6,this.btn_operate[e].exts[0],0),this.remove_from_list(this.btn_operate[e].exts[0]),this.bResetOBC=!0)),!0;return 1==i?(this.iLockDelay=0,this.iLockY=s):2==i&&this.iLockY>0?(this.iOffY+=this.iLockY-s,this.iLockY=s,this.bResetOBC=!0):3==i&&this.iLockY>0&&(this.iOffY+=this.iLockY-s,this.iLockY=-1,this.bResetOBC=!0,this.iLockDelay<6&&(this.iRolePoint=(s-a+this.iOffY)/95,gn.sop("iTeamPoint="+this.iRolePoint+",,,"+this.iOffY))),(e=95*(this.iNRCount-4))<0&&(e=0),this.iOffY<0&&(this.iOffY=0),this.iOffY>e&&(this.iOffY=e),!0}}else if(this.chk_autoback.ProcTouch(i,t,s)&&(this.chk_autoback.bTrue?Mh.gi().s_setflag(2,11,0):Mh.gi().s_setflag(2,11,1)),this.btn_change.ProcTouch(i,t,s))return this.btn_change.bCheck()&&Mh.gi().s_TeamOperate(23,0,0),!0;if(this.iLockY=-1,this.btn_close.ProcTouch(i,t,s))return this.btn_close.bCheck()&&ln.gi().PopStat(1),!0;if(this.btn_zf.ProcTouch(i,t,s))return this.btn_zf.bCheck()&&jt.Open(),!0;if(0==this.iPage){for(e=0;e<5;e++)if(0!=H.iTmpTeamRid[e]){if(this.btn_watch[e].ProcTouch(i,t,s))return this.btn_watch[e].bCheck()&&Mh.gi().s_WatchOn(0,H.iTmpTeamRid[e],0,""),!0;if(this.btn_away[e].ProcTouch(i,t,s)){this.btn_away[e].bCheck()&&(H.bTeamLeader()?0==H.iTeamRid[e]&&Mh.gi().s_TeamOperate(22,H.iTmpTeamRid[e],0):0==H.iTeamRid[e]?Mh.gi().s_TeamOperate(21,0,0):Mh.gi().s_TeamOperate(20,0,0));break}this.btn_roles[e].ProcTouch(i,t,s)&&this.btn_roles[e].bCheck()&&H.bTeamLeader()&&(this.bLock?(this.iLockPoint1!=e&&Mh.gi().s_TeamOperate(8,this.iLockPoint1,e),this.bLock=!1):(this.bLock=!0,this.iLockPoint1=e)),this.btn_refuse[e].ProcTouch(i,t,s)&&this.btn_refuse[e].bCheck()&&(H.bTeamLeader()?(0==e?(Mh.gi().s_TeamOperate(1,xh.me.iRid,0),ln.gi().PopStat(1)):Mh.gi().s_TeamOperate(2,H.iTmpTeamRid[e],0),H.iTeamRid[e]=0,H.iTmpTeamRid[e]=0):H.iTmpTeamRid[e]==xh.me.iRid&&(Mh.gi().s_TeamOperate(1,xh.me.iRid,0),ln.gi().PopStat(1)))}}else if(1==this.iPage&&bn.bInRect(t,s,this.iX+50,this.iY+180,600,365)){for(e=0;e<Qt.iRequestCount;e++){if(this.btn_watch[e].ProcTouch(i,t,s))return this.btn_watch[e].bCheck()&&Mh.gi().s_WatchOn(0,Qt.trl[e].iRid,0,""),!0;if(this.btn_away[e].ProcTouch(i,t,s))return this.btn_away[e].bCheck()&&(Mh.gi().s_TeamOperate(5,Qt.trl[e].iRid,0),Qt.RemoveFromRequest(Qt.trl[e].iRid)),!0;if(this.btn_roles[e].ProcTouch(i,t,s)&&this.btn_roles[e].bCheck(),this.btn_refuse[e].ProcTouch(i,t,s))return this.btn_refuse[e].bCheck()&&(Mh.gi().s_TeamOperate(4,Qt.trl[e].iRid,0),Qt.RemoveFromRequest(Qt.trl[e].iRid)),!0}1==i&&(this.bLockX=!0,this.iLockX=t)}return!1}}Qt.MAXNEARROLE=128,Qt.rolelist=function(i){ln.gi().CheckStat(ln.GS_TEAMOPERATE)&&ln.gi().LastStat(0)._rolelist(i)},Qt.CleanAnima=function(){var i,t=ln.gi().FindStat(ln.GS_TEAMOPERATE);if(null!=t)for(i=0;i<Qt.MAXLIST;i++)t.aa_body[i]=null,t.aa_weapon[i]=null},Qt.ResetWeapon=function(i,t,s,e){var h=gn.de_goods.intValue(i,0,19);return e=gn.xani_weap[2*h+t][N.WeapFlag(i)].InitAnimaWithName(s,e)},Qt.trl,Qt.MAXLIST=32,Qt.iRequestCount=0,Qt.sZz="无",Qt.Open=function(i){ln.gi().PushStat(ln.GS_TEAMOPERATE).iPage=i},Qt.AddTeamRequest=function(i){var t,s,e=i.GetNextInt();if(Qt.RemoveFromRequest(e),Qt.trl&&Qt.trl.length){for(t=Qt.MAXLIST-1;t>0;t--)Qt.trl[t].copyfrom(Qt.trl[t-1]);Qt.trl[0].iRid=e,Qt.trl[0].sName=i.GetNextString(),Qt.trl[0].iRas=i.GetNextByte(),Qt.trl[0].iSchoolId=i.GetNextByte(),Qt.trl[0].iLev=i.GetNextShort(),s=i.GetNextShort(),Qt.trl[0].iColor[0]=7&s,Qt.trl[0].iColor[1]=s>>3&7,Qt.trl[0].iColor[2]=s>>6&7,Qt.trl[0].iColor[3]=s>>9&7,Qt.trl[0].iColor[4]=s>>12&7,Qt.trl[0].iWeapTid=i.GetNextShort(),Qt.trl[0].sMapName=i.GetNextString(),Qt.iRequestCount<Qt.MAXLIST&&Qt.iRequestCount++,qt.gi().bRequestFlash=!0}},Qt.RemoveFromRequest=function(i){var t,s=0;for(t=0;t<Qt.iRequestCount;t++)Qt.trl[t].iRid==i&&(s=1),1==s&&t<Qt.iRequestCount-1&&Qt.trl[t].copyfrom(Qt.trl[t+1]);1==s&&Qt.iRequestCount--,Qt.CleanAnima()};class qt{constructor(){this.bShow=!1,this.iTeamButtonDelay=0,this.bRequestFlash=!1,this.btn_oc=new Eh(gn.xani_frame),this.btn_oc.InitButton("右下底框72_72"),this.bOpening=!1,this.bCloseing=!1,this.iModifyX=0,this.btn_list1=new Array(8),this.btn_list2=new Array(3),this.btn_list3=new Array(5),this.btn_team=new Eh(gn.xani_icon),this.btn_team.InitButton("队伍"),this.btn_fast=new Eh(gn.xani_icon),this.btn_fast.InitButton("快捷"),this.btn_bag=new Eh(gn.xani_icon),this.btn_bag.InitButton("背包"),this.btn_mission=new Eh(gn.xani_icon),this.btn_mission.InitButton("任务"),this.btn_gov=new Eh(gn.xani_icon),this.btn_gov.InitButton("帮派"),this.btn_mounts=new Eh(gn.xani_icon),this.btn_mounts.InitButton("坐骑"),this.btn_fuben=new Eh(gn.xani_icon),this.btn_fuben.InitButton("副本"),this.btn_system=new Eh(gn.xani_icon),this.btn_system.InitButton("系统");var i=0;fn.gi().iLHX>0&&(i=fn.gi().iLHX),this.btn_act=new Eh(gn.xani_icon),this.btn_act.Move(5+i,90,72,72),this.btn_act.InitButton("活动"),this.btn_mall=new Eh(gn.xani_icon),this.btn_mall.Move(5+i,179,72,72),this.btn_mall.InitButton("商城"),this.btn_aq=new Eh(gn.xani_icon),this.btn_aq.Move(5+i,268,72,72),this.btn_aq.InitButton("答题图标"),this.btn_aq.sAnimaName="答题",this.btn_help=new Eh(gn.xani_icon),this.btn_help.Move(5+i,268,72,72),this.btn_help.InitButton("帮助"),this.btn_qq=new Eh(gn.xani_icon),this.btn_qq.Move(5+i,268,72,72),this.btn_qq.InitButton("引导"),this.bCloseing=!1,this.bOpening=!0,this.bShow=!0,this.iModifyX=0,this.aa_effect=gn.xani_skill.InitAnimaWithName("起死回生_右",null),this.btn_list2[0]=this.btn_fast,this.btn_list2[1]=this.btn_team,this.iBtnCount2=2}Draw(){if(!Ih.gi().vbk.mapdialog.bHideUI()&&!xs.jq.bJQLock()){this.bOpening&&(this.iModifyX+=15,this.iModifyX>=qt.MODIFYW&&(this.iModifyX=qt.MODIFYW,this.bOpening=!1)),this.bCloseing&&(this.iModifyX-=15,this.iModifyX<0&&(this.iModifyX=0,this.bCloseing=!1,this.bShow=!1));var i=0;if(this.bShow){for(this.iTeamButtonDelay>0&&this.iTeamButtonDelay--,this.btn_list1[i++]=this.btn_system,xh.me.rbs.iLev>=40&&(this.btn_list1[i++]=this.btn_fuben),xh.me.rbs.iLev>=30&&(this.btn_list1[i++]=this.btn_mounts),xh.me.rbs.iLev>=20&&(this.btn_list1[i++]=this.btn_gov),this.btn_list1[i++]=this.btn_mission,this.btn_list1[i++]=this.btn_bag,this.iBtnCount1=i,i=0;i<this.iBtnCount1;i++)this.btn_list1[i].Move(h.SCRW-80-this.iModifyX*(i+1),h.SCRH-84,72,72);for(i=0;i<this.iBtnCount1;i++)this.btn_list1[i].Draw(),c.gi().DrawText_2(this.btn_list1[i].iX+36,this.btn_list1[i].iY+71,this.btn_list1[i].sAnimaName,4294833640,22,101,1,1,0,-2,-3,3,4279894016);for(i=0;i<this.iBtnCount2;i++)this.btn_list2[i].Move(h.SCRW-80,h.SCRH-80-this.iModifyX*(i+1),72,72);for(this.bRequestFlash&&gn.iDelay/2%2==0&&this.btn_team.Move(this.btn_team.iX+2,this.btn_team.iY+2,72,72),i=0;i<this.iBtnCount2;i++)this.btn_list2[i].Draw(),c.gi().DrawText_2(this.btn_list2[i].iX+36,this.btn_list2[i].iY+71,this.btn_list2[i].sAnimaName,4294833640,22,101,1,1,0,-2,-3,3,4279894016)}this.btn_oc.Move(h.SCRW-80,h.SCRH-84,72,72),this.btn_oc.Draw(),gn.xani_icon.DrawAnimaEx(h.SCRW-80-12,h.SCRH-84-12,"开关箭头",0,101,1,1,180-180*this.iModifyX/qt.MODIFYW,-2,-2),this.btn_list3[0]=this.btn_act,this.btn_list3[1]=this.btn_mall,this.btn_list3[2]=this.btn_help,this.iBtnCount3=3,gt.bShow&&(this.btn_list3[3]=this.btn_aq,this.iBtnCount3++);var t=0;for(fn.gi().iLHX>0&&(t=fn.gi().iLHX),i=0;i<this.iBtnCount3;i++)this.btn_list3[i].Move(5+t,90+89*i,72,72),this.btn_list3[i].Draw(),c.gi().DrawText_2(this.btn_list3[i].iX+36,this.btn_list3[i].iY+71,this.btn_list3[i].sAnimaName,4294833640,22,101,1,1,0,-2,-3,3,4279894016);yt.iHead>0&&3!=ph.iExtHelp&&(this.btn_qq.Draw(),c.gi().DrawText_2(this.btn_qq.iX+40,this.btn_qq.iY+80,this.btn_qq.sAnimaName,4294967295,22,101,1,1,0,-2,-3,3,4278190080))}}ProcTouch(i,t,s){if(yt.iHead>0&&3!=ph.iExtHelp&&this.btn_qq.ProcTouch(i,t,s))return this.btn_qq.bCheck()&&(yt.iPrev=yt.iTall,yt.iHead=yt.iTall,yt.eh=ln.gi().PushStat(ln.GS_EXTHELP),yt.PreviousHelp()),!0;if(this.btn_act.ProcTouch(i,t,s))return this.btn_act.bCheck()&&(Mh.gi().s_PromptActivity(0,0),ln.gi().PushStat(ln.GS_LOADING1)),!0;if(this.btn_mall.ProcTouch(i,t,s))return this.btn_mall.bCheck()&&Mh.gi().s_IngotMall(0,0),!0;if(this.btn_help.ProcTouch(i,t,s))return this.btn_help.bCheck()&&xt.Open(),!0;if(gt.bShow&&this.btn_aq.ProcTouch(i,t,s))return this.btn_aq.bCheck()&&gt.Open(),!0;if(this.btn_oc.ProcTouch(i,t,s))return this.btn_oc.bCheck()&&(this.bShow?(this.bCloseing=!0,this.bOpening=!1,this.iModifyX=qt.MODIFYW):(this.bCloseing=!1,this.bOpening=!0,this.bShow=!0,this.iModifyX=0)),!0;if(!this.bShow)return!1;if(this.btn_bag.ProcTouch(i,t,s))return this.btn_bag.bCheck()&&ht.gi().Open(),!0;if(this.btn_mission.ProcTouch(i,t,s))return this.btn_mission.bCheck()&&Xt.Open(0),!0;if(xh.me.rbs.iLev>=20&&this.btn_gov.ProcTouch(i,t,s))return this.btn_gov.bCheck()&&(-1==Fi.mg.iRealGid?(Mh.gi().s_NewGovOperate(0,0,0,0,0,""),Mh.gi().s_NewGovOperate(2,0,0,0,0,"")):Mh.gi().s_NewGovOperate(3,0,0,0,0,"")),!0;if(xh.me.rbs.iLev>=30&&this.btn_mounts.ProcTouch(i,t,s))return this.btn_mounts.bCheck()&&(Ht.mm.iMountsCount>0?ln.gi().PushStat(ln.GS_MOUNTSFRAME):L.easymsg.AddMessage("你还没有坐骑")),!0;if(xh.me.rbs.iLev>=40&&this.btn_fuben.ProcTouch(i,t,s))return this.btn_fuben.bCheck()&&(0==wt.iStat?Mh.gi().s_FuBen(2,0):1==wt.iStat?Mh.gi().s_FuBen(1,0):2==wt.iStat&&Z.fm.Open("#cffffff"+wt.sDetail+"#e#c00ff00"+wt.sTarget)),!0;if(this.btn_system.ProcTouch(i,t,s))return this.btn_system.bCheck()&&ln.gi().PushStat(ln.GS_SYSTEMOPERATE),!0;if(0==this.iTeamButtonDelay&&this.btn_team.ProcTouch(i,t,s)){if(this.btn_team.bCheck())if(H.bNoTeam())Zt.Open(),this.iTeamButtonDelay=30;else{var e=ln.gi().PushStat(ln.GS_TEAMOPERATE);Mh.gi().s_TeamOperate(10,0,0),this.bRequestFlash&&(this.bRequestFlash=!1,e.iPage=1)}return!0}return!!this.btn_fast.ProcTouch(i,t,s)&&(this.btn_fast.bCheck()&&ln.gi().PushStat(ln.GS_FASTOPERATE),!0)}}qt.MODIFYW=85,qt.fb=null,qt.gi=function(){return null==qt.fb&&(qt.fb=new qt),qt.fb};class Kt{swap(i){var t,s;t=i.iRid,i.iRid=this.iRid,this.iRid=t,s=i.sName,i.sName=this.sName,this.sName=s,t=i.iMapId,i.iMapId=this.iMapId,this.iMapId=t,t=i.iLev,i.iLev=this.iLev,this.iLev=t,t=i.iRaX,i.iRaX=this.iRaX,this.iRaX=t,t=i.iSchool,i.iSchool=this.iSchool,this.iSchool=t,t=i.iTarget,i.iTarget=this.iTarget,this.iTarget=t,t=i.iTargetMap,i.iTargetMap=this.iTargetMap,this.iTargetMap=t,t=i.iCount,i.iCount=this.iCount,this.iCount=t,t=i.iSort,i.iSort=this.iSort,this.iSort=t}constructor(){this.btn_apply=new Eh(gn.xani_nui2),this.btn_apply.InitButton("按钮1_110")}}class Zt extends s{constructor(i){var t;for(super(),this.iW=1020,this.iH=610,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_applyall=new Eh(gn.xani_nui2),this.btn_applyall.InitButton("按钮1"),this.btn_applyall.sName="一键申请",this.btn_autoteam=new Eh(gn.xani_nui2),this.btn_autoteam.InitButton("按钮1"),this.btn_autoteam.sName="自动匹配",this.btn_fresh=new Eh(gn.xani_nui2),this.btn_fresh.InitButton("按钮1"),this.btn_fresh.sName="刷新",this.btn_create=new Eh(gn.xani_nui2),this.btn_create.InitButton("按钮1"),this.btn_create.sName="创建队伍",this.btncs=new Array(16),this.btn_dest=new Array(16),t=0;t<16;t++)this.btncs[t]=new Int32Array(5),this.btn_dest[t]=new D(gn.xani_nui4);this.iDestPoint=0,this.iOpenPoint=-1,this.iOffH=0,this.iShowH=440,this.ResetButton(!0),this.bLocked1=!1,this.bLocked2=!1,this.iTlCount=0,this.tl=new Array(64),this.iOffY=0,this.iLockY=-1,this.iTeamPoint=-1}ResetButton(i){var t;this.iDestCount=0,this.btn_dest[this.iDestCount].InitButton("组队类型1"),this.btn_dest[this.iDestCount].sName="附近",this.btncs[this.iDestCount][0]=0,this.btncs[this.iDestCount][1]=0,this.btncs[this.iDestCount][2]=0,this.btncs[this.iDestCount][3]=0,this.btncs[this.iDestCount][4]=80,this.iDestCount++,xh.me.rbs.iLev>=10&&(this.btn_dest[this.iDestCount].InitButton("组队类型1"),this.btn_dest[this.iDestCount].sName="为民除害",this.btncs[this.iDestCount][0]=1,this.btncs[this.iDestCount][1]=0,this.btncs[this.iDestCount][2]=0,this.btncs[this.iDestCount][3]=10,this.btncs[this.iDestCount][4]=80,this.iDestCount++),xh.me.rbs.iLev>=20&&(this.btn_dest[this.iDestCount].InitButton("组队类型1"),this.btn_dest[this.iDestCount].sName="追捕强盗",this.btncs[this.iDestCount][0]=2,this.btncs[this.iDestCount][1]=0,this.btncs[this.iDestCount][2]=0,this.btncs[this.iDestCount][3]=20,this.btncs[this.iDestCount][4]=80,this.iDestCount++),xh.me.rbs.iLev>=30&&(this.btn_dest[this.iDestCount].InitButton("组队类型1"),this.btn_dest[this.iDestCount].sName="山贼宝图",this.btncs[this.iDestCount][0]=3,this.btncs[this.iDestCount][1]=0,this.btncs[this.iDestCount][2]=0,this.btncs[this.iDestCount][3]=30,this.btncs[this.iDestCount][4]=80,this.iDestCount++),xh.me.rbs.iLev>=40&&(this.btn_dest[this.iDestCount].InitButton("组队类型1"),this.btn_dest[this.iDestCount].sName="挑战嚣张",this.btncs[this.iDestCount][0]=4,this.btncs[this.iDestCount][1]=0,this.btncs[this.iDestCount][2]=0,this.btncs[this.iDestCount][3]=40,this.btncs[this.iDestCount][4]=80,this.iDestCount++),xh.me.rbs.iLev>=20&&(this.btn_dest[this.iDestCount].InitButton("组队类型1"),this.btn_dest[this.iDestCount].sName="封印叔叔",this.btncs[this.iDestCount][0]=5,this.btncs[this.iDestCount][1]=0,this.btncs[this.iDestCount][2]=0,this.btncs[this.iDestCount][3]=20,this.btncs[this.iDestCount][4]=80,this.iDestCount++),this.btn_dest[this.iDestCount].InitButton("组队类型1"),this.btn_dest[this.iDestCount].sName="定时活动",this.btncs[this.iDestCount][0]=99,this.btncs[this.iDestCount][1]=0,i&&(this.iOpenPoint=this.iDestCount),t=this.iDestCount,this.iOpenPoint==t?this.btncs[this.iDestCount][2]=1:this.btncs[this.iDestCount][2]=2,this.btncs[this.iDestCount][3]=20,this.btncs[this.iDestCount][4]=80,this.iDestCount++,this.iOpenPoint==t&&xh.me.rbs.iLev>=30&&(this.btn_dest[this.iDestCount].InitButton("组队类型2"),this.btn_dest[this.iDestCount].sName="门派闯关",this.btncs[this.iDestCount][0]=6,this.btncs[this.iDestCount][1]=0,this.btncs[this.iDestCount][2]=0,this.btncs[this.iDestCount][3]=30,this.btncs[this.iDestCount][4]=80,this.iDestCount++,this.btn_dest[this.iDestCount].InitButton("组队类型2"),this.btn_dest[this.iDestCount].sName="保卫西阳",this.btncs[this.iDestCount][0]=7,this.btncs[this.iDestCount][1]=0,this.btncs[this.iDestCount][2]=0,this.btncs[this.iDestCount][3]=30,this.btncs[this.iDestCount][4]=80,this.iDestCount++),this.iDestH=85*this.iDestCount-5+40}Draw(){var i,t,s,h,a,n;for(E.new_baseframe2(this.iX,this.iY,this.iW,this.iH,"组","队"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_close.Draw(),this.bLocked1||(this.iOffH>0&&(this.iOffH/=2),i=this.iDestH<this.iShowH?this.iDestH:this.iShowH,(t=this.iDestH+this.iOffH)<i&&(this.iOffH+=(i-t)/2)),this.bLocked2||(this.iOffY>0&&(this.iOffY/=2),i=83*this.iTlCount<445?83*this.iTlCount:445,(t=83*this.iTlCount+this.iOffY)<i&&(this.iOffY+=(i-t)/2)),s=this.iX+30,h=this.iY+30,a=270,n=this.iH-60,E.new_framein(s,h,a,n),c.gi().SetViewClip(s+20,h+20,s+20+230,h+20+this.iShowH),i=0;i<this.iDestCount;i++)this.btn_dest[i].Move(s+20,h+20+85*i+this.iOffH,230,80),i==this.iDestPoint&&(this.btn_dest[i].bMouseIn=!0,this.btn_dest[i].bMouseDown=!0),this.btn_dest[i].Draw(),1==this.btncs[i][2]?gn.xani_nui4.DrawAnima(this.btn_dest[i].iX,this.btn_dest[i].iY,"组队目录开关",1):2==this.btncs[i][2]&&gn.xani_nui4.DrawAnima(this.btn_dest[i].iX,this.btn_dest[i].iY,"组队目录开关",0);for(c.gi().NoClip(),this.btn_create.Move(s+a/2-80.5,h+n-20-53,161,53),this.btn_create.Draw(),s=this.iX+30+270+20,h=this.iY+30,a=this.iW-30-30-270-20,n=this.iH-60,E.new_framein(s,h,a,n),this.btn_applyall.Move(s+20,h+n-20-53,161,53),this.btn_applyall.Draw(),H.bSingleAutoTeaming?this.btn_autoteam.sName="匹配中...":this.btn_autoteam.sName="自动匹配",this.btn_autoteam.Move(s+20+161+70,h+n-20-53,161,53),this.btn_autoteam.Draw(),this.btn_fresh.Move(s+20+161+70+161+70,h+n-20-53,161,53),this.btn_fresh.Draw(),this.iTlCount<=0&&c.gi().DrawTextEx(s+a/2,h+n/2-40,"当前目标没有队伍",4278206039,35,101,1,1,0,-2,-2),s+=20,h+=20,c.gi().SetViewClip(s,h,s+630,h+415+30),h+=this.iOffY,i=0;i<this.iTlCount;i++)gn.xani_nui4.DrawAnima(s,h,"队伍条",0),gn.xani_nui4.DrawAnima(s,h,"队伍条",this.tl[i].iCount),gn.xani_head.DrawAnimaEx(s+8,h+8,"新头像"+this.tl[i].iRaX,0,101,.8,.8,0,0,0),c.gi().DrawTextEx(s+8+80,h+20,this.tl[i].sName,4294967295,22,101,1,1,0,0,-2),c.gi().DrawTextEx(s+8+80,h+57,e.sSchools[this.tl[i].iSchool],4294967295,22,101,1,1,0,0,-2),c.gi().DrawTextEx(s+8+80+70,h+57,this.tl[i].iLev+"级",4294967040,22,101,1,1,0,0,-2),c.gi().DrawTextEx(s+375,h+27,gn.de_map.strValue(this.tl[i].iMapId,0,1),4294967295,20,101,1,1,0,-3,-2),this.tl[i].iTarget>0&&this.tl[i].iTarget<5&&c.gi().DrawTextEx(s+385,h+27,Zt._TARGET[this.tl[i].iTarget],4294967295,20,101,1,1,0,0,-2),c.gi().DrawTextEx(s+390,h+61,this.tl[i].iCount+"/5",4278190080,20,101,1,1,0,-2,-2),this.tl[i].btn_apply.Move(s+500,h+39-26,110,52),Ih.gi().iCurrentMapId==this.tl[i].iMapId?this.tl[i].btn_apply.sName="申请":this.tl[i].btn_apply.sName="前往",this.tl[i].bApplyed?c.gi().DrawTextEx(this.tl[i].btn_apply.iX+this.tl[i].btn_apply.iW/2,this.tl[i].btn_apply.iY+this.tl[i].btn_apply.iH/2,"已申请",4278206039,30,101,1,1,0,-2,-2):this.tl[i].btn_apply.Draw(),h+=83;c.gi().NoClip()}ProcTouch(i,t,s){if(3==i){if(this.bLocked1)return this.bLocked1=!1,!0;if(this.bLocked2)return this.bLocked2=!1,!0}var e,h,a,n;if(a=this.iX+30,n=this.iY+30,bn.bInRect(t,s,a,n,270,20+this.iShowH)){for(e=0;e<this.iDestCount;e++)this.btn_dest[e].ProcTouch(i,t,s)&&this.btn_dest[e].bCheck()&&(this.iDestPoint=e,99==this.btncs[e][0]&&(this.iOpenPoint<0?this.iOpenPoint=e:this.iOpenPoint=-1,this.ResetButton(!1)),Mh.gi().s_TeamOperate(12,this.btncs[this.iDestPoint][0],this.btncs[this.iDestPoint][1]));if(1==i&&(this.iLockY=s),2==i&&!this.bLocked1&&((e=this.iLockY-s)<-15||e>15))for(this.bLocked1=!0,e=0;e<this.iDestCount;e++)this.btn_dest[e].bMouseDown=!1}if(2==i&&this.bLocked1)return e=this.iLockY-s,this.iOffH-=e,this.iLockY=s,!0;if(a=this.iX+30+270+20+20,n=this.iY+30+20,bn.bInRect(t,s,a,n,630,445)){for(e=0;e<this.iTlCount;e++)this.tl[e].bApplyed||this.tl[e].btn_apply.ProcTouch(i,t,s)&&this.tl[e].btn_apply.bCheck()&&(Ih.gi().iCurrentMapId==this.tl[e].iMapId?(Mh.gi().s_TeamOperate(3,this.tl[e].iRid,0),this.tl[e].bApplyed=!0):(Ue.gi().FindMap(this.tl[e].iMapId,-1,-1,!1,!0)&&(Zt.iWaitingApplyMapId=this.tl[e].iMapId,Zt.iWaitingApplyRid=this.tl[e].iRid),ln.gi().PopStat(1)));1==i&&(this.iLockY=s),2==i&&(this.bLocked2||((e=this.iLockY-s)<-15||e>15)&&(this.bLocked2=!0))}if(2==i&&this.bLocked2)return e=this.iLockY-s,this.iOffY-=e,this.iLockY=s,!0;if(this.btn_create.ProcTouch(i,t,s))return this.btn_create.bCheck()&&(Mh.gi().s_TeamOperate(0,this.btncs[this.iDestPoint][0],this.btncs[this.iDestPoint][1]),ln.gi().PopStat(1),qt.gi().iTeamButtonDelay=30),!0;if(this.btn_fresh.ProcTouch(i,t,s))return this.btn_fresh.bCheck()&&Mh.gi().s_TeamOperate(12,this.btncs[this.iDestPoint][0],this.btncs[this.iDestPoint][1]),!0;if(this.btn_applyall.ProcTouch(i,t,s)){if(this.btn_applyall.bCheck()){for(h=0,e=0;e<this.iTlCount;e++)this.tl[e].bApplyed||Ih.gi().iCurrentMapId==this.tl[e].iMapId&&(Mh.gi().s_TeamOperate(3,this.tl[e].iRid,0),this.tl[e].bApplyed=!0,h++);0==h&&L.easymsg.AddMessage("附近没有队伍可申请")}return!0}return this.btn_autoteam.ProcTouch(i,t,s)?(this.btn_autoteam.bCheck()&&(this.btncs[this.iDestPoint][0]<0||this.btncs[this.iDestPoint][0]>7?L.easymsg.AddMessage("请先选择队伍目标"):Mh.gi().s_TeamOperate(25,this.btncs[this.iDestPoint][0],0)),!0):this.btn_close.ProcTouch(i,t,s)?(this.btn_close.bCheck()&&ln.gi().PopStat(1),!0):(bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||ln.gi().PopStat(1),!1)}}Zt.iWaitingApplyMapId=0,Zt.iWaitingApplyRid=0,Zt._LEV_MAP=[[10,14,18,19],[15,19,18,19,20],[20,24,19,20,21],[25,29,20,21,22],[30,34,21,22,23],[35,39,22,23,24],[40,44,23,24,25],[45,49,24,25,26],[50,54,25,26,27],[55,59,26,27,35],[60,64,27,35,36],[65,69,25,26,50],[70,72,36,50,51],[73,74,50,51,52],[75,76,51,52,53],[77,100,52,53]],Zt._TARGET=["无目标","为民除害","追捕强盗","山贼宝图","挑战嚣张","封印叔叔","门派闯关","保卫西阳"],Zt.Open=function(){ln.gi().CheckStat(ln.GS_TEAMCREATE)||(ln.gi().PushStat(ln.GS_TEAMCREATE),Mh.gi().s_TeamOperate(12,0,0))},Zt.teamlist=function(i){if(ln.gi().CheckStat(ln.GS_TEAMCREATE)){var t,s=ln.gi().LastStat(0),e=0;for(s.iTlCount=0;0!=(t=i.GetNextInt())&&(s.tl[e]=new Kt,s.tl[e].iRid=t,s.tl[e].sName=i.GetNextString(),s.tl[e].iMapId=i.GetNextShort(),s.tl[e].iLev=i.GetNextShort(),t=i.GetNextByte(),s.tl[e].iRaX=t%10,s.tl[e].iSchool=parseInt(t/10),s.tl[e].iTarget=i.GetNextByte(),s.tl[e].iTargetMap=i.GetNextShort(),s.tl[e].iCount=i.GetNextByte(),s.tl[e].bApplyed=!1,s.tl[e].iSort=xh.me.rbs.iLev-s.tl[e].iLev,s.tl[e].iSort<0&&(s.tl[e].iSort=-s.tl[e].iSort),!(++e>=60)););for(s.iTlCount=e,t=0;t<s.iTlCount-1;t++)for(e=t+1;e<s.iTlCount;e++)s.tl[t].iSort>s.tl[e].iSort&&s.tl[t].swap(s.tl[e])}};class $t extends s{constructor(i){var t;for(super(),this.iW=590,this.iH=360,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2-50,this.btn_channel=new Array(7),t=0;t<7;t++)this.btn_channel[t]=new Eh(gn.xani_button),this.btn_channel[t].Move(this.iX+25+80*t,this.iY+25,60,60),this.btn_channel[t].InitButton("频道选择");if(this.btn_channel[0].sName="当",this.btn_channel[1].sName="队",this.btn_channel[2].sName="门",this.btn_channel[3].sName="帮",this.btn_channel[4].sName="世",this.btn_channel[5].sName="传",this.btn_channel[6].sName="叭",this.bSelectColor=!1,this.bSelectFace=!1,t=75,this.btn_voice=new Eh(gn.xani_button),this.btn_voice.Move(this.iX+25,this.iY+this.iH-25-65,64,65),this.btn_voice.InitButton("发送语音"),this.btn_face=new Eh(gn.xani_button),this.btn_face.Move(this.iX+25+t+t,this.iY+this.iH-25-65,64,65),this.btn_face.InitButton("发送表情"),this.btn_goods=new Eh(gn.xani_button),this.btn_goods.Move(this.iX+25+t+t+t,this.iY+this.iH-25-65,64,65),this.btn_goods.InitButton("发送物品"),this.btn_pet=new Eh(gn.xani_button),this.btn_pet.Move(this.iX+25+t+t+t+t,this.iY+this.iH-25-65,64,65),this.btn_pet.InitButton("发送宠物"),this.btn_team=new Eh(gn.xani_button),this.btn_team.Move(this.iX+25+5*t,this.iY+this.iH-25-65,64,65),this.btn_team.InitButton("发送队伍"),this.btn_send=new Eh(gn.xani_button),this.btn_send.Move(this.iX+this.iW-90-25,this.iY+this.iH-25-65+2,90,60),this.btn_send.InitButton("发送聊天按钮"),this.btn_send.sName="发送",$t.in_speak=new pi(gn.xani_nui3),$t.in_speak.Move(this.iX+25,this.iY+25+60+10,this.iW-50,this.iH-25-65-10-25-60-10),$t.in_speak.bHideText=!0,$t.bOpenInput&&$t.in_speak.OpenInput(),$t.bOpenInput=!0,this.iCurrentColor=16777215,null==$t.cext){for($t.cext=new Array(5),t=0;t<5;t++)$t.cext[t]=new V;$t.ClearCext()}this.iRecordDelay=0,this.iRecordStat=0,this.iRecordingShow=0,this.bSend=!1}Draw(){var i,t;for($t.iChannelPoint<0&&($t.iChannelPoint=0),$t.iChannelPoint>6&&($t.iChannelPoint=6),E.frame_type4("中等框a52_50",this.iX,this.iY,this.iW,this.iH,52,50),E.frame_type4("聊天显示框亮20_20",$t.in_speak.iX,$t.in_speak.iY,$t.in_speak.iW,$t.in_speak.iH,20,20),i=0;i<7;i++)$t.iChannelPoint==i&&(this.btn_channel[i].bMouseIn=!0,this.btn_channel[i].bMouseDown=!0),this.btn_channel[i].Draw();for($t.in_speak.onscr(),t="#c176b51"+$t.in_speak.sDetail,i=0;i<4;i++)$t.cext[i].type>=100||(t.indexOf("#x"+(i+1))>=0?t=3==i?t.replace("#x"+(i+1),"#c00c000[语音:"+$t.cext[i].detail+"]#o"):t.replace("#x"+(i+1),"#c00c000["+$t.cext[i].name+"]#o"):$t.cext[i].type=100);switch(Y.gi().FormatEx(t,$t.in_speak.iW-30,29,0,0,35),Y.gi().Draw($t.in_speak.iX+15,$t.in_speak.iY+10),this.btn_voice.Draw(),this.btn_face.Draw(),this.btn_goods.Draw(),this.btn_pet.Draw(),this.btn_team.Draw(),this.btn_send.Draw(),this.bSelectFace&&_t.gi().Draw(),this.iRecordStat){case 0:break;case 1:E.frame_type4("语音输入背景20_20",h.SCRW/2-120,h.SCRH/2-120,240,305,20,20),E.frame_type1("语音输入字底框20_35",h.SCRW/2-100,h.SCRH/2+100+20,200,20);var s=h.SCRW/2-100,a=h.SCRH/2+100+20;c.gi().FillRect_2D(s,a,s+200*(e.VOICETIMEOUT-this.iRecordDelay)/e.VOICETIMEOUT,a+35,822083583),1==this.iRecordingShow?(gn.xani_other.DrawAnima(h.SCRW/2-100,h.SCRH/2-100,"录音中",0),c.gi().DrawTextEx(h.SCRW/2,h.SCRH/2+100+20+17.5,"手指划开，取消录制",4294967295,18,101,1,1,0,-2,-2)):2==this.iRecordingShow&&(gn.xani_other.DrawAnima(h.SCRW/2-100,h.SCRH/2-100,"移开手指",0),c.gi().DrawTextEx(h.SCRW/2,h.SCRH/2+100+20+17.5,"手指划开，取消发送",4294967295,18,101,1,1,0,-2,-2));break;case 2:if("empty"!=gn.m_vi.sRecordName){if(gn.m_vi.iRecordTime<=1e3){L.easymsg.AddMessage("录音时间太短"),this.iRecordStat=0;break}this.iRecordDelay=e.VOICETIMEOUT,$t.cext[3].type=2,$t.cext[3].eid=gn.m_vi.iRecordTime,-1==$t.in_speak.sDetail.indexOf("#x4")&&($t.in_speak.sDetail+="#x4",$t.in_speak.OpenInput()),$t.cext[3].name="",$t.cext[3].detail="",gn.m_vi.UpLoad(),this.iRecordStat=3}break;case 3:"empty"!=gn.m_vi.sUrlName&&(this.iRecordDelay=e.VOICETIMEOUT,$t.cext[3].name=gn.m_vi.sUrlName,gn.m_vi.StartRecognize(),this.iRecordStat=4);break;case 4:"empty"!=gn.m_vi.sRecognizeResult&&($t.cext[3].detail=gn.m_vi.sRecognizeResult,this.iRecordStat=0)}this.iRecordStat>0&&(this.iRecordDelay--,this.iRecordDelay<=0&&(this.iRecordStat=0,gn.m_vi.StopRecord(),L.easymsg.AddMessage("录音超时取消"))),this.bSend&&0==this.iRecordStat&&(this.bSend=!1,this.SendMessage())}ProcTouch(i,t,s){var h;if(this.bSelectFace)return _t.gi().ProcTouch(i,t,s)&&0!=_t.gi().iSelectStat&&(1==_t.gi().iSelectStat&&($t.in_speak.sDetail+="#f"+_t.gi().iSelectPoint,$t.in_speak.OpenInput()),this.bSelectFace=!1),!0;if(this.bSelectColor)return ft.sc.ProcTouch(i,t,s)&&0!=ft.sc.iSelectStat&&(1==ft.sc.iSelectStat&&($t.in_speak.sDetail+="#c"+ft.sc.tostr(),$t.in_speak.OpenInput(),this.iCurrentColor=ft.sc.iColor),this.bSelectColor=!1),!0;if(this.btn_face.ProcTouch(i,t,s))return this.btn_face.bCheck()&&(this.bSelectFace=!0,_t.gi().Init()),!0;if(this.btn_goods.ProcTouch(i,t,s))return this.btn_goods.bCheck()&&pt.Open(0),!0;if(this.btn_pet.ProcTouch(i,t,s))return this.btn_pet.bCheck()&&ut.Open(0),!0;if(this.btn_team.ProcTouch(i,t,s))return this.btn_team.bCheck()&&$t.AddTeam(),!0;if(bn.bInRect(t,s,this.btn_voice.iX,this.btn_voice.iY,this.btn_voice.iW,this.btn_voice.iH)){if(1==i){if(0==this.iRecordStat){if(!gn.m_vi.StartRecord())return L.easymsg.AddMessage("启动录音失败"),!0;this.iRecordStat=1,this.iRecordDelay=e.VOICETIMEOUT}}else 3==i&&1==this.iRecordStat&&(gn.m_vi.StopRecord(),this.iRecordStat=2);return this.iRecordingShow=1,!0}if(1==this.iRecordStat)return 3==i&&(gn.m_vi.StopRecord(),this.iRecordStat=0),this.iRecordingShow=2,!0;for(this.iRecordingShow=0,h=0;h<7;h++)this.btn_channel[h].ProcTouch(i,t,s)&&this.btn_channel[h].bCheck()&&(6==h?ht.bHaveGoods(122,1)?$t.iChannelPoint=h:L.easymsg.AddMessage("背包中没有小喇叭"):$t.iChannelPoint=h);return $t.in_speak.ProcTouch(i,t,s),this.btn_send.ProcTouch(i,t,s)?(this.btn_send.bCheck()&&(this.bSend=!0,0!=this.iRecordStat&&L.easymsg.AddMessage("正在处理中，请稍后...")),!0):!!bn.bOnRect(t,s,this.iX,this.iY,this.iW,this.iH)||(3==i&&ln.gi().PopStat(1),!1)}SendMessage(){var i;if($t.in_speak.sDetail.length>100)L.easymsg.AddMessage("文字太长"),$t.in_speak.sDetail="";else if($t.in_speak.sDetail.length>0){var t=$t.in_speak.sDetail;for(i=0;i<4;i++)$t.cext[i].type>=100||(t.indexOf("#x"+(i+1))>=0?t=3==i?t.replace("#x"+(i+1),e.EXTCOLOR+"[语音:"+$t.cext[i].detail+"]#o"):t.replace("#x"+(i+1),e.EXTCOLOR+"["+$t.cext[i].name+"]#o"):$t.cext[i].type=100);Mh.gi().s_PublicChat($t.iChannelPoint,t),$t.in_speak.sDetail="",$t.ClearCext(),ln.gi().PopStat(1)}else L.easymsg.AddMessage("请先输入文字")}}$t.iChannelPoint=0,$t.in_speak=null,$t.cext=null,$t.AddTeam=function(){var i;if(H.bTeamLeader()){for(null==$t.cext&&$t.ClearCext(),i=0;i<3;i++)if(100==$t.cext[i].type)return $t.cext[i].type=4,$t.cext[i].eid=xh.me.iRid,$t.cext[i].tid=0,$t.cext[i].name="申请入队",$t.in_speak.sDetail+=Zt._TARGET[H.iTeamTarget]+""+H.iLev1+"级~"+H.iLev2+"级#x"+(i+1),void $t.in_speak.OpenInput();L.easymsg.AddMessage("最多添加3个发送项目")}else L.easymsg.AddMessage("队长才能添加")},$t.AddGoods=function(i){var t;for(null==$t.cext&&$t.ClearCext(),t=0;t<3;t++)if(100==$t.cext[t].type)return $t.cext[t].type=0,$t.cext[t].eid=i.iGid,$t.cext[t].tid=i.iTid,$t.cext[t].name=gn.de_goods.strValue(i.iTid,0,4),$t.in_speak.sDetail+="#x"+(t+1),void $t.in_speak.OpenInput();L.easymsg.AddMessage("最多添加3个物品或宠物")},$t.AddPet=function(i){var t;for(null==$t.cext&&$t.ClearCext(),t=0;t<3;t++)if(100==$t.cext[t].type)return $t.cext[t].type=1,$t.cext[t].eid=i.iPid,$t.cext[t].tid=i.iTid,$t.cext[t].name=gn.de_pet.strValue(i.iTid,0,1),$t.in_speak.sDetail+="#x"+(t+1),void $t.in_speak.OpenInput();L.easymsg.AddMessage("最多添加3个物品或宠物")},$t.bOpenInput=!0,$t.Open=function(){ln.gi().PushStat(ln.GS_SENDPUBLICCHAT)},$t.ClearCext=function(){var i;if(null==$t.cext)for($t.cext=new Array(5),i=0;i<5;i++)$t.cext[i]=new V;for(i=0;i<5;i++)$t.cext[i].type=100};class is extends s{constructor(i){var t;for(super(),this._FCLIST=["当前频道","队伍频道","门派频道","帮派频道","世界频道","传闻频道","系统频道"],this._AUTO=["当前语音","队伍语音","门派语音","帮派语音","世界语音","传闻语音"],this._FAST=["当前语音","队伍语音","门派语音","帮派语音","世界语音","传闻语音"],this.iW=700,this.iH=570,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.chk_fchannel=new Array(8),this.chk_autoplay=new Array(8),this.chk_fastvoice=new Array(8),t=0;t<7;t++)this.chk_fchannel[t]=new T(gn.xani_button),this.chk_fchannel[t].InitBox("复选框50_53"),0==(ph.iFilterChannel&1<<t)?this.chk_fchannel[t].bTrue=!1:this.chk_fchannel[t].bTrue=!0,this.chk_fchannel[t].sDetail=this._FCLIST[t];for(t=0;t<6;t++)this.chk_autoplay[t]=new T(gn.xani_button),this.chk_autoplay[t].InitBox("复选框50_53"),0==(ph.iAutoPlay&1<<t)?this.chk_autoplay[t].bTrue=!1:this.chk_autoplay[t].bTrue=!0,this.chk_autoplay[t].sDetail=this._AUTO[t],this.chk_fastvoice[t]=new T(gn.xani_button),this.chk_fastvoice[t].InitBox("复选框50_53"),0==(ph.iFastVoice&1<<t)?this.chk_fastvoice[t].bTrue=!1:this.chk_fastvoice[t].bTrue=!0,this.chk_fastvoice[t].sDetail=this._FAST[t]}Draw(){var i,t,s;for(E.frame_type4("中等框a52_50",this.iX,this.iY,this.iW,this.iH,52,50),this.iH-50,200,t=this.iX+25,s=this.iY+25,E.frame_type4("聊天显示框暗20_20",t,s,200,this.iH-50,20,20),E.frame_type4("单色内框a20_20",t+20,s+20,160,50,20,20),c.gi().DrawTextEx(t+100,s+20+25,"频道过滤",4279724881,30,101,1,1,0,-2,-2),i=0;i<7;i++)this.chk_fchannel[i].Move(t+20,s+20+50+20+60*i,50,50),this.chk_fchannel[i].Draw();for(t+=225,E.frame_type4("聊天显示框暗20_20",t,s,200,this.iH-50,20,20),E.frame_type4("单色内框a20_20",t+20,s+20,160,50,20,20),c.gi().DrawTextEx(t+100,s+20+25,"自动播放",4279724881,30,101,1,1,0,-2,-2),i=0;i<6;i++)this.chk_autoplay[i].Move(t+20,s+20+50+20+60*i,50,50),this.chk_autoplay[i].Draw();for(t+=225,E.frame_type4("聊天显示框暗20_20",t,s,200,this.iH-50,20,20),E.frame_type4("单色内框a20_20",t+20,s+20,160,50,20,20),c.gi().DrawTextEx(t+100,s+20+25,"快捷语音",4279724881,30,101,1,1,0,-2,-2),i=0;i<6;i++)this.chk_fastvoice[i].Move(t+20,s+20+50+20+60*i,50,50),this.chk_fastvoice[i].Draw()}ProcTouch(i,t,s){var e;for(e=0;e<7;e++)this.chk_fchannel[e].ProcTouch(i,t,s)&&(ph.iFilterChannel=ph.iFilterChannel&~(1<<e),this.chk_fchannel[e].bTrue&&(ph.iFilterChannel|=1<<e));for(e=0;e<6;e++)this.chk_autoplay[e].ProcTouch(i,t,s)&&(ph.iAutoPlay=ph.iAutoPlay&~(1<<e),this.chk_autoplay[e].bTrue&&(ph.iAutoPlay|=1<<e)),this.chk_fastvoice[e].ProcTouch(i,t,s)&&(ph.iFastVoice=ph.iFastVoice&~(1<<e),this.chk_fastvoice[e].bTrue&&(ph.iFastVoice|=1<<e));return bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||3!=i||ln.gi().PopStat(1),!1}}is.Open=function(){ln.gi().PushStat(ln.GS_SETCHATVALUE)};class ts extends s{InitButton(){if(!this.bInited){var i;for(this.btn_set=new Eh(gn.xani_button),this.btn_set.InitButton("聊天设置"),this.btn_face=new Eh(gn.xani_button),this.btn_face.InitButton("发送表情"),this.btn_send=new Eh(gn.xani_button),this.btn_send.InitButton("发送聊天按钮"),this.btn_send.sName="发送",this.in_words=new pi(gn.xani_ui),this.in_words.sDetail="",this.in_words.sBackPrompt="点击这里输入聊天信息",this.in_words.iBackSize=20,this.in_words.iTextSize=30,this.in_words.iTextColor=4279724881,this.btn_channel=new Array(8),i=0;i<8;i++)this.btn_channel[i]=new Eh(gn.xani_button),this.btn_channel[i].InitButton("频道选择");this.btn_channel[0].sName="全",this.btn_channel[1].sName="当",this.btn_channel[2].sName="队",this.btn_channel[3].sName="门",this.btn_channel[4].sName="帮",this.btn_channel[5].sName="世",this.btn_channel[6].sName="传",this.btn_channel[7].sName="系",this.btn_voice=new Eh(gn.xani_button),this.btn_voice.InitButton("发送语音"),this.btn_opensend=new Eh(gn.xani_button),this.btn_opensend.InitButton("打开公聊输入框"),this.btn_close=new Eh(gn.xani_frame),this.btn_close.InitButton("聊天半屏关闭框45_106"),this.bInited=!0}}constructor(i){var t;for(super(),this.chk_switch=new Array(8),t=0;t<8;t++)this.chk_switch[t]=new T(gn.xani_nui3),this.chk_switch[t].InitBox("统一勾选"),this.chk_switch[t].Move(this.iX+this.iW-25-50-60,this.iY+25+55*t,50,50),this.chk_switch[t].bTrue=!0,t>0&&(this.chk_switch[t].bTrue=es.gi().bMessageSwitch[t-1]);this.chk_switch[1].sDetail="当前",this.chk_switch[2].sDetail="队伍",this.chk_switch[3].sDetail="门派",this.chk_switch[4].sDetail="帮派",this.chk_switch[5].sDetail="世界",this.chk_switch[6].sDetail="传闻",this.bScrolling=!1,this.iRecordDelay=0,this.iRecordStat=0,this.iVoiceChannelPoint=0,this.iRecordingShow=0}DrawSelect(i,t,s){var e;for(e=0;e<5;e++)switch(s.exts[e].type){case 0:case 1:case 2:if(s.lrs_big[e].CopyFrom(Y.gi().lrs[e]),s.exts[e].iShowDelay>0){for(var h=0;h<s.lrs_big[e].iCount;h++){var a=i+s.lrs_big[e].rs[h].iX,n=t+s.lrs_big[e].rs[h].iY,o=i+s.lrs_big[e].rs[h].iX+s.lrs_big[e].rs[h].iW,r=t+s.lrs_big[e].rs[h].iY+s.lrs_big[e].rs[h].iH;c.gi().FillRect_2D(a,n,o,r,16711935|s.exts[e].iShowDelay<<24)}s.exts[e].iShowDelay>200?s.exts[e].iShowDelay-=3:s.exts[e].iShowDelay>150?s.exts[e].iShowDelay-=6:s.exts[e].iShowDelay>100?s.exts[e].iShowDelay-=9:s.exts[e].iShowDelay>50?s.exts[e].iShowDelay-=12:s.exts[e].iShowDelay=0}}}DrawPms(i,t,s,h,a){var n,o=es.gi(),r="#c176b51"+a.sMessage;for(n=1;n<5;n++)switch(a.exts[n].type){case 0:r=Y.gi().InsertLocker(n,r,"["+gn.de_goods.strValue(a.exts[n].tid,0,4)+"]",e.EXTCOLOR,"#c00c000");break;case 1:r=Y.gi().InsertLocker(n,r,"["+gn.de_pet.strValue(a.exts[n].tid,0,1)+"]",e.EXTCOLOR,"#c00c000");break;case 2:r=Y.gi().InsertLocker(n,r,"[语音:"+a.exts[n].detail+"]",e.EXTCOLOR,"#c00c000");break;case 4:r=Y.gi().InsertLocker(n,r,"[申请入队]",e.EXTCOLOR,"#c00c000")}for(Y.gi().Format(r,s-90,yh.WordSize(24)),Y.gi().CheckOutRect(),n=0;n<5;n++)switch(a.exts[n].type){case 0:case 1:case 2:case 3:case 4:a.lrs_big[n].CopyFrom(Y.gi().lrs[n])}var l=Y.gi().iH+10+10+24,b=t-l;return a.iRid==xh.me.iRid?(a.ox=i+s-52-10-Y.gi().iW-10,a.oy=b+24+10,a.ow=Y.gi().iW,a.oh=Y.gi().iH,a.headx=i+s-52,a.heady=b,gn.xani_head.DrawAnimaEx(i+s-52,b,"新头像"+a.iRax,0,101,.65,.65,0,0,0),gn.xani_frame.DrawAnima(i+s-52-10-24,b,"聊天频道框24_24",0),c.gi().DrawTextEx(i+s-52-10-24+12,b+12,o._CHANNELSHORT[h],o._CHANNELCOLORI[h],20,101,1,1,0,-2,-2),c.gi().DrawTextEx(i+s-52-10-24-5,b+12,a.sName,4279724881,24,101,1,1,0,-3,-2),E.frame_type4("聊天内容框20_20",i+s-52-10-(Y.gi().iW+20),b+24,Y.gi().iW+20,Y.gi().iH+20,20,20),gn.xani_frame.DrawAnima(i+s-52-10,b+24,"聊天内容框20_20",10),this.DrawSelect(i+s-52-10-Y.gi().iW-10,b+24+10,a),Y.gi().Draw(i+s-52-10-Y.gi().iW-10,b+24+10)):(a.ox=i+52+10+10,a.oy=b+24+10,a.ow=Y.gi().iW,a.oh=Y.gi().iH,a.headx=i,a.heady=b,gn.xani_head.DrawAnimaEx(i,b,"新头像"+a.iRax,0,101,.65,.65,0,0,0),gn.xani_frame.DrawAnima(i+52+10,b,"聊天频道框24_24",0),c.gi().DrawTextEx(i+52+10+12,b+12,o._CHANNELSHORT[h],o._CHANNELCOLORI[h],20,101,1,1,0,-2,-2),c.gi().DrawTextEx(i+52+10+24+5,b+12,a.sName,4279724881,24,101,1,1,0,0,-2),E.frame_type4("聊天内容框20_20",i+52+10,b+24,Y.gi().iW+20,Y.gi().iH+20,20,20),gn.xani_frame.DrawAnima(i+52+10,b+24,"聊天内容框20_20",9),this.DrawSelect(i+52+10+10,b+24+10,a),Y.gi().Draw(i+52+10+10,b+24+10)),l}DrawPmsEx(i,t,s,e,h){var a=es.gi(),n=a._CHANNELCOLORS[e]+h.sMessage;Y.gi().Format(n,s-60,yh.WordSize(24));var o=Y.gi().iH+10,r=t-o;return gn.xani_frame.DrawAnima(i,r,"聊天频道框24_24",0),c.gi().DrawTextEx(i+12,r+12,a._CHANNELSHORT[e],a._CHANNELCOLORI[e],20,101,1,1,0,-2,-2),Y.gi().Draw(i+24+10,r),o}DrawMessage(i,t,s,e){var h,a;i+=10,t+=10,s-=20,e-=20,this.iMx=i,this.iMy=t,this.iMw=s,this.iMh=e;var n=t+e+this.iScrollY,o=es.gi();for(h=0;h<o.iMessageCount;h++)o.pms[h].ox=-1;for(c.gi().SetViewClip(i,t,i+s,t+e),h=0;h<o.iMessageCount;h++)if((1!=this.iChannelPoint||0==o.pms[h].channel)&&!(2==this.iChannelPoint&&1!=o.pms[h].channel||3==this.iChannelPoint&&2!=o.pms[h].channel||4==this.iChannelPoint&&3!=o.pms[h].channel||5==this.iChannelPoint&&4!=o.pms[h].channel&&50!=o.pms[h].channel||6==this.iChannelPoint&&5!=o.pms[h].channel||7==this.iChannelPoint&&6!=o.pms[h].channel&&7!=o.pms[h].channel)){if(0==o.pms[h].channel)a=0;else if(1==o.pms[h].channel)a=1;else if(2==o.pms[h].channel)a=2;else if(3==o.pms[h].channel)a=3;else if(4==o.pms[h].channel||50==o.pms[h].channel)a=4;else if(5==o.pms[h].channel)a=5;else if(6==o.pms[h].channel)a=6;else{if(7!=o.pms[h].channel)continue;a=7}if((n-=a<=5?this.DrawPms(i,n,s,a,o.pms[h])+5:this.DrawPmsEx(i,n,s,a,o.pms[h])+5)<=t)break}h<es.gi().iMessageCount?this.bCanScroll=!0:this.bCanScroll=!1,c.gi().NoClip()}Draw(){if(this.bShow){var i,t,s;if(this.InitButton(),this.bOpening)this.iX<0-this.iW/5?this.iX+=this.iW/5:(this.iX=fn.gi().iLHX,this.bOpening=!1);else if(this.bCloseing){if(!(this.iX>-this.iW))return this.iX=-this.iW,this.bCloseing=!1,void(this.bShow=!1);this.iX-=this.iW/5}for(this.btn_close.Move(this.iX+this.iW,this.iY+h.SCRH/2-53,45,106),this.btn_close.Draw(),E.frame_type4("中等框a52_50",this.iX,this.iY,this.iW,this.iH,52,50),t=this.iX+15,s=this.iY+15,this.btn_set.Move(t,s,64,65),this.btn_set.Draw(),t+=69,this.in_words.Move(t,s+9,235,47),E.frame_type1("输入框a20_47",this.in_words.iX,this.in_words.iY,this.in_words.iW,20),this.in_words.DrawText(),this.in_words.onscr(),t+=240,this.btn_face.Move(t,s,64,65),this.btn_face.Draw(),t+=69,this.btn_send.Move(t,s+2,90,60),this.btn_send.Draw(),t=this.iX+15,s+=69,i=0;i<8;i++)this.btn_channel[i].Move(t+2,s+60*i,60,60),this.btn_channel[i].Draw();var a=this.iH-15-15-64-5;for(E.frame_type4("聊天显示框暗20_20",t+64+5,s,400,a,20,20),this.DrawMessage(t+64+5,s,400,a),this.btn_opensend.Move(this.iX+15,this.iY+this.iH-15-65,64,65),this.btn_opensend.Draw(),this.btn_voice.Move(this.iX+15,this.iY+this.iH-15-65-5-65,64,65),this.btn_voice.Draw(),i=0;i<8;i++)this.iChannelPoint==i&&(this.btn_channel[i].bMouseIn=!0,this.btn_channel[i].bMouseDown=!0),this.btn_channel[i].Draw();switch(this.bSelectFace&&_t.gi().Draw(),this.iRecordStat){case 0:break;case 1:E.frame_type4("语音输入背景20_20",h.SCRW/2-120,h.SCRH/2-120,240,305,20,20),E.frame_type1("语音输入字底框20_35",h.SCRW/2-100,h.SCRH/2+100+20,200,20);var n=h.SCRW/2-100,o=h.SCRH/2+100+20;c.gi().FillRect_2D(n,o,n+200*(e.VOICETIMEOUT-this.iRecordDelay)/e.VOICETIMEOUT,o+35,822083583),1==this.iRecordingShow?(gn.xani_other.DrawAnima(h.SCRW/2-100,h.SCRH/2-100,"录音中",0),c.gi().DrawTextEx(h.SCRW/2,h.SCRH/2+100+20+17.5,"手指划开，取消录制",4294967295,18,101,1,1,0,-2,-2)):2==this.iRecordingShow&&(gn.xani_other.DrawAnima(h.SCRW/2-100,h.SCRH/2-100,"移开手指",0),c.gi().DrawTextEx(h.SCRW/2,h.SCRH/2+100+20+17.5,"手指划开，取消发送",4294967295,18,101,1,1,0,-2,-2));break;case 2:"empty"!=gn.m_vi.sRecordName&&(this.iRecordDelay=e.VOICETIMEOUT,gn.m_vi.UpLoad(),this.iRecordStat=3);break;case 3:"empty"!=gn.m_vi.sUrlName&&(this.iRecordDelay=e.VOICETIMEOUT,gn.m_vi.StartRecognize(),this.iRecordStat=4);break;case 4:if("empty"!=gn.m_vi.sRecognizeResult){if(gn.m_vi.iRecordTime<=1e3){L.easymsg.AddMessage("录音时间太短"),this.iRecordStat=0;break}$t.ClearCext(),$t.cext[3].type=2,$t.cext[3].eid=gn.m_vi.iRecordTime,$t.cext[3].name=gn.m_vi.sUrlName,$t.cext[3].detail=gn.m_vi.sRecognizeResult,this.iRecordStat=0,Mh.gi().s_PublicChat(this.iVoiceChannelPoint,e.EXTCOLOR+"[语音:"+$t.cext[3].detail+"]#o")}}this.iRecordStat>0&&(this.iRecordDelay--,this.iRecordDelay<=0&&(this.iRecordStat=0,gn.m_vi.StopRecord(),L.easymsg.AddMessage("录音超时取消")))}}ProcTouch(i,t,s){if(!this.bShow)return!1;var h,a;if(this.bSelectFace)return _t.gi().ProcTouch(i,t,s)&&0!=_t.gi().iSelectStat&&(1==_t.gi().iSelectStat&&(this.in_words.sDetail+="#f"+_t.gi().iSelectPoint),this.bSelectFace=!1),!0;if(this.btn_close.bMouseDown)return 2==i?(this.iX-=this.iLockX-t,this.iLockX=t,this.iX>0&&(this.iX=0)):3==i&&(Math.abs(this.iLockX_old-t)<10?this.bCloseing=!0:this.iX<-this.iW/2?this.bCloseing=!0:this.bOpening=!0,this.btn_close.bMouseDown=!1,this.btn_close.iAnimaStat=11),!0;if(this.btn_close.ProcTouch(i,t,s))return this.btn_close.bMouseDown&&(this.iLockX=t,this.iLockX_old=t),this.btn_close.bCheck()&&(this.bCloseing=!0),!0;if(this.btn_opensend.ProcTouch(i,t,s))return this.btn_opensend.bCheck()&&($t.Open(),$t.iChannelPoint=this.iChannelPoint-1),!0;for(h=0;h<8;h++)this.btn_channel[h].ProcTouch(i,t,s)&&this.btn_channel[h].bCheck()&&this.iChannelPoint!=h&&(this.iChannelPoint=h,this.iScrollY=0);if(bn.bInRect(t,s,this.btn_voice.iX,this.btn_voice.iY,this.btn_voice.iW,this.btn_voice.iH)){if(1==i){if(0==this.iChannelPoint)L.easymsg.AddMessage("不能在全部频道发言");else if(7==this.iChannelPoint)L.easymsg.AddMessage("不能在系统频道发言");else if(2==this.iChannelPoint&&H.bNoTeam())L.easymsg.AddMessage("还未组队");else if(3==this.iChannelPoint&&xh.me.rbs.iSchoolId<=0)L.easymsg.AddMessage("还未加入门派");else if(4==this.iChannelPoint&&Fi.mg.iRealGid<=0)L.easymsg.AddMessage("还未加入帮派");else if(0==this.iRecordStat){if(!gn.m_vi.StartRecord())return L.easymsg.AddMessage("启动录音失败"),!0;this.iRecordStat=1,this.iRecordDelay=e.VOICETIMEOUT,this.iVoiceChannelPoint=this.iChannelPoint-1}}else 3==i&&1==this.iRecordStat&&(gn.m_vi.StopRecord(),this.iRecordStat=2);return this.iRecordingShow=1,!0}if(1==this.iRecordStat)return 3==i&&(gn.m_vi.StopRecord(),this.iRecordStat=0),this.iRecordingShow=2,!0;if(this.iRecordingShow=0,3==i){var n=es.gi();for(h=0;h<n.iMessageCount;h++)if(-1!=n.pms[h].ox&&(bn.bInRect(t,s,n.pms[h].headx,n.pms[h].heady,52,52)&&n.pms[h].iRid>1e3&&Mh.gi().s_WatchOn(0,n.pms[h].iRid,0,""),bn.bInRect(t,s,n.pms[h].ox,n.pms[h].oy,n.pms[h].ow,n.pms[h].oh)))for(a=1;a<5;a++)if(!(n.pms[h].exts[a].type>=100)&&!(n.pms[h].exts[a].iShowDelay>0)&&n.pms[h].lrs_big[a].bIn(t-n.pms[h].ox,s-n.pms[h].oy))switch(n.pms[h].exts[a].type){case 0:Mh.gi().s_WatchOn(1,n.pms[h].exts[a].eid,0,""),n.pms[h].exts[a].iShowDelay=255;break;case 1:Mh.gi().s_WatchOn(2,n.pms[h].exts[a].eid,0,""),n.pms[h].exts[a].iShowDelay=255;break;case 2:gn.m_vi.PlayUrlVoice(n.pms[h].exts[a].name),n.pms[h].exts[a].iShowDelay=255;break;case 4:H.bInTeam()?L.easymsg.AddMessage("已有队伍"):Mh.gi().s_TeamOperate(3,n.pms[h].exts[a].eid,0),n.pms[h].exts[a].iShowDelay=255}}return this.btn_send.ProcTouch(i,t,s)&&this.btn_send.bCheck()&&(0==this.iChannelPoint?L.easymsg.AddMessage("不能在全部频道发言"):7==this.iChannelPoint?L.easymsg.AddMessage("不能在系统频道发言"):this.in_words.sDetail.length>100?(L.easymsg.AddMessage("文字太长"),this.in_words.sDetail=""):this.in_words.sDetail.length>0?($t.ClearCext(),Mh.gi().s_PublicChat(this.iChannelPoint-1,this.in_words.sDetail),this.in_words.sDetail=""):L.easymsg.AddMessage("请先输入文字")),this.btn_face.ProcTouch(i,t,s)?(this.btn_face.bCheck()&&(this.bSelectFace=!0,_t.gi().Init()),!0):!!this.in_words.ProcTouch(i,t,s)||(this.btn_set.ProcTouch(i,t,s)?(this.btn_set.bCheck()&&is.Open(),!0):(bn.bInRect(t,s,this.iMx,this.iMy,this.iMw,this.iMh)&&1==i&&(this.bScrolling=!0,this.iLockY=s),this.bScrolling&&(2==i&&(s>this.iLockY?this.bCanScroll&&(this.iScrollY+=s-this.iLockY):this.iScrollY+=s-this.iLockY,this.iScrollY<0&&(this.iScrollY=0),this.iLockY=s),3==i&&(this.bScrolling=!1)),!!bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)))}}ts.bg=null,ts.gi=function(){return null==ts.bg&&(ts.bg=new ts(null)),ts.bg},ts.Open=function(){var i=ts.gi();i.iW=500,i.iH=h.SCRH,i.iX=-i.iW,i.iY=0,i.bShow=!0,i.bOpening=!0,i.iScrollY=0,i.InitButton();for(var t=0;t<8;t++)i.btn_channel[t].SetNormal();i.bSelectFace=!1};class ss{constructor(){var i;for(this.sName="",this.sMessage="",this.exts=new Array(5),this.lrs_small=new Array(5),this.lrs_big=new Array(5),i=0;i<5;i++)this.exts[i]=new V,this.lrs_small[i]=new F,this.lrs_big[i]=new F}copyfrom(i){this.channel=i.channel,this.iRid=i.iRid,this.sName=i.sName,this.iRax=i.iRax,this.iFlag=i.iFlag,this.sMessage=i.sMessage,this.exts[0].copyfrom(i.exts[0]),this.exts[1].copyfrom(i.exts[1]),this.exts[2].copyfrom(i.exts[2]),this.exts[3].copyfrom(i.exts[3]),this.exts[4].copyfrom(i.exts[4])}}class es{constructor(){var i;for(this.pm3f=c.gi(),this.bMessageSwitch=new Array(10),i=0;i<10;i++)this.bMessageSwitch[i]=!0;for(es.iW=475,es.iH=160,es.iModifyW=es.iW,es.iModifyH=es.iH,this.bOpen=!0,this.bOpening=!1,this.bCloseing=!1,this.btn_open=null,this.btn_speak=null,this.btn_close=null,this.btn_full=null,this.btn_voice=null,this.pms=new Array(es.MAXMESSAGE),i=0;i<es.MAXMESSAGE;i++)this.pms[i]=new ss;this.iMessageCount=0,es.bLock=!1,this.sSpeakers=new Array(32),this.iSpeakerCount=-1,this.iSpeakerX=0,this.iSpeakerWidth=0,this.iRecordDelay=0,this.iRecordStat=0,this.iVoiceChannelPoint=0,this.iRecordingShow=0,this._CHANNELSHORT=["当","队","门","帮","世","传","系","副"],this._CHANNELCOLORS=["#cffffff","#cff8000","#cff0000","#c00ff00","#c00ffff","#c80a0ff","#cffff00","#cff00ff"],this._CHANNELCOLORI=[4294967295,4294934528,4294901760,4278255360,4278255615,4286619903,4294967040,4294902015]}AddSpeaker(i,t){-1==this.iSpeakerCount?(this.iSpeakerCount=1,this.sSpeakers[1]=i+":"+t,this.NextSpeaker()):this.iSpeakerCount<30&&(this.iSpeakerCount++,this.sSpeakers[this.iSpeakerCount]=i+":"+t)}DrawSpeaker(){this.iSpeakerCount<0||(this.iSpeakerX+this.iSpeakerWidth<0&&this.NextSpeaker(),this.iSpeakerX-=h.SCRW/100,this.pm3f.FillRect_2D(0,60,h.SCRW,90,2147483648),this.pm3f.DrawTextEx(this.iSpeakerX,75,this.sSpeakers[0],4294967295,30,101,1,1,0,0,-2))}NextSpeaker(){var i;for(i=0;i<this.iSpeakerCount;i++)this.sSpeakers[i]=this.sSpeakers[i+1];this.iSpeakerCount--,this.iSpeakerWidth=this.pm3f.GetTextWidth(this.sSpeakers[0],30),this.iSpeakerX=h.SCRW}DrawMessage(i,t){var s,a,n,o,r,l,b,_,f,u=h.SCRH-10,d="";for(o=i+36,r=t,l=es.iW-40,b=es.iH,s=0;s<this.iMessageCount;s++)this.pms[s].ox=-1;for(this.pm3f.SetViewClip(o-40+3,r+3,o+l-3,r+b-3),s=0;s<this.iMessageCount;s++)if((!(this.pms[s].channel<10)||this.bMessageSwitch[this.pms[s].channel])&&(0!=(1&ph.iFilterChannel)||0!=this.pms[s].channel)&&!(0==(2&ph.iFilterChannel)&&1==this.pms[s].channel||0==(4&ph.iFilterChannel)&&2==this.pms[s].channel||0==(8&ph.iFilterChannel)&&3==this.pms[s].channel||0==(16&ph.iFilterChannel)&&(4==this.pms[s].channel||50==this.pms[s].channel)||0==(32&ph.iFilterChannel)&&5==this.pms[s].channel||0==(64&ph.iFilterChannel)&&(6==this.pms[s].channel||7==this.pms[s].channel))){switch(this.pms[s].channel){case 0:case 1:case 2:case 3:case 4:case 50:d="["+this.pms[s].sName+"]:"+this.pms[s].sMessage;break;case 5:case 6:case 7:d=""==this.pms[s].sName?this.pms[s].sMessage:"["+this.pms[s].sName+"]:"+this.pms[s].sMessage}for(50==(a=this.pms[s].channel)&&(a=4),(a<0||a>7)&&(a=0),d=this._CHANNELCOLORS[a]+d,n=0;n<5;n++)switch(this.pms[s].exts[n].type){case 0:d=Y.gi().InsertLocker(n,d,"["+gn.de_goods.strValue(this.pms[s].exts[n].tid,0,4)+"]",e.EXTCOLOR,"#c00ff00");break;case 1:d=Y.gi().InsertLocker(n,d,"["+gn.de_pet.strValue(this.pms[s].exts[n].tid,0,1)+"]",e.EXTCOLOR,"#c00ff00");break;case 2:d=Y.gi().InsertLocker(n,d,"[语音:"+this.pms[s].exts[n].detail+"]",e.EXTCOLOR,"#c00ff00");break;case 3:d=Y.gi().InsertLocker(n,d,"["+this.pms[s].sName+"]",this._CHANNELCOLORS[a],this._CHANNELCOLORS[a]);break;case 4:d=Y.gi().InsertLocker(n,d,"[申请入队]",e.EXTCOLOR,"#c00ff00")}for(Y.gi().Format(d,l,yh.WordSize(24)),Y.gi().CheckOutRect(),_=o,f=u-Y.gi().iH,n=0;n<5;n++)switch(this.pms[s].exts[n].type){case 0:case 1:case 2:case 3:case 4:if(this.pms[s].lrs_small[n].CopyFrom(Y.gi().lrs[n]),this.pms[s].exts[n].iShowDelay>0){for(var p=0;p<this.pms[s].lrs_small[n].iCount;p++){var m=_+this.pms[s].lrs_small[n].rs[p].iX,g=f+this.pms[s].lrs_small[n].rs[p].iY,w=_+this.pms[s].lrs_small[n].rs[p].iX+this.pms[s].lrs_small[n].rs[p].iW,x=f+this.pms[s].lrs_small[n].rs[p].iY+this.pms[s].lrs_small[n].rs[p].iH;c.gi().FillRect_2D(m,g,w,x,16711935|this.pms[s].exts[n].iShowDelay<<24)}this.pms[s].exts[n].iShowDelay>200?this.pms[s].exts[n].iShowDelay-=3:this.pms[s].exts[n].iShowDelay>150?this.pms[s].exts[n].iShowDelay-=6:this.pms[s].exts[n].iShowDelay>100?this.pms[s].exts[n].iShowDelay-=9:this.pms[s].exts[n].iShowDelay>50?this.pms[s].exts[n].iShowDelay-=12:this.pms[s].exts[n].iShowDelay=0}}if(gn.xani_frame.DrawAnima(o-16-12,u-Y.gi().iH+Y.gi().iLineH[0]-24-1,"聊天频道框24_24",0),c.gi().DrawTextEx(o-16,u-Y.gi().iH+12+Y.gi().iLineH[0]-24-1,this._CHANNELSHORT[a],this._CHANNELCOLORI[a],20,101,1,1,0,-2,-2),Y.gi().Draw(o,u-Y.gi().iH),this.pms[s].ox=o,this.pms[s].oy=u-Y.gi().iH,this.pms[s].ow=Y.gi().iW,this.pms[s].oh=Y.gi().iH,(u-=Y.gi().iH)<=r)break}this.pm3f.NoClip()}LoadButtons(){if(null==this.btn_open&&(this.btn_open=new Eh(gn.xani_nui2),this.btn_open.InitButton("左下开关2")),null==this.btn_close&&(this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("左下开关1")),null==this.btn_speak&&(this.btn_speak=new Eh(gn.xani_nui2),this.btn_speak.InitButton("左下发言")),null==this.btn_full&&(this.btn_full=new Eh(gn.xani_nui2),this.btn_full.InitButton("左下展开")),null==this.btn_voice){this.btn_voice=new Array(10);for(var i=0;i<6;i++)this.btn_voice[i]=new Eh(gn.xani_button),this.btn_voice[i].InitButton("喇叭按钮60_60")}}Draw(){if(!Ih.gi().vbk.mapdialog.bHideUI()&&!xs.jq.bJQLock()){this.LoadButtons();var i=5;this.bOpening?(es.iModifyW+es.iW/i<es.iW?es.iModifyW+=es.iW/i:es.iModifyW=es.iW,es.iModifyH+es.iH/i<es.iH?es.iModifyH+=es.iH/i:es.iModifyH=es.iH,es.iModifyW==es.iW&&es.iModifyH==es.iH&&(this.bOpening=!1,this.bOpen=!0)):this.bCloseing&&(es.iModifyW>0?es.iModifyW-=es.iW/i:es.iModifyW=0,es.iModifyH>0?es.iModifyH-=es.iH/i:es.iModifyH=0,0==es.iModifyW&&0==es.iModifyH&&(this.bCloseing=!1,this.bOpen=!1));var t=h.SCRH-es.iModifyH;es.iModifyW>0&&es.iModifyH>0&&this.pm3f.FillRect_2D(0,t,0+es.iModifyW,t+es.iModifyH,2147483648),this.bOpen&&this.DrawMessage(0,t),this.btn_open.Move(0,h.SCRH-60,60,60),this.btn_open.SetCheckRect(0,h.SCRH-60,60,60),this.btn_close.Move(es.iModifyW-60,h.SCRH-(es.iModifyH+60)/2,60,60),this.btn_close.SetCheckRect(es.iModifyW-60,h.SCRH-(es.iModifyH+60)/2,60,60);var s=0;fn.gi().iLHX>0&&(s=fn.gi().iLHX);var a=h.SCRH-es.iModifyH-80;for(this.btn_speak.Move(s,a,72,72),this.btn_speak.SetCheckRect(s,a,72,72),s+=80,this.btn_full.Move(s,a,72,72),this.btn_full.SetCheckRect(s,a,72,72),s+=80,i=0;i<6;i++)0!=(ph.iFastVoice&1<<i)&&(this.btn_voice[i].Move(s,a,72,72),s+=80);if(this.bOpen||this.bOpening||this.bCloseing){for(gn.xani_frame.DrawAnima(this.btn_speak.iX,this.btn_speak.iY,"右下底框72_72",0),gn.xani_icon.DrawAnima(this.btn_speak.iX,this.btn_speak.iY,"公聊发送",0),gn.xani_frame.DrawAnima(this.btn_full.iX,this.btn_full.iY,"右下底框72_72",0),gn.xani_icon.DrawAnima(this.btn_full.iX,this.btn_full.iY,"公聊半屏",0),i=0;i<6;i++)0!=(ph.iFastVoice&1<<i)&&(gn.xani_frame.DrawAnima(this.btn_voice[i].iX,this.btn_voice[i].iY,"右下底框72_72",0),gn.xani_icon.DrawAnima(this.btn_voice[i].iX,this.btn_voice[i].iY,"公聊话筒",0),c.gi().DrawText_2(this.btn_voice[i].iX+72-10,this.btn_voice[i].iY+10,this._CHANNELSHORT[i],4294967295,30,101,1,1,0,-2,-2,4,4278199373));switch(this.iRecordStat){case 0:break;case 1:E.frame_type4("语音输入背景20_20",h.SCRW/2-120,h.SCRH/2-120,240,305,20,20),E.frame_type1("语音输入字底框20_35",h.SCRW/2-100,h.SCRH/2+100+20,200,20);var n=h.SCRW/2-100,o=h.SCRH/2+100+20;c.gi().FillRect_2D(n,o,n+200*(e.VOICETIMEOUT-this.iRecordDelay)/e.VOICETIMEOUT,o+35,822083583),1==this.iRecordingShow?(gn.xani_other.DrawAnima(h.SCRW/2-100,h.SCRH/2-100,"录音中",0),c.gi().DrawTextEx(h.SCRW/2,h.SCRH/2+100+20+17.5,"手指划开，取消录制",4294967295,18,101,1,1,0,-2,-2)):2==this.iRecordingShow&&(gn.xani_other.DrawAnima(h.SCRW/2-100,h.SCRH/2-100,"移开手指",0),c.gi().DrawTextEx(h.SCRW/2,h.SCRH/2+100+20+17.5,"手指划开，取消发送",4294967295,18,101,1,1,0,-2,-2));break;case 2:"empty"!=gn.m_vi.sRecordName&&(this.iRecordDelay=e.VOICETIMEOUT,gn.m_vi.UpLoad(),this.iRecordStat=3);break;case 3:"empty"!=gn.m_vi.sUrlName&&(this.iRecordDelay=e.VOICETIMEOUT,gn.m_vi.StartRecognize(),this.iRecordStat=4);break;case 4:if("empty"!=gn.m_vi.sRecognizeResult){if(gn.m_vi.iRecordTime<=1e3){L.easymsg.AddMessage("录音时间太短"),this.iRecordStat=0;break}$t.ClearCext(),$t.cext[3].type=2,$t.cext[3].eid=gn.m_vi.iRecordTime,$t.cext[3].name=gn.m_vi.sUrlName,$t.cext[3].detail=gn.m_vi.sRecognizeResult,this.iRecordStat=0,Mh.gi().s_PublicChat(this.iVoiceChannelPoint,e.EXTCOLOR+"[语音:"+$t.cext[3].detail+"]#o")}}this.btn_close.Move(es.iModifyW-60,h.SCRH-(es.iModifyH+60)/2,60,60)}this.iRecordStat>0&&(this.iRecordDelay--,this.iRecordDelay<=0&&(this.iRecordStat=0,gn.m_vi.StopRecord(),L.easymsg.AddMessage("录音超时取消"))),this.bOpening||this.bCloseing||(this.bOpen?this.btn_close.Draw():this.btn_open.Draw())}}SwichFrame(){this.bOpening?(this.bOpening=!1,this.bCloseing=!0):this.bCloseing?(this.bOpening=!0,this.bCloseing=!1):this.bOpen?(this.bOpening=!1,this.bCloseing=!0):this.bOpen||(this.bOpening=!0,this.bCloseing=!1)}ProcTouch(i,t,s){var a,n,o=h.SCRH-es.iModifyH;if(es.bLock){switch(i){case 2:es.iW=es.iW+(t-this.iLockX),es.iW<235&&(es.iW=235),es.iH=es.iH-(s-this.iLockY),es.iH<110&&(es.iH=110),t>this.iLockX&&es.iW>h.SCRW-40&&(es.iW=h.SCRW),es.iW>h.SCRW&&(es.iW=h.SCRW),s<this.iLockY&&es.iH>h.SCRH-40&&(es.iH=h.SCRH),es.iH>h.SCRH&&(es.iH=h.SCRH),this.iLockX=t,this.iLockY=s,es.iModifyW=es.iW,es.iModifyH=es.iH;break;case 3:es.bLock=!1}return!0}if(!this.bOpen&&this.btn_open.ProcTouch(i,t,s))return this.btn_open.bCheck()&&this.SwichFrame(),!0;if(this.bOpen&&this.btn_close.ProcTouch(i,t,s))return this.btn_close.bCheck()&&this.SwichFrame(),!0;if(this.bOpen){if(this.btn_speak.ProcTouch(i,t,s))return this.btn_speak.bCheck()&&$t.Open(),!0;if(this.btn_full.ProcTouch(i,t,s))return this.btn_full.bCheck()&&ts.Open(),!0;for(n=-1,a=0;a<6;a++)if(0!=(ph.iFastVoice&1<<a)&&bn.bInRect(t,s,this.btn_voice[a].iX,this.btn_voice[a].iY,this.btn_voice[a].iW,this.btn_voice[a].iH)){if(0==this.iRecordStat&&1==i){if(1==a&&H.bNoTeam())return L.easymsg.AddMessage("还未组队"),!0;if(2==a&&xh.me.rbs.iSchoolId<=0)return L.easymsg.AddMessage("还未加入门派"),!0;if(3==a&&Fi.mg.iRealGid<=0)return L.easymsg.AddMessage("还未加入帮派"),!0}if(this.iRecordStat>=2)return!0;if(n=a,1==i){if(0==this.iRecordStat){if(!gn.m_vi.StartRecord())return L.easymsg.AddMessage("启动录音失败"),!0;this.iRecordStat=1,this.iRecordDelay=e.VOICETIMEOUT,this.iVoiceChannelPoint=a}}else 3==i&&1==this.iRecordStat&&(n==this.iVoiceChannelPoint?(gn.m_vi.StopRecord(),this.iRecordStat=2):(gn.m_vi.StopRecord(),this.iRecordStat=0))}if(1==this.iRecordStat)return n==this.iVoiceChannelPoint?this.iRecordingShow=1:(3==i&&(gn.m_vi.StopRecord(),this.iRecordStat=0),this.iRecordingShow=2),!0;if(this.iRecordingShow=0,3==i)for(a=0;a<this.iMessageCount;a++)if(-1!=this.pms[a].ox&&bn.bInRect(t,s,this.pms[a].ox,this.pms[a].oy,this.pms[a].ow,this.pms[a].oh))for(n=0;n<5;n++)if(gn.sop(""+this.pms[a].exts[n].type),!(this.pms[a].exts[n].type>=100)&&!(this.pms[a].exts[n].iShowDelay>0)&&this.pms[a].lrs_small[n].bIn(t-this.pms[a].ox,s-this.pms[a].oy))switch(this.pms[a].exts[n].type){case 0:Mh.gi().s_WatchOn(1,this.pms[a].exts[n].eid,0,""),this.pms[a].exts[n].iShowDelay=255;break;case 1:Mh.gi().s_WatchOn(2,this.pms[a].exts[n].eid,0,""),this.pms[a].exts[n].iShowDelay=255;break;case 2:gn.m_vi.PlayUrlVoice(this.pms[a].exts[n].name),this.pms[a].exts[n].iShowDelay=255;break;case 3:this.pms[a].exts[n].eid>1e3&&Mh.gi().s_WatchOn(0,this.pms[a].exts[n].eid,0,""),this.pms[a].exts[n].iShowDelay=255;break;case 4:H.bInTeam()?L.easymsg.AddMessage("已有队伍"):Mh.gi().s_TeamOperate(3,this.pms[a].exts[n].eid,0),this.pms[a].exts[n].iShowDelay=255}}return bn.bInRect(t,s,0+es.iW-60,o,60,60)&&1==i?(es.bLock=!0,this.iLockX=t,this.iLockY=s,!0):(es.bLock=!1,!!bn.bInRect(t,s,0,o,es.iModifyW,es.iModifyH))}GetMessage(i){var t=i.GetNextByte(),s=i.GetNextInt(),e=i.GetNextString(),h=i.GetNextByte(),a=i.GetNextByte(),n=i.GetNextString();if(50==t&&this.AddSpeaker(e,n),this.AddMessage(t,s,e,h,a,n,i),0==t||1==t)if(s==xh.me.iRid)xh.me.sPopoString=n,xh.me.iPopoDelay=200;else{var o=rh.gameing.findnrs(s);null!=o&&(o.sPopoString=n,o.iPopoDelay=200)}}AddMessage(i,t,s,e,h,a,n){var o;for(this.iMessageCount>=es.MAXMESSAGE&&(this.iMessageCount=es.MAXMESSAGE-1),o=this.iMessageCount;o>0;o--)this.pms[o].copyfrom(this.pms[o-1]);for(this.pms[0].channel=i,this.pms[0].iRid=t,this.pms[0].sName=s,this.pms[0].iRax=e,this.pms[0].iFlag=h,this.pms[0].sMessage=a,5==i&&t<1e3&&(this.pms[0].iRax=6,this.pms[0].sName="某某"),i<5?(this.pms[0].exts[0].type=3,this.pms[0].exts[0].eid=t):this.pms[0].exts[0].type=100,o=1;o<5&&null!=n;o++)if(n.iOffset>=n.iLength)this.pms[0].exts[o].type=100;else switch(this.pms[0].exts[o].type=n.GetNextByte(),this.pms[0].exts[o].type){case 0:case 1:case 4:this.pms[0].exts[o].eid=n.GetNextInt(),this.pms[0].exts[o].tid=n.GetNextShort();break;case 2:this.pms[0].exts[o].eid=n.GetNextInt(),this.pms[0].exts[o].name=n.GetNextString(),this.pms[0].exts[o].detail=n.GetNextString(),0!=(1&ph.iAutoPlay)&&0==i?gn.m_vi.PlayUrlVoice(this.pms[0].exts[o].name):0!=(2&ph.iAutoPlay)&&1==i?gn.m_vi.PlayUrlVoice(this.pms[0].exts[o].name):0!=(4&ph.iAutoPlay)&&2==i?gn.m_vi.PlayUrlVoice(this.pms[0].exts[o].name):0!=(8&ph.iAutoPlay)&&3==i?gn.m_vi.PlayUrlVoice(this.pms[0].exts[o].name):0==(16&ph.iAutoPlay)||4!=i&&50!=i?0!=(32&ph.iAutoPlay)&&5==i&&gn.m_vi.PlayUrlVoice(this.pms[0].exts[o].name):gn.m_vi.PlayUrlVoice(this.pms[0].exts[o].name)}this.iMessageCount++}}es.iW,es.iH,es.iModifyW,es.iModifyH,es.bLock,es.MAXMESSAGE=100,es.chat=null,es.gi=function(){return null==es.chat&&(es.chat=new es),es.chat},es.CHANNEL_DANGQIAN=0,es.CHANNEL_DUIWU=1,es.CHANNEL_MENPAI=2,es.CHANNEL_BANGPAI=3,es.CHANNEL_SHIJIE=4,es.CHANNEL_CHUANWEN=5,es.CHANNEL_XITONG=6,es.CHANNEL_FUBEN=7;class hs{constructor(){var i,t;for(this.iWeapTid=-1,this.aa_body=new l,this.aa_weapon=new l,this.iStatus=new Int32Array(hs.iMaxStatusCount),this.aa_status=new Array(hs.iMaxStatusCount),i=0;i<hs.iMaxStatusCount;i++)this.aa_status[i]=null;for(this.ianPoint=0,this.bActed=!0,this.an_list=new Array(this.MAXLIST),this.aa_cls=new Array(6),this.iColor=new Int32Array(6),i=0;i<6;i++){for(this.aa_cls[i]=new Array(5),t=0;t<5;t++)this.aa_cls[i][t]=new l;this.iColor[i]=0}this.rotajd=0}FaceTo(i){i?this.iPos<20?(this.sFaceTo="_左上",this.sSkillFaceTo="_左"):(this.sFaceTo="_右下",this.sSkillFaceTo="_右"):this.iPos<20?(this.sFaceTo="_右下",this.sSkillFaceTo="_右"):(this.sFaceTo="_左上",this.sSkillFaceTo="_左")}Clear(){var i;for(i=0;i<hs.iMaxStatusCount;i++)this.iStatus[i]=0,this.aa_status[i]=null;this.bUseing=!1,this.iMaxHp=1,this.iWeapTid=-1,this.nr=null,this.bMe=!1,this.iActDelay=0,this.iFlying=0,this.ianPoint=0,this.bActed=!1,this.iPopoDelay=0,this.iRace_Sex=-1,this.iShowSNDelay=0}ChangeStatus(i,t){i>=0&&i<hs.iMaxStatusCount&&(this.iStatus[i]=t)}ActionStatus(){var i;for(i=0;i<hs.iMaxStatusCount;i++)this.iStatus[i]>0&&this.iStatus[i]--}AddAnima(i){this.bUseing&&(1==this.iType&&0!=parseInt(this.iTid/1e4)?this.an_list[this.ianPoint]="变异_"+i:2==this.iType&&2==this.iSpecialType&&0!=parseInt(this.iTid/1e4)?this.an_list[this.ianPoint]="变异_"+i:this.an_list[this.ianPoint]=i,this.ianPoint++)}PopAnima(){if(0!=this.ianPoint){this.ianPoint--;for(var i=0;i<this.ianPoint;i++)this.an_list[i]=this.an_list[i+1]}}SetBaseAnima(i){1==this.iType&&0!=parseInt(this.iTid/1e4)?this.an_base="变异_"+i:2==this.iType&&2==this.iSpecialType&&0!=parseInt(this.iTid/1e4)?this.an_base="变异_"+i:this.an_base=i,this.bBaseWaiting&&this.ChangeAnima(this.an_base)}ChangeAnima(i){if(0==this.iType||2==this.iType&&1==this.iSpecialType)return bn.sop(""+this.iRace_Sex),gn.xani_newrole[this.iRace_Sex].InitAnimaWithName(i+this.sFaceTo,this.aa_body),this.ChangeColor(this.iRace_Sex,i+this.sFaceTo,0),void(this.iWeapTid>0&&gn.xani_weap[this.iRace_Sex][N.WeapFlag(this.iWeapTid)].InitAnimaWithName(i+this.sFaceTo,this.aa_weapon));this.xani.InitAnimaWithName(i+this.sFaceTo,this.aa_body)}NextAnima(){this.ianPoint>0?(this.ChangeAnima(this.an_list[0]),this.PopAnima(),this.bBaseWaiting=!1):(this.ChangeAnima(this.an_base),this.bBaseWaiting=!0)}NextFrame(){this.bBaseWaiting&&this.ianPoint>0?this.NextAnima():this.aa_body.NextFrame()?this.NextAnima():this.iWeapTid>0&&(this.aa_weapon.iFrame=this.aa_body.iFrame)}InitSN(i){this.sShowSNDetail=gn.de_skill.strValue(i,0,6),"-1"!=this.sShowSNDetail&&(this.iShowSNDelay=100)}ShowSN(){this.iShowSNDelay}FightPopo(i,t,s){if(!(this.iPopoDelay<=0)){this.iPopoDelay--,Y.gi().Format(this.sPopoString,151,25),i-=Y.gi().iW/2;var e=t+s+40-Y.gi().iH;M.gi().FillRect(t,i,e,i+Y.gi().iW,e+Y.gi().iH,1342177280),Y.gi().DrawToBuffer(t+1,i,e)}}ChangeColor(i,t,s){var e;if(yh.bShowColor)for(e=0;e<N._CHANGECOLOR[i].length;e++)this.iColor[e]<=0||this.iColor[e]>=6||(gn.xani_color[i][this.iColor[e]-1].InitAnimaWithName(N._CHANGECOLOR[i][e]+"_"+t,this.aa_cls[s][e]),gn.sop(N._CHANGECOLOR[i][e]+"_"+t))}DrawColor(i,t,s,e,h,a){var n;if(yh.bShowColor)for(n=0;n<N._CHANGECOLOR[i].length;n++)this.iColor[n]<=0||this.iColor[n]>=6||(this.aa_cls[a][n].iFrame=t,M.gi().DrawAnimaEx(s,e,h,this.aa_cls[a][n],this.iStatus[38]>0?50:101,1,1,0,0,0))}frame_type1(i,t,s,e,h){gn.xani_frame.InitAnimaWithName(i,gn.aaa),e<2*h?(gn.aaa.iFrame=0,M.gi().DrawAnimaEx(this.iY+5,t,s,gn.aaa,101,1*e/2/h,1,0,0,0),gn.aaa.iFrame=2,M.gi().DrawAnimaEx(this.iY+5,t+e/2,s,gn.aaa,101,1*e/2/h,1,0,0,0)):(gn.aaa.iFrame=1,M.gi().DrawAnimaEx(this.iY+5,t+h/2,s,gn.aaa,101,1*(e-h)/h,1,0,0,0),gn.aaa.iFrame=0,M.gi().DrawAnimaEx(this.iY+5,t,s,gn.aaa,101,1,1,0,0,0),gn.aaa.iFrame=2,M.gi().DrawAnimaEx(this.iY+5,t+e-h,s,gn.aaa,101,1,1,0,0,0))}Draw(){var i,t,s,e,a,n;if(5!=this.iPos&&25!=this.iPos){s=72*this.iHp/this.iMaxHp,115,(this.iPos<20||this.iStatus[16]>0)&&(gn.xani_frame.InitAnimaWithName("血条外框76_13",gn.aaa),M.gi().DrawAnima_aa(this.iY+4,null,this.iX-38,this.iY-115-10,gn.aaa),this.frame_type1("血条10_9",this.iX-38+2,this.iY-115-10+2,s,10),this.bActed||M.gi().DrawAnima_aa(this.iY+5,null,this.iX,this.iY-115-15,gn.aa_fightready)),this.iShowSNDelay>0&&(this.iShowSNDelay-=5,gn.xani_skills[0].InitAnimaWithName("技能名称背景",gn.aaa),i=this.iShowSNDelay>75?30-(this.iShowSNDelay-75):30,t=this.iShowSNDelay<25?4*this.iShowSNDelay:101,M.gi().DrawAnimaEx(this.iY+5,this.iX-60,this.iY-115-20,gn.aaa,t,1*i/30,1*i/30,0,0,0),t=this.iShowSNDelay<25?10*this.iShowSNDelay:255,M.gi().DrawText(this.iY+6,0,this.iX-60,this.iY-115-20-i,this.sShowSNDetail,t<<24|16777215,i));G.DrawAura(0,this.iX,this.iY,M.gi(),this.iY-2),this.bActed?(M.gi().DrawText_2(this.iY+1,1,this.iX,this.iY+20,this.sName,4286644096,20,1,4278190080),M.gi().DrawText(this.iY+h.SCRH,1,this.iX,this.iY+20,this.sName,1619066752,20)):(M.gi().DrawText_2(this.iY+1,1,this.iX,this.iY+20,this.sName,4294934528,20,1,4278190080),M.gi().DrawText(this.iY+h.SCRH,1,this.iX,this.iY+20,this.sName,1627369600,20)),this.iFlying>10&&(this.iFlying%2==0?(this.FaceTo(!0),this.SetBaseAnima("被攻击")):(this.FaceTo(!1),this.SetBaseAnima("被攻击"))),i=0,s=0,this.iStatus[18]>0&&(i=bn.GetRand(-2,2),s=bn.GetRand(-2,2)),M.gi().DrawAnimaEx(this.iY,this.iX+i,this.iY+s,this.aa_body,this.iStatus[38]>0?50:101,1,1,0,0,0),(0==this.iType||2==this.iType&&1==this.iSpecialType)&&(this.DrawColor(this.iRace_Sex,this.aa_body.iFrame,this.iY+1,this.iX+i,this.iY+s,0),this.iWeapTid>0&&M.gi().DrawAnima_aa(this.iY+2,this.xani,this.iX+i,this.iY+s,this.aa_weapon)),this.bActed?this.NextFrame():this.iActDelay%2==0&&this.NextFrame(),this.iActDelay++,this.bMe?xh.me.DrawPopo(this.iX,this.iY+10):null!=this.nr&&(this.nr.sName==this.sName?this.nr.DrawPopo(this.iX,this.iY+10):this.nr=null),this.FightPopo(this.iX,this.iY+10,this.xani.iAnimaY(this.aa_body)-30)}for(this.rotajd+=.1,i=0;i<hs.iMaxStatusCount;i++)if(this.iStatus[i]>0)switch(i){case 0:case 1:case 2:case 3:case 4:null==this.aa_status[i]&&(this.aa_status[i]=gn.xani_ui.InitAnimaWithName("祝福标记"+this.sSkillFaceTo,null)),this.aa_status[i].iFrame=i,this.iPos<20?M.gi().DrawAnima_aa(this.iY+1,this.xani,this.iX+30,this.iY-90,this.aa_status[i]):M.gi().DrawAnima_aa(this.iY+1,this.xani,this.iX-30,this.iY-90,this.aa_status[i]);break;case 5:null==this.aa_status[i]&&(this.aa_status[i]=gn.xani_skills[4].InitAnimaWithName("狂暴_持续",null)),M.gi().DrawAnima_aa(this.iY+1,this.xani,this.iX,this.iY,this.aa_status[i]),this.aa_status[i].NextFrame();break;case 6:null==this.aa_status[i]&&(this.aa_status[i]=gn.xani_skills[4].InitAnimaWithName("定心诀_持续",null)),M.gi().DrawAnima_aa(this.iY+1,this.xani,this.iX,this.iY,this.aa_status[i]),this.aa_status[i].NextFrame();break;case 7:null==this.aa_status[i]&&(this.aa_status[i]=gn.xani_skills[4].InitAnimaWithName("魔甲术"+this.sSkillFaceTo,null)),"_左"==this.sSkillFaceTo?M.gi().DrawAnima_aa(this.iY-3,this.xani,this.iX,this.iY,this.aa_status[i]):M.gi().DrawAnima_aa(this.iY+3,this.xani,this.iX,this.iY,this.aa_status[i]),this.aa_status[i].NextFrame();break;case 8:null==this.aa_status[i]&&(this.aa_status[i]=gn.xani_skills[4].InitAnimaWithName("壁垒_持续",null)),M.gi().DrawAnimaEx(this.iY+1,this.iX,this.iY,this.aa_status[i],101,2,2,0,-2,-2),this.aa_status[i].NextFrame();break;case 10:case 11:case 12:case 13:case 14:case 15:null==this.aa_status[i]&&(this.aa_status[i]=gn.xani_ui.InitAnimaWithName("诅咒标记"+this.sSkillFaceTo,null)),this.aa_status[i].iFrame=i-10,this.iPos<20?M.gi().DrawAnima_aa(this.iY+1,this.xani,this.iX+30,this.iY-90,this.aa_status[i]):M.gi().DrawAnima_aa(this.iY+1,this.xani,this.iX-30,this.iY-90,this.aa_status[i]);break;case 20:null==this.aa_status[i]&&(this.aa_status[i]=gn.xani_skills[2].InitAnimaWithName("陷阱_持续",null)),M.gi().DrawAnimaEx(this.iY-2,this.iX,this.iY,this.aa_status[i],101,2,2,0,-2,-2),this.aa_status[i].NextFrame();break;case 21:null==this.aa_status[i]&&(this.aa_status[i]=gn.xani_skills[5].InitAnimaWithName("火牢_持续",null)),M.gi().DrawAnimaEx(this.iY-2,this.iX,this.iY,this.aa_status[i],101,1,1,0,0,0),this.aa_status[i].NextFrame();break;case 22:null==this.aa_status[i]&&(this.aa_status[i]=gn.xani_skills[6].InitAnimaWithName("飞箝术_持续",null)),M.gi().DrawAnima_aa(this.iY-1,this.xani,this.iX,this.iY,this.aa_status[i]),this.aa_status[i].NextFrame();break;case 23:null==this.aa_status[i]&&(this.aa_status[i]=gn.xani_skills[8].InitAnimaWithName("仙绫缚_持续",null)),M.gi().DrawAnima_aa(this.iY-1,this.xani,this.iX,this.iY,this.aa_status[i]),this.aa_status[i].NextFrame();break;case 24:null==this.aa_status[i]&&(this.aa_status[i]=gn.xani_skill.InitAnimaWithName("眩晕"+this.sSkillFaceTo,null)),M.gi().DrawAnima_aa(this.iY+1,this.xani,this.iX,this.iY,this.aa_status[i]),this.aa_status[i].NextFrame();break;case 25:null==this.aa_status[i]&&(this.aa_status[i]=gn.xani_skills[11].InitAnimaWithName("流沙_持续",null)),M.gi().DrawAnimaEx(this.iY+1,this.iX,this.iY,this.aa_status[i],101,2,2,0,-2,-2),this.aa_status[i].NextFrame();break;case 27:null==this.aa_status[i]&&(this.aa_status[i]=gn.xani_skills[11].InitAnimaWithName("巫毒_持续",null)),M.gi().DrawAnimaEx(this.iY+1,this.iX,this.iY,this.aa_status[i],101,2,2,0,-2,-2),this.aa_status[i].NextFrame();break;case 28:null==this.aa_status[i]&&(this.aa_status[i]=gn.xani_skills[12].InitAnimaWithName("心如止水"+this.sSkillFaceTo,null)),M.gi().DrawAnima_aa(this.iY+1,this.xani,this.iX,this.iY,this.aa_status[i]),this.aa_status[i].NextFrame();break;case 29:null==this.aa_status[i]&&(this.aa_status[i]=gn.xani_skills[12].InitAnimaWithName("幽冥鬼眼"+this.sSkillFaceTo,null)),M.gi().DrawAnima_aa(this.iY+1,this.xani,this.iX,this.iY,this.aa_status[i]),this.aa_status[i].NextFrame();break;case 30:null==this.aa_status[i]&&(this.aa_status[i]=gn.xani_skills[5].InitAnimaWithName("火甲术"+this.sSkillFaceTo,null)),"_左"==this.sSkillFaceTo?M.gi().DrawAnimaEx(this.iY-3,this.iX,this.iY,this.aa_status[i],101,1,1,0,0,0):M.gi().DrawAnimaEx(this.iY+3,this.iX,this.iY,this.aa_status[i],101,1,1,0,0,0),this.aa_status[i].NextFrame();break;case 31:null==this.aa_status[i]&&(this.aa_status[i]=gn.xani_skills[5].InitAnimaWithName("火灵诀_持续",null)),M.gi().DrawAnimaEx(this.iY+2,this.iX,this.iY,this.aa_status[i],101,1,1,0,0,0),this.aa_status[i].NextFrame();break;case 32:null==this.aa_status[i]&&(this.aa_status[i]=gn.xani_skills[6].InitAnimaWithName("凝神诀"+this.sSkillFaceTo,null)),M.gi().DrawAnima_aa(this.iY+1,this.xani,this.iX,this.iY,this.aa_status[i]),this.aa_status[i].NextFrame();break;case 34:null==this.aa_status[i]&&(this.aa_status[i]=gn.xani_skills[9].InitAnimaWithName("五行甲"+this.sSkillFaceTo,null)),M.gi().DrawAnima_aa(this.iY+1,this.xani,this.iX,this.iY,this.aa_status[i]),this.aa_status[i].NextFrame();break;case 35:null==this.aa_status[i]&&(this.aa_status[i]=gn.xani_skills[8].InitAnimaWithName("定天弓"+this.sSkillFaceTo,null)),"_左"==this.sSkillFaceTo?M.gi().DrawAnima_aa(this.iY-2,this.xani,this.iX,this.iY,this.aa_status[i]):M.gi().DrawAnima_aa(this.iY+2,this.xani,this.iX,this.iY,this.aa_status[i]),this.aa_status[i].NextFrame();break;case 36:null==this.aa_status[i]&&(this.aa_status[i]=gn.xani_skills[8].InitAnimaWithName("灵动九天_持续"+this.sSkillFaceTo,null)),"_左"==this.sSkillFaceTo?M.gi().DrawAnima_aa(this.iY+3,this.xani,this.iX,this.iY,this.aa_status[i]):M.gi().DrawAnima_aa(this.iY-3,this.xani,this.iX,this.iY,this.aa_status[i]),this.aa_status[i].NextFrame();break;case 37:null==this.aa_status[i]&&(this.aa_status[i]=gn.xani_skills[1].InitAnimaWithName("凝神聚气_持续",null)),a=60*Math.cos(this.rotajd),n=30*Math.sin(this.rotajd),M.gi().DrawAnima_aa(this.iY+n,this.xani,this.iX+a,this.iY+n,this.aa_status[i]),a=60*Math.cos(this.rotajd+2*bn.PI/3),n=30*Math.sin(this.rotajd+2*bn.PI/3),M.gi().DrawAnima_aa(this.iY+n,this.xani,this.iX+a,this.iY+n,this.aa_status[i]),a=60*Math.cos(this.rotajd+4*bn.PI/3),n=30*Math.sin(this.rotajd+4*bn.PI/3),M.gi().DrawAnima_aa(this.iY+n,this.xani,this.iX+a,this.iY+n,this.aa_status[i]),this.aa_status[i].NextFrame();break;case 39:null==this.aa_status[i]&&(this.aa_status[i]=gn.xani_skills[12].InitAnimaWithName("天魔甲"+this.sSkillFaceTo,null)),M.gi().DrawAnima_aa(this.iY+1,this.xani,this.iX,this.iY,this.aa_status[i]),this.aa_status[i].NextFrame();break;case 40:for(null==this.aa_status[i]&&(this.aa_status[i]=gn.xani_skills[2].InitAnimaWithName("迷雾_左",null)),t=e=5==this.iPos?0:2;t<e+2;t++)for(s=0;s<5;s++)M.gi().DrawAnimaEx(h.SCRH,ws.gi().fat[t][s].iOx,ws.gi().fat[t][s].iOy-100,this.aa_status[i],101,3,3,0,-2,-2);this.aa_status[i].NextFrame();break;case 41:null==this.aa_status[i]&&(this.aa_status[i]=gn.xani_skills[2].InitAnimaWithName("兵诡_左",null)),e=5==this.iPos?0:2,t=(ws.gi().fat[e][0].iOx+ws.gi().fat[e][1].iOx+ws.gi().fat[e+1][0].iOx+ws.gi().fat[e+1][1].iOx)/4,s=(ws.gi().fat[e][0].iOy+ws.gi().fat[e][1].iOy+ws.gi().fat[e+1][0].iOy+ws.gi().fat[e+1][1].iOy)/4,M.gi().DrawAnimaEx(s,t,s,this.aa_status[i],101,2,2,0,-2,-2),t=(ws.gi().fat[e][0].iOx+ws.gi().fat[e][2].iOx+ws.gi().fat[e+1][0].iOx+ws.gi().fat[e+1][2].iOx)/4,s=(ws.gi().fat[e][0].iOy+ws.gi().fat[e][2].iOy+ws.gi().fat[e+1][0].iOy+ws.gi().fat[e+1][2].iOy)/4,M.gi().DrawAnimaEx(s,t,s,this.aa_status[i],101,2,2,0,-2,-2),this.aa_status[i].NextFrame();break;case 42:null==this.aa_status[i]&&(this.aa_status[i]=gn.xani_skills[9].InitAnimaWithName("天阵"+this.sSkillFaceTo,null)),M.gi().DrawAnimaEx(1,this.iX,this.iY,this.aa_status[i],101,2,2,0,-2,-2),this.aa_status[i].NextFrame();break;case 43:null==this.aa_status[i]&&(this.aa_status[i]=gn.xani_skills[9].InitAnimaWithName("地阵"+this.sSkillFaceTo,null)),M.gi().DrawAnimaEx(1,this.iX,this.iY,this.aa_status[i],101,2,2,0,-2,-2),this.aa_status[i].NextFrame();break;case 44:null==this.aa_status[i]&&(this.aa_status[i]=gn.xani_skills[12].InitAnimaWithName("神灵护佑"+this.sSkillFaceTo,null)),M.gi().DrawAnimaEx(0,this.iX,this.iY,this.aa_status[i],101,2,2,0,-2,-2),this.aa_status[i].NextFrame();break;case 18:break;case 19:null==this.aa_status[i]&&(this.aa_status[i]=gn.xani_skills[2].InitAnimaWithName("奇谋_持续",null)),M.gi().DrawAnimaEx(this.iY+1,this.iX,this.iY,this.aa_status[i],101,2,2,0,-2,-2),this.aa_status[i].NextFrame();break;case 17:null==this.aa_status[i]&&(this.aa_status[i]=gn.xani_skills[11].InitAnimaWithName("撕裂"+this.sSkillFaceTo,null)),M.gi().DrawAnima_aa(this.iY+1,this.xani,this.iX,this.iY,this.aa_status[i]),this.aa_status[i].NextFrame();break;case 33:null==this.aa_status[i]&&(this.aa_status[i]=gn.xani_skills[7].InitAnimaWithName("灵智术"+this.sSkillFaceTo,null)),M.gi().DrawAnima_aa(this.iY+1,this.xani,this.iX,this.iY,this.aa_status[i]),this.aa_status[i].NextFrame();break;case 50:null==this.aa_status[i]&&(this.aa_status[i]=gn.xani_skills[7].InitAnimaWithName("仙甲术"+this.sSkillFaceTo,null)),"_左"==this.sSkillFaceTo?M.gi().DrawAnima_aa(this.iY-3,this.xani,this.iX,this.iY,this.aa_status[i]):M.gi().DrawAnima_aa(this.iY+3,this.xani,this.iX,this.iY,this.aa_status[i]),this.aa_status[i].NextFrame();break;case 100:case 101:case 102:case 103:case 104:null==this.aa_status[i]&&(this.aa_status[i]=gn.xani_skills[0].InitAnimaWithName("五行灵体"+(i-100),null)),M.gi().DrawAnimaEx(this.iY+1,this.iX,this.iY,this.aa_status[i],101,2,2,0,-2,-2),this.aa_status[i].NextFrame()}}}hs.iMaxStatusCount=200;class as extends s{constructor(i){var t;for(super(),this.pani=i,this.pm3f=i.pm3f,this.iW=900,this.iH=620,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.iMainSkillId=new Int32Array(as.MAXSKILLCOUNT),this.btn_main=new Array(as.MAXSKILLCOUNT),t=0;t<as.MAXSKILLCOUNT;t++)this.btn_main[t]=new D(gn.xani_ui),this.btn_main[t].bSingleButton=!0;for(this.iUseSkillId=new Int32Array(as.MAXSKILLCOUNT),this.btn_use=new Array(as.MAXSKILLCOUNT),t=0;t<as.MAXSKILLCOUNT;t++)this.btn_use[t]=new D(gn.xani_ui),this.btn_use[t].bSingleButton=!0;this.iMainPoint=-1,this.iUsePoint=-1,this.InitSkill(),this.btn_learn=new Eh(gn.xani_nui2),this.btn_learn.InitButton("按钮1_110"),this.btn_learn.Move(this.iX+this.iW-155,this.iY+this.iH-100,110,52),this.btn_learn.sName="学  习"}InitSkill(){var i,t,s;for(s=1,i=0;i<gn.de_skill.iDataCount;i++)0==(t=gn.de_skill.intValue(gn.de_skill.datas[i].iDid,-1,1))?(t=gn.de_skill.intValue(gn.de_skill.datas[i].iDid,-1,2))==xh.me.rbs.iSchoolId&&(this.iMainSkillId[0]=gn.de_skill.datas[i].iDid):1==t&&(t=gn.de_skill.intValue(gn.de_skill.datas[i].iDid,-1,2))==xh.me.rbs.iSchoolId&&(this.iMainSkillId[s]=gn.de_skill.datas[i].iDid,s++)}Draw(){var i,t,s,h,a,n,o,r,l;for(E.new_bigframe(this.iX,this.iY,this.iW,this.iH),E.new_framein(this.iX+25,this.iY+25,270,570),i=0;i<as.MAXSKILLCOUNT;i++)h=this.iX+25+20,a=this.iY+25+20+90*i,this.btn_main[i].Move(h,a,230,80),this.iMainPoint==i?gn.xani_nui2.DrawAnima(h,a,"选择主技能",1):gn.xani_nui2.DrawAnima(h,a,"选择主技能",0),gn.xani_nicon.DrawAnima_aa(h,a,gn.de_skill.strValue(e.iSchoolSkillId[xh.me.rbs.iSchoolId][i],0,5),0),this.pm3f.DrawTextEx(h+95,a+25,gn.de_skill.strValue(e.iSchoolSkillId[xh.me.rbs.iSchoolId][i],-1,6),4294967295,25,101,1,1,0,0,-2),this.pm3f.DrawTextEx(h+95,a+60,xh.me.rbs.iSchoolSkill[i]+"级",4294967295,20,101,1,1,0,0,-2);if(r=this.iX+25+270+15+15,l=this.iY+25+270+7+15,gn.xani_nui2.DrawAnima(r,l,"技能说明框",0),h=this.iX+25+270+15,a=this.iY+25,E.new_framein(h,a,565,570),c.gi().FillRect_2D(h+15,a+15,h+550,l-15,4284784296),this.iUseSkillCount=0,this.iMainPoint>=0){for(n=e.iSchoolSkillId[xh.me.rbs.iSchoolId][this.iMainPoint],o=xh.me.rbs.iSchoolSkill[this.iMainPoint],-1==this.iUsePoint&&(c.gi().DrawText_2(r+5,l+18,gn.de_skill.strValue(n,0,6),4282245605,28,101,1,1,0,0,-2,4,4278206039),1==(s=gn.de_skill.intValue(n,0,7))?c.gi().DrawTextEx(r+120,l+18,"战斗中使用",4282245605,24,101,1,1,0,0,-2):0==s?c.gi().DrawTextEx(r+120,l+18,"漫游中使用",4282245605,24,101,1,1,0,0,-2):3==s&&c.gi().DrawTextEx(r+120,l+18,"被动技能",4282245605,24,101,1,1,0,0,-2),Y.gi().Format(gn.de_skill.strValue(n,0,3),514,20),Y.gi().Draw(r+5,l+38)),i=0;i<5&&-1!=(t=gn.de_skill.intValue(n,i,4));i++)this.iUseSkillId[i]=t,h=this.iX+25+270+15+15+7,a=this.iY+25+15+7+84*i,this.iUsePoint==i?(gn.xani_nui2.DrawAnima(h,a,"选择子技能",0),c.gi().DrawText_2(r+5,l+18,gn.de_skill.strValue(t,0,6),4282245605,28,101,1,1,0,0,-2,4,4278206039),1==(s=gn.de_skill.intValue(t,0,7))?c.gi().DrawTextEx(r+120,l+18,"战斗中使用",4282245605,24,101,1,1,0,0,-2):0==s?c.gi().DrawTextEx(r+120,l+18,"漫游中使用",4282245605,24,101,1,1,0,0,-2):3==s&&c.gi().DrawTextEx(r+120,l+18,"被动技能",4282245605,24,101,1,1,0,0,-2),Y.gi().Format(gn.de_skill.strValue(t,0,3),514,20),Y.gi().Draw(r+5,l+38)):gn.xani_nui2.DrawAnima(h,a,"选择子技能",1),this.btn_use[i].Move(h,a,520,84),gn.xani_nicon.DrawAnima_aa(h+2,a+2,gn.de_skill.strValue(t,0,5),0),this.pm3f.DrawTextEx(h+95,a+25,gn.de_skill.strValue(t,-1,6),4294967295,25,101,1,1,0,0,-2),s=gn.de_skill.intValue(t,-1,9),this.pm3f.DrawTextEx(h+95,a+60,"要求"+gn.de_skill.strValue(gn.de_skill.intValue(t,-1,8),-1,6)+">="+s+"级",o>=s?4278255360:4294901760,20,101,1,1,0,0,-2);this.iUseSkillCount=i,h=this.iX+25+270+15+15,a=this.iY+25+270+7+110+7+18,gn.xani_nui2.DrawAnima(h,a,"提示1",2),c.gi().DrawTextEx(h+55,a+16,"当前经验",4294967295,24,101,1,1,0,-2,-2),gn.xani_nui2.DrawAnima(h+110,a,"提示2",0),c.gi().DrawTextEx(h+110+60,a+16,""+xh.me.rbs.iExp,4294967295,24,101,1,1,0,-2,-2),a+=40,gn.xani_nui2.DrawAnima(h,a,"提示1",2),c.gi().DrawTextEx(h+55,a+16,"当前铜币",4294967295,24,101,1,1,0,-2,-2),gn.xani_nui2.DrawAnima(h+110,a,"提示2",0),c.gi().DrawTextEx(h+110+60,a+16,""+xh.me.rbs.iMoney,4294967295,24,101,1,1,0,-2,-2),a+=40,gn.xani_nui2.DrawAnima(h,a,"提示1",2),c.gi().DrawTextEx(h+55,a+16,"绑铜",4294967295,24,101,1,1,0,-2,-2),gn.xani_nui2.DrawAnima(h+110,a,"提示2",0),c.gi().DrawTextEx(h+110+60,a+16,""+xh.me.rbs.iReserve,4294967295,24,101,1,1,0,-2,-2),h=this.iX+25+270+15+15+304,a=this.iY+25+270+7+110+7+18,gn.xani_nui2.DrawAnima(h,a,"提示1",2),c.gi().DrawTextEx(h+55,a+16,"所需经验",4294967295,24,101,1,1,0,-2,-2),gn.xani_nui2.DrawAnima(h+110,a,"提示2",0),c.gi().DrawTextEx(h+110+60,a+16,""+parseInt(e.iUpgradeExp[o]/6),4294967295,24,101,1,1,0,-2,-2),a+=40,gn.xani_nui2.DrawAnima(h,a,"提示1",2),c.gi().DrawTextEx(h+55,a+16,"所需铜币",4294967295,24,101,1,1,0,-2,-2),gn.xani_nui2.DrawAnima(h+110,a,"提示2",0),c.gi().DrawTextEx(h+110+60,a+16,""+parseInt(e.iUpgradeMoney[o]/18),4294967295,24,101,1,1,0,-2,-2),this.btn_learn.Draw()}this.btn_close.Draw()}ProcTouch(i,t,s){if(this.btn_close.ProcTouch(i,t,s))return this.btn_close.bCheck()&&ln.gi().PopStat(1),!0;var h;for(h=0;h<6;h++)this.btn_main[h].ProcTouch(i,t,s)&&this.btn_main[h].bMouseDown&&(this.iMainPoint=h,this.iUsePoint=-1);for(h=0;h<this.iUseSkillCount;h++)this.btn_use[h].ProcTouch(i,t,s)&&this.btn_use[h].bMouseDown&&(this.iUsePoint=h);return this.iMainPoint>=0&&this.btn_learn.ProcTouch(i,t,s)&&this.btn_learn.bCheck()&&(xh.me.rbs.iSchoolSkill[this.iMainPoint]>=xh.me.rbs.iLev+10?L.easymsg.AddMessage("不能超过人物等级10级"):this.iMainPoint>0&&xh.me.rbs.iSchoolSkill[this.iMainPoint]>=xh.me.rbs.iSchoolSkill[0]?L.easymsg.AddMessage("不能超过主技能等级"):parseInt(e.iUpgradeExp[xh.me.rbs.iSchoolSkill[this.iMainPoint]]/6)>xh.me.rbs.iExp?L.easymsg.AddMessage("当前经验不足"):parseInt(e.iUpgradeMoney[xh.me.rbs.iSchoolSkill[this.iMainPoint]]/18)>xh.me.rbs.iMoney+xh.me.rbs.iReserve?L.easymsg.AddMessage("当前铜币不足"):(Mh.gi().s_learnschoolskill(e.iSchoolSkillId[xh.me.rbs.iSchoolId][this.iMainPoint],this.iMainPoint),xh.me.rbs.iExp-=parseInt(e.iUpgradeExp[xh.me.rbs.iSchoolSkill[this.iMainPoint]]/6),xh.me.rbs.iReserve>=parseInt(e.iUpgradeExp[xh.me.rbs.iSchoolSkill[this.iMainPoint]]/18)?xh.me.rbs.iReserve-=parseInt(e.iUpgradeExp[xh.me.rbs.iSchoolSkill[this.iMainPoint]]/18):(h=parseInt(e.iUpgradeExp[xh.me.rbs.iSchoolSkill[this.iMainPoint]]/18)-xh.me.rbs.iReserve,xh.me.rbs.iReserve=0,xh.me.rbs.iMoney-=h),xh.me.rbs.iSchoolSkill[this.iMainPoint]++)),3!=i||bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||ln.gi().PopStat(1),!1}}as.MAXSKILLCOUNT=6;class ns{constructor(){this.MAXSKILLCOUNT=10,this.iFightSkillId=new Int32Array(this.MAXSKILLCOUNT),this.btn_skills=new Array(this.MAXSKILLCOUNT),this.iW=510,this.iH=345,this.iX=h.SCRW-this.iW-20,this.iY=h.SCRH-this.iH-20}InitFightSkill(){var i,t,s,a,n,o;for(this.iW=530,this.iH=330,this.iX=h.SCRW-this.iW-20,this.iY=h.SCRH-this.iH-20,this.btn_skills[0]=null,i=0;i<this.MAXSKILLCOUNT;i++)this.iFightSkillId[i]=-1;if(this.iFightSkillCount=0,xh.me.rbs.iLev<30&&(this.iFightSkillId[this.iFightSkillCount++]=1201,this.iShowPoint=-1),0!=xh.me.rbs.iSchoolId){for(i=0;i<as.MAXSKILLCOUNT;i++)for(t=e.iSchoolSkillId[xh.me.rbs.iSchoolId][i],s=0;s<10&&!((a=gn.de_skill.intValue(t,s,4))<=0);s++)n=gn.de_skill.intValue(a,0,9),o=gn.de_skill.intValue(a,0,7),xh.me.rbs.iSchoolSkill[i]>=n&&(a+=1e3),0!=o&&(this.iFightSkillId[this.iFightSkillCount++]=a);i=xh.me.iFlag[33]%10,ws.gi().iFightType==ws.FIGHTWITH_DARK&&i>0&&(this.iFightSkillId[this.iFightSkillCount++]=1203),this.iShowPoint=-1}}DrawFightSkill(){var i,t;if(this.iW=530,this.iH=330,this.iX=h.SCRW-this.iW-20,this.iY=h.SCRH-this.iH-20,this.iFightSkillCount>0&&null==this.btn_skills[0])for(i=0;i<this.iFightSkillCount;i++)this.btn_skills[i]=new Eh(gn.xani_nicon),this.btn_skills[i].InitButton(gn.de_skill.strValue(this.iFightSkillId[i]%1e3,0,5)),this.btn_skills[i].Move(this.iX+30+i%4*130,this.iY+30+150*parseInt(i/4),80,80);E.new_framepc(this.iX,this.iY,this.iW,this.iH);var s=-1;for(i=0;i<this.iFightSkillCount;i++)gn.xani_nicon.DrawAnimaEx(this.btn_skills[i].iX-80*(this.btn_skills[i].fScale-1)/2,this.btn_skills[i].iY-80*(this.btn_skills[i].fScale-1)/2,"技能外框",0,101,this.btn_skills[i].fScale,this.btn_skills[i].fScale,0,0,0),this.btn_skills[i].Draw(),this.btn_skills[i].bMouseDown&&(s=i),t=this.iFightSkillId[i]>1e3?4294897374:4294901760,c.gi().DrawTextEx(this.btn_skills[i].iX+40,this.btn_skills[i].iY+80+15,gn.de_skill.strValue(this.iFightSkillId[i]%1e3,0,6),t,25,101,1,1,0,-2,0);s>=0&&Yi.Skill_Detail(this.iFightSkillId[s]%1e3,this.btn_skills[s].iX,this.btn_skills[s].iY,-1)}ProcTouch(i,t,s){var e;for(e=0;e<this.iFightSkillCount;e++)if(this.btn_skills[e].ProcTouch(i,t,s)&&this.btn_skills[e].bCheck()){if(this.iShowPoint=e,!(this.iFightSkillId[e]<=1e3))return this.iUseSkillId=this.iFightSkillId[e]%1e3,this.iSelectTarget=gn.de_skill.intValue(this.iUseSkillId,0,23),this.btn_skills[e].SetNormal(),!0;L.easymsg.AddMessage("技能等级不足无法使用")}return 3==i&&!bn.bInRect(t,s,this.iX-20,this.iY-20,this.iW+40,this.iH+40)&&(this.iUseSkillId=-1,!0)}}ns.xfs=new ns;class os{constructor(){this.MAXSKILLCOUNT=10,this.iGoodsSkillId=new Int32Array(this.MAXSKILLCOUNT),this.btn_skills=new Array(this.MAXSKILLCOUNT)}InitSpecialSkill(){var i,t;for(i=0;i<this.MAXSKILLCOUNT;i++)this.iGoodsSkillId[i]=-1,this.btn_skills[i]=new Eh(gn.xani_ngoods);for(this.iSkillCount=0,i=0;i<6;i++)ht.gi().goods[1][i].iGid<=0||(t=1023&ht.gi().goods[1][i].iAtts[4])<=0||(this.btn_skills[this.iSkillCount].InitButton(gn.de_goods.strValue(ht.gi().goods[1][i].iTid,-1,10)),this.iGoodsSkillId[this.iSkillCount++]=t);this.iShowPoint=-1,this.iW=400,this.iSkillCount>2?this.iH=330:this.iH=180,this.iX=h.SCRW-this.iW-20,this.iY=h.SCRH-this.iH-20}DrawSpecialSkill(){var i,t,s;for(this.iW=400,this.iSkillCount>2?this.iH=330:this.iH=180,this.iX=h.SCRW-this.iW-20,this.iY=h.SCRH-this.iH-20,E.new_framepc(this.iX,this.iY,this.iW,this.iH),i=0;i<this.iSkillCount;i++)this.btn_skills[i].Move(this.iX+30+i%3*130,this.iY+30+i/3*150,80,80),gn.xani_nicon.DrawAnimaEx(this.btn_skills[i].iX-80*(this.btn_skills[i].fScale-1)/2,this.btn_skills[i].iY-80*(this.btn_skills[i].fScale-1)/2,"技能外框",0,101,this.btn_skills[i].fScale,this.btn_skills[i].fScale,0,0,0),this.btn_skills[i].Draw(),t=gn.de_skill.intValue(this.iGoodsSkillId[i],0,35),ht.gi().goods[1][4].iGid>0&&267==(ht.gi().goods[1][4].iAtts[4]>>10&1023)&&(t=8*t/10),s=t<=xh.me.rbs.iAnger?4294897374:4294901760,c.gi().DrawTextEx(this.btn_skills[i].iX+40,this.btn_skills[i].iY+80+15,gn.de_skill.strValue(this.iGoodsSkillId[i],0,6),s,22,101,1,1,0,-2,0),c.gi().DrawTextEx(this.btn_skills[i].iX+40,this.btn_skills[i].iY+80+15+24,"SP:"+t+"/"+xh.me.rbs.iAnger,s,20,101,1,1,0,-2,0);this.iShowPoint>=0&&this.iShowPoint<this.iSkillCount&&Yi.Skill_Detail(this.iGoodsSkillId[this.iShowPoint],this.iX,this.iY+60*this.iShowPoint+30,-1)}ProcTouch(i,t,s){var e,h;for(e=0;e<this.iSkillCount;e++)if(this.btn_skills[e].ProcTouch(i,t,s)&&this.btn_skills[e].bCheck())return this.btn_skills[e].SetNormal(),this.iShowPoint=e,h=gn.de_skill.intValue(this.iGoodsSkillId[e],0,35),ht.gi().goods[1][4].iGid>0&&267==(ht.gi().goods[1][4].iAtts[4]>>10&1023)&&(h=8*h/10),h>xh.me.rbs.iAnger?(L.easymsg.AddMessage("怒气不足，可能使用失败"),this.iUseSkillId=this.iGoodsSkillId[e],this.iSelectTarget=gn.de_skill.intValue(this.iUseSkillId,0,36),!0):(this.iUseSkillId=this.iGoodsSkillId[e],this.iSelectTarget=gn.de_skill.intValue(this.iUseSkillId,0,36),!0);return 3==i&&!bn.bInRect(t,s,this.iX-20,this.iY-20,this.iW+40,this.iH+40)&&(this.iUseSkillId=-1,!0)}}os.xss=new os;class rs{constructor(){this.bUseing=!1,this.aa=new l,this.aa1=new l}}class cs{constructor(){var i;for(this.list_middle=new Array(cs.MAXEFFECT),i=0;i<cs.MAXEFFECT;i++)this.list_middle[i]=new rs}AddDarts(i,t,s,e,h,a){var n;for(n=0;n<cs.MAXEFFECT;n++)if(!this.list_middle[n].bUseing){switch(this.list_middle[n].bUseing=!0,this.list_middle[n].iX=i,this.list_middle[n].iY=t-60,this.list_middle[n].iRate=10,this.list_middle[n].iSkillId=h,this.list_middle[n].iType=1,this.list_middle[n].iTFrame=a,this.list_middle[n].iTX=s,this.list_middle[n].iTY=e-60,this.list_middle[n].iRa=bn.GetAngleXY(i,t,s,e),this.list_middle[n].iRa<0&&(this.list_middle[n].iRa+=360),h){case 0:gn.xani_skills[0].InitAnimaWithName("飞刀",this.list_middle[n].aa);break;case 1:case 2:case 3:case 4:case 5:gn.xani_skills[0].InitAnimaWithName("五行攻击"+h,this.list_middle[n].aa);break;case 6:gn.xani_skills[8].InitAnimaWithName("穿云箭",this.list_middle[n].aa);break;default:gn.xani_skills[0].InitAnimaWithName("飞刀",this.list_middle[n].aa)}break}}AddEffect(i,t,s,e){var h;if(!(s>=cs.EFFECTNAME.length))for(h=0;h<cs.MAXEFFECT;h++)if(!this.list_middle[h].bUseing){switch(this.list_middle[h].bUseing=!0,this.list_middle[h].iX=i,this.list_middle[h].iY=t,this.list_middle[h].iRate=10,this.list_middle[h].iSkillId=s,this.list_middle[h].iType=0,s){case 9:case 11:break;case 54:case 61:case 62:gn.xani_skills[0].InitAnimaWithName(cs.EFFECTNAME[s],this.list_middle[h].aa);break;case 0:case 1:case 2:case 57:case 3:case 4:case 5:gn.xani_skills[1].InitAnimaWithName(cs.EFFECTNAME[s]+(e?"_右":"_左"),this.list_middle[h].aa),this.list_middle[h].iRate=20;break;case 6:case 8:case 10:gn.xani_skills[2].InitAnimaWithName(cs.EFFECTNAME[s]+(e?"_右":"_左"),this.list_middle[h].aa),this.list_middle[h].iRate=20;break;case 7:gn.xani_skills[2].InitAnimaWithName(cs.EFFECTNAME[s]+(e?"1_右":"1_左"),this.list_middle[h].aa),gn.xani_skills[2].InitAnimaWithName(cs.EFFECTNAME[s]+(e?"2_右":"2_左"),this.list_middle[h].aa1),this.list_middle[h].iRate=20;break;case 12:case 15:case 16:case 17:gn.xani_skills[3].InitAnimaWithName(cs.EFFECTNAME[s]+(e?"_右":"_左"),this.list_middle[h].aa),this.list_middle[h].iRate=20;break;case 13:case 14:gn.xani_skills[3].InitAnimaWithName(cs.EFFECTNAME[s]+(e?"1_右":"1_左"),this.list_middle[h].aa),gn.xani_skills[3].InitAnimaWithName(cs.EFFECTNAME[s]+(e?"2_右":"2_左"),this.list_middle[h].aa1),this.list_middle[h].iRate=20;break;case 18:case 19:case 20:case 21:case 23:gn.xani_skills[4].InitAnimaWithName(cs.EFFECTNAME[s]+(e?"_右":"_左"),this.list_middle[h].aa),this.list_middle[h].iRate=20;break;case 24:gn.xani_skills[5].InitAnimaWithName(cs.EFFECTNAME[s]+(e?"1_右":"1_左"),this.list_middle[h].aa),gn.xani_skills[5].InitAnimaWithName(cs.EFFECTNAME[s]+(e?"2_右":"2_左"),this.list_middle[h].aa1),this.list_middle[h].iRate=20;break;case 25:case 26:case 27:case 28:case 29:gn.xani_skills[5].InitAnimaWithName(cs.EFFECTNAME[s]+(e?"_右":"_左"),this.list_middle[h].aa),this.list_middle[h].iRate=20,28==s&&(this.list_middle[h].iRate=10);break;case 30:case 32:case 33:case 34:case 35:gn.xani_skills[6].InitAnimaWithName(cs.EFFECTNAME[s]+(e?"_右":"_左"),this.list_middle[h].aa),this.list_middle[h].iRate=20;break;case 60:gn.xani_skills[7].InitAnimaWithName(cs.EFFECTNAME[s]+(e?"_右":"_左"),this.list_middle[h].aa),this.list_middle[h].iRate=30;break;case 36:case 40:case 41:gn.xani_skills[7].InitAnimaWithName(cs.EFFECTNAME[s]+(e?"_右":"_左"),this.list_middle[h].aa),this.list_middle[h].iRate=20;break;case 37:case 38:case 39:gn.xani_skills[7].InitAnimaWithName(cs.EFFECTNAME[s]+(e?"_右":"_左"),this.list_middle[h].aa);break;case 42:case 43:break;case 44:case 46:case 47:gn.xani_skills[9].InitAnimaWithName(cs.EFFECTNAME[s]+(e?"_右":"_左"),this.list_middle[h].aa),this.list_middle[h].iRate=20;break;case 48:case 50:case 51:case 52:case 53:gn.xani_skills[8].InitAnimaWithName(cs.EFFECTNAME[s]+(e?"_右":"_左"),this.list_middle[h].aa),this.list_middle[h].iRate=20;break;case 56:case 63:case 64:case 65:case 66:case 67:case 68:case 69:gn.xani_skills[11].InitAnimaWithName(cs.EFFECTNAME[s]+(e?"_右":"_左"),this.list_middle[h].aa),this.list_middle[h].iRate=20;break;case 58:case 59:gn.xani_skills[0].InitAnimaWithName(cs.EFFECTNAME[s],this.list_middle[h].aa),this.list_middle[h].iRate=20;break;default:gn.xani_skill.InitAnimaWithName(cs.EFFECTNAME[s]+(e?"_右":"_左"),this.list_middle[h].aa)}break}}AddEffect2(i,t,s,e,h){var a;for(a=0;a<cs.MAXEFFECT;a++)if(!this.list_middle[a].bUseing){this.list_middle[a].bUseing=!0,this.list_middle[a].iX=i,this.list_middle[a].iY=t,this.list_middle[a].iRate=s%100,gn.xani_skills[parseInt(s/100)].InitAnimaWithName(e+(h?"_右":"_左"),this.list_middle[a].aa),this.list_middle[a].iSkillId=-1,this.list_middle[a].iType=0;break}}DrawGround(){var i;for(i=0;i<cs.MAXEFFECT;i++)if(this.list_middle[i].bUseing){if(1==this.list_middle[i].iType){M.gi().DrawAnimaEx(h.SCRH,this.list_middle[i].iX,this.list_middle[i].iY,this.list_middle[i].aa,101,.1*this.list_middle[i].iRate,.1*this.list_middle[i].iRate,this.list_middle[i].iRa,-2,-2),this.list_middle[i].iX=this.list_middle[i].iTX+(this.list_middle[i].iX-this.list_middle[i].iTX)*this.list_middle[i].iTFrame/(this.list_middle[i].iTFrame+1),this.list_middle[i].iY=this.list_middle[i].iTY+(this.list_middle[i].iY-this.list_middle[i].iTY)*this.list_middle[i].iTFrame/(this.list_middle[i].iTFrame+1),this.list_middle[i].iTFrame<=0?this.list_middle[i].bUseing=!1:this.list_middle[i].iTFrame--,this.list_middle[i].aa.NextFrame();continue}7==this.list_middle[i].iSkillId||13==this.list_middle[i].iSkillId||14==this.list_middle[i].iSkillId||24==this.list_middle[i].iSkillId?(M.gi().DrawAnimaEx(this.list_middle[i].iY-1,this.list_middle[i].iX,this.list_middle[i].iY,this.list_middle[i].aa,101,.1*this.list_middle[i].iRate,.1*this.list_middle[i].iRate,0,-2,-2),M.gi().DrawAnimaEx(h.SCRH,this.list_middle[i].iX,this.list_middle[i].iY,this.list_middle[i].aa1,101,.1*this.list_middle[i].iRate,.1*this.list_middle[i].iRate,0,-2,-2),this.list_middle[i].aa1.NextFrame()):M.gi().DrawAnimaEx(h.SCRH,this.list_middle[i].iX,this.list_middle[i].iY,this.list_middle[i].aa,101,.1*this.list_middle[i].iRate,.1*this.list_middle[i].iRate,0,-2,-2),this.list_middle[i].aa.NextFrame()&&(this.list_middle[i].bUseing=!1)}}DrawMiddle(){}DrawSky(){}}cs.EFFECTNAME=["浩然剑气","无双剑法","幻影剑法1","凝神聚气","虎啸","先发制人","陷阱","烈焰阵","轮轴术","迷雾","奇谋","兵诡","推功过血","起死回生","练气化神","气功","知己知彼","针灸","狂暴前奏","连环刀","乱舞","定心诀","魔甲术","壁垒","火流星","毒火术","火牢","炎爆术","火甲术","火灵诀","飞箝术","凝神诀","鬼谷刀法","散势法","清心咒","鬼符","呼风","唤雨","天雷封魔","仙甲术","天神助威","灵智术前奏","天阵","地阵","五行击","五行甲","孤虚法","归元法","穿云箭爆","定天弓","驱魔符","天地同寿","灵动九天","仙绫缚","普通攻击","暴击","生死决","幻影剑法2","出场烟雾","五行攻击爆炸","唤雨新","加血效果","加蓝效果","奋力一击","烈火","水箭","风刃","流沙","巫毒","招魂"],cs.MAXEFFECT=64,cs.fe=new cs;class ls{NumberEffectOle(){bUseing=!1}}class bs{constructor(){var i;for(this.MAXNUMBEREFFECT=20,this.neo=new Array(this.MAXNUMBEREFFECT),i=0;i<this.MAXNUMBEREFFECT;i++)this.neo[i]=new ls;this.nlist=new Int8Array(8)}AddEffect(i,t,s){var e;if(0!=s)for(e=0;e<this.MAXNUMBEREFFECT;e++)if(!this.neo[e].bUseing)return s>0?(this.neo[e].iNumber=s,this.neo[e].iType=0):(this.neo[e].iNumber=-s,this.neo[e].iType=1),this.neo[e].iX=i,this.neo[e].iY=t,this.neo[e].iProc=0,void(this.neo[e].bUseing=!0)}DrawNeo11(i){var t,s;null==this.aa_add&&(this.aa_add=gn.xani_ui.InitAnimaWithName("加血数字",null),this.aa_sub=gn.xani_ui.InitAnimaWithName("减血数字",null));var e=0;for(t=i.iNumber;t>0;)this.nlist[e++]=t%10,t/=10;0==e&&(this.nlist[0]=0,e=1);var h;for(s=i.iProc,t=e-1;t>=0;t--)h=s>=0&&s<3?5*-s:s>=3&&s<6?5*-(6-s):0,s-=2,0==i.iType?(this.aa_add.iFrame=this.nlist[t],this.aa_add.Draw(i.iX+12*(e-1)/2-12*t,i.iY+h)):(this.aa_sub.iFrame=this.nlist[t],this.aa_sub.Draw(i.iX+12*(e-1)/2-12*t,i.iY+h));i.iProc++,i.iProc>=6*e+5&&(i.bUseing=!1)}DrawNeo(i){var t,s;null==this.aa_add&&(this.aa_add=gn.xani_ui4.InitAnimaWithName("加血数字",null),this.aa_sub=gn.xani_ui4.InitAnimaWithName("掉血数字",null));var e=0;for(t=i.iNumber;t>0;)this.nlist[e++]=t%10,t=parseInt(t/10);0==e&&(this.nlist[0]=0,e=1);var h;for(s=i.iProc,t=e-1;t>=0;t--)h=s>=0&&s<3?10*-s:s>=3&&s<6?10*-(6-s):0,s-=2,0==i.iType?(this.aa_add.iFrame=this.nlist[t],this.aa_add.Draw(i.iX+20*(e-1)/2-20*t,i.iY+h)):(this.aa_sub.iFrame=this.nlist[t],this.aa_sub.Draw(i.iX+20*(e-1)/2-20*t,i.iY+h));i.iProc++,i.iProc>=6*e+6&&(i.bUseing=!1)}Draw(){var i;for(i=0;i<this.MAXNUMBEREFFECT;i++)this.neo[i].bUseing&&this.DrawNeo(this.neo[i])}Draw_TimeNumber(i,t,s){s<10?gn.xani_nui4.DrawAnimaEx(i,t,"倒计时数字",s,101,1,1,0,0,0):s<100&&(gn.xani_nui4.DrawAnimaEx(i-25,t,"倒计时数字",s/10,101,1,1,0,0,0),gn.xani_nui4.DrawAnimaEx(i+25,t,"倒计时数字",s%10,101,1,1,0,0,0))}Draw_RoundNumber(i,t,s){s<10?gn.xani_nui4.DrawAnimaEx(i,t,"回合数字",s,101,1,1,0,0,0):s<100?(gn.xani_nui4.DrawAnimaEx(i-15,t,"回合数字",s/10,101,1,1,0,0,0),gn.xani_nui4.DrawAnimaEx(i+15,t,"回合数字",s%10,101,1,1,0,0,0)):s<1e3&&(gn.xani_nui4.DrawAnimaEx(i-30,t,"回合数字",s/100,101,1,1,0,0,0),gn.xani_nui4.DrawAnimaEx(i,t,"回合数字",s/10%10,101,1,1,0,0,0),gn.xani_nui4.DrawAnimaEx(i+30,t,"回合数字",s%10,101,1,1,0,0,0))}}bs.ne=new bs;class _s{constructor(){this.iAutoFightLast=0,this.iW=83,this.iH=83,this.wsize=22}Draw(){this.iAutoFightLast<=0||(null==this.btn_cancel&&(this.btn_cancel=new Eh(gn.xani_nui4),this.btn_cancel.InitButton("战斗_自动")),this.iX=h.SCRW-80,this.iY=h.SCRH-80-10,this.btn_cancel.Move(this.iX,this.iY,this.iW,this.iH),this.btn_cancel.Draw(),xh.me.iFlag[20]>0?(this.iAutoFightLast=_s.AUTOLAST,c.gi().DrawText_2(this.btn_cancel.iX+40,this.btn_cancel.iY+80,"无限",4294967295,this.wsize,101,1,1,0,-2,-3,3,4278190080)):c.gi().DrawText_2(this.btn_cancel.iX+40,this.btn_cancel.iY+80,""+this.iAutoFightLast,4294967295,this.wsize,101,1,1,0,-2,-3,3,4278190080))}ProcTouch(i,t,s){return!(this.iAutoFightLast<=0)&&(null!=this.btn_cancel&&this.btn_cancel.ProcTouch(i,t,s)?(this.btn_cancel.bCheck()&&(this.iAutoFightLast=0),!0):!!bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH))}}_s.AUTOLAST=100,_s.aff=new _s;class fs extends s{constructor(i){var t;for(super(),this.btn_ids=new Int32Array(15),this.btn_open=new Array(4),t=0;t<4;t++)this.btn_open[t]=new Eh(gn.xani_nui4);this.InitButton()}InitButton(){var i,t=0;if(this.iBtnCount=0,this.btn_ids[t++]=0,this.btn_ids[t++]=1,xh.me.rbs.iLev<20){if(this.btn_ids[t++]=2,xh.me.rbs.nut>0&&(this.btn_ids[t++]=3),xh.me.iFightPid<=0)this.btn_ids[t++]=4;else{var s=Bi.mp.FindPet(xh.me.iFightPid);null==s?this.btn_ids[t++]=4:s.nut>0&&(this.btn_ids[t++]=4)}this.btn_ids[t++]=5}else xh.me.rbs.iLev<30?(Fi.mg.iRealGid>0&&(this.btn_ids[t++]=6,this.btn_ids[t++]=7),this.btn_ids[t++]=8,this.btn_ids[t++]=9):(Ht.mm.iMountsCount>0&&(this.btn_ids[t++]=10),Fi.mg.iRealGid>0&&(this.btn_ids[t++]=11,this.btn_ids[t++]=12),this.btn_ids[t++]=13,this.btn_ids[t++]=14);for(t>4&&(t=4),i=0;i<t;i++)this.btn_open[i].InitButton("提示"+fs._PROMPTS[this.btn_ids[i]][1]),this.btn_open[i].Move(h.SCRW/2-85-170-40+170*i,340,80,80),this.btn_open[i].sAnimaName=fs._PROMPTS[this.btn_ids[i]][1];this.iBtnCount=t}Draw(){var i;if(c.gi().FillRect_2D(0,0,h.SCRW,h.SCRH,2147483648),gn.xani_nui4.DrawAnima(h.SCRW/2,280,"死亡提示框",0),fs.iLostExp>0||fs.iLostMoney>0){var t="死亡损失";fs.iLostExp>0&&(t+=fs.iLostExp+"经验，"),fs.iLostMoney>0&&(t+=fs.iLostMoney+"金钱"),c.gi().DrawTextEx(h.SCRW/2,300,t,4288207341,20,101,1,1,0,-2,0)}else c.gi().DrawTextEx(h.SCRW/2,300,fs.sDetail,4288207341,20,101,1,1,0,-2,0);for(i=0;i<this.iBtnCount;i++)this.btn_open[i].Draw(),c.gi().DrawText_2(this.btn_open[i].iX+40,this.btn_open[i].iY+80,this.btn_open[i].sAnimaName,4294967295,26,101,1,1,0,-2,-2,3,4278190080),c.gi().DrawTextEx(this.btn_open[i].iX+40,this.btn_open[i].iY+80+22,fs._PROMPTS[this.btn_ids[i]][2],4288332473,15,101,1,1,0,-2,-2);c.gi().DrawTextEx(h.SCRW/2,460,"胜败乃江湖常事，少侠请提升实力再战",4294967295,20,101,1,1,0,-2,0),c.gi().DrawTextEx(h.SCRW/2,538,"点击空白处消失",4288332473,20,101,1,1,0,-2,-2)}ProcTouch(i,t,s){var e;for(e=0;e<this.iBtnCount;e++)if(this.btn_open[e].ProcTouch(i,t,s)&&this.btn_open[e].bCheck())switch(this.btn_ids[e]){case 0:Mh.gi().s_PromptActivity(0,0),ln.gi().PushStat(ln.GS_LOADING1);break;case 1:Zt.Open();break;case 2:case 8:0==xh.me.rbs.iSchoolId?Z.fm.Open("拜师之后才能学习门派技能"):ln.gi().PushStat(ln.GS_LEARNSKILL);break;case 3:Yi.Open(0);break;case 4:case 9:case 14:Bi.mp.iPetCount>0?ln.gi().PushStat(ln.GS_PETSFRAME):Z.fm.Open("你还没有宠物");break;case 5:case 13:Yi.Open(3);break;case 6:case 11:Mh.gi().s_GovOperateFrame(0);break;case 7:case 12:Mh.gi().s_GovOperateFrame(1);break;case 10:Ht.mm.iMountsCount>0?ln.gi().PushStat(ln.GS_MOUNTSFRAME):L.easymsg.AddMessage("你还没有坐骑")}return bn.bInRect(t,s,300,280,680,220)||ln.gi().PopStat(1),!1}}fs.bOpen=!1,fs.iLostExp,fs.iLostMoney,fs.sDetail="",fs._PROMPTS=[["0","升级","参加活动升级"],["1","组队","组队再战"],["2","技能","人物技能升级"],["3","人物","升级加点"],["4","宝宝","增强宝宝"],["5","VIP","更多福利"],["6","帮派技能","提升帮派技能"],["7","帮派修炼","提升修炼等级"],["8","技能","人物技能升级"],["9","宝宝","学习宝宝技能"],["10","坐骑","加强坐骑"],["11","帮派技能","提升修炼等级"],["12","帮派修炼","提升帮派技能"],["13","VIP","更多福利"],["14","宝宝","炼出更强宝宝"]],fs.Open=function(){if(fs.bOpen){if(fs.bOpen=!1,xh.me.rbs.iLev<10)return;if(xh.me.rbs.iLev>=40)return;ln.gi().PushStat(ln.GS_DIEPROMPT),Z.fm.bShow&&(Z.fm.bShow=!1)}};class us{XFightGoods(){}InitFightGoods(){this.bReturn=!1,this.bSelectFinished=!1,this.lockgoods=null}DrawFightGoods(){this.iW=430,this.iH=345,this.iX=h.SCRW-this.iW-20,this.iY=h.SCRH-this.iH-20,qi.new_DrawGoods(this.iX,this.iY,ht.gi().goods[2],null,null),null!=this.lockgoods&&qi.new_DrawRect(this.iX,this.iY,ht.gi().goods[2],this.lockgoods,0),qi.bShowDetail()&&qi.new_DrawDetail(null,-1,-1,0)}ProcTouch(i,t,s){var e;return this.bFood=!1,this.bUseToDest=!1,this.lockgoods=qi.new_LockGoods(t,s,this.iX,this.iY,ht.gi().goods[2],i),qi.NoMove(),3==i&&null!=this.lockgoods&&qi.bCanProc()&&(4==(e=gn.de_goods.intValue(this.lockgoods.iTid,0,30))?2!=ws.gi().iFightStat?L.easymsg.AddMessage("宠物不能使用"):(this.bUseToDest=!0,this.bSelectFinished=!0):1==(e=gn.de_goods.intValue(this.lockgoods.iTid,0,26))||2==e?this.bSelectFinished=!0:2==(e=gn.de_goods.intValue(this.lockgoods.iTid,0,34))||3==e?2!=ws.gi().iFightStat?L.easymsg.AddMessage("宠物不能使用烹饪"):(this.bFood=!0,this.bSelectFinished=!0):L.easymsg.AddMessage("所选物品不能在战斗中使用")),3!=i||bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||(this.bReturn=!0),!0}}us.xfg=new us;class ds{constructor(){this.MAXPETCOUNT=10,this.pets=new Array(this.MAXPETCOUNT),this.btn_pets=new Array(this.MAXPETCOUNT),this.iW=510,this.iH=330,this.iX=h.SCRW-this.iW-20,this.iY=h.SCRH-this.iH-20}InitCallPet(){var i;for(this.iW=530,this.iH=330,this.iX=h.SCRW-this.iW-20,this.iY=h.SCRH-this.iH-20,this.btn_pets[0]=null,i=0;i<this.MAXPETCOUNT;i++)this.pets[i]=null;for(this.iPetCount=0,i=0;i<Bi.mp.iPetCount;i++)Bi.mp.pets[i].iPid>0&&(this.pets[this.iPetCount++]=Bi.mp.pets[i]);return this.btn_pets[0]=null,this.iPetCount}DrawCallPet(){var i,t,s;if(this.iW=530,this.iH=330,this.iX=h.SCRW-this.iW-20,this.iY=h.SCRH-this.iH-20,this.iPetCount>0&&null==this.btn_pets[0])for(i=0;i<this.iPetCount;i++)this.btn_pets[i]=new Eh(gn.xani_head),this.btn_pets[i].InitButton(gn.de_pet.strValue(this.pets[i].iTid,0,1)),this.btn_pets[i].Move(this.iX+30+i%4*130,this.iY+30+150*parseInt(i/4),80,80);for(E.new_framepc(this.iX,this.iY,this.iW,this.iH),i=0;i<this.iPetCount;i++){for(gn.xani_nui2.DrawAnimaEx(this.btn_pets[i].iX-80*(this.btn_pets[i].fScale-1)/2,this.btn_pets[i].iY-80*(this.btn_pets[i].fScale-1)/2,"宠物头像框",0,101,this.btn_pets[i].fScale,this.btn_pets[i].fScale,0,0,0),this.btn_pets[i].Draw(),t=0;t<8&&this.pets[i].iPid!=ws.gi().iUsedPetsId[t];t++);s=t<8?4294901760:4294897374,c.gi().DrawTextEx(this.btn_pets[i].iX+40,this.btn_pets[i].iY+80+15,this.pets[i].sName,s,22,101,1,1,0,-2,0),c.gi().DrawTextEx(this.btn_pets[i].iX+40,this.btn_pets[i].iY+80+15+24,this.pets[i].iLev+"级",s,20,101,1,1,0,-2,0)}}ProcTouch(i,t,s){var e,h;for(e=0;e<this.iPetCount;e++)if(this.btn_pets[e].ProcTouch(i,t,s)&&this.btn_pets[e].bCheck()){for(h=0;h<8&&this.pets[e].iPid!=ws.gi().iUsedPetsId[h];h++);if(!(h<8))return this.iCallPetId=this.pets[e].iPid,this.btn_pets[e].SetNormal(),!0;L.easymsg.AddMessage("出战过的宠物，不能再次出战")}return 3==i&&!bn.bInRect(t,s,this.iX-20,this.iY-20,this.iW+40,this.iH+40)&&(this.iCallPetId=-1,!0)}}ds.xfcp=new ds;class ps{constructor(){this.MAXSKILLCOUNT=9,this.iFightSkillId=new Int32Array(this.MAXSKILLCOUNT),this.btn_skills=new Array(this.MAXSKILLCOUNT)}InitPetSkill(i){var t;for(this.iW=380,this.iH=345,this.iX=h.SCRW-this.iW-20,this.iY=h.SCRH-this.iH-20,this.btn_skills[0]=null,this.pet=i,this.iFightSkillCount=0,t=0;t<this.MAXSKILLCOUNT;t++)i.jn[t]>0&&0==gn.de_skill.intValue(i.jn[t],0,32)&&(this.iFightSkillId[this.iFightSkillCount]=i.jn[t],this.iFightSkillCount++);return this.bReturn=!1,this.bUsed=!1,this.iPoint=-1,this.iW=400,this.iFightSkillCount>2?this.iH=330:this.iH=180,this.iX=h.SCRW-this.iW-20,this.iY=h.SCRH-this.iH-20,this.iFightSkillCount}Draw(){var i;if(this.iW=400,this.iFightSkillCount>2?this.iH=330:this.iH=180,this.iX=h.SCRW-this.iW-20,this.iY=h.SCRH-this.iH-20,this.iFightSkillCount>0&&null==this.btn_skills[0])for(i=0;i<this.iFightSkillCount;i++)this.btn_skills[i]=new Eh(gn.xani_nicon),this.btn_skills[i].InitButton(gn.de_skill.strValue(this.iFightSkillId[i],0,5)),this.btn_skills[i].Move(this.iX+30+i%3*130,this.iY+30+150*parseInt(i/3),80,80);E.new_framepc(this.iX,this.iY,this.iW,this.iH);var t=-1;for(i=0;i<this.iFightSkillCount;i++)this.btn_skills[i].Draw(),this.btn_skills[i].bMouseDown&&(t=i),4294897374,c.gi().DrawTextEx(this.btn_skills[i].iX+40,this.btn_skills[i].iY+80+15,gn.de_skill.strValue(this.iFightSkillId[i],0,6),4294897374,25,101,1,1,0,-2,0);t>=0&&Yi.Skill_Detail(this.iFightSkillId[t]%1e3,this.btn_skills[t].iX,this.btn_skills[t].iY,-1)}ProcTouch(i,t,s){var e;for(e=0;e<this.iFightSkillCount;e++)if(this.btn_skills[e].ProcTouch(i,t,s)&&this.btn_skills[e].bCheck())return this.btn_skills[e].SetNormal(),this.iPoint=e,this.bUsed=!0,this.iUseSkillId=this.iFightSkillId[e],!0;return 3==i&&!bn.bInRect(t,s,this.iX-20,this.iY-20,this.iW+40,this.iH+40)&&(this.bReturn=!0,!0)}}ps.xfps=new ps;class ms{constructor(){this.aa=new l,this.sValue="",this.iValues=new Int32Array(5)}}class gs{constructor(){this.bUseing=!1,this.sBuffer=new Uint8Array(64)}}class ws{btnmov(){var i=10;this.btn_operate[0].Move(h.SCRW-80-425,h.SCRH-80-i,80,80),this.btn_operate[1].Move(h.SCRW-80-340,h.SCRH-80-i,80,80),this.btn_operate[2].Move(h.SCRW-80-255,h.SCRH-80-i,80,80),this.btn_operate[3].Move(h.SCRW-80-170,h.SCRH-80-i,80,80),this.btn_operate[7].Move(h.SCRW-80-85,h.SCRH-80-i,80,80),this.btn_operate[6].Move(h.SCRW-80,h.SCRH-80-i,80,80),this.btn_operate[5].Move(h.SCRW-80,h.SCRH-80-85-i,80,80),this.btn_operate[4].Move(h.SCRW-80,h.SCRH-80-170-i,80,80),this.btn_operate[8].Move(h.SCRW-80,h.SCRH-80-255-i,80,80),this.btn_operate[9].Move(h.SCRW-80-80,h.SCRH-80-80-i,80,80),this.btn_petoperate[0].Move(h.SCRW-80-425,h.SCRH-80-i,80,80),this.btn_petoperate[1].Move(h.SCRW-80-340,h.SCRH-80-i,80,80),this.btn_petoperate[2].Move(h.SCRW-80-255,h.SCRH-80-i,80,80),this.btn_petoperate[3].Move(h.SCRW-80-170,h.SCRH-80-i,80,80),this.btn_petoperate[4].Move(h.SCRW-80-85,h.SCRH-80-i,80,80),this.btn_petoperate[5].Move(h.SCRW-80,h.SCRH-80-i,80,80),this.btn_cancel.Move(h.SCRW-80,h.SCRH-80-i,80,80)}constructor(){var i,t;for(this.MAXFIGHTDATA=1024,this.FIGHTACTION_NORMAL=0,this.FIGHTACTION_DEFENCE=1,this.FIGHTACTION_ESCAPE=2,this.FIGHTACTION_CATCH=3,this.FIGHTACTION_CALLBB=4,this.FIGHTACTION_CALLBACKBB=5,this.FIGHTACTION_MAGIC=6,this.FIGHTACTION_USEGOODS=7,this.FIGHTACTION_PROTECT=8,this.FIGHTACTION_SPECIAL=9,this.iCmd=new Int32Array(10),this.iLastRoleCmd=new Int32Array(10),this.iLastPetCmd=new Int32Array(10),this.iShiQi=[0,0],this.iZhen=[0,0],this.iUsedPetsId=new Int32Array(8),this.fat=new Array(4),i=0;i<4;i++)for(this.fat[i]=new Array(xh.MAXTEAMOLE),t=0;t<xh.MAXTEAMOLE;t++)this.fat[i][t]=new hs;for(this.aa_select1=gn.xani_nui4.InitAnimaWithName("选择敌人",null),this.aa_select2=gn.xani_nui4.InitAnimaWithName("选择队友",null),this.fat_base=new Array(2),this.fat_base[0]=new hs,this.fat_base[1]=new hs,this.fat_base[0].iPos=5,this.fat_base[0].sFaceTo="_左",this.fat_base[1].iPos=25,this.fat_base[1].sFaceTo="_右",this.btn_operate=new Array(10),i=0;i<9;i++)this.btn_operate[i]=new Eh(gn.xani_nui4),this.btn_operate[i].Move(h.SCRW-170-40+i%2*85,h.SCRH/3+i/2*80,80,80);for(this.btn_operate[0].InitButton("战斗_法术"),this.btn_operate[0].sAnimaName="法术",this.btn_operate[1].InitButton("战斗_道具"),this.btn_operate[1].sAnimaName="道具",this.btn_operate[2].InitButton("战斗_保护"),this.btn_operate[2].sAnimaName="保护",this.btn_operate[3].InitButton("战斗_防御"),this.btn_operate[3].sAnimaName="防御",this.btn_operate[7].InitButton("战斗_逃跑"),this.btn_operate[7].sAnimaName="逃跑",this.btn_operate[4].InitButton("战斗_召唤"),this.btn_operate[4].sAnimaName="召唤",this.btn_operate[8].InitButton("战斗_捕捉"),this.btn_operate[8].sAnimaName="捕捉",this.btn_operate[5].InitButton("战斗_召还"),this.btn_operate[5].sAnimaName="召还",this.btn_operate[6].InitButton("战斗_自动"),this.btn_operate[6].sAnimaName="自动",this.btn_operate[9]=new Eh(gn.xani_nui4),this.btn_operate[9].InitButton("战斗_特技"),this.btn_operate[9].sAnimaName="特技",this.btn_petoperate=new Array(7),i=0;i<7;i++)this.btn_petoperate[i]=new Eh(gn.xani_nui4),this.btn_petoperate[i].Move(h.SCRW/2+i%2*85,h.SCRH/3+i/2*80,80,80);for(this.btn_petoperate[0].InitButton("战斗_法术"),this.btn_petoperate[0].sAnimaName="法术",this.btn_petoperate[1].InitButton("战斗_道具"),this.btn_petoperate[1].sAnimaName="道具",this.btn_petoperate[2].InitButton("战斗_保护"),this.btn_petoperate[2].sAnimaName="保护",this.btn_petoperate[3].InitButton("战斗_防御"),this.btn_petoperate[3].sAnimaName="防御",this.btn_petoperate[4].InitButton("战斗_逃跑"),this.btn_petoperate[4].sAnimaName="逃跑",this.btn_petoperate[5].InitButton("战斗_自动"),this.btn_petoperate[5].sAnimaName="自动",this.btn_cancel=new Eh(gn.xani_nui4),this.btn_cancel.InitButton("战斗_自动"),this.btn_cancel.sAnimaName="取消",this.btnmov(),this.fds=new Array(this.MAXFIGHTDATA),i=0;i<this.MAXFIGHTDATA;i++)this.fds[i]=new ms;for(i=0;i<2;i++)for(t=0;t<5;t++)ws.basepos[i][t][0]*=80,ws.basepos[i][t][1]*=80;for(i=0;i<12;i++)for(t=0;t<5;t++)ws.zhenpos[i][t][0]*=80,ws.zhenpos[i][t][1]*=25;for(this.iLastRoleCmd[0]=this.FIGHTACTION_NORMAL,this.iLastRoleCmd[1]=0,this.iLastRoleCmd[2]=-1,this.iLastPetCmd[0]=this.FIGHTACTION_NORMAL,this.iLastPetCmd[1]=0,this.iLastPetCmd[2]=-1,this.btn_leavewatch=new Eh(gn.xani_nui4),this.btn_leavewatch.InitButton("战斗_自动"),this.btn_leavewatch.sAnimaName="离开",this.ub=new Array(10),i=0;i<10;i++)this.ub[i]=new gs;this.bShowHpDetail=!1,this.wsize=22,this.jdjd=0}InitPos(){var i,t,s,e,a,n,o,r,c,l;if(this.myfat=null,this.bSwap)for(i=0;i<2;i++)for(t=0;t<xh.MAXTEAMOLE;t++)r=this.fat[i][t],this.fat[i][t]=this.fat[i+2][t],this.fat[i+2][t]=r;for(630,360,170,200,this.fat_base[0].iX=630*h.SCRW/800,this.fat_base[0].iY=360*h.SCRH/480,this.fat_base[1].iX=170*h.SCRW/800,this.fat_base[1].iY=200*h.SCRH/480,this.fat_base[0].FaceTo(!0),this.fat_base[1].FaceTo(!0),i=0;i<4;i++)for(t=0;t<xh.MAXTEAMOLE;t++)c=ws.basepos[i%2][t][0]+ws.zhenpos[i%2+2*this.iZhen[parseInt(i/2)]][t][0],l=ws.basepos[i%2][t][1]+ws.zhenpos[i%2+2*this.iZhen[parseInt(i/2)]][t][1],s=bn.GetAngleXY_ext(c,l,0,0),e=bn.llength(c,l,0,0),i<2?(s+=125*bn.PI/180,a=630,n=360):(s-=55*bn.PI/180,a=170,n=200),this.fat[i][t].iOx=a+Math.cos(s)*e*1.2,this.fat[i][t].iOy=n+Math.sin(s)*e*.7,this.fat[i][t].iOx=this.fat[i][t].iOx*h.SCRW/800,this.fat[i][t].iOy=this.fat[i][t].iOy*h.SCRH/480,this.fat[i][t].iX=this.fat[i][t].iOx,this.fat[i][t].iY=this.fat[i][t].iOy,this.fat[i][t].iPos=10*i+t,i<2?(this.fat[i][t].FaceTo(!0),this.fat[i][t].iMoveOffX=100*Math.cos(20*bn.PI/180),this.fat[i][t].iMoveOffY=100*Math.sin(20*bn.PI/180)):(this.fat[i][t].FaceTo(!0),this.fat[i][t].iMoveOffX=-100*Math.cos(20*bn.PI/180),this.fat[i][t].iMoveOffY=-100*Math.sin(20*bn.PI/180)),this.fat[i][t].bUseing&&(o=this.fat[i][t],this.fat[i][t].SetBaseAnima("战斗站立"),this.fat[i][t].iHp<=0&&this.fat[i][t].SetBaseAnima("死亡"),o.NextAnima(),o.iPos==this.iMyPos&&(o.bMe=!0,this.myfat=o))}SwapPos(i){return this.bSwap?i<20?i+20:i-20:i}SwapZhen(){if(this.bSwap){var i=this.iZhen[0];this.iZhen[0]=this.iZhen[1],this.iZhen[1]=i}}SwapShiQi(){if(this.bSwap){var i=this.iShiQi[0];this.iShiQi[0]=this.iShiQi[1],this.iShiQi[1]=i}}setpetused(i){var t=i.GetNextInt();xh.me.iFightPid=t;for(var s=0;s<8;s++)if(this.iUsedPetsId[s]<=0){this.iUsedPetsId[s]=t;break}}updatefat(i){var t;for(t=0;t<10;t++)if(!this.ub[t].bUseing){bn.arraycopy(i.databuf,3,this.ub[t].sBuffer,0,i.iLength-3),this.ub[t].iLen=i.iLength-3,this.ub[t].iPos=i.GetNextByte(),this.ub[t].iPos=this.SwapPos(this.ub[t].iPos),this.ub[t].bUseing=!0;break}gn.sop1("len="+i.iLength+",,offset="+i.iOffset)}DoUpdate(i){var t;for(t=0;t<10;t++)if(this.ub[t].bUseing&&this.ub[t].iPos==i){var s=new u(256);return s.SetDataAndOffset(this.ub[t].sBuffer,0,this.ub[t].iLen),this._updatefat(s),void(this.ub[t].bUseing=!1)}}_updatefat(i){var t,s,e,h=i.GetNextByte();h=this.SwapPos(h);var a=this.fat[parseInt(h/10)][h%10];if(a.Clear(),Bi.mp.CalcAll(),h==this.iMyPos+10){var n=Bi.mp.GetUseingPet();null!=n&&n.iHp<=0&&(n.iHp=n.iMaxHp,n.iMp=n.iMaxMp)}a.bUseing=!0,a.sName=i.GetNextString(),a.iMaxHp=i.GetNextInt(),a.iHp=i.GetNextInt(),a.iMaxMp=i.GetNextInt(),a.iMp=i.GetNextInt(),a.iType=i.GetNextByte(),t=i.GetNextByte(),s=i.GetNextInt(),e=i.GetNextInt(),a.iColor[0]=7&e,a.iColor[1]=e>>3&7,a.iColor[2]=e>>6&7,a.iColor[3]=e>>9&7,a.iColor[4]=e>>12&7,0==a.iType?(a.iRace_Sex=t,a.iWeapTid=s,a.nr=rh.gameing.findnrsbyname(a.sName),a.xani=gn.xani_newrole[a.iRace_Sex],a.iSex=a.iRace_Sex%2):1==a.iType?(a.iTid=s,a.xani=gn.xani_pets[a.iTid%1e4]):2==a.iType&&(a.iSpecialType=t,1==t?(a.iWeapTid=s%1e4,a.iRace_Sex=parseInt(s/1e4),a.xani=gn.xani_newrole[a.iRace_Sex],a.iSex=a.iRace_Sex%2):(a.iTid=s,a.xani=gn.xani_pets[a.iTid%1e4])),a.iX=a.iOx,a.iY=a.iOy,a.FaceTo(!0),a.SetBaseAnima("战斗站立"),a.NextAnima()}InitFight(i){var t,s,e,h,a;for(this.btnmov(),i.bCompress=!0,t=0;t<4;t++)for(s=0;s<xh.MAXTEAMOLE;s++)this.fat[t][s].Clear();for(t=0;t<10;t++)this.ub[t].bUseing=!1;for(t=0;t<2;t++)this.fat_base[t].Clear();for(this.iFightType=i.GetNextByte();100!=(h=i.GetNextByte());)(a=this.fat[parseInt(h/10)][h%10]).bUseing=!0,a.sName=i.GetNextString(),a.iMaxHp=i.GetNextInt(),a.iHp=i.GetNextInt(),a.iMaxMp=i.GetNextInt(),a.iMp=i.GetNextInt(),a.iType=i.GetNextByte(),t=i.GetNextByte(),s=i.GetNextInt(),e=i.GetNextInt(),a.iColor[0]=7&e,a.iColor[1]=e>>3&7,a.iColor[2]=e>>6&7,a.iColor[3]=e>>9&7,a.iColor[4]=e>>12&7,0==a.iType?(a.iRace_Sex=t,a.iWeapTid=s,a.nr=rh.gameing.findnrsbyname(a.sName),a.xani=gn.xani_newrole[a.iRace_Sex],a.iSex=a.iRace_Sex%2):1==a.iType?(a.iTid=s,a.xani=gn.xani_pets[s%1e4]):2==a.iType&&(a.iSpecialType=t,1==t?(a.iWeapTid=s%1e4,a.iRace_Sex=parseInt(s/1e4),a.xani=gn.xani_newrole[a.iRace_Sex],a.iSex=a.iRace_Sex%2):(a.iTid=s,a.xani=gn.xani_pets[s%1e4]));if(this.iMyPos=i.GetNextByte(),this.bSwap=!1,this.iMyPos>=100)100==this.iMyPos?this.iMyTeam=0:(this.iMyTeam=1,this.bSwap=!0);else{for(this.iMyPos<20?this.iMyTeam=0:(this.iMyTeam=1,this.bSwap=!0,this.iMyPos-=20),t=0;t<8;t++)this.iUsedPetsId[t]=i.GetNextInt();ns.xfs.InitFightSkill(),os.xss.InitSpecialSkill()}this.iShiQi[0]=i.GetNextShort(),this.iShiQi[1]=i.GetNextShort(),this.iRound=i.GetNextShort(),this.iZhen[0]=i.GetNextByte(),this.iZhen[1]=i.GetNextByte(),this.SwapShiQi(),this.SwapZhen(),ws.bFighting=!0,this.iAlphaEffect=0,this.iFightStat=0,this.InitPos(),this.bFightFinished=!1,this.iWaited=0,i.bCompress=!1}DrawHpDetail(){if(this.iMyPos>=100)xh.me.DrawHpDetail();else{var i=this.getfm(this.iMyPos),t=h.SCRW-88-60-150;c.gi().FillRect_2D(t,0,t+150,60,2147483648),c.gi().DrawTextEx(t,0,"气血:"+i.iHp+"/"+i.iMaxHp,4294967295,20,101,1,1,0,0,0),c.gi().DrawTextEx(t,20,"魔法:"+i.iMp+"/"+i.iMaxMp,4294967295,20,101,1,1,0,0,0),c.gi().DrawTextEx(t,40,"愤怒:"+xh.me.rbs.iAnger+"/150",4294967295,20,101,1,1,0,0,0)}}DrawHead(){if(this.iMyPos>=100)xh.me.DrawHead();else{var i=this.getfm(this.iMyPos),t=this.getfm(this.iMyPos+10),s=Bi.mp.GetUseingPet();null==s?xh.me.DrawHeadEx(i.iHp,xh.me.rbs.iMaxHp,i.iMp,xh.me.rbs.iMaxMp,xh.me.rbs.iAnger,xh.me.rbs.iLev,-1,0,0,0,0,0,0):xh.me.DrawHeadEx(i.iHp,xh.me.rbs.iMaxHp,i.iMp,xh.me.rbs.iMaxMp,xh.me.rbs.iAnger,xh.me.rbs.iLev,s.iTid,t.iHp,s.iMaxHp,t.iMp,s.iMaxMp,s.iLev,s.iExp)}this.bShowHpDetail&&this.DrawHpDetail()}Draw_UI1(){c.gi().FillRect_2D(0,0,this.iAlphaEffect,h.SCRH,2684356120),this.DrawHead(),this.iAlphaEffect>=h.SCRW&&gn.xani_nui2.DrawAnimaEx(h.SCRW/2-365,(h.SCRH-327)/2+80,"背景图案",1,101,2,1,0,0,0)}Draw(){var i,t,s=!1;for((i=this.iAlphaEffect)<h.SCRW&&(c.gi().SetViewClip(0,0,i<=0?1:i,h.SCRH),s=!0),M.gi().ClearBuffer(),i=0;i<4;i++)for(t=0;t<xh.MAXTEAMOLE;t++)this.fat[i][t].bUseing&&(this.iFightStat>100&&(this.fat[i][t].bActed=!0),this.fat[i][t].Draw(),4!=this.iFightStat&&14!=this.iFightStat||i>=2&&M.gi().DrawAnima_aa(this.fat[i][t].iY+1,null,this.fat[i][t].iX,this.fat[i][t].iY-40,this.aa_select1),5!=this.iFightStat&&15!=this.iFightStat||i<2&&M.gi().DrawAnima_aa(this.fat[i][t].iY+1,null,this.fat[i][t].iX,this.fat[i][t].iY-40,this.aa_select2));this.aa_select1.NextFrame(),this.aa_select2.NextFrame(),this.fat_base[0].Draw(),this.fat_base[1].Draw(),cs.fe.DrawGround(),M.gi().SortAndDraw(),bs.ne.Draw(),s&&c.gi().NoClip()}Draw_UI2(){var i;switch(this.iAlphaEffect<h.SCRW&&c.gi().SetViewClip(0,0,this.iAlphaEffect<=0?1:this.iAlphaEffect,h.SCRH),this.btnmov(),uh.gi().Draw(),this.iMyPos>=100&&(this.iFightStat<100&&(this.iFightStat=100),this.btn_leavewatch.Move(h.SCRW-83,h.SCRH-83,83,83),this.btn_leavewatch.Draw(),c.gi().DrawText_2(this.btn_leavewatch.iX+40,this.btn_leavewatch.iY+80,this.btn_leavewatch.sAnimaName,4294967295,this.wsize,101,1,1,0,-2,-3,3,4278190080)),this.iFightStat<=100&&this.bFightFinished&&(this.iFightStat=300,this.iTimeOut=0),this.iFightStat){case 0:if(xs.jq.bJQLock()){this.iCmd[0]=this.FIGHTACTION_DEFENCE,this.iCmd[1]=0,this.iCmd[2]=0,this.FinishRoleOperate(),this.iCmd[0]=this.FIGHTACTION_DEFENCE,this.iCmd[1]=0,this.iCmd[2]=0,this.FinishPetOperate();break}if(_s.aff.iAutoFightLast>0){(this.iWaited/20>=3||this.iRound>1||this.iFightType!=ws.FIGHTWITH_DARK)&&(this.iCmd[0]=this.iLastRoleCmd[0],this.iCmd[1]=this.iLastRoleCmd[1],this.iCmd[2]=this.iLastRoleCmd[2],this.FinishRoleOperate(),this.iCmd[0]=this.iLastPetCmd[0],this.iCmd[1]=this.iLastPetCmd[1],this.iCmd[2]=this.iLastPetCmd[2],this.FinishPetOperate(),_s.aff.iAutoFightLast--);break}for(i=0;i<8;i++)this.btn_operate[i].Draw(),c.gi().DrawText_2(this.btn_operate[i].iX+40,this.btn_operate[i].iY+80,this.btn_operate[i].sAnimaName,4294833640,this.wsize,101,1,1,0,-2,-3,3,4279894016);(this.iFightType==ws.FIGHTWITH_DARK||this.iFightType==ws.FIGHTWITH_NPC&&this.fat[2][0].bUseing&&"野猪"==this.fat[2][0].sName)&&(this.btn_operate[8].Draw(),i=8,c.gi().DrawText_2(this.btn_operate[i].iX+40,this.btn_operate[i].iY+80,this.btn_operate[i].sAnimaName,4294833640,this.wsize,101,1,1,0,-2,-3,3,4279894016)),os.xss.iSkillCount>0&&(this.btn_operate[9].Draw(),i=9,c.gi().DrawText_2(this.btn_operate[i].iX+40,this.btn_operate[i].iY+80,this.btn_operate[i].sAnimaName,4294833640,this.wsize,101,1,1,0,-2,-3,3,4279894016)),ei.end(ei.CONFIRM_ESCAPE)&&ei.bConfirm&&(this.iCmd[0]=this.FIGHTACTION_ESCAPE,this.iCmd[1]=0,this.iCmd[2]=0,this.FinishRoleOperate());break;case 6:os.xss.DrawSpecialSkill();break;case 1:ns.xfs.DrawFightSkill();break;case 2:case 12:us.xfg.DrawFightGoods();break;case 3:ds.xfcp.DrawCallPet();break;case 10:for(i=0;i<6;i++)this.btn_petoperate[i].Draw(),c.gi().DrawText_2(this.btn_petoperate[i].iX+40,this.btn_petoperate[i].iY+80,this.btn_petoperate[i].sAnimaName,4294833640,this.wsize,101,1,1,0,-2,-3,3,4279894016);_s.aff.iAutoFightLast>0&&(this.iCmd[0]=this.iLastPetCmd[0],this.iCmd[1]=this.iLastPetCmd[1],this.iCmd[2]=this.iLastPetCmd[2],this.FinishPetOperate(),_s.aff.iAutoFightLast--),ei.end(ei.CONFIRM_ESCAPE)&&ei.bConfirm&&(this.iCmd[0]=this.FIGHTACTION_ESCAPE,this.iCmd[1]=0,this.iCmd[2]=0,this.FinishPetOperate());break;case 11:ps.xfps.Draw();break;case 4:case 5:case 14:case 15:this.btn_cancel.Draw(),c.gi().DrawText_2(this.btn_cancel.iX+40,this.btn_cancel.iY+80,this.btn_cancel.sAnimaName,4294967295,this.wsize,101,1,1,0,-2,-3,3,4278190080);break;case 100:break;case 200:this.ProcFightData();break;case 300:this.iTimeOut++,this.iTimeOut>15&&(this.iAlphaEffect-=h.SCRW/4),this.iTimeOut>23&&(ws.bFighting=!1,this.ClearPopo(),fs.Open())}ws.bFighting&&(i=20,this.iFightStat<100?(this.iWaited<30*i?this.iWaited++:this.iFightStat=100,bs.ne.Draw_TimeNumber(h.SCRW/2,150,30-this.iWaited/i)):100==this.iFightStat&&gn.xani_nui4.DrawAnima(h.SCRW/2,150,"倒计时等待",0)),gn.xani_nui4.DrawAnima(h.SCRW/2,0,"战斗顶部UI",0),gn.xani_nui4.DrawAnimaEx(h.SCRW/2-49+(120*(1-this.iShiQi[1]/120)-3),1,"战斗顶部UI",1,101,1*this.iShiQi[1]/120,1,0,0,0),gn.xani_nui4.DrawAnimaEx(h.SCRW/2+49,1,"战斗顶部UI",2,101,1*this.iShiQi[0]/120,1,0,0,0),c.gi().DrawTextEx(h.SCRW/2+82,45,""+this.iShiQi[0],4278223103,28,101,1,1,0,-2,-3),c.gi().DrawTextEx(h.SCRW/2-82,45,""+this.iShiQi[1],4294901760,28,101,1,1,0,-2,-3),bs.ne.Draw_RoundNumber(h.SCRW/2,45,this.iRound),this.iAlphaEffect<h.SCRW&&(c.gi().NoClip(),this.iAlphaEffect+=h.SCRW/8)}ClearPopo(){rh.gameing.ClearPopo()}bHavePet(i){return gn.sop("pos="+i),this.fat[parseInt(i/10)+1][i%10].bUseing}SelectOur(i,t){var s,e;for(s=0;s<2;s++)for(e=0;e<xh.MAXTEAMOLE;e++)if(this.fat[s][e].bUseing&&bn.bInRect(i,t,this.fat[s][e].iX-30,this.fat[s][e].iY-40-30,60,60))return 10*s+e;for(s=0;s<2;s++)for(e=0;e<xh.MAXTEAMOLE;e++)if(this.fat[s][e].bUseing&&this.fat[s][e].xani.bInAnima(this.fat[s][e].aa_body,this.fat[s][e].iOx,this.fat[s][e].iOy,i,t))return 10*s+e;return-1}SelectEnemy(i,t){var s,e;for(s=2;s<4;s++)for(e=0;e<xh.MAXTEAMOLE;e++)if(this.fat[s][e].bUseing&&bn.bInRect(i,t,this.fat[s][e].iX-30,this.fat[s][e].iY-40-30,60,60))return 10*s+e;for(s=2;s<4;s++)for(e=0;e<xh.MAXTEAMOLE;e++)if(this.fat[s][e].bUseing&&this.fat[s][e].xani.bInAnima(this.fat[s][e].aa_body,this.fat[s][e].iOx,this.fat[s][e].iOy,i,t))return 10*s+e;return-1}ProcTouch(i,t,s){if(this.bShowHpDetail=!1,this.iAlphaEffect<h.SCRW)return Gh.gi().clear(),!0;if(this.iMyPos>=100)return this.btn_leavewatch.ProcTouch(i,t,s)&&this.btn_leavewatch.bCheck()&&(this.btn_leavewatch.SetNormal(),Mh.gi().s_WatchFight(1,0),this.iFightStat=300,this.iTimeOut=0),!0;var e;switch(this.iFightStat){case 0:if(_s.aff.iAutoFightLast>0)break;for(e=0;e<10;e++)if((9!=e||os.xss.iSkillCount>0)&&(8!=e||this.iFightType==ws.FIGHTWITH_DARK||this.iFightType==ws.FIGHTWITH_NPC&&"野猪"==this.fat[2][0].sName)&&this.btn_operate[e].ProcTouch(i,t,s)&&this.btn_operate[e].bCheck())switch(this.btn_operate[e].SetNormal(),e){case 0:this.iCmd[0]=this.FIGHTACTION_MAGIC,this.iFightStat=1,ns.xfs.iShowPoint=-1;break;case 1:this.iCmd[0]=this.FIGHTACTION_USEGOODS,this.iFightStat=2,us.xfg.InitFightGoods();break;case 2:this.iCmd[0]=this.FIGHTACTION_PROTECT,this.iFightStat=5;break;case 3:this.iCmd[0]=this.FIGHTACTION_DEFENCE,this.iCmd[1]=0,this.iCmd[2]=0,this.FinishRoleOperate();break;case 4:ds.xfcp.InitCallPet()<=0?L.easymsg.AddMessage("当前没有宠物可召唤"):(this.iCmd[0]=this.FIGHTACTION_CALLBB,this.iCmd[1]=0,this.iFightStat=3);break;case 5:this.iCmd[0]=this.FIGHTACTION_CALLBACKBB,this.FinishRoleOperate();break;case 6:this.iWaited+=60,_s.aff.iAutoFightLast=_s.AUTOLAST;break;case 7:ei.start(ei.CONFIRM_ESCAPE,"是否确定逃跑？");break;case 8:this.iCmd[0]=this.FIGHTACTION_CATCH,this.iCmd[1]=0,this.iFightStat=4;break;case 9:this.iCmd[0]=this.FIGHTACTION_SPECIAL,this.iFightStat=6,os.xss.iShowPoint=-1}this.iEnemyPoint=this.SelectEnemy(t,s),3==i&&-1!=this.iEnemyPoint&&(this.iCmd[0]=this.FIGHTACTION_NORMAL,this.iCmd[1]=0,this.iCmd[2]=this.iEnemyPoint,this.FinishRoleOperate());break;case 6:os.xss.ProcTouch(i,t,s)&&(-1==os.xss.iUseSkillId?this.iFightStat=0:(this.iCmd[1]=os.xss.iUseSkillId,os.xss.iSelectTarget<=0?(this.iCmd[2]=0,this.FinishRoleOperate()):1==os.xss.iSelectTarget?this.iFightStat=5:this.iFightStat=4));break;case 1:ns.xfs.ProcTouch(i,t,s)&&(-1==ns.xfs.iUseSkillId?this.iFightStat=0:(this.iCmd[1]=ns.xfs.iUseSkillId,ns.xfs.iSelectTarget<=0?(this.iCmd[2]=0,this.FinishRoleOperate()):1==ns.xfs.iSelectTarget?this.iFightStat=5:this.iFightStat=4));break;case 2:us.xfg.ProcTouch(i,t,s),us.xfg.bReturn?this.iFightStat=0:us.xfg.bSelectFinished&&(this.lastusegoods1=us.xfg.lockgoods,this.iCmd[1]=us.xfg.lockgoods.iGid,us.xfg.bUseToDest?this.iFightStat=4:us.xfg.bFood?(this.iCmd[2]=0,this.FinishRoleOperate()):this.iFightStat=5);break;case 3:ds.xfcp.ProcTouch(i,t,s)&&(-1==ds.xfcp.iCallPetId?this.iFightStat=0:(this.iCmd[1]=ds.xfcp.iCallPetId,this.iCmd[2]=ds.xfcp.iCallPetId,this.FinishRoleOperate()));break;case 4:if(this.btn_cancel.ProcTouch(i,t,s)){this.btn_cancel.bCheck()&&(this.iFightStat=0,this.btn_cancel.SetNormal());break}this.iEnemyPoint=this.SelectEnemy(t,s),3==i&&-1!=this.iEnemyPoint&&(this.iCmd[2]=this.iEnemyPoint,this.FinishRoleOperate());break;case 5:if(this.btn_cancel.ProcTouch(i,t,s)){this.btn_cancel.bCheck()&&(this.btn_cancel.SetNormal(),this.iFightStat=0);break}this.iOurPoint=this.SelectOur(t,s),3==i&&-1!=this.iOurPoint&&(this.iCmd[2]=this.iOurPoint,this.FinishRoleOperate());break;case 10:for(e=0;e<6;e++)if(this.btn_petoperate[e].ProcTouch(i,t,s)&&this.btn_petoperate[e].bCheck())switch(this.btn_petoperate[e].SetNormal(),e){case 0:ps.xfps.InitPetSkill(Bi.mp.GetUseingPet())<=0?L.easymsg.AddMessage("当前宠物没有主动技能"):(this.iCmd[0]=this.FIGHTACTION_MAGIC,this.iFightStat=11);break;case 1:this.iCmd[0]=this.FIGHTACTION_USEGOODS,this.iFightStat=12,us.xfg.InitFightGoods();break;case 2:this.iCmd[0]=this.FIGHTACTION_PROTECT,this.iFightStat=15;break;case 3:this.iCmd[0]=this.FIGHTACTION_DEFENCE,this.iCmd[1]=0,this.iCmd[2]=0,this.FinishPetOperate();break;case 4:ei.start(ei.CONFIRM_ESCAPE,"宠物是否确定逃跑？");break;case 5:_s.aff.iAutoFightLast=_s.AUTOLAST}this.iEnemyPoint=this.SelectEnemy(t,s),3==i&&-1!=this.iEnemyPoint&&(this.iCmd[0]=this.FIGHTACTION_NORMAL,this.iCmd[1]=0,this.iCmd[2]=this.iEnemyPoint,this.FinishPetOperate());break;case 11:ps.xfps.ProcTouch(i,t,s)&&(ps.xfps.bReturn&&(this.iFightStat=10),ps.xfps.bUsed&&(this.iCmd[1]=ps.xfps.iUseSkillId,this.iFightStat=14));break;case 12:us.xfg.ProcTouch(i,t,s),us.xfg.bReturn?this.iFightStat=10:us.xfg.bSelectFinished&&(this.lastusegoods2=us.xfg.lockgoods,this.iCmd[1]=us.xfg.lockgoods.iGid,this.iFightStat=15);break;case 14:if(this.btn_cancel.ProcTouch(i,t,s)){this.btn_cancel.bCheck()&&(this.btn_cancel.SetNormal(),this.iFightStat=10);break}this.iEnemyPoint=this.SelectEnemy(t,s),3==i&&-1!=this.iEnemyPoint&&(this.iCmd[2]=this.iEnemyPoint,this.FinishPetOperate());break;case 15:if(this.btn_cancel.ProcTouch(i,t,s)){this.btn_cancel.bCheck()&&(this.btn_cancel.SetNormal(),this.iFightStat=10);break}this.iOurPoint=this.SelectOur(t,s),3==i&&-1!=this.iOurPoint&&(this.iCmd[2]=this.iOurPoint,this.FinishPetOperate())}return(0==this.iFightStat||this.iFightStat>=100)&&1==i&&-1==(e=this.SelectOur(t,s))&&(e=this.SelectEnemy(t,s)),!(2!=i&&1!=i||!bn.bInRect(t,s,h.SCRW-191,0,108,80))&&(this.bShowHpDetail=!0,!0)}FinishPetOperate(){this.iCmd[0]==this.FIGHTACTION_USEGOODS&&-1==this.lastusegoods2.iGid&&(this.iCmd[0]=this.FIGHTACTION_NORMAL,this.iCmd[1]=0,this.iCmd[2]=-1),this.iLastPetCmd[0]=this.iCmd[0],this.iLastPetCmd[1]=this.iCmd[1],this.iLastPetCmd[2]=this.iCmd[2],this.iCmd[2]=this.SwapPos(this.iCmd[2]),Mh.gi().s_FightOperate(1,this.iCmd),this.iFightStat=100}FinishRoleOperate(){this.iCmd[0]==this.FIGHTACTION_USEGOODS&&-1==this.lastusegoods1.iGid&&(this.iCmd[0]=this.FIGHTACTION_NORMAL,this.iCmd[1]=0,this.iCmd[2]=-1),this.iLastRoleCmd[0]=this.iCmd[0],this.iLastRoleCmd[1]=this.iCmd[1],this.iLastRoleCmd[2]=this.iCmd[2],this.iCmd[2]=this.SwapPos(this.iCmd[2]),Mh.gi().s_FightOperate(0,this.iCmd),this.bHavePet(this.iMyPos)?this.iFightStat=10:this.iFightStat=100}getfm(i){return i%10==5?parseInt(i/10)<2?this.fat_base[0]:this.fat_base[1]:this.fat[parseInt(i/10)][i%10]}ProcFightData(){for(var i,t,s,e,h=!1;this.fds[this.iFDPoint].iTimeStamp<=this.iTimeStamp&&this.iFDPoint<this.iFDCount;){switch((s=this.fds[this.iFDPoint]).iActType){case 0:s.bActing=!0,s.iValues[1]=0,this.getfm(s.iAPos).iDx=this.getfm(s.iValues[0]).iOx+this.getfm(s.iAPos).iMoveOffX,this.getfm(s.iAPos).iDy=this.getfm(s.iValues[0]).iOy+this.getfm(s.iAPos).iMoveOffY;break;case 18:s.bActing=!0,s.iValues[1]=0,this.getfm(s.iAPos).iDx=this.getfm(s.iValues[0]).iOx-this.getfm(s.iAPos).iMoveOffX/2,this.getfm(s.iAPos).iDy=this.getfm(s.iValues[0]).iOy-this.getfm(s.iAPos).iMoveOffY/2;break;case 1:(e=this.getfm(s.iAPos)).AddAnima("普通攻击"),0==e.iType||2==e.iType&&1==e.iSpecialType?0==e.iSex?gn.x_wav.StartWav("role0_attack",!1):gn.x_wav.StartWav("role1_attack",!1):(1==e.iType||2==e.iType&&1!=e.iSpecialType)&&gn.x_wav.StartWav_Pet(e.iTid%1e4,0);break;case 2:(e=this.getfm(s.iAPos)).AddAnima("被攻击"),0==e.iType||2==e.iType&&1==e.iSpecialType?0==e.iSex?gn.x_wav.StartWav("role0_hurt",!1):gn.x_wav.StartWav("role1_hurt",!1):(1==e.iType||2==e.iType&&1!=e.iSpecialType)&&gn.x_wav.StartWav_Pet(e.iTid%1e4,2);break;case 3:(e=this.getfm(s.iAPos)).AddAnima("防御"),gn.x_wav.StartWav("defence",!1),cs.fe.AddEffect2(e.iX,e.iY,10,"防御",!(s.iAPos/10<2));break;case 4:s.bActing=!0,s.iValues[1]=0;break;case 5:if(this.iDelay++,this.iDelay<s.iAPos){h=!0;break}this.iDelay=0;break;case 6:this.iTimeStamp=0;break;case 7:e=this.getfm(s.iAPos),0==s.iValues[0]?(e.AddAnima("死亡过程"),e.SetBaseAnima("死亡"),0==e.iType||2==e.iType&&1==e.iSpecialType?0==e.iSex?gn.x_wav.StartWav("role0_die",!1):gn.x_wav.StartWav("role1_die",!1):(1==e.iType||2==e.iType&&1!=e.iSpecialType)&&gn.x_wav.StartWav_Pet(e.iTid%1e4,3)):e.SetBaseAnima("战斗站立");break;case 8:case 25:this.getfm(s.iAPos).iDx=this.getfm(s.iAPos).iOx+6*this.getfm(s.iAPos).iMoveOffX,this.getfm(s.iAPos).iDy=this.getfm(s.iAPos).iOy+6*this.getfm(s.iAPos).iMoveOffY,this.getfm(s.iAPos).SetBaseAnima("逃跑"),s.iValues[1]=0,s.bActing=!0,gn.x_wav.StartWav("escape",!1);break;case 21:e=this.getfm(s.iAPos),s.iAPos==s.iValues[0]?(this.getfm(s.iAPos).iDx=this.getfm(s.iValues[0]).iOx,this.getfm(s.iAPos).iDy=this.getfm(s.iValues[0]).iOy):(this.getfm(s.iAPos).iDx=this.getfm(s.iValues[0]).iOx+this.getfm(s.iAPos).iMoveOffX,this.getfm(s.iAPos).iDy=this.getfm(s.iValues[0]).iOy+this.getfm(s.iAPos).iMoveOffY),e.iPos<20&&e.iDx>e.iX&&e.FaceTo(!1),e.iPos>=20&&e.iDx<e.iX&&e.FaceTo(!1),this.getfm(s.iAPos).iTx=this.getfm(s.iAPos).iX,this.getfm(s.iAPos).iTy=this.getfm(s.iAPos).iY,this.getfm(s.iAPos).SetBaseAnima("跑步"),s.iValues[3]=0,s.bActing=!0;break;case 19:s.iValues[1]=0,s.bActing=!0,this.getfm(s.iAPos).iFlying=1;break;case 17:s.iValues[1]=0,s.bActing=!0;break;case 9:this.getfm(s.iAPos).ChangeStatus(s.iValues[0],s.iValues[1]);break;case 24:this.getfm(s.iAPos).bMe&&(xh.me.rbs.iAnger=s.iValues[0]);break;case 12:bs.ne.AddEffect(this.getfm(s.iAPos).iX,this.getfm(s.iAPos).iY-80,s.iValues[0]-this.getfm(s.iAPos).iHp),this.getfm(s.iAPos).iHp=s.iValues[0],this.getfm(s.iAPos).iMp=s.iValues[1],this.getfm(s.iAPos).iHp<0&&(this.getfm(s.iAPos).iHp=0),this.getfm(s.iAPos).iMp<0&&(this.getfm(s.iAPos).iMp=0);break;case 13:this.getfm(s.iAPos).bUseing=!1;break;case 14:(e=this.getfm(s.iAPos)).AddAnima("施法"),0==e.iType||2==e.iType&&1==e.iSpecialType?0==e.iSex?gn.x_wav.StartWav("role0_magic",!1):gn.x_wav.StartWav("role1_magic",!1):(1==e.iType||2==e.iType&&1!=e.iSpecialType)&&gn.x_wav.StartWav_Pet(e.iTid%1e4,1);break;case 26:e=this.getfm(s.iValues[0]),gn.sop("目标:"+s.iValues[0]),cs.fe.AddDarts(this.getfm(s.iAPos).iX,this.getfm(s.iAPos).iY,e.iX,e.iY,s.iValues[1],s.iValues[2]);break;case 27:(e=this.getfm(s.iAPos)).InitSN(s.iValues[0]);break;case 15:e=this.getfm(s.iValues[0]),cs.fe.AddEffect(e.iX,e.iY,s.iValues[1],!(s.iAPos/10<2));break;case 23:e=this.getfm(s.iValues[0]),cs.fe.AddEffect2(e.iX,e.iY,s.iValues[1],s.sValue,!(s.iAPos/10<2));break;case 16:this.iShiQi[0]=s.iValues[0],this.iShiQi[1]=s.iValues[1],this.SwapShiQi();break;case 20:(e=this.getfm(s.iAPos)).iPopoDelay=200,e.sPopoString=s.sValue,es.gi().AddMessage(0,0,e.sName,6,0,s.sValue,null);break;case 22:this.DoUpdate(s.iAPos);break;case 100:for(i=0;i<this.iFDPoint&&(!(s=this.fds[i]).bActing||19!=s.iActType);i++);if(i<this.iFDPoint){h=!0;break}for(this.iFightStat=0,this.iRound++,i=0;i<4;i++)for(t=0;t<xh.MAXTEAMOLE;t++)this.fat[i][t].ActionStatus();this.fat_base[0].ActionStatus(),this.fat_base[1].ActionStatus(),this.bFightFinished&&(this.iFightStat=300,this.iTimeOut=0)}if(h)break;this.iFDPoint++}for(this.iTimeStamp++,i=0;i<this.iFDPoint;i++)if((s=this.fds[i]).bActing)switch(s.iActType){case 0:case 18:s.iValues[1]++,(e=this.getfm(s.iAPos)).iX=e.iOx+(e.iDx-e.iOx)*s.iValues[1]/3,e.iY=e.iOy+(e.iDy-e.iOy)*s.iValues[1]/3,s.iValues[1]>=3&&(s.bActing=!1);break;case 4:t=3-s.iValues[1],(e=this.getfm(s.iAPos)).iX=e.iOx+(e.iX-e.iOx)/t,e.iY=e.iOy+(e.iY-e.iOy)/t,s.iValues[1]++,s.iValues[1]>=3&&(e.iX=e.iOx,e.iY=e.iOy,s.bActing=!1);break;case 8:case 25:if(s.iValues[1]++,s.iValues[1]<10)break;if(t=s.iValues[1]-10,e=this.getfm(s.iAPos),8==s.iActType&&(e.iX=e.iOx+(e.iDx-e.iOx)*t/40,e.iY=e.iOy+(e.iDy-e.iOy)*t/40),25==s.iActType){0==t&&(e.FaceTo(!0),e.SetBaseAnima("战斗站立")),t>0&&(t%2==0?e.FaceTo(!0):e.FaceTo(!1),t>10&&(e.FaceTo(!0),s.bActing=!1),e.SetBaseAnima("战斗站立"));break}t>=40&&(s.bActing=!1,e.bUseing=!1,e.iPos==this.iMyPos&&(this.iFightStat=0,this.bFightFinished&&(this.iFightStat=300,this.iTimeOut=0)));break;case 21:s.iValues[3]++,(e=this.getfm(s.iAPos)).iX=e.iTx+(e.iDx-e.iTx)*s.iValues[3]/s.iValues[1],e.iY=e.iTy+(e.iDy-e.iTy)*s.iValues[3]/s.iValues[1],s.iValues[3]>=s.iValues[2]&&(e.FaceTo(!0),e.SetBaseAnima("战斗站立"),s.bActing=!1);break;case 19:if(0==(e=this.getfm(s.iAPos)).iFlying){s.bActing=!1;break}e.iFlying<10||(10==e.iFlying?(this.getfm(s.iAPos).ianPoint=0,this.getfm(s.iAPos).NextAnima(),this.getfm(s.iAPos).SetBaseAnima("被攻击")):(t=e.iFlying-10,s.iAPos<20?t<8?(e.iX+=30,e.iY-=15):(e.iX-=30,e.iY-=15):t<8?(e.iX-=30,e.iY-=15):(e.iX+=30,e.iY-=15))),e.iY<=0&&(s.bActing=!1,e.bUseing=!1),e.iFlying++;break;case 17:e=this.getfm(s.iAPos),s.iValues[1]>=0&&s.iValues[1]<=3&&(e.iX+=e.iMoveOffX/8),s.iValues[1]>=4&&s.iValues[1]<=7&&(e.iX-=e.iMoveOffX/8),s.iValues[1]++,s.iValues[1]>8&&(e.iX=e.iOx,s.bActing=!1)}}getfightdata(i){i.bCompress=!0;var t,s=0,e=i.GetNextByte();for(gn.sop("Fight Data Length : "+i.iLength);101!=e;){switch(e=this.SwapPos(e),this.fds[s].bActing=!1,this.fds[s].iAPos=e,t=i.GetNextByte(),this.fds[s].iTimeStamp=t<0?256+t:t,this.fds[s].iActType=i.GetNextByte(),gn.sop("iActType="+this.fds[s].iActType+"stamp="+this.fds[s].iTimeStamp),this.fds[s].iActType){case 5:this.fds[s].iAPos=this.SwapPos(e);break;case 0:case 18:this.fds[s].iValues[0]=i.GetNextByte(),this.fds[s].iValues[0]=this.SwapPos(this.fds[s].iValues[0]);break;case 7:this.fds[s].iValues[0]=i.GetNextByte();break;case 9:this.fds[s].iValues[0]=i.GetNextByte(),this.fds[s].iValues[1]=i.GetNextByte();break;case 24:this.fds[s].iValues[0]=i.GetNextShort();break;case 12:case 16:this.fds[s].iValues[0]=i.GetNextShort(),this.fds[s].iValues[1]=i.GetNextShort();break;case 15:this.fds[s].iValues[0]=i.GetNextByte(),this.fds[s].iValues[0]=this.SwapPos(this.fds[s].iValues[0]),this.fds[s].iValues[1]=i.GetNextShort();break;case 20:this.fds[s].sValue=i.GetNextString();break;case 21:this.fds[s].iValues[0]=i.GetNextByte(),this.fds[s].iValues[0]=this.SwapPos(this.fds[s].iValues[0]),this.fds[s].iValues[1]=i.GetNextByte(),this.fds[s].iValues[2]=i.GetNextByte();break;case 22:break;case 23:this.fds[s].iValues[0]=i.GetNextByte(),this.fds[s].iValues[0]=this.SwapPos(this.fds[s].iValues[0]),this.fds[s].iValues[1]=i.GetNextShort(),this.fds[s].sValue=i.GetNextString();break;case 26:this.fds[s].iValues[0]=i.GetNextByte(),this.fds[s].iValues[0]=this.SwapPos(this.fds[s].iValues[0]),this.fds[s].iValues[1]=i.GetNextByte(),this.fds[s].iValues[2]=i.GetNextByte();break;case 27:this.fds[s].iValues[0]=i.GetNextShort()}s++,e=i.GetNextByte()}this.iFDPoint=0,this.iFDCount=s,this.iFightStat=200,this.iTimeStamp=0,this.iDelay=0,this.iWaited=0,i.bCompress=!1}getfightflag(i){var t,s,e,h;if(!(this.iFightStat>100)){for(t=0;t<4;t++)for(s=0;s<5;s++)this.fat[t][s].bActed=!1;for(t=0;t<4;t++)for(h=t,this.bSwap&&(h=h<2?t+2:t-2),s=i.GetNextByte(),e=0;e<5;e++)0!=(s&1<<e)&&(this.fat[h][e].bActed=!0)}}}ws.FIGHTWITH_DARK=1,ws.FIGHTWITH_USER=2,ws.FIGHTWITH_NPC=3,ws.FIGHTWITH_SPECIAL=4,ws.zhenpos=[[[0,0],[0,0],[0,0],[0,0],[0,0]],[[0,0],[0,0],[0,0],[0,0],[0,0]],[[0,-1],[0,1],[0,1],[0,1],[0,1]],[[0,0],[0,0],[0,0],[0,0],[0,0]],[[0,-1],[0,-1],[0,-1],[0,1],[0,1]],[[0,0],[0,0],[0,0],[0,0],[0,0]],[[0,1],[0,-1],[0,-1],[0,1],[0,1]],[[0,0],[0,0],[0,0],[0,0],[0,0]],[[0,-1],[0,1],[0,1],[0,-1],[0,-1]],[[0,0],[0,0],[0,0],[0,0],[0,0]],[[0,-2],[0,1],[0,1],[-1,-2],[1,-2]],[[0,0],[0,0],[0,0],[0,0],[0,0]]],ws.basepos=[[[0,0],[1,0],[-1,0],[2,0],[-2,0]],[[0,1],[1,1],[-1,1],[2,1],[-2,1]]],ws.bFighting=!1,ws.ft=null,ws.gi=function(){return null==ws.ft&&(ws.ft=new ws),ws.ft};class xs{constructor(){this.iStat=0}bNearToNpc(i){var t=gn.de_npc.fdata(i);if(null==t)return!1;var s=t.intValue(4),e=t.intValue(5),h=t.intValue(6);return!(s!=Ih.gi().iCurrentMapId||!Ye.bInCircle(xh.me.iX,xh.me.iY,e,h,60))}StartJQ(i){this.iStat=i,this.iProc=0,this.iGoToNpc=0,this.sGoToDetail="",this.iTalkNpc=0,this.iTalkDelay=0,this.iFightId=0,this.iCSID=0}JQLogic(){switch(this.iStat){case 0:56!=Ih.gi().iCurrentMapId||this.bJQ1Finished||this.StartJQ(1);break;case 1:this.JQProc1(),this.JQDraw1();break;case 2:var i,t,s;this.iProc<(h.SCRW-1100)/2&&(this.iProc=(h.SCRW-1100)/2),this.iProc<h.SCRW+255?(i=255,t=101):(s=this.iProc-h.SCRW-255)<255?(i=255-s,t=100-100*s/255):(i=0,t=0),c.gi().FillRect_2D(0,0,h.SCRW,h.SCRH,i<<24),this.iProc<h.SCRW&&c.gi().SetViewClip(0,0,this.iProc,h.SCRH),gn.xani_other.DrawAnimaEx((h.SCRW-1100)/2,(h.SCRH-54)/2,"首次登陆黑屏提示语",0,t,1,1,0,0,0),this.iProc<h.SCRW&&c.gi().NoClip(),c.gi().DrawTextEx(h.SCRW-20,5,"点击屏幕继续 》",4285443272,30,101,1,1,0,-3,0),this.iProc+=10,this.iProc>=h.SCRW+255+255&&(this.iProc=h.SCRW,this.iStat=0)}}JQDraw1(){0!=this.iStat&&(gn.xani_nui4.DrawAnimaEx(0,-100,"阴影",1,101,1*h.SCRW/20,1,0,0,0),gn.xani_nui4.DrawAnimaEx(0,h.SCRH+100+100,"阴影",0,101,1*h.SCRW/20,1,0,0,0),1==Ih.gi().iCurrentMapId&&(this.iStat=0),this.iTalkNpc>0&&c.gi().DrawTextEx(h.SCRW-20,5,"点击屏幕跳过对话 》",4285443272,30,101,1,1,0,-3,0),this.iGoToNpc>0&&this.sGoToDetail.length>0&&c.gi().DrawTextEx(h.SCRW/2,5,this.sGoToDetail,4291359731,28,101,1,1,0,-2,0))}ProcTouch(i,t,s){return 0!=this.iStat&&(3==i&&(this.iTalkNpc>0&&(500==this.iTalkNpc?xh.me.iPopoDelay=0:Ih.gi().vbk._npctalk(0,this.iTalkNpc,"",0),this.iTalkNpc=0,this.iTalkDelay=0),2==this.iStat&&(this.iProc<h.SCRW?this.iProc=h.SCRW:this.iProc=2*h.SCRW)),!0)}bJQLock(){return 0!=this.iStat}JQProc1(){if(this.iGoToNpc>0)this.bNearToNpc(this.iGoToNpc)&&(this.iGoToNpc=0);else{if(this.iTalkNpc>0){if(this.iTalkDelay--,!(this.iTalkDelay<=0))return;this.iTalkNpc=0,this.iTalkDelay=0}if(this.iFightId>0)return ws.bFighting&&0==this.iFightStat&&(this.iFightStat=1),void(ws.bFighting||1!=this.iFightStat||(this.iFightId=0));if(this.iCSID>0)this.iNowMap!=Ih.gi().iCurrentMapId&&(this.iCSID=0);else if("start"==xs.JQ1[this.iProc][0])this.iProc++;else if("end"==xs.JQ1[this.iProc][0])this.iStat=0,this.bJQ1Finished=!0;else if("gotonpc"==xs.JQ1[this.iProc][0])this.iGoToNpc=parseInt(xs.JQ1[this.iProc][1]),Ue.gi().FindNpc(this.iGoToNpc,!1,!1),xs.JQ1[this.iProc].length>2?this.sGoToDetail=xs.JQ1[this.iProc][2]:this.sGoToDetail="",this.iProc++;else if("talk"==xs.JQ1[this.iProc][0]){this.iTalkNpc=parseInt(xs.JQ1[this.iProc][1]);var i=xs.JQ1[this.iProc][2];xs.JQ1[this.iProc].length>3&&1==xh.me.iSex&&(i=xs.JQ1[this.iProc][3]),500==this.iTalkNpc?(xh.me.sPopoString=i,xh.me.iPopoDelay=100):Ih.gi().vbk._npctalk(0,this.iTalkNpc,i,100),this.iTalkDelay=98,this.iProc++}else"fight"==xs.JQ1[this.iProc][0]?(this.iFightId=parseInt(xs.JQ1[this.iProc][1]),Mh.gi().s_SeverEvent(24,0,this.iFightId,0,0),this.iFightStat=0,this.iProc++):"cs"==xs.JQ1[this.iProc][0]?(this.iNowMap=Ih.gi().iCurrentMapId,this.iCSID=parseInt(xs.JQ1[this.iProc][1]),Mh.gi().s_ChangeMapNew(2,this.iCSID),this.iProc++):"special"==xs.JQ1[this.iProc][0]&&(this.DoSpecial(parseInt(xs.JQ1[this.iProc][1])),this.iProc++)}}DoSpecial(i){switch(i){case 1:this.DoSpecial1()}}DoSpecial1(){var i;xh.me.iDx=xh.me.iSx+1,xh.me.iDy=xh.me.iSy-1,xh.me.FaceTo(),xh.me.bfc4=!1,xh.me.bfc6=!1,xh.me.bfc8=!1,gn.xani_newrole[0].InitAnimaWithName("站立_右上",xh.me.aa_body),xh.me.iWeapTid=291,xh.me.aa_weapon=Qt.ResetWeapon(xh.me.iWeapTid,0,"站立_右上",xh.me.aa_weapon),this.pnpc1=Ye.pvb.AddVoidNpc(),this.pnpc1.bCurrentBlock=!0,this.pnpc1.iNpcId=1,this.pnpc1.iSid=0,this.pnpc1.iX=831,this.pnpc1.iY=1007,this.pnpc1.iDx=this.pnpc1.iX,this.pnpc1.iDy=this.pnpc1.iY,this.pnpc1.sNpcName="猪妖",this.pnpc1.iAnimaType=200003,this.pnpc1.sAniName="站立_右下",this.pnpc1.iR=30,this.pnpc1.iStandFlag=-1,this.pnpc1.iWeapId=this.pnpc1.iAnimaType%1e4,i=this.pnpc1.iAnimaType/1e4%10,gn.xani_pets[this.pnpc1.iWeapId].InitAnimaWithName((0==i?"":"变异_")+this.pnpc1.sAniName,this.pnpc1.aa_body),this.pnpc2=Ye.pvb.AddVoidNpc(),this.pnpc2.bCurrentBlock=!0,this.pnpc2.iNpcId=2,this.pnpc2.iSid=0,this.pnpc2.iX=1109,this.pnpc2.iY=987,this.pnpc2.iDx=this.pnpc2.iX,this.pnpc2.iDy=this.pnpc2.iY,this.pnpc2.sNpcName="秦雪涧",this.pnpc2.iAnimaType=100291,this.pnpc2.sAniName="站立_上",this.pnpc2.iR=30,this.pnpc2.iStandFlag=-1,this.pnpc2.iWeapId=291,gn.xani_newrole[0].InitAnimaWithName(this.pnpc2.sAniName,this.pnpc2.aa_body),this.pnpc2.iWeapId>0&&Qt.ResetWeapon(this.pnpc2.iWeapId,0,this.pnpc2.sAniName,this.pnpc2.aa_weapon),this.pnpc3=Ye.pvb.AddVoidNpc(),this.pnpc3.bCurrentBlock=!0,this.pnpc3.iNpcId=2,this.pnpc3.iSid=0,this.pnpc3.iX=1234,this.pnpc3.iY=985,this.pnpc3.iDx=this.pnpc3.iX,this.pnpc3.iDy=this.pnpc3.iY,this.pnpc3.sNpcName="沈无名",this.pnpc3.iAnimaType=150295,this.pnpc3.sAniName="站立_左上",this.pnpc3.iR=30,this.pnpc3.iStandFlag=-1,this.pnpc3.iWeapId=295,gn.xani_newrole[5].InitAnimaWithName(this.pnpc3.sAniName,this.pnpc3.aa_body),this.pnpc3.iWeapId>0&&Qt.ResetWeapon(this.pnpc3.iWeapId,1,this.pnpc3.sAniName,this.pnpc3.aa_weapon),this.pnpc4=Ye.pvb.AddVoidNpc(),this.pnpc4.bCurrentBlock=!0,this.pnpc4.iNpcId=2,this.pnpc4.iSid=0,this.pnpc4.iX=1300,this.pnpc4.iY=898,this.pnpc4.iDx=this.pnpc4.iX,this.pnpc4.iDy=this.pnpc4.iY,this.pnpc4.sNpcName="王沐风",this.pnpc4.iAnimaType=130293,this.pnpc4.sAniName="站立_左",this.pnpc4.iR=30,this.pnpc4.iStandFlag=-1,this.pnpc4.iWeapId=293,gn.xani_newrole[3].InitAnimaWithName(this.pnpc4.sAniName,this.pnpc4.aa_body),this.pnpc4.iWeapId>0&&Qt.ResetWeapon(this.pnpc4.iWeapId,1,this.pnpc4.sAniName,this.pnpc4.aa_weapon)}}xs.JQ1=[["start"],["special","1"],["end"],["gotonpc","84"],["talk","84","看你这迷茫的小眼神，真让人心疼！"],["talk","500","你是谁？这里是哪里？我的心为何这般痛！"],["talk","84","因为死亡都无法令你忘怀的那个人曾经就在这里等你，爱情本来就是最伤人的东西！"],["talk","500","不！爱情是这世上最美妙的，你是无论如何都不能理解的！"],["talk","84","那么你还坚持宁可经受一季冰寒，再忍一季炙烤，宁可忘记自己也要记住那个人么？"],["talk","500","我意已决，绝不更改！"],["gotonpc","85","要经受转生的煎熬，只为能记住那个心跳，去桃花岛岛主那里渡过劫难！"],["talk","85","如果你的爱不够真挚，你会元神幻灭，魂飞魄散！你要三思！"],["talk","500","这世上没有他活着可笑，来吧！","这世上没有她活着可笑，来吧！"],["talk","85","我敬你重情义，但是我并不会手下留情，接受考验吧！"],["fight","1"],["talk","85","你有姐妹厚意，更有英雄情深！感情真挚日月可鉴，现在我为你转生，重新开始新的生命旅程吧！","你有兄弟厚意，更有佳人情深！感情真挚日月可鉴，现在我为你转生，重新开始新的生命旅程吧！"],["cs","96"],["end"]],xs.jq=new xs;class Ss{constructor(){this.iW=300,this.iH=200,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.pm3f=c.xm3f,this.bShow=!1}Open(i){this.sDetail=i,this.bShow=!0,this.iW=512,this.iH=195,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2+40,this.bLock=!0,this.iot=gn.iNowMillis}Draw(){this.bShow&&(xs.jq.bJQLock()?this.iot=gn.iNowMillis:(gn.xani_other.DrawAnima(this.iX,this.iY,"欢迎框",0),gn.xani_other.DrawAnima(this.iX,this.iY,"欢迎仙女",0),Y.gi().FormatEx("#cd1ecf5"+this.sDetail,300,25,1,4278190080,40),Y.gi().Draw(this.iX+180,this.iY+40),gn.iNowMillis-this.iot>5e3&&(this.bShow=!1)))}ProcTouch(i,t,s){return!xs.jq.bJQLock()&&(!!this.bShow&&(1==i&&(this.bLock=!1),3!=i||this.bLock||gn.iNowMillis-this.iot>1e3&&(this.bShow=!1),!0))}}Ss.fm=new Ss;class Ds extends s{constructor(i){var t;for(super(),this.pani=i,this.pm3f=c.gi(),Ds.iW=950,Ds.iH=475,Ds.iX=(h.SCRW-Ds.iW)/2,Ds.iY=(h.SCRH-Ds.iH)/2,this.btn_close=new D(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(Ds.iX+Ds.iW-35,Ds.iY-25,60,60),this.btn_goods=new Array(8),this.gmake=new Array(8),this.igsub=new Array(8),t=0;t<8;t++)this.btn_goods[t]=new D(gn.xani_ui),this.btn_goods[t].InitButton("物品格"),this.gmake[t]=null,this.igsub[t]=1;this.btn_goods[0].Move(Ds.iX+5+60,Ds.iY+80,80,80),this.btn_goods[1].Move(Ds.iX+5+60+125,Ds.iY+80,80,80),this.btn_goods[2].Move(Ds.iX+5+60+250,Ds.iY+80,80,80),this.btn_goods[3].Move(Ds.iX+5+60,Ds.iY+180,80,80),this.btn_goods[4].Move(Ds.iX+5+60+125,Ds.iY+180,80,80),this.btn_goods[5].Move(Ds.iX+5+60+250,Ds.iY+180,80,80),this.btn_make=new Eh(gn.xani_nui2),this.btn_make.InitButton("按钮1_110"),this.btn_make.sName="制造",this.btn_make.Move(Ds.iX+260,Ds.iY+Ds.iH-50-40,70,40)}Draw(){var i,t,s;for(E.new_baseframe2(Ds.iX,Ds.iY,Ds.iW,Ds.iH,"打","造"),this.btn_close.Draw(),gn.xani_nui3.DrawAnima(Ds.iX+230,Ds.iY+200,"炼丹炉背景",0),t=Ds.iX+Ds.iW-30-430-40,s=Ds.iY+30,E.new_framein(t,s,470,Ds.iH-60),c.gi().DrawTextEx(t+20,s+20,"双击选择装备制造图纸：",4278206039,30,101,1,1,0,0,0),Ds.iGx=t+20,Ds.iGy=s+20+30,qi.new_DrawGoods(Ds.iGx,Ds.iGy,ht.gi().goods[2],this.gmake,this.igsub),null!=this.lockgoods&&qi.new_DrawRect(Ds.iGx,Ds.iGy,ht.gi().goods[2],this.lockgoods,0),i=0;i<6;i++)gn.xani_nui3.DrawAnima(this.btn_goods[i].iX,this.btn_goods[i].iY,"物品格子",0),null!=this.gmake[i]&&qi.new_DrawOneGoods_ext(this.btn_goods[i].iX,this.btn_goods[i].iY,this.gmake[i],1);s=Ds.iY+Ds.iH-30-160,E.new_framein(Ds.iX+30,s,400,160);var e="#c003e57"+this.Check();Y.gi().FormatEx(e,360,25,0,0,30),Y.gi().Draw(Ds.iX+30+20,s+20),Ds.bCanMake&&(this.btn_make.Move(Ds.iX+30+400-20-110,s+160-20-52,110,52),this.btn_make.Draw()),qi.bShowDetail()&&qi.new_DrawDetail(null,-1,-1,0)}Check(){var i,t,s,e,h,a,n="#c003e57";if(Ds.bCanMake=!1,null==this.gmake[0])return"请先放入装备制造图纸";if(h=gn.de_goods.intValue(this.gmake[0].iAtts[0],-1,16),a=gn.de_goods.intValue(this.gmake[0].iAtts[0],-1,9),-1==h||-1==a)return"数据错误1";if(null!=this.gmake[1]&&382==this.gmake[1].iTid);else if(0==h||4==h){if(null==this.gmake[1]||98!=this.gmake[1].iTid)return"需要放入锻造手艺";if(this.gmake[1].iAtts[0]<a)return"锻造手艺等级不够"}else if(1==h||2==h){if(null==this.gmake[1]||99!=this.gmake[1].iTid)return"需要放入冶金手艺";if(this.gmake[1].iAtts[0]<a)return"冶金手艺等级不够"}else{if(3!=h&&5!=h)return"数据错误2";if(null==this.gmake[1]||100!=this.gmake[1].iTid)return"需要放入剪裁手艺";if(this.gmake[1].iAtts[0]<a)return"剪裁手艺等级不够"}for(e=0,i=1;i<4&&!((t=this.gmake[0].iAtts[i])<=0);i++){for(s=3;s<6&&(null==this.gmake[s]||this.gmake[s].iTid!=t);s++);s>=6&&(n=n+"需要放入材料："+gn.de_goods.strValue(t,-1,4)+"#e",e++)}return e>0?n:(n=null!=this.gmake[2]?"#e至少获得一项附加属性":"#e#cff0000放入幸运符可附加属性",Ds.bCanMake=!0,"#c00ff00材料齐备"+n)}ProcTouch(i,t,s){var e,h,a,n;if(Ds.bCanMake&&this.btn_make.ProcTouch(i,t,s)&&this.btn_make.bCheck()){var o=[0,0,0,0,0,0,0,0];for(e=0;e<8;e++)null!=this.gmake[e]&&(o[e]=this.gmake[e].iGid,(h=gn.de_goods.intValue(this.gmake[e].iTid,0,28))>1?(this.gmake[e].iCount--,this.gmake[e].iCount<=0&&(this.gmake[e].iGid=-1)):this.gmake[e].iGid=-1,this.gmake[e]=null);Mh.gi().s_UseSkill(4,o[0],o[1],o[2],o[3],o[4],o[5])}if(this.btn_close.ProcTouch(i,t,s))return this.btn_close.bCheck()&&ln.gi().PopStat(1),!0;if(this.lockgoods=qi.new_LockGoods(t,s,Ds.iGx,Ds.iGy,ht.gi().goods[2],i),3==i&&null!=this.lockgoods&&qi.bCanProc()){if(97==this.lockgoods.iTid){for(this.gmake[0]=this.lockgoods,h=2==(e=gn.de_goods.intValue(this.lockgoods.iAtts[0],0,16))||1==e?99:3==e||5==e?100:0==e||4==e?98:-1,a=0;a<20;a++)if(ht.gi().goods[2][a].iGid>0&&ht.gi().goods[2][a].iTid==h){this.gmake[1]=ht.gi().goods[2][a];break}for(a=0;a<20;a++)if(ht.gi().goods[2][a].iGid>0&&108==ht.gi().goods[2][a].iTid){this.gmake[2]=ht.gi().goods[2][a];break}for(n=3,e=1;e<4;e++)if((h=this.lockgoods.iAtts[e])>0)for(a=0;a<20;a++)if(ht.gi().goods[2][a].iGid>0&&ht.gi().goods[2][a].iTid==h){this.gmake[n++]=ht.gi().goods[2][a];break}}if(98!=this.lockgoods.iTid&&99!=this.lockgoods.iTid&&100!=this.lockgoods.iTid&&382!=this.lockgoods.iTid||(this.gmake[1]=this.lockgoods),108==this.lockgoods.iTid&&(this.gmake[2]=this.lockgoods),-1!=gn.de_goods.intValue(this.lockgoods.iTid,-1,31))for(e=3;e<6;e++)if(null==this.gmake[e]){this.gmake[e]=this.lockgoods;break}this.lockgoods=null}for(e=0;e<6;e++)this.btn_goods[e].ProcTouch(i,t,s)&&this.btn_goods[e].bCheck()&&(this.gmake[e]=null);return!1}}Ds.iX,Ds.iY,Ds.iW,Ds.iH,Ds.iGx,Ds.iGy,Ds.bCanMake;class Ts extends s{constructor(i){var t;for(super(),this.pani=i,this.pm3f=i.pm3f,this.iW=950,this.iH=475,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_goods=new Array(8),this.gmake=new Array(8),this.igsub=new Array(8),t=0;t<8;t++)this.btn_goods[t]=new D(gn.xani_nui3),this.btn_goods[t].InitButton("物品格子"),this.gmake[t]=null,this.igsub[t]=1;this.btn_goods[0].Move(this.iX+30+200-40,this.iY+120-60,80,80),this.btn_goods[1].Move(this.iX+30+200-40,this.iY+120+60,80,80),this.btn_goods[2].Move(this.iX+30+200-40-100,this.iY+120-80,80,80),this.btn_goods[3].Move(this.iX+30+200-40+100,this.iY+120-80,80,80),this.btn_goods[4].Move(this.iX+30+200-40-100,this.iY+120+80,80,80),this.btn_goods[5].Move(this.iX+30+200-40+100,this.iY+120+80,80,80),this.btn_make=new Eh(gn.xani_nui2),this.btn_make.InitButton("按钮1_110"),this.btn_make.sName="炼药",this.btn_close=new D(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60)}Draw(){var i,t,s;for(E.new_baseframe2(this.iX,this.iY,this.iW,this.iH,"炼","丹"),this.btn_close.Draw(),gn.xani_nui3.DrawAnima(this.iX+230,this.iY+200,"炼丹炉背景",0),t=this.iX+this.iW-30-430-40,s=this.iY+30,E.new_framein(t,s,470,this.iH-60),c.gi().DrawTextEx(t+20,s+20,"双击选择丹方：",4278206039,30,101,1,1,0,0,0),this.iGx=t+20,this.iGy=s+20+30,qi.new_DrawGoods(this.iGx,this.iGy,ht.gi().goods[2],this.gmake,this.igsub),null!=this.lockgoods&&qi.new_DrawRect(this.iGx,this.iGy,ht.gi().goods[2],this.lockgoods,0),i=0;i<6;i++)this.btn_goods[i].Draw(),null!=this.gmake[i]&&qi.new_DrawOneGoods_ext(this.btn_goods[i].iX,this.btn_goods[i].iY,this.gmake[i],1);s=this.iY+this.iH-30-160,E.new_framein(this.iX+30,s,400,160);var e=this.Check();Y.gi().FormatEx(e,360,25,0,0,30),Y.gi().Draw(this.iX+30+20,s+20),gn.sop("aaa="+e),this.bCanMake&&(this.btn_make.Move(this.iX+30+400-20-110,s+160-20-52,110,52),this.btn_make.Draw()),qi.bShowDetail()&&qi.new_DrawDetail(null,-1,-1,0)}Check(){var i,t,s,e,h=[0,0,0,0,0,0,0,0,0,0],a="#c003e57";if(this.bCanMake=!1,null==this.gmake[0])return"请先放入丹方";for(e=0,i=3;i<7&&!((t=this.gmake[0].iAtts[i])<=0);i++){for(s=2;s<6;s++)if(null!=this.gmake[s]&&this.gmake[s].iTid==t&&0==h[s]){h[s]=1;break}s>=6&&(a=a+"缺少草药："+gn.de_goods.strValue(t,-1,4)+"#e",e++)}return e>0?a:(i=60,a="#e炼药成功率"+(i=195==this.gmake[0].iTid?60:328==this.gmake[0].iTid?50:329==this.gmake[0].iTid?40:330==this.gmake[0].iTid?10:5)+"%",null!=this.gmake[1]&&this.gmake[1].iGid>0&&(a+="#e炼丹炉提高成功率"+this.gmake[1].iAtts[3]+"%"),Fi.mg.iZhuQueLev>0&&(i=Fi.mg.iZhuQueLev/5,a+="#e朱雀堂提高成功率"+(i*=5)/10+"."+i%10+"%"),this.bCanMake=!0,"#c00ff00材料齐备"+a)}ProcTouch(i,t,s){var e,h,a,n;if(this.bCanMake&&this.btn_make.ProcTouch(i,t,s)&&this.btn_make.bCheck()){var o=[0,0,0,0,0,0,0,0];for(e=0;e<8;e++)null!=this.gmake[e]&&(o[e]=this.gmake[e].iGid,(h=gn.de_goods.intValue(this.gmake[e].iTid,0,28))>1?(this.gmake[e].iCount--,this.gmake[e].iCount<=0&&(this.gmake[e].iGid=-1)):this.gmake[e].iGid=-1,this.gmake[e]=null);Mh.gi().s_UseSkill(8,o[0],o[1],o[2],o[3],o[4],o[5])}if(this.btn_close.ProcTouch(i,t,s))return this.btn_close.bCheck()&&ln.gi().PopStat(1),!0;if(this.lockgoods=qi.new_LockGoods(t,s,this.iGx,this.iGy,ht.gi().goods[2],i),3==i&&null!=this.lockgoods&&qi.bCanProc()){if(h=gn.de_goods.intValue(this.lockgoods.iTid,-1,27),195==this.lockgoods.iTid||328==this.lockgoods.iTid||329==this.lockgoods.iTid||330==this.lockgoods.iTid||331==this.lockgoods.iTid){for(this.gmake[0]=this.lockgoods,n=2,e=3;e<7;e++)if((h=this.lockgoods.iAtts[e])>0)for(a=0;a<20;a++)if(ht.gi().goods[2][a].iGid>0&&ht.gi().goods[2][a].iTid==h){this.gmake[n++]=ht.gi().goods[2][a];break}}else if(this.lockgoods.iTid>=342&&this.lockgoods.iTid<=343)this.gmake[1]=this.lockgoods;else if(-1!=h||this.lockgoods.iTid>=337&&this.lockgoods.iTid<=341){for(e=2;e<6;e++)if(null==this.gmake[e]){this.gmake[e]=this.lockgoods;break}}else L.easymsg.AddMessage("请选择丹方");this.lockgoods=null}for(e=0;e<6;e++)this.btn_goods[e].ProcTouch(i,t,s)&&this.btn_goods[e].bCheck()&&(this.gmake[e]=null);return!1}AutoPutGoods(i){var t,s,e,h;for(h=2,t=3;t<7;t++)if((s=i.iAtts[t])>0)for(e=0;e<20;e++)if(ht.gi().goods[2][e].iGid>0&&ht.gi().goods[2][e].iTid==s){this.gmake[h++]=ht.gi().goods[2][e];break}}}Ts.Open=function(i,t){var s=ln.gi().PushStat(ln.GS_LIANDANSHU);s.gmake[0]=i,s.gmake[1]=t,null!=i&&s.AutoPutGoods(i),Mh.gi().s_NewGovOperate(22,0,0,0,0,"")};class Cs extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=910,this.iH=610,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_dundi=new D(gn.xani_nicon),this.btn_dundi.InitButton("遁地术"),this.btn_dundi.Move(h.SCRW,h.SCRH,1,1),this.btn_duanzao=new D(gn.xani_nicon),this.btn_duanzao.InitButton("锻造"),this.btn_duanzao.Move(h.SCRW,h.SCRH,1,1),this.btn_yejin=new D(gn.xani_nicon),this.btn_yejin.InitButton("冶金"),this.btn_yejin.Move(h.SCRW,h.SCRH,1,1),this.btn_jiancai=new D(gn.xani_nicon),this.btn_jiancai.InitButton("剪裁"),this.btn_jiancai.Move(h.SCRW,h.SCRH,1,1),this.btn_zhiyao=new D(gn.xani_nicon),this.btn_zhiyao.InitButton("炼丹术"),this.btn_zhiyao.Move(h.SCRW,h.SCRH,1,1),this.btn_pengren=new D(gn.xani_nicon),this.btn_pengren.InitButton("烹饪"),this.btn_pengren.Move(h.SCRW,h.SCRH,1,1);var t=120,s=245;this.btn_vip=new Eh(gn.xani_nui2),this.btn_vip.InitButton("按钮3"),this.btn_vip.sName="开通会员",this.btn_vip.Move(this.iX+this.iW-t-60,this.iY+s-66,141,49),this.btn_vip.iNameSize=25,this.btn_sell=new Eh(gn.xani_nui2),this.btn_sell.InitButton("按钮4"),this.btn_sell.sName="摆    摊",this.btn_sell.Move(this.iX+this.iW-t-60,this.iY+s,141,49),this.btn_sell.iNameSize=25,this.btn_find=new Eh(gn.xani_nui2),this.btn_find.InitButton("按钮4"),this.btn_find.sName="查找好友",this.btn_find.Move(this.iX+this.iW-t-60,this.iY+s+66,141,49),this.btn_find.iNameSize=25,this.btn_restore=new Eh(gn.xani_nui2),this.btn_restore.InitButton("按钮4"),this.btn_restore.sName="快捷恢复",this.btn_restore.Move(this.iX+this.iW-t-60,this.iY+s+132,141,49),this.btn_restore.iNameSize=25,this.btn_dark=new Eh(gn.xani_nui2),this.btn_dark.InitButton("按钮4"),xh.me.bDark?this.btn_dark.sName="遇怪:开":this.btn_dark.sName="遇怪:关",this.btn_dark.Move(this.iX+this.iW-t-60,this.iY+s+198,141,49),this.btn_dark.iNameSize=25,this.btn_pk=new Eh(gn.xani_nui2),this.btn_pk.InitButton("按钮4"),xh.me.bPk?this.btn_pk.sName="对战:开":this.btn_pk.sName="对战:关",this.btn_pk.Move(this.iX+this.iW-t-60,this.iY+s+264,141,49),this.btn_pk.iNameSize=25,this.bLockStatus=!1,this.iStatusOffY=0}Draw(){var i,t,s,e,h,a;if(E.new_baseframe2(this.iX,this.iY,this.iW,this.iH,"快","捷"),s=this.iX+30,e=this.iY+30,h=670,a=285,E.new_framein(s,e,h,a),e=e+a+15,a=250,E.new_framein(s,e,h,a),s=s+h+15,e=this.iY+30,h=170,a=550,E.new_framein(s,e,h,a),this.btn_close.Draw(),s=this.iX+10+20,e=this.iY+65+20,this.Draw_Skill(s,e),this.btn_vip.Draw(),this.btn_sell.Draw(),this.btn_find.Draw(),this.btn_restore.Draw(),this.btn_dark.Draw(),this.btn_pk.Draw(),s=this.iX+30,e=this.iY+330,h=670,a=250,c.gi().SetViewClip(s+20,e+20,s+h-20,e+a-20),i=0,xh.me.bStandIn&&this.DrawStatus(i++,"替身状态","开启"),xh.me.bQP&&this.DrawStatus(i++,"强行对战","开启"),xh.me.iFlag[3]>0&&this.DrawStatus(i++,"血池剩余:",""+xh.me.iFlag[3]),xh.me.iFlag[4]>0&&this.DrawStatus(i++,"蓝池剩余:",""+xh.me.iFlag[4]),xh.me.iFlag[28]>0&&(i=this.DrawStatusEx1(i,"临时体质:","\t\t\t\t\t\t\t+"+(xh.me.iFlag[27]>>24&31),xh.me.iFlag[28])),xh.me.iFlag[29]>0&&(i=this.DrawStatusEx1(i,"临时法力:","\t\t\t\t\t\t\t+"+(xh.me.iFlag[27]>>18&31),xh.me.iFlag[29])),xh.me.iFlag[30]>0&&(i=this.DrawStatusEx1(i,"临时力量:","\t\t\t\t\t\t\t+"+(xh.me.iFlag[27]>>12&31),xh.me.iFlag[30])),xh.me.iFlag[31]>0&&(i=this.DrawStatusEx1(i,"临时耐力:","\t\t\t\t\t\t\t+"+(xh.me.iFlag[27]>>6&31),xh.me.iFlag[31])),xh.me.iFlag[32]>0&&(i=this.DrawStatusEx1(i,"临时敏捷:","\t\t\t\t\t\t\t+"+(31&xh.me.iFlag[27]),xh.me.iFlag[32])),xh.me.iFlagExt[1]>0&&(i=this.DrawStatusEx1(i,"临时愤怒:","\t\t\t\t\t\t\t\t\t\t\t\t\t+"+(31&xh.me.iFlagExt[0]),xh.me.iFlagExt[1])),xh.me.iFlagExt[2]>0&&(i=this.DrawStatusEx1(i,"治疗能力:","\t\t\t\t\t\t\t\t\t\t\t\t\t+"+(xh.me.iFlagExt[0]>>6&31)+"%",xh.me.iFlagExt[2])),xh.me.iFlagExt[3]>0&&(i=this.DrawStatusEx1(i,"固定伤害:","\t\t\t\t\t\t\t\t\t\t\t\t\t+"+(xh.me.iFlagExt[0]>>12&31),xh.me.iFlagExt[3])),xh.me.iFlagExt[4]>0&&(i=(t=50+5*(xh.me.iFlagExt[0]>>18&31))%10==0?this.DrawStatusEx1(i,"物法命中","\t\t\t\t\t\t\t\t\t\t\t\t\t+"+Math.floor(t/10)+"%",xh.me.iFlagExt[4]):this.DrawStatusEx1(i,"物法命中","\t\t\t\t\t\t\t\t\t\t\t\t\t+"+Math.floor(t/10)+"."+t%10+"%",xh.me.iFlagExt[4])),xh.me.iFlagExt[5]>0&&(i=(t=10+5*(xh.me.iFlagExt[0]>>24&31))%10==0?this.DrawStatusEx1(i,"物法暴击","\t\t\t\t\t\t\t\t\t\t\t\t\t+"+Math.floor(t/10)+"%",xh.me.iFlagExt[5]):this.DrawStatusEx1(i,"物法暴击","\t\t\t\t\t\t\t\t\t\t\t\t\t+"+Math.floor(t/10)+"."+t%10+"%",xh.me.iFlagExt[5])),xh.me.iFlagExt[7]>0&&(i=this.DrawStatusEx1(i,"人物修炼","\t\t\t\t\t\t\t+"+(31&xh.me.iFlagExt[6]),xh.me.iFlagExt[7])),xh.me.iFlagExt[9]>0&&(i=this.DrawStatusEx1(i,"伤害结果","\t\t\t\t\t\t\t+"+20*(xh.me.iFlagExt[6]>>12&31),xh.me.iFlagExt[9])),xh.me.iFlagExt[10]>0&&(i=this.DrawStatusEx1(i,"宠物属性","\t\t\t\t\t\t\t+"+(xh.me.iFlagExt[6]>>18&31),xh.me.iFlagExt[10])),xh.me.iFlag[5]>0&&(i=this.DrawStatusEx1(i,"双倍时间","",xh.me.iFlag[5])),xh.me.iFlag[34]>0&&(i=this.DrawStatusEx1(i,"三倍时间","",xh.me.iFlag[34])),xh.me.iFlag[22]>0&&(i=this.DrawStatusEx1(i,"双倍体力","",xh.me.iFlag[22])),xh.me.iFlag[23]>0&&(i=this.DrawStatusEx1(i,"自动遇怪","",xh.me.iFlag[23])),xh.me.iChangeType>0)if(xh.me.iChangeLast+xh.me.ltex-bn.get_ms()/1e3<0)xh.me.iChangeType=0;else{if(i=this.DrawStatusEx1(i,"变身状态\t\t\t\t\t\t\t\t\t\t\t\t\t",":"+gn.de_pet.strValue(xh.me.iChangeType%1e4,0,1),xh.me.iChangeLast),xh.me.iChangeSkill>0&&this.DrawStatus(i++,"变身技能\t\t\t\t\t\t\t",gn.de_skill.strValue(xh.me.iChangeSkill,0,6)),xh.me.iChangeAtt>0){t=xh.me.iChangeAtt%1e3-100;this.DrawStatus(i++,"变身属性\t\t\t\t\t\t\t",(t>0?"+"+t:t)+"%"+["气血","灵力","伤害","防御","速度"][Math.floor(xh.me.iChangeAtt/1e3)%10])}this.DrawStatus(i++,"变身对战\t\t\t\t\t\t\t","剩余"+xh.me.iChangeFC+"次")}c.gi().NoClip(),t=(i+1)/2,this.bLockStatus||(this.iStatusOffY<0&&(this.iStatusOffY/=2),(i=36*t-210)<0&&(i=0),this.iStatusOffY>i&&(this.iStatusOffY-=(this.iStatusOffY-i)/2))}DrawStatusEx1(i,t,s,e){var h=e+xh.me.lt1-bn.get_ms()/1e3;return h<0?i:(this.DrawStatus(i++,t,s+"("+Math.floor(h/3600)+":"+Math.floor(h/60%60)+":"+Math.floor(h%60)+")"),i)}DrawStatus(i,t,s){var e,h;e=this.iX+30+i%2*300+50,h=this.iY+330+36*Math.floor(i/2)+10-this.iStatusOffY,E.ui3_Text2_(e,h,110,50,t,s)}Draw_Skill(i,t){var s=i;i+=35,t-=35,gn.xani_nui2.DrawAnima(this.iX+760,this.iY+50,"技能框",0),xh.me.rbs.iSchoolId>0&&(this.btn_dundi.Move(this.iX+760,this.iY+50,80,80),this.btn_dundi.Draw(),c.gi().DrawText_2(this.iX+760+40,this.iY+50+105,"遁地术",4294959296,20,101,1,1,0,-2,-2,3,4278190080)),gn.xani_nui2.DrawAnima(i,t,"技能框",0),xh.me.rbs.iGovSkill[1]>0&&(this.btn_zhiyao.Move(i,t,80,80),this.btn_zhiyao.Draw(),c.gi().DrawText_2(i+40,t+105,gn.de_skill.strValue(e.iGovSkillId[1],0,6)+xh.me.rbs.iGovSkill[1]+"级",4294959296,20,101,1,1,0,-2,-2,3,4278190080)),i+=125,gn.xani_nui2.DrawAnima(i,t,"技能框",0),xh.me.rbs.iGovSkill[2]>0&&(this.btn_pengren.Move(i,t,80,80),this.btn_pengren.Draw(),c.gi().DrawText_2(i+40,t+105,gn.de_skill.strValue(e.iGovSkillId[2],0,6)+xh.me.rbs.iGovSkill[2]+"级",4294959296,20,101,1,1,0,-2,-2,3,4278190080)),i+=125,gn.xani_nui2.DrawAnima(i,t,"技能框",0),xh.me.rbs.iGovSkill[3]>0&&(this.btn_duanzao.Move(i,t,80,80),this.btn_duanzao.Draw(),c.gi().DrawText_2(i+40,t+105,gn.de_skill.strValue(e.iGovSkillId[3],0,6)+xh.me.rbs.iGovSkill[3]+"级",4294959296,20,101,1,1,0,-2,-2,3,4278190080)),i+=125,gn.xani_nui2.DrawAnima(i,t,"技能框",0),xh.me.rbs.iGovSkill[4]>0&&(this.btn_yejin.Move(i,t,80,80),this.btn_yejin.Draw(),c.gi().DrawText_2(i+40,t+105,gn.de_skill.strValue(e.iGovSkillId[4],0,6)+xh.me.rbs.iGovSkill[4]+"级",4294959296,20,101,1,1,0,-2,-2,3,4278190080)),i+=125,gn.xani_nui2.DrawAnima(i,t,"技能框",0),xh.me.rbs.iGovSkill[5]>0&&(this.btn_jiancai.Move(i,t,80,80),this.btn_jiancai.Draw(),c.gi().DrawText_2(i+40,t+105,gn.de_skill.strValue(e.iGovSkillId[5],0,6)+xh.me.rbs.iGovSkill[5]+"级",4294959296,20,101,1,1,0,-2,-2,3,4278190080)),i+=195,i=s+35,t+=135,gn.xani_nui2.DrawAnima(i,t,"技能框",0),i+=125,gn.xani_nui2.DrawAnima(i,t,"技能框",0),i+=125,gn.xani_nui2.DrawAnima(i,t,"技能框",0),i+=125,gn.xani_nui2.DrawAnima(i,t,"技能框",0),i+=125}ProcTouch(i,t,s){var e,h,a;if(h=this.iX+30,a=this.iY+330,670,250,this.bLockStatus&&(2==i&&(this.iStatusOffY+=this.iLockY-s,this.iLockY=s),3==i&&(this.bLockStatus=!1)),bn.bInRect(t,s,h,a,670,250)&&1==i&&(this.bLockStatus=!0,this.iLockY=s),xh.me.rbs.iSchoolId>0&&this.btn_dundi.ProcTouch(i,t,s)&&this.btn_dundi.bCheck()&&(H.bNoTeam()||H.bAway()?xh.me.rbs.iSchoolId>0&&(Mh.gi().s_UseSkill(0,0,0,0,0,0,0),ln.gi().PopStat(1),Ih.gi().iMapChangeing=100,Us.m.bCheckDoing(143)&&Mh.gi().s_FinishMission(0,143,0,0)):L.easymsg.AddMessage("队伍中不能使用遁地术")),xh.me.rbs.iGovSkill[1]>0&&this.btn_zhiyao.ProcTouch(i,t,s))return this.btn_zhiyao.bCheck()&&(ln.gi().PopStat(1),Ts.Open(null,null)),!0;if(xh.me.rbs.iGovSkill[2]>0&&this.btn_pengren.ProcTouch(i,t,s))return this.btn_pengren.bCheck()&&(xh.me.rbs.iGovSkill[2]<10?L.easymsg.AddMessage("烹饪技能达到10级才可使用"):xh.me.rbs.iPower<xh.me.rbs.iGovSkill[2]?L.easymsg.AddMessage("体力不足无法烹饪"):Mh.gi().s_UseSkill(9,0,0,0,0,0,0)),!0;if(xh.me.rbs.iGovSkill[3]>0&&this.btn_duanzao.ProcTouch(i,t,s)&&this.btn_duanzao.bCheck()&&Mh.gi().s_UseSkill(1,0,0,0,0,0,0),xh.me.rbs.iGovSkill[4]>0&&this.btn_yejin.ProcTouch(i,t,s)&&this.btn_yejin.bCheck()&&Mh.gi().s_UseSkill(2,0,0,0,0,0,0),xh.me.rbs.iGovSkill[5]>0&&this.btn_jiancai.ProcTouch(i,t,s)&&this.btn_jiancai.bCheck()&&Mh.gi().s_UseSkill(3,0,0,0,0,0,0),this.btn_vip.ProcTouch(i,t,s))return this.btn_vip.bCheck()&&(ln.gi().PopStat(1),Yi.Open(3)),!0;if(this.btn_sell.ProcTouch(i,t,s)){if(this.btn_sell.bCheck())if(xh.me.bHaveLock&&xh.me.bLocked)L.easymsg.AddMessage("未解锁不能摆摊");else if(H.bInTeam())L.easymsg.AddMessage("队伍中不能摆摊");else if(xh.me.rbs.iLev<10)L.easymsg.AddMessage("10级以上才能摆摊");else if(ct.gi().bSelling)ct.gi().bShow=!0,ln.gi().PopStat(1);else{for(e=0;e<Ih.gi().vbk.MAXVISUALBLOCK;e++)if(null!=Ih.gi().vbk.vbs[e]){if(!Ih.gi().vbk.vbs[e].bCurrentBlock)continue;if(bn.bInRect(Ih.gi().vbk.vbs[e].iX,Ih.gi().vbk.vbs[e].iY,xh.me.iX-100,xh.me.iY-160,200,200))return L.easymsg.AddMessage("摆摊不能距离NPC太近"),!0}ln.gi().PopStat(1),Mh.gi().s_StartSell(0,0,0,""),xh.me.iFightMid>0&&(xh.me.iFightMid=0,Mh.gi().s_ChangeFightMounts(0)),xh.me.ChangeStat("站立")}return!0}if(this.btn_find.ProcTouch(i,t,s))return this.btn_find.bCheck()&&(ln.gi().PopStat(1),ln.gi().PushStat(ln.GS_FINDFRIEND)),!0;if(this.btn_restore.ProcTouch(i,t,s)){if(this.btn_restore.bCheck()){e=xh.me.rbs.iMaxHp-xh.me.rbs.iHp,e+=2*(xh.me.rbs.iMaxMp-xh.me.rbs.iMp);var n=Bi.mp.GetUseingPet();null!=n&&(e+=n.iMaxHp-n.iHp,e+=n.iMaxMp-n.iMp),Mh.gi().s_UseSkill(7,0,0,0,0,0,0)}return!0}return this.btn_dark.ProcTouch(i,t,s)&&this.btn_dark.bCheck()&&(xh.me.bDark=!xh.me.bDark,xh.me.bDark?(this.btn_dark.sName="遇怪:开",Mh.gi().s_setflag(2,0,0)):(this.btn_dark.sName="遇怪:关",Mh.gi().s_setflag(2,0,1))),this.btn_pk.ProcTouch(i,t,s)&&this.btn_pk.bCheck()&&(xh.me.bPk=!xh.me.bPk,xh.me.bPk?(this.btn_pk.sName="对战:开",Mh.gi().s_setflag(2,1,0)):(this.btn_pk.sName="对战:关",Mh.gi().s_setflag(2,1,1))),!!this.btn_close.ProcTouch(i,t,s)&&(this.btn_close.bCheck()&&ln.gi().PopStat(1),!0)}}class ks extends s{constructor(i){super(),this.iW=650,this.iH=400,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.pc_price=new Array(8),this.btn_price=new Array(8);for(var t=0;t<8;t++)this.btn_price[t]=new Eh(gn.xani_ui),this.btn_price[t].bSingleButton=!0;this.ishowdetail=-1,this.gd=new Li}Draw(){var i,t,s,e,a,n,o;i=this.pc_show.FindClass("详细信息"),E.frame_type4("半透明内容框a50_50",this.iX,this.iY,this.iW,this.iH,50,50),gn.xani_frame.DrawAnima(this.iX+40,this.iY+40,"活跃图标框73_73",0),null==(o=this.pc_show.FindWord("活动名称"))?(gn.xani_icon.DrawAnima_aa(this.iX+40,this.iY+40,this.pc_show.sName,0),c.gi().DrawText_2(this.iX+150,this.iY+55,this.pc_show.sName,4294967040,30,101,1,1,0,0,-2,2,4278190080)):(gn.xani_icon.DrawAnima_aa(this.iX+40,this.iY+40,o.pword,0),c.gi().DrawText_2(this.iX+150,this.iY+55,o.pword,4294967040,30,101,1,1,0,0,-2,2,4278190080));var r=130;if(0==this.iType||1==this.iType){for(c.gi().DrawTextEx(this.iX+150,this.iY+50+40,this.sExtShow,4294967295,20,101,1,1,0,0,-2),c.gi().DrawTextEx(this.iX+40,this.iY+r,"活动时间：",4294967295,20,101,1,1,0,0,0),s=i.FindWord("活动时间"),c.gi().DrawTextEx(this.iX+150,this.iY+r,s.pword,4294967295,20,101,1,1,0,0,0),r+=30,null==(e=i.FindWord("限制单位"))?c.gi().DrawTextEx(this.iX+40,this.iY+r,"等级限制：",4294967295,20,101,1,1,0,0,0):c.gi().DrawTextEx(this.iX+40,this.iY+r,e.pword+"：",4294967295,20,101,1,1,0,0,0),s=i.FindWord("等级限制"),c.gi().DrawTextEx(this.iX+150,this.iY+r,s.pword,4294967295,20,101,1,1,0,0,0),r+=30,c.gi().DrawTextEx(this.iX+40,this.iY+r,"任务形式：",4294967295,20,101,1,1,0,0,0),s=i.FindWord("任务形式"),c.gi().DrawTextEx(this.iX+150,this.iY+r,s.pword,4294967295,20,101,1,1,0,0,0),r+=30,c.gi().DrawTextEx(this.iX+40,this.iY+r,"任务介绍：",4294967295,20,101,1,1,0,0,0),s=i.FindWord("任务介绍"),Y.gi().FormatEx(s.pword,425,20,0,0,25),Y.gi().Draw(this.iX+150,this.iY+r),r+=Y.gi().iH+10,null!=(t=i.FindClass("任务奖励"))?(t=t.pca.phead,c.gi().DrawTextEx(this.iX+40,this.iY+r,"任务奖励：",4294967295,20,101,1,1,0,0,0)):r-=100,this.iPriceCount=0;null!=t;)a=t.FindNumber("物品id"),n=t.FindWord("物品介绍"),gn.xani_nui3.DrawAnima(this.iX+150+100*this.iPriceCount,this.iY+r,"物品格子",0),gn.xani_ngoods.DrawAnima_aa(this.iX+150+100*this.iPriceCount,this.iY+r,gn.de_goods.strValue(a.iNumber,0,10),0),this.pc_price[this.iPriceCount]=t,this.btn_price[this.iPriceCount].Move(this.iX+160+100*this.iPriceCount,this.iY+r,80,80),this.iPriceCount++,t=t.pdown;this.ishowdetail>=0&&(a=this.pc_price[this.ishowdetail].FindNumber("物品id"),null!=(n=this.pc_price[this.ishowdetail].FindWord("物品介绍"))?qi.new_DrawDetailEx1(a.iNumber,this.iX+150+100*this.ishowdetail,this.iY+r,n.pword):(this.gd.SetAtt(0,a.iNumber,1,0,0,0,0,0,0,0,0),qi.new_DrawDetail(this.gd,this.iX+150+100*this.ishowdetail,this.iY+r,0))),r+=100}else if(4==this.iType)for(t=i.pca.phead;null!=t;)o=t.FindWord("小标题"),n=t.FindWord("详细内容"),null!=o&&(c.gi().DrawTextEx(this.iX+40,this.iY+r,o.pword,4294967295,20,101,1,1,0,0,0),r+=30),null!=n&&(Y.gi().Format(n.pword,this.iW-80,20),Y.gi().Draw(this.iX+40,this.iY+r),r+=Y.gi().iH+10),t=t.pdown;this.iH<r+20&&(this.iH=r+20),this.iY=(h.SCRH-this.iH)/2}ProcTouch(i,t,s){var e;for(this.ishowdetail=-1,e=0;e<this.iPriceCount;e++)this.btn_price[e].ProcTouch(i,t,s)&&this.btn_price[e].bCheck()&&(this.ishowdetail=e);return 3!=i||bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||ln.gi().PopStat(1),!1}}ks.Open=function(i,t,s){var e=ln.gi().PushStat(ln.GS_SHOWACTIVITYDETAIL);e.pc_show=i,e.iType=t,e.sExtShow=s};class As extends s{constructor(i){super(),this.titles=["时间","星期日","星期一","星期二","星期三","星期四","星期五","星期六"],this.iW=1170,this.iH=440,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.ui_list=new Oi(0,8,1080,350),this.ui_list.SetTitle(0,"活动时间",170,!1),this.ui_list.SetTitle(1,"星期日",130,!0),this.ui_list.SetTitle(2,"星期一",130,!0),this.ui_list.SetTitle(3,"星期二",130,!0),this.ui_list.SetTitle(4,"星期三",130,!0),this.ui_list.SetTitle(5,"星期四",130,!0),this.ui_list.SetTitle(6,"星期五",130,!0),this.ui_list.SetTitle(7,"星期六",130,!0),this.ui_list.iRowHeight=50,this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60)}Draw(){var i,t,s,e=0,h=this.pc_weekly.pca.phead;E.new_baseframe2(this.iX,this.iY,this.iW,this.iH,"周","历"),this.btn_close.Draw();var a=this.ui_list.iCheckPoint,n=this.ui_list.iCheckX;for(this.ui_list.iCheckPoint=-1,this.ui_list.iLockPoint=-1,this.ui_list.BeginDraw(this.iX+45,this.iY+45);null!=h;){for(i=0;i<this.titles.length;i++)0==i?null!=(s=h.FindWord(this.titles[i]))&&this.ui_list.DrawUnit(i,e,s.pword):null!=(t=h.FindClass(this.titles[i]))&&null!=(s=t.FindWord("活动名称"))&&(this.ui_list.DrawUnit(i,e,s.pword),a==e&&i==n&&ks.Open(t,0,""));h=h.pdown,e++}this.ui_list.FinishDraw()}ProcTouch(i,t,s){return this.ui_list.ProcTouch(i,t,s),!!this.btn_close.ProcTouch(i,t,s)&&(this.btn_close.bCheck()&&ln.gi().PopStat(1),!0)}}As.Open=function(i){ln.gi().PushStat(ln.GS_WEEKLYACTIVITY).pc_weekly=i};class Is{constructor(){}}class Ps{constructor(){}}class Ns extends s{constructor(i){var t;for(super(),this.sKeyName=["青铜钥匙","白银钥匙","黄金钥匙"],this.iRoundSpeed=5,this.bwaiting=!1,this.iW=1130,this.iH=600,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.iPage=0,this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_page=new Array(2),t=0;t<2;t++)this.btn_page[t]=new Eh(gn.xani_nui2),this.btn_page[t].InitButton("右侧标签");for(this.i0Sort=0,this.btn0_sort=new Array(5),t=0;t<5;t++)this.btn0_sort[t]=new Eh(gn.xani_button),this.btn0_sort[t].InitButton("选择按钮145_56");for(this.btn0_sort[0].sName="日常活动",this.btn0_sort[1].sName="定时活动",this.btn0_sort[2].sName="活动周历",this.btn0_sort[3].sName="幸运转盘",this.btn0_sort[4].sName="实力提升",this.btn_getact=new Array(6),t=0;t<6;t++)this.btn_getact[t]=new Eh(gn.xani_button),this.btn_getact[t].bSingleButton=!0;for(this.btn_sign=new Array(31),this.pc_price=new Array(31),t=0;t<31;t++)this.btn_sign[t]=new Eh(gn.xani_button),this.btn_sign[t].bSingleButton=!0;var s=Ei.pxe.FindMain("七国");for(this.pc_act=s.FindFirst("活动界面资料",5),this.btn0_go=new Array(32),this.btn0_detail=new Array(32),this.alist=new Array(32),this.aprice=new Array(32),t=0;t<32;t++)this.btn0_go[t]=new Eh(gn.xani_button),this.btn0_go[t].InitButton("普通按钮100_55"),this.btn0_go[t].sName="前往",this.btn0_detail[t]=new Eh(gn.xani_button),this.btn0_detail[t].bSingleButton=!0,this.alist[t]=new Is,this.aprice[t]=new Ps;for(this.i0GoToNpcIdList=new Int32Array(32),this.pc_detail=new Array(32),this.sExtShow=new Array(32),this.b0LockScroll=!1,this.i0OffY=0,this.ishowdetail=-1,this.gd=new Li,this.btn_extbuy=new Eh(gn.xani_button),this.btn_extbuy.InitButton("普通按钮100_55"),this.btn_extbuy.sName="购买",this.btn_extsign=new Eh(gn.xani_button),this.btn_extsign.InitButton("选择按钮145_56"),this.btn_extsign.sName="补签",this.iShowGet=-1,this.btn_gift=new Eh(gn.xani_nui2),this.btn_gift.InitButton("礼包按钮"),this.btn_gift.sName="领  取",this.btn_watchprice=new Array(16),t=0;t<16;t++)this.btn_watchprice[t]=new Eh(gn.xani_ui2),this.btn_watchprice[t].bSingleButton=!0;for(this.aa_point=gn.xani_skills[0].InitAnimaWithName("物品突出",null),this.btn_lottery=new Array(3),this.iKeyCount=new Int32Array(3),t=0;t<3;t++)this.btn_lottery[t]=new Eh(gn.xani_button),this.btn_lottery[t].InitButton("抽奖小按钮167_183")}findactbyname(i){var t;for(t=0;t<this.iActCount;t++)if(this.alist[t].sName==i)return this.alist[t];return null}lottery_startround(i){this.iLotteryResult=i-1,L.easymsg.Clear(),L.easymsg.bDisable=!0,Ns.iLotteryRound=Ns.iLotteryRound%16,Ns.iRoundDest=48+this.iLotteryResult,this.iRoundSpeed=1,this.iRoundDelay=this.iRoundSpeed}draw_lottery(i,t){var s;this.iRoundDelay--,this.iRoundDelay<=0&&(Ns.iLotteryRound<Ns.iRoundDest?(Ns.iRoundDest-Ns.iLotteryRound<15&&this.iRoundSpeed++,Ns.iLotteryRound++):this.iLotteryResult>=0&&(this.iLotteryResult=-1,L.easymsg.bDisable=!1,this.bwaiting=!1),this.iRoundDelay=this.iRoundSpeed);var e,h,a,n,o=this.pc_act.FindClass("抽奖物品");o=o.pca.phead;var r,l,b=null,_=0,f=0;for(this.iCjCount=0;null!=o;)e=o.FindNumber("x"),h=o.FindNumber("y"),a=o.FindNumber("物品id"),n=o.FindWord("物品描述"),r=i+20+138*e.iNumber,l=t+20+98*h.iNumber,gn.xani_frame.DrawAnima(r,l,"抽奖物品框119_85",0),gn.xani_ngoods.DrawAnima_aa(r+19.5,l+2.5,gn.de_goods.strValue(a.iNumber,-1,10),0),Ns.iLotteryRound%16==this.iCjCount&&E.frame_type2("黄色透明框a25_25",r,l,119,85,25,25),this.btn_watchprice[this.iCjCount].Move(r,l,119,85),this.ishowdetail==this.iCjCount&&(b=o,_=r,f=l),o=o.pdown,this.iCjCount++;for(s=0;s<3;s++)this.iKeyCount[s]=0;for(s=0;s<20;s++)ht.gi().goods[2][s].iGid>0&&(386==ht.gi().goods[2][s].iTid&&(this.iKeyCount[0]+=ht.gi().goods[2][s].iCount),387==ht.gi().goods[2][s].iTid&&(this.iKeyCount[1]+=ht.gi().goods[2][s].iCount),388==ht.gi().goods[2][s].iTid&&(this.iKeyCount[2]+=ht.gi().goods[2][s].iCount));for(s=0;s<3;s++)r=i+20+138+182*s,l=t+20+98,this.btn_lottery[s].Move(r,l,167,183),this.btn_lottery[s].Draw(),gn.xani_ngoods.DrawAnima_aa(r+83.5-40,l+91.5-40-30,this.sKeyName[s],0),c.gi().DrawText_2(r+83.5,l+91.5+40,""+this.iKeyCount[s],4294967040,30,101,1,1,0,-2,-2,3,4278190080);this.ishowdetail>=0&&null!=b&&(a=b.FindNumber("物品id"),null!=(n=b.FindWord("物品描述"))?qi.new_DrawDetailEx1(a.iNumber,_,f,n.pword):(this.gd.SetAtt(0,a.iNumber,1,0,0,0,0,0,0,0,0),qi.new_DrawDetail(this.gd,_,f,0)))}draw_get(i){var t,s,e,a,n=0;t=(h.SCRW-465)/2,s=(h.SCRH-381)/2,gn.xani_nui2.DrawAnima(t,s,"礼包背景框",0),this.aprice[i].iExp>0&&(e=t+60+n%2*190,a=s+100,gn.xani_nui2.DrawAnima(e,a,"礼品格子",1),gn.xani_ngoods.DrawAnima(e,a,"物品经验",0),c.gi().DrawTextEx(e+80,a+80,""+this.aprice[i].iExp,4294967295,20,101,1,1,0,-3,-3),gn.xani_nui2.DrawAnima(e+80+20,a+11,"礼包文本框",0),c.gi().DrawTextEx(e+80+20+30,a+11+11,"经验",4294967295,20,101,1,1,0,-2,-2),gn.xani_nui2.DrawAnima(e+80+20,a+45,"礼包文本框",0),c.gi().DrawTextEx(e+80+20+30,a+45+11,"x 1",4294967295,20,101,1,1,0,-2,-2),n++),this.aprice[i].iMoney>0&&(e=t+60+n%2*190,a=s+100,gn.xani_nui2.DrawAnima(e,a,"礼品格子",1),gn.xani_ngoods.DrawAnima(e,a,"物品钱",0),c.gi().DrawTextEx(e+80,a+80,""+this.aprice[i].iMoney,4294967295,20,101,1,1,0,-3,-3),gn.xani_nui2.DrawAnima(e+80+20,a+11,"礼包文本框",0),c.gi().DrawTextEx(e+80+20+30,a+11+11,"金钱",4294967295,20,101,1,1,0,-2,-2),gn.xani_nui2.DrawAnima(e+80+20,a+45,"礼包文本框",0),c.gi().DrawTextEx(e+80+20+30,a+45+11,"x 1",4294967295,20,101,1,1,0,-2,-2),n++),this.aprice[i].tid1>0&&this.aprice[i].tcount1>0&&(e=t+60+n%2*190,a=s+100+100,gn.xani_nui2.DrawAnima(e,a,"礼品格子",1),gn.xani_ngoods.DrawAnima_aa(e,a,gn.de_goods.strValue(this.aprice[i].tid1,-1,10),0),gn.xani_nui2.DrawAnima(e+80+20,a+11,"礼包文本框",0),c.gi().DrawTextEx(e+80+20+30,a+11+11,gn.de_goods.strValue(this.aprice[i].tid1,-1,4),4294967295,20,101,1,1,0,-2,-2),gn.xani_nui2.DrawAnima(e+80+20,a+45,"礼包文本框",0),c.gi().DrawTextEx(e+80+20+30,a+45+11,"x "+this.aprice[i].tcount1,4294967295,20,101,1,1,0,-2,-2),n++),this.aprice[i].tid2>0&&this.aprice[i].tcount2>0&&(e=t+60+n%2*190,a=s+100+100,gn.xani_nui2.DrawAnima(e,a,"礼品格子",1),gn.xani_ngoods.DrawAnima_aa(e,a,gn.de_goods.strValue(this.aprice[i].tid2,-1,10),0),gn.xani_nui2.DrawAnima(e+80+20,a+11,"礼包文本框",0),c.gi().DrawTextEx(e+80+20+30,a+11+11,gn.de_goods.strValue(this.aprice[i].tid2,-1,4),4294967295,20,101,1,1,0,-2,-2),gn.xani_nui2.DrawAnima(e+80+20,a+45,"礼包文本框",0),c.gi().DrawTextEx(e+80+20+30,a+45+11,"x "+this.aprice[i].tcount2,4294967295,20,101,1,1,0,-2,-2),n++),this.btn_gift.Move(t+165.5,s+381-44-40,134,44),this.btn_gift.Draw()}Draw(){if(null==ln.gi().FindStat(ln.GS_WEEKLYACTIVITY)){var i;for(E.new_baseframe2(this.iX,this.iY,this.iW,this.iH,"活","动"),i=0;i<2;i++)this.btn_page[i].Move(this.iX+this.iW-15,this.iY+40+130*i,50,130),this.iPage==i&&(this.btn_page[i].bMouseDown=!0),this.btn_page[i].Draw(),0==i?E.new_lableword4(this.iX+this.iW-15,this.iY+40+130*i,40,80,this.iPage==i,"日","常","活","动"):E.new_lableword2(this.iX+this.iW-15,this.iY+40+130*i,40,130,this.iPage==i,"签","到");switch(this.btn_close.Draw(),this.Draw_act(this.iX+35,this.iY+this.iH-90),this.iPage){case 0:this.Draw_0();break;case 1:this.Draw_1()}this.iShowGet>=0&&this.draw_get(this.iShowGet)}}Draw_1(){var i,t,s,e,h,a,n,o;for(s=this.iX+30,e=this.iY+30,h=200,420,E.new_framein(s,e,h,420),c.gi().DrawTextEx(s+100,e+40,"最新动态",4278206039,30,101,1,1,0,-2,-2),s+=h+20,h=630,E.new_framein(s,e,h,420),this.iR0X=s,this.iR0Y=e,this.iR0W=h,this.iR0H=420,a=(a=this.pc_act.FindClass("签到奖励")).pca.phead,this.i0Count=0,c.gi().SetViewClip(s+20,e+20,s+h-20,e+420-20),gn.sop(""+this.iSignCount);null!=a&&(n=a.FindNumber("物品id"),o=a.FindWord("描述"),i=s+25+this.i0Count%6*100,t=e+20+100*parseInt(this.i0Count/6)-this.i0OffY,gn.xani_nui3.DrawAnima(s+25+this.i0Count%6*100,e+20+100*parseInt(this.i0Count/6)-this.i0OffY,"物品格子",0),gn.xani_ngoods.DrawAnima_aa(s+25+this.i0Count%6*100,e+20+100*parseInt(this.i0Count/6)-this.i0OffY,gn.de_goods.strValue(n.iNumber,0,10),0),this.i0Count<this.iSignCount?c.gi().FillRect_2D(i,t,i+80,t+80,2147483648):this.i0Count==this.iSignCount&&0==(xh.me.iFlag[50]&1<<this.iTodayDay-1)&&(this.aa_point.Draw(i,t),this.aa_point.NextFrame()),this.ishowdetail==this.i0Count&&E.frame_type2("黄色透明框a25_25",i,t,80,80,25,25),this.pc_price[this.i0Count]=a,this.btn_sign[this.i0Count].Move(s+25+this.i0Count%6*100,e+20+100*parseInt(this.i0Count/6)-this.i0OffY,80,80),a=a.pdown,this.i0Count++,!(this.i0Count>=this.iMaxDay)););c.gi().NoClip(),this.i0OffH=100*parseInt((this.i0Count+5)/6)-420+40,this.i0OffH<0&&(this.i0OffH=0),s+=h+20,h=200,E.new_framein(s,e,h,420),xh.me.iFlag[20]>0?this.iExtSignCount=5-xh.me.iFlag[62]/1e4%10:this.iExtSignCount=0,this.iExtSignCount+=Math.floor(xh.me.iFlag[62]/1e3%10),this.ishowdetail<0&&(this.iTodayDay-1)%6==1||this.ishowdetail>=0&&this.ishowdetail%6==1?(c.gi().DrawTextEx(s+100,e+40,"会员专属",4278206039,30,101,1,1,0,-2,-2),gn.xani_nui3.DrawAnima(s+100-40,e+40+40,"物品格子",0),gn.xani_ngoods.DrawAnima_aa(s+100-40,e+40+40,gn.de_goods.strValue(118,0,10),0),c.gi().DrawTextEx(s+100,e+40+40+80+40,"签到额外获得",4278206039,25,101,1,1,0,-2,-2)):this.ishowdetail<0&&(this.iTodayDay-1)%6==3||this.ishowdetail>=0&&this.ishowdetail%6==3?(c.gi().DrawTextEx(s+100,e+40,"会员折扣",4278206039,30,101,1,1,0,-2,-2),gn.xani_nui3.DrawAnima(s+100-40,e+40+40,"物品格子",0),gn.xani_ngoods.DrawAnima_aa(s+100-40,e+40+40,gn.de_goods.strValue(161,0,10),0),c.gi().DrawTextEx(s+100,e+40+40+80+40,"40元宝",4278206039,25,101,1,1,0,-2,-2),this.btn_extbuy.Move(s+50,e+40+40+80+40+25+20,100,55),this.btn_extbuy.Draw()):(Y.gi().FormatEx("#c003e57会员拥有5次当月补签次数，连续签到七天可获得一次当月补签次数，每天只能补签一次",165,20,0,0,25),Y.gi().Draw(s+20,e+20),c.gi().DrawTextEx(s+20,e+20+Y.gi().iH+40,"累计签到"+this.iSignCount+"天",4278206039,20,101,1,1,0,0,-2),c.gi().DrawTextEx(s+20,e+20+Y.gi().iH+40+40,"连续签到"+xh.me.iFlag[62]%10+"天",4278206039,20,101,1,1,0,0,-2),c.gi().DrawTextEx(s+20,e+20+Y.gi().iH+40+80,"剩余补签次数"+this.iExtSignCount+"次",4278206039,20,101,1,1,0,0,-2)),this.btn_extsign.Move(s+100-72.5,e+420-30-56,145,56),this.btn_extsign.Draw(),this.ishowdetail>=0&&(n=this.pc_price[this.ishowdetail].FindNumber("物品id"),null!=(o=this.pc_price[this.ishowdetail].FindWord("描述"))?qi.new_DrawDetailEx1(n.iNumber,this.iX+30+220+25+this.ishowdetail%6*100,this.iY+30+20+100*parseInt(this.ishowdetail/6)-this.i0OffY,o.pword):(this.gd.SetAtt(0,n.iNumber,1,0,0,0,0,0,0,0,0),qi.new_DrawDetail(this.gd,this.iX+30+220+25+this.ishowdetail%6*100,this.iY+30+20+100*parseInt(this.ishowdetail/6)-this.i0OffY,0)))}Draw_act(i,t){var s,e,h=this.iW-150-6;for(c.gi().DrawText_2(i,t,"活跃度",4278206039,25,101,1,1,0,0,-2,1,4278190080),i+=80,E.frame_type1("活跃进度外框a20_24",i,t-12,this.iW-150,20),E.frame_type1("活跃进度内框a10_18",i+3,t-12+3,this.iActNumber*h/120,10),c.gi().DrawTextEx(i+h-5,t,""+this.iActNumber,4294967295,20,101,1,1,0,-3,-2),s=0;s<6;s++)e=i+3+h*(15*(s+1))/120,this.iActNumber>=15*(s+1)?gn.xani_nui2.DrawAnima(e-50,t-50,"礼品包包",s):gn.xani_nui2.DrawAnima(e-50,t-50,"礼品包包",6),this.btn_getact[s].Move(e-50,t-50,100,100),c.gi().DrawText_2(e,t+35,15*(s+1)+"活跃",4294967040,25,101,1,1,0,-2,0,3,4278190080),s<this.iActGetPoint&&gn.xani_nui6.DrawAnima(e-50,t-25,"已领取",0)}Draw_0_lable(i,t,s,e,h,a,n){E.frame_type1("活跃标签框a10_84",i,t,400,10),gn.xani_frame.DrawAnima(i+5,t+5,"活跃图标框73_73",0),gn.xani_icon.DrawAnima_aa(i+5,t+5,s,0),c.gi().DrawText_2(i+85,t+26,s,4294967040,30,101,1,1,0,0,-2,2,4278190080),c.gi().DrawTextEx(i+85,t+64,e+"   "+h,4294967295,18,101,1,1,0,0,-2),null!=a&&(a.Move(i+400-100-20,t+42-27.5,100,55),a.Draw()),n.Move(i+5,t+5,73,73)}Draw_0(){var i,t,s,e,h,a,n,o,r,l,b,_;if(t=this.iX+30,s=this.iY+30,e=850,420,E.new_framein(t,s,e,420),this.iR0X=t,this.iR0Y=s,this.iR0W=e,this.iR0H=420,this.i0Count=0,0==this.i0Sort||1==this.i0Sort||4==this.i0Sort){if(0==this.i0Sort)h=this.pc_act.FindClass("日常活动列表");else if(1==this.i0Sort)h=this.pc_act.FindClass("定时活动列表");else{if(4!=this.i0Sort)return;h=this.pc_act.FindClass("实力提升")}for(h=h.pca.phead,c.gi().SetViewClip(t+20,s+20,t+e-20,s+420-20);null!=h;)h.FindNumber("开启等级").iNumber>xh.me.rbs.iLev?h=h.pdown:(a=h.FindNumber("活跃上限"),n=h.FindWord("次数单位"),o=h.FindNumber("次数上限"),r=h.FindNumber("前往npcid"),_=this.findactbyname(h.sName),l=null!=a&&null!=_?"活跃 "+_.add+"/"+a.iNumber:"",null!=n&&null!=_?(b=n.pword+" "+_.proc+"/"+o.iNumber,this.sExtShow[this.i0Count]=_.proc+"/"+o.iNumber):(b="",this.sExtShow[this.i0Count]=""),null!=r&&(this.i0GoToNpcIdList[this.i0Count]=r.iNumber),this.Draw_0_lable(t+20+this.i0Count%2*410,s+25+100*parseInt(this.i0Count/2)-this.i0OffY,h.sName,l,b,null==r?null:this.btn0_go[this.i0Count],this.btn0_detail[this.i0Count]),this.pc_detail[this.i0Count]=h,h=h.pdown,this.i0Count++);c.gi().NoClip(),this.i0OffH=(this.i0Count+1)/2*100-420+40,this.i0OffH<0&&(this.i0OffH=0)}for(3==this.i0Sort&&this.draw_lottery(t,s),t+=e+20,e=200,E.new_framein(t,s,e,420),i=0;i<5;i++)this.btn0_sort[i].Move(t+27.5,s+30+75*i,145,56),this.i0Sort==i&&(this.btn0_sort[i].bMouseDown=!0),this.btn0_sort[i].Draw()}ProcTouch(i,t,s){var a,n,o,r;if(this.iShowGet>=0)return 465,381,n=(h.SCRW-465)/2,o=(h.SCRH-381)/2,3!=i||bn.bInRect(t,s,n,o,465,381)||(this.iShowGet=-1),this.btn_gift.ProcTouch(i,t,s)&&this.btn_gift.bCheck()&&(this.iActNumber<this.aprice[this.iShowGet].iNeed?L.easymsg.AddMessage("活跃度未达不能领取"):this.iShowGet<this.iActGetPoint?L.easymsg.AddMessage("此档奖励已领过"):this.iShowGet>this.iActGetPoint?L.easymsg.AddMessage("按顺序领取奖励"):Mh.gi().s_PromptActivity(1,this.iShowGet),this.iShowGet=-1),!0;if(this.btn_close.ProcTouch(i,t,s))return this.btn_close.bCheck()&&ln.gi().PopStat(1),!0;for(a=0;a<2;a++)this.btn_page[a].ProcTouch(i,t,s)&&this.btn_page[a].bCheck()&&(this.iPage=a,this.i0OffY=0,this.ishowdetail=-1,Ns.iLotteryRound=Ns.iRoundDest);for(a=0;a<6;a++)if(this.btn_getact[a].ProcTouch(i,t,s))return this.btn_getact[a].bCheck()&&(this.iShowGet=a),!0;switch(this.iPage){case 0:for(a=0;a<5;a++)this.btn0_sort[a].ProcTouch(i,t,s)&&this.btn0_sort[a].bCheck()&&(2==a?As.Open(this.pc_act.FindClass("周历")):(this.i0Sort=a,this.i0OffY=0,this.ishowdetail=-1,Ns.iLotteryRound=Ns.iRoundDest));switch(this.i0Sort){case 0:case 1:case 4:if(this.b0LockScroll)return 2==i&&(this.i0OffY+=this.i0LockY-s,this.i0LockY=s,this.i0OffY<0&&(this.i0OffY=0),this.i0OffY>this.i0OffH&&(this.i0OffY=this.i0OffH)),3==i&&(this.b0LockScroll=!1),!0;if(bn.bInRect(t,s,this.iR0X,this.iR0Y,this.iR0W,this.iR0H)){for(a=0;a<this.i0Count;a++){if(this.btn0_go[a].ProcTouch(i,t,s))return this.btn0_go[a].bCheck()&&null!=(r=this.pc_detail[a].FindNumber("前往npcid"))&&(ln.gi().PopStat(1),1e4==r.iNumber?Ue.gi().FindNpc(e.iMasterids[xh.me.rbs.iSchoolId],!0,!0):Ue.gi().FindNpc(r.iNumber,!0,!0)),!0;if(this.btn0_detail[a].ProcTouch(i,t,s))return this.btn0_detail[a].bCheck()&&ks.Open(this.pc_detail[a],this.i0Sort,this.sExtShow[a]),!0}1==i&&(this.b0LockScroll=!0,this.i0LockY=s)}break;case 3:for(this.ishowdetail=-1,a=0;a<this.iCjCount;a++)if(this.btn_watchprice[a].ProcTouch(i,t,s))return this.btn_watchprice[a].bCheck()&&(this.ishowdetail=a),!0;if(!this.bwaiting)for(a=0;a<3;a++)if(this.btn_lottery[a].ProcTouch(i,t,s))return this.btn_lottery[a].bCheck()&&(1==a&&(xh.me.iFlag[63]>>8&15)>=5?L.easymsg.AddMessage("今日已使用过5次白银钥匙"):2==a&&(xh.me.iFlag[63]>>12&15)>=5?L.easymsg.AddMessage("今日已使用过5次黄金钥匙"):this.iKeyCount[a]>0?(Mh.gi().s_PromptActivity(6,a),this.iLotteryResult=-1,this.bwaiting=!0):L.easymsg.AddMessage("背包中没有"+this.sKeyName[a])),!0}break;case 1:if((this.ishowdetail<0&&(this.iTodayDay-1)%6==3||this.ishowdetail>=0&&this.ishowdetail%6==3)&&this.btn_extbuy.ProcTouch(i,t,s))return this.btn_extbuy.bCheck()&&(0!=(8192&xh.me.iFlag[24])?L.easymsg.AddMessage("折扣商品只能购买一次"):Mh.gi().s_PromptActivity(4,0)),!0;if(this.btn_extsign.ProcTouch(i,t,s))return this.btn_extsign.bCheck()&&(this.iExtSignCount<=0?L.easymsg.AddMessage("当前没有剩余补签次数"):0!=(16384&xh.me.iFlag[24])?L.easymsg.AddMessage("每天只能补签一次"):Mh.gi().s_PromptActivity(3,0)),!0;if(3==i&&(this.ishowdetail=-1),this.b0LockScroll)if(3==i)this.b0LockScroll=!1;else if(Math.abs(this.i0LockY-s)>=10&&(this.b0Scrolling=!0),this.b0Scrolling){for(2==i&&(this.i0OffY+=this.i0LockY-s,this.i0LockY=s,this.i0OffY<0&&(this.i0OffY=0),this.i0OffY>this.i0OffH&&(this.i0OffY=this.i0OffH)),a=0;a<this.i0Count;a++)this.btn_sign[a].bMouseDown=!1;return!0}if(bn.bInRect(t,s,this.iR0X,this.iR0Y,this.iR0W,this.iR0H)){for(a=0;a<this.i0Count;a++)this.btn_sign[a].ProcTouch(i,t,s)&&this.btn_sign[a].bCheck()&&(a<this.iSignCount||(a==this.iSignCount&&0==(xh.me.iFlag[50]&1<<this.iTodayDay-1)?Mh.gi().s_PromptActivity(2,0):this.ishowdetail=a));1==i&&(this.b0LockScroll=!0,this.b0Scrolling=!1,this.i0LockY=s)}}return!0}}Ns.iLotteryRound=0,Ns.iRoundDest=0,Ns.iOpenFlag=0,Ns.Open=function(i){var t;ln.gi().iXStat==ln.GS_LOADING1&&ln.gi().PopStat(1),t=ln.gi().iXStat==ln.GS_PROMPTACTIVITY?ln.gi().LastStat(0):ln.gi().PushStat(ln.GS_PROMPTACTIVITY);for(var s=0;0!=i.GetNextByte();)t.alist[s].sName=i.GetNextString(),t.alist[s].proc=i.GetNextByte(),t.alist[s].max=i.GetNextByte(),t.alist[s].add=i.GetNextByte(),s++;for(t.iActCount=s,gn.sop("actcount"+s),t.iActNumber=i.GetNextShort(),t.iActGetPoint=i.GetNextByte(),t.iActPriceCount=i.GetNextByte(),s=0;s<t.iActPriceCount;s++)t.aprice[s].iNeed=i.GetNextShort(),t.aprice[s].iExp=i.GetNextInt(),t.aprice[s].iMoney=i.GetNextInt(),t.aprice[s].tid1=i.GetNextShort(),t.aprice[s].tcount1=i.GetNextByte(),t.aprice[s].tid2=i.GetNextShort(),t.aprice[s].tcount2=i.GetNextByte();for(t.iSignCount=0,s=0;s<31;s++)0!=(xh.me.iFlag[50]&1<<s)&&t.iSignCount++;t.iTodayDay=i.GetNextByte(),t.iMaxDay=i.GetNextByte(),t.iWeekDay=i.GetNextByte(),1==Ns.iOpenFlag&&(Ns.iOpenFlag=0,t.i0Sort=3)};class vs{constructor(i){var t;for(this.pani=i,this.pm3f=c.gi(),this.bChanged=!1,this.bFinished=!1,this.iNumber=0,this.iMinNumber=0,this.iMaxNumber=2147483647,this.bShow=!1,this.btn_num=new Array(12),t=0;t<12;t++)this.btn_num[t]=new Eh(gn.xani_nui3),3==t?this.btn_num[t].InitButton("键盘按钮_退格"):11==t?this.btn_num[t].InitButton("键盘按钮_确定"):this.btn_num[t].InitButton("键盘按钮");this.btn_num[0].sName="1",this.btn_num[1].sName="2",this.btn_num[2].sName="3",this.btn_num[4].sName="4",this.btn_num[5].sName="5",this.btn_num[6].sName="6",this.btn_num[7].sName="0",this.btn_num[8].sName="7",this.btn_num[9].sName="8",this.btn_num[10].sName="9",this.aa_frame=null}MinMax(i,t){this.iMinNumber=i,this.iMaxNumber=t}Draw(){var i;if(E.new_numberframe(this.iX,this.iY,this.iW,""+this.iNumber),this.bShow)for(this.DrawBack(),i=0;i<12;i++)this.btn_num[i].Move(this.iFx+10+i%4*74,this.iFy+10+74*parseInt(i/4),64,64),this.btn_num[i].Draw()}ProcTouch(i,t,s){var e;if(this.bShow){if(bn.bInRect(t,s,this.iFx,this.iFy,this.iFw,this.iFh))for(e=0;e<12;e++)this.btn_num[e].ProcTouch(i,t,s)&&this.btn_num[e].bCheck()&&(0==e||1==e||2==e?this.iNumber=10*this.iNumber+(e+1):3==e?this.iNumber=parseInt(this.iNumber/10):4==e||5==e||6==e?this.iNumber=10*this.iNumber+e:7==e?this.iNumber=10*this.iNumber:8==e||9==e||10==e?this.iNumber=10*this.iNumber+(e-1):11==e&&(this.bShow=!1),this.iNumber<this.iMinNumber&&(this.iNumber=this.iMinNumber),this.iNumber>this.iMaxNumber&&(this.iNumber=this.iMaxNumber));else 3==i&&(this.iNumber<this.iMinNumber&&(this.iNumber=this.iMinNumber),this.bShow=!1);return this.iNumber=Math.floor(this.iNumber),!0}return!!bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)&&(1==i&&(this.bMouseDown=!0),3==i&&this.bMouseDown&&(this.bMouseDown=!1,this.bShow=!0,this.iNumber=0),!0)}DrawBack(){null==this.aa_frame&&(this.aa_frame=gn.xani_nui3.InitAnimaWithName("键盘框",null)),this.aa_frame.iFrame=0,this.aa_frame.Draw(this.iFx,this.iFy),this.aa_frame.iFrame=1,this.aa_frame.DrawEx(this.iFx+10,this.iFy,101,1*(this.iFw-20)/20,1,0,0,0),this.aa_frame.iFrame=2,this.aa_frame.Draw(this.iFx+this.iFw,this.iFy),this.aa_frame.iFrame=3,this.aa_frame.DrawEx(this.iFx+this.iFw,this.iFy+10,101,1,1*(this.iFh-20)/20,0,0,0),this.aa_frame.iFrame=4,this.aa_frame.Draw(this.iFx+this.iFw,this.iFy+this.iFh),this.aa_frame.iFrame=5,this.aa_frame.DrawEx(this.iFx+10,this.iFy+this.iFh,101,1*(this.iFw-20)/20,1,0,0,0),this.aa_frame.iFrame=6,this.aa_frame.Draw(this.iFx,this.iFy+this.iFh),this.aa_frame.iFrame=7,this.aa_frame.DrawEx(this.iFx,this.iFy+10,101,1,1*(this.iFh-20)/20,0,0,0),this.aa_frame.iFrame=8,this.aa_frame.DrawEx(this.iFx+10,this.iFy+10,101,1*(this.iFw-20)/20,1*(this.iFh-20)/20,0,0,0),this.aa_frame.iFrame=9,this.aa_frame.Draw(this.iPx,this.iPy)}Move(i,t,s){this.iX=i,this.iY=t,this.iW=s,this.iH=50,this._numframe(this.iX+this.iW/2,this.iY-15)}_numframe(i,t){this.iPx=i,this.iPy=t,this.iFw=306,this.iFh=232,this.iFx=this.iPx-this.iFw/2,this.iFy=this.iPy-this.iFh}}class Ms{_SHOPGOODS(){}}class ys extends s{constructor(i){var t,s;for(super(),this.pani=i,this.pm3f=i.pm3f,this.iW=920,this.iH=550,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.sgs=new Array(20),t=0;t<20;t++)this.sgs[t]=new Ms;for(this.btn_page=new Array(8),t=0;t<8;t++)this.btn_page[t]=new D(gn.xani_nui2),this.btn_page[t].InitButton("按钮2");for(this.in_num=new vs(gn.xani_nui2),this.in_num.MinMax(1,10),this.in_num.iNumber=1,this.btn_buy=new Eh(gn.xani_nui2),this.btn_buy.InitButton("按钮1_110"),this.btn_buy.sName="购买",this.btn_charge=new Eh(gn.xani_nui2),this.btn_charge.InitButton("按钮3"),this.btn_charge.sName="充  值",this.goods=new Array(20),t=0;t<20;t++)this.goods[t]=new Li,this.goods[t].iPos=t;for(this.iSelect=ys.iLastSelect,ys.iLastSelect=0,this.btn_select=new Array(3),t=0;t<3;t++)this.btn_select[t]=new Eh(gn.xani_nui2),this.btn_select[t].InitButton("右侧标签");for(this.btn_pay=new Array(8),s=0;s<2;s++)for(t=0;t<4;t++)this.btn_pay[4*s+t]=new D(gn.xani_nui3),this.btn_pay[4*s+t].Move(this.iX+67+410*s,this.iY+50+100*t,376,94),this.btn_pay[4*s+t].InitButton("充值大按钮");this.btn_pay1=new Eh(gn.xani_nui2),this.btn_pay1.InitButton("按钮1"),this.btn_pay1.Move(this.iX+this.iW-67-161,this.iY+this.iH-30-53,161,53),this.btn_pay1.sName="自定义额度",this.in_price=new vs(gn.xani_nui2),this.in_price.iNumber=1,this.in_price.MinMax(1,1e3),this.btn_act=new Eh(gn.xani_nui2),this.btn_act.InitButton("感叹提示"),this.btn_act.Move(this.iX+67,this.iY+this.iH-30-26-32,65,65),this.bShowAct=!1}Draw_0(){var i,t,s,e,h;for(this.btn_page[0].sName="热卖品",this.btn_page[1].sName="装备相关",this.btn_page[2].sName="宠物相关",this.btn_page[3].sName="二级丹药",this.btn_page[4].sName="三级草药",this.btn_page[5].sName="其他",this.btn_page[6].sName="铜币区",E.new_framein(this.iX+30,this.iY+30,185,this.iH-60),i=0;i<7;i++)this.btn_page[i].Move(this.iX+30+20,this.iY+30+20+67*i,145,56),this.iPage==i&&(this.btn_page[i].bMouseIn=!0,this.btn_page[i].bMouseDown=!0),this.btn_page[i].Draw();t=this.iX+30+145+40+20,s=this.iY+30,e=this.iW-60-145-40-20,E.new_framein(t,s,e,385),this.iGx=t+20,this.iGy=s+20,qi.new_DrawGoods(this.iGx,this.iGy,this.goods,null,null),t+=465,s+=20,null!=this.lockgoods&&(E.new_TagText2(t,s,100,"名称",gn.de_goods.strValue(this.lockgoods.iTid,0,4)),s+=50,0==this.sgs[this.lockgoods.iPos].iPrice&&this.sgs[this.lockgoods.iPos].iMoney>0?(i=this.sgs[this.lockgoods.iPos].iMoney,E.new_TagText2(t,s,100,"单价",i%1e4==0?i/1e4+"万铜币":i+"铜币")):E.new_TagText2(t,s,100,"单价",this.sgs[this.lockgoods.iPos].iPrice+"元宝"),s+=50,c.gi().DrawTextEx(t,s+25,"数量:",4278206039,30,101,1,1,0,0,-2),this.in_num.Move(t+67,s,100),this.in_num.Draw(),s+=70,0==this.sgs[this.lockgoods.iPos].iPrice&&this.sgs[this.lockgoods.iPos].iMoney>0?(i=this.sgs[this.lockgoods.iPos].iMoney*this.in_num.iNumber,E.new_TagText2(t,s,100,"总价",i%1e4==0?i/1e4+"万铜币":i+"铜币")):E.new_TagText2(t,s,100,"总价",this.sgs[this.lockgoods.iPos].iPrice*this.in_num.iNumber+"元宝"),s+=100,this.btn_buy.Move(t+57,s,110,52),this.btn_buy.Draw()),t=this.iX+30+40+145+20,s=this.iY+30+20+345+20+20,h=this.iH-60-345-40-20,E.new_framein(t,s,e,h),E.new_TagText2(t+20,s+(h-32)/2,150,"元宝",""+xh.me.rbs.iInGot),E.new_TagText2(t+20+235,s+(h-32)/2,150,"铜币",""+xh.me.rbs.iMoney),this.btn_charge.Move(t+490,s+(h/2-24.5),141,49),this.btn_charge.Draw(),null!=this.lockgoods&&qi.new_DrawRect(this.iGx,this.iGy,this.goods,this.lockgoods,0),qi.bShowDetail()&&qi.new_DrawDetail(null,-1,-1,0)}Draw_1(){var i;for(i=0;i<8;i++)this.btn_pay[i].Draw(),gn.xani_nui3.DrawAnima(this.btn_pay[i].iX+7,this.btn_pay[i].iY+7,"充值图标",i),c.gi().DrawText_2(this.btn_pay[i].iX+7+80+7,this.btn_pay[i].iY+12+17,"￥"+ys.amount[i]+"="+10*ys.amount[i]+"元宝",4294967295,28,101,1,1,0,0,-2,1,4278190080),1==ys.iAddType&&i>=4&&(gn.xani_nui3.DrawAnima(this.btn_pay[i].iX,this.btn_pay[i].iY,"加送标签",i-4),c.gi().DrawTextEx(this.btn_pay[i].iX+7+80+7,this.btn_pay[i].iY+12+17+38,"加送"+ys.addmount[i]+"元宝",4294902015,28,101,1,1,0,0,-2)),2==ys.iAddType&&i>=4&&(gn.xani_nui3.DrawAnima(this.btn_pay[i].iX,this.btn_pay[i].iY,"加送标签",4),c.gi().DrawTextEx(this.btn_pay[i].iX+7+80+7,this.btn_pay[i].iY+12+17+38,"送：充值礼包 x "+ys.addlibao[i],4294902015,28,101,1,1,0,0,-2));this.btn_act.Move(this.btn_pay[0].iX,this.iY+this.iH-30-26-32,65,65),this.btn_act.Draw(),c.gi().DrawTextEx(this.btn_pay[0].iX+70,this.btn_act.iY+32,"充值活动",4278206039,30,101,1,1,0,0,-2),this.bShowAct,this.CanDefine(t.QUDAO)&&(c.gi().DrawTextEx(this.btn_pay1.iX-130-190,this.btn_pay1.iY+12,"充值金额(元):",4278206039,30,101,1,1,0,0,0),this.in_price.Move(this.btn_pay1.iX-130,this.btn_pay1.iY+2,120),this.in_price.Draw(),this.btn_pay1.Draw())}CanDefine(i){return!0}Draw_2(){var i,t,s,e,h;for(this.btn_page[0].sName="储备区",E.new_framein(this.iX+30,this.iY+30,185,this.iH-60),i=0;i<1;i++)this.btn_page[i].Move(this.iX+30+20,this.iY+30+20+67*i,145,56),this.iPage==i&&(this.btn_page[i].bMouseIn=!0,this.btn_page[i].bMouseDown=!0),this.btn_page[i].Draw();t=this.iX+30+145+40+20,s=this.iY+30,e=this.iW-60-145-40-20,E.new_framein(t,s,e,385),this.iGx=t+20,this.iGy=s+20,qi.new_DrawGoods(this.iGx,this.iGy,this.goods,null,null),t+=465,s+=20,null!=this.lockgoods&&(E.new_TagText2(t,s,100,"名称",gn.de_goods.strValue(this.lockgoods.iTid,0,4)),s+=50,0==this.sgs[this.lockgoods.iPos].iPrice&&0==this.sgs[this.lockgoods.iPos].iMoney&&this.sgs[this.lockgoods.iPos].iReserve>0?(i=this.sgs[this.lockgoods.iPos].iReserve,E.new_TagText2(t,s,100,"单价",i%1e4==0?i/1e4+"万绑铜":i+"绑铜")):0==this.sgs[this.lockgoods.iPos].iPrice&&this.sgs[this.lockgoods.iPos].iMoney>0?(i=this.sgs[this.lockgoods.iPos].iMoney,E.new_TagText2(t,s,100,"单价",i%1e4==0?i/1e4+"万铜币":i+"铜币")):E.new_TagText2(t,s,100,"单价",this.sgs[this.lockgoods.iPos].iPrice+"元宝"),s+=50,c.gi().DrawTextEx(t,s+25,"数量:",4278206039,30,101,1,1,0,0,-2),this.in_num.Move(t+67,s,100),this.in_num.Draw(),s+=70,0==this.sgs[this.lockgoods.iPos].iPrice&&0==this.sgs[this.lockgoods.iPos].iMoney&&this.sgs[this.lockgoods.iPos].iReserve>0?(i=this.sgs[this.lockgoods.iPos].iReserve*this.in_num.iNumber,E.new_TagText2(t,s,100,"总价",i%1e4==0?i/1e4+"万绑铜":i+"绑铜")):0==this.sgs[this.lockgoods.iPos].iPrice&&this.sgs[this.lockgoods.iPos].iMoney>0?(i=this.sgs[this.lockgoods.iPos].iMoney*this.in_num.iNumber,E.new_TagText2(t,s,100,"总价",i%1e4==0?i/1e4+"万铜币":i+"铜币")):E.new_TagText2(t,s,100,"总价",this.sgs[this.lockgoods.iPos].iPrice*this.in_num.iNumber+"元宝"),this.sgs[this.lockgoods.iPos].iBuyLimit>0&&c.gi().DrawTextEx(t,s+60,"每日限购:"+this.sgs[this.lockgoods.iPos].iBuyLimit,4278206039,30,101,1,1,0,0,-2),s+=100,this.btn_buy.Move(t+57,s,110,52),this.btn_buy.Draw()),t=this.iX+30+40+145+20,s=this.iY+30+20+345+20+20,h=this.iH-60-345-40-20,E.new_framein(t,s,e,h),E.new_TagText2(t+20,s+(h-32)/2,150,"元宝",""+xh.me.rbs.iInGot),E.new_TagText2(t+20+235,s+(h-32)/2,150,"绑铜",""+xh.me.rbs.iReserve),this.btn_charge.Move(t+490,s+(h/2-24.5),141,49),this.btn_charge.Draw(),null!=this.lockgoods&&qi.new_DrawRect(this.iGx,this.iGy,this.goods,this.lockgoods,0),qi.bShowDetail()&&qi.new_DrawDetail(null,-1,-1,0)}Draw(){var i;for(0==this.iSelect?E.new_baseframe2(this.iX,this.iY,this.iW,this.iH,"商","城"):1==this.iSelect?E.new_baseframe4(this.iX,this.iY,this.iW,this.iH,"绑","定","商","城"):E.new_baseframe2(this.iX,this.iY,this.iW,this.iH,"充","值"),this.btn_close.Draw(),i=0;i<3;i++)this.btn_select[i].Move(this.iX+this.iW-15,this.iY+40+130*i,50,130),this.iSelect==i&&(this.btn_select[i].bMouseDown=!0),this.btn_select[i].Draw(),0==i?E.new_lableword2(this.iX+this.iW-15,this.iY+40+130*i,40,130,this.iSelect==i,"商","城"):1==i?E.new_lableword4(this.iX+this.iW-15,this.iY+46+130*i,40,70,this.iSelect==i,"绑","定","商","城"):E.new_lableword2(this.iX+this.iW-15,this.iY+40+130*i,40,130,this.iSelect==i,"充","值");switch(this.iSelect){case 0:this.Draw_0();break;case 1:this.Draw_2();break;case 2:this.Draw_1()}}ProcTouch(i,s,e){if(this.bShowAct=!1,2==this.iSelect&&this.CanDefine(t.QUDAO)&&this.in_price.ProcTouch(i,s,e))return!0;var h;if(0==this.iSelect){if(null!=this.lockgoods){if(this.in_num.ProcTouch(i,s,e))return!0;if(this.btn_buy.ProcTouch(i,s,e)){if(this.btn_buy.bCheck()&&this.in_num.iNumber>=1&&this.in_num.iNumber<=10)if(0==this.sgs[this.lockgoods.iPos].iPrice&&this.sgs[this.lockgoods.iPos].iMoney>0)if(xh.me.rbs.iMoney<this.sgs[this.lockgoods.iPos].iMoney*this.in_num.iNumber)L.easymsg.AddMessage("铜币不足");else{for(h=0;h<this.in_num.iNumber;h++)Mh.gi().s_IngotMallBuy(this.iShopId,this.sgs[this.lockgoods.iPos].iTid,this.sgs[this.lockgoods.iPos].iCount);ln.gi().PushStat(ln.GS_LOADING1)}else if(xh.me.rbs.iInGot<this.sgs[this.lockgoods.iPos].iPrice*this.in_num.iNumber)L.easymsg.AddMessage("元宝不足");else{for(h=0;h<this.in_num.iNumber;h++)fn.gi().mta_record(5,this.sgs[this.lockgoods.iPos].iPrice,gn.de_goods.strValue(this.lockgoods.iTid,0,4)),Mh.gi().s_IngotMallBuy(this.iShopId,this.sgs[this.lockgoods.iPos].iTid,this.sgs[this.lockgoods.iPos].iCount);ln.gi().PushStat(ln.GS_LOADING1)}return!0}}else this.in_num.iNumber=1;for(this.lockgoods=qi.new_LockGoods(s,e,this.iGx,this.iGy,this.goods,i),qi.NoMove(),null!=this.lockgoods&&(121==this.lockgoods.iTid?(this.in_num.MinMax(1,1),this.in_num.iNumber=1):this.in_num.MinMax(1,10)),this.btn_charge.ProcTouch(i,s,e)&&this.btn_charge.bCheck()&&(this.iSelect=2),h=0;h<7;h++)this.btn_page[h].ProcTouch(i,s,e)&&this.btn_page[h].bCheck()&&(this.iPage=h,Mh.gi().s_IngotMall(this.iPage,0))}if(this.btn_close.ProcTouch(i,s,e))return this.btn_close.bCheck()&&ln.gi().PopStat(1),!0;for(h=0;h<3;h++)this.btn_select[h].ProcTouch(i,s,e)&&this.btn_select[h].bCheck()&&h!=this.iSelect&&(this.iSelect=h,this.iPage=0,0==this.iSelect&&Mh.gi().s_IngotMall(this.iPage,0),1==this.iSelect&&Mh.gi().s_IngotMall(10+this.iPage,1));if(1==this.iSelect){if(null!=this.lockgoods){if(this.in_num.ProcTouch(i,s,e))return!0;if(this.btn_buy.ProcTouch(i,s,e)){if(this.btn_buy.bCheck()&&this.in_num.iNumber>=1&&this.in_num.iNumber<=10)if(0==this.sgs[this.lockgoods.iPos].iPrice&&0==this.sgs[this.lockgoods.iPos].iMoney&&this.sgs[this.lockgoods.iPos].iReserve>0)if(xh.me.rbs.iReserve<this.sgs[this.lockgoods.iPos].iReserve*this.in_num.iNumber)L.easymsg.AddMessage("绑铜不足");else{for(h=0;h<this.in_num.iNumber;h++)Mh.gi().s_IngotMallBuy(this.iShopId,this.sgs[this.lockgoods.iPos].iTid,this.sgs[this.lockgoods.iPos].iCount);ln.gi().PushStat(ln.GS_LOADING1)}else if(0==this.sgs[this.lockgoods.iPos].iPrice&&this.sgs[this.lockgoods.iPos].iMoney>0)if(xh.me.rbs.iMoney<this.sgs[this.lockgoods.iPos].iMoney*this.in_num.iNumber)L.easymsg.AddMessage("铜币不足");else{for(h=0;h<this.in_num.iNumber;h++)Mh.gi().s_IngotMallBuy(this.iShopId,this.sgs[this.lockgoods.iPos].iTid,this.sgs[this.lockgoods.iPos].iCount);ln.gi().PushStat(ln.GS_LOADING1)}else if(xh.me.rbs.iInGot<this.sgs[this.lockgoods.iPos].iPrice*this.in_num.iNumber)L.easymsg.AddMessage("元宝不足");else{for(h=0;h<this.in_num.iNumber;h++)fn.gi().mta_record(5,this.sgs[this.lockgoods.iPos].iPrice,gn.de_goods.strValue(this.lockgoods.iTid,0,4)),Mh.gi().s_IngotMallBuy(this.iShopId,this.sgs[this.lockgoods.iPos].iTid,this.sgs[this.lockgoods.iPos].iCount);ln.gi().PushStat(ln.GS_LOADING1)}return!0}}else this.in_num.iNumber=1;for(this.lockgoods=qi.new_LockGoods(s,e,this.iGx,this.iGy,this.goods,i),qi.NoMove(),null!=this.lockgoods&&(121==this.lockgoods.iTid?(this.in_num.MinMax(1,1),this.in_num.iNumber=1):this.in_num.MinMax(1,10)),this.btn_charge.ProcTouch(i,s,e)&&this.btn_charge.bCheck()&&(this.iSelect=2),h=0;h<1;h++)this.btn_page[h].ProcTouch(i,s,e)&&this.btn_page[h].bCheck()&&(this.iPage=h,Mh.gi().s_IngotMall(this.iPage+10,1))}if(2==this.iSelect){for(h=0;h<8;h++)this.btn_pay[h].ProcTouch(i,s,e)&&this.btn_pay[h].bCheck()&&fn.gi().Pay(ys.amount[h]);this.btn_act.ProcTouch(i,s,e)&&this.btn_act.bCheck()&&(this.bShowAct=!this.bShowAct,Z.fm.Open("1，单次充值50元可参与神兽抽奖活动，详情请在西阳城神兽使者处查询")),this.CanDefine(t.QUDAO)&&this.btn_pay1.ProcTouch(i,s,e)&&this.btn_pay1.bCheck()&&((h=this.in_price.iNumber)<1||h>1e3?L.easymsg.AddMessage("充值额度为1~1000"):fn.gi().Pay(h))}return!1}}ys.iAddType=0,ys.iLastSelect=0,ys.amount=[10,20,30,50,100,300,500,1e3],ys.addmount=[0,0,0,0,50,300,750,2e3],ys.addlibao=[0,0,0,0,1,4,8,20],ys.OpenEx=function(){Mh.gi().s_IngotMall(0,2)},ys.OPEN=function(i){var t,s;ln.gi().iXStat!=ln.GS_INGOTMALL&&ln.gi().PushStat(ln.GS_INGOTMALL);var e=ln.gi().LastStat(0);for(e.iShopId=i.GetNextInt(),e.sShopName=i.GetNextString(),t=0;t<20;t++)e.goods[t].iGid=-1;for(t=0;e.sgs[t].iTid=i.GetNextInt(),-1!=e.sgs[t].iTid;){for(e.sgs[t].iCount=i.GetNextInt(),e.sgs[t].iPrice=i.GetNextInt(),e.sgs[t].iMoney=i.GetNextInt(),e.sgs[t].iReserve=i.GetNextInt(),e.sgs[t].iBuyLimit=i.GetNextByte(),e.goods[t].iGid=1,e.goods[t].iTid=e.sgs[t].iTid,e.goods[t].iCount=e.sgs[t].iCount,s=0;s<8;s++)e.goods[t].iAtts[s]=0;gn.xani_ngoods.InitAnimaWithName(gn.de_goods.strValue(e.goods[t].iTid,-1,10),e.goods[t].aa),t++}e.iSgCount=t,e.lockgoods=null,e.sTitle=i.GetNextString(),ys.iAddType=i.GetNextByte(),e.iPage=i.GetNextByte(),e.iSelect=i.GetNextByte()};class Rs extends s{constructor(i){super(),this.pm3f=c.gi(),this.iW=500,this.iH=350,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.in_count=new vs(gn.xani_nui3),this.in_count.iNumber=1,this.in_count.MinMax(1,200),this.btn_exchange=new Eh(gn.xani_button),this.btn_exchange.InitButton("1号按钮150_60"),this.btn_exchange.sName="兑换"}Draw(){E.frame_type4("7号框52_52",this.iX,this.iY,this.iW,this.iH,52,52),this.pm3f.DrawText_2(this.iX+this.iW/2,this.iY+30,"铜币兑换",4294896766,32,101,1,1,0,-2,0,3,4278261038),this.pm3f.DrawText_2(this.iX+50,this.iY+30+60+14,"兑换数目",4294896766,28,101,1,1,0,0,-2,3,4278261038),this.in_count.Move(this.iX+50+120,this.iY+30+60-11,140),this.in_count.Draw(),this.pm3f.DrawText_2(this.iX+50+120+140+8,this.iY+30+60+14,"*10万",4294896766,28,101,1,1,0,0,-2,3,4278261038),this.pm3f.DrawText_2(this.iX+50,this.iY+30+60+60+14,"需要元宝",4294896766,28,101,1,1,0,0,-2,3,4278261038),this.pm3f.DrawTextEx(this.iX+50+120,this.iY+30+60+60+14,""+10*this.in_count.iNumber,4279324257,20,101,1,1,0,0,-2),this.pm3f.DrawText_2(this.iX+50,this.iY+30+60+60+60+14,"拥有元宝",4294896766,28,101,1,1,0,0,-2,3,4278261038),this.pm3f.DrawTextEx(this.iX+50+120,this.iY+30+60+60+60+14,""+xh.me.rbs.iInGot,4279324257,20,101,1,1,0,0,-2),this.btn_exchange.Move(this.iX+this.iW/2-75,this.iY+this.iH-30-60,150,60),this.btn_exchange.Draw(),ei.end(ei.CONFIRM_GOTOCHARGE)&&ei.bConfirm&&ys.OpenEx()}ProcTouch(i,t,s){return!!this.in_count.ProcTouch(i,t,s)||(this.btn_exchange.ProcTouch(i,t,s)?(this.btn_exchange.bCheck()&&(10*this.in_count.iNumber<=xh.me.rbs.iInGot?(Mh.gi().s_SeverEvent(36,0,this.in_count.iNumber,0,0),ln.gi().PopStat(1)):ei.start(ei.CONFIRM_GOTOCHARGE,"当前元宝不足，是否前往充值？")),!0):3==i&&!bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)&&(ln.gi().PopStat(1),!0))}}Rs.Open=function(){ln.gi().PushStat(ln.GS_EXCHANGEMONEY)};class Gs extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=400,this.iH=130,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new D(gn.xani_button),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_send=new D(gn.xani_button),this.btn_send.InitButton("1号按钮90_60"),this.btn_send.Move(this.iX+this.iW-40-90,this.iY+40-5,90,60),this.btn_send.sName="解锁",this.in_speak=new pi(gn.xani_button),this.in_speak.Move(this.iX+40,this.iY+40,this.iW-40-40-90-20,50),this.in_speak.bHideText=!0,this.in_speak.OpenInput()}Draw(){E.frame_type4("7号框52_52",this.iX,this.iY,this.iW,this.iH,52,52),E.frame_type4("8号框20_20",this.in_speak.iX,this.in_speak.iY,this.in_speak.iW,50,20,20),this.pm3f.DrawTextEx(this.in_speak.iX+10,this.in_speak.iY+this.in_speak.iH/2,this.in_speak.sDetail,4279324257,20,101,1,1,0,0,-2),this.btn_send.Draw(),this.btn_close.Draw(),this.in_speak.onscr()}ProcTouch(i,t,s){return this.in_speak.ProcTouch(i,t,s),this.btn_send.ProcTouch(i,t,s)&&this.btn_send.bCheck()&&(this.in_speak.sDetail.length<=0?L.easymsg.AddMessage("请先输入密码"):this.in_speak.sDetail.length>=20?L.easymsg.AddMessage("密码过长"):(Mh.gi().s_SetLock(1,0,this.in_speak.sDetail),ln.gi().PopStat(1))),!!this.btn_close.ProcTouch(i,t,s)&&(this.btn_close.bCheck()&&ln.gi().PopStat(1),!0)}}Gs.Open=function(){ln.gi().PushStat(ln.GS_LOCKOPEN)};class Es extends s{constructor(i){var t;for(super(),this.pani=i,this.pm3f=i.pm3f,this.iW=290,this.iH=220,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_open=new Array(2),t=0;t<2;t++)this.btn_open[t]=new Wi(gn.xani_button),this.btn_open[t].InitButton("1号按钮210_60");this.btn_open[0].sName="解  锁",this.btn_open[1].sName="强制解锁"}Draw(){E.frame_type4("7号框52_52",this.iX,this.iY,this.iW,this.iH,52,52),this.btn_open[0].Move(this.iX+40,this.iY+40,210,60),this.btn_open[0].Draw(),xh.me.iUnlockTime<100?this.btn_open[1].sName="取消强制解锁":this.btn_open[1].sName="强制解锁",this.btn_open[1].Move(this.iX+40,this.iY+40+60+20,210,60),this.btn_open[1].Draw(),ei.end(ei.CONFIRM_UNLOCK)&&ei.bConfirm&&(Mh.gi().s_SetLock(2,0,"asdf"),ln.gi().PopStat(1))}ProcTouch(i,t,s){if(this.btn_open[0].ProcTouch(i,t,s)&&this.btn_open[0].bCheck())return ln.gi().PopStat(1),Gs.Open(),!0;if(this.btn_open[1].ProcTouch(i,t,s)&&this.btn_open[1].bCheck()){if(xh.me.iUnlockTime<100)return Mh.gi().s_SetLock(3,0,"asdf"),ln.gi().PopStat(1),!0;ei.start(ei.CONFIRM_UNLOCK,"强制解锁需要等待3天观察期，是否确定强制解锁？")}return 3!=i||bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||ln.gi().PopStat(1),!1}}Es.Open=function(){ln.gi().PushStat(ln.GS_LOCKFRAME)};class Os extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=400,this.iH=130,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new D(gn.xani_button),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_send=new D(gn.xani_button),this.btn_send.InitButton("1号按钮90_60"),this.btn_send.Move(this.iX+this.iW-40-90,this.iY+40-5,90,60),this.btn_send.sName="设置",this.in_speak=new pi(gn.xani_ui),this.in_speak.Move(this.iX+40,this.iY+40,this.iW-40-40-90-20,50),this.in_speak.bHideText=!0,this.in_speak.OpenInput()}Draw(){E.frame_type4("7号框52_52",this.iX,this.iY,this.iW,this.iH,52,52),E.frame_type4("8号框20_20",this.in_speak.iX,this.in_speak.iY,this.in_speak.iW,50,20,20),this.pm3f.DrawTextEx(this.in_speak.iX+10,this.in_speak.iY+this.in_speak.iH/2,this.in_speak.sDetail,4279324257,20,101,1,1,0,0,-2),this.btn_send.Draw(),this.btn_close.Draw(),this.in_speak.onscr()}ProcTouch(i,t,s){return this.in_speak.ProcTouch(i,t,s),this.btn_send.ProcTouch(i,t,s)&&this.btn_send.bCheck()&&(this.in_speak.sDetail.length<=0?L.easymsg.AddMessage("请先输入密码"):this.in_speak.sDetail.length>=20?L.easymsg.AddMessage("密码过长"):(Mh.gi().s_SetLock(0,0,this.in_speak.sDetail),ln.gi().PopStat(1))),!!this.btn_close.ProcTouch(i,t,s)&&(this.btn_close.bCheck()&&ln.gi().PopStat(1),!0)}}Os.Open=function(){ln.gi().PushStat(ln.GS_LOCKSET)};class Fs extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=600,this.iH=100,this.iX=(h.SCRW-this.iW)/2,this.iY=0,this.btn_close=new D(gn.xani_ui),this.btn_close.InitButton("统一关闭按钮"),this.btn_close.Move(this.iX+this.iW-60,this.iY+20,60,60),this.btn_send=new D(gn.xani_ui),this.btn_send.InitButton("统一中按钮2"),this.btn_send.Move(this.iX+this.iW-70-70,this.iY+30,70,40),this.btn_send.sName="发送",this.in_speak=new pi(gn.xani_ui),this.in_speak.Move(this.iX+20,this.iY+20,this.iW-180,this.iH-40),this.in_speak.bHideText=!0,this.in_speak.OpenInput()}Draw(){E.Frame2_MD(this.iX,this.iY,this.iW,this.iH),c.gi().FillRect_2D(this.iX+20,this.iY+20,this.iX+this.iW-180,this.iY+this.iH-20,4278190081),Y.gi().Format(this.in_speak.sDetail,this.in_speak.iW-10,20),Y.gi().Draw(this.in_speak.iX+10,this.in_speak.iY+10),this.btn_send.Draw(),this.btn_close.Draw(),this.in_speak.onscr()}ProcTouch(i,t,s){return this.in_speak.ProcTouch(i,t,s),this.btn_send.ProcTouch(i,t,s)&&this.btn_send.bCheck()&&(this.in_speak.sDetail.length<=0?L.easymsg.AddMessage("请先输入内容"):this.in_speak.sDetail.length>=40?L.easymsg.AddMessage("内容过长"):(Mh.gi().s_UseGoods(Fs.goods.iGid,1,this.in_speak.sDetail),ln.gi().PopStat(1))),!!this.btn_close.ProcTouch(i,t,s)&&(this.btn_close.bCheck()&&ln.gi().PopStat(1),!0)}}Fs.goods,Fs.Open=function(i){Fs.goods=i,122==i.iTid&&ln.gi().PushStat(ln.GS_SMALLSPEAKER)};class Xs extends s{constructor(i){var t;for(super(),this.pani=i,this.pm3f=i.pm3f,this.iW=1040,this.iH=610,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_setpoint=new Array(3),t=0;t<3;t++)this.btn_setpoint[t]=new Eh(gn.xani_nui3),this.btn_setpoint[t].InitButton("装备切换按钮"),this.btn_setpoint[t].sName=""+(t+1);for(this.aa_body=new l,this.aa_weapon=new l,this.aa_cls=new Array(5),t=0;t<5;t++)this.aa_cls[t]=new l;this.FreshWeapon(),this.btn_bag1=new Eh(gn.xani_button),this.btn_bag1.InitButton("背包按钮109_61"),this.btn_bag2=new Eh(gn.xani_button),this.btn_bag2.InitButton("行囊按钮109_61"),this.btn_bag3=new Eh(gn.xani_button),this.btn_bag3.InitButton("仓库按钮109_61"),this.btn_locker=new Eh(gn.xani_nui2),this.btn_locker.InitButton("按钮1_110"),this.btn_locker.sName="锁",this.btn_locker.iNameSize=25,this.iBagPoint=0,this.btn_use=new Eh(gn.xani_nui3),this.btn_use.InitButton("内框按钮"),this.btn_use.sName="使 用",this.btn_break=new Eh(gn.xani_nui3),this.btn_break.InitButton("内框按钮"),this.btn_break.sName="分 解",this.btn_drop=new Eh(gn.xani_nui3),this.btn_drop.InitButton("内框按钮"),this.btn_drop.sName="丢 弃",this.btn_checkmoney=new Eh(gn.xani_button),this.btn_checkmoney.InitButton("10号按钮40_40")}GetWeaponTid(){return ht.gi().goods[1][2].iGid<=0?-1:ht.gi().goods[1][2].iTid}FreshWeapon(){var i;this.iWeapTid=this.GetWeaponTid(),this.aa_body=gn.xani_newrole[2*xh.me.iRace+xh.me.iSex].InitAnimaWithName("站立_下",null),this.iWeapTid>=0&&(this.aa_weapon=gn.xani_weap[2*xh.me.iRace+xh.me.iSex][N.WeapFlag(this.iWeapTid)].InitAnimaWithName("站立_下",null));var t=2*xh.me.iRace+xh.me.iSex;for(i=0;i<N._CHANGECOLOR[t].length;i++)xh.me.iColor[i]<=0||xh.me.iColor[i]>=6||gn.xani_color[t][xh.me.iColor[i]-1].InitAnimaWithName(N._CHANGECOLOR[t][i]+"_站立_下",this.aa_cls[i])}Draw(){var i,t,s,e,h,a;for(this.bOperateGoods=!1,E.new_baseframe2(this.iX,this.iY,this.iW,this.iH,"物","品"),this.btn_close.Draw(),E.new_framein(this.iX+30,this.iY+30,480,this.iH-60),h=this.iX+30+25,a=this.iY+30+20,i=0;i<3;i++)xh.me.iFlag[51]%10==i&&(this.btn_setpoint[i].bMouseDown=!0,this.btn_setpoint[i].bMouseIn=!0),this.btn_setpoint[i].Move(h+157*i,a,117,54),this.btn_setpoint[i].Draw();for(a+=74,-1!=ht.gi().goods[1][0].iGid?gn.xani_nui3.DrawAnimaEx(h,a,"物品格子",0,101,1,1,0,0,0):gn.xani_nui3.DrawAnimaEx(h,a,"装备格子",0,101,1,1,0,0,0),-1!=ht.gi().goods[1][2].iGid?gn.xani_nui3.DrawAnimaEx(h,a+85,"物品格子",0,101,1,1,0,0,0):gn.xani_nui3.DrawAnimaEx(h,a+85,"装备格子",2,101,1,1,0,0,0),-1!=ht.gi().goods[1][4].iGid?gn.xani_nui3.DrawAnimaEx(h,a+170,"物品格子",0,101,1,1,0,0,0):gn.xani_nui3.DrawAnimaEx(h,a+170,"装备格子",4,101,1,1,0,0,0),h=this.iX+30+480-25-80,-1!=ht.gi().goods[1][1].iGid?gn.xani_nui3.DrawAnimaEx(h,a,"物品格子",0,101,1,1,0,0,0):gn.xani_nui3.DrawAnimaEx(h,a,"装备格子",1,101,1,1,0,0,0),-1!=ht.gi().goods[1][3].iGid?gn.xani_nui3.DrawAnimaEx(h,a+85,"物品格子",0,101,1,1,0,0,0):gn.xani_nui3.DrawAnimaEx(h,a+85,"装备格子",3,101,1,1,0,0,0),-1!=ht.gi().goods[1][5].iGid?gn.xani_nui3.DrawAnimaEx(h,a+170,"物品格子",0,101,1,1,0,0,0):gn.xani_nui3.DrawAnimaEx(h,a+170,"装备格子",5,101,1,1,0,0,0),this.iSx=this.iX+30+25,this.iSy=a,i=0;i<2;i++)for(t=0;t<3;t++)s=this.iX+30+25+350*i,e=a+85*t,-1!=ht.gi().goods[1][2*t+i].iGid&&ht.gi().goods[1][2*t+i].aa.Draw(s,e);gn.xani_nui3.DrawAnima(this.iX+30+240,this.iY+30+240,"人物背景图",0),G.DrawAura(0,this.iX+30+240,this.iY+30+280,null,0),this.aa_body.Draw(this.iX+30+240,this.iY+30+280);var n=2*xh.me.iRace+xh.me.iSex;for(i=0;i<N._CHANGECOLOR[n].length;i++)xh.me.iColor[i]<=0||xh.me.iColor[i]>=6||(this.aa_cls[i].iFrame=this.aa_body.iFrame,this.aa_cls[i].Draw(this.iX+30+240,this.iY+30+280));this.aa_body.NextFrame(),this.iWeapTid>=0&&(this.aa_weapon.Draw(this.iX+30+240,this.iY+30+280),this.aa_weapon.NextFrame()),h=this.iX+30+25,a+=265,E.new_TagText2(h,a,363,"气血",xh.me.rbs.iHp+"/"+xh.me.rbs.iMaxHp),a+=47,E.new_TagText2(h,a,363,"魔法",xh.me.rbs.iMp+"/"+xh.me.rbs.iMaxMp),a+=47,E.new_TagText2(h,a,120,"灵力",""+xh.me.rbs.iSpirit),E.new_TagText2(h+430-67-120,a,120,"防御",""+xh.me.rbs.iDefence),a+=47,E.new_TagText2(h,a,120,"伤害",""+xh.me.rbs.iAttack),E.new_TagText2(h+430-67-120,a,120,"速度",""+xh.me.rbs.iSpeed),E.new_framein(this.iX+30+480+15,this.iY+30,480,this.iH-60),h=this.iX+30+480+15+25,a=this.iY+30+25,this.btn_bag1.Move(h,a,109,61),this.btn_bag1.Draw(),this.pm3f.DrawText_2(this.btn_bag1.iX+78,this.btn_bag1.iY+17,"背",4294962304,24,101,1,1,0,-2,-2,4,4278199373),this.pm3f.DrawText_2(this.btn_bag1.iX+78,this.btn_bag1.iY+13+30,"包",4294962304,24,101,1,1,0,-2,-2,4,4278199373),this.btn_bag2.Move(h+160.5,a,109,61),this.btn_bag2.Draw(),this.pm3f.DrawText_2(this.btn_bag2.iX+78,this.btn_bag2.iY+17,"行",4294962304,24,101,1,1,0,-2,-2,4,4278199373),this.pm3f.DrawText_2(this.btn_bag2.iX+78,this.btn_bag2.iY+13+30,"囊",4294962304,24,101,1,1,0,-2,-2,4,4278199373),this.btn_bag3.Move(h+480-50-109,a,109,61),this.btn_bag3.Draw(),this.pm3f.DrawText_2(this.btn_bag3.iX+78,this.btn_bag3.iY+17,"仓",4294962304,24,101,1,1,0,-2,-2,4,4278199373),this.pm3f.DrawText_2(this.btn_bag3.iX+78,this.btn_bag3.iY+13+30,"库",4294962304,24,101,1,1,0,-2,-2,4,4278199373),0==this.iBagPoint?gn.xani_nui3.DrawAnima(this.btn_bag1.iX,this.btn_bag1.iY,"背包选中框",0):gn.xani_nui3.DrawAnima(this.btn_bag2.iX,this.btn_bag2.iY,"背包选中框",0),a+=66,qi.new_DrawGoods(h,a,ht.gi().goods[2+this.iBagPoint],null,null),Xs.iGx=h,Xs.iGy=a,a+=365,E.new_TagText2(h,a,120,"铜币",""+xh.me.rbs.iMoney),this.btn_checkmoney.Move(h+67+120+5,a-4,40,40),this.btn_checkmoney.Draw(),E.new_TagText2(h+430-67-120,a,120,"元宝",""+xh.me.rbs.iInGot),a+=47,E.new_TagText2(h,a,120,"储备",""+xh.me.rbs.iReserve),xh.me.bHaveLock?xh.me.bLocked?this.btn_locker.sName="解  锁":this.btn_locker.sName="改锁密":this.btn_locker.sName="加  锁",this.btn_locker.Move(this.iX+30+480+15+480-110-25,a-15,110,52),this.btn_locker.Draw(),ei.end(ei.CONFIRM_DROPPET)&&ei.bConfirm&&Os.Open(),null!=this.lockgoods&&1==this.lockgoods.iOid?(i=this.lockgoods.iPos%2,t=parseInt(this.lockgoods.iPos/2),s=this.iSx+350*i,e=this.iSy+85*t,gn.xani_nui3.DrawAnimaEx(s,e,"物品选中框",0,101,1,1,0,0,0),qi.new_DrawDetail(this.lockgoods,s,e,0)):qi.bShowDetail()&&(qi.new_DrawRect(Xs.iGx,Xs.iGy,ht.gi().goods[2+this.iBagPoint],this.lockgoods,0),2==qi.lastlock.iOid?(qi.new_DrawDetail(null,-1,-1,75),this.bOperateGoods=!0,this.btn_drop.Move(qi.iDetailX+10,qi.iDetailY+qi.iDetailH-55-20,98,55),this.btn_drop.Draw(),gn.de_goods.intValue(qi.lastlock.iTid,0,16)>=0&&(this.btn_break.Move(qi.iDetailX+qi.iDetailW/2-49,qi.iDetailY+qi.iDetailH-55-20,98,55),this.btn_break.Draw()),this.btn_use.Move(qi.iDetailX+qi.iDetailW-98-10,qi.iDetailY+qi.iDetailH-55-20,98,55),this.btn_use.Draw()):qi.new_DrawDetail(null,-1,-1,0)),ei.end(ei.CONFIRM_BREAKGOODS)&&(ei.bConfirm&&null!=this.lockgoods&&this.lockgoods.iGid>0&&2==this.lockgoods.iOid&&(xh.me.bHaveLock&&xh.me.bLocked?L.easymsg.AddMessage("未解锁不能分解"):gn.de_goods.intValue(this.lockgoods.iTid,0,16)<0?Z.fm.Open("只有装备才能分解！"):(Mh.gi().s_RecoverGoods(this.lockgoods.iGid),this.lockgoods.iGid=-1)),qi.bMoving=!1,qi.lastlock=null),ei.end(ei.CONFIRM_DROPGOODS)&&(ei.bConfirm&&null!=this.lockgoods&&this.lockgoods.iGid>0&&2==this.lockgoods.iOid&&(xh.me.bHaveLock&&xh.me.bLocked?L.easymsg.AddMessage("未解锁不能丢弃"):1==gn.de_goods.intValue(this.lockgoods.iTid,0,35)?Z.fm.Open("该物品不可丢弃！"):(Mh.gi().s_DropGoods(this.lockgoods.iGid),this.lockgoods.iGid=-1)),qi.bMoving=!1,qi.lastlock=null),Qi.Draw()}ProcTouch(i,t,s){if(Qi.ProcTouch(i,t,s))return!0;if(this.bOperateGoods){if(this.btn_drop.ProcTouch(i,t,s))return this.btn_drop.bCheck()&&(ei.start(ei.CONFIRM_DROPGOODS,"是否确定丢弃？"),this.btn_drop.SetNormal()),!0;if(qi.lastlock&&gn.de_goods.intValue(qi.lastlock.iTid,0,16)>=0&&this.btn_break.ProcTouch(i,t,s))return this.btn_break.bCheck()&&(ei.start(ei.CONFIRM_BREAKGOODS,"是否确定分解？"),this.btn_break.SetNormal()),!0;if(this.btn_use.ProcTouch(i,t,s))return this.btn_use.bCheck()&&(this.UseGoods(),this.lockgoods=null,qi.lastlock=null,this.btn_use.fScale=1,this.btn_use.iAnimaStat=0),!0}if(this.btn_close.ProcTouch(i,t,s))return this.btn_close.bCheck()&&ln.gi().PopStat(1),!0;if(this.btn_bag1.ProcTouch(i,t,s)&&this.btn_bag1.bCheck()&&(this.iBagPoint=0),this.btn_bag2.ProcTouch(i,t,s)&&this.btn_bag2.bCheck()&&(this.iBagPoint=1),this.btn_bag3.ProcTouch(i,t,s))return this.btn_bag3.bCheck()&&(xh.me.iFlag[20]>60?(ln.gi().PopStat(1),ln.gi().PushStat(ln.GS_GOODSSTOREFROME),ln.gi().PushStat(ln.GS_LOADING1),Mh.gi().s_OpenStore(0,0,0)):Z.fm.Open("仓库管理员在西阳城(103,23)#e#e会员剩余天数>60可随时打开仓库")),!0;var e,h,a,n;for(e=0;e<3;e++)if(this.btn_setpoint[e].ProcTouch(i,t,s)&&this.btn_setpoint[e].bCheck()){if(xh.me.iFlag[51]%10==e)continue;if(Xs.bSELock){L.easymsg.AddMessage("请勿频繁更换装备");continue}Mh.gi().s_SwapEquipment(e),ht.gi().goods[1][0].iGid=-1,ht.gi().goods[1][1].iGid=-1,ht.gi().goods[1][2].iGid=-1,ht.gi().goods[1][3].iGid=-1,ht.gi().goods[1][4].iGid=-1,ht.gi().goods[1][5].iGid=-1,xh.me.iFlag[51]=xh.me.iFlag[51]/10*10+e,Xs.bSELock=!0}for(this.btn_checkmoney.ProcTouch(i,t,s)&&this.btn_checkmoney.bCheck()&&Rs.Open(),this.btn_locker.ProcTouch(i,t,s)&&this.btn_locker.bCheck()&&(xh.me.bHaveLock?xh.me.bLocked?Es.Open():Os.Open():ei.start(ei.CONFIRM_DROPPET,"加锁后，每次登陆需要解锁才能进行（交易，摆摊，丢弃，给予，放生）等功能，是否确定加锁？")),e=0;e<2;e++)for(h=0;h<3;h++)if(a=this.iSx+345*e,n=this.iSy+85*h,bn.bInRect(t,s,a,n,80,80)){if(3==i){if(-1==ht.gi().goods[1][2*h+e].iGid)break;this.lockgoods==ht.gi().goods[1][2*h+e]?(this.UseGoods(),this.lockgoods=null):this.lockgoods=ht.gi().goods[1][2*h+e]}return!0}if(3==i&&null!=this.lockgoods&&qi.bMoving)if(bn.bInRect(t,s,this.btn_bag1.iX,this.btn_bag1.iY,this.btn_bag1.iW,this.btn_bag1.iH)){for(e=0;e<20;e++)if(-1==ht.gi().goods[2][e].iGid){qi.swaplock=ht.gi().goods[2][e],this.MoveGoods(qi.swaplock);break}}else if(bn.bInRect(t,s,this.btn_bag2.iX,this.btn_bag2.iY,this.btn_bag2.iW,this.btn_bag2.iH)){for(e=0;e<20;e++)if(-1==ht.gi().goods[3][e].iGid){qi.swaplock=ht.gi().goods[3][e],this.MoveGoods(qi.swaplock);break}}else if(bn.bInRect(t,s,this.iSx,this.iSy,425,255))0==this.iBagPoint&&this.UseGoods(),qi.lastlock=null;else if(!bn.bInRect(t,s,Xs.iGx,Xs.iGy,425,340))return 2!=this.lockgoods.iOid?(L.easymsg.AddMessage("道具栏的物品才能丢弃"),qi.bMoving=!1):ei.start(ei.CONFIRM_DROPGOODS,"是否确定丢弃？"),!0;return this.lockgoods=qi.new_LockGoods(t,s,Xs.iGx,Xs.iGy,ht.gi().goods[2+this.iBagPoint],i),qi.bCanProc()&&(0==this.iBagPoint&&this.UseGoods(),qi.lastlock=null),qi.bCanMove()&&this.MoveGoods(qi.swaplock),!1}MoveGoods(i){var t,s;if((1!=i.iOid||ht.bCheckEquipment(this.lockgoods,i.iPos))&&(1!=this.lockgoods.iOid||-1==i.iGid||ht.bCheckEquipment(i,this.lockgoods.iPos)))if(318!=this.lockgoods.iTid&&319!=this.lockgoods.iTid&&320!=this.lockgoods.iTid&&321!=this.lockgoods.iTid&&322!=this.lockgoods.iTid&&323!=this.lockgoods.iTid||2!=this.lockgoods.iOid||2==i.iOid){if(Mh.gi().s_MoveGoods(this.lockgoods.iGid,this.lockgoods.iOid,this.lockgoods.iPos,i.iGid,i.iOid,i.iPos),-1==i.iGid)i.copyfrom(this.lockgoods),this.lockgoods.iGid=-1;else if(t=gn.de_goods.intValue(this.lockgoods.iTid,0,28),this.lockgoods.iTid==i.iTid&&t>1)i.iCount>=t||(this.lockgoods.iCount+i.iCount<=t?(i.iCount+=this.lockgoods.iCount,this.lockgoods.iGid=-1):(s=this.lockgoods.iCount+i.iCount,i.iCount=t,this.lockgoods.iCount=s-t));else{var e=new Li;e.copyfrom(i),i.copyfrom(this.lockgoods),this.lockgoods.copyfrom(e)}console.log(this.lockgoods.iOid),1!=this.lockgoods.iOid&&1!=i.iOid||((1==this.lockgoods.iOid&&2==this.lockgoods.iPos||1==i.iOid&&2==i.iPos)&&(xh.me.bwc=!0,this.FreshWeapon()),L.easymsg.snapatt(),xh.me.CalcFightAtt(),L.easymsg.calcattchanged())}else Z.fm.Open("礼包不能移动到行囊和仓库")}UseGoods(){if(null!=this.lockgoods){var i,t;if(1==this.lockgoods.iOid)for(i=0;i<20;i++)if(-1==ht.gi().goods[2][i].iGid)return void this.MoveGoods(ht.gi().goods[2][i]);if(2==this.lockgoods.iOid)if(-1==(t=gn.de_goods.intValue(this.lockgoods.iTid,-1,16))){if(-1!=(t=gn.de_goods.intValue(this.lockgoods.iTid,-1,27))){i=0;for(var s=1,e=gn.de_goods.intValue(this.lockgoods.iTid,0,1),h=gn.de_goods.intValue(this.lockgoods.iTid,0,2);(-1!=e&&xh.me.rbs.iHp<xh.me.rbs.iMaxHp||-1!=h&&xh.me.rbs.iMp<xh.me.rbs.iMaxMp)&&!(s<=0);)-1!=e&&(xh.me.rbs.iHp+=e),-1!=h&&(xh.me.rbs.iMp+=h),s--,i++;return 3==t&&(i=1),void(i<=0&&t<3?L.easymsg.AddMessage("您的状态很好，不需要恢复"):(Mh.gi().s_UseGoods(this.lockgoods.iGid,i,""),this.lockgoods.iCount-=i,this.lockgoods.iCount<=0&&(this.lockgoods.iGid=-1,this.lockgoods=null),xh.me.CalcFightAtt()))}if(-1==(t=gn.de_goods.intValue(this.lockgoods.iTid,-1,33)))if(-1==(t=gn.de_goods.intValue(this.lockgoods.iTid,-1,30)))if(-1==(t=gn.de_goods.intValue(this.lockgoods.iTid,-1,31))){if(-1!=(t=gn.de_goods.intValue(this.lockgoods.iTid,-1,34)))return 1!=t&&3!=t?void L.easymsg.AddMessage("不能直接使用"):void Mh.gi().s_UseGoods(this.lockgoods.iGid,1,"");L.easymsg.AddMessage("未知物品使用失败")}else L.easymsg.AddMessage("不能直接使用");else if(1==t)if(195==this.lockgoods.iTid||328==this.lockgoods.iTid||329==this.lockgoods.iTid||330==this.lockgoods.iTid||331==this.lockgoods.iTid)xh.me.rbs.iGovSkill[1]>0?(ln.gi().PopStat(1),Ts.Open(this.lockgoods,null)):L.easymsg.AddMessage("还未学习炼丹术");else if(this.lockgoods.iTid>=342&&this.lockgoods.iTid<=346)xh.me.rbs.iGovSkill[1]>0?(ln.gi().PopStat(1),Ts.Open(null,this.lockgoods)):L.easymsg.AddMessage("还未学习炼丹术");else if(160==this.lockgoods.iTid||161==this.lockgoods.iTid){var a=et.Open();null!=a&&(a.iPage=1)}else 122==this.lockgoods.iTid?Fs.Open(this.lockgoods):386==this.lockgoods.iTid||387==this.lockgoods.iTid||388==this.lockgoods.iTid?(Mh.gi().s_PromptActivity(0,0),Ns.iOpenFlag=1,ln.gi().PushStat(ln.GS_LOADING1)):(Mh.gi().s_UseGoods(this.lockgoods.iGid,1,""),119==this.lockgoods.iTid&&(ln.gi().PopStat(1),0!=this.lockgoods.iAtts[0]&&(Ih.gi().iMapChangeing=100)));else L.easymsg.AddMessage("不能直接使用");else Mh.gi().s_UseGoods(this.lockgoods.iGid,1,"")}else this.MoveGoods(ht.gi().goods[1][t])}}}Xs.bSELock=!1,Xs.iGx,Xs.iGy;class Ys{Init(){var i;for(this.bEx=Y.gi().bEx,this.WORDSIZE=Y.gi().WORDSIZE,this.iExType=Y.gi().iExType,this.iExColor=Y.gi().iExColor,this.iulc=0,i=0;i<Y.MAXUNIT&&-1!=Y.gi().uls[i].iLp;i++)this.iulc++;for(this.uls=new Array(this.iulc),i=0;i<this.iulc;i++)this.uls[i]=new X,this.uls[i].copyfrom(Y.gi().uls[i])}Draw(i,t){var s;for(s=0;s<this.iulc;s++)switch(this.uls[s].iType){case 0:this.bEx?c.gi().DrawText_2(i+this.uls[s].iX,t+this.uls[s].iY,this.uls[s].sDetail,this.uls[s].iColor,this.WORDSIZE,101,1,1,0,0,0,this.iExType,this.iExColor):c.gi().DrawTextEx(i+this.uls[s].iX,t+this.uls[s].iY,this.uls[s].sDetail,this.uls[s].iColor,this.WORDSIZE,101,1,1,0,0,0);break;case 1:gn.xani_face.InitAnimaWithName(this.uls[s].sDetail,gn.aaa),gn.aaa.SetFrame(gn.iDelay),gn.aaa.DrawEx(i+this.uls[s].iX,t+this.uls[s].iY,101,1,1,0,-1,-1)}}}class Ws{constructor(){this.fsb=new Ys,this.sDest="",this.sPrompt=""}Clean(){this.bFight=!1,this.iProcType=-1,this.bPaoHuan=!1}}class Ls{constructor(){var i;for(this.mi=new Array(Ls.MAXMI),i=0;i<Ls.MAXMI;i++)this.mi[i]=new Ws;this.iW=250,this.iH=300,this.iX=h.SCRW-this.iW-5,this.iY=85,this.btn_oc=new Eh(gn.xani_nui3),this.btn_oc.InitButton("关闭任务"),this.bOpen=!0,this.iMCount=0,this.mi[this.iMCount].sort=0,this.mi[this.iMCount].sName="可接任务",this.mi[this.iMCount].sDest="点击查看",this.mi[this.iMCount].Clean(),this.mi[this.iMCount].bJQ=!1,this.mi[this.iMCount].nm=null,this.mi[this.iMCount].sm=null,this.mi[this.iMCount].iProcType=10,this.iMCount++,this.iOffX=0,this.iOffY=0,this.bLock=!1,this.iLockPoint=-1,this.iLockY=-1,this.bMove=!1}FreshMission(){var i,t,s,e,h,a,n,o,r;for(this.iMCount=0,i=0;i<Us.MAXMISSIONCOUNT;i++){if(Us.m.nmlist[i].bUseing){for(a=Us.m.nmlist[i],e=Us.de_mission.fdata(a.iMPoint),this.mi[this.iMCount].sort=a.iMid,this.mi[this.iMCount].sName=Us.de_mission.strValue(a.iMPoint,0,19),this.mi[this.iMCount].sDetail=Us.de_mission.strValue(a.iMPoint,0,23),this.mi[this.iMCount].Clean(),this.mi[this.iMCount].bJQ=!0,this.mi[this.iMCount].nm=a,this.mi[this.iMCount].sm=null,t=0;t<a.iItemCount;t++)if(null!=(h=e.fitem(a.ni[t].iItemId)))switch(h.iType){case 10:this.mi[this.iMCount].sDest=e.strValue(16),this.mi[this.iMCount].iDestNpcId=e.intValue(5),this.mi[this.iMCount].iProcType=0;break;case 14:this.mi[this.iMCount].sPrompt=Ls.sPetFrom(h.intValue(9)),this.mi[this.iMCount].sDest=h.strValue(17),this.mi[this.iMCount].bFight=!0,this.mi[this.iMCount].iProcType=2;break;case 15:this.mi[this.iMCount].sDest=e.strValue(18),ht.bHaveGoods(e.intValue(8),e.intValue(7))?(this.mi[this.iMCount].iDestNpcId=e.intValue(33),this.mi[this.iMCount].iProcType=0):(this.mi[this.iMCount].sPrompt=Ls.sGoodsFrom(e.intValue(8)),this.mi[this.iMCount].iProcType=2);break;case 20:this.mi[this.iMCount].sDest=e.strValue(24),this.mi[this.iMCount].iDestNpcId=e.intValue(15),this.mi[this.iMCount].bFight=!0,this.mi[this.iMCount].iProcType=0;break;case 26:this.mi[this.iMCount].sPrompt=Ls.sPetFrom(h.intValue(30)),this.mi[this.iMCount].sDest=h.strValue(32),this.mi[this.iMCount].bFight=!0,this.mi[this.iMCount].iProcType=2}"-1"!=(s=e.strValue(22))&&(this.mi[this.iMCount].sPrompt=s,this.mi[this.iMCount].iProcType=2),this.iMCount++}if(Us.m.smlist[i].bUseing){for(n=Us.m.smlist[i],this.mi[this.iMCount].sort=n.iMid,this.mi[this.iMCount].sName=n.sName,0!=n.iMPoint&&50!=n.iMPoint&&51!=n.iMPoint&&52!=n.iMPoint&&53!=n.iMPoint&&54!=n.iMPoint||(this.mi[this.iMCount].sName+="("+n.iCount+"/10)"),this.mi[this.iMCount].sDetail=n.sDetail,this.mi[this.iMCount].Clean(),this.mi[this.iMCount].bJQ=!1,this.mi[this.iMCount].nm=null,this.mi[this.iMCount].sm=n,t=0;t<n.iItemCount;t++)if(!(9!=(o=n.si[t]).iSType&&o.iProc>=100)&&0==o.iMType)switch(o.iSType){case 1:case 7:this.mi[this.iMCount].sDest=o.sDetail,this.mi[this.iMCount].iDestNpcId=o.iV1,this.mi[this.iMCount].iProcType=0;break;case 5:case 8:this.mi[this.iMCount].sDest=o.sDetail,this.mi[this.iMCount].iDestNpcId=o.iV1,this.mi[this.iMCount].iProcType=0,this.mi[this.iMCount].bFight=!0;break;case 0:if(10!=n.iMPoint&&(this.mi[this.iMCount].sDest=o.sDetail),gn.sop(""+o.iV1),ht.bHaveGoods(o.iV1,o.iV2))this.mi[this.iMCount].iDestNpcId=o.iV3,this.mi[this.iMCount].iProcType=0,10==n.iMPoint&&(this.mi[this.iMCount].sPrompt=n.sDetail+"#e#e(手动押镖不能自动寻路)",this.mi[this.iMCount].iProcType=2,this.mi[this.iMCount].sDest=o.sDetail);else{if(10==n.iMPoint)continue;this.mi[this.iMCount].sPrompt=Ls.sGoodsFrom(o.iV1),this.mi[this.iMCount].iProcType=2}break;case 2:this.mi[this.iMCount].bFight=!0;case 6:this.mi[this.iMCount].sDest=o.sDetail,this.mi[this.iMCount].sPrompt=n.sDetail,this.mi[this.iMCount].iProcType=2;break;case 9:this.mi[this.iMCount].sPrompt=Ls.sPetFrom(o.iV1),this.mi[this.iMCount].sPrompt.length<=0&&(this.mi[this.iMCount].sPrompt=n.sDetail),this.mi[this.iMCount].sDest=o.sDetail+"("+o.iProc+"/"+o.iV2+")",this.mi[this.iMCount].bFight=!0,this.mi[this.iMCount].iProcType=2,o.iProc>=o.iV2&&13==n.iMPoint&&(this.mi[this.iMCount].iDestNpcId=20,this.mi[this.iMCount].iProcType=0);break;case 3:this.mi[this.iMCount].sDest=o.sDetail,Bi.bHavePet(o.iV1,o.iV3)?(this.mi[this.iMCount].iDestNpcId=o.iV2,this.mi[this.iMCount].iProcType=0):(this.mi[this.iMCount].sPrompt=Ls.sPetFrom(o.iV1),this.mi[this.iMCount].iProcType=2);break;case 4:this.mi[this.iMCount].bFight=!0,this.mi[this.iMCount].sDest=o.sDetail,this.mi[this.iMCount].sPrompt=n.sDetail,this.mi[this.iMCount].iProcType=2;break;case 10:this.mi[this.iMCount].sDest=o.sDetail,ht.bHaveGoods(o.iV1,o.iV2)?(this.mi[this.iMCount].sPrompt=n.sDetail,this.mi[this.iMCount].iProcType=2):(this.mi[this.iMCount].sPrompt=Ls.sGoodsFrom(o.iV1),this.mi[this.iMCount].iProcType=2);break;case 11:case 14:case 15:case 16:case 17:this.mi[this.iMCount].sDest=o.sDetail,this.mi[this.iMCount].sPrompt=n.sDetail,this.mi[this.iMCount].iProcType=2;break;case 12:this.mi[this.iMCount].bPaoHuan=!0,this.mi[this.iMCount].iPHTime=o.iV1;break;case 13:this.mi[this.iMCount].sDest=o.sDetail,this.mi[this.iMCount].sPrompt=n.sDetail,this.mi[this.iMCount].iProcType=2;break;case 18:this.mi[this.iMCount].sDest=o.sDetail+o.iProc+"/10",this.mi[this.iMCount].sPrompt=n.sDetail,this.mi[this.iMCount].iProcType=2}this.iMCount++}}for(i=0;i<this.iMCount-1;i++)for(t=i+1;t<this.iMCount;t++)this.mi[t].sort>this.mi[i].sort&&(r=this.mi[t],this.mi[t]=this.mi[i],this.mi[i]=r);for(xh.me.rbs.iLev>=10&&(this.mi[this.iMCount].sort=0,this.mi[this.iMCount].sName="可接任务",this.mi[this.iMCount].sDest="点击查看",this.mi[this.iMCount].Clean(),this.mi[this.iMCount].bJQ=!1,this.mi[this.iMCount].nm=null,this.mi[this.iMCount].sm=null,this.mi[this.iMCount].iProcType=10,this.iMCount++),i=0;i<this.iMCount;i++)Y.gi().FormatEx("#cfeeede"+this.mi[i].sDest,230,22,0,0,26),this.mi[i].fsb.Init(),this.mi[i].iEh=Y.gi().iH,this.mi[i].iOh=37+this.mi[i].iEh+8}Draw(){if(!(Ih.gi().vbk.mapdialog.bHideUI()||xs.jq.bJQLock()||this.iMCount<=0)){var i,t;if(this.iOffH=0,this.iX>h.SCRW&&(this.iX=h.SCRW),this.btn_oc.Move(this.iX-50,this.iY,50,70),i=this.iW/4,uh.gi().bShow&&!uh.gi().bCloseing){if(!(this.iX<h.SCRW-5))return;this.iX+=i}else if(this.bOpen)this.iX>h.SCRW-this.iW-5+i?this.iX-=i:this.iX=h.SCRW-this.iW-5,this.btn_oc.Move(this.iX-50,this.iY,50,70),this.btn_oc.Draw();else{if(!(this.iX<h.SCRW))return void this.btn_oc.Draw();this.iX+=i,this.btn_oc.Move(this.iX-50,this.iY,50,70),this.btn_oc.Draw()}for(i=ht.iHaveGoodsCount(),t=Bi.bHavePetCount(),Ls.iOldGoodsCount==i&&Ls.iOldPetCount==t||(Ls.iOldGoodsCount=i,Ls.iOldPetCount=t,this.FreshMission()),c.gi().SetViewClip(this.iX,this.iY,this.iX+this.iW,this.iY+this.iH),i=0;i<this.iMCount;i++)this.mi[i].iOx=this.iX,this.mi[i].iOy=this.iY+this.iOffH+this.iOffY,this.bLock&&this.iLockPoint==i?E.new_framepc(this.mi[i].iOx,this.mi[i].iOy,this.iW,this.mi[i].iOh):c.gi().FillRect_2D(this.mi[i].iOx,this.mi[i].iOy,this.mi[i].iOx+this.iW,this.mi[i].iOy+this.mi[i].iOh,2147483648),c.gi().DrawTextEx(this.mi[i].iOx+8,this.mi[i].iOy+8,this.mi[i].sName,this.mi[i].bJQ?4294902015:4294967040,24,101,1,1,0,0,0),this.mi[i].fsb.Draw(this.mi[i].iOx+8,this.mi[i].iOy+8+24+5),this.mi[i].bFight&&gn.xani_nui3.DrawAnima(this.mi[i].iOx+225,this.mi[i].iOy+25,"战斗标签",0),this.iOffH+=this.mi[i].iOh+2;c.gi().NoClip(),this.bMove||((t=this.iH-this.iOffH)>0&&(t=0),this.iOffY<t&&(this.iOffY<t-50?this.iOffY+=50:this.iOffY=t),this.iOffY>0&&(this.iOffY>50?this.iOffY-=50:this.iOffY=0))}}ProcTouch(i,t,s){if(this.iMCount<=0)return!1;if(uh.gi().bShow&&!uh.gi().bCloseing)return!1;if(!this.bOpen)return!!this.btn_oc.ProcTouch(i,t,s)&&(this.btn_oc.bCheck()&&(this.bOpen=!0,this.btn_oc.InitButton("关闭任务")),!0);if(this.btn_oc.ProcTouch(i,t,s))return this.btn_oc.bCheck()&&(this.bOpen=!1,this.btn_oc.InitButton("打开任务")),!0;var e;if(this.bLock){if(2==i&&(e=s-this.iLockY,this.bMove||(e>20||e<-20)&&(this.bMove=!0),this.bMove&&(this.iOffY+=e,this.iLockY=s,this.iOffY>this.iH-5&&(this.iOffY=this.iH-5),this.iOffY<5-this.iOffH&&(this.iOffY=5-this.iOffH))),3==i)if(this.bLock=!1,this.bMove)this.bMove=!1;else{if(10==this.mi[this.iLockPoint].iProcType)return Xt.Open(1),!0;if(null!=this.mi[this.iLockPoint].nm&&(56==this.mi[this.iLockPoint].nm.iMPoint||59==this.mi[this.iLockPoint].nm.iMPoint||139==this.mi[this.iLockPoint].nm.iMPoint||140==this.mi[this.iLockPoint].nm.iMPoint||141==this.mi[this.iLockPoint].nm.iMPoint||144==this.mi[this.iLockPoint].nm.iMPoint))return Ue.gi().AutoNormalMission(this.mi[this.iLockPoint].nm),!0;if(null!=this.mi[this.iLockPoint].sm){if(50==this.mi[this.iLockPoint].sm.iMPoint||51==this.mi[this.iLockPoint].sm.iMPoint||52==this.mi[this.iLockPoint].sm.iMPoint||53==this.mi[this.iLockPoint].sm.iMPoint||54==this.mi[this.iLockPoint].sm.iMPoint)return Ue.gi().AutoSpecialMission(this.mi[this.iLockPoint].sm),!0;if(10==this.mi[this.iLockPoint].sm.iMPoint&&1==parseInt(xh.me.iFlag[1]/1e8))return Ue.gi().AutoSpecialMission(this.mi[this.iLockPoint].sm),!0}0==this.mi[this.iLockPoint].iProcType&&Ue.gi().FindNpc(this.mi[this.iLockPoint].iDestNpcId,null!=this.mi[this.iLockPoint].nm,null!=this.mi[this.iLockPoint].nm),2==this.mi[this.iLockPoint].iProcType&&(this.mi[this.iLockPoint].bPaoHuan?Z.fm.Open(this.mi[this.iLockPoint].sPrompt+"#e#e剩余时间："+Math.floor((this.mi[this.iLockPoint].iPHTime-(gn.iNowMillis-xh.iMillis)/1e3-xh.iSecond)/60)+"分钟"):Z.fm.Open(this.mi[this.iLockPoint].sPrompt))}return!0}if(1==i&&bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH))for(e=0;e<this.iMCount;e++)if(this.mi[e].iOy<=s&&s<=this.mi[e].iOy+this.mi[e].iOh+2)return this.bLock=!0,this.iLockPoint=e,this.iLockY=s,!0;return!1}special_doyb(){var i;for(i=0;i<this.iMCount;i++)null!=this.mi[i].sm&&10==this.mi[i].sm.iMPoint&&1==parseInt(xh.me.iFlag[1]/1e8)&&Ue.gi().AutoSpecialMission(this.mi[i].sm)}}Ls.MAXMI=20,Ls.ml=null,Ls.gi=function(){return null==Ls.ml&&(Ls.ml=new Ls),Ls.ml},Ls.sGoodsFrom=function(i){var t,s,e=gn.de_goods.fdata(i);if(null==e)return"";if(s=e.strValue(4)+"#e#cffffff",(t=e.intValue(9))>=0)return 0==t&&(s+="0级装备可在【乡水镇】装备商人处购买"),10==t&&(s+="10级装备可在【西阳城】装备商人处购买"),20==t&&(s+="20级装备可在【郢城】装备商人处购买#e#e通过西阳城轿夫前往"),30==t&&(s+="30级装备可在【临淄】装备商人处购买#e#e通过西阳城轿夫前往"),40==t&&(s+="40级装备可在【咸阳】装备商人处购买#e#e通过西阳城轿夫前往"),t>=50&&(s+=t+"级装备，可使用图纸和材料，在【乡水镇】铁匠处打造"),s;if((t=e.intValue(27))>0){if(1==t||2==t)switch(i){case 65:s+="竹叶可在【乡水镇】药品商购买";break;case 66:s+="香草可在【乡水镇】或【西阳城】药品商购买";break;case 67:s+="薄荷可在【西阳城】或【郢城】药品商购买";break;case 68:s+="夏枯草可在【乡水镇】药品商购买";break;case 69:s+="石蜜可在【乡水镇】或【西阳城】药品商购买";break;case 70:s+="止血草可在【西阳城】药品商购买";break;case 71:s+="甘草可在【乡水镇】或【郢城】药品商购买";break;case 72:s+="勺药可在【乡水镇】或【临淄】药品商购买";break;case 73:s+="蜂蜜可在【西阳城】或【临淄】药品商购买";break;case 74:s+="松脂可在【西阳城】药品商购买";break;case 75:s+="云母可在【郢城】药品商购买#e#e通过西阳城轿夫前往";break;case 76:s+="麝香可在【临淄】药品商购买#e#e通过西阳城轿夫前往";break;case 77:s+="赤芝可在【咸阳】药品商购买#e#e通过西阳城轿夫前往";break;case 78:s+="人参可在【郢城】药品商购买#e#e通过西阳城轿夫前往";break;case 79:s+="鹿茸可在【临淄】药品商购买#e#e通过西阳城轿夫前往";break;case 80:s+="熊胆可在【临淄】或【咸阳】药品商购买#e#e通过西阳城轿夫前往";break;case 81:s+="雄黄可在【郢城】或【咸阳】药品商购买#e#e通过西阳城轿夫前往";break;case 82:s+="当归可在【临淄】或【咸阳】药品商购买#e#e通过西阳城轿夫前往";break;case 83:s+="白石英可在【郢城】或【咸阳】药品商购买#e#e通过西阳城轿夫前往";break;case 84:s+="紫石英可在【咸阳】药品商购买#e#e通过西阳城轿夫前往"}return 3==t&&(s+="三级草药通过挖宝或副本获得，部分三级草药可在商城购买"),s}return(t=e.intValue(33))>0?(1==t&&(s+="一级丹药，使用丹方进行炼丹可获得，每完成一轮帮派朱雀任务，可获得一张丹方。在帮派中学习炼丹术，可提高炼出丹药的品质"),2==t&&(s+="二级丹药，可在商城购买"),s):(t=e.intValue(31))>0?(1==t&&(s+="一级材料，完成一轮护法任务有几率获得，护法任务在【咸阳】商鞅处领取，30级以下地图战斗也有几率掉落一级材料。#e任务获得材料种类随机，建议玩家向其他玩家购买所需材料"),2==t&&(s+="二级材料，30级以上完成一轮护法任务有几率获得，护法任务在【咸阳】商鞅处领取，30级以上地图战斗也有几率掉落二级材料。#e任务获得材料种类随机，建议玩家向其他玩家购买所需材料"),3==t&&(s+="三级材料，挖宝有几率获得，或在【咸阳】副本官处使用副本积分兑换#e建议玩家通过交易获得所需材料"),s):(t=e.intValue(34))>=0?s+="在帮派学院学习烹饪技能，即可制作烹饪，技能等级越高，制出烹饪品质越高，也可直接向其他玩家购买":154==i||155==i||156==i?s+="挖宝有几率获得#e战胜嚣张有几率获得#e打开宠物技能包可获得#e建议玩家通过交易购买所需特定宠物技能书":157==i||158==i||159==i?s+="可在商城购买获得":160==i||161==i?s+="挖宝有几率获得#e活动，副本掉落#e向其他玩家购买#e商城购买":226==i||227==i||227==i?s+="周二门派闯关活动中掉落#e或向其他玩家购买":116==i||117==i||118==i||119==i||120==i||121==i||122==i||123==i||207==i||208==i||236==i||106==i||107==i||108==i||229==i?s+="日常活动中获得#e向其他玩家购买#e商城购买":209==i?s+="在【临淄】慎到处拜师或收徒，领取师徒任务，完成师徒任务可获得修炼积分，用于兑换修炼果。也可向其他玩家购买获得":209==i||211==i||212==i?s+="活动中获得，也可向其他玩家购买获得":278==i||279==i?s+="国庆活动中获得":i>=109&&i<=115?s+="野外地图战斗有几率掉落，挖宝有几率获得，或向其他玩家购买":i>=213&&i<=224?s+="新年活动中获得":i>=101&&i<=105?s+="打败妖怪叔叔掉落#e副本，活动中掉落#e或向其他玩家购买":96==i?s+="完成除害任务获得#e副本，活动中掉落#e或向其他玩家购买":97==i?s+="【郢城】栾千盛处完成一轮强盗任务可获得#e挖宝有几率获得#e高级图纸可跑环获得，或用副本积分兑换#e也可向其他玩家购买":98==i||99==i||100==i?s+="在帮派学院学习相应技能即可制作#e也可向其他玩家购买":162==i||225==i||237==i?s+="系统赠送给新玩家的礼物，没有其他获得途径":163==i||164==i?s+="押镖任务物品，任务中自动获得":192==i||193==i||194==i?s+="帮派任务物品，领取任务自动获得":195==i?s+="每完成一轮帮派朱雀任务，可获得一张丹方。#e也可向其他玩家购买":196==i?s+="完成押镖任务有几率获得#e也可向其他玩家购买":230==i?s+="集齐一套七国旗，可在【西阳城】乞丐处兑换高级藏宝图#e也可向其他玩家购买":i>=231&&i<=235?s+="对怪物贝贝使用偷窃技能可获得，偷窃技能可在【西阳山道】狐狸精处学习#e周二门派闯关活动中掉落#e也可向其他玩家购买":238==i||239==i||240==i||241==i||242==i||243==i?s+="展示物品":312==i?s+="周三西阳保卫战中有几率掉落#e【乡水镇】新手指导员处侠义值兑换#e商城购买#e向其他玩家购买":255==i||256==i||257==i||258==i||259==i?s+="挖宝有几率获得#e打开果实有几率获得":260==i||261==i||262==i?s+="商城购买":263==i||264==i||265==i?s+="照料土地时获得的任务物品":i>=266&&i<=270?s+="挖宝获得#e也可向其他玩家购买":271==i||272==i||273==i||274==i||275==i?s+="土地上植物成熟后，采摘得到#e也可向其他玩家购买":276==i||277==i?s+="打开果实有几率获得#e也可向其他玩家购买":280==i||281==i||282==i||283==i||284==i?s+="完成战队秘境可获得#e也可向其他玩家购买":280==i||281==i||282==i||283==i||284==i?s+="打开果实有几率获得#e也可向其他玩家购买":s},Ls.sPetFrom=function(i){var t,s,e,h=0,a=gn.de_pet.fdata(i);if(null==a)return"";for(e=a.strValue(1)+"出现在#c00ff00",t=0;t<gn.de_map.iDataCount;t++)for(s=0;s<gn.de_map.datas[t].iItemCount;s++)4==gn.de_map.datas[t].items[s].iType&&gn.de_map.datas[t].items[s].intValue(6)==i&&(h>0&&(e+="，"),h++,e+=gn.de_map.datas[t].strValue(1));return e+="#o#e#e小地图/#c00ff00世界地图#o查看如何前往#e在野外地图#c00ff00走动#o，会遭遇怪物#e注！将快捷中的#c00ff00遇怪开关#o打开"},Ls.iOldGoodsCount=0,Ls.iOldPetCount=0;class Hs{constructor(){var i;for(this.iGuideing=-1,this.aa_fx=new Array(8),i=0;i<8;i++)this.aa_fx[i]=null;this.iStartDelay=1,this.iTime=0}DrawTextFrame(i,t,s){gn.xani_nui3.DrawAnima(i,t,"指示内容框",0),s>120&&gn.xani_nui3.DrawAnimaEx(i+60,t,"指示内容框",1,101,1*(s-120)/60,1,0,0,0),gn.xani_nui3.DrawAnima(i+s-60,t,"指示内容框",2)}_DrawText(i,t,s,e){this.DrawTextFrame(i-(e+30)/2,t-33,e+30),c.gi().DrawText_2(i,t,s,4294967040,36,101,1,1,0,-2,-2,3,4278190080)}DrawGuide(i,t,s,e,h,a){this.iGuideDelay;if(gn.xani_nui3.DrawAnima(i,t,"指示框1",gn.iDelay/2),gn.xani_nui3.DrawAnima(i+s,t,"指示框2",gn.iDelay/2),gn.xani_nui3.DrawAnima(i+s,t+e,"指示框3",gn.iDelay/2),gn.xani_nui3.DrawAnima(i,t+e,"指示框4",gn.iDelay/2),!(a<0)){var n=c.gi().GetTextWidth(h,36);4294967040;var o=0,r=0;switch(a){case 0:o=i+s/2,r=t+e,gn.xani_nui3.DrawAnimaEx(o,r,"指示箭头",gn.iDelay/2,101,1,1,270,o,r),this._DrawText(o,r+60+33,h,n);break;case 1:o=i+s,r=t+e,gn.xani_nui3.DrawAnimaEx(o,r,"指示箭头",gn.iDelay/2,101,1,1,225,o,r),this._DrawText(o+42+(n+30)/2,r+42+33,h,n);break;case 2:o=i+s,r=t+e/2,gn.xani_nui3.DrawAnimaEx(o,r,"指示箭头",gn.iDelay/2,101,1,1,180,o,r),this._DrawText(o+60+(n+30)/2,r,h,n);break;case 3:o=i+s,r=t,gn.xani_nui3.DrawAnimaEx(o,r,"指示箭头",gn.iDelay/2,101,1,1,135,o,r),this._DrawText(o+42+(n+30)/2,r-42-33,h,n);break;case 4:o=i+s/2,r=t,gn.xani_nui3.DrawAnimaEx(o,r,"指示箭头",gn.iDelay/2,101,1,1,90,o,r),this._DrawText(o,r-60-33,h,n);break;case 5:o=i,r=t,gn.xani_nui3.DrawAnimaEx(o,r,"指示箭头",gn.iDelay/2,101,1,1,45,o,r),this._DrawText(o-42-(n+30)/2,r-42-33,h,n);break;case 6:o=i,r=t+e/2,gn.xani_nui3.DrawAnimaEx(o,r,"指示箭头",gn.iDelay/2,101,1,1,0,o,r),this._DrawText(o-60-(n+30)/2,r,h,n);break;case 7:o=i,r=t+e,gn.xani_nui3.DrawAnimaEx(o,r,"指示箭头",0,101,1,1,315,o,r),this._DrawText(o-42-(n+30)/2,r+42+33,h,n)}}}Draw(){var i;if(-1!=this.iGuideing){for(Z.fm.bShow&&(Z.fm.bShow=!1),i=0;i<8;i++)null==this.aa_fx[i]&&(this.aa_fx[i]=gn.xani_ui.InitAnimaWithName("引导指向_"+i,null));switch(this.DrawGuide(this.iX,this.iY,this.iW,this.iH,this.sMessage,this.iFx),this.iGuideStat){case 0:this.iGuideDelay+=16,this.iGuideDelay>=128&&(this.iGuideStat=1,this.iDelay=0);break;case 1:this.iDelay++,this.iDelay>30&&(this.iGuideStat=2);break;case 3:this.iGuideDelay-=16,this.iGuideDelay<=0&&(this.iGuideing=-1)}}}bCheckGuideExt(i){return 0==(ph.iGuideFlags[parseInt(i/10)]&1<<i%10)&&(ph.iGuideFlags[parseInt(i/10)]|=1<<i%10,!0)}bCheckGuide(i){return 0!=(ph.iGuideFlags[parseInt(i/10)]&1<<i%10)}SetGuideExt(i,t,s,e,h,a){this.iX=i,this.iY=t,this.iW=s,this.iH=e,this.iFx=h,this.iFx>=0&&(this.sMessage=a),this.iGuideing=9999,this.iGuideStat=0,this.iGuideDelay=0,this.bForce=!1}SetGuide(i){if(this.bCheckGuide(i))return!1;this.iGuideing=i,ph.iGuideFlags[parseInt(i/10)]|=1<<i%10,gn.x_record.SaveTo(bn.RECORDFILENAME),gn.sop("打开gd="+i);var t,s,e=ln.gi().LastStat(0);switch(Hs.iEventGuide=0,this.bForce=!0,i){case 1:this.iX=e.btn_prompt.iX,this.iY=e.btn_prompt.iY,this.iW=e.btn_prompt.iW,this.iH=e.btn_prompt.iH,this.sMessage="点击打开任务详细提示",this.iFx=4;break;case 2:this.iX=0,this.iY=0,this.iW=118,this.iH=83,this.sMessage="点击打开小地图",this.iFx=1;break;case 3:this.iX=Oh.x_x,this.iY=Oh.x_y,this.iW=Oh.x_w,this.iH=Oh.x_h,this.sMessage="点击自动前往",this.iFx=6;break;case 4:this.iX=Ls.gi().iX,this.iY=Ls.gi().iY,this.iW=Ls.gi().iW,this.iH=80,this.sMessage="点击前往完成任务",this.iFx=7;break;case 5:case 6:this.iX=h.SCRW-255,this.iY=Ls.gi().iY,this.iW=Ls.gi().iW,this.iH=80,this.sMessage="点击继续任务",this.iFx=7;break;case 10:this.iX=h.SCRW-83,this.iY=0,this.iW=83,this.iH=83,this.sMessage="点击头像打开属性页面",this.iFx=7;break;case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 58:case 59:case 60:this.iX=h.SCRW-83,this.iY=0,this.iW=83,this.iH=83,this.sMessage="经验足够，点击头像/升级按钮",this.iFx=7;break;case 50:yt.Initex("经验已足够升入下一级，点击右上角人物头像打开属性栏，点击#cff0000升级按钮#o升级",0,0,"",0,0,"",2,0,"确定"),this.iGuideing=-1;break;case 11:this.iX=e.btn_upgrade.iX,this.iY=e.btn_upgrade.iY,this.iW=e.btn_upgrade.iW,this.iH=e.btn_upgrade.iH,this.sMessage="你的经验以足够升级，点击升级按钮",this.iFx=6;break;case 12:this.iX=e.btn_addpoint.iX,this.iY=e.btn_addpoint.iY,this.iW=e.btn_addpoint.iW,this.iH=e.btn_addpoint.iH,this.sMessage="每次升级有5点属性可自由分配",this.iFx=6;break;case 13:this.iX=e.btn_add[2].iX,this.iY=e.btn_add[2].iY,this.iW=e.btn_add[2].iW,this.iH=e.btn_add[2].iH,this.sMessage="新玩家建议加力量，以便前期杀怪",this.iFx=0;break;case 14:this.iX=uh.gi().btn_chat1.iX,this.iY=uh.gi().btn_chat1.iY,this.iW=uh.gi().btn_chat1.iW,this.iH=uh.gi().btn_chat1.iH,this.sMessage="收到新的消息，点击查看",this.iFx=6;break;case 20:this.iX=qt.gi().btn_bag.iX,this.iY=qt.gi().btn_bag.iY,this.iW=80,this.iH=80,this.sMessage="点击打开背包",this.iFx=5;break;case 21:for(s=0;s<20;s++)if(ht.gi().goods[2][s].iGid>0&&2==gn.de_goods.intValue(ht.gi().goods[2][s].iTid,0,16)&&gn.de_goods.intValue(ht.gi().goods[2][s].iTid,0,19)==xh.me.iRace&&0==gn.de_goods.intValue(ht.gi().goods[2][s].iTid,0,9)){this.iX=Xs.iGx+5+s%5*85,this.iY=Xs.iGy+5+s/5*85,this.iW=80,this.iH=80,this.sMessage="双击装备穿戴",this.iFx=7;break}s>=20&&(this.iGuideing=-1);break;case 22:this.iX=ht.iX+395,this.iY=ht.iY+155,this.iW=60,this.iH=60,this.sMessage="双击使用/穿戴",this.iFx=0;break;case 30:this.iX=qt.gi().btn_team.iX,this.iY=qt.gi().btn_team.iY,this.iW=qt.gi().btn_team.iW,this.iH=qt.gi().btn_team.iH,this.sMessage="组队打怪可以事半功倍",this.iFx=5;break;case 31:this.iX=qt.gi().btn_team.iX,this.iY=qt.gi().btn_team.iY,this.iW=qt.gi().btn_team.iW,this.iH=qt.gi().btn_team.iH,this.sMessage="闪烁时有玩家申请入队",this.iFx=5;break;case 32:this.iX=e.btn_roles[0].iX,this.iY=e.btn_roles[0].iY,this.iW=e.btn_roles[0].iW,this.iH=e.btn_roles[0].iH,this.sMessage="点击玩家，同意入队",this.iFx=2;break;case 33:this.iX=ws.gi().fat[2][0].iX-30,this.iY=ws.gi().fat[2][0].iY-60,this.iW=60,this.iH=60,this.sMessage="直接点击敌人攻击",this.iFx=2,_s.aff.iAutoFightLast=0;break;case 34:case 95:this.iX=ws.gi().btn_operate[0].iX,this.iY=ws.gi().btn_operate[0].iY,this.iW=80,this.iH=80,this.sMessage="点击法术选择技能",this.iFx=4,_s.aff.iAutoFightLast=0;break;case 35:this.iX=ws.gi().btn_operate[3].iX,this.iY=ws.gi().btn_operate[3].iY,this.iW=80,this.iH=80,this.sMessage="点击防御可以减少伤害",this.iFx=5,_s.aff.iAutoFightLast=0;break;case 36:this.iX=ws.gi().btn_operate[1].iX,this.iY=ws.gi().btn_operate[1].iY,this.iW=80,this.iH=80,this.sMessage="点击道具后使用一个止血草",this.iFx=5,_s.aff.iAutoFightLast=0;break;case 37:this.iX=ws.gi().btn_operate[7].iX,this.iY=ws.gi().btn_operate[7].iY,this.iW=80,this.iH=80,this.sMessage="打不过可以选择逃跑",this.iFx=5,_s.aff.iAutoFightLast=0;break;case 38:this.iX=ws.gi().btn_operate[8].iX,this.iY=ws.gi().btn_operate[8].iY,this.iW=80,this.iH=80,this.sMessage="点击捕捉后选择目标",this.iFx=6,_s.aff.iAutoFightLast=0;break;case 39:this.iX=ws.gi().btn_operate[1].iX,this.iY=ws.gi().btn_operate[1].iY,this.iW=80,this.iH=80,this.sMessage="点击道具后使用一个薄荷",this.iFx=5,_s.aff.iAutoFightLast=0;break;case 61:yt.Initex("点击下方任务按钮，可以查看当前已领的任务，和任务完成条件",0,0,"",0,0,"",5,75,"确定"),this.iGuideing=-1;break;case 62:case 63:case 64:case 65:case 66:case 67:case 68:case 69:case 70:yt.Initex("您有未分配的属性点，可点击#cff0000人物头像/加点#o按钮进行加点，前期建议加力量，加入门派后会自动洗点一次",0,0,"",0,0,"",2,0,"确定"),this.iGuideing=-1;break;case 71:yt.Initex("您当前气血不满，可以打开右下角#cff0000快捷/快捷恢复#o按钮恢复，也可以使用#cff0000红池#o战斗结束自动恢复满气血",0,0,"",0,0,"",2,0,"确定"),this.iGuideing=-1;break;case 72:yt.Initex("您当前魔法不满，可以打开右下角#cff0000快捷/快捷恢复#o按钮恢复，也可以使用#cff0000蓝池#o战斗结束自动恢复满魔法",0,0,"",0,0,"",2,0,"确定"),this.iGuideing=-1;break;case 73:yt.Initex("在野外行走时，怪物会自动与你战斗，可以打开右下角#cff0000快捷/遇怪:开/关#o按钮来屏蔽野外怪物",0,0,"",0,0,"",2,0,"确定"),this.iGuideing=-1;break;case 74:this.iX=qt.gi().btn_qq.iX,this.iY=qt.gi().btn_qq.iY,this.iW=qt.gi().btn_qq.iW,this.iH=qt.gi().btn_qq.iH,this.sMessage="点击这里可打开上次提示",this.iFx=2;break;case 75:this.iX=qt.gi().btn_mission.iX-40,this.iY=qt.gi().btn_mission.iY-80,this.iW=80,this.iH=80,this.sMessage="点击打开任务，可以看到当前任务提示",this.iFx=5;break;case 76:for(s=0;s<20;s++)if(ht.gi().goods[2][s].iGid>0&&97==ht.gi().goods[2][s].iTid){this.iX=Ds.iGx+5+s%5*85,this.iY=Ds.iGy+5+s/5*85,this.iW=80,this.iH=80,this.sMessage="双击图纸",this.iFx=4;break}s>=20&&(this.iGuideing=-1);break;case 79:this.iX=Ds.iX+30+400-20-110,this.iY=Ds.iY+Ds.iH-30-160+160-20-52,this.iW=110,this.iH=52,this.sMessage="点击制造装备",this.iFx=0;break;case 77:yt.Initex("点击上方宠物头像，可以查看#cff0000宠物属性，资质，成长，技能#o",0,0,"",0,0,"",5,78,"确定"),this.iGuideing=-1;break;case 78:this.iX=h.SCRW-83-104-83,this.iY=0,this.iW=83,this.iH=83,this.sMessage="点击宠物头像，查看宠物属性",this.iFx=7;break;case 80:case 82:this.iX=qt.gi().btn_fast.iX,this.iY=qt.gi().btn_fast.iY,this.iW=qt.gi().btn_fast.iW,this.iH=qt.gi().btn_fast.iH,this.sMessage="点击打开快捷",this.iFx=5;break;case 81:this.iX=e.btn_dundi.iX,this.iY=e.btn_dundi.iY,this.iW=e.btn_dundi.iW,this.iH=e.btn_dundi.iH,this.sMessage="点击使用遁地术",this.iFx=6;break;case 83:this.iX=e.btn_dark.iX,this.iY=e.btn_dark.iY,this.iW=e.btn_dark.iW,this.iH=e.btn_dark.iH,this.sMessage="点击关闭遇怪，在野外地图不再碰到怪物",this.iFx=6;break;case 84:this.iX=ns.xfs.btn_skills[0].iX,this.iY=ns.xfs.btn_skills[0].iY,this.iW=ns.xfs.btn_skills[0].iW,this.iH=ns.xfs.btn_skills[0].iH,this.sMessage="点击技能",this.iFx=5;break;case 85:for(t=0;t<20;t++)if(ht.gi().goods[2][t].iGid>0&&70==ht.gi().goods[2][t].iTid&&ht.gi().goods[2][t].iCount>=1){this.iX=us.xfg.iX+5+t%5*85,this.iY=us.xfg.iY+5+t/5*85,this.iW=80,this.iH=80,this.sMessage="双击使用止血草",this.iFx=5;break}break;case 86:this.iX=qt.gi().btn_act.iX,this.iY=qt.gi().btn_act.iY,this.iW=80,this.iH=80,this.sMessage="看看有什么活动可以做",this.iFx=2;break;case 87:case 96:this.iX=ns.xfs.btn_skills[0].iX,this.iY=ns.xfs.btn_skills[0].iY,this.iW=80,this.iH=80,this.sMessage="选择花拳绣腿",this.iFx=5;break;case 88:case 97:this.iX=ws.gi().fat[2][0].iX-30,this.iY=ws.gi().fat[2][0].iY-60,this.iW=60,this.iH=60,this.sMessage="选择攻击目标",this.iFx=2;break;case 89:this.iX=xh.me.btn_petatt.iX,this.iY=xh.me.btn_petatt.iY,this.iW=xh.me.btn_petatt.iW,this.iH=xh.me.btn_petatt.iH,this.sMessage="点击打开宠物界面",this.iFx=0;break;case 90:this.iX=e.btn_joinfight.iX,this.iY=e.btn_joinfight.iY,this.iW=e.btn_joinfight.iW,this.iH=e.btn_joinfight.iH,this.sMessage="点击设置宠物出战",this.iFx=4;break;case 91:this.iX=xh.me.btn_att.iX,this.iY=0,this.iW=83,this.iH=83,this.sMessage="点击头像打开人物属性面板",this.iFx=7;break;case 92:this.iX=e.btn_addpoint.iX,this.iY=e.btn_addpoint.iY,this.iW=e.btn_addpoint.iW,this.iH=e.btn_addpoint.iH,this.sMessage="点击加点，可以分配剩余潜力点",this.iFx=6;break;case 93:this.iX=e.pbtn_recommend.iOffX+e.pbtn_recommend.iX,this.iY=e.pbtn_recommend.iOffY+e.pbtn_recommend.iY,this.iW=e.pbtn_recommend.iW,this.iH=e.pbtn_recommend.iH,this.sMessage="看看怎么加点更合适",this.iFx=6;break;case 94:case 99:this.iX=ws.gi().btn_operate[6].iX,this.iY=ws.gi().btn_operate[6].iY,this.iW=ws.gi().btn_operate[6].iW,this.iH=ws.gi().btn_operate[6].iH,this.sMessage="选择自动模式，即可自动战斗哦~",this.iFx=5;break;case 98:this.iX=ws.gi().fat[2][0].iX-30,this.iY=ws.gi().fat[2][0].iY-60,this.iW=60,this.iH=60,this.sMessage="点击目标攻击",this.iFx=2;break;case 100:Ss.fm.Open("有一只萌萌的宠物可以跟你一起战斗啦~小心~宠物也会死的哦~"),this.iGuideing=-1;break;case 101:Ss.fm.Open("分配好潜能点以后不要忘记点击确认保存哦"),this.iGuideing=-1;break;case 102:this.iX=qt.gi().btn_mounts.iX,this.iY=qt.gi().btn_mounts.iY,this.iW=qt.gi().btn_mounts.iW,this.iH=qt.gi().btn_mounts.iH,this.sMessage="点击打开坐骑界面",this.iFx=5;break;case 103:this.iX=e.btn_joinfight.iX,this.iY=e.btn_joinfight.iY,this.iW=e.btn_joinfight.iW,this.iH=e.btn_joinfight.iH,this.sMessage="点击骑乘坐骑",this.iFx=5}return this.iX<=0&&this.iY<=0&&(this.iGuideing=-1,gn.sop("error guide = "+this.iGuideing)),this.iGuideDelay=0,this.iGuideStat=0,!0}InitGuide(){if(3!=ph.iExtHelp)if(this.iStartDelay>0)ln.gi().LastStatType(0)==ln.GS_GAMEING&&this.iStartDelay--;else if(!(xh.me.rbs.iLev>40)&&!(this.iGuideing>=0)&&!Z.fm.bShow&&!Ih.gi().vbk.mapdialog.bDialoging&&(ln.gi().LastStatType(0)!=ln.GS_GAMEING||ws.bFighting||xs.jq.bJQLock()||!Us.m.bCheckDoing(48)||!this.SetGuide(4))&&(ln.gi().LastStatType(0)!=ln.GS_GAMEING||ws.bFighting||xs.jq.bJQLock()||!Us.m.bCheckDoing(49)||!this.SetGuide(5))&&(ln.gi().LastStatType(0)!=ln.GS_GAMEING||ws.bFighting||xs.jq.bJQLock()||!Us.m.bCheckDoing(50)||!this.SetGuide(6))&&(ln.gi().LastStatType(0)!=ln.GS_GAMEING||ws.bFighting||xs.jq.bJQLock()||Ss.fm.bShow||!Us.m.bCheckDoing(147)||!this.SetGuide(4))&&(ln.gi().LastStatType(0)!=ln.GS_GAMEING||ws.bFighting||xs.jq.bJQLock()||!Ls.gi().bOpen||!Us.m.bCheckDoing(148)||!this.SetGuide(5))&&!(ln.gi().LastStatType(0)==ln.GS_MYATTFRAME&&xh.me.rbs.iExp>=e.iUpgradeExp[xh.me.rbs.iLev]&&this.SetGuide(11))&&(ln.gi().LastStatType(0)!=ln.GS_GAMEING||!uh.gi().bPrivateChatFlash||!this.SetGuide(14))&&(ln.gi().LastStatType(0)!=ln.GS_MYGOODSFRAME||!this.SetGuide(21))&&(ln.gi().LastStatType(0)!=ln.GS_GAMEING||2!=Ih.gi().iCurrentMapId||!this.SetGuide(30))&&(ln.gi().LastStatType(0)!=ln.GS_GAMEING||!qt.gi().bRequestFlash||!this.SetGuide(31))&&!(ln.gi().LastStatType(0)==ln.GS_GAMEING&&xh.me.iFlag[3]<=0&&xh.me.rbs.iHp<xh.me.rbs.iMaxHp&&this.SetGuide(71))&&!(ln.gi().LastStatType(0)==ln.GS_GAMEING&&xh.me.iFlag[4]<=0&&xh.me.rbs.iMp<xh.me.rbs.iMaxMp&&this.SetGuide(72))&&(ln.gi().LastStatType(0)!=ln.GS_GAMEING||!ws.bFighting||1==Ih.gi().iCurrentMapId||!this.SetGuide(73))&&!(ln.gi().LastStatType(0)==ln.GS_GAMEING&&Bi.mp.iPetCount>0&&this.SetGuide(77))&&(ln.gi().LastStatType(0)!=ln.GS_MAKEEQUIP||!this.SetGuide(76))&&(ln.gi().LastStatType(0)!=ln.GS_MAKEEQUIP||!Ds.bCanMake||!this.SetGuide(79))&&(ln.gi().LastStatType(0)!=ln.GS_GAMEING||!Us.m.bCheckDoing(143)||!this.SetGuide(80))&&!(ln.gi().LastStatType(0)==ln.GS_FASTOPERATE&&this.bCheckGuide(80)&&Us.m.bCheckDoing(143)&&this.SetGuide(81))&&(ln.gi().LastStatType(0)!=ln.GS_GAMEING||ws.bFighting||!Us.m.bCheckDoing(23)||!this.SetGuide(86))&&!(ws.bFighting&&0==ws.gi().iFightStat&&Us.m.bCheckDoing(150)&&this.SetGuide(34))&&!(ws.bFighting&&1==ws.gi().iFightStat&&Us.m.bCheckDoing(150)&&this.SetGuide(87))&&!(ws.bFighting&&4==ws.gi().iFightStat&&Us.m.bCheckDoing(150)&&this.SetGuide(88))&&!(ws.bFighting&&0==ws.gi().iFightStat&&Us.m.bCheckDoing(150)&&this.bCheckGuide(88)&&this.SetGuide(94))&&!(ws.bFighting&&0==ws.gi().iFightStat&&Us.m.bCheckDoing(157)&&this.SetGuide(95))&&!(ws.bFighting&&1==ws.gi().iFightStat&&Us.m.bCheckDoing(157)&&this.SetGuide(96))&&!(ws.bFighting&&4==ws.gi().iFightStat&&Us.m.bCheckDoing(157)&&this.SetGuide(97))&&!(ws.bFighting&&10==ws.gi().iFightStat&&Us.m.bCheckDoing(157)&&this.SetGuide(98))&&!(ws.bFighting&&0==ws.gi().iFightStat&&Us.m.bCheckDoing(157)&&this.bCheckGuide(97)&&this.SetGuide(99))&&(ln.gi().LastStatType(0)!=ln.GS_GAMEING||ws.bFighting||!Us.m.bCheckDoing(157)||!this.SetGuide(89))&&(ln.gi().LastStatType(0)!=ln.GS_PETSFRAME||!this.bCheckGuide(89)||!this.SetGuide(90))&&(!this.bCheckGuide(90)||!this.SetGuide(100))&&(!ws.bFighting||0!=ws.gi().iFightStat||1!=ws.gi().iFightType||!this.SetGuide(38))&&(ws.bFighting||ln.gi().LastStatType(0)!=ln.GS_GAMEING||!this.bCheckGuide(38)||!this.SetGuide(82))&&(ws.bFighting||ln.gi().LastStatType(0)!=ln.GS_FASTOPERATE||!this.bCheckGuide(82)||!this.SetGuide(83))&&!(xh.me.rbs.iLev>=10&&xh.me.rbs.iSchoolId>0&&ln.gi().LastStatType(0)==ln.GS_GAMEING&&xh.me.rbs.nut>0&&this.SetGuide(91)||xh.me.rbs.iLev>=10&&xh.me.rbs.iSchoolId>0&&ln.gi().LastStatType(0)==ln.GS_MYATTFRAME&&xh.me.rbs.nut>0&&this.SetGuide(92)||xh.me.rbs.iLev>=10&&xh.me.rbs.iSchoolId>0&&Ei.pxe.IsStat("人物加点")&&this.SetGuide(93)||this.bCheckGuide(93)&&this.SetGuide(101)||xh.me.rbs.iLev>=30&&Ht.mm.iMountsCount>0&&this.SetGuide(102)||ln.gi().LastStatType(0)==ln.GS_MOUNTSFRAME&&xh.me.iFightMid<=0&&this.bCheckGuide(102)&&this.SetGuide(103)||ws.bFighting&&2==ws.gi().iFightStat&&ht.bHaveGoods(70,1)&&this.bCheckGuide(36)&&this.SetGuide(85))){if(Hs.iEventGuide>0){if(33==Hs.iEventGuide&&ws.bFighting&&0==ws.gi().iFightStat&&this.SetGuide(33))return;if(34==Hs.iEventGuide&&ws.bFighting&&0==ws.gi().iFightStat&&this.SetGuide(34))return;if(35==Hs.iEventGuide&&ws.bFighting&&0==ws.gi().iFightStat&&this.SetGuide(35))return;if(36==Hs.iEventGuide&&ws.bFighting&&0==ws.gi().iFightStat&&this.SetGuide(36))return;if(37==Hs.iEventGuide&&ws.bFighting&&0==ws.gi().iFightStat&&this.SetGuide(37))return;if(38==Hs.iEventGuide&&ws.bFighting&&0==ws.gi().iFightStat&&this.SetGuide(38))return;if(39==Hs.iEventGuide&&ws.bFighting&&0==ws.gi().iFightStat&&this.SetGuide(39))return;if(20==Hs.iEventGuide&&ln.gi().LastStatType(0)==ln.GS_GAMEING&&!qt.gi().bOpening&&qt.gi().bShow&&this.SetGuide(20))return;if(61==Hs.iEventGuide&&ln.gi().LastStatType(0)==ln.GS_GAMEING&&this.SetGuide(61))return;if(74==Hs.iEventGuide&&ln.gi().LastStatType(0)==ln.GS_GAMEING&&this.SetGuide(74))return;if(75==Hs.iEventGuide&&ln.gi().LastStatType(0)==ln.GS_GAMEING&&!qt.gi().bOpening&&qt.gi().bShow&&this.SetGuide(75))return;if(78==Hs.iEventGuide&&ln.gi().LastStatType(0)==ln.GS_GAMEING&&this.SetGuide(78))return}this.iTime++,this.iTime%4500==0&&ln.gi().LastStatType(0)==ln.GS_GAMEING&&xh.me.rbs.iLev<20&&xh.me.rbs.nut>0&&(0==xh.me.rbs.iSchoolId&&yt.Initex("您有未分配的属性点，可点击#cff0000人物头像/加点#o按钮进行加点，前期建议加力量，加入门派后会自动洗点一次",0,0,"",0,0,"",2,0,"确定"),this.iGuideing=-1)}}InitGuideFromSever(i){var t=i.GetNextInt();Hs.iEventGuide=t}ProcTouch(i,t,s){return this.iGuideing>=0&&(this.bForce||2==this.iGuideStat&&3==i&&(this.iGuideStat=3),!bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||(3==i&&(this.iGuideing=-1),!1))}}Hs.bg=null,Hs.gi=function(){return null==Hs.bg&&(Hs.bg=new Hs),Hs.bg},Hs.iEventGuide=0;class Bs{constructor(){this.bShow=!1,this.paths=new Array(256);for(var i=0;i<256;i++)this.paths[i]=new Int32Array(3);this.aa_direct=null,this.icmid=-1}InitPath(i,t){if(Ih.gi().mfy.findway(xh.me.iX,xh.me.iY,i,t)){console.log("路径");var s,e,h,a,n,o,r,c,l=0;for(a=Ih.gi().mfy.iPath[0][0],n=Ih.gi().mfy.iPath[0][1],s=1;s<Ih.gi().mfy.iPathDeep;s++){for(o=Ih.gi().mfy.iPath[s][0],r=Ih.gi().mfy.iPath[s][1],c=bn.llength(a,n,o,r),e=1==s?0:60;e<c;e+=60)this.paths[l][0]=a+(o-a)*e/c,this.paths[l][1]=n+(r-n)*e/c,l>0&&(h=bn.GetAngleXY(this.paths[l][0],this.paths[l][1],this.paths[l-1][0],this.paths[l-1][1]),this.paths[l][2]=h<11?12:h<34?11:h<56?10:h<79?9:h<101?8:h<124?7:h<146?6:h<169?5:h<191?4:h<214?3:h<236?2:h<259?1:h<281?0:h<304?15:h<326?14:h<349?13:12),l++;l>0?(a=this.paths[l-1][0],n=this.paths[l-1][1]):(a=o,n=r)}this.iPathSize=l,this.bShow=!0,null==this.aa_direct&&(this.aa_direct=gn.xani_nui5.InitAnimaWithName("步行指向",null)),this.icmid=Ih.gi().iCurrentMapId}}Draw(){if(this.bShow){if(this.icmid!=Ih.gi().iCurrentMapId)return void(this.bShow=!1);for(var i=1;i<this.iPathSize-1;i++)this.aa_direct.iFrame=this.paths[i][2],M.gi().DrawAnima_aa(Ih.gi().iOffy+this.paths[i][1]-50,null,Ih.gi().iOffx+this.paths[i][0],Ih.gi().iOffy+this.paths[i][1],this.aa_direct)}}}Bs.psp=new Bs;class Vs{constructor(){var i;for(this.iProc=new Int32Array(4),i=0;i<4;i++)this.iProc[i]=-1}Init(){var i;for(i=0;i<4;i++)this.iProc[i]=6-2*i}Draw(){if(!(this.iProc[0]<0)){var i,t=0;for(i=0;i<4;i++){switch(this.iProc[i]){case 6:gn.xani_nui3.DrawAnimaEx(h.SCRW/2-90-45+90*i,135,"任务完成",i,20,2.2,2.2,0,0,0);break;case 7:gn.xani_nui3.DrawAnimaEx(h.SCRW/2-90-45+90*i,135,"任务完成",i,40,1.9,1.9,0,0,0);break;case 8:gn.xani_nui3.DrawAnimaEx(h.SCRW/2-90-45+90*i,135,"任务完成",i,60,1.6,1.6,0,0,0);break;case 9:gn.xani_nui3.DrawAnimaEx(h.SCRW/2-90-45+90*i,135,"任务完成",i,80,1.3,1.3,0,0,0);break;case 10:gn.xani_nui3.DrawAnimaEx(h.SCRW/2-90-45+90*i,135,"任务完成",i,101,1,1,0,0,0);break;case 11:gn.xani_nui3.DrawAnimaEx(h.SCRW/2-90-45+90*i,135,"任务完成",i,101,.7,.7,0,0,0);break;case 12:gn.xani_nui3.DrawAnimaEx(h.SCRW/2-90-45+90*i,135,"任务完成",i,101,1,1,0,0,0);break;case 16:default:gn.xani_nui3.DrawAnimaEx(h.SCRW/2-90-45+90*i,135,"任务完成",i,101,1,1,0,0,0)}this.iProc[i]<20?this.iProc[i]++:t++}4==t&&(this.iProc[0]=-1)}}}Vs.mf=new Vs;class Us{constructor(){var i;for(this.nmlist=new Array(Us.MAXMISSIONCOUNT),this.smlist=new Array(Us.MAXMISSIONCOUNT),i=0;i<Us.MAXMISSIONCOUNT;i++)this.nmlist[i]=new Et,this.smlist[i]=new Ft;this.iNMCount=0,this.iSMCount=0}bCheckInMissionMap(i){var t,s;for(t=0;t<Us.MAXMISSIONCOUNT;t++)if(this.smlist[t].bUseing)for(s=0;s<this.smlist[t].iItemCount;s++)if(gn.sop(this.smlist[t].si[s].iSType+",,,"+this.smlist[t].si[s].iV2+",,,"+Ih.gi().iVisualMapId),0==this.smlist[t].si[s].iMType&&(15==this.smlist[t].si[s].iSType||16==this.smlist[t].si[s].iSType||17==this.smlist[t].si[s].iSType)&&this.smlist[t].si[s].iV1==i&&this.smlist[t].si[s].iV2==Ih.gi().iVisualMapId)return gn.sop("true"+this.smlist[t].si[s].iV1),!0;return!1}bCheckDoing(i){var t;for(t=0;t<Us.MAXMISSIONCOUNT;t++)if(this.nmlist[t].bUseing&&this.nmlist[t].iMPoint==i)return!0;return!1}bCheckSpecialDoing(i){var t;for(t=0;t<Us.MAXMISSIONCOUNT;t++)if(this.smlist[t].bUseing&&this.smlist[t].iMPoint==i)return!0;return!1}bCheckRequirement(i){var t,s,e,h=Us.de_mission.datas[Us.de_mission.iValueIndex[i]];for(t=0;t<h.iItemCount;t++)for(s=0;s<h.items[t].iValueCount;s++)switch(h.items[t].values[s].iVid){case 2:if(e=parseInt(h.items[t].values[s].sValue),xh.me.rbs.iLev<e)return!1;break;case 3:if(e=parseInt(h.items[t].values[s].sValue),xh.me.rbs.iSchoolId!=e)return!1;break;case 4:if(e=parseInt(h.items[t].values[s].sValue),xh.me.iSex!=e)return!1}return!0}bCheckCanFinish(i){return!0}CheckMission1(i){var t,s,e;for(gn.sop("Check Mission1 npcid="+i),t=0;t<Us.MAXMISSIONCOUNT;t++)if(this.smlist[t].bUseing)for(s=0;s<this.smlist[t].iItemCount;s++){if(0==this.smlist[t].si[s].iMType&&3==this.smlist[t].si[s].iSType&&this.smlist[t].si[s].iV2==i&&this.smlist[t].si[s].iProc<100){gn.sop("完成条件，抓宠物,finish 1,0"),Mh.gi().s_FinishMission(1,this.smlist[t].iMPoint,0,0);break}if(0==this.smlist[t].si[s].iMType&&1==this.smlist[t].si[s].iSType&&this.smlist[t].si[s].iV1==i&&this.smlist[t].si[s].iProc<100){Mh.gi().s_FinishMission(1,this.smlist[t].iMPoint,0,0);break}if(0==this.smlist[t].si[s].iMType&&0==this.smlist[t].si[s].iSType&&(0==this.smlist[t].si[s].iV3||this.smlist[t].si[s].iV3==i)&&this.smlist[t].si[s].iProc<100)for(e=0;e<20;e++)if(ht.gi().goods[2][e].iGid>0&&ht.gi().goods[2][e].iTid==this.smlist[t].si[s].iV1){Mh.gi().s_FinishMission(1,this.smlist[t].iMPoint,0,0);break}}}getmissionindex(i){var t,s=i.GetNextInt(),e=i.GetNextString(),h=i.GetNextByte();if(0==h){for(t=0;t<Us.MAXMISSIONCOUNT;t++)if(this.nmlist[t].bUseing&&this.nmlist[t].iMid==s)return this.nmlist[t].iType=h,this.nmlist[t].sName=e,this.nmlist[t].iMPoint=i.GetNextInt(),this.nmlist[t].iItemCount=0,this.nmlist[t].bDetailed=!1,Mh.gi().s_GetMissionDetail(s,h),void(59==this.nmlist[t].iMPoint&&(Hs.iEventGuide=61));for(t=0;t<Us.MAXMISSIONCOUNT;t++)if(!this.nmlist[t].bUseing)return this.nmlist[t].bUseing=!0,this.nmlist[t].iMid=s,this.nmlist[t].iType=h,this.nmlist[t].sName=e,this.nmlist[t].iMPoint=i.GetNextInt(),this.nmlist[t].iItemCount=0,this.nmlist[t].bDetailed=!1,Mh.gi().s_GetMissionDetail(s,h),59==this.nmlist[t].iMPoint&&(Hs.iEventGuide=61),void(56==this.nmlist[t].iMPoint&&1==Ih.gi().iCurrentMapId&&Bs.psp.InitPath(1870,1404))}else{for(t=0;t<Us.MAXMISSIONCOUNT;t++)if(this.smlist[t].bUseing&&this.smlist[t].iMid==s)return this.smlist[t].iType=h,this.smlist[t].sName=e,this.smlist[t].sDetail=i.GetNextString(),this.smlist[t].iItemCount=0,this.smlist[t].bDetailed=!1,void Mh.gi().s_GetMissionDetail(s,h);for(t=0;t<Us.MAXMISSIONCOUNT;t++)if(!this.smlist[t].bUseing)return this.smlist[t].bUseing=!0,this.smlist[t].iMid=s,this.smlist[t].iType=h,this.smlist[t].sName=e,this.smlist[t].sDetail=i.GetNextString(),this.smlist[t].iMPoint=i.GetNextInt(),this.smlist[t].iCount=i.GetNextInt(),this.smlist[t].iItemCount=0,this.smlist[t].bDetailed=!1,void Mh.gi().s_GetMissionDetail(s,h)}}linktonpc(){var i,t,s,e,h;for(Ih.gi().vbk.ClearNpcFlag(),i=0;i<Us.MAXMISSIONCOUNT;i++){if(this.smlist[i].bUseing&&this.smlist[i].bDetailed)for(t=0;t<this.smlist[i].iItemCount;t++)if(0==this.smlist[i].si[t].iMType)switch(this.smlist[i].si[t].iSType){case 0:this.smlist[i].si[t].iV3>0&&(this.smlist[i].si[t].iProc>=100?Ih.gi().vbk.SetNpcFlag(this.smlist[i].si[t].iV3,0):Ih.gi().vbk.SetNpcFlag(this.smlist[i].si[t].iV3,1));break;case 1:this.smlist[i].si[t].iProc>=100?Ih.gi().vbk.SetNpcFlag(this.smlist[i].si[t].iV1,0):Ih.gi().vbk.SetNpcFlag(this.smlist[i].si[t].iV1,1)}if(this.nmlist[i].bUseing&&this.nmlist[i].bDetailed)for(e=Us.de_mission.fdata(this.nmlist[i].iMPoint),t=0;t<this.nmlist[i].iItemCount;t++)if(gn.sop("---("+t+")this.nmlist[i].ni[j].iItemId="+this.nmlist[i].ni[t].iItemId),null!=(h=e.fitem(this.nmlist[i].ni[t].iItemId)))switch(h.iType){case 10:s=h.intValue(5),Ih.gi().vbk.SetNpcFlag(s,1);break;case 14:case 15:break;case 20:s=h.intValue(15),Ih.gi().vbk.SetNpcFlag(s,1)}}}getmissiondetail(i){var t,s,e=i.GetNextInt();if(0==i.GetNextByte()){for(t=0;t<Us.MAXMISSIONCOUNT;t++)if(this.nmlist[t].bUseing&&this.nmlist[t].iMid==e){for(this.nmlist[t].iItemCount=i.GetNextByte(),s=0;s<this.nmlist[t].iItemCount;s++)this.nmlist[t].ni[s].iItemId=i.GetNextInt(),this.nmlist[t].ni[s].iProc=i.GetNextInt();return this.nmlist[t].bDetailed=!0,void this.linktonpc()}}else for(t=0;t<Us.MAXMISSIONCOUNT;t++)if(this.smlist[t].bUseing&&this.smlist[t].iMid==e){for(this.smlist[t].iItemCount=i.GetNextByte(),s=0;s<this.smlist[t].iItemCount;s++)this.smlist[t].si[s].iMType=i.GetNextInt(),this.smlist[t].si[s].iSType=i.GetNextInt(),this.smlist[t].si[s].iV1=i.GetNextInt(),this.smlist[t].si[s].iV2=i.GetNextInt(),this.smlist[t].si[s].iV3=i.GetNextInt(),this.smlist[t].si[s].iProc=i.GetNextInt(),this.smlist[t].si[s].sDetail=i.GetNextString();return this.smlist[t].bDetailed=!0,void this.linktonpc()}}cleanclientmission(i){var t,s=i.GetNextInt();for(1==i.GetNextByte()&&Vs.mf.Init(),t=0;t<Us.MAXMISSIONCOUNT;t++)this.smlist[t].bUseing&&this.smlist[t].iMid==s&&(this.smlist[t].bUseing=!1),this.nmlist[t].bUseing&&this.nmlist[t].iMid==s&&(this.nmlist[t].bUseing=!1);Ih.gi().vbk.ClearNpcFlag(),this.linktonpc()}GetAiDest(){var i,t;for(i=0;i<Us.MAXMISSIONCOUNT;i++){if(this.smlist[i].bUseing&&xh.me.iFlag[20]>0)for(t=0;t<this.smlist[i].iItemCount;t++)if(0==this.smlist[i].si[t].iMType)switch(this.smlist[i].si[t].iSType){case 1:case 5:case 7:case 8:return Ue.gi().iDestNpcId=this.smlist[i].si[t].iV1,Ue.gi().sDestDetail=this.smlist[i].si[t].sDetail,!0}if(this.nmlist[i].bUseing){var s=Us.MyMission.de_mission.fdata(this.nmlist[i].iMPoint);if(-1!=s.intValue(5))return Ue.gi().iDestNpcId=s.intValue(5),Ue.gi().sDestDetail=s.strValue(16),!0;if(s.intValue(9),s.intValue(8),-1!=s.intValue(15))return Ue.gi().iDestNpcId=s.intValue(15),Ue.gi().sDestDetail=s.strValue(24),!0;s.intValue(30)}}return!1}}Us.de_mission,Us.MAXMISSIONCOUNT=32,Us.m=new Us;class zs extends q{constructor(){var i;for(super(),this.iType=0,this.iCount=0,this.next=new q(zs.MAXSELECTCOUNT),i=0;i<zs.MAXSELECTCOUNT;i++)this.next[i]=null}}zs.MAXSELECTCOUNT=6;class js extends q{constructor(){var i;for(super(),this.iEid=-1,this.next=null,this.sValues=new Array(js.MAXEVENTVALUE),i=0;i<js.MAXEVENTVALUE;i++)this.sValues[i]=""}}js.MAXEVENTVALUE=8;class Js extends q{constructor(){super(),this.next=null,this.sName=""}}class Qs extends q{constructor(){var i;for(super(),this.iRid=-1,this.next=null,this.sValues=new Array(Qs.MAXREQUIREMENTVALUE),i=0;i<Qs.MAXREQUIREMENTVALUE;i++)this.sValues[i]=""}}Qs.MAXREQUIREMENTVALUE=8;class qs{constructor(){this.opendialog=new K,this.opendialog.iType=4,this.cdlist=new q(32),this.splist=new js(32);for(var i=0;i<32;i++)this.splist[i]=new js}ProcBase_CheckOutDrama(i){var t;if(null!=i&&!this.bBreakCheck)switch(gn.sop("type="+i.iType),i.iType){case 1:this.phead=i,null!=this.phead.next&&this.ProcBase_CheckOutDrama(this.phead.next);break;case 2:for(this.pbranch=i,t=0;t<this.pbranch.iCount;t++)null!=this.pbranch.next[t]&&this.ProcBase_CheckOutDrama(this.pbranch.next[t]);break;case 3:this.prequirement=i,1==this.prequirement.iRid&&(t=parseInt(this.prequirement.sValues[0]),Us.m.bCheckDoing(t)&&(this.opendialog.AddSelect("剧情："+Us.de_mission.strValue(t,0,19),this.prequirement.next),138==t&&(this.bBreakCheck=!0)));break;case 5:this.pevent=i,Ye.pvb.procmap.ProcEvent(this.pevent)}}ProcBase_CheckOutDefault(i){if(null==i)return!1;var t;switch(i.iType){case 1:if(this.phead=i,null!=this.phead.next)return this.ProcBase_CheckOutDefault(this.phead.next);break;case 2:for(this.pbranch=i,t=0;t<this.pbranch.iCount;t++)if(null!=this.pbranch.next[t]&&this.ProcBase_CheckOutDefault(this.pbranch.next[t]))return!0;break;case 3:if(this.prequirement=i,1==this.prequirement.iRid)return!1;if(Ye.pvb.procmap.RequirementCheck(this.prequirement))return this.ProcBase_CheckOutDefault(this.prequirement.next);break;case 4:if(this.pselect=i,this.opendialog.sHead=this.pselect.sHead,this.opendialog.sQuestion=this.pselect.sQuestion,this.bBreakCheck)return!0;for(t=0;t<this.pselect.iCount;t++)xh.me.rbs.iLev>=40&&null!=this.pselect.next[t]&&5==this.pselect.next[t].iType&&(this.pevent=this.pselect.next[t],4==this.pevent.iEid)?(this.splist[this.iSpCount].iType=5,this.splist[this.iSpCount].iEid=4,this.splist[this.iSpCount].sValues[0]="22",this.opendialog.AddSelect("自动任务(得储备)",this.splist[this.iSpCount]),this.iSpCount++,this.opendialog.AddSelect("手动任务(得铜币)",this.pselect.next[t])):this.opendialog.AddSelect(this.pselect.sAnswers[t],this.pselect.next[t]);return!0}return!1}CheckOutSpecialMission(i){var t,s,e=Us.m.smlist;for(t=0;t<Us.MAXMISSIONCOUNT;t++)if(e[t].bUseing)for(s=0;s<e[t].iItemCount;s++){if(0==e[t].si[s].iMType&&3==e[t].si[s].iSType&&e[t].si[s].iV2==i&&e[t].si[s].iProc<100&&Bi.bHavePet(e[t].si[s].iV1,e[t].si[s].iV3)&&(this.splist[this.iSpCount].iType=5,this.splist[this.iSpCount].iEid=11,this.splist[this.iSpCount].sValues[0]=""+e[t].iMPoint,this.opendialog.AddSelect("完成："+e[t].sName,this.splist[this.iSpCount]),this.iSpCount++),0==e[t].si[s].iMType&&1==e[t].si[s].iSType&&e[t].si[s].iV1==i&&e[t].si[s].iProc<100){this.splist[this.iSpCount].iType=5,this.splist[this.iSpCount].iEid=11,this.splist[this.iSpCount].sValues[0]=""+e[t].iMPoint,this.opendialog.AddSelect("完成："+e[t].sName,this.splist[this.iSpCount]),this.iSpCount++;break}if(0==e[t].si[s].iMType&&0==e[t].si[s].iSType&&(0==e[t].si[s].iV3||e[t].si[s].iV3==i)&&e[t].si[s].iProc<100&&ht.bHaveGoods(e[t].si[s].iV1,1)){this.splist[this.iSpCount].iType=5,this.splist[this.iSpCount].iEid=11,this.splist[this.iSpCount].sValues[0]=""+e[t].iMPoint,this.opendialog.AddSelect("完成："+e[t].sName,this.splist[this.iSpCount]),this.iSpCount++;break}if(0==e[t].si[s].iMType&&5==e[t].si[s].iSType&&e[t].si[s].iV1==i&&e[t].si[s].iProc<100){this.splist[this.iSpCount].iType=5,this.splist[this.iSpCount].iEid=11,this.splist[this.iSpCount].sValues[0]=""+e[t].iMPoint,this.opendialog.AddSelect("战斗："+e[t].sName,this.splist[this.iSpCount]),this.iSpCount++;break}if(0==e[t].si[s].iMType&&15==e[t].si[s].iSType&&e[t].si[s].iV1==i&&e[t].si[s].iV2==Ih.gi().iVisualMapId&&e[t].si[s].iProc<100){this.splist[this.iSpCount].iType=5,this.splist[this.iSpCount].iEid=11,this.splist[this.iSpCount].sValues[0]=""+e[t].iMPoint,this.opendialog.AddSelect("完成："+e[t].sName,this.splist[this.iSpCount]),this.iSpCount++;break}if(0==e[t].si[s].iMType&&16==e[t].si[s].iSType&&e[t].si[s].iV1==i&&e[t].si[s].iV2==Ih.gi().iVisualMapId&&e[t].si[s].iProc<100&&ht.bHaveGoods(e[t].si[s].iV3,1)){this.splist[this.iSpCount].iType=5,this.splist[this.iSpCount].iEid=11,this.splist[this.iSpCount].sValues[0]=""+e[t].iMPoint,this.opendialog.AddSelect("完成："+e[t].sName,this.splist[this.iSpCount]),this.iSpCount++;break}}}Open(i){var t;for(this.opendialog.iCount=0,this.opendialog.sQuestion="",this.defaultdialog=null,this.iCdCount=0,this.iSpCount=0,this.bBreakCheck=!1,t=0;t<at.MAXBASESEQUENCE&&(null==i.pss[t]||(this.ProcBase_CheckOutDrama(i.pss[t]),!this.bBreakCheck));t++);for(i.bCurrentBlock&&this.CheckOutSpecialMission(i.iNpcId),t=0;t<at.MAXBASESEQUENCE&&(null==i.pss[t]||(gn.sop("ggggggggggggggggggggg"),!this.ProcBase_CheckOutDefault(i.pss[t])));t++);null!=this.defaultdialog&&this.opendialog.copyfrom(this.defaultdialog),""==!this.opendialog.sQuestion&&("@"!=this.opendialog.sQuestion.charAt(0)&&i.bCurrentBlock&&(this.opendialog.sQuestion="@1n"+parseInt(i.iNpcId/100)+parseInt(i.iNpcId/10)%10+i.iNpcId%10+"t"+this.opendialog.sQuestion),Ye.pvb.mapdialog.InitDialog(this.opendialog,i.sNpcName))}}class Ks{SteeringWheel(){this.iW=160,this.iH=160,this.pm3f=c.xm3f}Draw(){if(!Ih.gi().vbk.mapdialog.bHideUI()&&!xs.jq.bJQLock()&&1!=yh.iWheel){var i,t,s;if(this.iX=this.iW/2,es.gi().bOpen?this.iY=h.SCRH-es.gi().iModifyH-this.iH/2-70:this.iY=h.SCRH-this.iH/2,this.iY>h.SCRH-this.iH/2&&(this.iY=h.SCRH-this.iH/2),gn.xani_ui.DrawAnima(this.iX,this.iY,"方向盘",0),this.bLocked){this.iLockTime++,i=bn.llength(this.iLockX,this.iLockY,this.iX,this.iY);var e=bn.GetAngleXY(this.iLockX,this.iLockY,this.iX,this.iY);if(t=50*Math.cos(e*Math.PI/180),s=50*Math.sin(e*Math.PI/180),rh.iFindWayOnce<=0&&(rh.iFindWayOnce++,H.bNoTeam()||H.bTeamLeader()||H.bAway()))if(Ih.gi().mfy.findway1(xh.me.iX,xh.me.iY,xh.me.iX+t,xh.me.iY+s)){if(Sh.bAutoBoom&&this.bAutoRun)return this.bAutoRun=!1,this.bLocked=!1,void gn.xani_ui.DrawAnima(this.iX,this.iY,"方向盘",1);Ih.gi().mfy.checkagain()&&(Ih.gi().vbk.iGoToNpcFlag=-1,Ih.gi().vbk.iGoToNpcId=-1,xh.me.start(Ih.gi().mfy.iPath,Ih.gi().mfy.iPathDeep))}else if(this.bAutoRun)return this.bAutoRun=!1,this.bLocked=!1,void gn.xani_ui.DrawAnima(this.iX,this.iY,"方向盘",1);i>50?(t=50*Math.cos(e*Math.PI/180),s=50*Math.sin(e*Math.PI/180)):(t=this.iLockX-this.iX,s=this.iLockY-this.iY)}else t=0,s=0;this.bAutoRun&&(t=0,s=0),gn.xani_ui.DrawAnima(this.iX+t,this.iY+s,"方向盘",1)}}ProcTouch(i,t,s){return!Ih.gi().vbk.mapdialog.bHideUI()&&!xs.jq.bJQLock()&&(!ct.gi().bSelling&&(1!=yh.iWheel&&(1==i&&(this.bAutoRun&&(this.bAutoRun=!1,this.bLocked=!1),bn.llength(t,s,this.iX,this.iY)<=80&&(this.iLockTime=0,this.bLocked=!0,this.iLockX=t,this.iLockY=s)),!(!this.bLocked||this.bAutoRun)&&(2==i&&(this.iLockX=t,this.iLockY=s),3!=i||((this.iLockTime>=6||bn.llength(t,s,this.iX,this.iY)<=80)&&(this.bLocked=!1),!0)))))}}Ks.sw=new Ks;class Zs extends s{constructor(i){super(),this.iW=320,this.iH=230,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_ok=new Eh(gn.xani_nui3),this.btn_ok.InitButton("内框按钮"),this.btn_ok.sName="确定",this.btn_cancel=new Eh(gn.xani_nui3),this.btn_cancel.InitButton("内框按钮"),this.btn_cancel.sName="取消",this.in_num=new vs(gn.xani_nui3),this.in_num.iNumber=0,Zs.bOk=!1}Draw(){E.new_framewatch(this.iX,this.iY,this.iW,this.iH),c.gi().DrawTextEx(this.iX+30,this.iY+30,Zs.sTitle,4294967295,30,100,1,1,0,0,0),this.in_num.Move(this.iX+30+30,this.iY+30+30+20,220),this.in_num.Draw(),this.btn_ok.Move(this.iX+30,this.iY+this.iH-30-50,98,50),this.btn_cancel.Move(this.iX+this.iW-30-98,this.iY+this.iH-30-50,98,50),this.btn_ok.Draw(),this.btn_cancel.Draw()}ProcTouch(i,t,s){return!!this.in_num.ProcTouch(i,t,s)||(this.btn_ok.ProcTouch(i,t,s)?(this.btn_ok.bCheck()&&(this.in_num.iNumber>=0?(Zs.iNumber=this.in_num.iNumber,Zs.bFinished=!0,Zs.bOk=!0,ln.gi().PopStat(1),Zs.iIid==Zs.IN_RID&&Mh.gi().s_SeverEvent(17,2,Zs.iNumber,0,0)):L.easymsg.AddMessage("请先输入数字")),!0):!!this.btn_cancel.ProcTouch(i,t,s)&&(this.btn_cancel.bCheck()&&ln.gi().PopStat(1),!0))}}Zs.IN_IN=10,Zs.IN_OUT=20,Zs.IN_RID=30,Zs.iNumber,Zs.iIid,Zs.bFinished=!1,Zs.bOk,Zs.sTitle,Zs.start=function(i,t,s,e){if(ln.gi().LastStatType(0)!=ln.GS_INNUMBER){Zs.iIid=i,Zs.sTitle=t,Zs.iNumber=s;var h=ln.gi().PushStat(ln.GS_INNUMBER);h.in_num.MinMax(0,e),h.in_num.iNumber=s}},Zs.end=function(i){return!(!Zs.bFinished||Zs.iIid!=i)&&(Zs.iIid=0,Zs.bFinished=!1,!0)};class $s extends s{constructor(i){var t,s,e;for(super(),this._costmoney=[[5e4,55132,68678,89593,117319,151466,191736,237882,289700,347010,409655],[1e4,11539,15603,21878,30196,40440,52521,66365,81910,99103,117897]],this.pm3f=c.gi(),this.iNeedTid=new Int32Array(5),this.iNeedCount=new Int32Array(5),this.iHaveCount=new Int32Array(5),this.materials=new Array(5),this.btn_detail=new Array(5),t=0;t<5;t++)this.materials[t]=null;for(this.btn_getfrom=new Eh(gn.xani_button),this.btn_getfrom.InitButton("1号按钮150_60"),this.btn_getfrom.sName="商城购买",this.showgoods=new Li,t=0;t<5;t++)this.btn_detail[t]=new Eh(gn.xani_button),this.btn_detail[t].bSingleButton=!0;this.iShowDetail=-1,this.equips=new Array(32);var a,n=new Int32Array(32);for(this.iCount=0,this.iWearCount=0,t=0;t<6;t++)ht.gi().goods[1][t].iGid>0&&ht.gi().goods[1][t].iAtts[0]>0&&(e=5*gn.de_goods.intValue(ht.gi().goods[1][t].iTid,-1,9)+100,((ht.gi().goods[1][t].iAtts[5]%1e5+19)/20<ht.gi().goods[1][t].iAtts[5]/1e5||ht.gi().goods[1][t].iAtts[5]/1e5<e)&&(n[this.iCount]=ht.gi().goods[1][t].iAtts[5]%1e5*1e4+ht.gi().goods[1][t].iAtts[5]/1e5,this.equips[this.iCount++]=ht.gi().goods[1][t],this.iWearCount++));for(t=0;t<20;t++)if(ht.gi().goods[2][t].iGid>0){if(0==ht.gi().goods[2][t].iAtts[0])continue;gn.de_goods.intValue(ht.gi().goods[2][t].iTid,0,16)>=0&&(e=5*gn.de_goods.intValue(ht.gi().goods[2][t].iTid,-1,9)+100,((ht.gi().goods[2][t].iAtts[5]%1e5+19)/20<ht.gi().goods[2][t].iAtts[5]/1e5||ht.gi().goods[2][t].iAtts[5]/1e5<e)&&(n[this.iCount]=ht.gi().goods[2][t].iAtts[5]%1e5*1e4+ht.gi().goods[2][t].iAtts[5]/1e5,this.equips[this.iCount++]=ht.gi().goods[2][t]))}for(t=0;t<this.iWearCount;t++)for(s=t+1;s<this.iWearCount;s++)n[s]<n[t]&&(e=n[s],n[s]=n[t],n[t]=e,a=this.equips[s],this.equips[s]=this.equips[t],this.equips[t]=a);for(t=this.iWearCount;t<this.iCount;t++)for(s=t+1;s<this.iCount;s++)n[s]<n[t]&&(e=n[s],n[s]=n[t],n[t]=e,a=this.equips[s],this.equips[s]=this.equips[t],this.equips[t]=a);for(this.iCount>0?this.iPoint=0:this.iPoint=-1,this.iW=1030,this.iH=580,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_equips=new Array(this.iCount),t=0;t<this.iCount;t++)this.btn_equips[t]=new Eh(gn.xani_button),this.btn_equips[t].InitButton("11号按钮250_102");for(this.btn_repairtype=new Array(3),t=0;t<3;t++)this.btn_repairtype[t]=new Eh(gn.xani_button),this.btn_repairtype[t].InitButton("1号按钮150_60");this.btn_repairtype[0].sName="普通修理",this.btn_repairtype[1].sName="特殊修理",this.btn_repairtype[2].sName="装备修复",this.btn_repair=new Eh(gn.xani_button),this.btn_repair.InitButton("1号按钮150_60"),this.btn_repair.sName="修理",this.btn_close=new Eh(gn.xani_button),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.iOffY1=0,this.bLocked1=!1,this.iOffY2=0,this.bLocked2=!1}_open(i,t){this.iRepairType=t>=0&&t<=2?t:-1,this.LockGoods()}Draw(){var i,t,s,e,h,a=0,n=0;for(E.new_baseframe4(this.iX,this.iY,this.iW,this.iH,"装","备","修","理"),this.btn_close.Draw(),E.new_framein(this.iX+25,this.iY+25,290,this.iH-50),this.bLocked1||(this.iOffY1>0&&(this.iOffY1/=2),this.iOffY1<0&&this.iDestH1<this.iY+this.iH-45&&(i=this.iY+this.iH-45-this.iDestH1,this.iOffY1+=i/2)),this.bLocked2||(this.iOffY2>0&&(this.iOffY2/=2),this.iOffY2<0&&this.iDestH2<200&&(i=200-this.iDestH2,this.iOffY2+=i/2)),e=this.iX+25+20,h=this.iY+25+20+this.iOffY1,this.pm3f.SetViewClip(this.iX+25+20,this.iY+25+20,this.iX+25+20+250,this.iY+this.iH-25-20),i=0;i<this.iCount;i++)this.btn_equips[i].Move(e,h,250,102),i==this.iPoint&&this.btn_equips[i].setdown(),this.btn_equips[i].Draw(),gn.xani_nui3.DrawAnima(e+11,h+11,"物品格子",0),gn.xani_ngoods.DrawAnima_aa(e+11,h+11,gn.de_goods.strValue(this.equips[i].iTid,0,10),0),i<this.iWearCount&&gn.xani_other.DrawAnima(e+11+80,h+11,"已装备标签",0),s=Math.floor(this.equips[i].iAtts[5]/1e5),0==(t=Math.floor(this.equips[i].iAtts[5]%1e5/20))?gn.xani_other.DrawAnima(e+11,h+11+80,"耐久度过低",1):t<50&&gn.xani_other.DrawAnima(e+11,h+11+80,"耐久度过低",0),c.gi().DrawText_2(e+11+80+10,h+11+5,gn.de_goods.strValue(this.equips[i].iTid,0,4),4294896766,30,101,1,1,0,0,0,3,4278261038),c.gi().DrawTextEx(e+11+80+10,h+11+80-5,"耐久度"+t+"/"+s,4294896766,20,101,1,1,0,0,-3),h+=105;for(this.iDestH1=h,this.pm3f.NoClip(),E.new_framein(this.iX+25+250+40+20,this.iY+25,670,this.iH-50),e=this.iX+25+250+40+20+20,h=this.iY+25+20,E.frame_type4("2号框20_20",e,h,220,220,20,20),E.frame_type4("2号框20_20",e+220+20,h,220,220,20,20),i=0;i<3;i++)this.btn_repairtype[i].Move(e+220+20+220+20,h+80*i,150,60),i==this.iRepairType&&this.btn_repairtype[i].setdown(),this.btn_repairtype[i].Draw();this.iPoint>=0&&this.iPoint<this.iCount&&(i=this.iPoint,gn.xani_nui3.DrawAnima(e+70,h+70,"物品格子",0),gn.xani_ngoods.DrawAnima_aa(e+70,h+70,gn.de_goods.strValue(this.equips[i].iTid,0,10),0),i<this.iWearCount&&gn.xani_other.DrawAnima(e+70+80,h+70,"已装备标签",0),c.gi().DrawText_2(e+70+40,h+70+80+10,gn.de_goods.strValue(this.equips[i].iTid,0,4),4294896766,30,101,1,1,0,-2,0,3,4278261038),this.DrawAtts(e+220+20+10,h+10,this.equips[i]),this.iRepairType>=0&&E.frame_type4("2号框20_20",e,h+220+20,630,160,20,20),a=e,n=h+220+20,630,this.iELev=gn.de_goods.intValue(this.equips[i].iTid,0,9),this.iLimitNJ=100+5*this.iELev,this.iMaxNJ=this.equips[i].iAtts[5]/1e5,this.iCurNJ=this.equips[i].iAtts[5]%1e5/20,this.iEType=gn.de_goods.intValue(this.equips[i].iTid,0,16),a+=315,0==this.iRepairType?(this.iNeedMoney=this._costmoney[this.iRepairType][this.iELev/10],this.btn_detail[0].Move(a-40,n+5,80,80),gn.xani_nui3.DrawAnima(a-40,n+5,"物品格子",0),gn.xani_ngoods.DrawAnima_aa(a-40,n+5,gn.de_goods.strValue(this.iNeedTid[0],0,10),0),null==this.materials[0]?this.pm3f.DrawText_2(a,n+5+80+5,"0/1",4294896766,20,101,1,1,0,-2,0,3,4278261038):this.pm3f.DrawText_2(a,n+5+80+5,"1/1",4294896766,20,101,1,1,0,-2,0,3,4278261038),this.pm3f.DrawText_2(a,n+5+80+5+20,(null==this.materials[0]?this.iELev:this.materials[0].iAtts[0])+"级"+gn.de_goods.strValue(this.iNeedTid[0],0,4),4294896766,20,101,1,1,0,-2,0,3,4278261038),this.pm3f.DrawTextEx(a,n+5+80+10+20+20,"普通修理会消耗耐久上限，耐久上限低于20%无法普通修理",4294967295,18,101,1,1,0,-2,0),this.iNeedMoney>xh.me.rbs.iMoney?this.btn_repair.bDisable=!0:null==this.materials[0]?this.btn_repair.bDisable=!0:this.iMaxNJ<this.iLimitNJ/5?this.btn_repair.bDisable=!0:this.btn_repair.bDisable=!1):1==this.iRepairType?(this.iNeedMoney=this._costmoney[this.iRepairType][this.iELev/10],this.btn_detail[0].Move(a-50-80,n+5,80,80),gn.xani_nui3.DrawAnima(a-50-80,n+5,"物品格子",0),gn.xani_ngoods.DrawAnima_aa(a-50-80,n+5,gn.de_goods.strValue(this.iNeedTid[0],0,10),0),null==this.materials[0]?this.pm3f.DrawText_2(a-50-40,n+5+80+5,"0/1",4294896766,20,101,1,1,0,-2,0,3,4278261038):this.pm3f.DrawText_2(a-50-40,n+5+80+5,"1/1",4294896766,20,101,1,1,0,-2,0,3,4278261038),this.pm3f.DrawText_2(a-50-40,n+5+80+5+20,(null==this.materials[0]?this.iELev:this.materials[0].iAtts[0])+"级"+gn.de_goods.strValue(this.iNeedTid[0],0,4),4294896766,20,101,1,1,0,-2,0,3,4278261038),this.btn_detail[1].Move(a+50,n+5,80,80),gn.xani_nui3.DrawAnima(a+50,n+5,"物品格子",0),gn.xani_ngoods.DrawAnima_aa(a+50,n+5,gn.de_goods.strValue(this.iNeedTid[1],0,10),0),this.pm3f.DrawText_2(a+50+40,n+5+80+5,this.iHaveCount[1]+"/"+this.iNeedCount[1],4294896766,20,101,1,1,0,-2,0,3,4278261038),this.pm3f.DrawText_2(a+50+40,n+5+80+5+20,gn.de_goods.strValue(this.iNeedTid[1],0,4),4294896766,20,101,1,1,0,-2,0,3,4278261038),this.pm3f.DrawTextEx(a,n+5+80+10+20+20,"特殊修理恢复100点耐久，不会损耗耐久上限",4294967295,18,101,1,1,0,-2,0),this.iNeedMoney>xh.me.rbs.iMoney?this.btn_repair.bDisable=!0:null==this.materials[0]?this.btn_repair.bDisable=!0:this.iHaveCount[1]<this.iNeedCount[1]?this.btn_repair.bDisable=!0:this.btn_repair.bDisable=!1):2==this.iRepairType?(this.iNeedMoney=0,this.btn_detail[0].Move(a-40,n+5,80,80),gn.xani_nui3.DrawAnima(a-40,n+5,"物品格子",0),gn.xani_ngoods.DrawAnima_aa(a-40,n+5,gn.de_goods.strValue(this.iNeedTid[0],0,10),0),this.pm3f.DrawText_2(a,n+5+80+5,this.iHaveCount[0]+"/"+this.iNeedCount[0],4294896766,20,101,1,1,0,-2,0,3,4278261038),this.pm3f.DrawText_2(a,n+5+80+5+20,gn.de_goods.strValue(this.iNeedTid[0],0,4),4294896766,20,101,1,1,0,-2,0,3,4278261038),this.pm3f.DrawTextEx(a,n+5+80+10+20+20,"装备修复可以完全修复装备耐久和耐久上限",4294967295,18,101,1,1,0,-2,0),this.iHaveCount[0]<this.iNeedCount[0]?this.btn_repair.bDisable=!0:this.btn_repair.bDisable=!1):this.btn_repair.bDisable=!0,E.ui3_Text1(e,h+220+20+160+20,100,220,"需要铜币",""+(this.iRepairType<0?"":this.iNeedMoney)),E.ui3_Text1(e,h+220+20+160+20+40,100,220,"拥有铜币",""+xh.me.rbs.iMoney),this.btn_repair.Move(this.iX+this.iW-25-20-150,this.iY+this.iH-25-20-60,150,60),this.btn_repair.Draw(),this.LockGoods()),this.iShowDetail>=0&&(0==this.iRepairType?(this.showgoods.SetAtt(1,this.iNeedTid[0],1,this.iELev,0,0,0,0,0,0,0),null==this.materials[0]?(qi.detail_add="#e#cc8bfe7获取途径：1生活技能  2手艺任务",qi.new_DrawDetail(this.showgoods,this.btn_detail[0].iX,this.btn_detail[0].iY,0),qi.detail_add=""):qi.new_DrawDetail(this.materials[0],this.btn_detail[0].iX,this.btn_detail[0].iY,0)):1==this.iRepairType?0==this.iShowDetail?(this.showgoods.SetAtt(1,this.iNeedTid[0],1,this.iELev,0,0,0,0,0,0,0),null==this.materials[0]?(qi.detail_add="#e#cc8bfe7获取途径：1生活技能  2手艺任务",qi.new_DrawDetail(this.showgoods,this.btn_detail[0].iX,this.btn_detail[0].iY,0),qi.detail_add=""):qi.new_DrawDetail(this.materials[0],this.btn_detail[0].iX,this.btn_detail[0].iY,0)):1==this.iShowDetail&&(this.showgoods.SetAtt(1,this.iNeedTid[1],1,0,0,0,0,0,0,0,0),null==this.materials[1]||this.iHaveCount[1]<this.iNeedCount[1]?(qi.detail_add="#e#cc8bfe7获取途径：",qi.new_DrawDetail(this.showgoods,this.btn_detail[1].iX,this.btn_detail[1].iY,80),qi.detail_add="",this.btn_getfrom.Move(qi.iDetailX+qi.iDetailW/2-75,qi.iDetailY+qi.iDetailH-60-20,150,60),this.btn_getfrom.Draw()):qi.new_DrawDetail(this.materials[1],this.btn_detail[1].iX,this.btn_detail[1].iY,0)):2==this.iRepairType&&(this.showgoods.SetAtt(1,this.iNeedTid[0],1,0,0,0,0,0,0,0,0),null==this.materials[0]||this.iHaveCount[0]<this.iNeedCount[0]?(qi.detail_add="#e#cc8bfe7获取途径：",qi.new_DrawDetail(this.showgoods,this.btn_detail[0].iX,this.btn_detail[0].iY,80),qi.detail_add="",this.btn_getfrom.Move(qi.iDetailX+qi.iDetailW/2-75,qi.iDetailY+qi.iDetailH-60-20,150,60),this.btn_getfrom.Draw()):qi.new_DrawDetail(this.materials[0],this.btn_detail[0].iX,this.btn_detail[0].iY,0)))}DrawAtts(i,t,s){var e,h,a,n;this.iDAX=i,this.iDAY=t;var o,r,c="基本属性",l="等级："+gn.de_goods.strValue(s.iTid,-1,9),b=[8,12,40,8,6],_=[0,0,0,0,0];o=Math.floor(s.iAtts[0]/1e4),r=s.iAtts[0]%1e4,(e=Math.floor(s.iAtts[2]/1e4))>0&&(_[Math.floor(e/1e3)]=b[Math.floor(e/1e3)]*(e%1e3)),(e=s.iAtts[2]%1e4)>0&&(_[Math.floor(e/1e3)]=b[Math.floor(e/1e3)]*(e%1e3));var f="";switch(gn.de_goods.intValue(s.iTid,-1,16)){case 0:f="类型：头盔",c+="#e# #cffff00防御 +"+Math.floor(gn.de_goods.intValue(s.iTid,-1,21)+o+_[1]),c+="#e# #cffff00魔法 +"+Math.floor(gn.de_goods.intValue(s.iTid,-1,22)+r),_[1]=0;break;case 1:f="类型：饰品",c+="#e# #cffff00灵力 +"+Math.floor(gn.de_goods.intValue(s.iTid,-1,23)+r+_[4]),_[4]=0;break;case 2:f=0==(h=gn.de_goods.intValue(s.iTid,-1,19))?"类型：武器(剑)":1==h?"类型：武器(刀)":"类型：武器(枪)",c+="#e# #cffff00伤害 +"+Math.floor(gn.de_goods.intValue(s.iTid,-1,3)+r+_[0]),_[0]=0;break;case 3:f=0==(h=gn.de_goods.intValue(s.iTid,-1,20))?"类型：女衣":"类型：铠甲",c+="#e# #cffff00防御 +"+Math.floor(gn.de_goods.intValue(s.iTid,-1,21)+r+_[1]),_[1]=0;break;case 4:f="类型：腰带",c+="#e# #cffff00防御 +"+Math.floor(gn.de_goods.intValue(s.iTid,-1,21)+o+_[1]),c+="#e# #cffff00气血 +"+Math.floor(gn.de_goods.intValue(s.iTid,-1,24)+r+_[2]),_[1]=0,_[2]=0;break;case 5:f="类型：鞋子",c+="#e# #cffff00防御 +"+Math.floor(gn.de_goods.intValue(s.iTid,-1,21)+o+_[1]),c+="#e# #cffff00速度 +"+Math.floor(gn.de_goods.intValue(s.iTid,-1,25)+r+_[3]),_[1]=0,_[3]=0}if(_[0]>0&&(c+="#e# 伤害 +"+_[0]),_[1]>0&&(c+="#e# 防御 +"+_[1]),_[2]>0&&(c+="#e# 气血 +"+_[2]),_[3]>0&&(c+="#e# 速度 +"+_[3]),_[4]>0&&(c+="#e# 灵力 +"+_[4]),o=Math.floor(s.iAtts[1]/1e4),r=s.iAtts[1]%1e4,o>0){const i=Math.floor(o/1e3);0==i?c+="#e# #c00ff00体质 +"+o%1e3:1==i?c+="#e# #c00ff00法力 +"+o%1e3:2==i?c+="#e# #c00ff00力量 +"+o%1e3:3==i?c+="#e# #c00ff00耐力 +"+o%1e3:4==i&&(c+="#e# #c00ff00敏捷 +"+o%1e3)}if(r>0){const i=Math.floor(r/1e3);c+=o<=0?"#e# #c00ff00":" ",0==i?c+="体质 +"+r%1e3:1==i?c+="法力 +"+r%1e3:2==i?c+="力量 +"+r%1e3:3==i?c+="耐力 +"+r%1e3:4==i&&(c+="敏捷 +"+r%1e3)}s.iAtts[4]>0&&((e=s.iAtts[4]>>20&1023)>0&&(c+="#e# #cff8020"+gn.de_skill.strValue(e,0,6)),(e=s.iAtts[4]>>10&1023)>0&&(c+="#e# #c80c0ff特效 : "+gn.de_skill.strValue(e,0,6)),(e=1023&s.iAtts[4])>0&&(c+="#e# #c80c0ff特技 : "+gn.de_skill.strValue(e,0,6))),c+="#e# #cffffff耐久度 : "+Math.floor((s.iAtts[5]%1e5+19)/20)+"/"+Math.floor(s.iAtts[5]/1e5),a=Math.floor(s.iAtts[2]/1e4),n=s.iAtts[2]%1e4,(a>0||n>0)&&(c+="#e #cb48cc8镶嵌等级 : "+(a%1e3+n%1e3),c+="#e# 已镶嵌 : ",a>0&&(c+=gn.de_goods.strValue(Math.floor(a/1e3)+101,0,4)),n>0&&(c+=","+gn.de_goods.strValue(Math.floor(n/1e3)+101,0,4))),s.CalcSetScore(),s.iScore>0&&(c+="#e# #cffffff评分："+s.iScore),e=Math.floor(s.iAtts[3]/1e4);var u=f+"#e"+l+"#e"+c;this.pm3f.SetViewClip(i,t,i+200,t+200),this.pm3f.DrawText_2(i,t+this.iOffY2,"装备属性",4294896766,24,101,1,1,0,0,0,3,4278261038),Y.gi().FormatEx(u,200,20,0,0,22),Y.gi().Draw(i,t+this.iOffY2+26),this.iDestH2=Y.gi().iH+this.iOffY2+26,this.pm3f.NoClip()}ProcTouch(i,t,s){if(this.iShowDetail>=0)return(1==this.iRepairType&&1==this.iShowDetail||2==this.iRepairType)&&this.btn_getfrom.ProcTouch(i,t,s)&&this.btn_getfrom.bCheck()&&(Mh.gi().s_IngotMall(1,0),this.btn_getfrom.SetNormal()),3==i&&(this.iShowDetail=-1),!0;var e,h;if(3==i){if(this.bLocked1)return this.bLocked1=!1,!0;if(this.bLocked2)return this.bLocked2=!1,!0}if(2==i){if(this.bLocked1)return e=this.iLockY1-s,this.iOffY1-=e,this.iLockY1=s,!0;if(this.bLocked2)return e=this.iLockY2-s,this.iOffY2-=e,this.iLockY2=s,!0}if(this.btn_close.ProcTouch(i,t,s))return this.btn_close.bCheck()&&ln.gi().PopStat(1),!0;for(e=0;e<this.iCount;e++)if(this.btn_equips[e].ProcTouch(i,t,s)&&this.btn_equips[e].bCheck()){for(this.iPoint=e,h=0;h<5;h++)this.materials[h]=null;this.LockGoods()}for(e=0;e<3;e++)if(this.btn_repairtype[e].ProcTouch(i,t,s)&&this.btn_repairtype[e].bCheck()){for(this.iRepairType=e,h=0;h<5;h++)this.materials[h]=null;this.LockGoods()}if(this.btn_detail[0].ProcTouch(i,t,s)&&this.btn_detail[0].bCheck()&&(this.iShowDetail=0),1==this.iRepairType&&this.btn_detail[1].ProcTouch(i,t,s)&&this.btn_detail[1].bCheck()&&(this.iShowDetail=1),this.btn_repair.ProcTouch(i,t,s)&&this.btn_repair.bCheck()&&Mh.gi().s_UseSkill(11,this.equips[this.iPoint].iGid,this.iRepairType,0,0,0,0),bn.bInRect(t,s,this.iX+25,this.iY+25,290,this.iH-50)&&(1==i&&(this.iLockY1=s),2==i&&!this.bLocked1&&((e=this.iLockY1-s)<-15||e>15)))for(this.bLocked1=!0,e=0;e<this.iCount;e++)this.btn_equips[e].SetNormal();return bn.bInRect(t,s,this.iDAX,this.iDAY,220,220)&&(1==i&&(this.iLockY2=s),2==i&&(this.bLocked2||((e=this.iLockY2-s)<-15||e>15)&&(this.bLocked2=!0))),!1}LockGoods(){var i;for(i=0;i<5;i++)this.materials[i]=null;i=this.iPoint;var t=this.iRepairType;if(!(i<0))if(this.iELev=gn.de_goods.intValue(this.equips[i].iTid,0,9),this.iLimitNJ=100+5*this.iELev,this.iMaxNJ=this.equips[i].iAtts[5]/1e5,this.iCurNJ=this.equips[i].iAtts[5]%1e5/20,this.iEType=gn.de_goods.intValue(this.equips[i].iTid,0,16),0==t)for(this.iNeedCount[0]=1,0==this.iEType||4==this.iEType?this.iNeedTid[0]=98:1==this.iEType||2==this.iEType?this.iNeedTid[0]=99:3!=this.iEType&&5!=this.iEType||(this.iNeedTid[0]=100),i=0;i<20;i++)ht.gi().goods[2][i].iGid>0&&ht.gi().goods[2][i].iTid==this.iNeedTid[0]&&ht.gi().goods[2][i].iAtts[0]>=this.iELev&&(null==this.materials[0]?this.materials[0]=ht.gi().goods[2][i]:this.materials[0].iAtts[0]>ht.gi().goods[2][i].iAtts[0]?this.materials[0]=ht.gi().goods[2][i]:this.materials[0].iAtts[1]>ht.gi().goods[2][i].iAtts[1]&&(this.materials[0]=ht.gi().goods[2][i]));else if(1==t){for(this.iNeedCount[0]=1,0==this.iEType||4==this.iEType?this.iNeedTid[0]=98:1==this.iEType||2==this.iEType?this.iNeedTid[0]=99:3!=this.iEType&&5!=this.iEType||(this.iNeedTid[0]=100),i=0;i<20;i++)ht.gi().goods[2][i].iGid>0&&ht.gi().goods[2][i].iTid==this.iNeedTid[0]&&ht.gi().goods[2][i].iAtts[0]>=this.iELev&&(null==this.materials[0]?this.materials[0]=ht.gi().goods[2][i]:this.materials[0].iAtts[0]>ht.gi().goods[2][i].iAtts[0]?this.materials[0]=ht.gi().goods[2][i]:this.materials[0].iAtts[1]>ht.gi().goods[2][i].iAtts[1]&&(this.materials[0]=ht.gi().goods[2][i]));for(this.iNeedTid[1]=399,this.iELev<=40?this.iNeedCount[1]=1:this.iELev<=60?this.iNeedCount[1]=2:this.iELev<=80?this.iNeedCount[1]=3:this.iNeedCount[1]=4,this.iHaveCount[1]=0,i=0;i<20;i++)ht.gi().goods[2][i].iGid>0&&ht.gi().goods[2][i].iTid==this.iNeedTid[1]&&(null==this.materials[1]&&(this.materials[1]=ht.gi().goods[2][i]),this.iHaveCount[1]+=ht.gi().goods[2][i].iCount);this.iHaveCount[1]>this.iNeedCount[1]&&(this.iHaveCount[1]=this.iNeedCount[1])}else if(2==t){for(this.iNeedTid[0]=400,this.iELev<=40?this.iNeedCount[0]=3:this.iELev<=60?this.iNeedCount[0]=4:this.iELev<=80?this.iNeedCount[0]=5:this.iNeedCount[0]=6,this.iHaveCount[0]=0,i=0;i<20;i++)ht.gi().goods[2][i].iGid>0&&ht.gi().goods[2][i].iTid==this.iNeedTid[0]&&(null==this.materials[0]&&(this.materials[0]=ht.gi().goods[2][i]),this.iHaveCount[0]+=ht.gi().goods[2][i].iCount);this.iHaveCount[0]>this.iNeedCount[0]&&(this.iHaveCount[0]=this.iNeedCount[0])}}}$s.Open=function(i,t){var s;(s=ln.gi().iXStat==ln.GS_REPAIREQUIP?ln.gi().oCurrentView:ln.gi().PushStat(ln.GS_REPAIREQUIP))._open(i,t),s.iCount<=0&&(Z.fm.Open("当前没有可修理的装备，只有有附加属性或者经过强化的装备才能修理。"),ln.gi().PopStat(1))};class ie extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=400,this.iH=410,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.in_ftname=new pi(gn.xani_frame),this.in_ftname.Move(this.iX+20,this.iY+100,this.iW-40,60),this.in_ftname.bHideText=!0,this.in_ftdetail=new pi(gn.xani_frame),this.in_ftdetail.Move(this.iX+20,this.iY+200,this.iW-40,120),this.in_ftdetail.bHideText=!0,this.btn_create=new Wi(gn.xani_button),this.btn_create.Move(this.iX+this.iW-20-90,this.iY+this.iH-20-60,90,60),this.btn_create.InitButton("1号按钮90_60"),this.btn_create.sName="创建",this.btn_cancel=new Wi(gn.xani_button),this.btn_cancel.Move(this.iX+20,this.iY+this.iH-20-60,90,60),this.btn_cancel.InitButton("1号按钮90_60"),this.btn_cancel.sName="取消"}Draw(){E.frame_type4("10号框20_20",this.iX,this.iY,this.iW,this.iH,20,20),this.pm3f.DrawText_2(this.iX+this.iW/2,this.iY+20,"创建战队",4294896766,32,101,1,1,0,-2,0,2,4278261038),this.pm3f.DrawText_2(this.in_ftname.iX,this.in_ftname.iY-30,"输入战队名称：",4294896766,28,101,1,1,0,0,0,2,4278261038),E.frame_type4("8号框20_20",this.in_ftname.iX,this.in_ftname.iY,this.in_ftname.iW,this.in_ftname.iH,20,20),Y.gi().Format("#c114e61"+this.in_ftname.sDetail,this.in_ftname.iW-10,30),Y.gi().Draw(this.in_ftname.iX+5,this.in_ftname.iY+5),this.pm3f.DrawText_2(this.in_ftdetail.iX,this.in_ftdetail.iY-30,"输入战队简介：",4294896766,28,101,1,1,0,0,0,2,4278261038),E.frame_type4("8号框20_20",this.in_ftdetail.iX,this.in_ftdetail.iY,this.in_ftdetail.iW,this.in_ftdetail.iH,20,20),Y.gi().Format("#c114e61"+this.in_ftdetail.sDetail,this.in_ftdetail.iW-10,30),Y.gi().Draw(this.in_ftdetail.iX+5,this.in_ftdetail.iY+5),this.btn_create.Draw(),this.btn_cancel.Draw(),this.in_ftname.onscr(),this.in_ftdetail.onscr()}ProcTouch(i,t,s){if(this.in_ftname.ProcTouch(i,t,s),this.in_ftdetail.ProcTouch(i,t,s),this.btn_create.ProcTouch(i,t,s)){if(this.btn_create.bCheck()){if(this.in_ftname.sDetail.length<2||this.in_ftname.sDetail.length>8)return L.easymsg.AddMessage("战队名称2-8个字"),!0;if(this.in_ftdetail.sDetail.length<2||this.in_ftdetail.sDetail.length>40)return L.easymsg.AddMessage("战队宗旨2-40个字"),!0;Mh.gi().s_CreateFT(this.in_ftname.sDetail,this.in_ftdetail.sDetail),ln.gi().PopStat(1)}return!0}return this.btn_cancel.ProcTouch(i,t,s)?(this.btn_cancel.bCheck()&&ln.gi().PopStat(1),!0):!!bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)}}ie.Open=function(){ln.gi().PushStat(ln.GS_CREATEFT)};class te{constructor(){this.iFTid=0}}te.mft=new te;class se extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=460,this.iH=420,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_ok=new Wi(gn.xani_button),this.btn_ok.InitButton("1号按钮90_60"),this.btn_ok.Move(this.iX+30,this.iY+this.iH-30-60,90,60),this.btn_ok.sName="报名",this.btn_cancel=new Wi(gn.xani_button),this.btn_cancel.InitButton("1号按钮90_60"),this.btn_cancel.Move(this.iX+this.iW-30-90,this.iY+this.iH-30-60,90,60),this.btn_cancel.sName="取消",this.in_price=new pi(gn.xani_frame),this.in_price.Move(this.iX+180,this.iY+80,200,50),this.in_price.sDetail="500000",this.in_price.bNumber=!0,this.in_price.iTextSize=30,this.in_price.iMaxNumber=99999999,this.in_price.iTextColor=4279324257}Draw(){E.frame_type4("10号框20_20",this.iX,this.iY,this.iW,this.iH,20,20),c.gi().DrawText_2(this.iX+this.iW/2,this.iY+30,"帮战报名",4294896766,32,100,1,1,0,-2,0,2,4278261038),c.gi().DrawText_2(this.iX+35,this.iY+90,"竞选资金:",4294896766,30,100,1,1,0,0,0,2,4278261038),E.frame_type4("8号框20_20",this.in_price.iX,this.in_price.iY,this.in_price.iW,this.in_price.iH,20,20),this.in_price.DrawText(),this.in_price.onscr(),Y.gi().Format("#c114e611,帮战报名时间: 每周四12:00:00~周五18:00:00#e2,竞选要求当前帮派资金>=100万#e3,竞选资金最低为50万，且不能超过[当前帮派资金/3]#e4,周五19:00:00，按竞选资金数额顺序，前8名获得本周帮战资格，系统自动扣除竞选资金(如当前帮派资金低于100万，或低于[竞选资金+(帮派等级+1)*50万]时，取消帮战资格)。",this.iW-40,18),Y.gi().Draw(this.iX+20,this.iY+160),this.btn_ok.Draw(),this.btn_cancel.Draw()}ProcTouch(i,t,s){var e;return this.in_price.ProcTouch(i,t,s),this.btn_ok.ProcTouch(i,t,s)&&this.btn_ok.bCheck()&&((e=parseInt(this.in_price.sDetail))<5e5?L.easymsg.AddMessage("竞选资金不能低于50万"):(Mh.gi().s_SeverEvent(10,1,e,0,0),ln.gi().PopStat(1))),!!this.btn_cancel.ProcTouch(i,t,s)&&(this.btn_cancel.bCheck()&&ln.gi().PopStat(1),!0)}}se.Open=function(){ln.gi().PushStat(ln.GS_APPLYGOVFIGHT)};class ee extends s{constructor(i){var t;for(super(),this.pani=i,this.pm3f=i.pm3f,this.iW=950,this.iH=475,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new D(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_goods=new Array(8),this.gmake=new Array(8),this.igsub=new Array(8),t=0;t<8;t++)this.btn_goods[t]=new D(gn.xani_ui),this.btn_goods[t].InitButton("物品格"),this.gmake[t]=null,this.igsub[t]=1;this.btn_goods[0].Move(this.iX+35+80,this.iY+120,80,80),this.btn_goods[1].Move(this.iX+35+80+140,this.iY+120,80,80),this.btn_make=new Eh(gn.xani_nui2),this.btn_make.InitButton("按钮1_110"),this.btn_make.sName="合并"}Draw(){var i,t,s;for(E.new_baseframe4(this.iX,this.iY,this.iW,this.iH,"丹","方","合","并"),this.btn_close.Draw(),gn.xani_nui3.DrawAnima(this.iX+230,this.iY+200,"炼丹炉背景",0),t=this.iX+this.iW-30-430-40,s=this.iY+30,E.new_framein(t,s,470,this.iH-60),c.gi().DrawTextEx(t+20,s+20,"双击选择丹方：",4278206039,30,101,1,1,0,0,0),this.iGx=t+20,this.iGy=s+20+30,qi.new_DrawGoods(this.iGx,this.iGy,ht.gi().goods[2],this.gmake,this.igsub),null!=this.lockgoods&&qi.new_DrawRect(this.iGx,this.iGy,ht.gi().goods[2],this.lockgoods,0),i=0;i<2;i++)gn.xani_nui3.DrawAnima(this.btn_goods[i].iX,this.btn_goods[i].iY,"物品格子",0),null!=this.gmake[i]&&qi.new_DrawOneGoods_ext(this.btn_goods[i].iX,this.btn_goods[i].iY,this.gmake[i],1);s=this.iY+this.iH-30-160,E.new_framein(this.iX+30,s,400,160);var e="#c003e57"+this.Check();Y.gi().FormatEx(e,360,25,0,0,30),Y.gi().Draw(this.iX+30+20,s+20),this.btn_make.Move(this.iX+30+400-20-110,s+160-20-52,110,52),1==this.iCanMake?(this.btn_make.sName="合并",this.btn_make.Draw()):2==this.iCanMake?(this.btn_make.sName="镶嵌",this.btn_make.Draw()):3==this.iCanMake&&(this.btn_make.sName="使用",this.btn_make.Draw()),qi.bShowDetail()&&qi.new_DrawDetail(null,-1,-1,0)}Check(){return this.iCanMake=0,null==this.gmake[0]?"请先放入需要合并的丹方":-1==gn.de_goods.intValue(this.gmake[0].iTid,-1,16)?null==this.gmake[1]?"请先放入同等级丹方进行合并":this.gmake[1].iTid!=this.gmake[0].iTid?"丹方等级不同，不能合成":(this.iCanMake=1,"#c00ff00可以合并"):"#c00ff00放入物品错误"}ProcTouch(i,t,s){var e;if(this.iCanMake>0&&this.btn_make.ProcTouch(i,t,s)&&this.btn_make.bCheck()){var h=[0,0,0,0,0,0,0,0];for(e=0;e<8;e++)null!=this.gmake[e]&&(h[e]=this.gmake[e].iGid,gn.de_goods.intValue(this.gmake[e].iTid,0,28)>1?(this.gmake[e].iCount--,this.gmake[e].iCount<=0&&(this.gmake[e].iGid=-1)):this.gmake[e].iGid=-1,this.gmake[e]=null);Mh.gi().s_UseSkill(10,h[0],h[1],h[2],h[3],h[4],h[5])}if(this.btn_close.ProcTouch(i,t,s))return this.btn_close.bCheck()&&ln.gi().PopStat(1),!0;for(this.lockgoods=qi.new_LockGoods(t,s,this.iGx,this.iGy,ht.gi().goods[2],i),3==i&&null!=this.lockgoods&&qi.bCanProc()&&(195==this.lockgoods.iTid||328==this.lockgoods.iTid||329==this.lockgoods.iTid||330==this.lockgoods.iTid||331==this.lockgoods.iTid?null==this.gmake[0]?this.gmake[0]=this.lockgoods:null==this.gmake[1]&&this.gmake[0]!=this.lockgoods&&(this.gmake[0].iTid==this.lockgoods.iTid?this.gmake[1]=this.lockgoods:L.easymsg.AddMessage("请放入同等级丹方")):L.easymsg.AddMessage("请放入丹方进行合并"),this.lockgoods=null),e=0;e<2;e++)this.btn_goods[e].ProcTouch(i,t,s)&&this.btn_goods[e].bCheck()&&(this.gmake[e]=null);return!1}}ee.Open=function(){ln.gi().PushStat(ln.GS_GOV_REMEDYMERGE)};class he extends s{constructor(i){super(),this.iW=500,this.iH=240,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.in_govid=new vs(gn.xani_nui3),this.in_govid.iNumber=0,this.in_govid.MinMax(0,3e4),this.btn_go=new Eh(gn.xani_button),this.btn_go.InitButton("普通按钮195_55"),this.btn_go.sName="前往"}Draw(){var i,t,s,e;E.new_bigframe(this.iX,this.iY,this.iW,this.iH),i=this.iX+25,t=this.iY+25,s=this.iW-50,e=this.iH-50,E.frame_type4("中等框a52_50",i,t,s,e,52,50),c.gi().DrawTextEx(i+10,t+35,"请输入想要前往的帮派号码",4278190080,25,101,1,1,0,0,0),this.in_govid.Move(i+275+10,t+35-11,140),this.in_govid.Draw(),this.btn_go.Move(this.iX+this.iW-50-195,this.iY+this.iH-50-55,195,55),this.btn_go.Draw()}ProcTouch(i,t,s){return!!this.in_govid.ProcTouch(i,t,s)||(this.btn_go.ProcTouch(i,t,s)?(this.btn_go.bCheck()&&(ln.gi().PopStat(1),Mh.gi().s_GetIntoGov(this.in_govid.iNumber)),!0):(3!=i||bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||ln.gi().PopStat(1),!1))}}he.Open=function(){ln.gi().iXStat!=ln.GS_GETINGOV&&ln.gi().PushStat(ln.GS_GETINGOV)};class ae extends s{constructor(i){var t;for(super(),140,60,this.iW=471,this.iH=232,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_building=new Eh(9),t=0;t<9;t++)this.btn_building[t]=new Eh(gn.xani_button),this.btn_building[t].InitButton("成员操作131_52"),this.btn_building[t].Move(this.iX+30+t%3*140,this.iY+30+60*Math.floor(t/3),131,52),this.btn_building[t].sName=Fi._GOVBUILDINGS[t]}Draw(){var i;for(E.frame_type4("中等框a52_50",this.iX,this.iY,this.iW,this.iH,52,50),i=0;i<9;i++)this.btn_building[i].Draw()}ProcTouch(i,t,s){var e;for(e=0;e<9;e++)if(this.btn_building[e].ProcTouch(i,t,s))return this.btn_building[e].bCheck()&&(Mh.gi().s_NewGovOperate(18,1,e,0,0,""),Mh.gi().s_NewGovOperate(18,0,0,0,0,""),ln.gi().PopStat(1)),!0;return bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||3!=i||ln.gi().PopStat(1),!1}}ae.Open=function(){ln.gi().PushStat(ln.GS_GOV_SETBUILDING)};class ne extends s{constructor(i){super(),this.iW=360,this.iH=260,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_ok=new Eh(gn.xani_button),this.btn_ok.InitButton("普通按钮140_55"),this.btn_ok.Move(this.iX+this.iW-30-140,this.iY+this.iH-30-55,140,55),this.btn_ok.sName="确定",this.btn_cancel=new Eh(gn.xani_button),this.btn_cancel.InitButton("普通按钮140_55"),this.btn_cancel.Move(this.iX+30,this.iY+this.iH-30-55,140,55),this.btn_cancel.sName="取消",this.in_hid=new pi(gn.xani_ui),this.in_hid.sDetail="",this.in_hid.sBackPrompt="点击这里输入帮派会员",this.in_hid.iBackSize=24,this.in_hid.iTextSize=30}Draw(){var i,t;E.frame_type4("中等框a52_50",this.iX,this.iY,this.iW,this.iH,52,50),E.frame_type1("帮派宣言a20_44",this.iX+this.iW/2-60,this.iY+30,120,20),c.gi().DrawTextEx(this.iX+this.iW/2,this.iY+30+22,"设置敌对",4278190080,25,101,1,1,0,-2,-2),i=this.iX+30,t=this.iY+20+44+30,this.in_hid.Move(i,t,300,47),E.frame_type1("输入框a20_47",i,t,300,20),this.in_hid.DrawText(),this.in_hid.onscr(),this.btn_ok.Draw(),this.btn_cancel.Draw()}ProcTouch(i,t,s){return!!this.in_hid.ProcTouch(i,t,s)||(this.btn_cancel.ProcTouch(i,t,s)?(this.btn_cancel.bCheck()&&ln.gi().PopStat(1),!0):this.btn_ok.ProcTouch(i,t,s)?(this.btn_ok.bCheck()&&(this.in_hid.sDetail.length>0?(Mh.gi().s_NewGovOperate(18,5,0,0,0,this.in_hid.sDetail),Mh.gi().s_NewGovOperate(18,0,0,0,0,""),ln.gi().PopStat(1)):L.easymsg.AddMessage("请先输入敌对帮派会员")),!0):(bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||3!=i||ln.gi().PopStat(1),!1))}}ne.Open=function(){ln.gi().PushStat(ln.GS_GOV_SETHOSTILITY)};class oe extends s{constructor(i){var t;for(super(),140,60,this.iW=471,this.iH=112,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_mt=new Eh(8),t=0;t<3;t++)this.btn_mt[t]=new Eh(gn.xani_button),this.btn_mt[t].InitButton("成员操作131_52"),this.btn_mt[t].Move(this.iX+30+t%3*140,this.iY+30+60*Math.floor(t/3),131,52),this.btn_mt[t].sName=Fi._GOVMTLEV[t]}Draw(){var i;for(E.frame_type4("中等框a52_50",this.iX,this.iY,this.iW,this.iH,52,50),i=0;i<3;i++)this.btn_mt[i].Draw()}ProcTouch(i,t,s){var e;for(e=0;e<3;e++)if(this.btn_mt[e].ProcTouch(i,t,s))return this.btn_mt[e].bCheck()&&(Mh.gi().s_NewGovOperate(18,3,e,0,0,""),Mh.gi().s_NewGovOperate(18,0,0,0,0,""),ln.gi().PopStat(1)),!0;return bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||3!=i||ln.gi().PopStat(1),!1}}oe.Open=function(){ln.gi().PushStat(ln.GS_GOV_SETMTLEV)};class re extends s{constructor(i){super(),this.iW=360,this.iH=260,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_ok=new Eh(gn.xani_button),this.btn_ok.InitButton("普通按钮140_55"),this.btn_ok.Move(this.iX+this.iW-30-140,this.iY+this.iH-30-55,140,55),this.btn_ok.sName="确定",this.btn_cancel=new Eh(gn.xani_button),this.btn_cancel.InitButton("普通按钮140_55"),this.btn_cancel.Move(this.iX+30,this.iY+this.iH-30-55,140,55),this.btn_cancel.sName="取消",this.in_name=new pi(gn.xani_ui),this.in_name.sDetail="",this.in_name.sBackPrompt="点击这里输入新的帮派名字",this.in_name.iBackSize=24,this.in_name.iTextSize=30}Draw(){var i,t;E.frame_type4("中等框a52_50",this.iX,this.iY,this.iW,this.iH,52,50),E.frame_type1("帮派宣言a20_44",this.iX+this.iW/2-60,this.iY+30,120,20),c.gi().DrawTextEx(this.iX+this.iW/2,this.iY+30+22,"帮派改名",4278190080,25,101,1,1,0,-2,-2),i=this.iX+30,t=this.iY+20+44+30,this.in_name.Move(i,t,300,47),E.frame_type1("输入框a20_47",i,t,300,20),this.in_name.DrawText(),this.in_name.onscr(),this.btn_ok.Draw(),this.btn_cancel.Draw()}ProcTouch(i,t,s){if(this.in_name.ProcTouch(i,t,s))return!0;if(this.btn_cancel.ProcTouch(i,t,s))return this.btn_cancel.bCheck()&&ln.gi().PopStat(1),!0;if(this.btn_ok.ProcTouch(i,t,s)){if(this.btn_ok.bCheck())if(this.in_name.sDetail.length>0){var e=this.in_name.sDetail.getBytes("GBK");if(e.length<4||e.length>16)return L.easymsg.AddMessage("帮派名称2-8个字"),!0;Mh.gi().s_NewGovOperate(18,6,0,0,0,this.in_name.sDetail),Mh.gi().s_NewGovOperate(18,0,0,0,0,""),ln.gi().PopStat(1)}else L.easymsg.AddMessage("请先输入新的帮派名称");return!0}return bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||3!=i||ln.gi().PopStat(1),!1}}re.Open=function(){ln.gi().PushStat(ln.GS_GOV_SETNAME)};class ce extends s{constructor(i){var t;for(super(),140,60,this.iW=471,this.iH=232,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_research=new Array(8),t=0;t<8;t++)this.btn_research[t]=new Eh(gn.xani_button),this.btn_research[t].InitButton("成员操作131_52"),this.btn_research[t].Move(this.iX+30+t%3*140,this.iY+30+60*Math.floor(t/3),131,52),this.btn_research[t].sName=Fi._GOVSKILLS[t]}Draw(){var i;for(E.frame_type4("中等框a52_50",this.iX,this.iY,this.iW,this.iH,52,50),i=0;i<8;i++)this.btn_research[i].Draw()}ProcTouch(i,t,s){var e;for(e=0;e<8;e++)if(this.btn_research[e].ProcTouch(i,t,s))return this.btn_research[e].bCheck()&&(Mh.gi().s_NewGovOperate(18,2,e,0,0,""),Mh.gi().s_NewGovOperate(18,0,0,0,0,""),ln.gi().PopStat(1)),!0;return bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||3!=i||ln.gi().PopStat(1),!1}}ce.Open=function(){ln.gi().PushStat(ln.GS_GOV_SETRESEARCH)};class le extends s{constructor(i){super(),this.iW=1100,this.iH=620,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_detail=new Array(7),this.btn_set=new Array(7);for(var t=0;t<7;t++)this.btn_detail[t]=new Eh(gn.xani_button),this.btn_detail[t].bSingleButton=!0,this.btn_set[t]=new Eh(gn.xani_button),this.btn_set[t].InitButton("普通按钮140_55"),this.btn_set[t].sName="设置";this.bLock3=!1,this.iOffY3=0,this._GOVMANAGE=[["帮派建筑","","#c0000001.青龙堂：#e# # 升级后可提高青龙任务效率以及雇佣工人的收益#e2.白虎堂：#e# # 升级后可降低维护的安定度消耗#e3.朱雀堂：#e# # 升级后可提高成员炼丹成功率和副产品率#e4.玄武堂：#e# # 升级后可提升行动力上限和帮派维护增加的守护兽经验#e5.学院：#e# # 升级后可提升帮派维护增加的技能经验#e6.金库：#e# # 升级后可提升帮派资金上限#e7.商会：#e# # 升级后可增加出产道具种类和数量#e8.药房：#e# # 升级后可增加出产药品种类和数量#e9.厢房：#e# # 升级后可提升帮派人数上限"],["帮派技能","","#c0000001.强身术#e# # 学习后能增加气血上限#e2.修心#e# # 学习后能增加魔法上限#e3.健体术#e# # 学习后能增加体力上限#e4.炼丹术#e# # 学习后可以提高炼丹的能力#e5.烹饪#e# # 学习后可以提高制作食物的能力#e6.锻造术#e# # 学习后可以提高制作头盔和腰带的能力#e7.冶金术#e# # 学习后可以提高制作武器和项链的能力#e8.剪裁术#e# # 学习后可以提高制作衣服和靴子的能力"],["维护等级","","#c0000001.初级维护#e# # 提供基础维护效果#e2.中级维护#e# # 消耗150%基础维护资金，提供150%基础维护效果#e3.高级维护#e# # 消耗200%基础维护资金，提供200%基础维护效果"],["帮派升级","","#c000000# # 帮派升级可以提高帮派建筑的等级上限#e#e# # 帮派升级需要消耗繁荣度，繁荣度根据时间恢复，繁荣度上限通过建造建筑提高"],["设置敌对","","#c000000# # 设置敌对会使得白虎任务有极高的概率随机到敌对帮派#e#e# # 敌对设置只能由帮主进行。"],["帮派改名","",""],["解散帮派","",""]]}_GetSet(i){var t;if(0==i.GetNextInt()){for(this.building=new Array(4),t=0;t<4;t++)this.building[t]=i.GetNextInt();for(this._GOVMANAGE[0][1]="当前正在建造"+Fi._GOVBUILDINGS[this.building[0]]+this.building[1]+"级("+this.building[2]+"/"+this.building[3]+")",this.research=new Array(4),t=0;t<4;t++)this.research[t]=i.GetNextInt();this._GOVMANAGE[1][1]="当前正在研究"+Fi._GOVSKILLS[this.research[0]]+this.research[1]+"级("+this.research[2]+"/"+this.research[3]+")",this.mtlev=i.GetNextInt(),this._GOVMANAGE[2][1]="当前帮派维护等级："+Fi._GOVMTLEV[this.mtlev],this.iExp=i.GetNextInt(),this.iMaxExp=i.GetNextInt(),this.iUpgradeExp=i.GetNextInt(),this._GOVMANAGE[3][1]="升级需要繁荣度："+this.iExp+"/"+this.iUpgradeExp,this.iHostilityId=i.GetNextInt(),this.sHostilityName=i.GetNextString(),0==this.iHostilityId?this._GOVMANAGE[4][1]="当前没有敌对帮派":this._GOVMANAGE[4][1]="当前敌对帮派："+this.sHostilityName}}Draw(){var i;for(E.new_baseframe4(this.iX,this.iY,this.iW,this.iH,"帮","派","管","理"),this.btn_close.Draw(),E.new_framein(this.iX+25,this.iY+25,this.iW-50,this.iH-50),c.gi().SetViewClip(this.iX+25+20,this.iY+25+20,this.iX+this.iW-25-20,this.iY+this.iH-25-20),i=0;i<7;i++)this.DrawEntry(i,this.iX+25+20,this.iY+25+20+100*i+this.iOffY3,this._GOVMANAGE[i][0],this._GOVMANAGE[i][1]);c.gi().NoClip(),this.bLock3||(i=692-(this.iH-90),this.iOffY3>0&&(this.iOffY3/=2),i<=0?this.iOffY3<0&&(this.iOffY3/=2):this.iOffY3<-i&&(i+=this.iOffY3,i/=2,this.iOffY3-=i)),ei.end(ei.CONFIRM_GOVUPGRADE)&&ei.bConfirm&&(Mh.gi().s_NewGovOperate(18,4,0,0,0,""),Mh.gi().s_NewGovOperate(18,0,0,0,0,"")),ei.end(ei.CONFIRM_GOVDISBAND)&&ei.bConfirm&&(Mh.gi().s_NewGovOperate(18,7,0,0,0,""),ln.gi().PopStat(1))}DrawEntry(i,t,s,e,h){E.frame_type1("帮派福利条a20_92",t,s,1010,20),gn.xani_icon.DrawAnima_aa(t+20,s+9.5,e,0),c.gi().DrawText_2(t+20+73+20,s+46,e,4294967040,30,101,1,1,0,0,-2,4,4289034305),h.length>0&&c.gi().DrawTextEx(t+20+73+20+160,s+46,h,4278190080,20,101,1,1,0,0,-2),this.btn_set[i].Move(t+1010-20-140,s+18.5,140,55),this.btn_set[i].Draw(),this.btn_detail[i].Move(t+20,s+9.5,73,73)}ProcTouch(i,t,s){var e;if(3==i&&(this.bLock3=!1),this.bLock3&&2==i&&(this.iOffY3+=s-this.iLock3Y,this.iLock3Y=s),bn.bInRect(t,s,this.iX+50,this.iY+50,this.iW-100,this.iH-100)){for(e=0;e<7;e++){if(this.btn_detail[e].ProcTouch(i,t,s))return this.btn_detail[e].bCheck()&&this._GOVMANAGE[e][2].length>0&&Ni.Open(this._GOVMANAGE[e][0],this._GOVMANAGE[e][2]),!0;if(this.btn_set[e].ProcTouch(i,t,s)){if(this.btn_set[e].bCheck())switch(e){case 0:Fi.mg.bCheckPower(1)?ae.Open():Z.fm.Open("你没有帮派管理权限");break;case 1:Fi.mg.bCheckPower(1)?ce.Open():Z.fm.Open("你没有帮派管理权限");break;case 2:Fi.mg.bCheckPower(1)?oe.Open():Z.fm.Open("你没有帮派管理权限");break;case 3:0==Fi.mg.iJob?ei.start(ei.CONFIRM_GOVUPGRADE,"是否确定升级帮派？"):Z.fm.Open("帮主才能升级帮派");break;case 4:0==Fi.mg.iJob?0==this.iHostilityId?ne.Open():(Mh.gi().s_NewGovOperate(18,5,0,0,0,"0"),Mh.gi().s_NewGovOperate(18,0,0,0,0,"")):Z.fm.Open("帮主才能设置敌对");break;case 5:0==Fi.mg.iJob?re.Open():Z.fm.Open("帮主才能修改帮派名称");break;case 6:0==Fi.mg.iJob?ei.start(ei.CONFIRM_GOVDISBAND,"是否确定解散帮派？"):Z.fm.Open("帮主才能解散帮派")}return!0}}if(bn.bInRect(t,s,this.iX+25,this.iY+25,this.iW-50,this.iH-50)&&1==i)return this.bLock3=!0,this.iLock3Y=s,!0}return this.btn_close.ProcTouch(i,t,s)&&this.btn_close.bCheck()&&ln.gi().PopStat(1),!1}}le.Open=function(){ln.gi().iXStat!=ln.GS_NEWGOVMANAGE?ln.gi().PushStat(ln.GS_NEWGOVMANAGE):ln.gi().LastStat(0),Mh.gi().s_NewGovOperate(18,0,0,0,0,"")},le.GetSet=function(i){var t;null!=(t=ln.gi().FindStat(ln.GS_NEWGOVMANAGE))&&t._GetSet(i)};class be extends s{constructor(i){var t;for(super(),this.iW=500,this.iH=400,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.chk_powers=new Array(4),t=0;t<4;t++)this.chk_powers[t]=new T(gn.xani_button),this.chk_powers[t].InitBox("复选框50_53"),this.chk_powers[t].bTrue=!1,this.chk_powers[t].Move(this.iX+50+t%2*200,this.iY+50+80+20+70*Math.floor(t/2),50,50);this.chk_powers[0].sDetail="人员管理",this.chk_powers[1].sDetail="帮派管理",this.chk_powers[2].sDetail="开启副本",this.chk_powers[3].sDetail="群发消息",this.btn_ok=new Eh(gn.xani_button),this.btn_ok.InitButton("普通按钮140_55"),this.btn_ok.sName="确定",this.btn_ok.Move(this.iX+this.iW/2-70,this.iY+this.iH-50-55,140,55),this.btn_question=new Eh(gn.xani_button),this.btn_question.InitButton("问号按钮60_60"),this.btn_question.Move(this.iX+this.iW-50-60,this.iY+this.iH-50-60,60,60)}Draw(){var i;for(E.frame_type4("中等框a52_50",this.iX,this.iY,this.iW,this.iH,52,50),gn.xani_head.DrawAnima(this.iX+50,this.iY+50,"新头像"+this.pgm.iRas,0),c.gi().DrawTextEx(this.iX+50+80+10,this.iY+50+20,this.pgm.sName,4278190080,25,101,1,1,0,0,-2),c.gi().DrawTextEx(this.iX+50+80+10,this.iY+50+20+40,Fi.sJob(this.pgm.iJob),4278190080,25,101,1,1,0,0,-2),i=0;i<4;i++)this.chk_powers[i].Draw();this.btn_ok.Draw(),this.btn_question.Draw()}ProcTouch(i,t,s){var e;for(e=0;e<4;e++)if(this.chk_powers[e].ProcTouch(i,t,s))return!0;return this.btn_ok.ProcTouch(i,t,s)?(this.btn_ok.bCheck()&&(this.pgm.iPower=0,this.chk_powers[0].bTrue&&(this.pgm.iPower|=1),this.chk_powers[1].bTrue&&(this.pgm.iPower|=2),this.chk_powers[2].bTrue&&(this.pgm.iPower|=4),this.chk_powers[3].bTrue&&(this.pgm.iPower|=8),Mh.gi().s_NewGovOperate(8,this.pgm.iRid,this.pgm.iPower,0,0,this.pgm.sName),ln.gi().PopStat(1)),!0):this.btn_question.ProcTouch(i,t,s)?(this.btn_question.bCheck()&&Ni.Open("界面说明","#c000000# # 权限系统可以让帮主管理各个帮派官员所拥有的管理权限。#e#e1.人员管理#e# # 授予该管理人员任命权限，以及加入帮众与踢出帮众的权限#e#e2.帮派管理#e# # 授予该管理人员管理帮派建筑，帮派技能，帮派维护等级和帮派升级的权限#e#e3.开启副本#e# # 授予该管理人员主动开启帮派副本的权限#e#e4.群发消息#e# # 授予该管理人员群发消息的权限"),!0):!bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)&&3==i&&(ln.gi().PopStat(1),!0)}}be.Open=function(i){var t;0==Fi.mg.iJob&&((t=ln.gi().iXStat!=ln.GS_SETGOVPOWER?ln.gi().PushStat(ln.GS_SETGOVPOWER):ln.gi().LastStat(0)).pgm=i,t.chk_powers[0].bTrue=0!=(1&i.iPower),t.chk_powers[1].bTrue=0!=(2&i.iPower),t.chk_powers[2].bTrue=0!=(4&i.iPower),t.chk_powers[3].bTrue=0!=(8&i.iPower))};class _e extends s{constructor(i){var t;for(super(),this.iW=312,this.iH=316,this.iX=(h.SCRW-this.iW)/2+150,this.iY=(h.SCRH-this.iH)/2,this.btn_operates=new Array(6),t=0;t<6;t++)this.btn_operates[t]=new Eh(gn.xani_button),this.btn_operates[t].InitButton("成员操作131_52");for(this.btn_operates[0].sName="聊天",this.btn_operates[1].sName="好友",this.btn_operates[2].sName="任命",this.btn_operates[3].sName="踢出",this.btn_operates[4].sName="权限",this.jW=292,this.jH=258,this.jX=this.iX-this.jW-20,this.jY=this.iY+70,this.btn_joblist=new Array(10),t=0;t<8;t++)this.btn_joblist[t]=new Eh(gn.xani_button),this.btn_joblist[t].Move(this.jX+10+t%2*141,this.jY+10+62*Math.floor(t/2),131,52),this.btn_joblist[t].InitButton("成员操作131_52"),this.btn_joblist[t].sName=Fi._GOVJOBS[t]}Draw(){var i,t;if(E.new_framepc(this.iX,this.iY,this.iW,this.iH),gn.xani_head.DrawAnima(this.iX+20,this.iY+20,"新头像"+this.pgm.iRas,0),c.gi().DrawTextEx(this.iX+20+80+10,this.iY+20+20,this.pgm.sName,4294967295,25,101,1,1,0,0,-2),c.gi().DrawTextEx(this.iX+20+80+10,this.iY+20+20+40,"号码："+this.pgm.iRid,4294967295,25,101,1,1,0,0,-2),i=0,t=0,this.btn_operates[t].Move(this.iX+20+i%2*141,this.iY+20+80+20+62*Math.floor(i/2),131,52),this.btn_operates[t].Draw(),i++,t++,this.btn_operates[t].Move(this.iX+20+i%2*141,this.iY+20+80+20+62*Math.floor(i/2),131,52),this.btn_operates[t].Draw(),i++,t++,this.pgm.iJob>Fi.mg.iJob&&Fi.mg.bCheckPower(0)?(this.btn_operates[t].Move(this.iX+20+i%2*141,this.iY+20+80+20+62*Math.floor(i/2),131,52),this.btn_operates[t].Draw(),i++):this.btn_operates[t].Move(-100,-100,5,5),t++,this.pgm.iJob>Fi.mg.iJob&&Fi.mg.bCheckPower(0)?(this.btn_operates[t].Move(this.iX+20+i%2*141,this.iY+20+80+20+62*Math.floor(i/2),131,52),this.btn_operates[t].Draw(),i++):this.btn_operates[t].Move(-100,-100,5,5),t++,0==Fi.mg.iJob?(this.btn_operates[t].Move(this.iX+20+i%2*141,this.iY+20+80+20+62*Math.floor(i/2),131,52),this.btn_operates[t].Draw(),i++):this.btn_operates[t].Move(-100,-100,5,5),t++,this.bAppoint){for(E.new_framepc(this.jX,this.jY,this.jW,this.jH),i=0;i<8;i++)this.btn_joblist[i].Draw();ei.end(ei.CONFIRM_GOVAPPOINT)&&ei.bConfirm&&(Mh.gi().s_NewGovOperate(7,this.pgm.iRid,this.iTmpJob,0,0,this.pgm.sName),ln.gi().PopStat(1))}ei.end(ei.CONFIRM_GOVKICKMEMBER)&&ei.bConfirm&&(Mh.gi().s_NewGovOperate(7,this.pgm.iRid,100,0,0,this.pgm.sName),ln.gi().PopStat(1))}ProcTouch(i,t,s){var e;if(this.bAppoint){for(e=0;e<8;e++)this.btn_joblist[e].ProcTouch(i,t,s)&&this.btn_joblist[e].bCheck()&&(this.iTmpJob=Fi._JOBIDS[e],Fi._JOBIDS[e]<Fi.mg.iJob?Z.fm.Open("不能任命高于自己的职位"):Fi._JOBIDS[e]==Fi.mg.iJob?ei.start(ei.CONFIRM_GOVAPPOINT,"确定将自己的帮派职位转让给他（转让后自己将成为帮众）？"):(Mh.gi().s_NewGovOperate(7,this.pgm.iRid,this.iTmpJob,0,0,this.pgm.sName),ln.gi().PopStat(1)));if(bn.bInRect(t,s,this.jX,this.jY,this.jW,this.jH))return!0}for(e=0;e<5;e++)if(this.btn_operates[e].ProcTouch(i,t,s)){if(this.btn_operates[e].bCheck())switch(e){case 0:ln.gi().PopStat(1),dt.OpenChat(this.pgm.iRid,this.pgm.sName,this.pgm.iRas);break;case 1:Mh.gi().s_FriendOperate(0,this.pgm.iRid,0),ln.gi().PopStat(1);break;case 2:this.bAppoint=!0;break;case 3:ei.start(ei.CONFIRM_GOVKICKMEMBER,"是否确定将#e"+this.pgm.sName+"("+this.pgm.iRid+")#e踢出帮派？");break;case 4:ln.gi().PopStat(1),be.Open(this.pgm)}return!0}return bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||3!=i||ln.gi().PopStat(1),!1}}_e.Open=function(i){if(i.iRid!=xh.me.iRid){var t;(t=ln.gi().iXStat!=ln.GS_MEMBEROPERATE?ln.gi().PushStat(ln.GS_MEMBEROPERATE):ln.gi().LastStat(0)).pgm=i;var s=2;i.iJob>Fi.mg.iJob&&Fi.mg.bCheckPower(0)&&(s+=2),0==Fi.mg.iJob&&s++,t.iH=1==s||2==s?192:3==s||4==s?254:316}};class fe{constructor(){}}class ue{constructor(){}}class de{constructor(){this.iBid=-1,this.iLev=0,this.iProc=0}}class pe{constructor(){this.iSid=-1,this.iLev=0,this.iProc=0}}class me extends s{constructor(i){var t;for(super(),this.pani=i,this.pm3f=i.pm3f,this.iW=600,this.iH=400,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new D(gn.xani_ui),this.btn_close.InitButton("统一关闭按钮"),this.btn_close.Move(this.iX+this.iW-60-5,this.iY,60,60),this.btn_base=new Array(6),this.bBaseInited=new Array(6),t=0;t<6;t++)this.btn_base[t]=new D(gn.xani_ui),this.btn_base[t].InitButton("统一中按钮4"),this.btn_base[t].Move(this.iX+10,this.iY+80+50*t,130,40),this.bBaseInited[t]=!1;for(this.btn_base[0].sName="基本属性",this.btn_base[1].sName="帮派成员",this.btn_base[2].sName="帮派建筑",this.btn_base[3].sName="帮派技能",this.btn_base[4].sName="其他功能",this.btn_base[5].sName="申请列表",this.iBasePoint=0,this.bBaseInited[0]=!0,Mh.gi().s_GetBaseGovData(0,0),0==Fi.mg.iJob||1==Fi.mg.iJob||2==Fi.mg.iJob||3==Fi.mg.iJob||4==Fi.mg.iJob?this.iBaseCount=6:this.iBaseCount=5,this.iApplyCount=0,this.applylist=new Array(10),this.btn_agree=new Array(10),this.btn_refuse=new Array(10),t=0;t<10;t++)this.applylist[t]=new fe,this.btn_agree[t]=new D(gn.xani_ui),this.btn_agree[t].InitButton("统一小按钮2"),this.btn_agree[t].sName="同意",this.btn_refuse[t]=new D(gn.xani_ui),this.btn_refuse[t].InitButton("统一小按钮2"),this.btn_refuse[t].sName="拒绝";for(this.iMemberCount=0,this.govmember=new Array(10),this.govbuilding=new Array(10),this.btn_build=new Array(10),this.govskill=new Array(10),this.btn_skill=new Array(10),t=0;t<10;t++)this.govmember[t]=new ue,this.govbuilding[t]=new de,this.btn_build[t]=new D(gn.xani_ui),this.btn_build[t].InitButton("统一小按钮2"),this.btn_build[t].sName="建造",this.govskill[t]=new pe,this.btn_skill[t]=new D(gn.xani_ui),this.btn_skill[t].InitButton("统一小按钮2"),this.btn_skill[t].sName="研究";this.btn_left=new D(gn.xani_ui),this.btn_left.InitButton("统一中按钮3"),this.btn_left.sName="上一页",this.btn_right=new D(gn.xani_ui),this.btn_right.InitButton("统一中按钮3"),this.btn_right.sName="下一页",this.btn_leavegov=new D(gn.xani_ui),this.btn_leavegov.InitButton("统一中按钮4"),this.btn_leavegov.sName="离帮",this.btn_mtlev=new D(gn.xani_ui),this.btn_mtlev.InitButton("统一中按钮4"),this.btn_mtlev.sName="离帮",this.btn_upgrade=new D(gn.xani_ui),this.btn_upgrade.InitButton("统一中按钮4"),this.btn_upgrade.sName="升级帮派",this.btn_swap=new D(gn.xani_ui),this.btn_swap.InitButton("统一中按钮4"),this.btn_swap.sName="帮主转让",this.btn_message=new D(gn.xani_ui),this.btn_message.InitButton("统一中按钮4"),this.btn_message.sName="群发邮件",this.btn_watch=new D(gn.xani_ui),this.btn_watch.InitButton("统一中按钮2"),this.btn_watch.sName="查看",this.iMemberPoint=-1}Draw_0(i,t,s,e){E.Frame1_BR(i+20,t+20,s-40,40),E.Data1_BR(i+30,t+30,"我的职位:",sJob(Fi.mg.iJob),100,70),E.Data1_BR(i+220,t+30,"我的帮贡:",""+Fi.mg.iTick,100,80),t+=60,E.Frame1_BR(i+20,t+10,s-40,e-90),E.Data1_BR(i+30,t+20,"帮派名称:",Fi.mg.sName,100,130),E.Data1_BR(i+270,t+20,"帮派号码:",""+Fi.mg.iRealGid,70,60),E.Data1_BR(i+30,t+20+25,"帮派等级:",""+this.iLev,100,60),E.Data1_BR(i+220,t+20+25,"帮派人数:",this.iAllMemberCount+"/"+this.iMaxMemberCount,100,80),E.Data1_BR(i+30,t+20+50,"帮派资金:",this.iMoney+"/"+this.iMaxMoney,100,260),E.Data1_BR(i+30,t+20+75,"当前繁荣度:",this.iExp+"/"+this.iMaxExp,120,240),E.Data1_BR(i+30,t+20+100,"升级繁荣度:",""+this.iUpgradExp,120,240),E.Data1_BR(i+30,t+20+125,"帮派行动力:",this.iTick+"/"+this.iMaxTick,120,240),E.Data1_BR(i+30,t+20+150,"当前建造建筑:",sBuilding(this.iBuildingId)+"("+this.iBExp+"/"+this.iBMaxExp+")",140,220),E.Data1_BR(i+30,t+20+175,"当前研究科技:",sSkill(this.iResearchId)+"("+this.iRExp+"/"+this.iRMaxExp+")",140,220),0==this.iRMtLev?E.Data1_BR(i+30,t+20+200,"当前维护级别:","普通",140,220):1==this.iRMtLev?E.Data1_BR(i+30,t+20+200,"当前维护级别:","中级",140,220):2==this.iRMtLev&&E.Data1_BR(i+30,t+20+200,"当前维护级别:","高级",140,220)}Draw_1(i,t,s,e){var h,a,n;for(E.Frame1_BR(i+20,t+20,s-40,e-40),h=0;h<10;h++)a=i+30,n=t+30+22*h,E.Text1_BR(a,n,s-60),h>=this.iMemberCount||(this.pm3f.DrawTextEx(a+10,n+10,this.govmember[h].sName,4294967295,20,101,1,1,0,0,-2),this.pm3f.DrawTextEx(a+160,n,sJob(this.govmember[h].iJob),4294967295,20,101,1,1,0,0,0));this.iMemberPoint>=0&&this.iMemberPoint<this.iMemberCount&&(a=i+30,n=t+30+22*this.iMemberPoint,this.btn_watch.Move(a+300,n-10,70,40),this.btn_watch.Draw()),0==this.iTotalLine?this.iPageCount=1:this.iPageCount=(this.iTotalLine-1)/this.iLineEachPage+1,this.pm3f.DrawTextEx(i+s/2,t+e-50,iPagePoint+1+"/"+this.iPageCount,4294967295,20,101,1,1,0,-2,-2),this.btn_left.Move(i+s/2-100-80,t+e-70,100,40),this.btn_left.Draw(),this.btn_right.Move(i+s/2+80,t+e-70,100,40),this.btn_right.Draw()}Draw_2(i,t,s,e){var h,a,n;for(E.Frame1_BR(i+20,t+20,s-40,e-40),h=0;h<8;h++)a=i+30,n=t+38+33*h,E.Text1_BR(a,n,s-60),-1!=this.govbuilding[h].iBid&&(this.pm3f.DrawTextEx(a+10,n,sBuilding(h)+this.govbuilding[h].iLev+"级",4294967295,20,101,1,1,0,0,0),this.pm3f.DrawTextEx(a+220,n,this.govbuilding[h].iProc+"/"+Fi.iBuildingUpgrad[this.govbuilding[h].iLev]/10,4294967295,20,101,1,1,0,-2,0),0!=Fi.mg.iJob&&1!=Fi.mg.iJob||(this.iBuildingId==h?this.pm3f.DrawTextEx(a+320,n,"建造中",4294967295,20,101,1,1,0,0,0):(this.btn_build[h].Move(a+320,n-5,60,30),this.btn_build[h].Draw())))}Draw_3(i,t,s,e){var h,a,n;for(E.Frame1_BR(i+20,t+20,s-40,e-40),h=0;h<8;h++)a=i+30,n=t+38+33*h,E.Text1_BR(a,n,s-60),-1!=this.govskill[h].iSid&&(this.pm3f.DrawTextEx(a+10,n,sSkill(h)+this.govskill[h].iLev+"级",4294967295,20,101,1,1,0,0,0),this.pm3f.DrawTextEx(a+220,n,this.govskill[h].iProc+"/"+Fi.iBuildingUpgrad[this.govskill[h].iLev],4294967295,20,101,1,1,0,-2,0),0!=Fi.mg.iJob&&1!=Fi.mg.iJob||(this.iResearchId==h?this.pm3f.DrawTextEx(a+320,n,"研究中",4294967295,20,101,1,1,0,0,0):(this.btn_skill[h].Move(a+320,n-5,60,30),this.btn_skill[h].Draw())))}Draw_4(i,t,s,e){var h,a;E.Frame1_BR(i+20,t+20,s-40,e-40),h=i+30,a=t+30,this.btn_leavegov.Move(h,a,130,40),0==Fi.mg.iJob?this.btn_leavegov.sName="解散帮派":this.btn_leavegov.sName="离帮",this.btn_leavegov.Draw(),Fi.mg.iJob<=1&&(a+=60,this.btn_mtlev.Move(h,a,130,40),0==this.iRMtLev?this.btn_mtlev.sName="维护:普通":1==this.iRMtLev?this.btn_mtlev.sName="维护:中级":2==this.iRMtLev&&(this.btn_mtlev.sName="维护:高级"),this.btn_mtlev.Draw(),a+=60,this.btn_upgrade.Move(h,a,130,40),this.btn_upgrade.Draw()),Fi.mg.iJob<=4&&(a+=60,this.btn_message.Move(h,a,130,40),this.btn_message.Draw()),h=i+30+150,a=t+30-60,0==Fi.mg.iJob&&(a+=60,this.btn_swap.Move(h,a,130,40),this.btn_swap.Draw()),ei.end(ei.CONFIRM_LEAVEGOV)&&ei.bConfirm&&(Mh.gi().s_LeaveGov(),Fi.mg.iRealGid=-1,ln.gi().PopStat(1)),ei.end(ei.CONFIRM_UPGRADEGOV)&&ei.bConfirm&&(Mh.gi().s_GovSet(3,0),ln.gi().PopStat(1)),ei.end(ei.CONFIRM_SWAPGOV)&&ei.bConfirm&&(Mh.gi().s_GovSet(4,0),ln.gi().PopStat(1))}Draw_5(i,t,s,e){var h,a,n;for(E.Frame1_BR(i+20,t+20,s-40,e-40),h=0;h<this.iApplyCount;h++)a=i+30,n=t+38+33*h,E.Text1_BR(a,n,s-60),this.pm3f.DrawTextEx(a+10,n+10,this.applylist[h].sName,4294967295,20,101,1,1,0,0,-2),-1!=this.applylist[h].iRid?-2!=this.applylist[h].iRid?(this.btn_agree[h].Move(a+200,n-5,60,30),this.btn_agree[h].Draw(),this.btn_refuse[h].Move(a+300,n-5,60,30),this.btn_refuse[h].Draw()):this.pm3f.DrawTextEx(a+250,n,"已拒绝",4294901760,20,101,1,1,0,0,0):this.pm3f.DrawTextEx(a+250,n,"已同意",4294901760,20,101,1,1,0,0,0)}Draw(){var i;for(E.Frame3_BK(this.iX,this.iY,this.iW,this.iH,"帮派属性"),this.btn_close.Draw(),i=0;i<this.iBaseCount;i++)this.iBasePoint==i&&(this.btn_base[i].bMouseDown=!0,this.btn_base[i].bMouseIn=!0),this.btn_base[i].Draw();switch(E.Frame2_MD(this.iX+150,this.iY+65,this.iW-160,this.iH-75),this.iBasePoint){case 0:this.Draw_0(this.iX+150,this.iY+65,this.iW-160,this.iH-75);break;case 1:this.Draw_1(this.iX+150,this.iY+65,this.iW-160,this.iH-75);break;case 2:this.Draw_2(this.iX+150,this.iY+65,this.iW-160,this.iH-75);break;case 3:this.Draw_3(this.iX+150,this.iY+65,this.iW-160,this.iH-75);break;case 4:this.Draw_4(this.iX+150,this.iY+65,this.iW-160,this.iH-75);break;case 5:this.Draw_5(this.iX+150,this.iY+65,this.iW-160,this.iH-75)}}ProcTouch(i,t,s){var e;if(this.btn_close.ProcTouch(i,t,s))return this.btn_close.bCheck()&&ln.gi().PopStat(1),!0;for(e=0;e<this.iBaseCount;e++)if(this.btn_base[e].ProcTouch(i,t,s)&&this.btn_base[e].bCheck())switch(e){case 0:case 4:this.iBasePoint=e;break;case 1:case 2:case 3:case 5:this.iBasePoint=e,0==this.bBaseInited[e]&&(this.bBaseInited[e]=!0,Mh.gi().s_GetBaseGovData(e,0))}if(1==this.iBasePoint){for(Fi.mg.iJob,e=0;e<10;e++){var h=this.iX+150+30,a=this.iY+65+30+22*e;bn.bInRect(t,s,h,a,220,22)&&e<this.iMemberCount&&(this.iMemberPoint=e)}if(this.iMemberPoint>=0&&this.btn_watch.ProcTouch(i,t,s))return this.btn_watch.bCheck()&&(Mh.gi().s_GetBaseGovData(6,this.govmember[this.iMemberPoint].iRid),ln.gi().PushStat(ln.GS_MEMBERDETAIL)),!0;this.btn_left.ProcTouch(i,t,s)&&this.btn_left.bCheck()&&iPagePoint>0&&(iPagePoint--,Mh.gi().s_GetBaseGovData(1,iPagePoint)),this.btn_right.ProcTouch(i,t,s)&&this.btn_right.bCheck()&&iPagePoint<this.iPageCount-1&&(iPagePoint++,Mh.gi().s_GetBaseGovData(1,iPagePoint))}if(2==this.iBasePoint&&(0==Fi.mg.iJob||1==Fi.mg.iJob))for(e=0;e<8;e++)if(e!=this.iBuildingId&&this.btn_build[e].ProcTouch(i,t,s))return this.btn_build[e].bCheck()&&(this.iBuildingId=e,Mh.gi().s_GovSet(0,e)),!0;if(3==this.iBasePoint&&(0==Fi.mg.iJob||1==Fi.mg.iJob))for(e=0;e<8;e++)if(e!=this.iResearchId&&this.btn_skill[e].ProcTouch(i,t,s))return this.btn_skill[e].bCheck()&&(this.iResearchId=e,Mh.gi().s_GovSet(1,e)),!0;if(4==this.iBasePoint){if(this.btn_leavegov.ProcTouch(i,t,s))return this.btn_leavegov.bCheck()&&(0==Fi.mg.iJob?ei.start(ei.CONFIRM_LEAVEGOV,"是否确认解散帮派？"):ei.start(ei.CONFIRM_LEAVEGOV,"是否确认离帮？")),!0;if(Fi.mg.iJob<=1&&this.btn_message.ProcTouch(i,t,s)&&this.btn_message.bCheck()&&(dt.OpenChat(1e4,Fi.mg.sName,6),L.easymsg.AddMessage("发送收取5万铜币")),Fi.mg.iJob<=1){if(this.btn_mtlev.ProcTouch(i,t,s))return this.btn_mtlev.bCheck()&&(this.iRMtLev<2?this.iRMtLev++:this.iRMtLev=0,Mh.gi().s_GovSet(2,this.iRMtLev)),!0;this.btn_upgrade.ProcTouch(i,t,s)&&this.btn_upgrade.bCheck()&&ei.start(ei.CONFIRM_UPGRADEGOV,"帮派"+this.iLev+"级升"+(this.iLev+1)+"级，要求2个建筑达到"+10*(this.iLev+1)+"级、帮派资金达到"+80*(this.iLev+1)*15/10+"万、繁荣度达到"+this.iUpgradExp+"#e升级成功消耗"+80*(this.iLev+1)+"万帮派资金#e是否确定升级帮派？"),0==Fi.mg.iJob&&this.btn_swap.ProcTouch(i,t,s)&&this.btn_swap.bCheck()&&ei.start(ei.CONFIRM_SWAPGOV,"是否确定将帮派转让给副帮主？")}}if(5==this.iBasePoint)for(e=0;e<this.iApplyCount;e++)if(!(this.applylist[e].iRid<0)){if(this.btn_agree[e].ProcTouch(i,t,s))return this.btn_agree[e].bCheck()&&(Mh.gi().s_OperateGovMember(this.applylist[e].iRid,0,0),this.applylist[e].iRid=-1),!0;if(this.btn_refuse[e].ProcTouch(i,t,s))return this.btn_refuse[e].bCheck()&&(Mh.gi().s_OperateGovMember(this.applylist[e].iRid,1,0),this.applylist[e].iRid=-2),!0}return!1}getgovdata(i){var t;switch(i.GetNextByte()){case 0:this.iLev=i.GetNextByte(),this.iMoney=i.GetNextInt(),this.iMaxMoney=i.GetNextInt(),this.iExp=i.GetNextInt(),this.iMaxExp=i.GetNextInt(),this.iTick=i.GetNextInt(),this.iMaxTick=i.GetNextInt(),this.iAllMemberCount=i.GetNextInt(),this.iMaxMemberCount=i.GetNextInt(),this.iUpgradExp=i.GetNextInt(),this.iBuildingId=i.GetNextByte(),this.iBExp=i.GetNextInt(),this.iBMaxExp=i.GetNextInt(),this.iResearchId=i.GetNextByte(),this.iRExp=i.GetNextInt(),this.iRMaxExp=i.GetNextInt(),this.iRMtLev=i.GetNextInt();break;case 1:for(this.iTotalLine=i.GetNextInt(),this.iLineEachPage=i.GetNextByte(),iPagePoint=i.GetNextByte(),this.iMemberCount=i.GetNextByte(),t=0;t<this.iMemberCount;t++)this.govmember[t].iRid=i.GetNextInt(),this.govmember[t].iJob=i.GetNextInt(),this.govmember[t].sName=i.GetNextString();break;case 2:for(t=0;t<8;t++)this.govbuilding[t].iBid=t,this.govbuilding[t].iLev=i.GetNextInt(),this.govbuilding[t].iProc=i.GetNextInt();break;case 3:for(t=0;t<8;t++)this.govskill[t].iSid=t,this.govskill[t].iLev=i.GetNextInt(),this.govskill[t].iProc=i.GetNextInt();break;case 5:for(this.iApplyCount=i.GetNextByte(),t=0;t<this.iApplyCount;t++)this.applylist[t].iRid=i.GetNextInt(),this.applylist[t].sName=i.GetNextString()}}}me.iPagePoint,me.sBuilding=function(i){switch(i){case 0:return"青龙堂";case 1:return"白虎堂";case 2:return"朱雀堂";case 3:return"玄武堂";case 4:return"学院";case 5:return"金库";case 6:return"商会";case 7:return"厢房";case 8:return"药房";default:return"未知"+i}},me.sSkill=function(i){switch(i){case 0:return"强身术";case 1:return"炼丹术";case 2:return"烹饪";case 3:return"锻造术";case 4:return"冶金术";case 5:return"剪裁术";case 6:return"健体";case 7:return"修心";default:return"未知"+i}},me.sJob=function(i){switch(i){case 0:return"帮主";case 1:return"副帮主";case 2:return"左护法";case 3:return"右护法";case 4:return"长老";case 5:return"堂主";case 6:return"精英";case 10:return"帮众";default:return"未知"+i}},me.ReloadMember=function(){Mh.gi().s_GetBaseGovData(1,iPagePoint)};class ge extends s{constructor(i){super(),this.iW=500,this.iH=400,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_ok=new Eh(gn.xani_button),this.btn_ok.InitButton("普通按钮140_55"),this.btn_ok.Move(this.iX+this.iW-30-140,this.iY+this.iH-30-55,140,55),this.btn_ok.sName="修改",this.btn_cancel=new Eh(gn.xani_button),this.btn_cancel.InitButton("普通按钮140_55"),this.btn_cancel.Move(this.iX+30,this.iY+this.iH-30-55,140,55),this.btn_cancel.sName="取消",this.in_name=new pi(gn.xani_ui),this.in_name.sDetail=""}Draw(){var i,t;E.frame_type4("中等框a52_50",this.iX,this.iY,this.iW,this.iH,52,50),E.frame_type1("帮派宣言a20_44",this.iX+this.iW/2-60,this.iY+30,120,20),c.gi().DrawTextEx(this.iX+this.iW/2,this.iY+30+22,"帮派宣言",4278190080,25,101,1,1,0,-2,-2),i=this.iX+30,t=this.iY+20+44+20+5,this.in_name.Move(i,t,this.iW-60,200),E.new_framepc(i,t,this.iW-60,200),this.in_name.onscr(),this.in_name.sDetail.length<=0?c.gi().DrawTextEx(i+10,t+10,"点击这里输入新的帮派宣言",1627389951,24,101,1,1,0,0,0):(Y.gi().FormatEx(this.in_name.sDetail,this.iW-60-20,25,0,0,30),Y.gi().Draw(i+10,t+10)),this.btn_ok.Draw(),this.btn_cancel.Draw()}ProcTouch(i,t,s){if(this.in_name.ProcTouch(i,t,s))return!0;if(this.btn_cancel.ProcTouch(i,t,s))return this.btn_cancel.bCheck()&&ln.gi().PopStat(1),!0;if(this.btn_ok.ProcTouch(i,t,s)){if(this.btn_ok.bCheck())if(this.in_name.sDetail.length>0){var e=this.in_name.sDetail.getBytes("GBK");if(e.length<4||e.length>80)return L.easymsg.AddMessage("帮派宣言2-40个字"),!0;Mh.gi().s_NewGovOperate(19,0,0,0,0,this.in_name.sDetail),ln.gi().PopStat(1)}else L.easymsg.AddMessage("请输入新的帮派宣言");return!0}return bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||3!=i||ln.gi().PopStat(1),!1}}ge.Open=function(i){ln.gi().PushStat(ln.GS_GOV_SETDETAIL).in_name.sDetail=i};class we extends s{constructor(i){var t;for(super(),this.iW=312,this.iH=254,this.iX=(h.SCRW-this.iW)/2+150,this.iY=(h.SCRH-this.iH)/2,this.btn_operates=new Array(4),t=0;t<4;t++)this.btn_operates[t]=new Eh(gn.xani_button),this.btn_operates[t].InitButton("成员操作131_52");this.btn_operates[0].sName="聊天",this.btn_operates[1].sName="好友",this.btn_operates[2].sName="同意",this.btn_operates[3].sName="拒绝"}Draw(){var i;for(E.new_framepc(this.iX,this.iY,this.iW,this.iH),gn.xani_head.DrawAnima(this.iX+20,this.iY+20,"新头像"+this.pgm.iRas,0),c.gi().DrawTextEx(this.iX+20+80+10,this.iY+20+20,this.pgm.sName,4294967295,25,101,1,1,0,0,-2),c.gi().DrawTextEx(this.iX+20+80+10,this.iY+20+20+40,"号码："+this.pgm.iRid,4294967295,25,101,1,1,0,0,-2),i=0;i<(Fi.mg.bCheckPower(0)?4:2);i++)this.btn_operates[i].Move(this.iX+20+i%2*141,this.iY+20+80+20+62*Math.floor(i/2),131,52),this.btn_operates[i].Draw()}ProcTouch(i,t,s){var e;for(e=0;e<(Fi.mg.bCheckPower(0)?4:2);e++)if(this.btn_operates[e].ProcTouch(i,t,s)){if(this.btn_operates[e].bCheck())switch(e){case 0:ln.gi().PopStat(1),dt.OpenChat(this.pgm.iRid,this.pgm.sName,this.pgm.iRas);break;case 1:Mh.gi().s_FriendOperate(0,this.pgm.iRid,0),ln.gi().PopStat(1);break;case 2:Mh.gi().s_NewGovOperate(11,this.pgm.iRid,1,0,0,this.pgm.sName),ln.gi().PopStat(1);break;case 3:Mh.gi().s_NewGovOperate(11,this.pgm.iRid,0,0,0,this.pgm.sName),ln.gi().PopStat(1)}return!0}return bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||3!=i||ln.gi().PopStat(1),!1}}we.Open=function(i){var t;i.iRid!=xh.me.iRid&&((t=ln.gi().iXStat!=ln.GS_CONFIRMAPPLY?ln.gi().PushStat(ln.GS_CONFIRMAPPLY):ln.gi().LastStat(0)).pgm=i,Fi.mg.bCheckPower(0)?t.iH=254:t.iH=192)};class xe{constructor(){this.iRid=0}}class Se{constructor(){}}class De{constructor(){}}class Te extends s{constructor(i){var t;for(super(),this.sBuildingDetail=["青龙堂：可提升青龙任务的效率以及雇佣工人的收益","白虎堂：可降低维护的安定度消耗，安定度影响技能研究效率","朱雀堂：可提高成员炼丹成功率和副产品率","玄武堂：可提升行动力上限和帮派维护增加的守护兽经验","学院：可提升帮派维护增加的技能经验","金库：可提升帮派资金上限","商会：可增加帮派商店出产道具种类和数量","厢房：可提升帮派人数上限","药房：可增加帮派药房出产道具种类和数量"],this._GOVWELFARE=[["帮派修炼","提升修炼，战斗更加得心应手","#c0000001.\t物理攻击修炼#e# # 每级提升2%物理攻击的伤害效果#e2.\t法术攻击修炼#e# # 每级提升2%法术攻击的伤害效果#e3.\t物理防御修炼#e# # 每级降低2%受到的物理伤害效#e4.\t法术防御修炼#e# # 每级降低2%受到的法术伤害效果#e5.\t封印修炼#e# # 每级提升2%封印命中几率#e6.\t抗封修炼#e# # 每级降低2%被封印命中几率"],["帮派技能","学习辅助技能，升级赚钱两不误","#c0000001.\t强身术#e# # 学习后能增加气血上限#e2.\t修心#e# # 学习后能增加魔法上限#e3.\t健体术#e# # 学习后能增加体力上限#e4.\t炼丹术#e# # 学习后可以提高炼丹的能力#e5.\t烹饪#e# #  学习后可以提高制作食物的能力#e6.\t锻造术#e# # 学习后可以提高制作头盔和腰带的能力#e7.\t冶金术#e# # 学习后可以提高制作武器和项链的能力#e8.\t剪裁术#e# # 学习后可以提高制作衣服和靴子的能力"],["帮派商店","限时折扣，特色产品，仅此一家","#c000000帮派招商，商人们都在帮里开店了，我们有特殊渠道进货，价格有优惠哦#e#e每日11:00,15:00,19:00,23:00，帮派商店会刷新一定数量商品，种类繁多，价格优惠。#e#e升级商会可以增加帮派商店出产种类和数量#e#e"],["帮派药房","卖治病的药，售炼心的炉","#c000000江湖人士，过得都是刀口舔血的日子，楚王感怀，允许各帮各派建立帮派药房。#e#e每日12:00,15:00,18:00,21:00，帮派药房刷新一定数量物品，包括药材，丹方，\t以及丹炉。玩家可消耗铜币，元宝或者帮贡选择购买。可能会有惊喜打折物品哦。#e#e升级药房可以增加帮派药房出产种类和数量#e#e"]],this._GOVACTIVITY=[["帮派竞赛","风云起，群帮争霸，狼烟升，万雄交锋。","#c000000# # 帮派竞赛每周周一至周五帮主消耗帮派资金进行报名，报名资金排名前8的帮派入选帮战。#e# # 帮派成功入选后，入帮3天以上等级达到20级的玩家，可于周五周六周日的19:30~20:00由咸阳帮战接引人进入帮战地图。#e# # 帮派竞赛分为粮草争夺战和场地对战，周五周六为粮草争夺战，周日为场地对战。#e# # 粮草争夺战双方初始粮草为100，任意一方粮草归零或者成员全部离开场地为负。#e# # 场地对战以成员全部离开场地者为负。#e帮派竞赛期间每次死亡，损失部分体力，体力为0，自动离场。#e# # 帮派竞赛期间每次赢得战斗或者成功运送粮草获得帮贡等奖励；体力归零自动离场获得经验帮贡，可能获得道具奖励；胜利帮派会在己方场地内刷新10个大宝箱以供捡取。"],["帮派副本","一段传奇，一个故事，探索小千世界之谜。","#c000000# # 拟定帮派守护兽达到30级时，帮派副本由帮主或拥有开启副本权限的成员消耗200万帮派资金，1000行动力开启，在开启时间内，加入帮派大于5天等级达到35的帮众方可参加，帮派副本开启时间持续2小时。#e#e# # 副本内玩家每三分钟将获得一次经验与帮贡奖励。#e#e# # 完成副本后，副本内所有玩家将获得侠义礼盒，惊喜多多"],["朱雀任务","访朱雀总管，寻神秘丹方。可获得帮贡，丹方","#c000000# # 玩家达到20后可以在帮派领地里找朱雀堂总管领取朱雀任务，完成任务可获得大量经验，金钱和帮贡，并且在第十次任务完成时获得丹方，丹方是炼丹的必需品。"],["青龙任务","倾众人之力，为帮派建设。可获得海量帮贡","#c000000# # 玩家达到20后可以在帮派领地里找朱雀堂总管领取青龙任务，完成任务可获得大量经验，金钱和帮贡。#e#e# # 青龙任务可以为帮派提供大量帮派建筑进度。"],["玄武任务","劳心劳力，为帮派谋取资金。可获得海量帮贡","#c000000# # 玩家达到20后可以在帮派领地里找朱雀堂总管领取玄武任务，完成任务可获得大量经验，金钱和帮贡。#e#e# # 玄武任务可以为帮派提供安定度以及大量帮派资金。"],["白虎任务","攘外安内，稳固帮内安定。可获得海量帮贡","#c000000# # 玩家达到20后可以在帮派领地里找朱雀堂总管领取白虎任务，完成任务可获得大量经验，金钱和帮贡。#e#e# # 白虎任务可以为帮派提供大量安定度。"]],this.iW=1100,this.iH=620,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.iPage=0,this.btn_page=new Array(4),t=0;t<4;t++)this.btn_page[t]=new Eh(gn.xani_nui2),this.btn_page[t].InitButton("右侧标签"),this.btn_page[t].Move(this.iX+this.iW-15,this.iY+40+125*t,50,140);for(this.btn0_fastback=new Eh(gn.xani_button),this.btn0_fastback.InitButton("普通按钮170_55"),this.btn0_fastback.Move(this.iX+this.iW-25-20-170,this.iY+25+20,170,55),this.btn0_fastback.sName="快速回帮",this.btn0_govstatus=new Eh(gn.xani_button),this.btn0_govstatus.bSingleButton=!0,this.btn0_govbuilding=new Eh(gn.xani_button),this.btn0_govbuilding.bSingleButton=!0,this.btn0_editdetail=new Eh(gn.xani_button),this.btn0_editdetail.bSingleButton=!0,this.i0Table=0,this.i0ShowExplain=-1,this.btn1_page=new Array(3),this.btn1_page[0]=new Eh(gn.xani_button),this.btn1_page[0].InitButton("选择按钮145_56"),this.btn1_page[0].sName="成员列表",this.btn1_page[1]=new Eh(gn.xani_button),this.btn1_page[1].InitButton("选择按钮145_56"),this.btn1_page[1].sName="申请列表",this.btn1_page[2]=new Eh(gn.xani_button),this.btn1_page[2].InitButton("选择按钮145_56"),this.btn1_page[2].sName="帮派事件",this.btn1_message=new Eh(gn.xani_button),this.btn1_message.InitButton("喇叭按钮60_60"),this.btn1_leavegov=new Eh(gn.xani_button),this.btn1_leavegov.InitButton("普通按钮170_55"),this.btn1_leavegov.sName="脱离帮派",this.ui1a_memberlist=new Oi(0,9,this.iW-90,450),this.ui1a_memberlist.SetTitle(0,"编号",70,!1),this.ui1a_memberlist.SetTitle(1,"名字",180,!0),this.ui1a_memberlist.SetTitle(2,"门派",80,!0),this.ui1a_memberlist.SetTitle(3,"等级",70,!0),this.ui1a_memberlist.SetTitle(4,"职位",80,!0),this.ui1a_memberlist.SetTitle(5,"剩余帮贡",110,!0),this.ui1a_memberlist.SetTitle(6,"历史帮贡",110,!0),this.ui1a_memberlist.SetTitle(7,"入帮时间",155,!0),this.ui1a_memberlist.SetTitle(8,"离线时间",155,!0),this.ui1b_applylist=new Oi(0,6,this.iW-90,450),this.ui1b_applylist.SetTitle(0,"序号",70,!1),this.ui1b_applylist.SetTitle(1,"名字",180,!1),this.ui1b_applylist.SetTitle(2,"门派",80,!1),this.ui1b_applylist.SetTitle(3,"等级",70,!1),this.ui1b_applylist.SetTitle(4,"号码",120,!1),this.ui1b_applylist.SetTitle(5,"申请时间",490,!1),this.ui1c_govevent=new Oi(0,2,this.iW-90,450),this.ui1c_govevent.SetTitle(0,"日期",250,!1),this.ui1c_govevent.SetTitle(1,"事件",760,!1),this.ui1c_govevent.iTitleHeight=0,this.ui1c_govevent.iAlign[1]=0,this.iSortType=-1,this.iSortUD=0,this.btn2_go=new Array(4),this.btn2_detail=new Array(4),t=0;t<4;t++)this.btn2_go[t]=new Eh(gn.xani_button),this.btn2_go[t].InitButton("普通按钮140_55"),this.btn2_go[t].sName="前往",this.btn2_detail[t]=new Eh(gn.xani_button),this.btn2_detail[t].bSingleButton=!0;for(this.bLock2=!1,this.iOffY2=0,this.btn3_go=new Array(6),this.btn3_detail=new Array(6),t=0;t<6;t++)this.btn3_go[t]=new Eh(gn.xani_button),this.btn3_go[t].InitButton("普通按钮140_55"),this.btn3_go[t].sName="前往",this.btn3_detail[t]=new Eh(gn.xani_button),this.btn3_detail[t].bSingleButton=!0;this.bLock3=!1,this.iOffY3=0}_InitMemberDetail(i){var t,s=i.GetNextInt();for(t=0;t<this.iMCount;t++)if(2==this.gov_members[t].iInitStat&&this.gov_members[t].iRid==s)return this.gov_members[t].sName=i.GetNextString(),this.gov_members[t].iSchoolId=i.GetNextByte(),this.gov_members[t].iLev=i.GetNextShort(),this.gov_members[t].iJob=i.GetNextShort(),this.gov_members[t].iTick=i.GetNextInt(),this.gov_members[t].iMaxTick=i.GetNextInt(),this.gov_members[t].sJoinDate=i.GetNextString(),this.gov_members[t].sLoginTime=i.GetNextString(),this.gov_members[t].iPower=i.GetNextShort(),this.gov_members[t].iRas=i.GetNextByte(),this.gov_members[t].iOnLine=i.GetNextByte(),void(this.gov_members[t].iInitStat=3)}_ApplyDetail(i){var t,s=i.GetNextInt();for(t=0;t<this.iACount;t++)if(2==this.gov_applys[t].iInitStat&&this.gov_applys[t].iRid==s){this.gov_applys[t].sName=i.GetNextString(),this.gov_applys[t].iSchoolId=i.GetNextInt(),this.gov_applys[t].iRas=i.GetNextInt(),this.gov_applys[t].iLev=i.GetNextInt(),this.gov_applys[t].sATime=i.GetNextString(),this.gov_applys[t].iInitStat=3;break}}_ApplyList(i){var t;if(this.iACount=i.GetNextShort(),!(this.iACount<=0))for(this.gov_applys=new Array(this.iACount),t=0;t<this.iACount;t++)this.gov_applys[t]=new Se,this.gov_applys[t].iRid=i.GetNextInt(),this.gov_applys[t].iInitStat=1}_InitEventDetail(i){for(var t=i.GetNextInt(),s=0;s<this.iECount;s++)this.gov_events[s].iEid==t&&(this.gov_events[s].sTime=i.GetNextString(),this.gov_events[s].sDetail=i.GetNextString(),this.gov_events[s].iInitStat=3)}_InitGovEvent(i){this.iECount=i.GetNextInt(),this.gov_events=new Array(this.iECount);for(var t=0;t<this.iECount;t++)this.gov_events[t]=new De,this.gov_events[t].iEid=i.GetNextInt(),this.gov_events[t].iInitStat=1}_InitMemberList(i){var t,s=i.GetNextByte(),e=i.GetNextShort(),h=i.GetNextShort();if(0==h){for(this.gov_members=new Array(e),t=0;t<e;t++)this.gov_members[t]=new xe,this.gov_members[t].iInitStat=0;this.iMCount=e,this.iSortType=s}for(;h<this.iMCount&&0!=(t=i.GetNextInt());)this.gov_members[h].iRid=t,this.gov_members[h].iInitStat=1,h++}GetBase(i){this.iLev=i.GetNextInt(),this.sMasterName=i.GetNextString(),this.iMasterId=i.GetNextInt(),this.sFightGovName=i.GetNextString(),this.iFightGovId=i.GetNextShort(),this.sDetail=i.GetNextString(),this.iMemberCount=i.GetNextInt(),this.iMaxMemberCount=i.GetNextInt(),this.iMoney=i.GetNextInt(),this.iMaxMoney=i.GetNextInt(),this.iExp=i.GetNextInt(),this.iMaxExp=i.GetNextInt(),this.iUpgradeExp=i.GetNextInt(),this.iStable=i.GetNextInt(),this.iMaxStable=i.GetNextInt(),this.iTick=i.GetNextInt(),this.iMaxTick=i.GetNextInt(),this.iBuildingId=i.GetNextByte(),this.iBuildingProc=i.GetNextInt(),this.iBuildingUpgrade=i.GetNextInt(),this.iReserchId=i.GetNextByte(),this.iReserchProc=i.GetNextInt(),this.iReserchUpgrade=i.GetNextInt(),this.iMtLev=i.GetNextInt(),this.iBuildingLevs=new Int32Array(9),this.iBuildingProcs=new Int32Array(9);for(var t=0;t<9;t++)i.GetNextByte(),this.iBuildingLevs[t]=i.GetNextShort(),this.iBuildingProcs[t]=i.GetNextInt()}Draw(){var i;for(E.new_baseframe4(this.iX,this.iY,this.iW,this.iH,"帮","派","列","表"),this.btn_close.Draw(),i=0;i<4;i++)this.iPage==i&&(this.btn_page[i].bMouseIn=!0,this.btn_page[i].bMouseDown=!0),this.btn_page[i].Draw();switch(E.new_lableword4(this.iX+this.iW-15,this.iY+50+0-4,40,70,0==this.iPage,"帮","派","信","息"),E.new_lableword4(this.iX+this.iW-15,this.iY+50+130-8,40,70,1==this.iPage,"帮","派","成","员"),E.new_lableword4(this.iX+this.iW-15,this.iY+50+260-12,40,70,2==this.iPage,"帮","派,","福","利"),E.new_lableword4(this.iX+this.iW-15,this.iY+50+390-16,40,70,3==this.iPage,"帮","派","活","动"),this.iPage){case 0:this.Draw_0();break;case 1:this.Draw_1();break;case 2:this.Draw_2();break;case 3:this.Draw_3()}}Draw_0(){var i,t,s,e,h;if(t=this.iX+25,s=this.iY+25,e=this.iW-50,h=this.iH-50,E.new_framein(t,s,e,h),t=this.iX+25+20,s=this.iY+25+20,E.frame_type4("淡蓝色a30_30",t,s,500,440,30,30),t+=10,s+=20,this.DrawMessage(t,s,160,300,"帮派名称",Fi.mg.sName),this.DrawMessage(t,s+50,160,80,"帮派等级",""+(this.iLev+1)),this.DrawMessage(t+160+80,s+50,140,80,"帮派号码",""+Fi.mg.iRealGid),this.DrawMessage(t,s+100,160,300,"帮      主",this.sMasterName),this.DrawMessage(t,s+150,160,300,"敌对帮派",0==this.iFightGovId?"无":this.sFightGovName),t+=20,s+=200,this.btn0_editdetail.Move(t,s,440,200),E.frame_type3("纯色b10_10",t,s,440,200,10,10),E.frame_type2("外边框a10_10",t,s,440,200,10,10),E.frame_type1("帮派宣言a20_44",t+220-60,s+20,120,20),c.gi().DrawTextEx(t+220,s+20+22,"帮派宣言",4278190080,25,101,1,1,0,-2,-2),Y.gi().FormatEx("#c000000"+this.sDetail,400,20,0,0,20),Y.gi().Draw(t+20,s+80),t=this.iX+25+20,s=this.iY+25+20+440+10,E.frame_type4("淡蓝色a30_30",t,s,500,80,30,30),t+=10,s+=20,this.DrawMessage(t,s,160,100,"我的职位",me.sJob(Fi.mg.iJob)),this.DrawMessage(t+180+80,s,100,100,"帮贡",""+Fi.mg.iTick),t=this.iX+25+20+500+10,s=this.iY+25+20,this.btn0_fastback.Draw(),this.btn0_govstatus.Move(t+30,s,140,70),this.btn0_govbuilding.Move(t+30+145,s,140,70),E.frame_type4(0==this.i0Table?"淡蓝色a30_30":"蓝色a30_30",t+30,s,140,90,30,30),E.frame_type4(1==this.i0Table?"淡蓝色a30_30":"蓝色a30_30",t+30+145,s,140,90,30,30),E.frame_type4("淡蓝色a30_30",t,s+60,500,470,30,30),t+=10,s+=75,i=45,0==this.i0Table)c.gi().DrawText_2(this.btn0_govstatus.iX+this.btn0_govstatus.iW/2,this.btn0_govstatus.iY+this.btn0_govstatus.iH/2,"帮派状态",4294967040,30,101,1,1,0,-2,-2,4,4278199373),c.gi().DrawTextEx(this.btn0_govbuilding.iX+this.btn0_govbuilding.iW/2,this.btn0_govbuilding.iY+this.btn0_govbuilding.iH/2,"帮派建筑",4278190080,30,101,1,1,0,-2,-2),E.frame_type3("纯色c30_30",this.btn0_govstatus.iX+2,this.btn0_govstatus.iY+60,136,30,30,30),this.DrawMessage1(t,s+0*i,200,260,bn.CalcRate(this.iMemberCount,this.iMaxMemberCount,260),"成员数量",this.iMemberCount+"/"+this.iMaxMemberCount),this.DrawMessage1(t,s+1*i,200,260,bn.CalcRate(this.iMoney,this.iMaxMoney,260),"帮派资金",this.iMoney+"/"+this.iMaxMoney),this.DrawMessage1(t,s+2*i,200,260,bn.CalcRate(this.iExp,this.iMaxExp,260),"当前繁荣度",this.iExp+"/"+this.iMaxExp),this.DrawMessage1(t,s+3*i,200,260,0,"升级繁荣度",""+this.iUpgradeExp),this.DrawMessage1(t,s+4*i,200,260,bn.CalcRate(this.iStable,this.iMaxStable,260),"安定度",this.iStable+"/"+this.iMaxStable),this.DrawMessage1(t,s+5*i,200,260,bn.CalcRate(this.iTick,this.iMaxTick,260),"帮派行动力",this.iTick+"/"+this.iMaxTick),this.DrawMessage1(t,s+6*i,200,260,bn.CalcRate(this.iBuildingProc,this.iBuildingUpgrade,260),"当前建造建筑",me.sBuilding(this.iBuildingId)+"("+this.iBuildingProc+"/"+this.iBuildingUpgrade+")"),this.DrawMessage1(t,s+7*i,200,260,bn.CalcRate(this.iReserchProc,this.iReserchUpgrade,260),"当前研究科技",me.sSkill(this.iReserchId)+"("+this.iReserchProc+"/"+this.iReserchUpgrade+")"),this.DrawMessage1(t,s+8*i,200,260,0,"当前维护级别",0==this.iMtLev?"低":1==this.iMtLev?"中":"高"),this.DrawMessage1(t,s+9*i,200,260,0,"守护兽等级",""+Fi.mg.iShsLev);else for(c.gi().DrawTextEx(this.btn0_govstatus.iX+this.btn0_govstatus.iW/2,this.btn0_govstatus.iY+this.btn0_govstatus.iH/2,"帮派状态",4278190080,30,101,1,1,0,-2,-2),c.gi().DrawText_2(this.btn0_govbuilding.iX+this.btn0_govbuilding.iW/2,this.btn0_govbuilding.iY+this.btn0_govbuilding.iH/2,"帮派建筑",4294967040,30,101,1,1,0,-2,-2,4,4278199373),E.frame_type3("纯色c30_30",this.btn0_govbuilding.iX+2,this.btn0_govbuilding.iY+60,136,30,30,30),i=0;i<9;i++)this.DrawMessage1(t,s+50*i,200,260,bn.CalcRate(this.iBuildingProcs[i],Fi.iBuildingUpgrad[this.iBuildingLevs[i]]/10,260),me.sBuilding(i),this.iBuildingProcs[i]+"/"+Fi.iBuildingUpgrad[this.iBuildingLevs[i]]/10),c.gi().DrawTextEx(t+10+110,s+20+50*i,this.iBuildingLevs[i]+"级",4294967295,30,101,1,1,0,0,-2);this.i0Lx=t,this.i0Ly=s,this.i0ShowExplain>=0&&(Y.gi().FormatEx(this.sBuildingDetail[this.i0ShowExplain],260,20,0,0,25),E.frame_type4("蓝色a30_30",t-300,s+50*this.i0ShowExplain-Y.gi().iH/2,300,40+Y.gi().iH,30,30),Y.gi().Draw(t-300+20,s+50*this.i0ShowExplain-Y.gi().iH/2+20)),ei.end(ei.CONFIRM_BACKGOV)&&ei.bConfirm&&(Mh.gi().s_NewGovOperate(4,0,0,0,0,""),ln.gi().PopStat(1))}DrawMessage1(i,t,s,e,h,a,n){c.gi().DrawTextEx(i+10,t+20,a,4278190080,30,101,1,1,0,0,-2),E.frame_type1("进度条背景a20_38",i+s,t+1,e,20);(h=bn.CalcRate(h,e,e-3-3))>0&&(c.gi().SetViewClip(i+s+3,t,i+s+h/2+3,t+50),gn.xani_frame.DrawAnima(i+s+3,t+5,"进度条a150_30",0),c.gi().NoClip(),c.gi().SetViewClip(i+s+h/2+3,t,i+s+h+3,t+50),gn.xani_frame.DrawAnima(i+s-150+h+3,t+5,"进度条a150_30",1),c.gi().NoClip()),c.gi().DrawTextEx(i+s+e/2,t+20,n,4294967295,20,101,1,1,0,-2,-2)}DrawMessage(i,t,s,e,h,a){c.gi().DrawTextEx(i+s/2,t+20,h,4278190080,30,101,1,1,0,-2,-2),E.frame_type1("文本框a20_40",i+s,t,e,20),c.gi().DrawTextEx(i+s+e/2,t+20,a,4294967295,25,101,1,1,0,-2,-2)}Draw_1(){var i,t,s,e,h;for(t=this.iX+25,s=this.iY+25,e=this.iW-50,h=this.iH-50,E.new_framein(t,s,e,h),t+=20,s+=20,this.btn1_page[this.i1Page].bMouseIn=!0,this.btn1_page[this.i1Page].bMouseDown=!0,i=0;i<3;i++)this.btn1_page[i].Move(t+165*i,s,145,56),this.btn1_page[i].Draw();switch(this.i1Page){case 0:this.Draw_1a(t,s);break;case 1:this.Draw_1b(t,s);break;case 2:this.Draw_1c(t,s)}}Draw_1a(i,t){var s,h;for(Fi.mg.bCheckPower(3)&&(this.btn1_message.Move(i+600,t,60,60),this.btn1_message.Draw()),this.btn1_leavegov.Move(this.iX+this.iW-25-20-170,t,170,55),this.btn1_leavegov.Draw(),t+=75,this.ui1a_memberlist.BeginDraw(i,t),h=0;h<this.iMCount;h++)s=0==this.iSortUD?h:this.iMCount-h-1,this.ui1a_memberlist.DrawUnit(0,h,""+(h+1)),this.ui1a_memberlist.bShow(h)&&null!=this.gov_members[s]&&(1==this.gov_members[s].iInitStat?(Mh.gi().s_NewGovOperate(6,this.gov_members[s].iRid,0,0,0,""),this.gov_members[s].iInitStat=2):2==this.gov_members[s].iInitStat?this.ui1a_memberlist.DrawUnit(1,h,"获取中..."):3==this.gov_members[s].iInitStat&&(this.ui1a_memberlist.DrawUnit(1,h,this.gov_members[s].sName),this.ui1a_memberlist.DrawUnit(2,h,e.sSchools[this.gov_members[s].iSchoolId]),this.ui1a_memberlist.DrawUnit(3,h,""+this.gov_members[s].iLev),this.ui1a_memberlist.DrawUnit(4,h,me.sJob(this.gov_members[s].iJob)),this.ui1a_memberlist.DrawUnit(5,h,""+this.gov_members[s].iTick),this.ui1a_memberlist.DrawUnit(6,h,""+this.gov_members[s].iMaxTick),this.ui1a_memberlist.DrawUnit(7,h,this.gov_members[s].sJoinDate),this.ui1a_memberlist.DrawUnit(8,h,0==this.gov_members[s].iOnLine?this.gov_members[s].sLoginTime:"在线")));this.ui1a_memberlist.FinishDraw(),this.iSortType==this.ui1a_memberlist.iSortType?this.iSortUD!=this.ui1a_memberlist.iSortUD&&(this.iSortUD=this.ui1a_memberlist.iSortUD):(this.iSortType=this.ui1a_memberlist.iSortType,this.iSortUD=0,this.iSortType>=1&&this.iSortType<=8&&(Mh.gi().s_NewGovOperate(5,this.iSortType,0,0,0,""),this.iMCount=0,this.ui1a_memberlist.iOffY=0)),(s=this.ui1a_memberlist.iChecked())>=0&&(0==this.iSortUD||(s=this.iMCount-s-1),_e.Open(this.gov_members[s])),ei.end(ei.CONFIRM_LEAVEGOV)&&ei.bConfirm&&(Mh.gi().s_LeaveGov(),Fi.mg.iRealGid=-1,ln.gi().PopStat(1))}Draw_1b(i,t){var s,h;for(t+=75,this.ui1b_applylist.BeginDraw(i,t),h=0;h<this.iACount;h++)s=h,this.ui1b_applylist.DrawUnit(0,h,""+(h+1)),this.ui1b_applylist.bShow(h)&&null!=this.gov_applys[s]&&(1==this.gov_applys[s].iInitStat?(Mh.gi().s_NewGovOperate(10,this.gov_applys[s].iRid,0,0,0,""),this.gov_applys[s].iInitStat=2):2==this.gov_applys[s].iInitStat?this.ui1b_applylist.DrawUnit(1,h,"获取中..."):3==this.gov_applys[s].iInitStat&&(this.ui1b_applylist.DrawUnit(1,h,this.gov_applys[s].sName),this.ui1b_applylist.DrawUnit(2,h,e.sSchools[this.gov_applys[s].iSchoolId]),this.ui1b_applylist.DrawUnit(3,h,""+this.gov_applys[s].iLev),this.ui1b_applylist.DrawUnit(4,h,""+this.gov_applys[s].iRid),this.ui1b_applylist.DrawUnit(5,h,this.gov_applys[s].sATime)));this.ui1b_applylist.FinishDraw(),(s=this.ui1b_applylist.iChecked())>=0&&s<this.iACount&&we.Open(this.gov_applys[s])}Draw_1c(i,t){var s,e;for(t+=75,this.ui1c_govevent.BeginDraw(i,t),e=0;e<this.iECount;e++)s=e,this.ui1c_govevent.bShow(e)&&null!=this.gov_events[s]&&(1==this.gov_events[s].iInitStat?(Mh.gi().s_NewGovOperate(13,this.gov_events[s].iEid,0,0,0,""),this.gov_events[s].iInitStat=2):2==this.gov_events[s].iInitStat?this.ui1c_govevent.DrawUnit(1,e,"获取中..."):3==this.gov_events[s].iInitStat&&(this.ui1c_govevent.DrawUnit(0,e,this.gov_events[s].sTime),this.ui1c_govevent.DrawUnit(1,e,this.gov_events[s].sDetail)));this.ui1c_govevent.FinishDraw()}Draw_2(){var i;for(E.new_framein(this.iX+25,this.iY+25,this.iW-50,this.iH-50),c.gi().SetViewClip(this.iX+25+20,this.iY+25+20,this.iX+this.iW-25-20,this.iY+this.iH-25-20),i=0;i<4;i++)this.Draw2Entry(i,this.iX+25+20,this.iY+25+20+100*i+this.iOffY2,this._GOVWELFARE[i][0],this._GOVWELFARE[i][1]);for(c.gi().NoClip(),this.bLock2||(this.iOffY2>0||this.iOffY2<0)&&(this.iOffY2/=2),i=0;i<4;i++)ei.end(ei.CONFIRM_GOVCONVEY1[i])&&ei.bConfirm&&(Mh.gi().s_NewGovOperate(4,1,i,0,0,""),ln.gi().PopStat(1))}Draw2Entry(i,t,s,e,h){E.frame_type1("帮派福利条a20_92",t,s,1010,20),gn.xani_icon.DrawAnima_aa(t+20,s+9.5,e,0),c.gi().DrawText_2(t+20+73+20,s+46,e,4294967040,30,101,1,1,0,0,-2,4,4289034305),c.gi().DrawTextEx(t+20+73+20+160,s+46,h,4278190080,20,101,1,1,0,0,-2),this.btn2_go[i].Move(t+1010-20-140,s+18.5,140,55),this.btn2_go[i].Draw(),this.btn2_detail[i].Move(t+20,s+9.5,73,73)}Draw_3(){var i;for(E.new_framein(this.iX+25,this.iY+25,this.iW-50,this.iH-50),c.gi().SetViewClip(this.iX+25+20,this.iY+25+20,this.iX+this.iW-25-20,this.iY+this.iH-25-20),i=0;i<6;i++)this.Draw3Entry(i,this.iX+25+20,this.iY+25+20+100*i+this.iOffY3,this._GOVACTIVITY[i][0],this._GOVACTIVITY[i][1]);for(c.gi().NoClip(),this.bLock3||(i=592-(this.iH-90),this.iOffY3>0&&(this.iOffY3/=2),i<=0?this.iOffY3<0&&(this.iOffY3/=2):this.iOffY3<-i&&(i+=this.iOffY3,i/=2,this.iOffY3-=i)),i=0;i<6;i++)ei.end(ei.CONFIRM_GOVCONVEY2[i])&&ei.bConfirm&&(Mh.gi().s_NewGovOperate(4,2,i,0,0,""),ln.gi().PopStat(1))}Draw3Entry(i,t,s,e,h){E.frame_type1("帮派福利条a20_92",t,s,1010,20),gn.xani_icon.DrawAnima_aa(t+20,s+9.5,e,0),c.gi().DrawText_2(t+20+73+20,s+46,e,4294967040,30,101,1,1,0,0,-2,4,4289034305),c.gi().DrawTextEx(t+20+73+20+160,s+46,h,4278190080,20,101,1,1,0,0,-2),this.btn3_go[i].Move(t+1010-20-140,s+18.5,140,55),this.btn3_go[i].Draw(),this.btn3_detail[i].Move(t+20,s+9.5,73,73)}ProcTouch(i,t,s){var e;for(3==i&&(this.bLock2=!1,this.bLock3=!1),e=0;e<4;e++)this.btn_page[e].ProcTouch(i,t,s)&&this.btn_page[e].bCheck()&&this.iPage!=e&&(this.iPage=e,1==e&&(Mh.gi().s_NewGovOperate(5,0,0,0,0,""),this.iMCount=0,this.i1Page=0,this.ui1a_memberlist.Clean(),this.iSortType=-1,this.iSortUD=0));switch(this.iPage){case 0:if(this.i0ShowExplain=-1,(1==i||2==i&&this.i0ShowExplain>=0)&&1==this.i0Table)for(this.i0ShowExplain=-1,e=0;e<9;e++)bn.bInRect(t,s,this.i0Lx,this.i0Ly+50*e,120,40)&&(this.i0ShowExplain=e);else this.i0ShowExplain=-1;if(this.btn0_govstatus.ProcTouch(i,t,s)&&this.btn0_govstatus.bCheck()&&(this.i0Table=0),this.btn0_govbuilding.ProcTouch(i,t,s)&&this.btn0_govbuilding.bCheck()&&(this.i0Table=1),this.btn0_fastback.ProcTouch(i,t,s))return this.btn0_fastback.bCheck()&&(Hs.gi().bCheckGuideExt(100)?ei.start(ei.CONFIRM_BACKGOV,"每次使用快速回帮需要花费6000游戏币，是否确定快速回帮？"):(Mh.gi().s_NewGovOperate(4,0,0,0,0,""),ln.gi().PopStat(1))),!0;this.btn0_editdetail.ProcTouch(i,t,s)&&this.btn0_editdetail.bCheck()&&0==Fi.mg.iJob&&ge.Open(this.sDetail);break;case 1:for(e=0;e<3;e++)this.btn1_page[e].ProcTouch(i,t,s)&&this.btn1_page[e].bCheck()&&this.i1Page!=e&&(0==e&&(Mh.gi().s_NewGovOperate(5,0,0,0,0,""),this.iMCount=0,this.ui1a_memberlist.Clean(),this.iSortType=-1,this.iSortUD=0),1==e&&(Mh.gi().s_NewGovOperate(9,0,0,0,0,""),this.iACount=0,this.ui1b_applylist.Clean()),2==e&&(Mh.gi().s_NewGovOperate(12,0,0,0,0,""),this.iECount=0,this.ui1c_govevent.Clean()),this.i1Page=e);switch(this.i1Page){case 0:if(this.ui1a_memberlist.ProcTouch(i,t,s))return!0;if(Fi.mg.bCheckPower(3)&&this.btn1_message.ProcTouch(i,t,s))return this.btn1_message.bCheck()&&(dt.OpenChat(1e4,Fi.mg.sName,6),L.easymsg.AddMessage("发送收取5万铜币")),!0;if(this.btn1_leavegov.ProcTouch(i,t,s))return this.btn1_leavegov.bCheck()&&(0==Fi.mg.iJob?Z.fm.Open("请先任命其他人为帮主后再脱离帮派"):ei.start(ei.CONFIRM_LEAVEGOV,"是否确认脱离帮派？")),!0;break;case 1:this.ui1b_applylist.ProcTouch(i,t,s);break;case 2:this.ui1c_govevent.ProcTouch(i,t,s)}break;case 2:for(e=0;e<4;e++){if(this.btn2_go[e].ProcTouch(i,t,s))return this.btn2_go[e].bCheck()&&(Hs.gi().bCheckGuideExt(101+e)?ei.start(ei.CONFIRM_GOVCONVEY1[e],"每次传送需要花费8000游戏币，是否确定传送？"):(Mh.gi().s_NewGovOperate(4,1,e,0,0,""),ln.gi().PopStat(1))),!0;if(this.btn2_detail[e].ProcTouch(i,t,s))return this.btn2_detail[e].bCheck()&&Ni.Open(this._GOVWELFARE[e][0],this._GOVWELFARE[e][2]),!0}if(this.bLock2&&2==i&&(this.iOffY2+=s-this.iLock2Y,this.iLock2Y=s),bn.bInRect(t,s,this.iX+25,this.iY+25,this.iW-50,this.iH-50)&&1==i)return this.bLock2=!0,this.iLock2Y=s,!0;break;case 3:for(e=0;e<6;e++){if(this.btn3_go[e].ProcTouch(i,t,s))return this.btn3_go[e].bCheck()&&(Hs.gi().bCheckGuideExt(105+e)?ei.start(ei.CONFIRM_GOVCONVEY2[e],"每次传送需要花费8000游戏币，是否确定传送？"):(Mh.gi().s_NewGovOperate(4,2,e,0,0,""),ln.gi().PopStat(1))),!0;if(this.btn3_detail[e].ProcTouch(i,t,s))return this.btn3_detail[e].bCheck()&&Ni.Open(this._GOVACTIVITY[e][0],this._GOVACTIVITY[e][2]),!0}if(this.bLock3&&2==i&&(this.iOffY3+=s-this.iLock3Y,this.iLock3Y=s),bn.bInRect(t,s,this.iX+25,this.iY+25,this.iW-50,this.iH-50)&&1==i)return this.bLock3=!0,this.iLock3Y=s,!0}return this.btn_close.ProcTouch(i,t,s)&&this.btn_close.bCheck()&&ln.gi().PopStat(1),!1}}Te.Open=function(i){(ln.x_stat.iXStat!=ln.GS_NEWGOVFRAME?ln.x_stat.PushStat(ln.GS_NEWGOVFRAME):ln.x_stat.LastStat(0)).GetBase(i)},Te.InitMemberDetail=function(i){var t;null!=(t=ln.x_stat.FindStat(ln.GS_NEWGOVFRAME))&&t._InitMemberDetail(i)},Te.ChangeJob=function(i){var t;if(null!=(t=ln.x_stat.FindStat(ln.GS_NEWGOVFRAME))){var s=i.GetNextInt(),e=i.GetNextInt(),h=i.GetNextInt();if(100==e){for(var a=0,n=0;n<t.iMCount-1;n++)t.gov_members[n].iRid==s&&(a=1),1==a&&(t.gov_members[n]=t.gov_members[n+1]);1==a&&t.iMCount--}else for(n=0;n<t.iMCount;n++)t.gov_members[n].iRid==s&&(t.gov_members[n].iJob=e,t.gov_members[n].iPower=h)}},Te.ApplyCheck=function(i){var t;if(null!=(t=ln.x_stat.FindStat(ln.GS_NEWGOVFRAME))){for(var s=0,e=i.GetNextInt(),h=0;h<t.iACount-1;h++)t.gov_applys[h].iRid==e&&(s=1),1==s&&(t.gov_applys[h]=t.gov_applys[h+1]);t.iACount--}},Te.ApplyDetail=function(i){var t;null!=(t=ln.x_stat.FindStat(ln.GS_NEWGOVFRAME))&&t._ApplyDetail(i)},Te.ApplyList=function(i){var t;null!=(t=ln.x_stat.FindStat(ln.GS_NEWGOVFRAME))&&t._ApplyList(i)},Te.UpdateDetail=function(i){var t;null!=(t=ln.x_stat.FindStat(ln.GS_NEWGOVFRAME))&&(t.sDetail=i.GetNextString())},Te.InitEventDetail=function(i){var t;null!=(t=ln.x_stat.FindStat(ln.GS_NEWGOVFRAME))&&t._InitEventDetail(i)},Te.InitGovEvent=function(i){var t;null!=(t=ln.x_stat.FindStat(ln.GS_NEWGOVFRAME))&&t._InitGovEvent(i)},Te.InitMemberList=function(i){var t;null!=(t=ln.x_stat.FindStat(ln.GS_NEWGOVFRAME))&&t._InitMemberList(i)};class Ce{constructor(){}}class ke extends s{constructor(i){var t;for(super(),this._MSTAT=["等待领取","进行中","已过期","已完成"],this.iW=1100,this.iH=620,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.iPage=0,this.btn_page=new Array(2),t=0;t<2;t++)this.btn_page[t]=new Eh(gn.xani_nui2),this.btn_page[t].InitButton("右侧标签"),this.btn_page[t].Move(this.iX+this.iW-15,this.iY+40+125*t,50,140);for(this.iSelect=0,this.btn_select=new Array(4),t=0;t<4;t++)this.btn_select[t]=new Eh(gn.xani_button),this.btn_select[t].InitButton("选择按钮145_56"),this.btn_select[t].Move(this.iX+25+20+160*t,this.iY+25+20,145,55);this.btn_select[0].sName="朱雀任务",this.btn_select[1].sName="青龙任务",this.btn_select[2].sName="白虎任务",this.btn_select[3].sName="玄武任务",this.btn_addmission=new Eh(gn.xani_button),this.btn_addmission.InitButton("普通按钮170_55"),this.btn_addmission.Move(this.iX+this.iW-25-20-170,this.iY+25+20,170,55),this.btn_addmission.sName="发布委托",this.ui0_missionlist=new Oi(0,9,this.iW-90,450),this.ui0_missionlist.SetTitle(0,"任务佣金",300,!1),this.ui0_missionlist.SetTitle(1,"发布人",200,!0),this.ui0_missionlist.SetTitle(2,"发布时间",510,!0),this.ui1_missionlist=new Oi(0,9,this.iW-90,450),this.ui1_missionlist.SetTitle(0,"任务佣金",300,!1),this.ui1_missionlist.SetTitle(1,"任务状态",200,!0),this.ui1_missionlist.SetTitle(2,"发布时间",510,!0)}_GetMyDetail(i){var t,s=i.GetNextInt(),e=i.GetNextInt();if(100==s)for(t=0;t<this.iM1Count;t++)2==this.ets1[t].iInitStat&&this.ets1[t].iMid==e&&(this.ets1[t].iStat=i.GetNextByte(),this.ets1[t].iSIngot=i.GetNextShort(),this.ets1[t].iSMoney=i.GetNextInt(),this.ets1[t].sSTime=i.GetNextString(),this.ets1[t].iType=i.GetNextByte(),this.ets1[t].sSName=i.GetNextString(),this.ets1[t].iInitStat=3);else for(t=0;t<this.iM0Count;t++)2==this.ets0[t].iInitStat&&this.ets0[t].iMid==e&&(this.ets0[t].iStat=i.GetNextByte(),this.ets0[t].iSIngot=i.GetNextShort(),this.ets0[t].iSMoney=i.GetNextInt(),this.ets0[t].sSTime=i.GetNextString(),this.ets0[t].iType=i.GetNextByte(),this.ets0[t].sSName=i.GetNextString(),this.ets0[t].iInitStat=3)}_GetMyMission(i){var t;if(100==i.GetNextInt()){for(this.iM1Count=i.GetNextInt(),this.ets1=new Array(this.iM1Count),t=0;t<this.iM1Count;t++)this.ets1[t]=new Ce,this.ets1[t].iMid=i.GetNextInt(),this.ets1[t].iInitStat=1;this.iAlreadyEntrusted=i.GetNextInt()}else for(this.iM0Count=i.GetNextInt(),this.ets0=new Array(this.iM0Count),t=0;t<this.iM0Count;t++)this.ets0[t]=new Ce,this.ets0[t].iMid=i.GetNextInt(),this.ets0[t].iInitStat=1}Draw(){var i,t,s,e,h;for(E.new_baseframe4(this.iX,this.iY,this.iW,this.iH,"委","托","任","务"),this.btn_close.Draw(),i=0;i<2;i++)this.iPage==i&&(this.btn_page[i].bMouseIn=!0,this.btn_page[i].bMouseDown=!0),this.btn_page[i].Draw();switch(E.new_lableword4(this.iX+this.iW-15,this.iY+50+0-4,40,70,0==this.iPage,"委","托","任","务"),E.new_lableword4(this.iX+this.iW-15,this.iY+50+130-8,40,70,1==this.iPage,"我","的","委","托"),t=this.iX+25,s=this.iY+25,e=this.iW-50,h=this.iH-50,E.new_framein(t,s,e,h),this.iPage){case 0:this.Draw_0(t+20,s+20);break;case 1:this.Draw_1(t+20,s+20)}}Draw_0(i,t){var s;for(s=0;s<4;s++)this.iSelect==s&&(this.btn_select[s].bMouseIn=!0,this.btn_select[s].bMouseDown=!0),this.btn_select[s].Draw();for(this.ui0_missionlist.BeginDraw(i,t+55+20),s=0;s<this.iM0Count;s++)this.ui0_missionlist.bShow(s)&&null!=this.ets0[s]&&(1==this.ets0[s].iInitStat?(Mh.gi().s_NewGovOperate(15,this.iSelect,this.ets0[s].iMid,0,0,""),this.ets0[s].iInitStat=2):2==this.ets0[s].iInitStat?this.ui0_missionlist.DrawUnit(0,s,"获取中"):3==this.ets0[s].iInitStat&&(this.ui0_missionlist.DrawUnit(0,s,this.ets0[s].iSIngot+"元宝+"+this.ets0[s].iSMoney+"铜币"),this.ui0_missionlist.DrawUnit(1,s,this.ets0[s].sSName),this.ui0_missionlist.DrawUnit(2,s,this.ets0[s].sSTime)));this.ui0_missionlist.FinishDraw(),(s=this.ui0_missionlist.iChecked())>=0&&(this.pge=this.ets0[s],ei.start(ei.CONFIRM_GOVGETENTRUST,ReleaseGovMission._FOUR[this.pge.iType]+"#e#e委托人:"+this.pge.sSName+"#e#e接受委托任务后半小时内未完成则任务失败#e#e是否确定接受委托？")),ei.end(ei.CONFIRM_GOVGETENTRUST)&&ei.bConfirm&&(Mh.gi().s_NewGovOperate(17,1,this.pge.iMid,this.pge.iType,0,""),this.ui0_missionlist.Clean())}Draw_1(i,t){var s,e,h,a;for(s=0;s<4;s++)this.iSelect==s&&(this.btn_select[s].bMouseIn=!0,this.btn_select[s].bMouseDown=!0),this.btn_select[s].Draw();for(this.btn_addmission.Draw(),a=this.ui1_missionlist.iChecked(),this.ui1_missionlist.BeginDraw(i,t+55+20),e=0,h=0,s=0;s<this.iM1Count;s++)if(1==this.ets1[s].iInitStat)h<6&&(Mh.gi().s_NewGovOperate(15,100,this.ets1[s].iMid,0,0,""),this.ets1[s].iInitStat=2),h++;else if(2==this.ets1[s].iInitStat)h++;else if(3==this.ets1[s].iInitStat&&this.ets1[s].iType==this.iSelect){if(this.ui1_missionlist.DrawUnit(0,e,this.ets1[s].iSIngot+"元宝+"+this.ets1[s].iSMoney+"铜币"),this.ui1_missionlist.DrawUnit(1,e,this._MSTAT[this.ets1[s].iStat]),this.ui1_missionlist.DrawUnit(2,e,this.ets1[s].sSTime),a==e)switch(this.pge=this.ets1[s],this.pge.iStat){case 0:ei.start(ei.CONFIRM_GOVCANCELENTRUST,ReleaseGovMission._FOUR[this.pge.iType]+"#e#e委托任务持续一天，一天后未完成的委托任务失效#e撤销任务返还佣金，手续费不返还#e#e是否确认撤销所选委托？");break;case 1:Z.fm.Open(ReleaseGovMission._FOUR[this.pge.iType]+"#e#e委托任务持续一天，一天后未完成的委托任务失效#e撤销任务返还佣金，手续费不返还");break;case 2:ei.start(ei.CONFIRM_GOVCANCELENTRUST,ReleaseGovMission._FOUR[this.pge.iType]+"#e#e委托任务持续一天，一天后未完成的委托任务失效#e撤销任务返还佣金，手续费不返还#e#e是否确认撤销所选委托？")}e++}this.ui1_missionlist.FinishDraw(),ei.end(ei.CONFIRM_GOVCANCELENTRUST)&&ei.bConfirm&&(Mh.gi().s_NewGovOperate(17,0,this.pge.iMid,this.pge.iType,0,""),this.ui1_missionlist.Clean())}ProcTouch(i,t,s){var e;if(this.btn_close.ProcTouch(i,t,s))return this.btn_close.bCheck()&&ln.gi().PopStat(1),!0;for(e=0;e<2;e++)this.btn_page[e].ProcTouch(i,t,s)&&this.btn_page[e].bCheck()&&this.iPage!=e&&(this.iPage=e,1==e&&(Mh.gi().s_NewGovOperate(14,100,0,0,0,""),this.ui1_missionlist.Clean(),this.iSelect=0,this.iM1Count=0),0==e&&(Mh.gi().s_NewGovOperate(14,0,0,0,0,""),this.ui0_missionlist.Clean(),this.iSelect=0,this.iM0Count=0));switch(this.iPage){case 0:for(e=0;e<4;e++)this.btn_select[e].ProcTouch(i,t,s)&&this.btn_select[e].bCheck()&&this.iSelect!=e&&(this.iSelect=e,Mh.gi().s_NewGovOperate(14,e,0,0,0,""),this.ui0_missionlist.Clean(),this.iM0Count=0);this.ui0_missionlist.ProcTouch(i,t,s);break;case 1:for(e=0;e<4;e++)this.btn_select[e].ProcTouch(i,t,s)&&this.btn_select[e].bCheck()&&(this.iSelect=e);this.btn_addmission.ProcTouch(i,t,s)&&this.btn_addmission.bCheck()&&((e=xh.me.rbs.iLev/2)>20&&(e=20),this.iAlreadyEntrusted>=e?Z.fm.Open("发布任务次数已达上限"):ReleaseGovMission.Open(this.iSelect,e-this.iAlreadyEntrusted,e)),this.ui1_missionlist.ProcTouch(i,t,s)}return!1}}ke.Open=function(){ln.gi().iXStat!=ln.GS_ENTRUSTMISSION?ln.gi().PushStat(ln.GS_ENTRUSTMISSION):ln.gi().LastStat(0),Mh.gi().s_NewGovOperate(14,0,0,0,0,"")},ke.CancelEntrust=function(i){var t;if(null!=(t=ln.gi().FindStat(ln.GS_ENTRUSTMISSION))){var s=i.GetNextInt();if(0==s){var e=i.GetNextInt(),h=0;for(s=0;s<t.iM1Count-1;s++)t.ets1[s].iMid==e&&(h=1),1==h&&(t.ets1[s]=t.ets1[s+1]);1==h&&t.iM1Count--}else{e=i.GetNextInt(),h=0;for(s=0;s<t.iM0Count-1;s++)t.ets0[s].iMid==e&&(h=1),1==h&&(t.ets0[s]=t.ets0[s+1]);1==h&&t.iM0Count--}}},ke.GetMyDetail=function(i){var t;null!=(t=ln.gi().FindStat(ln.GS_ENTRUSTMISSION))&&t._GetMyDetail(i)},ke.GetMyMission=function(i){var t;null!=(t=ln.gi().FindStat(ln.GS_ENTRUSTMISSION))&&t._GetMyMission(i)};class Ae{}class Ie extends s{constructor(i){super(),this.iW=700,this.iH=400,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2}Draw(){var i,t=(this.iW-30-30-20)/2,s=this.iH-30-30-30-20;E.frame_type4("中等框a52_50",this.iX,this.iY,this.iW,this.iH,52,50),c.gi().DrawText_2(this.iX+30+t/2,this.iY+30+15,"进度描述",4294967040,30,101,1,1,0,-2,-2,3,4278190080),c.gi().DrawText_2(this.iX+30+t+20+t/2,this.iY+30+15,"进度目标",4294967040,30,101,1,1,0,-2,-2,3,4278190080),E.frame_type4("单色内框b20_20",this.iX+30,this.iY+30+30+20,t,s,20,20),E.frame_type4("单色内框b20_20",this.iX+30+t+20,this.iY+30+30+20,t,s,20,20),Y.gi().FormatEx(Ie.sDetail,t-30,20,0,0,25),Y.gi().Draw(this.iX+30+15,this.iY+30+30+20+15);var e=this.iX+30+t+20,h=this.iY+30+30+20;for(i=0;i<Ie.iTargetCount;i++)c.gi().DrawTextEx(e+15,h+15,Ie.mTargets[i].sTarget,4294967295,20,101,1,1,0,0,0),c.gi().DrawTextEx(e+t-15,h+15,Ie.mTargets[i].sProc,4294967295,20,101,1,1,0,-3,0),h+=25}ProcTouch(i,t,s){return 3==i&&ln.gi().PopStat(1),!1}}Ie.sDetail,Ie.iTargetCount,Ie.mTargets,Ie.iPlanId,Ie.Open=function(){ln.gi().iXStat!=ln.GS_GOVFBTARGET&&ln.gi().PushStat(ln.GS_GOVFBTARGET)},Ie.GetData=function(i){var t;if(null==Ie.mTargets)for(Ie.mTargets=new Array(10),t=0;t<10;t++)Ie.mTargets[t]=new Ae;for(Ie.sDetail=i.GetNextString(),Ie.iTargetCount=i.GetNextByte(),t=0;t<Ie.iTargetCount;t++)Ie.mTargets[t].iStat=i.GetNextByte(),Ie.mTargets[t].iType=i.GetNextByte(),Ie.mTargets[t].sTarget=i.GetNextString(),Ie.mTargets[t].sProc=i.GetNextString();Ie.iPlanId=i.GetNextInt(),gn.sop("GovFBTarget.iPlanId="+Ie.iPlanId+"GovFBTarget.iTargetCount"+Ie.iTargetCount)};class Pe extends s{constructor(i){var t;for(super(),this.iW=530,this.iH=475,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_select=new Array(3),t=0;t<2;t++)this.btn_select[t]=new Eh(gn.xani_button),this.btn_select[t].InitButton("普通按钮140_55"),this.btn_select[t].sName="选择";this.aa_np=new Array(2),this.aa_np[0]=gn.xani_pets[29].InitAnimaWithName("站立_右下",null),this.aa_np[1]=gn.xani_pets[30].InitAnimaWithName("站立_右下",null)}Draw(){E.frame_type4("中等框a52_50",this.iX,this.iY,this.iW,this.iH,52,50),c.gi().DrawTextEx(this.iX+this.iW/2,this.iY+45,"选择宠物",4280766287,30,101,1,1,0,-2,-2),E.frame_type4("蓝色a30_30",this.iX+50,this.iY+70,200,260,30,30),G.DrawAura(0,this.iX+50+100,this.iY+80+200-50,null,0),this.aa_np[0].Draw(this.iX+50+100,this.iY+80+200-50),this.aa_np[0].NextFrame(),c.gi().DrawTextEx(this.iX+50+100,this.iY+80+200,"耳兔",4294967295,25,101,1,1,0,-2,-2),E.frame_type4("蓝色a30_30",this.iX+50+200+30,this.iY+70,200,260,30,30),G.DrawAura(0,this.iX+50+200+30+100,this.iY+80+200-50,null,0),this.aa_np[1].Draw(this.iX+50+200+30+100,this.iY+80+200-50),this.aa_np[1].NextFrame(),c.gi().DrawTextEx(this.iX+50+200+30+100,this.iY+80+200,"猁猁",4294967295,25,101,1,1,0,-2,-2),this.btn_select[0].Move(this.iX+50+100-70,this.iY+70+260+20,140,55),this.btn_select[0].Draw(),this.btn_select[1].Move(this.iX+50+200+30+100-70,this.iY+70+260+20,140,55),this.btn_select[1].Draw(),c.gi().DrawTextEx(this.iX+this.iW/2,this.iY+70+260+20+55+35,"除了外形它们没有任何区别",4280766287,20,101,1,1,0,-2,-2)}ProcTouch(i,t,s){var e;for(e=0;e<2;e++)if(this.btn_select[e].ProcTouch(i,t,s))return this.btn_select[e].bCheck()&&(Mh.gi().s_SeverEvent(33,e,0,0,0),ln.gi().PopStat(1)),!0;return!1}}Pe.Open=function(){ln.gi().PushStat(ln.GS_SELECTNEWPET)};class Ne extends s{constructor(i){var t;for(super(),this.iW=800,this.iH=550,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_school=new Array(3),t=0;t<3;t++)this.btn_school[t]=new Eh(gn.xani_nui2),this.btn_school[t].InitButton(Ne._ADetail[4][t+3*xh.me.iRace][0]),this.btn_school[t].sName="";this.se=new mt,this.se.Init3(0,0,50,50),this.btn_go=new Eh(gn.xani_nui2),this.btn_go.InitButton("按钮1_110"),this.btn_go.sName="前往",this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮")}Draw(){var i,t,s,e;for(E.new_bigframe(this.iX,this.iY,this.iW,this.iH),t=this.iX+30,s=this.iY+30,e=165,E.new_framein(t,s,this.iW-60,e),c.gi().DrawTextEx(t+30,s+30+50,"选择门派：",4278206039,40,101,1,1,0,0,-2),i=0;i<3;i++)this.btn_school[i].Move(t+30+130*i+200,s+30,100,100),this.btn_school[i].Draw(),this.iSchoolPoint==i+3*xh.me.iRace&&this.iSchoolPoint>=0&&(this.se.Logic(),this.se.Draw(this.btn_school[i].iX+50,this.btn_school[i].iY+50));s+=e+20,e=this.iH-e-60-20,E.new_framein(t,s,this.iW-60,e),this.iSchoolPoint>=0&&(Y.gi().FormatEx("#c003e57"+Ne._ADetail[4][this.iSchoolPoint][1],this.iW-60-40,25,0,0,30),Y.gi().Draw(t+20,s+20),this.btn_go.Move(this.iX+this.iW-30-20-110,this.iY+this.iH-30-20-52,110,52),this.btn_go.Draw()),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_close.Draw()}ProcTouch(i,t,s){var e;for(e=0;e<3;e++)if(this.btn_school[e].ProcTouch(i,t,s))return this.btn_school[e].bCheck()&&(this.iSchoolPoint=e+3*xh.me.iRace),!0;return this.iSchoolPoint>=0&&this.btn_go.ProcTouch(i,t,s)?(this.btn_go.bCheck()&&(Mh.gi().s_ChangeMapNew(2,34+this.iSchoolPoint),Us.m.bCheckDoing(138)&&Mh.gi().s_FinishMission(0,138,0,0),ln.gi().PopStat(1)),!0):!!this.btn_close.ProcTouch(i,t,s)&&(this.btn_close.bCheck()&&ln.gi().PopStat(1),!0)}}Ne.Open=function(){ln.gi().PushStat(ln.GS_SELECTSCHOOL)},Ne._ADetail=[[["门派任务","人物等级>=10级#e10级加入门派后，找门派师傅领取任务，每天的前两轮（会员三轮）任务获得双倍奖励。"],["为民除害","人物等级>=10级#e在[西阳城守卫]处领取，任务完成后会获得大量的经验奖励。"],["每日赛跑","人物等级>=20级#e在[临淄城]的[田忌]处领取，完成可获得大量经验和金钱奖励，并获得一个三级草药。每天前十名更能额外获得道具奖励。#e任务可自动寻路完成"],["护法任务","人物等级>=20级#e在[咸阳]的[商鞅]处领取任务，完成获得大量的经验和金钱，10次为一轮，完成每轮的第十次任务可获得制作装备的材料。"],["追捕强盗","人物等级>=20级#e可以在[郢城]的[栾千盛]处领取追捕强盗任务，要求至少3人组队才能领取，完成获取经验金钱奖励，10次为一轮，第10次队长必定获得装备制造图纸，其他队员有几率获得道具奖励。"],["擂台切磋","在西阳城中间的擂台，跟其他玩家切磋一下，不管输赢都会获得2点活跃哦。"],["手艺任务","在郢城的铁匠接取任务，完成任务后会获得大量的经验和金钱，以及高熟练的打造手艺！"],["押镖任务","人物等级>=20级#e可前往[临淄城]找[程镖头]领取押镖任务，完成获得大量金钱奖励，并有一定几率获取阵法书，还有可能获得红包（#cff0000里面有200元宝哦#o）。"],["消灭山贼","人物等级>=30级#e每天整点，在随机野外地图刷出10只山贼，至少3人组队才能与山贼战斗，打败山贼获得大量的经验和金钱奖励，并有较大几率获得藏宝图。"],["帮派青龙","人物等级>=20级#e在[郢城]的[帮派总管]处加入帮派，进入帮派领地，在帮派的领地里面去找青龙堂总管，领取任务，完成任务可获得大量的经验、金钱和帮贡"],["帮派玄武","人物等级>=20级#e在帮派的领地里面去找玄武堂总管，领取任务，完成任务可获得大量的经验、金钱和帮贡（帮贡可在学院点帮派修炼）"],["帮派朱雀","人物等级>=20级#e在帮派的领地里面去找朱雀堂总管，领取任务，完成任务可获得大量的经验、金钱和帮贡，在第10次并能获取丹方，是炼丹的必备品。"]],[["门派闯关","每周四20:00点在[咸阳]或[临淄]的[门派活动使者]处领取任务，然后根据任务挑战门派护卫。每闯过一关都有丰厚的奖励，闯关速度最快的队伍更有高等级稀有宝石领取。"],["保卫西阳","每周一20:00点在大禹水道，平原山陵，函谷关，太行山四个地图刷新怪物向西阳城进攻，玩家阻挡怪物，阻止怪物进入西阳城，打败怪物会获得丰厚的奖励，保卫西阳城成功，在西阳城更有稀有宝箱出现。"],["比武大会","每周五中午12点~周六中午12点，玩家可以在[咸阳]的[比武接引人]报名，周六和周日下午13点~15点之间分别进行两场比武，比武获胜方可领取宝箱，即使失败也有其他丰厚奖励"],["帮派之战","每周五，周六，周日的19点~20点在[咸阳]的[帮战接引先锋]处进入帮战场地（帮主需提前报名），获胜帮派的成员将会获得100点帮贡和大量经验，并在帮战场地内刷出大量宝箱"],["封印叔叔","在挖宝时，有一定几率挖出妖怪叔叔，玩家组队去封印妖怪叔叔，会获得稀有的宝石和大量的经验金钱。"],["挑战嚣张","每天系统会在城市中刷新出4种嚣张妖怪（有点嚣张、比较嚣张、很嚣张、太嚣张）每种怪物每天可挑战一次，挑战成功，有几率获取丰厚的奖励（如高级宠物技能包）"],["战队竞技","在[咸阳]的[神威将军]处创建战队后，战队队长可以挑战比自己排名高的战队，挑战胜利可以提升战队排名。排名越靠前，战队每日声望增长越多"],["跑环","玩家在郢城的吉祥处领取跑环任务，完成跑环任务可获得相应等级的装备图纸。"]],[["门派任务","人物等级>=10级#e10级加入门派后，找门派师傅领取任务，每天的前两轮（会员三轮）任务获得双倍奖励。"],["为民除害","人物等级>=10级#e在[西阳城守卫]处领取，任务完成后会获得大量的经验奖励。"],["每日赛跑","人物等级>=10级#e在[临淄城]的[田忌]处领取，完成获得大量经验和金钱奖励，并获得一个三级草药。每天前十名更能额外获得道具奖励。#e任务可自动寻路完成"],["世界抢答","人物等级>=10级#e每隔一段时间，系统会发出一道题目，可在世界频道回答，最先答对的两名玩家各获得一颗宝石，并从前二十名答对的玩家中抽取4名给予66666铜币奖励"],["智者答题","无等级要求#e在各城市，每隔一段时间会随机出现一个智者，第一个答对智者问题的人可获得经验和金钱奖励，并有一定几率获得一颗宝石"],["押镖任务","人物等级>=20级#e可前往[临淄城]找[程镖头]领取押镖任务，完成获得大量金钱奖励，并有一定几率获取阵法书，还有可能获得红包（#cff0000里面有200元宝哦#o）。"],["追捕强盗","人物等级>=20级#e可以在[郢城]的[栾千盛]处领取追捕强盗任务，要求至少3人组队才能领取，完成获取经验金钱奖励，10次为一轮，第10次队长必定获得装备制造图纸，其他队员有几率获得道具奖励。"],["护法任务","人物等级>=20级#e在[咸阳]的[商鞅]处领取任务，完成获得大量的经验和金钱，10次为一轮，完成每轮的第十次任务可获得制作装备的材料。"],["帮派任务","人物等级>=20级#e在[郢城]的[帮派总管]处加入帮派，进入帮派领地，在帮派领地内可领取各种帮派任务，完成获得经验、金钱和帮贡，不同任务还有额外奖励"]],[["消灭山贼","人物等级>=30级#e每天整点，在随机野外地图刷出10只山贼，至少3人组队才能与山贼战斗，打败山贼获得大量的经验和金钱奖励，并有较大几率获得藏宝图。"],["封印叔叔","在挖宝时，有一定几率挖出妖怪叔叔，玩家组队去封印妖怪叔叔，会获得稀有的宝石和大量的经验金钱。"],["挑战嚣张","每天系统会在城市中刷新出4种嚣张妖怪（有点嚣张、比较嚣张、很嚣张、太嚣张）每种怪物每天可挑战一次，挑战成功，有几率获取丰厚的奖励（如高级宠物技能包）"],["门派闯关","每周二20:00点在[咸阳]或[临淄]的[门派活动使者]处领取任务，然后根据任务挑战门派护卫。每闯过一关都有丰厚的奖励，闯关速度最快的队伍更有高等级稀有宝石领取。"],["保卫西阳","每周三20:00点在大禹水道，平原山陵，函谷关，太行山四个地图刷新怪物向西阳城进攻，玩家阻挡怪物，阻止怪物进入西阳城，打败怪物会获得丰厚的奖励，保卫西阳城成功，在西阳城更有稀有宝箱出现。"],["比武大会","每周五中午12点~周六中午12点，玩家可以在[咸阳]的[比武接引人]报名，周六和周日下午13点~15点之间分别进行两场比武，比武获胜方可领取宝箱，即使失败也有其他丰厚奖励"],["帮派之战","每周五，周六，周日的19点~20点在[咸阳]的[帮战接引先锋]处进入帮战场地（帮主需提前报名），获胜帮派的成员将会获得100点帮贡和大量经验，并在帮战场地内刷出大量宝箱"],["战队竞技","在[咸阳]的[神威将军]处创建战队后，战队队长可以挑战比自己排名高的战队，挑战胜利可以提升战队排名。排名越靠前，战队每日声望增长越多"],["战队秘境","战队队长可在[咸阳]的[神威将军]处开启秘境，需要消耗战队声望，战队秘境里掉落大量的稀有道具，以及宠物进阶所必须的封印兽魂"],["副本挑战","人物等级>=40级#e在[咸阳]的[副本官]处创建自己的副本，也可申请加入其他玩家创建的副本。副本会掉落大量的稀有物品道具。"],["跑环","人物等级>=50级#e在[郢城]的[吉祥]处领取跑环任务，完成跑环任务可获得大量经验快速升级，每50环还可获得相应等级的装备图纸和手艺。"],["师徒任务","在[临淄]的[慎到]处拜师或收徒，师徒二人组队在慎到处领取师徒任务，任务会给与大量的经验和金钱奖励。徒弟出师后，师傅可获得宠物修炼积分"]],[["剑侠居","要求种族：人族#e门派特色：物理攻击型，具有超高物理输出、点杀能力。 #e推荐加点：5力、4力1敏、4力1体。#e●剑侠居算是最热门的一个门派，容易上手，输出可观，是练级不可缺少的一员，相对的装备也比较贵，后期的剑侠居，拥有较高的暴击率，在竞技玩法中更是点杀的一大利器。"],["茅棚坞","要求种族：人族#e门派特色：辅助型，具有高速度和强大的封印能力。 #e推荐加点：3敏2体、2敏3体、2敏2体1耐。#e●引以为傲的是速度，同样配置的情况下，先出手的绝对是茅棚，速度决定了竞技玩法的主动权，轮轴术也能很好的利用在卡敏战术中，迷雾让己方的胜率几率更大化，练级时，一个奇谋也能加快脚步。"],["庐医崖","要求种族：人族#e门派特色：辅助型、具有强大的加血和救人技能。#e推荐加点：3体2耐、2体2耐1法、2体2敏1耐。#e●作为七国里唯一的纯奶妈，具有强大的加血技能和救人技能，是各种高端任务、活动，竞技玩法不可缺少的一员。"],["溶洞","要求种族：魔族#e门派特色：法术攻击型，具有最高法系伤害。#e推荐加点：5法、4法1体#e●输出比封神高，但是目标数量比封神少，总伤害算起来反而不如封神了，不过做为七国的两大法系门派，溶洞更注重于多手段控制，相比封神来说没那么单调。"],["鬼谷","要求种族：魔族#e门派特色：辅助型，具有强大的封印和解封技能。#e推荐加点：3敏2体、2敏3体。#e●作为封系，鬼谷最大的特点就是可以为己方解封，还有增加封印几率的增益，在竞技玩法中也是一大强将。"],["武安阁","要求种族：魔族#e门派特色：物理攻击型、具有强大的物理攻击能力。#e推荐加点：5力、4力1敏、4力1体。#e●两大物理伤害的武安阁，点杀能力一点都不比剑侠居低，乱舞后还不用休息，单缺点就是太消耗蓝，续航能力不足。在竞技玩法和练级中，与剑侠居有同等的地位。"],["封神台","要求种族：仙族#e门派特点：法术伤害型、具有强大群秒技能#e推荐加点：5法、4法1体#e●两大法系之一，练级最受欢迎的门派，当然你要有一定的装备，不然小心免费回城。七国里的NPC怪物理攻击较高，所以很多玩家都注重于物理防御，导致在竞技玩法中，法系的输出也相当的可观。"],["仙人洞","要求种族：仙族#e门派特点：辅助攻击型，具有固定伤害和持续恢复，以及各种增益。#e推荐加点：3体2耐、2体2耐1速#e●在前期，玩家伤害普遍不高，血量也低的时候，仙人洞的固定伤害就是一大利器，又肉又能输出，是前期练级最重要的一员。"],["神女峰","要求种族：仙族#e门派特点：辅助攻击型，具有单体高伤、复活、持续蓝恢复、封印#e推荐加点：4力1体、3力2法(攻击型)、3体2耐(辅助型)#e●神女是又能输出又能复活又能封的门派，绝对可以省下奶妈与控制的位置，多加一个输出，大大加快练级速度。"]],[["人物升级",""],["装备打造",""],["修炼提升",""],["宠物进阶",""],["坐骑养成",""]],[["辅助技能",""],["剧情技能",""],["家园种植",""]]];class ve extends s{InitFrame(i,t,s){var e;for(this.iTurnCount=0,e=0;e<20;e++)ht.gi().goods[2][e].iGid>0&&ht.gi().goods[2][e].iTid==t&&ht.gi().goods[2][e].iCount>=s&&(this.gs[this.iTurnCount].copyfrom(ht.gi().goods[2][e]),this.iTurnCount++);this.iMPoint=i,this.lockgoods=this.gs[0],qi.new_LockPos(this.iX+30,this.iY+30,this.gs,this.lockgoods)}constructor(i){var t;for(super(),this.gs=new Array(20),t=0;t<20;t++)this.gs[t]=new Li;this.iW=490,this.iH=480,this.iX=h.SCRW-this.iW-20,this.iY=(h.SCRH-this.iH)/2,this.lockgoods=null,this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_turn=new Eh(gn.xani_button),this.btn_turn.InitButton("普通按钮140_55"),this.btn_turn.sName="上  交",this.btn_turn.Move(this.iX+this.iW-140-30,this.iY+this.iH-30-55,140,55)}Draw(){E.frame_type4("中等框a52_50",this.iX,this.iY,this.iW,this.iH,52,50),qi.new_DrawGoods(this.iX+30,this.iY+30,this.gs,null,null),null!=this.lockgoods&&qi.new_DrawRect(this.iX+30,this.iY+30,this.gs,this.lockgoods,0),this.btn_turn.Draw(),qi.bShowDetail()&&qi.new_DrawDetail(null,-1,-1,0)}ProcTouch(i,t,s){if(this.btn_turn.ProcTouch(i,t,s))return this.btn_turn.bCheck()&&(null==this.lockgoods?L.easymsg.AddMessage("请先选择所交物品"):(10==this.iMPoint&&163==this.lockgoods.iTid&&xh.me.iFlag[1],Mh.gi().s_FinishMission(1,this.iMPoint,this.lockgoods.iGid,0),ln.gi().PopStat(1))),!0;var e=qi.new_LockGoods(t,s,this.iX+30,this.iY+30,this.gs,i);return qi.NoMove(),3==i&&null!=e?this.lockgoods=e:null==e&&(this.lockgoods=null),this.btn_close.ProcTouch(i,t,s)?(this.btn_close.bCheck()&&ln.gi().PopStat(1),!0):(3!=i||bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||ln.gi().PopStat(1),!1)}}ve.psm,ve.Open=function(i){var t,s,e;for(t=0;t<Us.MAXMISSIONCOUNT;t++)if(Us.m.smlist[t].bUseing&&(ve.psm=Us.m.smlist[t],ve.psm.iMPoint==i))for(s=0;s<ve.psm.iItemCount;s++){if(0==(e=ve.psm.si[s]).iMType&&0==e.iSType)if(ht.bHaveGoods(e.iV1,e.iV2))return ln.gi().PushStat(ln.GS_SELECTGOODSFORMISSION).InitFrame(i,e.iV1,e.iV2),!0;if(0==e.iMType&&16==e.iSType)if(ht.bHaveGoods(e.iV3,1))return ln.gi().PushStat(ln.GS_SELECTGOODSFORMISSION).InitFrame(i,e.iV3,1),!0}return!1};class Me extends s{constructor(i){var t;for(super(),this.iW=885,this.iH=580,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_approve=new Eh(gn.xani_nui2),this.btn_approve.InitButton("按钮1"),this.btn_approve.sName="认证",this.btn_selpet=new Array(12),this.btn_selskill=new Array(12),t=0;t<12;t++)this.btn_selpet[t]=new D(gn.xani_button),this.btn_selpet[t].bSingleButton=!0,this.btn_selskill[t]=new D(gn.xani_button),this.btn_selskill[t].bSingleButton=!0;this.iPetPoint=0,this.iSkillPoint=-1}Draw(){var i,t,s,e,h;for(E.new_baseframe2(this.iX,this.iY,this.iW,this.iH,"认","证"),t=this.iX+30,s=this.iY+30,E.new_framein(t,s,392,520),c.gi().DrawTextEx(t+196,s+30,"请选择你要认证的宠物",4278206039,30,101,1,1,0,-2,0),i=0;i<8;i++)e=t+20+i%4*92,h=s+90+i/4*92,gn.xani_nui2.DrawAnima(e,h,"宠物头像框",0),this.btn_selpet[i].Move(e,h,83,83),i>=Bi.mp.iPetCount||(gn.xani_head.DrawAnima_aa(e,h,gn.de_pet.strValue(Bi.mp.pets[i].iTid,0,1),0),Bi.mp.pets[i].iFlag/100%10!=0&&c.gi().DrawText_2(e-6,h+80,"绑",4285267956,26,101,1,1,0,0,-3,4,4278190080),this.iPetPoint==i&&gn.xani_nui2.DrawAnimaEx(e,h,"头像选中框",0,101,1,1,0,0,0));for(Y.gi().FormatEx("#c003e57技能认证条件#e1,要求宠物第9技能格为开启状态(炼妖有几率开启)#e2,技能认证花费=参战等级*1万+90万#e3,认证过的宠物不能重复认证#e4,认证的技能打书时不会被覆盖",352,25,0,0,32),Y.gi().Draw(t+20,s+280),t+=412,E.new_framein(t,s,415,520),c.gi().DrawTextEx(t+20,s+30,"宠物名称："+Bi.mp.pets[this.iPetPoint].sName,4278206039,30,101,1,1,0,0,0),c.gi().DrawTextEx(t+196,s+90,"请选择你要认证的宠物",4278206039,30,101,1,1,0,-2,0),i=0;i<12;i++)e=t+20+i%4*99,h=s+150+i/4*97,this.btn_selskill[i].Move(e,h,92,92),gn.xani_nui2.DrawAnima(e,h,"技能框",0),this.iPetPoint>=Bi.mp.iPetCount||(i>=Bi.mp.pets[this.iPetPoint].iSkillBlock&&gn.xani_nui2.DrawAnima(e,h,"技能框",1),Bi.mp.pets[this.iPetPoint].jn[i]>0&&gn.xani_nicon.DrawAnima_aa(e,h,gn.de_skill.strValue(Bi.mp.pets[this.iPetPoint].jn[i],0,5),0),this.iSkillPoint==i&&(gn.xani_nui4.DrawAnima(e-7,h-7,"选中技能",0),Yi.Skill_Detail(Bi.mp.pets[this.iPetPoint].jn[i],e,h,-1)));this.btn_approve.Move(t+127,s+455,161,53),this.btn_approve.Draw(),this.btn_close.Draw(),ei.end(ei.CONFIRM_APPROVEPET)&&ei.bConfirm&&(Mh.gi().s_SeverEvent(26,1,Bi.mp.pets[this.iPetPoint].iPid,Bi.mp.pets[this.iPetPoint].jn[this.iSkillPoint],this.iSkillPoint),ln.gi().PopStat(1))}ProcTouch(i,t,s){var e;for(e=0;e<Bi.mp.iPetCount;e++)if(this.btn_selpet[e].ProcTouch(i,t,s))return this.btn_selpet[e].bCheck()&&(this.iPetPoint=e,this.iSkillPoint=-1),!0;for(e=0;e<8;e++)this.btn_selskill[e].ProcTouch(i,t,s)&&this.btn_selskill[e].bCheck()&&Bi.mp.pets[this.iPetPoint].jn[e]>0&&(this.iSkillPoint=e);return this.btn_approve.ProcTouch(i,t,s)&&this.btn_approve.bCheck()&&(e=1e4*gn.de_pet.intValue(Bi.mp.pets[this.iPetPoint].iTid,0,2)+9e5,this.iSkillPoint<0||this.iSkillPoint>7||0==Bi.mp.pets[this.iPetPoint].jn[this.iSkillPoint]?Z.fm.Open("请先选择要认证的技能"):0==(128&Bi.mp.pets[this.iPetPoint].iBaobao)?Z.fm.Open("没有开启第九个技能格无法认证宠物（第九个技能格在炼妖时有几率开启）"):xh.me.rbs.iMoney<e?Z.fm.Open("认证资金不足"):Bi.mp.pets[this.iPetPoint].jn[8]>0?Z.fm.Open("已有认证技能"):ei.start(ei.CONFIRM_APPROVEPET,"本次认证花费"+e+"铜币，技能认证后不可更改，是否确定认证？")),this.btn_close.ProcTouch(i,t,s)&&this.btn_close.bCheck()&&ln.gi().PopStat(1),!1}}Me.Open=function(){Bi.mp.iPetCount<=0?Z.fm.Open("当前没有宠物"):ln.gi().PushStat(ln.GS_APPROVEPET)};class ye extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=600,this.iH=360,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_jj=new Eh(gn.xani_button),this.btn_jj.Move(this.iX+this.iW-120-30,this.iY+this.iH-30-60,120,60),this.btn_jj.InitButton("1号按钮120_60"),this.btn_jj.sName="进 阶",this.btn_close=new Eh(gn.xani_button),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_close.InitButton("关闭按钮"),this.iPetPoint=-1}Draw(){var i,t,s;for(E.frame_type4("10号框20_20",this.iX,this.iY,this.iW,this.iH,20,20),this.pm3f.DrawText_2(this.iX+this.iW/2,this.iY+15,"宠物进阶",4294896766,40,101,1,1,0,-2,0,2,4278261038),this.pm3f.DrawTextEx(this.iX+20,this.iY+this.iH-20-15,"注：每次进阶可提升每项5点固定属性和25点可分配属性",4279324257,20,101,1,1,0,0,0),t=this.iX+20,s=this.iY+60,E.frame_type4("11号框20_20",t,s,200,250,20,20),i=0;i<Bi.mp.iPetCount;i++)this.iPetPoint==i&&E.frame_type1("12号框20_30",t+5,s+5+30*i,190,20),this.pm3f.DrawTextEx(t+5,s+5+30*i,Bi.mp.pets[i].sName,4279324257,30,101,1,1,0,0,0);if(this.iCanJJ=0,t=this.iX+240,s=this.iY+70,this.iPetPoint>=0&&this.iPetPoint<Bi.mp.iPetCount){var e=Bi.mp.pets[this.iPetPoint];if(e.iStar>=5)this.pm3f.DrawTextEx(t,s,"当前宠物已进阶至最高",4294967295,30,101,1,1,0,0,0);else{var h=20*(e.iStar+1),a=280+e.iStar,n=285+e.iStar;for(e.iLev<h?this.pm3f.DrawTextEx(t,s,"等级："+e.iLev+"(>="+h+")",4294901760,30,101,1,1,0,0,0):(this.pm3f.DrawTextEx(t,s,"等级："+e.iLev+"(>="+h+")",4278255360,30,101,1,1,0,0,0),this.iCanJJ|=1),i=0;i<20;i++)ht.gi().goods[2][i].iGid>0&&ht.gi().goods[2][i].iTid==a&&(this.iCanJJ|=2),ht.gi().goods[2][i].iGid>0&&ht.gi().goods[2][i].iTid==n&&ht.gi().goods[2][i].iCount>=30&&(this.iCanJJ|=4);gn.xani_nui3.DrawAnima(t,s+40,"物品格子",0),gn.xani_ngoods.DrawAnima_aa(t,s+40,gn.de_goods.strValue(a,0,10),0),0==(2&this.iCanJJ)?this.pm3f.DrawTextEx(t+85,s+40+25,gn.de_goods.strValue(a,0,4)+" x 1",4294901760,30,101,1,1,0,0,0):this.pm3f.DrawTextEx(t+85,s+40+25,gn.de_goods.strValue(a,0,4)+" x 1",4278255360,30,101,1,1,0,0,0),gn.xani_nui3.DrawAnima(t,s+40+100,"物品格子",0),gn.xani_ngoods.DrawAnima_aa(t,s+40+100,gn.de_goods.strValue(n,0,10),0),0==(4&this.iCanJJ)?this.pm3f.DrawTextEx(t+85,s+40+100+25,gn.de_goods.strValue(n,0,4)+" x 30",4294901760,30,101,1,1,0,0,0):this.pm3f.DrawTextEx(t+85,s+40+100+25,gn.de_goods.strValue(n,0,4)+" x 30",4278255360,30,101,1,1,0,0,0)}}7==this.iCanJJ&&this.btn_jj.Draw(),this.btn_close.Draw()}ProcTouch(i,t,s){var e,h;return e=this.iX+20,h=this.iY+60,7==this.iCanJJ&&this.btn_jj.ProcTouch(i,t,s)?(this.btn_jj.bCheck()&&(Mh.gi().s_PetJJ(Bi.mp.pets[this.iPetPoint].iPid,0,0),ln.gi().PopStat(1)),!0):(bn.bInRect(t,s,e,h,200,250)&&(this.iPetPoint=parseInt((s-h)/30)),this.btn_close.ProcTouch(i,t,s)?(this.btn_close.bCheck()&&ln.gi().PopStat(1),!0):!!bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH))}}ye.Open=function(){ln.gi().iXStat==ln.GS_JJPET?ln.gi().oCurrentView:ln.gi().PushStat(ln.GS_JJPET)};class Re extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=550,this.iH=410,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_one=new Wi(gn.xani_button),this.btn_one.Move(this.iX+20,this.iY+this.iH-20-60,150,60),this.btn_one.InitButton("1号按钮150_60"),this.btn_one.sName="融合一次",this.btn_all=new Wi(gn.xani_button),this.btn_all.Move(this.iX+this.iW-150-20,this.iY+this.iH-20-60,150,60),this.btn_all.InitButton("1号按钮150_60"),this.btn_all.sName="融合全部",this.btn_close=new Wi(gn.xani_button),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_close.InitButton("关闭按钮")}Draw(){var i,t;E.frame_type4("10号框20_20",this.iX,this.iY,this.iW,this.iH,20,20),this.pm3f.DrawText_2(this.iX+this.iW/2,this.iY+15,"融合自然之力",4294952960,40,101,1,1,0,-2,0,2,4278190080),i=this.iX+20,t=this.iY+70,gn.xani_nui3.DrawAnima(i,t,"物品格子",0),gn.xani_ngoods.DrawAnima_aa(i,t,gn.de_goods.strValue(this.gp.iTid,0,10),0),this.gp.iCount<=2?this.pm3f.DrawTextEx(i+85,t+25,gn.de_goods.strValue(this.gp.iTid,0,4)+" x "+this.gp.iCount,4294901760,30,101,1,1,0,0,0):this.pm3f.DrawTextEx(i+85,t+25,gn.de_goods.strValue(this.gp.iTid,0,4)+" x "+this.gp.iCount,4278255360,30,101,1,1,0,0,0),t+=100,E.frame_type4("11号框20_20",i,t,this.iW-40,145,20,20),i+=10,t+=10,this.pm3f.DrawTextEx(i,t,"融合规则：",4279324257,20,101,1,1,0,0,0),this.pm3f.DrawTextEx(i,t+25,"3个一级自然之力+3万铜币=1个二级自然之力",4279324257,20,101,1,1,0,0,0),this.pm3f.DrawTextEx(i,t+50,"3个二级自然之力+3万铜币+10元宝=1个三级自然之力",4279324257,20,101,1,1,0,0,0),this.pm3f.DrawTextEx(i,t+75,"3个三级自然之力+3万铜币+20元宝=1个四级自然之力",4279324257,20,101,1,1,0,0,0),this.pm3f.DrawTextEx(i,t+100,"3个四级自然之力+3万铜币+30元宝=1个五级自然之力",4279324257,20,101,1,1,0,0,0),this.btn_one.Draw(),this.btn_all.Draw(),this.btn_close.Draw(),ei.end(ei.CONFIRM_MERGEONE)&&ei.bConfirm&&(Mh.gi().s_FTOperate(8,1,this.gp.iGid),ln.gi().PopStat(1)),ei.end(ei.CONFIRM_MERGEALL)&&ei.bConfirm&&(Mh.gi().s_FTOperate(8,2,this.gp.iGid),ln.gi().PopStat(1))}ProcTouch(i,t,s){var e;return this.btn_one.ProcTouch(i,t,s)?(this.btn_one.bCheck()&&(285==this.gp.iTid?ei.start(ei.CONFIRM_MERGEONE,"3个一级自然之力+3万铜币=1个二级自然之力#e是否确定融合？"):286==this.gp.iTid?ei.start(ei.CONFIRM_MERGEONE,"3个二级自然之力+3万铜币+10元宝=1个三级自然之力#e是否确定融合？"):287==this.gp.iTid?ei.start(ei.CONFIRM_MERGEONE,"3个三级自然之力+3万铜币+20元宝=1个四级自然之力#e是否确定融合？"):288==this.gp.iTid&&ei.start(ei.CONFIRM_MERGEONE,"3个四级自然之力+3万铜币+30元宝=1个五级自然之力#e是否确定融合？")),!0):this.btn_all.ProcTouch(i,t,s)?(this.btn_all.bCheck()&&(e=this.gp.iCount/3,285==this.gp.iTid?ei.start(ei.CONFIRM_MERGEALL,3*e+"个一级自然之力+"+3*e+"万铜币="+e+"个二级自然之力#e是否确定融合？"):286==this.gp.iTid?ei.start(ei.CONFIRM_MERGEALL,3*e+"个二级自然之力+"+3*e+"万铜币+"+10*e+"元宝="+e+"个三级自然之力#e是否确定融合？"):287==this.gp.iTid?ei.start(ei.CONFIRM_MERGEALL,3*e+"个三级自然之力+"+3*e+"万铜币+"+20*e+"元宝="+e+"个四级自然之力#e是否确定融合？"):288==this.gp.iTid&&ei.start(ei.CONFIRM_MERGEALL,3*e+"个四级自然之力+"+3*e+"万铜币+"+30*e+"元宝="+e+"个五级自然之力#e是否确定融合？")),!0):this.btn_close.ProcTouch(i,t,s)?(this.btn_close.bCheck()&&ln.gi().PopStat(1),!0):!!bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)}}Re.Open=function(){ht.gi().goods[2][0].iGid<=0||285!=ht.gi().goods[2][0].iTid&&286!=ht.gi().goods[2][0].iTid&&287!=ht.gi().goods[2][0].iTid&&288!=ht.gi().goods[2][0].iTid?Z.fm.Open("请先将待融合的自然之力放到物品栏第一格"):(ln.gi().iXStat==ln.GS_MERGEZR?ln.gi().oCurrentView:ln.gi().PushStat(ln.GS_MERGEZR)).gp=ht.gi().goods[2][0]};class Ge extends s{_getpage(i){this.iPage=i.GetNextByte(),this.iCount=i.GetNextInt(),this.iCount>this.MAXBDS&&(this.iCount=this.MAXBDS);for(var t=0;t<this.iCount;t++)this.bds[t].iLev=i.GetNextByte(),this.bds[t].iType=i.GetNextByte(),this.bds[t].iPrice=i.GetNextInt()}constructor(i){super(),this.MAXBDS=10,this.iW=660,this.iH=660,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.bds=new Array(this.MAXBDS);for(var t=0;t<this.MAXBDS;t++)this.bds[t]=new Object;this.list_drawing=new Oi(0,3,this.iW-100,410),this.list_drawing.SetTitle(0,"类型",160,!1),this.list_drawing.SetTitle(1,"等级",100,!0),this.list_drawing.SetTitle(2,"价格",260,!0),this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_page=new Array(8);for(t=0;t<6;t++)this.btn_page[t]=new Eh(gn.xani_button),this.btn_page[t].InitButton("频道选择"),this.btn_page[t].sName=10*(t+3)+"";this.btn_buy=new Eh(gn.xani_button),this.btn_buy.InitButton("普通按钮140_55"),this.btn_buy.sName="购买"}Draw(){var i;for(console.log("购买"),E.new_baseframe4(this.iX,this.iY,this.iW,this.iH,"图","纸","商","店"),this.btn_close.Draw(),E.new_framein(this.iX+30,this.iY+30,this.iW-60,this.iH-60),c.gi().DrawTextEx(this.iX+30+20,this.iY+30+30+20,"选择等级",4294967295,30,101,1,1,0,0,-2),i=0;i<6;i++)this.iPage==i+3&&(this.btn_page[i].bMouseDown=!0),this.btn_page[i].Move(this.iX+30+20+140+70*i,this.iY+30+20,60,60),this.btn_page[i].Draw();for(this.list_drawing.BeginDraw(this.iX+30+20,this.iY+30+20+60+20),i=0;i<this.iCount;i++)this.list_drawing.DrawUnit(0,i,Ge._TYPE[i]),this.list_drawing.DrawUnit(1,i,10*this.bds[i].iLev+"级"),this.list_drawing.DrawUnit(2,i,this.bds[i].iPrice+"铜币");this.list_drawing.FinishDraw(),c.gi().DrawTextEx(this.iX+30+20,this.iY+this.iH-30-20-30,"铜币："+xh.me.rbs.iMoney,4294967295,30,101,1,1,0,0,-2),this.btn_buy.Move(this.iX+this.iW-30-20-140,this.iY+this.iH-30-20-55,140,55),this.btn_buy.Draw()}ProcTouch(i,t,s){var e;if(this.list_drawing.ProcTouch(i,t,s))return!0;for(e=0;e<6;e++)this.btn_page[e].ProcTouch(i,t,s)&&this.btn_page[e].bCheck()&&this.iPage!=e+3&&(this.iPage=e+3,this.iCount=0,Ge.GetPage(e+3));return this.btn_buy.ProcTouch(i,t,s)?(this.btn_buy.bCheck()&&(this.list_drawing.iLockPoint<0?L.easymsg.AddMessage("请先选中行"):xh.me.rbs.iMoney<this.bds[this.list_drawing.iLockPoint].iPrice?L.easymsg.AddMessage("铜币不足"):Mh.gi().s_SeverEvent(34,1,this.iPage,this.bds[this.list_drawing.iLockPoint].iType,this.bds[this.list_drawing.iLockPoint].iPrice)),!0):(this.btn_close.ProcTouch(i,t,s)&&this.btn_close.bCheck()&&ln.gi().PopStat(1),!1)}}Ge.GetPage=function(i){Mh.gi().s_SeverEvent(34,0,i,0,0)},Ge.Open=function(i){var t=ln.gi().FindStat(ln.GS_SHOPBUYDRAWING);null==t&&(t=ln.gi().PushStat(ln.GS_SHOPBUYDRAWING)),t._getpage(i)},Ge._TYPE=["头盔","项链","剑","刀","枪","男衣","女衣","腰带","鞋子"];class Ee extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=400,this.iH=400,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.in_shopname=new pi(gn.xani_frame),this.in_shopname.Move(this.iX+10,this.iY+100,this.iW-20,60),this.in_shopname.bHideText=!0,this.btn_pet=new D(gn.xani_button),this.btn_pet.InitButton("统一大按钮3"),this.btn_pet.Move(this.iX+150,this.iY+170,110,50),this.btn_pet.sName="宠物店",this.btn_goods=new D(gn.xani_button),this.btn_goods.InitButton("统一大按钮3"),this.btn_goods.Move(this.iX+150+120,this.iY+170,110,50),this.btn_goods.sName="物品店",this.btn_create=new Wi(gn.xani_ui3),this.btn_create.Move(this.iX+this.iW-117-20,this.iY+this.iH-50-15,117,40),this.btn_create.InitButton("统一按钮1"),this.btn_create.sName="创建",this.btn_cancel=new Wi(gn.xani_ui3),this.btn_cancel.Move(this.iX+20,this.iY+this.iH-50-15,117,40),this.btn_cancel.InitButton("统一按钮1"),this.btn_cancel.sName="取消",this.ipog=0}Draw(){E.ui3_DefineFrame(this.iX,this.iY,this.iW,this.iH),this.pm3f.DrawText_2(this.iX+this.iW/2,this.iY+15,"创建店铺",4294952960,40,101,1,1,0,-2,0,2,4278190080),this.pm3f.DrawTextEx(this.in_shopname.iX,this.in_shopname.iY-30,"输入店铺名称：",4278190080,30,101,1,1,0,0,0),E.Frame1_BR(this.in_shopname.iX,this.in_shopname.iY,this.in_shopname.iW,this.in_shopname.iH),Y.gi().Format(this.in_shopname.sDetail,this.in_shopname.iW-10,30),Y.gi().Draw(this.in_shopname.iX+15,this.in_shopname.iY+15),this.pm3f.DrawTextEx(this.in_shopname.iX,this.iY+180,"店铺类型：",4278190080,30,101,1,1,0,0,0),0==this.ipog?(this.btn_pet.bMouseIn=!0,this.btn_pet.bMouseDown=!0):(this.btn_goods.bMouseIn=!0,this.btn_goods.bMouseDown=!0),this.btn_pet.Draw(),this.btn_goods.Draw(),Y.gi().Format("#c000000说明：新建店铺需要缴纳150万铜币#e营业状态下每个柜台每天收取5万维护费#e休息状态下每个柜台每天收取2万维护费#e交易成功，收取成交价5%的交易税",this.iW-40,20),Y.gi().Draw(this.iX+20,this.iY+230),this.btn_create.Draw(),this.btn_cancel.Draw(),this.in_shopname.onscr()}ProcTouch(i,t,s){if(this.in_shopname.ProcTouch(i,t,s),this.btn_pet.ProcTouch(i,t,s)&&this.btn_pet.bCheck()&&(this.ipog=0),this.btn_goods.ProcTouch(i,t,s)&&this.btn_goods.bCheck()&&(this.ipog=1),this.btn_create.ProcTouch(i,t,s)){if(this.btn_create.bCheck()){var e=this.in_shopname.sDetail.getBytes("GBK");if(e.length<4||e.length>16)return L.easymsg.AddMessage("店铺名称2-8个字"),!0;Mh.gi().s_CreateShop(this.in_shopname.sDetail,this.ipog),ln.gi().PopStat(1)}return!0}return this.btn_cancel.ProcTouch(i,t,s)?(this.btn_cancel.bCheck()&&ln.gi().PopStat(1),!0):!!bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)}}Ee.Open=function(){ln.gi().PushStat(ln.GS_CREATESHOP)};class Oe extends s{constructor(i){var t,s;for(super(),this.iW=900,this.iH=550,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.aa_cls=new Array(6),this.iColor=new Int32Array(6),this.btn_color=new Array(6),t=0;t<6;t++){for(this.btn_color[t]=new Array(6),this.aa_cls[t]=new Array(6),s=0;s<6;s++)this.aa_cls[t][s]=new l,this.btn_color[t][s]=new Eh(gn.xani_nui3),this.btn_color[t][s].InitButton("仓库按钮"),this.btn_color[t][s].sName=0==s?"原":""+s;this.iColor[t]=xh.me.iColor[t]}this.aa_body=new l,this.bChange=!0,this.btn_left=new Eh(gn.xani_nui3),this.btn_left.InitButton("打开任务"),this.btn_right=new Eh(gn.xani_nui3),this.btn_right.InitButton("向右转"),this.btn_rs=new Eh(gn.xani_nui2),this.btn_rs.InitButton("按钮1_110"),this.btn_rs.sName="染色",this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.iRote=4}fx(){switch(this.iRote<0&&(this.iRote+=8),this.iRote>=8&&(this.iRote-=8),this.iRote){case 0:return"上";case 1:return"左上";case 2:return"左";case 3:return"左下";case 4:return"下";case 5:return"右下";case 6:return"右";case 7:return"右上"}return"下"}ChangeColor1(i,t,s){var e;for(e=0;e<N._CHANGECOLOR[i].length;e++)this.iColor[e]<=0||this.iColor[e]>=6||(gn.xani_color[i][this.iColor[e]-1].InitAnimaWithName(N._CHANGECOLOR[i][e]+"_"+t,this.aa_cls[s][e]),gn.sop(N._CHANGECOLOR[i][e]+"_"+t))}DrawColor(i,t,s,e,h,a){var n;for(n=0;n<N._CHANGECOLOR[i].length;n++)this.iColor[n]<=0||this.iColor[n]>=6||(this.aa_cls[a][n].iFrame=t,this.aa_cls[a][n].Draw(e,h))}DrawRole(i,t,s,e,h){var a,n=2*xh.me.iRace+xh.me.iSex,o=xh.face_sti(s),r=xh.stat_sti(e),c=0;for(a=0;a<N._ANIMASORT[n][r][o].length;a++)"人物"==N._ANIMASORT[n][r][o][a]?(h&&(gn.xani_newrole[n].InitAnimaWithName(e+"_"+s,this.aa_body),this.ChangeColor1(n,e+"_"+s,0)),this.aa_body.Draw(i,t),this.DrawColor(n,this.aa_body.iFrame,t+c,i,t,0),this.aa_body.NextFrame(),c++):N._ANIMASORT[n][r][o][a]}Draw(){var i,t,s,e,h;E.new_bigframe(this.iX,this.iY,this.iW,this.iH),this.btn_close.Draw(),gn.xani_nui2.DrawAnima(this.iX+30+140-130,this.iY+100,"宠物背景",0),this.DrawRole(this.iX+30+140,this.iY+290,this.fx(),"站立",this.bChange),this.bChange=!1,this.btn_left.Move(this.iX+30+140-100-25,this.iY+200,50,70),this.btn_left.Draw(),this.btn_right.Move(this.iX+30+140+100-25,this.iY+200,50,70),this.btn_right.Draw();var a=2*xh.me.iRace+xh.me.iSex;s=(360-60*(e=N._CHANGECOLOR[a].length))/(e+1);for(h=0,this.iNeed=0,i=0;i<N._CHANGECOLOR[a].length;i++){for(c.gi().DrawTextEx(this.iX+310,this.iY+50+i*(s+60)+s+30,"部位"+(i+1),4278206039,30,101,1,1,0,0,-2),t=0;t<6;t++)this.iColor[i]==t&&(this.btn_color[i][t].bMouseDown=!0,this.btn_color[i][t].bMouseIn=!0),this.btn_color[i][t].Move(this.iX+400+80*t,this.iY+50+i*(s+60)+s,60,60),this.btn_color[i][t].Draw();this.iColor[i]!=xh.me.iColor[i]&&this.iColor[i]>0&&(h>0&&"+","部位"+(i+1)+"需"+N._CHANGECOLORCOST[a][i]+"彩果",h++,this.iNeed+=N._CHANGECOLORCOST[a][i])}for(c.gi().DrawTextEx(this.iX+50,this.iY+450,"共需"+this.iNeed+"个彩果",4278206039,30,101,1,1,0,0,0),this.btn_rs.Move(this.iX+this.iW-110-50,this.iY+450-11,110,52),this.btn_rs.Draw(),this.iCGCount=0,i=0;i<20;i++)ht.gi().goods[2][i].iGid>0&&312==ht.gi().goods[2][i].iTid&&(this.iCGCount+=ht.gi().goods[2][i].iCount);c.gi().DrawTextEx(this.iX+50,this.iY+450+35,"背包中有"+this.iCGCount+"个彩果",4278206039,30,101,1,1,0,0,0),ei.end(ei.CONFIRM_CHANGECOLOR)&&ei.bConfirm&&(Mh.gi().s_SeverEvent(23,0,this.iDestColor,0,0),ln.gi().PopStat(1))}ProcTouch(i,t,s){var e,h,a=2*xh.me.iRace+xh.me.iSex;for(e=0;e<N._CHANGECOLOR[a].length;e++)for(h=0;h<6;h++)this.btn_color[e][h].ProcTouch(i,t,s)&&this.btn_color[e][h].bCheck()&&(this.iColor[e]=h,this.bChange=!0);return this.btn_close.ProcTouch(i,t,s)?(this.btn_close.bCheck()&&ln.gi().PopStat(1),!0):this.btn_rs.ProcTouch(i,t,s)?(this.btn_rs.bCheck()&&(e=(((this.iColor[4]<<3|this.iColor[3])<<3|this.iColor[2])<<3|this.iColor[1])<<3|this.iColor[0],this.iNeed>this.iCGCount?L.easymsg.AddMessage("拥有彩果不足"):xh.me.iFlag[53]==e?L.easymsg.AddMessage("修改颜色后再染色"):(this.iDestColor=e,ei.start(ei.CONFIRM_CHANGECOLOR,"是否确定染成所选颜色？"))),!0):(this.btn_left.ProcTouch(i,t,s)&&this.btn_left.bCheck()&&(this.iRote--,this.bChange=!0),this.btn_right.ProcTouch(i,t,s)&&this.btn_right.bCheck()&&(this.iRote++,this.bChange=!0),!0)}}Oe.Open=function(){ln.gi().PushStat(ln.GS_CHANGECOLOR)};class Fe extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=400,this.iH=130,this.iX=(h.SCRW-this.iW)/2,this.iY=80,this.btn_close=new Eh(gn.xani_button),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_send=new Eh(gn.xani_button),this.btn_send.InitButton("1号按钮90_60"),this.btn_send.Move(this.iX+this.iW-40-90,this.iY+40-5,90,60),this.btn_send.sName="发送",this.in_speak=new pi(gn.xani_ui),this.in_speak.Move(this.iX+40,this.iY+40,this.iW-40-40-90-20,50),this.in_speak.bHideText=!0,this.in_speak.OpenInput()}Draw(){E.frame_type4("7号框52_52",this.iX,this.iY,this.iW,this.iH,52,52),E.frame_type4("8号框20_20",this.in_speak.iX,this.in_speak.iY,this.in_speak.iW,50,20,20),this.pm3f.DrawTextEx(this.in_speak.iX+10,this.in_speak.iY+this.in_speak.iH/2,this.in_speak.sDetail,4279324257,20,101,1,1,0,0,-2),this.btn_send.Draw(),this.btn_close.Draw(),this.in_speak.onscr()}ProcTouch(i,t,s){return this.in_speak.ProcTouch(i,t,s),this.btn_send.ProcTouch(i,t,s)&&this.btn_send.bCheck()&&(this.in_speak.sDetail.length<=0?L.easymsg.AddMessage("请先输入内容"):this.in_speak.sDetail.length>=40?L.easymsg.AddMessage("内容过长"):"teris"==this.in_speak.sDetail?(ln.gi().PopStat(1),Tetris.Open()):(Mh.gi().s_GetCodeReward(1,this.in_speak.sDetail),ln.gi().PopStat(1))),!!this.btn_close.ProcTouch(i,t,s)&&(this.btn_close.bCheck()&&ln.gi().PopStat(1),!0)}}Fe.Open=function(){ln.gi().PushStat(ln.GS_GETCODEREWARD)};class Xe{constructor(){this.bMapChanged=!1}RequirementCheck(i){var t,s,e;switch(i.iRid){case 0:if(t=parseInt(i.sValues[0]),xh.me.rbs.iSchoolId==t)return!0;break;case 1:if(Us.m.bCheckDoing(parseInt(i.sValues[0])))return!0;break;case 2:if(0!=parseInt(i.sValues[0]))return!!H.bInTeam()||(L.easymsg.AddMessage("请组队后再来"),!1);if(H.bNoTeam())return!0;break;case 3:if(xh.me.rbs.iLev>=parseInt(i.sValues[0])&&xh.me.rbs.iLev<=parseInt(i.sValues[1]))return!0;break;case 4:if(0==parseInt(i.sValues[0])){if(Fi.mg.iRealGid<=0)return!0}else if(Fi.mg.iRealGid>0)return!0;break;case 5:if(1==parseInt(i.sValues[0]))return gn.sop(""+Ih.gi().mapdata.sMapDetail),gn.sop(""+Fi.mg.sName),Ih.gi().mapdata.sMapDetail==Fi.mg.sName;if(0==parseInt(i.sValues[0]))return Ih.gi().mapdata.sMapDetail!=Fi.mg.sName;break;case 6:if(s=parseInt(i.sValues[0]),gn.sop("check special "+s),Us.m.bCheckSpecialDoing(s))return!0;break;case 7:if(wt.iFbType==parseInt(i.sValues[0])){if(0!=(t=parseInt(i.sValues[1]))&&wt.iFbProc<t)return!0;if(0!=(t=parseInt(i.sValues[2]))&&wt.iFbProc==t)return!0;if(0!=(t=parseInt(i.sValues[3]))&&wt.iFbProc>t)return!0}break;case 8:if(1==parseInt(i.sValues[0])&&Ih.gi().mapdata.sMapDetail==Fi.mg.sName)return!0;break;case 9:if(0==(t=parseInt(i.sValues[0]))){if(te.mft.iFTid<=0)return!0}else if(1==t){if(te.mft.iFTid>0)return!0}else if(2==t&&te.mft.iFTid>0&&te.mft.iFTJob<=1)return!0;break;case 10:for(s=parseInt(i.sValues[0]),e=parseInt(i.sValues[1]),t=0;t<20;t++)if(ht.gi().goods[2][t].iGid>0&&ht.gi().goods[2][t].iTid==s&&ht.gi().goods[2][t].iCount>=e)return!0;break;case 11:return Us.m.bCheckInMissionMap(parseInt(i.sValues[0]));case 12:if(null!=Ye.talkingnpc&&Ye.talkingnpc.bCurrentBlock&&Ye.talkingnpc.iNpcId==parseInt(i.sValues[0]))return!0;break;case 13:if(t=parseInt(i.sValues[0]),gn.sop(Ie.iPlanId+"=================="+t),Ie.iPlanId==t)return!0;break;case 14:if(t=parseInt(i.sValues[0]),bn.GetRand(0,100)<t)return!0;break;case 15:if(xh.me.rbs.iLev>=30&&0==(8&xh.me.iFlag[39]))return!0}return!1}ProcEvent(i){var t,s,e,h,a,n;switch(i.iEid){case 0:var o=Ih.gi().NameToId(i.sValues[0]),r=parseInt(i.sValues[1]),c=parseInt(i.sValues[2]);if(1==Ih.gi().iCurrentMapId&&xh.me.rbs.iLev<10&&ht.gi().goods[1][2].iGid<=0){Z.fm.Open("郊外比较危险，先带上武器再去吧（打开背包穿戴装备）");break}gn.sop("go to "+o+","+i.sValues[0]),Mh.gi().s_ChangeMap(o,r,c);break;case 1:(t=parseInt(i.sValues[0]))>=1&&t<=9&&Mh.gi().s_GetInSchool(t);break;case 2:ln.gi().PushStat(ln.GS_LEARNSKILL);break;case 3:t=parseInt(i.sValues[0]),s=parseInt(i.sValues[1]),Mh.gi().s_GetMission(t,s);break;case 4:Mh.gi().s_GetSchoolMission(parseInt(i.sValues[0]));break;case 5:500==(t=parseInt(i.sValues[0]))?ln.gi().PushStat(ln.GS_MYRECOVER):Mh.gi().s_NpcShop(t);break;case 6:Mh.gi().s_FinishMission(0,parseInt(i.sValues[0]),0,0);break;case 7:ln.gi().PushStat(ln.GS_CREATEGOV);break;case 8:switch(parseInt(i.sValues[0])){case 0:Mh.gi().s_NewGovOperate(0,0,0,0,0,""),Mh.gi().s_NewGovOperate(2,0,0,0,0,"");break;case 1:Mh.gi().s_GetIntoGov(Fi.mg.iRealGid);break;case 2:Mh.gi().s_GovOperateFrame(0);break;case 3:Mh.gi().s_GovOperateFrame(1);break;case 4:Mh.gi().s_getflag(),ln.gi().PushStat(ln.GS_PETXIU);break;case 5:Fi.mg.iRealGid>0&&Fi.mg.iJob<=1?se.Open():L.easymsg.AddMessage("帮主/副帮主才能报名");break;case 6:ln.gi().PushStat(ln.GS_CHANGENAME);break;case 7:Zs.start(Zs.IN_RID,"输入人物ID",0,99999999);break;case 8:ie.Open();break;case 9:Mh.gi().s_FTChallenge(0,1e5,0);break;case 10:L.easymsg.AddMessage("系统暂未开放");break;case 11:ye.Open();break;case 12:Re.Open();break;case 13:Ui.Open();break;case 14:Oe.Open();break;case 15:Ne.Open();break;case 16:Me.Open();break;case 17:he.Open();break;case 18:ke.Open();break;case 19:le.Open();break;case 20:Mh.gi().s_NewGovOperate(20,0,0,0,0,"");break;case 21:ee.Open();break;case 22:Mh.gi().s_NewGovOperate(20,1,0,0,0,"");break;case 23:Mh.gi().s_NewGovOperate(21,0,1,0,0,"");break;case 24:Mh.gi().s_NewGovOperate(21,0,0,0,0,"");break;case 25:Mh.gi().s_NewGovOperate(23,0,0,0,0,"");break;case 26:Mh.gi().s_NewGovOperate(24,0,0,0,0,"");break;case 27:Pe.Open();break;case 28:(t=xh.me.rbs.iLev/10)<3&&(t=3),t>8&&(t=8),Ge.GetPage(t);break;case 29:$s.Open(-1,0)}break;case 9:Mh.gi().s_HireWorker(parseInt(i.sValues[0]),parseInt(i.sValues[1]),parseInt(i.sValues[2]));break;case 10:switch(parseInt(i.sValues[0])){case 0:ln.gi().PushStat(ln.GS_MAKEEQUIP);break;case 1:ln.gi().PushStat(ln.GS_CAMEOOPERATE);break;case 2:ln.gi().PushStat(ln.GS_IMPROVEEQUIP)}break;case 11:t=parseInt(i.sValues[0]),ve.Open(t)||Mh.gi().s_FinishMission(1,t,0,0);break;case 12:switch(parseInt(i.sValues[0])){case 0:ln.gi().PushStat(ln.GS_GOODSSTOREFROME),ln.gi().PushStat(ln.GS_LOADING1),Mh.gi().s_OpenStore(0,0,0);break;case 1:Mh.gi().s_OpenStore(1,0,0)}break;case 13:Mh.gi().s_SeverEvent(parseInt(i.sValues[0]),parseInt(i.sValues[1]),parseInt(i.sValues[2]),parseInt(i.sValues[3]),parseInt(i.sValues[4]));break;case 14:if(1==Ih.gi().iCurrentMapId&&xh.me.rbs.iLev<10&&ht.gi().goods[1][2].iGid<=0){Z.fm.Open("郊外比较危险，先带上武器再去吧（打开背包穿戴装备）");break}a=parseInt(i.sValues[0]),n=parseInt(i.sValues[1]),Mh.gi().s_ChangeMapNew(a,n);break;case 15:0==(a=parseInt(i.sValues[0]))?Mh.gi().s_GetCodeReward(2,""):1==a?Fe.Open():2==a&&Mh.gi().s_GetCodeReward(4,"");break;case 16:Mh.gi().s_FuBen(parseInt(i.sValues[0]),parseInt(i.sValues[1]));break;case 20:Mh.gi().s_NpcCmd(i.sValues[0],i.sValues[1],i.sValues[2],i.sValues[3],i.sValues[4],i.sValues[5],i.sValues[6],i.sValues[7]);break;case 21:Mh.gi().s_ExtendCmd(i.sValues[0],i.sValues[1],i.sValues[2],i.sValues[3],i.sValues[4],i.sValues[5],i.sValues[6],i.sValues[7]);break;case Xe.NPCREPLY_ANSWER:case Xe.NPCREPLY_QIANGDAO:case Xe.NPCREPLY_SHANZEI:case 103:case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:if(null==Ye.talkingnpc)break;if(Ye.talkingnpc.bCurrentBlock)break;if(e=parseInt(i.sValues[0]),h=parseInt(i.sValues[1]),e!=Ye.talkingnpc.iNpcId)break;Mh.gi().s_NpcReply(e,Ye.talkingnpc.iSid,h);break;default:if(i.iEid>=100){if(null==Ye.talkingnpc)break;if(Ye.talkingnpc.bCurrentBlock)break;if(e=parseInt(i.sValues[0]),h=parseInt(i.sValues[1]),e!=Ye.talkingnpc.iNpcId)break;Mh.gi().s_NpcReply(e,Ye.talkingnpc.iSid,h)}}return!1}}Xe.NPCREPLY_ANSWER=100,Xe.NPCREPLY_QIANGDAO=101,Xe.NPCREPLY_SHANZEI=102;class Ye{constructor(i){var t;for(this.MAXVISUALBLOCK=128,this.vbs=new Array(this.MAXVISUALBLOCK),t=0;t<this.MAXVISUALBLOCK;t++)this.vbs[t]=null;this.mapdialog=new si(i,this),this.newdialog=new qs,this.procmap=new Xe,this.bNpcLoaded=!1,this.ani_npcs=new S(i),this.aa_flag1=null,this.aa_flag2=null,this.iLockNpcId=-1,this.iGoToNpcFlag=-1,this.iGoToNpcId=-1,Ye.pvb=this,this.bFaceToFace=!1}FindNpcByName(i){var t;for(t=0;t<this.MAXVISUALBLOCK;t++)if(null!=this.vbs[t]&&this.vbs[t].sNpcName.length>0&&this.vbs[t].sNpcName==i)return this.vbs[t];return null}ClearNpcFlag(){var i;for(i=0;i<this.MAXVISUALBLOCK;i++)null!=this.vbs[i]&&(this.vbs[i].iFlag=0)}SetNpcFlag(i,t){var s;for(s=0;s<this.MAXVISUALBLOCK;s++)if(null!=this.vbs[s]&&this.vbs[s].bCurrentBlock&&this.vbs[s].iNpcId==i)return void(this.vbs[s].iFlag=t)}LoadNpcs(i,t){this.ani_npcs.LoadAnima_fullpath(t,i,!0,this._LoadNpcs)}_LoadNpcs(){Ye.pvb.bNpcLoaded=!0}DrawPopo(i,t,s){if(!(i.iPopoDelay<=0)){i.iPopoDelay--,Y.gi().Format(i.sPopoString,151,25);var e=t+i.iX-Y.gi().iW/2,h=s+i.iY+i.aa_body.pani.iAnimaY(i.aa_body)-Y.gi().iH;M.gi().FillRect(s+i.iY,e,h,e+Y.gi().iW,h+Y.gi().iH,1342177280),Y.gi().DrawToBuffer(s+i.iY+1,e,h)}}DrawNpcInBuffer(i,t,s){var e,h;if(this.bNpcLoaded){for(null==this.aa_flag1&&(this.aa_flag1=gn.xani_ui.InitAnimaWithName("交任务感叹号",null)),null==this.aa_flag2&&(this.aa_flag2=gn.xani_ui.InitAnimaWithName("接任务问号",null)),e=0;e<this.MAXVISUALBLOCK;e++)if(null!=this.vbs[e]&&this.vbs[e].sNpcName.length>0){if(this.vbs[e].iDx==this.vbs[e].iX&&this.vbs[e].iDy==this.vbs[e].iY||((h=bn.llength(this.vbs[e].iX,this.vbs[e].iY,this.vbs[e].iDx,this.vbs[e].iDy))>8?(this.vbs[e].iX=8*(this.vbs[e].iDx-this.vbs[e].iX)/h+this.vbs[e].iX,this.vbs[e].iY=8*(this.vbs[e].iDy-this.vbs[e].iY)/h+this.vbs[e].iY):(this.vbs[e].iX=this.vbs[e].iDx,this.vbs[e].iY=this.vbs[e].iDy)),this.vbs[e].iX<0||this.vbs[e].iY<0)continue;if(this.DrawPopo(this.vbs[e],t,s),3==parseInt(this.vbs[e].iAnimaType/1e5)){i.DrawAnima_aa(s+this.vbs[e].iY-20,null,t+this.vbs[e].iX,s+this.vbs[e].iY-20,this.vbs[e].aa_body),i.DrawAnima_aa(s+this.vbs[e].iY,null,t+this.vbs[e].iX-40,s+this.vbs[e].iY,this.vbs[e].aa_body),i.DrawAnima_aa(s+this.vbs[e].iY,null,t+this.vbs[e].iX+40,s+this.vbs[e].iY,this.vbs[e].aa_body),i.DrawAnima_aa(s+this.vbs[e].iY+20,null,t+this.vbs[e].iX,s+this.vbs[e].iY+20,this.vbs[e].aa_body);continue}if(4==parseInt(this.vbs[e].iAnimaType/1e5)){i.DrawAnima_aa(s+this.vbs[e].iY,null,t+this.vbs[e].iX,s+this.vbs[e].iY,this.vbs[e].aa_body);continue}switch("传送点"!=this.vbs[e].sAniName&&G.DrawAura(0,t+this.vbs[e].iX,s+this.vbs[e].iY,i,s+this.vbs[e].iY-1),i.DrawAnima_aa(s+this.vbs[e].iY,this.ani_npcs,t+this.vbs[e].iX,s+this.vbs[e].iY,this.vbs[e].aa_body),1==parseInt(this.vbs[e].iAnimaType/1e5)&&this.vbs[e].iWeapId>0&&(i.DrawAnima_aa(s+this.vbs[e].iY+1,this.ani_npcs,t+this.vbs[e].iX,s+this.vbs[e].iY,this.vbs[e].aa_weapon),this.vbs[e].aa_weapon.NextFrame()),this.vbs[e].iDx!=this.vbs[e].iX||this.vbs[e].iDy!=this.vbs[e].iY?1==parseInt(this.vbs[e].iAnimaType/1e5)?1==this.vbs[e].iActionStat&&this.vbs[e].iFaceTo==this.vbs[e].GetFace8(this.vbs[e].iDx,this.vbs[e].iDy)||(this.vbs[e].iActionStat=1,this.vbs[e].iFaceTo=this.vbs[e].GetFace8(this.vbs[e].iDx,this.vbs[e].iDy),gn.xani_newrole[parseInt(this.vbs[e].iAnimaType/1e4)%10].InitAnimaWithName("跑步_"+this.vbs[e].FaceTo(this.vbs[e].iFaceTo),this.vbs[e].aa_body),this.vbs[e].iWeapId>0&&Qt.ResetWeapon(this.vbs[e].iWeapId,parseInt(this.vbs[e].iAnimaType/1e4)%10%2,this.vbs[e].sAniName,this.vbs[e].aa_weapon)):2==parseInt(this.vbs[e].iAnimaType/1e5)&&(1==this.vbs[e].iActionStat&&this.vbs[e].iFaceTo==this.vbs[e].GetFace4(this.vbs[e].iDx,this.vbs[e].iDy)||(this.vbs[e].iActionStat=1,this.vbs[e].iFaceTo=this.vbs[e].GetFace8(this.vbs[e].iDx,this.vbs[e].iDy),gn.xani_pets[this.vbs[e].iWeapId].InitAnimaWithName((parseInt(this.vbs[e].iAnimaType/1e4)%10==0?"":"变异_")+"跑步_"+this.vbs[e].FaceTo(this.vbs[e].iFaceTo),this.vbs[e].aa_body))):0!=this.vbs[e].iActionStat&&(this.vbs[e].iActionStat=0,1==parseInt(this.vbs[e].iAnimaType/1e5)?(gn.xani_newrole[parseInt(this.vbs[e].iAnimaType/1e4)%10].InitAnimaWithName("站立_"+this.vbs[e].FaceTo(this.vbs[e].iFaceTo),this.vbs[e].aa_body),this.vbs[e].iWeapId>0&&Qt.ResetWeapon(this.vbs[e].iWeapId,parseInt(this.vbs[e].iAnimaType/1e4)%10%2,this.vbs[e].sAniName,this.vbs[e].aa_weapon)):2==parseInt(this.vbs[e].iAnimaType/1e5)&&gn.xani_pets[this.vbs[e].iWeapId].InitAnimaWithName((parseInt(this.vbs[e].iAnimaType/1e4)%10==0?"":"变异_")+"站立_"+this.vbs[e].FaceTo(this.vbs[e].iFaceTo),this.vbs[e].aa_body)),i.DrawText_2(s+this.vbs[e].iY,1,t+this.vbs[e].iX,s+this.vbs[e].iY+20,this.vbs[e].sNpcName,4294967040,20,1,4278190080),this.vbs[e].aa_body.NextFrame(),this.vbs[e].iFlag){case 1:i.DrawAnima_aa(s+this.vbs[e].iY,gn.xani_ui,t+this.vbs[e].iX,s+this.vbs[e].iY-100,this.aa_flag1);break;case 2:i.DrawAnima_aa(s+this.vbs[e].iY,gn.xani_ui,t+this.vbs[e].iX,s+this.vbs[e].iY-100,this.aa_flag2)}}gn.xani_ui.NextFrame(this.aa_flag1),gn.xani_ui.NextFrame(this.aa_flag2)}}npctalk(i){var t=i.GetNextByte(),s=i.GetNextInt(),e=i.GetNextString();this._npctalk(t,s,e,200)}_npctalk(i,t,s,e){var h;for(h=0;h<this.MAXVISUALBLOCK;h++)if(null!=this.vbs[h])if(0==i){if(!this.vbs[h].bCurrentBlock)continue;if(this.vbs[h].iNpcId==t){this.vbs[h].sPopoString=s,this.vbs[h].iPopoDelay=e;break}}else if(1==i){if(this.vbs[h].bCurrentBlock)continue;if(this.vbs[h].iNpcId==t){this.vbs[h].sPopoString=s,this.vbs[h].iPopoDelay=200;break}}}npcmove(i){var t,s=i.GetNextByte(),e=i.GetNextInt();for(t=0;t<this.MAXVISUALBLOCK;t++)if(null!=this.vbs[t]&&1==s){if(this.vbs[t].bCurrentBlock)continue;if(this.vbs[t].iNpcId==e){this.vbs[t].iDx=i.GetNextInt(),this.vbs[t].iDy=i.GetNextInt();break}}}AddVoidNpc(){var i;for(i=0;i<this.MAXVISUALBLOCK&&null!=this.vbs[i];i++);return i>=this.MAXVISUALBLOCK?null:(this.vbs[i]=new at(i),this.vbs[i])}clearnpc(i){var t,s=i.GetNextInt();for(t=0;t<this.MAXVISUALBLOCK;t++)if(null!=this.vbs[t]&&!this.vbs[t].bCurrentBlock&&this.vbs[t].iNpcId==s){Ye.iLastProcBase==t&&(Ye.iLastProcBase=-1),this.vbs[t]=null;break}}getnpctalkext(i){var t,s,e,h=i.GetNextInt(),a=i.GetNextInt();for(t=0;t<this.MAXVISUALBLOCK&&(null==this.vbs[t]||this.vbs[t].bCurrentBlock||this.vbs[t].iNpcId!=h||this.vbs[t].iSid!=a);t++);if(t<this.MAXVISUALBLOCK)for(e=0;gn.sop("off="+i.iOffset),s=i.GetNextByte(),gn.sop(""+s),-1!=s;)this.vbs[t].pss[e]=this.LoadBase(s,i),e++;else;}getnpc(i){var t,s,e,h=i.GetNextInt(),a=i.GetNextInt();for(t=0;t<this.MAXVISUALBLOCK&&(null==this.vbs[t]||this.vbs[t].bCurrentBlock||this.vbs[t].iNpcId!=h||this.vbs[t].iSid!=a);t++);if(!(t<this.MAXVISUALBLOCK)){for(t=0;t<this.MAXVISUALBLOCK&&null!=this.vbs[t];t++);if(!(t>=this.MAXVISUALBLOCK)){var n=t;this.vbs[t]=new at(t),this.vbs[t].bCurrentBlock=!1,this.vbs[t].iNpcId=h,this.vbs[t].iSid=a,this.vbs[t].iX=i.GetNextInt(),this.vbs[t].iY=i.GetNextInt(),this.vbs[t].iDx=this.vbs[t].iX,this.vbs[t].iDy=this.vbs[t].iY,this.vbs[t].sNpcName=i.GetNextString(),this.vbs[t].iAnimaType=i.GetNextInt(),this.vbs[t].sAniName=i.GetNextString(),this.vbs[t].sBaseAniName=this.vbs[t].sAniName,this.vbs[t].iActionStat=0,this.vbs[t].iR=30,s=parseInt(this.vbs[t].iAnimaType/1e5),this.vbs[t].iStandFlag=-1,0==s?this.ani_npcs.InitAnimaWithName(this.vbs[t].sAniName,this.vbs[t].aa_body):1==s?(this.vbs[t].iWeapId=this.vbs[t].iAnimaType%1e4,e=parseInt(this.vbs[t].iAnimaType/1e4)%10,gn.xani_newrole[e].InitAnimaWithName(this.vbs[t].sAniName,this.vbs[t].aa_body),this.vbs[t].iWeapId>0&&Qt.ResetWeapon(this.vbs[t].iWeapId,e%2,this.vbs[t].sAniName,this.vbs[t].aa_weapon)):2==s?(this.vbs[t].iWeapId=this.vbs[t].iAnimaType%1e4,e=parseInt(this.vbs[t].iAnimaType/1e4)%10,gn.xani_pets[this.vbs[t].iWeapId].InitAnimaWithName((0==e?"":"变异_")+this.vbs[t].sAniName,this.vbs[t].aa_body)):3!=s&&4!=s||gn.xani_grow.InitAnimaWithName(this.vbs[t].sAniName,this.vbs[t].aa_body),this.vbs[t].pss[0]=new K;var o,r=this.vbs[t].pss[0];for(r.iType=4,r.iCount=i.GetNextShort(),r.sQuestion=i.GetNextString(),t=0;t<r.iCount;t++)r.sAnswers[t]=i.GetNextString(),r.next[t]=new js,(o=r.next[t]).iType=5,o.iEid=i.GetNextShort(),o.sValues[0]=""+i.GetNextInt(),o.sValues[1]=""+i.GetNextByte();1e5!=(s=i.GetNextInt())&&(t=n,e=i.GetNextInt(),gn.de_npc.intValue(e,0,7)==s&&(this.vbs[t].iStandFlag=s,this.vbs[t].sStandName=gn.de_npc.strValue(e,0,8),this.vbs[t].iFaceTo=i.GetNextByte(),this.vbs[t].ResetStandAnima(this.vbs[t].ToX(this.vbs[t].iFaceTo),this.vbs[t].ToY(this.vbs[t].iFaceTo))))}}}ClearVisual(){console.log("清除npc");for(var i=0;i<this.MAXVISUALBLOCK;i++)this.vbs[i]=null;Ye.iLastProcBase=-1,this.ClearNpcFlag(),Us.m.linktonpc()}LoadVisual(i){var t,s,e;for(t=0;t<this.MAXVISUALBLOCK&&null!=this.vbs[t];t++);for(this.iBoomX=0,this.iBoomY=0;-1!=(s=i.GetNextByte());){for(this.vbs[t]=new at(t),this.vbs[t].bCurrentBlock=!0,this.vbs[t].iX=i.GetNextInt(),this.vbs[t].iY=i.GetNextInt(),this.vbs[t].iDx=this.vbs[t].iX,this.vbs[t].iDy=this.vbs[t].iY,this.vbs[t].iR=i.GetNextByte(),i.GetNextInt(),this.vbs[t].iNpcId=i.GetNextInt(),this.vbs[t].sNpcName=i.GetNextString(),this.vbs[t].sAniName=i.GetNextString(),this.vbs[t].sBaseAniName=this.vbs[t].sAniName,this.vbs[t].iActionStat=0,this.ani_npcs.InitAnimaWithName(this.vbs[t].sAniName,this.vbs[t].aa_body),this.vbs[t].iStandFlag=gn.de_npc.intValue(this.vbs[t].iNpcId,0,7),this.vbs[t].iStandFlag>=0&&(this.vbs[t].sStandName=gn.de_npc.strValue(this.vbs[t].iNpcId,0,8),this.vbs[t].iFaceTo=gn.de_npc.intValue(this.vbs[t].iNpcId,0,11),this.vbs[t].ResetStandAnima(this.vbs[t].ToX(this.vbs[t].iFaceTo),this.vbs[t].ToY(this.vbs[t].iFaceTo))),0==this.iBoomX&&this.vbs[t].iX>0&&(this.iBoomX=this.vbs[t].iX,this.iBoomY=this.vbs[t].iY),e=0;-1!=(s=i.GetNextByte());)this.vbs[t].pss[e]=this.LoadBase(s,i),e++;t++}Ye.iLastProcBase=-1,this.ClearNpcFlag(),Us.m.linktonpc()}LoadBase(i,t){var s,e,h,a,n,o,r,c=null;switch(i){case 0:break;case 1:(h=new Js).sName=t.GetNextString(),-1!=(e=t.GetNextByte())&&(h.next=this.LoadBase(e,t)),c=h;break;case 2:for((a=new zs).iCount=t.GetNextByte(),s=0;-1!=(e=t.GetNextByte());)a.next[s]=this.LoadBase(e,t),s++;c=a;break;case 3:for((n=new Qs).iRid=t.GetNextShort(),s=0;s<Qs.MAXREQUIREMENTVALUE;s++)n.sValues[s]=t.GetNextString();-1!=(e=t.GetNextByte())&&(n.next=this.LoadBase(e,t)),c=n;break;case 4:for((o=new K).sHead=t.GetNextString(),o.iCount=t.GetNextShort(),o.sQuestion=t.GetNextString(),gn.sop(o.sHead+":"+o.sQuestion),s=0;s<K.MAXSELECTCOUNT;s++)o.sAnswers[s]=t.GetNextString();for(s=0;-1!=(e=t.GetNextByte());)o.next[s]=this.LoadBase(e,t),s++;c=o;break;case 5:for((r=new js).iEid=t.GetNextShort(),s=0;s<js.MAXEVENTVALUE;s++)r.sValues[s]=t.GetNextString();-1!=(e=t.GetNextByte())&&(r.next=this.LoadBase(e,t)),c=r}return c.iType=i,c}ProcBase(i){var t,s,e,h,a,n;if(null==i)return!1;switch(gn.sop("Checking"+i.iType),i.iType){case 1:if(null!=(s=i).next)return this.ProcBase(s.next);break;case 2:for(e=i,t=0;t<e.iCount;t++)if(null!=e.next[t]&&this.ProcBase(e.next[t]))return!0;break;case 3:return h=i,!(!this.procmap.RequirementCheck(h)||null==h.next)&&this.ProcBase(h.next);case 4:return a=i,Ye.iLastProcBase>=0&&Ye.iLastProcBase<this.MAXVISUALBLOCK&&null!=this.vbs[Ye.iLastProcBase]?this.mapdialog.InitDialog(a,this.vbs[Ye.iLastProcBase].sNpcName):this.mapdialog.InitDialog(a,""),xh.me.ChangeStat("站立"),Ks.sw.bLocked=!1,!0;case 5:return n=i,this.procmap.ProcEvent(n),null==n.next||this.ProcBase(n.next)}return!1}SetTalkingNpc(i){for(var t=0;t<this.MAXVISUALBLOCK;t++)if(null!=this.vbs[t]){if(this.vbs[t].bCurrentBlock)continue;if(this.vbs[t].iNpcId==i)return void(Ye.iLastProcBase=t)}}CheckNow(i,t){var s,e,h,a;if(-1!=Ye.iLastProcBase){if(a="传送点"==this.vbs[Ye.iLastProcBase].sAniName?30:60,Ye.bInCircle(i,t,this.vbs[Ye.iLastProcBase].iX,this.vbs[Ye.iLastProcBase].iY,a))return!0;Ye.iLastProcBase=-1,this.mapdialog.bDialoging=!1}for(s=0;s<this.MAXVISUALBLOCK;s++)if(null!=this.vbs[s]&&(a=this.vbs[s].bCurrentBlock||3!=parseInt(this.vbs[s].iAnimaType/1e5)&&4!=parseInt(this.vbs[s].iAnimaType/1e5)?"传送点"==this.vbs[s].sAniName?30:60:30,Ye.bInCircle(i,t,this.vbs[s].iX,this.vbs[s].iY,a))){if(Ye.iLastProcBase==s)continue;if(H.bInTeam()&&!H.bTeamLeader()&&!H.bAway())continue;if("传送点"!=this.vbs[s].sAniName){if(this.iGoToNpcFlag>=0&&this.iGoToNpcFlag!=s)continue;if(this.iGoToNpcId>=0&&this.iGoToNpcId!=this.vbs[s].iNpcId)continue}if(Ye.iLastProcBase=s,Ye.talkingnpc=this.vbs[s],gn.sop(this.vbs[s].sNpcName+"============"+this.vbs[s].iNpcId),this.vbs[s].sNpcName.length>0&&(this.vbs[s].iStandFlag>=0&&(this.bFaceToFace=!0,this.vbs[s].ResetStandAnima(i,t)),2==parseInt(this.vbs[s].iAnimaType/1e5)&&(h=parseInt(this.vbs[s].iAnimaType/1e4)%10,this.vbs[s].sAniName="站立_"+this.vbs[s].FaceTo(this.vbs[s].GetFace4(i,t)),gn.xani_pets[this.vbs[s].iWeapId].InitAnimaWithName((0==h?"":"变异_")+this.vbs[s].sAniName,this.vbs[s].aa_body),this.bFaceToFace=!0)),this.vbs[s].bCurrentBlock&&101==Ue.gi().iLogicStat&&Ue.gi().iLogic_npc1==this.vbs[s].iNpcId)continue;if(this.vbs[s].iNpcId>=0)this.newdialog.Open(this.vbs[s]);else for(e=0;e<at.MAXBASESEQUENCE;e++)if(null!=this.vbs[s].pss[e]&&this.ProcBase(this.vbs[s].pss[e]))return!0;return!0}return!1}bOnNpc(i,t){var s;for(s=0;s<this.MAXVISUALBLOCK;s++)if(null!=this.vbs[s]&&this.vbs[s].sNpcName.length>0&&this.vbs[s].aa_body.bIn(this.vbs[s].iX,this.vbs[s].iY,i,t))return!0;return!1}GoToNpc_byid(i){var t;for(t=0;t<this.MAXVISUALBLOCK;t++)if(null!=this.vbs[t]&&this.vbs[t].sNpcName.length>0&&this.vbs[t].iNpcId==i)return this.iNpcX=this.vbs[t].iX,this.iNpcY=this.vbs[t].iY,gn.sop("go to npc"),this.iGoToNpcFlag=this.vbs[t].iDownFlag,this.iLockNpcId=this.vbs[t].iNpcId,void(Ye.iLastProcBase==t&&(Ye.iLastProcBase=-1))}GoToNpc(i,t){var s;for(s=0;s<this.MAXVISUALBLOCK;s++)if(null!=this.vbs[s]&&this.vbs[s].sNpcName.length>0&&this.vbs[s].aa_body.bIn(this.vbs[s].iX,this.vbs[s].iY,i,t))return this.iNpcX=this.vbs[s].iX,this.iNpcY=this.vbs[s].iY,gn.sop("go to npc"),this.iGoToNpcFlag=this.vbs[s].iDownFlag,this.iLockNpcId=this.vbs[s].iNpcId,Ye.iLastProcBase==s&&(Ye.iLastProcBase=-1),!0;return!1}}Ye.talkingnpc=null,Ye.iLastProcBase=-1,Ye.pvb=null,Ye.bInCircle=function(i,t,s,e,h){return!((s-=i)*s+(e-=t)*e>h*h)};class We{constructor(){this.iStat=0}copyfrom(i){this.iStat=i.iStat,this.iX=i.iX,this.iY=i.iY,this.iDX=i.iDX,this.iDY=i.iDY,this.iGid=i.iGid,this.iTid=i.iTid}}class Le{constructor(){var i;for(this.glist=new Array(Le.MAXCOUNT),i=0;i<Le.MAXCOUNT;i++)this.glist[i]=new We;this.iListPoint=0,this.btn_use=new Eh(gn.xani_nui2),this.btn_use.InitButton("按钮1_110"),this.btn_use.sName="使用",this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.bTouch=!1,this.bShowDetail=!1}PushGoods(i){Ue.gi().iLogicStat>0||this.iListPoint>=Le.MAXCOUNT||(this.glist[this.iListPoint].iStat=1,this.glist[this.iListPoint].iGid=i.GetNextInt(),this.glist[this.iListPoint].iTid=i.GetNextShort(),this.iListPoint++,this.iX=h.SCRW-230-54,this.iY=h.SCRH-310-30,this.iW=188,this.iH=256,this.iGx=this.iX+54,this.iGy=this.iY+30)}RemoveGoods(i){for(;i<this.iListPoint-1;i++)this.glist[i].copyfrom(this.glist[i+1]);this.iListPoint--}CheckGoods(){var i,t;for(i=0;i<this.iListPoint;i++){for(t=0;t<20&&(ht.gi().goods[2][t].iGid<=0||ht.gi().goods[2][t].iGid!=this.glist[i].iGid);t++);t>=20&&this.RemoveGoods(i)}}FindGoods(i){var t;for(t=0;t<20;t++)if(!(ht.gi().goods[2][t].iGid<=0)&&ht.gi().goods[2][t].iGid==i)return ht.gi().goods[2][t];return null}Draw(){if(this.bTouch=!1,!(xh.me.rbs.iLev>30||ws.bFighting||Ih.gi().vbk.mapdialog.bHideUI()||xs.jq.bJQLock()||this.iListPoint<=0||(this.CheckGoods(),this.iListPoint<=0))){var i,t,s,e=0,a=0;for(i=0;i<this.iListPoint;i++)1==this.glist[i].iStat&&e++,2==this.glist[i].iStat&&a++;for(t=h.SCRW/2-100+50*e,s=h.SCRW/2-20+10*e,i=0;i<this.iListPoint;i++)switch(this.glist[i].iStat){case 1:this.glist[i].iStat=2,this.glist[i].iX=t+10,this.glist[i].iDX=s,this.glist[i].iY=h.SCRH/2-40,this.glist[i].iDY=this.glist[i].iY,this.glist[i].iDelay=10,t-=100,s-=20;break;case 2:this.glist[i].iDelay--,this.glist[i].iDelay<=0&&(a<=1?(this.glist[i].iDelay=10,this.glist[i].iStat=4,ln.gi().iXStat==ln.GS_GAMEING?(this.glist[i].iDX=h.SCRW-230,this.glist[i].iDY=h.SCRH-310,this.iMoveType=0):(this.glist[i].iDX=h.SCRW-100,this.glist[i].iDY=h.SCRH-100,this.iMoveType=1,this.fMoveScal=1)):(this.glist[i].iDelay=10,this.glist[i].iStat=3)),gn.xani_nui3.DrawAnima(this.glist[i].iX,this.glist[i].iY,"物品格子",0),gn.xani_ngoods.DrawAnima_aa(this.glist[i].iX,this.glist[i].iY,gn.de_goods.strValue(this.glist[i].iTid,0,10),0);break;case 3:this.glist[i].iDelay--,this.glist[i].iDelay<=0?(this.glist[i].iDelay=10,this.glist[i].iStat=4,ln.gi().iXStat==ln.GS_GAMEING?(this.glist[i].iDX=h.SCRW-230,this.glist[i].iDY=h.SCRH-310,this.iMoveType=0):(this.glist[i].iDX=h.SCRW-100,this.glist[i].iDY=h.SCRH-100,this.iMoveType=1,this.fMoveScal=1)):(this.glist[i].iX+=(this.glist[i].iDX-this.glist[i].iX)/this.glist[i].iDelay,this.glist[i].iY+=(this.glist[i].iDY-this.glist[i].iY)/this.glist[i].iDelay),gn.xani_nui3.DrawAnima(this.glist[i].iX,this.glist[i].iY,"物品格子",0),gn.xani_ngoods.DrawAnima_aa(this.glist[i].iX,this.glist[i].iY,gn.de_goods.strValue(this.glist[i].iTid,0,10),0);break;case 4:this.glist[i].iDelay--,this.glist[i].iDelay<=0?(this.glist[i].iStat=5,this.glist[i].iX=this.glist[i].iDX,this.glist[i].iY=this.glist[i].iDY):(this.glist[i].iX+=(this.glist[i].iDX-this.glist[i].iX)/this.glist[i].iDelay,this.glist[i].iY+=(this.glist[i].iDY-this.glist[i].iY)/this.glist[i].iDelay),0==this.iMoveType?(gn.xani_nui3.DrawAnima(this.glist[i].iX,this.glist[i].iY,"物品格子",0),gn.xani_ngoods.DrawAnima_aa(this.glist[i].iX,this.glist[i].iY,gn.de_goods.strValue(this.glist[i].iTid,0,10),0)):(gn.xani_nui3.DrawAnimaEx(this.glist[i].iX,this.glist[i].iY,"物品格子",0,101,this.fMoveScal,this.fMoveScal,0,0,0),gn.xani_ngoods.DrawAnimaEx(this.glist[i].iX,this.glist[i].iY,gn.de_goods.strValue(this.glist[i].iTid,0,10),0,101,this.fMoveScal,this.fMoveScal,0,0,0),this.fMoveScal*=.9,gn.sop("sdfsdf"));break;case 5:if(ln.gi().iXStat!=ln.GS_GAMEING)break;if(ws.bFighting)break;t=h.SCRW-230-54,s=h.SCRH-310-30,gn.xani_nui5.DrawAnima(t,s,"快捷使用物品大框",0),gn.xani_nui3.DrawAnima(t+54,s+30,"物品格子",0),gn.xani_ngoods.DrawAnima_aa(t+54,s+30,gn.de_goods.strValue(this.glist[i].iTid,0,10),0),c.gi().DrawTextEx(t+54+40,s+30+90,gn.de_goods.strValue(this.glist[i].iTid,0,4),4294967295,25,101,1,1,0,-2,0),this.btn_use.Move(t+94-55,s+30+90+50,110,52),this.btn_use.Draw(),this.btn_close.Move(t+188-35,s-25,60,60),this.btn_close.Draw(),this.bShowDetail&&i==this.iListPoint-1&&qi.new_DrawDetail(this.FindGoods(this.glist[i].iGid),this.iGx,this.iGy,0),this.bTouch=!0}}}ProcTouch(i,t,s){if(xh.me.rbs.iLev>30)return!1;if(ws.bFighting)return!1;if(Ih.gi().vbk.mapdialog.bHideUI()||xs.jq.bJQLock())return!1;if(!this.bTouch)return!1;if(this.btn_close.ProcTouch(i,t,s))return this.btn_close.bCheck()&&this.iListPoint>0&&this.iListPoint--,!0;if(this.iListPoint>0&&(this.bShowDetail=!1,1!=i&&2!=i||!bn.bInRect(t,s,this.iGx,this.iGy,80,80)||(this.bShowDetail=!0),this.btn_use.ProcTouch(i,t,s)&&this.btn_use.bCheck())){for(var e=0;e<20;e++)if(!(ht.gi().goods[2][e].iGid<=0)&&ht.gi().goods[2][e].iGid==this.glist[this.iListPoint-1].iGid){L.easymsg.snapatt(),this.UseGoods(ht.gi().goods[2][e]),L.easymsg.calcattchanged();break}this.iListPoint--}return!!bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)}MoveGoods(i,t){var s,e;if((1!=t.iOid||ht.bCheckEquipment(i,t.iPos))&&(1!=i.iOid||-1==t.iGid||ht.bCheckEquipment(t,i.iPos)))if(318!=i.iTid&&319!=i.iTid&&320!=i.iTid&&321!=i.iTid&&322!=i.iTid&&323!=i.iTid||2!=i.iOid||2==t.iOid){if(Mh.gi().s_MoveGoods(i.iGid,i.iOid,i.iPos,t.iGid,t.iOid,t.iPos),-1==t.iGid)t.copyfrom(i),i.iGid=-1;else if(s=gn.de_goods.intValue(i.iTid,0,28),i.iTid==t.iTid&&s>1)t.iCount>=s||(i.iCount+t.iCount<=s?(t.iCount+=i.iCount,i.iGid=-1):(e=i.iCount+t.iCount,t.iCount=s,i.iCount=e-s));else{var h=new Li;h.copyfrom(t),t.copyfrom(i),i.copyfrom(h)}1!=i.iOid&&1!=t.iOid||((1==i.iOid&&2==i.iPos||1==t.iOid&&2==t.iPos)&&(xh.me.bwc=!0),xh.me.CalcFightAtt())}else Z.fm.Open("礼包不能移动到行囊和仓库")}UseGoods(i){var t,s;if(null!=i&&2==i.iOid)if(-1==(s=gn.de_goods.intValue(i.iTid,-1,16))){if(-1!=(s=gn.de_goods.intValue(i.iTid,-1,27))){t=0;for(var e=1,h=gn.de_goods.intValue(i.iTid,0,1),a=gn.de_goods.intValue(i.iTid,0,2);(-1!=h&&xh.me.rbs.iHp<xh.me.rbs.iMaxHp||-1!=a&&xh.me.rbs.iMp<xh.me.rbs.iMaxMp)&&!(e<=0);)-1!=h&&(xh.me.rbs.iHp+=h),-1!=a&&(xh.me.rbs.iMp+=a),e--,t++;return 3==s&&(t=1),void(t<=0&&s<3?L.easymsg.AddMessage("您的状态很好，不需要恢复"):(Mh.gi().s_UseGoods(i.iGid,t,""),i.iCount-=t,i.iCount<=0&&(i.iGid=-1,i=null),xh.me.CalcFightAtt()))}if(-1==(s=gn.de_goods.intValue(i.iTid,-1,33)))if(-1==(s=gn.de_goods.intValue(i.iTid,-1,30)))if(-1==(s=gn.de_goods.intValue(i.iTid,-1,31))){if(-1!=(s=gn.de_goods.intValue(i.iTid,-1,34)))return 1!=s&&3!=s?void L.easymsg.AddMessage("不能直接使用"):void Mh.gi().s_UseGoods(i.iGid,1,"");L.easymsg.AddMessage("未知物品使用失败")}else L.easymsg.AddMessage("不能直接使用");else if(1==s)if(195==i.iTid||328==i.iTid||329==i.iTid||330==i.iTid||331==i.iTid)xh.me.rbs.iGovSkill[1]>0?Ts.Open(i,null):L.easymsg.AddMessage("还未学习炼丹术");else if(i.iTid>=342&&i.iTid<=346)xh.me.rbs.iGovSkill[1]>0?(ln.gi().PopStat(1),Ts.Open(null,i)):L.easymsg.AddMessage("还未学习炼丹术");else if(160==i.iTid||161==i.iTid){var n=et.Open();null!=n&&(n.iPage=1)}else 122==i.iTid?Fs.Open(i):(Mh.gi().s_UseGoods(i.iGid,1,""),119==i.iTid&&0!=i.iAtts[0]&&(Ih.gi().iMapChangeing=100));else L.easymsg.AddMessage("不能直接使用");else Mh.gi().s_UseGoods(i.iGid,1,"")}else this.MoveGoods(i,ht.gi().goods[1][s])}}Le.MAXCOUNT=32,Le.fg=null,Le.gi=function(){return null==Le.fg&&(Le.fg=new Le),Le.fg};class He{constructor(){var i;for(this.price=new Int32Array(20),this.goods=new Array(20),i=0;i<20;i++)this.goods[i]=new Li}Open(){ln.gi().iXStat!=ln.GS_SHOPFRAME&&ln.gi().PushStat(ln.GS_SHOPFRAME)}Draw(){console.log("商店")}ProcTouch(){return!1}FreshGoods(i){var t,s,e,h;for(s=0,this.iShopId=i.GetNextInt(),this.sShopName=i.GetNextString(),t=0;t<20;t++)this.goods[t].iGid=-1;for(;-1!=(t=i.GetNextInt());)this.goods[s].iGid=10,this.goods[s].iTid=t,this.goods[s].iCount=i.GetNextInt(),this.goods[s].iPos=s,this.price[s]=i.GetNextInt(),this.goods[s].iAtts[0]=i.GetNextInt(),gn.xani_ngoods.InitAnimaWithName(gn.de_goods.strValue(t,0,10),this.goods[s].aa),(e=gn.de_goods.intValue(t,0,16))>=0&&(e=gn.de_goods.intValue(t,0,9))>=0&&e<=100&&(h=100+5*e,this.goods[s].iAtts[5]=1e5*h+20*h),s++;this.iSGCount=s,this.iUseType=i.GetNextInt(),He._USETYPE=i.GetNextString(),this.iUseType>=0&&this.iUseType<=5&&this.Open()}}He._USETYPE,He.ns=new He;class Be extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=730,this.iH=405,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.lockgoods=null,this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_buy=new Eh(gn.xani_nui2),this.btn_buy.InitButton("按钮1_110"),this.btn_buy.sName="购买",this.btn_buy.Move(this.iX+this.iW-110-30,this.iY+this.iH-52-30,110,52),this.in_count=new vs(gn.xani_nui3),this.in_count.iNumber=1,this.cityshop=[3,1,4,2,5,9,6,10,7,11]}Draw(){E.new_bigframe(this.iX,this.iY,this.iW,this.iH),this.btn_close.Draw(),this.pm3f.DrawTextEx(this.iX+430+30+15,this.iY+35,He.ns.sShopName,4278206039,30,101,1,1,0,0,0),qi.new_DrawGoods(this.iX+30,this.iY+30,He.ns.goods,null,null),null!=this.lockgoods&&(qi.new_DrawRect(this.iX+30,this.iY+30,He.ns.goods,this.lockgoods,0),this.pm3f.DrawTextEx(this.iX+430+30+15,this.iY+90+0,"名称 "+gn.de_goods.strValue(this.lockgoods.iTid,0,4),4278206039,25,101,1,1,0,0,0),this.pm3f.DrawTextEx(this.iX+430+30+15,this.iY+90+30,"单价 "+He.ns.price[this.lockgoods.iPos]+He._USETYPE,4278206039,25,101,1,1,0,0,0),this.pm3f.DrawTextEx(this.iX+430+30+15,this.iY+80+90,"数量 ",4278206039,25,101,1,1,0,0,0),this.in_count.Move(this.iX+430+30+15+60,this.iY+80+90+12.5-26,100),this.in_count.Draw(),this.pm3f.DrawTextEx(this.iX+430+30+15,this.iY+70+150,"总价 "+He.ns.price[this.lockgoods.iPos]*this.in_count.iNumber+He._USETYPE,4278206039,25,101,1,1,0,0,0),0==He.ns.iUseType?(this.pm3f.DrawTextEx(this.iX+430+30+15,this.iY+70+180,"铜币 "+xh.me.rbs.iMoney,4278206039,25,101,1,1,0,0,0),xh.me.rbs.iLev<40&&this.bCityShop(He.ns.iShopId)&&this.pm3f.DrawTextEx(this.iX+430+30+15,this.iY+70+210,"储备 "+xh.me.rbs.iReserve,4278206039,25,101,1,1,0,0,0)):1==He.ns.iUseType?this.pm3f.DrawTextEx(this.iX+430+30+15,this.iY+70+180,"现有 "+xh.me.iFlag[48]/1e3+He._USETYPE,4278206039,25,101,1,1,0,0,0):2==He.ns.iUseType&&this.pm3f.DrawTextEx(this.iX+430+30+15,this.iY+70+180,"现有 "+xh.me.rbs.iInGot+He._USETYPE,4278206039,25,101,1,1,0,0,0)),this.btn_buy.Draw(),qi.bShowDetail()&&qi.new_DrawDetail(null,-1,-1,0)}bCityShop(i){for(var t=0;t<this.cityshop.length;t++)if(this.cityshop[t]==i)return!0;return!1}ProcTouch(i,t,s){if(null!=this.lockgoods){if(this.in_count.ProcTouch(i,t,s))return!0;if(this.btn_buy.ProcTouch(i,t,s)){if(this.btn_buy.bCheck())if(this.in_count.iNumber<=0)L.easymsg.AddMessage("购买数量不能为0");else if(this.in_count.iNumber>this.lockgoods.iCount)L.easymsg.AddMessage("购买数量超过上限");else if(0==He.ns.iUseType){var e=xh.me.rbs.iMoney;xh.me.rbs.iLev<40&&this.bCityShop(He.ns.iShopId)&&(e+=xh.me.rbs.iReserve),e<He.ns.price[this.lockgoods.iPos]*this.in_count.iNumber?L.easymsg.AddMessage("铜币不足"):Mh.gi().s_NpcShopBuy(He.ns.iShopId,this.lockgoods.iTid,this.in_count.iNumber)}else Mh.gi().s_NpcShopBuy(He.ns.iShopId,this.lockgoods.iTid,this.in_count.iNumber);return!0}}var h;return h=qi.new_LockGoods(t,s,this.iX+30,this.iY+30,He.ns.goods,i),qi.NoMove(),3==i&&null!=h?this._lockgoods(h):null==h&&(this.lockgoods=null),this.btn_close.ProcTouch(i,t,s)?(this.btn_close.bCheck()&&ln.gi().PopStat(1),!0):(3!=i||bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||ln.gi().PopStat(1),!1)}_lockgoods(i){i!=this.lockgoods&&(this.in_count.iNumber=1),this.lockgoods=i;var t=xh.me.rbs.iMoney/He.ns.price[this.lockgoods.iPos];t<1&&(t=1),t>this.lockgoods.iCount&&(t=this.lockgoods.iCount),this.in_count.MinMax(1,t)}}class Ve{constructor(){}Set(i,t,s,e,h){this.iType=i,this.iMapId=t,this.iGoid=s,this.iSx=e,this.iSy=h}}class Ue{constructor(){this.bFinding=!1,this.iMapPath=new Int32Array(16),this.bDown=!1,this.bByNpc=!1,this.bByDundi=!1,this.tmp_path=new Array(128),this.last_path=new Array(128),this.iDelay=0,this.iLogicStat=0,this.iLogic_npc1,this.iLogic_npc2,this.iLogic_shop1,this.iLogic_goods1,this.iLogic_count1,this.iLogic_map1,this.iLogic_px1,this.iLogic_px2,this.iLogic_py1,this.iLogic_py2,this.sm_doing}InitLink(){var i,t,s,e,h,a,n,o,r,c=0;for(this.iMapLink=new Array(64),i=0;i<64;i++)this.iMapLink[i]=new Array(32);for(this.iMapLinkCount=new Int32Array(64),this.iMapLinkSize=0,i=0;i<gn.de_chuan_song.iDataCount;i++){for(e=gn.de_chuan_song.datas[i].intValue(1),h=gn.de_chuan_song.datas[i].intValue(2),a=gn.de_chuan_song.datas[i].intValue(5),n=gn.de_chuan_song.datas[i].iDid,o=gn.de_chuan_song.datas[i].intValue(3),r=gn.de_chuan_song.datas[i].intValue(4),t=0;t<this.iMapLinkSize;t++)if(this.iMapLink[t][0].iMapId==h){this.iMapLink[t][this.iMapLinkCount[t]].Set(e,a,n,o,r),this.iMapLinkCount[t]++,this.iMapLinkCount[t]>c&&(c=this.iMapLinkCount[t]);break}if(t>=this.iMapLinkSize){for(s=0;s<32;s++)this.iMapLink[this.iMapLinkSize][s]=new Ve;this.iMapLink[this.iMapLinkSize][0].Set(2,h,-1,-1,-1),this.iMapLink[this.iMapLinkSize][1].Set(e,a,n,o,r),this.iMapLinkCount[this.iMapLinkSize]=2,this.iMapLinkSize++}}}FindNpc(i,t,s){var e=gn.de_npc.fdata(i);null!=e?(this.iDestMapId=e.intValue(4),this.iDestX=e.intValue(5),this.iDestY=e.intValue(6),this.iDestMapId<=0||this.iDestX<=0||this.iDestY<=0?L.easymsg.AddMessage("目标NPC不能寻路"):(this.bByNpc=t,this.bByDundi=s,gn.sop("start find npc = "+i),this._findway(i),Ye.iLastProcBase=-1)):L.easymsg.AddMessage("目标NPC不能寻路")}FindMap(i,t,s,e,h){return this.iDestMapId=i,this.iDestX=t,this.iDestY=s,this.bByNpc=e,this.bByDundi=h,this._findway(-1)}_findway(i){var t;for(t=0;t<this.iMapLinkSize&&this.iMapLink[t][0].iMapId!=Ih.gi().iCurrentMapId;t++);if(t>=this.iMapLinkSize)return L.easymsg.AddMessage("你当前所在地图不能寻路"),!1;if(Ih.gi().vbk.iGoToNpcFlag=-1,Ih.gi().iCurrentMapId==this.iDestMapId)return this.bFinding=!0,this.iFindStat=0,this.iFindPoint=0,this.last_path[0]=new Ve,this.last_path[0].Set(0,Ih.gi().iCurrentMapId,0,0,0),this.last_path[1]=new Ve,this.last_path[1].Set(0,this.iDestMapId,0,this.iDestX,this.iDestY),this.pathlength=2,Ih.gi().vbk.iGoToNpcId=i,!0;var s=this.iMapLinkCount[t];return this.bByDundi&&xh.me.rbs.iSchoolId>0&&H.bNoTeam()&&!ct.gi().bSelling&&(this.iMapLink[t][this.iMapLinkCount[t]].Set(2,e.iSchoolMapIds[xh.me.rbs.iSchoolId],0,0,0),this.iMapLinkCount[t]++),this.pathlength=999,this._dig(this.iMapLink[t][0],this.iDestMapId,0),this.pathlength<999?(this.bFinding=!0,this.iFindStat=0,this.iFindPoint=0,Ih.gi().vbk.iGoToNpcId=i,this.iMapLinkCount[t]=s,!0):(L.easymsg.AddMessage("目标地图不能寻路"),this.iMapLinkCount[t]=s,!1)}savepath(i){var t;if(i<this.pathlength){for(t=0;t<i;t++)this.last_path[t]=this.tmp_path[t];this.pathlength=i}}_dig(i,t,s){var e,h,a;if(!(s>=16))for(gn.sop("deep="+s),e=0;e<this.iMapLinkSize;e++)if(this.iMapLink[e][0].iMapId==i.iMapId)for(this.tmp_path[s]=i,h=this.iMapLinkCount[e]-1;h>=1;h--)if(0!=this.bByNpc||0==this.iMapLink[e][h].iType){if(this.iMapLink[e][h].iMapId==t)return this.tmp_path[s+1]=this.iMapLink[e][h],void this.savepath(s+2);for(a=0;a<s&&this.tmp_path[a]!=this.iMapLink[e][h];a++);a>=s&&s<this.pathlength-1&&this._dig(this.iMapLink[e][h],t,s+1)}}Draw(){if(this.bFinding)switch(this.iFindStat){case 3:bn.llength(xh.me.iX,xh.me.iY,this.iDestX,this.iDestY)<30?this.bFinding=!1:si.md.bDialoging?this.bFinding=!1:"跑步"!=xh.me.sStat&&this.dodelay()&&(this.iFindStat=0);break;case 0:Ih.gi().iCurrentMapId==this.iDestMapId?this.iDestX<0||this.iDestY<0?this.bFinding=!1:bn.llength(xh.me.iX,xh.me.iY,this.iDestX,this.iDestY)<30?this.bFinding=!1:si.md.bDialoging?this.bFinding=!1:this.to_pos(this.iDestX,this.iDestY)?this.iFindStat=3:this.bFinding=!1:Ih.gi().iCurrentMapId==this.last_path[this.iFindPoint].iMapId?this.iFindPoint++:(0==this.last_path[this.iFindPoint].iType&&(this.to_pos(this.last_path[this.iFindPoint].iSx,this.last_path[this.iFindPoint].iSy),this.iFindStat=1),1==this.last_path[this.iFindPoint].iType&&(this.to_pos(this.last_path[this.iFindPoint].iSx,this.last_path[this.iFindPoint].iSy),this.iFindStat=2),2==this.last_path[this.iFindPoint].iType&&(Mh.gi().s_UseSkill(0,0,0,0,0,0,0),Ih.gi().iMapChangeing=100,this.iFindStat=1),this.iDelay=0);break;case 1:Ih.gi().iCurrentMapId==this.last_path[this.iFindPoint].iMapId?this.dodelay()&&(this.iFindStat=0):"跑步"!=xh.me.sStat&&0==Ih.gi().iMapChangeing&&this.dodelay()&&(this.iFindStat=0);break;case 2:bn.llength(xh.me.iX,xh.me.iY,this.last_path[this.iFindPoint].iSx,this.last_path[this.iFindPoint].iSy)<30?this.dodelay()&&(Mh.gi().s_ChangeMapNew(2,this.last_path[this.iFindPoint].iGoid),this.iFindStat=1):"跑步"!=xh.me.sStat&&this.dodelay()&&(this.iFindStat=0)}}dodelay(){return this.iDelay++,this.iDelay>=10&&(this.iDelay=0,!0)}map_to_map(i,t){var s,e,h;for(s=0;s<gn.de_chuan_song.iDataCount;s++)if(0==gn.de_chuan_song.datas[s].intValue(1)&&gn.de_chuan_song.datas[s].intValue(2)==i&&gn.de_chuan_song.datas[s].intValue(5)==t){e=gn.de_chuan_song.datas[s].intValue(3),h=gn.de_chuan_song.datas[s].intValue(4),this.to_pos(e,h);break}return!(s>=gn.de_chuan_song.iDataCount)}to_pos(i,t){if(ct.gi().bSelling)L.easymsg.AddMessage("摆摊中不能行走");else if((H.bNoTeam()||H.bTeamLeader()||H.bAway())&&Ih.gi().mfy.findway(xh.me.iX,xh.me.iY,i,t)){if(gn.sop("check again start"),Ih.gi().mfy.checkagain())return xh.me.start(Ih.gi().mfy.iPath,Ih.gi().mfy.iPathDeep),!0;gn.sop("check again end2")}return!1}AILogic(){var i,t;switch(this.iLogicStat){case 0:break;case 100:if(50==this.sm_doing.iMPoint||52==this.sm_doing.iMPoint||54==this.sm_doing.iMPoint)for(i=0;i<this.sm_doing.iItemCount;i++)if(0==this.sm_doing.si[i].iMType&&(1==this.sm_doing.si[i].iSType||5==this.sm_doing.si[i].iSType))return this.FindNpc(this.sm_doing.si[i].iV1,!0,!0),void(this.iLogicStat=0);if(53==this.sm_doing.iMPoint)for(i=0;i<this.sm_doing.iItemCount;i++)if(0==this.sm_doing.si[i].iMType&&(1==this.sm_doing.si[i].iSType||4==this.sm_doing.si[i].iSType))return this.iLogic_map1=this.sm_doing.si[i].iV1,this.FindMap(this.sm_doing.si[i].iV1,-1,-1,!0,!0),this.iLogic_px1=-1,Mh.gi().s_SeverEvent(29,0,this.iLogic_map1,0,0),void(this.iLogicStat=110);if(10==this.sm_doing.iMPoint)for(i=0;i<this.sm_doing.iItemCount;i++)if(0==this.sm_doing.si[i].iMType&&0==this.sm_doing.si[i].iSType&&ht.bHaveGoods(this.sm_doing.si[i].iV1,this.sm_doing.si[i].iV2)){if(34==this.sm_doing.si[i].iV3)if(15==Ih.gi().iCurrentMapId){var s=Ye.pvb.FindNpcByName("程镖头");null!=s&&(this.FindMap(15,s.iX,s.iY,!0,!1),Ih.gi().vbk.iGoToNpcId=s.iNpcId),this.iLogicStat=0}else this.FindMap(15,-1,-1,!0,!1),Ih.gi().vbk.iGoToNpcId=34,this.iLogic_map1=15,this.iLogicStat=114;else this.FindNpc(this.sm_doing.si[i].iV3,!0,!1),this.iLogic_npc2=this.sm_doing.si[i].iV3,Le.gi().iListPoint=0,this.iLogicStat=0;return}if(51==this.sm_doing.iMPoint)for(i=0;i<this.sm_doing.iItemCount;i++)if(0==this.sm_doing.si[i].iMType&&0==this.sm_doing.si[i].iSType)return void(ht.bHaveGoods(this.sm_doing.si[i].iV1,this.sm_doing.si[i].iV2)?(gn.sop("上交物品"),this.FindNpc(this.sm_doing.si[i].iV3,!0,!0),this.iLogic_npc2=this.sm_doing.si[i].iV3,Le.gi().iListPoint=0,this.iLogicStat=0):(this.iLogic_goods1=this.sm_doing.si[i].iV1,this.iLogic_count1=this.sm_doing.si[i].iV2,-1==(t=this.getnpcbygoods(this.sm_doing.si[i].iV1))?L.easymsg.AddMessage("所需物品来源未知"):(this.iLogic_npc1=Ue.npc_shop_goods[t][0],this.iLogic_shop1=Ue.npc_shop_goods[t][1],this.FindNpc(this.iLogic_npc1,!0,!0),this.iLogicStat=101,Ye.talkingnpc=null)));break;case 101:"站立"==xh.me.sStat&&null!=Ye.talkingnpc&&Ye.talkingnpc.bCurrentBlock&&Ye.talkingnpc.iNpcId==this.iLogic_npc1&&(Mh.gi().s_NpcShop(this.iLogic_shop1),this.iLogicStat=102);break;case 102:if(ln.gi().CheckStat(ln.GS_SHOPFRAME)){var e=ln.gi().LastStat(0);for(i=0;i<20;i++)if(He.ns.goods[i].iGid>0&&He.ns.goods[i].iTid==this.iLogic_goods1)return e._lockgoods(He.ns.goods[i]),qi.new_LockPos(e.iX+30,e.iY+30,He.ns.goods,He.ns.goods[i]),void(this.iLogicStat=103)}break;case 103:ht.bHaveGoods(this.iLogic_goods1,this.iLogic_count1)&&(si.md.bDialoging=!1,ln.gi().CheckStat(ln.GS_SHOPFRAME)&&ln.gi().PopStat(1),this.iLogicStat=100);break;case 110:Ih.gi().iCurrentMapId==this.iLogic_map1&&(this.iLogicStat=111);break;case 111:this.iLogic_px1>0&&(this.to_pos(this.iLogic_px2,this.iLogic_py2),this.iLogicStat=112);break;case 112:bn.llength(xh.me.iX,xh.me.iY,this.iLogic_px2,this.iLogic_py2)<50&&(this.to_pos(this.iLogic_px1,this.iLogic_py1),this.iLogicStat=113),!ws.bFighting&&this.bFinding||(this.iLogicStat=0);break;case 113:bn.llength(xh.me.iX,xh.me.iY,this.iLogic_px1,this.iLogic_py1)<50&&(this.to_pos(this.iLogic_px2,this.iLogic_py2),this.iLogicStat=112),!ws.bFighting&&this.bFinding||(this.iLogicStat=0);break;case 114:Ih.gi().iCurrentMapId==this.iLogic_map1&&(this.iLogicStat=100);break;case 200:if(56!=this.nm_doing.iMPoint&&59!=this.nm_doing.iMPoint||(this.iLogic_map1=4,this.FindMap(4,-1,-1,!0,!0),this.iLogic_px1=-1,Mh.gi().s_SeverEvent(29,0,this.iLogic_map1,0,0),this.iLogicStat=110),139==this.nm_doing.iMPoint||140==this.nm_doing.iMPoint){for(this.iLogicStat=0,i=1;i<10;i++)if(Ih.gi().iCurrentMapId==Ue._MENPAIMAP[i])return void this.FindNpc(Ue._TEACHERID[i],!1,!0);Z.fm.Open("寻找门派师傅对话")}141!=this.nm_doing.iMPoint&&144!=this.nm_doing.iMPoint||(this.iLogicStat=0,this.FindNpc(Ue._TEACHERID[xh.me.rbs.iSchoolId],!0,!0))}}getlogicpath(i){var t=i.GetNextInt();this.iLogic_px1=t/1e4,this.iLogic_py1=t%1e4,t=i.GetNextInt(),this.iLogic_px2=t/1e4,this.iLogic_py2=t%1e4}getnpcbygoods(i){var t,s;for(t=0;t<Ue.npc_shop_goods.length;t++)for(s=2;s<Ue.npc_shop_goods[t].length;s++)if(Ue.npc_shop_goods[t][s]==i)return t;return-1}AutoSpecialMission(i){this.sm_doing=i,this.iLogicStat=100}AutoNormalMission(i){this.nm_doing=i,this.iLogicStat=200}ProcTouch(i,t,s){return!1}}Ue.iX,Ue.iY,Ue.iW,Ue.iH,Ue._TEACHERID=[0,5,6,7,21,22,23,24,25,26],Ue._MENPAIMAP=[0,5,6,7,10,8,9,11,12,13],Ue.npc_shop_goods=[[27,4,66,67,69,70,73,74],[28,2,47,53,59,11,19,25,31,37,13],[3,3,65,66,68,69,71,72],[2,1,1,3,4,5,6,7,8,9,10],[41,5,78,81,83,67,71,75],[93,9,14,12,20,48,54,60,26,32,38],[42,6,79,80,82,72,73,76],[94,10,15,43,21,49,55,61,27,33,39],[43,7,82,83,84,77,80,81],[95,11,16,44,22,50,56,62,28,34,40]],Ue.ma=null,Ue.gi=function(){return null==Ue.ma&&(Ue.ma=new Ue),Ue.ma};class ze extends s{constructor(i){super(),this.xm3f=c.xm3f,this.iW=700,this.iH=320,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.sAnswer=new Array(6),this.iCs=new Int32Array(6),this.btn_ans=new Array(6);for(var t=0;t<6;t++)this.btn_ans[t]=new D(gn.xani_button),this.btn_ans[t].InitButton("普通按钮200_55"),this.btn_ans[t].Move(this.iX+this.iW-30-200,this.iY+30+65*t,200,55)}InitDialog(i){var t;for(this.iMType=i.GetNextByte(),this.iSType=i.GetNextByte(),this.sQuestion=i.GetNextString(),this.iCount=i.GetNextByte(),t=0;t<this.iCount;t++)this.sAnswer[t]=i.GetNextString(),this.iCs[t]=i.GetNextInt(),this.btn_ans[t].sName=this.sAnswer[t]}Draw(){var i;for(E.frame_type4("中等框a52_50",this.iX,this.iY,this.iW,this.iH,52,50),E.frame_type4("单色内框a20_20",this.iX+30,this.iY+30,430,this.iH-60,20,20),Y.gi().FormatEx(this.sQuestion,400,25,0,0,35),Y.gi().Draw(this.iX+30+15,this.iY+30+15),i=0;i<this.iCount;i++)this.btn_ans[i].Draw()}ProcTouch(i,t,s){if(ze.bInRect(t,s,this.iX,this.iY,this.iW,this.iH))for(var e=0;e<this.iCount;e++)this.btn_ans[e].ProcTouch(i,t,s)&&this.btn_ans[e].bCheck()&&(Mh.gi().s_SeverSelect(this.iMType,this.iSType,this.iCs[e]),ln.gi().PopStat(1));else 3==i&&ln.gi().PopStat(1);return!0}}ze.Open=function(i){var t=ln.gi().FindStat(ln.GS_MYSELECT);null==t&&(t=ln.gi().PushStat(ln.GS_MYSELECT)),t.InitDialog(i)},ze.bInRect=function(i,t,s,e,h,a){return!(i<=s)&&(!(t<=e)&&(!(i>=s+h)&&!(t>=e+a)))};class je{constructor(){this.bInited=!1,this.bShow=!1,this.btn_charge=null,this.bShowEffect=!0,this.bShowFrame=!1,this.iW=742,this.iH=486,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2}SetStatByFlag(){this.bShow=!1,xh.me.iFlag[59]/1e8==0&&(this.bShow=!0,this.iChargeProc=xh.me.iFlag[59]%1e8,this.iChargeProc/=10,this.iChargeProc>60&&(this.iChargeProc=60))}Draw(){if(!Ih.gi().vbk.mapdialog.bHideUI()&&!xs.jq.bJQLock()&&this.bShow&&!(xh.me.rbs.iLev<20)){var i,t,s=rh.iTopIconOffX;if(null==this.btn_charge){for(this.btn_charge=new Eh(gn.xani_nui2),this.btn_charge.InitButton("礼包按钮"),this.btn_charge.sName="充  值",this.btn_open=new Eh(gn.xani_icon),this.btn_open.InitButton("首充图标"),this.gs=new Array(2),this.btn_gs=new Array(2),i=0;i<2;i++)for(this.gs[i]=new Array(4),this.btn_gs[i]=new Array(4),t=0;t<4;t++)this.gs[i][t]=new Li,this.btn_gs[i][t]=new D(gn.xani_nui3),this.btn_gs[i][t].bSingleButton=!0;this.gs[0][0].SetAtt(0,116,1,0,0,0,0,0,0,0,1),this.gs[0][1].SetAtt(0,117,1,0,0,0,0,0,0,0,1),this.gs[0][2].SetAtt(0,118,1,0,0,0,0,0,0,0,1),this.gs[0][3].SetAtt(0,236,1,0,0,0,0,0,0,0,1),this.gs[1][0].SetAtt(0,208,1,0,0,0,0,0,0,0,1),this.gs[1][1].SetAtt(0,119,1,0,0,0,0,0,0,0,1),this.gs[1][2].SetAtt(0,240,1,1e5,0,0,0,0,0,0,1),this.aa_effect=gn.xani_nui6.InitAnimaWithName("转圈效果",null),this.bInited=!0}if(this.btn_open.Move(s,10,72,72),this.btn_open.Draw(),c.gi().DrawText_2(this.btn_open.iX+36,this.btn_open.iY+71,"首充礼包",4294833640,22,101,1,1,0,-2,-3,3,4279894016),this.bShowEffect&&gn.xani_icon.DrawAnima(s+48,2,"红点提示",0),this.bShowFrame){this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2;var e=-1,a=-1;for(gn.xani_nui6.DrawAnima(this.iX,this.iY,"首充背景框",0),gn.xani_nui6.DrawAnima(this.iX,this.iY,"首充背景框",1),gn.xani_nui6.DrawAnima(this.iX,this.iY,"首充背景框",2),gn.xani_nui2.DrawAnima(this.iX+this.iW-12,this.iY+12,"梅竹",0),gn.xani_nui2.DrawAnima(this.iX+12,this.iY+this.iH-12,"梅竹",1),gn.xani_nui6.DrawAnima(this.iX,this.iY,"首充背景框",3),i=0;i<2;i++)for(t=0;t<4;t++)this.btn_gs[i][t].Move(this.iX+361+85*t,this.iY+203+85*i,75,76),1!=i||3!=t?(this.gs[i][t].aa.Draw(this.iX+361+85*t,this.iY+203+85*i),this.btn_gs[i][t].bMouseDown&&(e=i,a=t)):gn.xani_head.DrawAnimaEx(this.iX+361+85*t+5,this.iY+203+85*i+5,"花魅",0,101,.9,.9,0,0,0);for(c.gi().DrawText_2(this.iX+366,this.iY+75,"豪华大礼包，升级助力，极品宝宝",4294967295,20,101,1,1,0,0,0,4,4285739818),c.gi().DrawText_2(this.iX+386,this.iY+115,"坠入凡间的花魅，伴您纵情仙侠。",4294967295,20,101,1,1,0,0,0,4,4285739818),c.gi().DrawTextEx(this.iX+83-8,this.iY+402-6,""+this.iChargeProc,4278190080,16,101,.8,1,0,-2,-2),c.gi().DrawTextEx(this.iX+83,this.iY+402,"/",4278190080,26,101,1,1,0,-2,-2),c.gi().DrawTextEx(this.iX+83+8,this.iY+402+6,"60",4278190080,16,101,.8,1,0,-2,-2),i=0;i<this.iChargeProc/10;i++)gn.xani_nui6.DrawAnima(this.iX,this.iY,"首充进度条",i);gn.xani_nui1.DrawAnimaEx(this.iX+210,this.iY+395,"选中角色底",gn.iDelay,101,.6,.6,0,0,0),gn.xani_pets[11].DrawAnimaEx(this.iX+210,this.iY+395-10,"变异_站立_右下",gn.iDelay/3,101,1.3,1.3,0,0,0),this.iChargeProc<60?this.btn_charge.sName="立即充值":this.btn_charge.sName="领  取",this.btn_charge.Move(this.iX+460,this.iY+385,134,44),this.btn_charge.Draw(),e>=0&&this.gs[e][a].iGid>=0&&qi.new_DrawDetail(this.gs[e][a],this.btn_gs[e][a].iX,this.btn_gs[e][a].iY,0)}rh.iTopIconOffX+=90}}ProcTouch(i,t,s){if(Ih.gi().vbk.mapdialog.bHideUI()||xs.jq.bJQLock())return!1;if(!this.bShow)return!1;if(xh.me.rbs.iLev<20)return!1;if(!this.bInited)return!1;if(this.btn_open.ProcTouch(i,t,s))return this.btn_open.bCheck()&&(this.bShowEffect=!1,this.bShowFrame=!0),!0;if(this.bShowFrame){var e,h;if(this.btn_charge.ProcTouch(i,t,s))return this.btn_charge.bCheck()&&(this.iChargeProc<60?(Mh.gi().s_IngotMall(0,0),ys.iLastSelect=1):Mh.gi().s_SeverEvent(28,0,0,0,0),this.bShowFrame=!1),!0;for(e=0;e<2;e++)for(h=0;h<4;h++)this.btn_gs[e][h].ProcTouch(i,t,s);if(bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||3!=i)return!0;this.bShowFrame=!1}return!1}}je.fg=new je;class Je{constructor(){this.sGetDetail=["今日可领","明日可领","两天后领","三天后领","四天后领"],this.bInited=!1,this.bShow=!1,this.btn_open=null,this.bShowEffect=!1,this.bShowFrame=!1,this.iW=905,this.iH=585}SetStatByFlag(){if(this.bShow=!1,(31&xh.me.iFlag[36])<=0){var i=xh.me.iFlag[36]>>5;i<31&&(0==(2048&xh.me.iFlag[24])&&(this.bShowEffect=!0),this.bShow=!0,this.iGetStat=i)}}Draw(){if(!Ih.gi().vbk.mapdialog.bHideUI()&&!xs.jq.bJQLock()&&this.bShow){var i,t,s,e,a=rh.iTopIconOffX;if(null==this.btn_open){for(this.btn_open=new Eh(gn.xani_icon),this.btn_open.InitButton("五日礼包"),this.btn_get=new Eh(gn.xani_nui6),this.btn_get.InitButton("领取按钮"),this.btn_get.sName="今日可领",this.btn_get.iNameSize=20,this.gs=new Array(5),this.btn_gs=new Array(5),t=0;t<5;t++)for(this.gs[t]=new Array(3),this.btn_gs[t]=new Array(3),s=0;s<3;s++)this.gs[t][s]=new Li,this.btn_gs[t][s]=new D(gn.xani_nui3),this.btn_gs[t][s].bSingleButton=!0;this.gs[0][0].SetAtt(0,88,1,0,0,0,0,0,0,0,1),this.gs[0][1].SetAtt(0,21,1,13,20051005,0,2e4,0,Li.GetSetNJ(30),0,1),this.gs[0][2].SetAtt(0,240,1,1e4,0,0,0,0,0,0,1),0==xh.me.iRace?this.gs[1][0].SetAtt(0,49,1,46,20054005,0,2e4,0,Li.GetSetNJ(30),0,1):1==xh.me.iRace?this.gs[1][0].SetAtt(0,55,1,46,20054005,0,2e4,0,Li.GetSetNJ(30),0,1):this.gs[1][0].SetAtt(0,61,1,46,20054005,0,2e4,0,Li.GetSetNJ(30),0,1),this.gs[1][1].SetAtt(0,237,1,0,0,0,0,0,0,0,1),this.gs[1][2].SetAtt(0,240,1,5e4,0,0,0,0,0,0,1),this.gs[2][0].SetAtt(0,15,1,60004,30051005,0,2e4,0,Li.GetSetNJ(30),0,1),this.gs[2][1].SetAtt(0,118,1,0,0,0,0,0,0,0,1),this.gs[2][2].SetAtt(0,240,1,1e5,0,0,0,0,0,0,1),this.gs[3][0].SetAtt(0,208,1,0,0,0,0,0,0,0,1),this.gs[3][1].SetAtt(0,106,1,0,0,0,0,0,0,0,1),this.gs[3][2].SetAtt(0,122,1,0,0,0,0,0,0,0,1),0==xh.me.iRace?this.gs[4][0].SetAtt(0,50,1,46,20064006,0,3e4,0,Li.GetSetNJ(40),0,1):1==xh.me.iRace?this.gs[4][0].SetAtt(0,56,1,46,20064006,0,3e4,0,Li.GetSetNJ(40),0,1):this.gs[4][0].SetAtt(0,62,1,46,20064006,0,3e4,0,Li.GetSetNJ(40),0,1),this.gs[4][1].SetAtt(0,312,1,0,0,0,0,0,0,0,1),this.gs[4][2].SetAtt(0,240,1,2e5,0,0,0,0,0,0,1),this.aa_effect=gn.xani_nui6.InitAnimaWithName("转圈效果",null),this.bInited=!0,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2}if(this.btn_open.Move(a,10,72,72),this.btn_open.Draw(),c.gi().DrawText_2(this.btn_open.iX+36,this.btn_open.iY+71,"五日礼包",4294833640,22,101,1,1,0,-2,-3,3,4279894016),this.bShowEffect&&gn.xani_icon.DrawAnima(a+48,2,"红点提示",0),this.bShowFrame){for(gn.xani_nui6.DrawAnima(this.iX,this.iY,"五日礼包背景框",0),gn.xani_nui6.DrawAnima(this.iX,this.iY,"五日礼包背景框",1),gn.xani_nui6.DrawAnima(this.iX,this.iY,"五日礼包背景框",2),gn.xani_nui2.DrawAnima(this.iX+this.iW-12,this.iY+12,"梅竹",0),gn.xani_nui2.DrawAnima(this.iX+12,this.iY+this.iH-12,"梅竹",1),gn.xani_nui6.DrawAnima(this.iX,this.iY,"五日礼包背景框",3),a=280,i=97,Y.gi().FormatEx("# 储备物资，临时提升，享仙侠之游！",200,18,4,4279717474,25),Y.gi().Draw(this.iX+a,this.iY+i),Y.gi().FormatEx("# 高阶武器，贵宾身份，让你畅行三界！",200,18,4,4279717474,25),Y.gi().Draw(this.iX+a,this.iY+i+97),Y.gi().FormatEx("# 双倍经验，光速升级，通往强者之路！",200,18,4,4279717474,25),Y.gi().Draw(this.iX+a,this.iY+i+194),Y.gi().FormatEx("# 替身木偶，悍不畏死，为你阻灾挡祸！",200,18,4,4279717474,25),Y.gi().Draw(this.iX+a,this.iY+i+291),Y.gi().FormatEx("# 绝世神兵，稀有彩果，助你叱咤风云！",200,18,4,4279717474,25),Y.gi().Draw(this.iX+a,this.iY+i+388),a=this.iX+490,i=this.iY+87,e=0,this.iLockX=-1,this.iLockY=-1,t=0;t<5;t++){for(s=0;s<3;s++)1==s||4==t&&0==s?gn.xani_nui6.DrawAnima(a+87*s,i+97*t,"主打物品框",0):gn.xani_nui3.DrawAnima(a+87*s,i+97*t,"物品格子",0),this.gs[t][s].iGid>=0&&(this.gs[t][s].aa.Draw(a+87*s,i+97*t),this.btn_gs[t][s].Move(a+87*s,i+97*t,80,80),this.btn_gs[t][s].bMouseDown&&(this.iLockX=t,this.iLockY=s));0==e?0==(this.iGetStat&1<<t)?(e=1,0==(2048&xh.me.iFlag[24])?(this.btn_get.Move(a+272,i+97*t+15,104,48),this.btn_get.Draw()):c.gi().DrawTextEx(a+270,i+97*t+40,this.sGetDetail[e++],4278190080,28,101,1,1,0,0,-2)):gn.xani_nui6.DrawAnima(a+272,i+97*t+12,"已领取",0):c.gi().DrawTextEx(a+270,i+97*t+40,this.sGetDetail[e++],4278190080,28,101,1,1,0,0,-2)}this.iLockX>=0&&this.gs[this.iLockX][this.iLockY].iGid>=0&&qi.new_DrawDetail(this.gs[this.iLockX][this.iLockY],this.btn_gs[this.iLockX][this.iLockY].iX,this.btn_gs[this.iLockX][this.iLockY].iY,0)}rh.iTopIconOffX+=90}}ProcTouch(i,t,s){if(Ih.gi().vbk.mapdialog.bHideUI()||xs.jq.bJQLock())return!1;if(!this.bShow)return!1;if(!this.bInited)return!1;if(this.btn_open.ProcTouch(i,t,s))return this.btn_open.bCheck()&&(this.bShowEffect=!1,this.bShowFrame=!0),!0;if(this.bShowFrame){var e,h;if(0==(2048&xh.me.iFlag[24])&&this.btn_get.ProcTouch(i,t,s))return this.btn_get.bCheck()&&(Mh.gi().s_SeverEvent(14,0,0,0,0),this.bShowFrame=!1),!0;for(e=0;e<5;e++)for(h=0;h<3;h++)this.btn_gs[e][h].ProcTouch(i,t,s);if(bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||3!=i)return!0;this.bShowFrame=!1}return!1}}Je.fg=new Je;class Qe{constructor(){this.btn_open=null}Draw(){var i=rh.iTopIconOffX;rh.iTopIconOffX+=90,null==this.btn_open&&(this.btn_open=new Eh(gn.xani_icon),this.btn_open.InitButton("排行榜")),this.btn_open.Move(i,10,72,72),this.btn_open.Draw(),c.gi().DrawText_2(this.btn_open.iX+36,this.btn_open.iY+71,"排行榜",4294833640,22,101,1,1,0,-2,-3,3,4279894016)}ProcTouch(i,t,s){return!!this.btn_open.ProcTouch(i,t,s)&&(this.btn_open.bCheck()&&(xh.me.CalcUserScore(),ln.gi().PushStat(ln.GS_LEADERBOARDFRAME)),!0)}}Qe.lb=new Qe;class qe{constructor(){this.bInited=!1,this.btn_gift2=null,this.btn_get=null,this.bShow=!1,this.iDelay=0}DrawGift2(){var i,t;if(0==(8&xh.me.iFlag[24]))i=500*xh.me.rbs.iLev+100;else if(0==(16&xh.me.iFlag[24]))i=100*xh.me.rbs.iLev+100;else if(0==(32&xh.me.iFlag[24]))i=200*xh.me.rbs.iLev+100;else if(0==(64&xh.me.iFlag[24]))i=300*xh.me.rbs.iLev+100;else{if(0!=(128&xh.me.iFlag[24]))return void(this.bGet2=!1);i=400*xh.me.rbs.iLev+100}t=3*i,this.iW=280,this.iH=240,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,E.new_framewatch(this.iX,this.iY,this.iW,this.iH),gn.xani_nui3.DrawAnima(this.iX+40,this.iY+30,"物品格子",0),gn.xani_ngoods.DrawAnima(this.iX+40,this.iY+30,"物品经验",0),c.gi().DrawText_2(this.iX+40+40,this.iY+30+80+5,""+t,4294967040,20,101,1,1,0,-2,0,1,4278190080),gn.xani_nui3.DrawAnima(this.iX+40+80+40,this.iY+30,"物品格子",0),gn.xani_ngoods.DrawAnima(this.iX+40+80+40,this.iY+30,"物品储备金",0),c.gi().DrawText_2(this.iX+40+80+40+40,this.iY+30+80+5,""+i,4294967040,20,101,1,1,0,-2,0,1,4278190080),this.btn_get.Move(this.iX+this.iW/2-49,this.iY+this.iH-50-30,98,50),this.btn_get.Draw()}SetStatByFlag(){this.bGift2=!1,this.bGet2=!1,0!=(8&xh.me.iFlag[24])&&0!=(16&xh.me.iFlag[24])&&0!=(32&xh.me.iFlag[24])&&0!=(64&xh.me.iFlag[24])&&0!=(128&xh.me.iFlag[24])||(this.bGift2=!0),this.bShow=!0}Draw(){var i;xh.me.rbs.iLev<10||(Ih.gi().vbk.mapdialog.bHideUI()||xs.jq.bJQLock()||this.bShow&&(this.iDelay++,null==this.btn_gift2&&(this.btn_gift2=new Eh(gn.xani_icon),this.btn_gift2.InitButton("登录礼包"),this.aa_effect=gn.xani_nui6.InitAnimaWithName("转圈效果",null),this.btn_get=new Wi(gn.xani_nui3),this.btn_get.InitButton("内框按钮"),this.btn_get.sName="领取",this.bInited=!0),this.iY=10,this.iW=72,this.iH=72,this.iX=rh.iTopIconOffX,this.bGift2&&xh.me.rbs.iLev>=10&&(rh.iTopIconOffX+=90,this.btn_gift2.Move(this.iX,this.iY,this.iW,this.iH),this.btn_gift2.Draw(),xh.me.iFlag[37]<=0&&gn.xani_icon.DrawAnima(this.iX+48,2,"红点提示",0),xh.me.iFlag[37]>0?(i=bn.get_ms()/1e3,i-=xh.me.lt1,(i=xh.me.iFlag[37]-i)<0?xh.me.iFlag[37]=0:qe.DrawTime(this.iX+36,this.iY+71,i)):c.gi().DrawText_2(this.btn_gift2.iX+36,this.btn_gift2.iY+71,"领取",4294833640,22,101,1,1,0,-2,-3,3,4279894016)),this.bGet2&&this.DrawGift2()))}ProcTouch(i,t,s){return!(xh.me.rbs.iLev<10)&&(!Ih.gi().vbk.mapdialog.bHideUI()&&!xs.jq.bJQLock()&&(!!this.bShow&&(!!this.bInited&&(this.bGet2?this.btn_get.ProcTouch(i,t,s)?(this.btn_get.bCheck()&&(Mh.gi().s_SeverEvent(14,1,0,0,0),this.bGet2=!1),!0):(bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||3!=i||(this.bGet2=!1),!0):!!(this.bGift2&&xh.me.rbs.iLev>=10&&this.btn_gift2.ProcTouch(i,t,s))&&(this.btn_gift2.bCheck()&&(0==xh.me.iFlag[37]?this.bGet2=!0:L.easymsg.AddMessage("倒计时结束后可领")),!0)))))}}qe.lg=new qe,qe.DrawNum=function(i,t,s){},qe.DrawTime=function(i,t,s){s=parseInt(s);var e="",h=parseInt(s/60/60)%60;e=e+parseInt(h/10)+h%10+":",h=parseInt(s/60)%60,e=e+parseInt(h/10)+h%10+":",h=s%60,e=e+parseInt(h/10)+h%10,c.gi().DrawText_2(i,t,e,4294833640,22,101,1,1,0,-2,-3,3,4279894016)};class Ke{constructor(){this.bInited=!1,this.bOpen=!1}calcshow(){if(xh.me.rbs.nut>0)return!0;if(xh.me.rbs.iExp>=e.iUpgradeExp[xh.me.rbs.iLev])return!0;var i=Bi.mp.GetUseingPet();return Bi.mp.iPetCount>0&&null==i||null!=i&&i.nut>0}Draw(){if(!Ih.gi().vbk.mapdialog.bHideUI()&&!xs.jq.bJQLock()&&!(xh.me.rbs.iLev>=40)&&(this.bShow=this.calcshow(),this.bShow)){this.bInited||(this.btn_upgrade=new Eh(gn.xani_icon),this.btn_upgrade.InitButton("实力提升"),this.btn_addpoint=new Eh(gn.xani_button),this.btn_addpoint.InitButton("1号按钮150_60"),this.btn_addpoint.sName="人物加点",this.btn_upgrademe=new Eh(gn.xani_button),this.btn_upgrademe.InitButton("1号按钮150_60"),this.btn_upgrademe.sName="人物升级",this.btn_petfight=new Eh(gn.xani_button),this.btn_petfight.InitButton("1号按钮150_60"),this.btn_petfight.sName="宠物出战",this.btn_petpoint=new Eh(gn.xani_button),this.btn_petpoint.InitButton("1号按钮150_60"),this.btn_petpoint.sName="宠物加点",this.bInited=!0);var i=rh.iTopIconOffX;if(this.btn_upgrade.Move(i,10,72,72),this.btn_upgrade.Draw(),gn.xani_icon.DrawAnima(this.btn_upgrade.iX+48,2,"红点提示",0),c.gi().DrawText_2(this.btn_upgrade.iX+36,this.btn_upgrade.iY+71,"提升",4294833640,22,101,1,1,0,-2,-3,3,4279894016),this.bOpen){i+=6;var t=90,s=90,h=Bi.mp.GetUseingPet();xh.me.rbs.nut>0&&(s+=65),xh.me.rbs.iExp>=e.iUpgradeExp[xh.me.rbs.iLev]&&(s+=65),Bi.mp.iPetCount>0&&null==h&&(s+=65),null!=h&&h.nut>0&&(s+=65),this.frame_type4("17号框20_20",i-50-5,t-5,160,s-t+5,20,20),xh.me.rbs.nut>0&&(this.btn_addpoint.Move(i-50,t,150,60),this.btn_addpoint.Draw(),t+=65),xh.me.rbs.iExp>=e.iUpgradeExp[xh.me.rbs.iLev]&&(this.btn_upgrademe.Move(i-50,t,150,60),this.btn_upgrademe.Draw(),t+=65),Bi.mp.iPetCount>0&&null==h&&(this.btn_petfight.Move(i-50,t,150,60),this.btn_petfight.Draw(),t+=65),null!=h&&h.nut>0&&(this.btn_petpoint.Move(i-50,t,150,60),this.btn_petpoint.Draw(),t+=65)}rh.iTopIconOffX+=90}}frame_type4(i,t,s,e,h,a,n){c.gi().FillRect_2D(t,s,t+e,s+h,2147483648),e-a-a>0&&gn.xani_frame.DrawAnimaEx(t+a-2,s,i,1,101,1*(e-a-a+4)/a,1,0,0,0),h-n-n>0&&gn.xani_frame.DrawAnimaEx(t+e-a,s+n-2,i,3,101,1,1*(h-n-n+4)/n,0,0,0),e-a-a>0&&gn.xani_frame.DrawAnimaEx(t+a-2,s+h-n,i,5,101,1*(e-a-a+4)/a,1,0,0,0),h-n-n>0&&gn.xani_frame.DrawAnimaEx(t,s+n-2,i,7,101,1,1*(h-n-n+4)/n,0,0,0),gn.xani_frame.DrawAnimaEx(t,s,i,0,101,1,1,0,0,0),gn.xani_frame.DrawAnimaEx(t+e-1*a,s,i,2,101,1,1,0,0,0),gn.xani_frame.DrawAnimaEx(t+e-1*a,s+h-1*n,i,4,101,1,1,0,0,0),gn.xani_frame.DrawAnimaEx(t,s+h-1*n,i,6,101,1,1,0,0,0),gn.xani_frame.DrawAnimaEx(t+e/2,s+1,i,8,101,1,1,0,0,0)}ProcTouch(i,t,s){if(Ih.gi().vbk.mapdialog.bHideUI()||xs.jq.bJQLock())return!1;if(xh.me.rbs.iLev>=40)return!1;if(!this.bShow)return!1;if(!this.bInited)return!1;if(this.bOpen){var h=Bi.mp.GetUseingPet();if(xh.me.rbs.nut>0&&this.btn_addpoint.ProcTouch(i,t,s))return this.btn_addpoint.bCheck()&&(Ei.pxe.RunXms("人物加点"),this.bOpen=!1),!0;if(xh.me.rbs.iExp>=e.iUpgradeExp[xh.me.rbs.iLev]&&this.btn_upgrademe.ProcTouch(i,t,s)){if(this.btn_upgrademe.bCheck()){var a=Yi.Open(0);a.Draw(),Hs.gi().SetGuideExt(a.btn_upgrade.iX,a.btn_upgrade.iY,a.btn_upgrade.iW,a.btn_upgrade.iH,-1,""),this.bOpen=!1}return!0}if(Bi.mp.iPetCount>0&&null==h&&this.btn_petfight.ProcTouch(i,t,s)){if(this.btn_petfight.bCheck())(n=et.Open()).Draw(),Hs.gi().SetGuideExt(n.btn_joinfight.iX,n.btn_joinfight.iY,n.btn_joinfight.iW,n.btn_joinfight.iH,-1,""),this.bOpen=!1;return!0}if(null!=h&&h.nut>0&&this.btn_petpoint.ProcTouch(i,t,s)){var n;if(this.btn_petpoint.bCheck())(n=et.Open()).Draw(),Hs.gi().SetGuideExt(n.btn_addpoint.iX,n.btn_addpoint.iY,n.btn_addpoint.iW,n.btn_addpoint.iH,-1,""),this.bOpen=!1;return!0}}return this.btn_upgrade.ProcTouch(i,t,s)?(this.btn_upgrade.bCheck()&&(this.btn_addpoint.SetNormal(),this.btn_upgrademe.SetNormal(),this.btn_petfight.SetNormal(),this.btn_petpoint.SetNormal(),this.bOpen=!0),!0):(this.bOpen=!1,!1)}}Ke.su=new Ke;class Ze{constructor(){this.iProc=new Int32Array(4);for(var i=0;i<4;i++)this.iProc[i]=-1}Init(){for(var i=0;i<4;i++)this.iProc[i]=6-2*i}Draw(){if(!(Vs.mf.iProc[0]>=0||this.iProc[0]<0)){var i,t=0;for(i=0;i<4;i++){switch(this.iProc[i]){case 6:gn.xani_skills[0].DrawAnimaEx(h.SCRW/2-90-45+90*i,135,"升级大字",i,20,2.2,2.2,0,0,0);break;case 7:gn.xani_skills[0].DrawAnimaEx(h.SCRW/2-90-45+90*i,135,"升级大字",i,40,1.9,1.9,0,0,0);break;case 8:gn.xani_skills[0].DrawAnimaEx(h.SCRW/2-90-45+90*i,135,"升级大字",i,60,1.6,1.6,0,0,0);break;case 9:gn.xani_skills[0].DrawAnimaEx(h.SCRW/2-90-45+90*i,135,"升级大字",i,80,1.3,1.3,0,0,0);break;case 10:gn.xani_skills[0].DrawAnimaEx(h.SCRW/2-90-45+90*i,135,"升级大字",i,101,1,1,0,0,0);break;case 11:gn.xani_skills[0].DrawAnimaEx(h.SCRW/2-90-45+90*i,135,"升级大字",i,101,.7,.7,0,0,0);break;case 12:gn.xani_skills[0].DrawAnimaEx(h.SCRW/2-90-45+90*i,135,"升级大字",i,101,1,1,0,0,0);break;case 16:default:gn.xani_skills[0].DrawAnimaEx(h.SCRW/2-90-45+90*i,135,"升级大字",i,101,1,1,0,0,0)}this.iProc[i]<20?this.iProc[i]++:t++}4==t&&(this.iProc[0]=-1)}}}Ze.ue=new Ze;class $e{constructor(){this.aa=new l}}class ih{constructor(){}}class th{constructor(){var i;for(this.bBuying=!1,this.bg=new Array(20),this.goods=new Array(20),this.bp=new Array(8),i=0;i<20;i++)this.bg[i]=new $e,this.goods[i]=new Li;for(i=0;i<8;i++)this.bp[i]=new ih;this.iW=900,this.iH=580,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_buy=new Eh(gn.xani_nui2),this.btn_buy.InitButton("按钮1_110"),this.btn_buy.sName="购买",this.btn_watch=new Eh(gn.xani_nui2),this.btn_watch.InitButton("按钮1_110"),this.btn_watch.sName="查看",this.in_count=new vs(gn.xani_nui3),this.in_count.iNumber=1,this.iPetPoint=-1}Draw(){var i,t,s,e,a;if(this.bBuying){for(this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,E.new_baseframe2(this.iX,this.iY,this.iW,this.iH,"摊","位"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_close.Draw(),E.new_framein(this.iX+30,this.iY+30,this.iW-60,this.iH-60),E.new_numberframe(this.iX+30+20,this.iY+30+30-5,685,this.sSellName+"   ---   ("+this.sSeller+this.iSellerId+")"),this.btn_watch.Move(this.iX+30+20+685,this.iY+30+30-5-1,110,52),this.btn_watch.Draw(),e=this.iX+30+20,a=this.iY+30+30+40+30,gn.xani_nui3.DrawAnima(e,a,"摊位分类框",0),c.gi().DrawTextEx(e+52.5,a+16.5,"物品",4294967295,25,101,1,1,0,-2,-2),a+=43,this.iGx=e,this.iGy=a,qi.new_DrawGoods(e,a,this.goods,null,null),i=0;i<20;i++)this.bg[i].iGid>0&&0==this.bg[i].iPrice&&(t=this.iGx+5+i%5*85,s=this.iGy+5+85*Math.floor(i/5),gn.xani_nui3.DrawAnima(t,s,"观赏标签",0));for(e=this.iX+30+20+430+20,a=this.iY+30+30+40+30,gn.xani_nui3.DrawAnima(e,a,"摊位分类框",0),c.gi().DrawTextEx(e+52.5,a+16.5,"宠物",4294967295,25,101,1,1,0,-2,-2),a+=43,this.iPx=e,this.iPy=a,E.new_frameon(e,a,345,175,0),i=0;i<8;i++)t=e+5+i%4*85,s=a+5+85*Math.floor(i/4),gn.xani_nui3.DrawAnima(t,s,"基本头像框",0),this.bp[i].iPid<=0||(gn.xani_head.DrawAnima_aa(t+3,s+3,gn.de_pet.strValue(this.bp[i].iTid,0,1),0),0==this.bp[i].iPrice&&gn.xani_nui3.DrawAnima(t,s,"观赏标签",0),this.iPetPoint==i&&(gn.xani_nui3.DrawAnimaEx(t,s,"物品选中框",0,101,1,1,0,0,0),E.new_TagText2(this.iPx,this.iPy+175+10,150,"名称",gn.de_pet.strValue(this.bp[i].iTid,0,1)),0==this.bp[i].iPrice?E.new_TagText2(this.iPx,this.iPy+175+10+42,150,"单价","观赏"):E.new_TagText2(this.iPx,this.iPy+175+10+42,150,"单价",""+this.bp[i].iPrice),E.new_TagText2(this.iPx,this.iPy+175+10+84,150,"总价",""+this.bp[i].iPrice),this.btn_buy.Move(this.iPx+235,this.iPy+175+10+126-20,110,52),this.btn_buy.Draw()));if(null!=this.lockgoods){for(qi.new_DrawRect(this.iGx,this.iGy,this.goods,this.lockgoods,0),i=0;i<20;i++)this.bg[i].iGid>0&&this.bg[i].iGid==this.lockgoods.iGid&&(E.new_TagText2(this.iPx,this.iPy+175+10,150,"名称",gn.de_goods.strValue(this.lockgoods.iTid,-1,4)),0==this.bg[i].iPrice?(E.new_TagText2(this.iPx,this.iPy+175+10+42,150,"单价","观赏"),qi.detail_add="#e#cc8bfe7观赏"):(E.new_TagText2(this.iPx,this.iPy+175+10+42,150,"单价",""+Math.floor(this.bg[i].iPrice)),E.new_TagText2(this.iPx,this.iPy+175+10+84,150,"总价",""+Math.floor(this.bg[i].iPrice*this.in_count.iNumber)),qi.detail_add="#e#cc8bfe7单价："+Math.floor(this.bg[i].iPrice),gn.de_goods.intValue(this.lockgoods.iTid,0,28)>1&&(this.in_count.Move(this.iPx+230,this.iPy+175+10,115),this.in_count.Draw())));this.btn_buy.Move(this.iPx+235,this.iPy+175+10+126-20,110,52),this.btn_buy.Draw()}E.new_TagText2(this.iPx,this.iPy+175+10+126,150,"铜币",""+xh.me.rbs.iMoney),qi.bShowDetail()&&qi.new_DrawDetail(null,-1,-1,0),qi.detail_add="",ei.end(ei.CONFIRM_MYBUY)&&ei.bConfirm&&(null!=this.lockgoods?Mh.gi().s_MyBuy(0,this.iSellerId,this.lockgoods.iGid,this.in_count.iNumber):-1!=this.iPetPoint&&Mh.gi().s_MyBuy(1,this.iSellerId,this.bp[this.iPetPoint].iPid,1))}}ProcTouch(i,t,s){var e,h,a;if(this.iPetPoint>=0){for(e=0;e<8;e++)if(h=this.iPx+5+e%4*85,a=this.iPy+5+85*Math.floor(e/4),this.bp[e].iPid>0&&bn.bInRect(t,s,h,a,80,80)&&this.iPetPoint==e)return 1==i&&Mh.gi().s_WatchOn(2,this.bp[this.iPetPoint].iPid,0,""),!0;if(this.btn_buy.ProcTouch(i,t,s))return this.btn_buy.bCheck()&&(0==this.bp[this.iPetPoint].iPrice?L.easymsg.AddMessage("观赏宠物，不能购买"):xh.me.rbs.iMoney<this.bp[this.iPetPoint].iPrice?L.easymsg.AddMessage("铜币不足，不能购买"):ei.start(ei.CONFIRM_MYBUY,"是否确定#e花费"+th.money_show(this.bp[this.iPetPoint].iPrice)+"#e购买#c00ff00["+this.bp[this.iPetPoint].sName+"]#cffffff？")),!0}if(null!=this.lockgoods)for(e=0;e<20;e++)if(this.bg[e].iGid>0&&this.bg[e].iGid==this.lockgoods.iGid){if(0==this.bg[e].iPrice);else if(gn.de_goods.intValue(this.lockgoods.iTid,0,28)>1&&this.in_count.ProcTouch(i,t,s))return this.in_count.iNumber>=this.bg[e].iCount&&(this.in_count.iNumber=this.bg[e].iCount),this.in_count.iNumber<0&&(this.in_count.iNumber=0),xh.me.rbs.iMoney<this.bg[e].iPrice*this.in_count.iNumber&&(this.in_count.iNumber=Math.floor(xh.me.rbs.iMoney/this.bg[e].iPrice)),!0;if(this.btn_buy.ProcTouch(i,t,s))return this.btn_buy.bCheck()&&(0==this.bg[e].iPrice?L.easymsg.AddMessage("观赏物品，不能购买"):xh.me.rbs.iMoney<this.bg[e].iPrice*this.in_count.iNumber?L.easymsg.AddMessage("铜币不足，不能购买"):this.in_count.iNumber<=0?L.easymsg.AddMessage("购买数量不能为0"):ei.start(ei.CONFIRM_MYBUY,"是否确定#e花费"+th.money_show(this.bg[e].iPrice*this.in_count.iNumber)+"#e购买"+this.in_count.iNumber+"个#c00ff00["+gn.de_goods.strValue(this.lockgoods.iTid,0,4)+"]#cffffff？")),!0;break}if(this.btn_watch.ProcTouch(i,t,s))return this.btn_watch.bCheck()&&Mh.gi().s_WatchOn(0,this.iSellerId,0,""),!0;for(this.lockgoods=qi.new_LockGoods(t,s,this.iGx,this.iGy,this.goods,i),qi.NoMove(),3==i&&null!=this.lockgoods&&qi.bCanProc(),this.in_count.iNumber=1,this.iPetPoint=-1,e=0;e<8;e++)h=this.iPx+5+e%4*85,a=this.iPy+5+85*Math.floor(e/4),this.bp[e].iPid>0&&bn.bInRect(t,s,h,a,80,80)&&(this.iPetPoint=e);return!this.btn_close.ProcTouch(i,t,s)||(this.btn_close.bCheck()&&(this.bBuying=!1),!0)}InitBuy(i,t,s){var e;for(this.iSellerId=i,this.sSellName=t,this.sSeller=s,this.bBuying=!0,e=0;e<20;e++)this.bg[e].iGid=0,this.goods[e].iGid=-1;for(e=0;e<8;e++)this.bp[e].iPid=0}IndexBuy(i){var t,s;if(0==(t=i.GetNextByte())){for(t=0;t<20;t++)this.bg[t].iGid=-1,this.goods[t].iGid=-1;for(t=0;t<20&&0!=(s=i.GetNextByte());t++){for(this.bg[t].iGid=i.GetNextInt(),this.bg[t].iPrice=i.GetNextInt(),this.bg[t].iTid=i.GetNextShort(),this.bg[t].iCount=i.GetNextShort(),this.goods[t].iGid=this.bg[t].iGid,this.goods[t].iTid=this.bg[t].iTid,this.goods[t].iCount=this.bg[t].iCount,s=0;s<8;s++)this.goods[t].iAtts[s]=i.GetNextInt();this.goods[t].iPos=t,gn.xani_ngoods.InitAnimaWithName(gn.de_goods.strValue(this.bg[t].iTid,0,10),this.goods[t].aa)}}else if(1==t){for(t=0;t<8;t++)this.bp[t].iPid=0;for(t=0;t<8&&0!=(s=i.GetNextByte());t++)this.bp[t].iPid=i.GetNextInt(),this.bp[t].iPrice=i.GetNextInt(),this.bp[t].iTid=i.GetNextInt(),s=i.GetNextShort(),this.bp[t].sName=gn.de_pet.strValue(this.bp[t].iTid,0,1),0!=(1&s)&&(this.bp[t].sName=this.bp[t].sName+"宝宝"),0!=(2&s)&&(this.bp[t].sName="变异"+this.bp[t].sName)}}}th.mb=null,th.gi=function(){return null==th.mb&&(th.mb=new th),th.mb},th.its=function(i){return i>=1e3?""+i:i>=100?"0"+i:i>=10?"00"+i:i>=0?"000"+i:"0000"},th.money_show=function(i){var t,s,e;return t=Math.floor(i/1e8),s=Math.floor(i/1e4)%1e4,e=i%1e4,t>0?t+","+th.its(s)+","+th.its(e):s>0?s+","+th.its(e):""+e};class sh extends s{constructor(i){var t;for(super(),this.pani=i,this.pm3f=i.pm3f,this.iW=790,this.iH=405,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.givegoods=new Array(3),this.btn_goods=new Array(3),this.xigsub=new Int32Array(3),this.in_count=new Array(3),t=0;t<3;t++)this.btn_goods[t]=new D(gn.xani_nui3),this.btn_goods[t].InitButton("物品格子"),this.givegoods[t]=null,this.xigsub[t]=1,this.in_count[t]=new vs(gn.xani_nui3),this.in_count[t].iNumber=1;this.in_money=new vs(gn.xani_nui3),this.in_money.iNumber=0,this.in_money.MinMax(0,xh.me.rbs.iMoney),this.btn_give=new Eh(gn.xani_nui2),this.btn_give.sName="给予",this.btn_give.InitButton("按钮1_110"),this.bLocked=!1}Draw(){var i,t,s;for(t=this.iX+30,s=this.iY+30,E.new_bigframe(this.iX,this.iY,this.iW,this.iH),i=0;i<3;i++)this.xigsub[i]=this.in_count[i].iNumber;for(qi.new_DrawGoods(this.iX+30,this.iY+30,ht.gi().goods[2],this.givegoods,this.xigsub),null!=this.lockgoods&&qi.new_DrawRect(this.iX+30,this.iY+30,ht.gi().goods[2],this.lockgoods,0),t+=450,i=0;i<3;i++)this.btn_goods[i].Move(t+100*i,s,80,80),this.btn_goods[i].Draw(),null!=this.givegoods[i]&&qi.new_DrawOneGoods_ext(this.btn_goods[i].iX,this.btn_goods[i].iY,this.givegoods[i],this.xigsub[i]);for(i=0;i<3;i++)null!=this.givegoods[i]&&gn.de_goods.intValue(this.givegoods[i].iTid,0,28)>1&&(this.in_count[i].Move(this.btn_goods[i].iX,this.btn_goods[i].iY+80,80),this.in_count[i].Draw());s+=150,this.pm3f.DrawTextEx(t,s+25,"铜币:",4278190080,30,101,1,1,0,0,-2),E.DrawTextFrame1(this.in_money.iX,this.in_money.iY,this.in_money.iW),this.in_money.Move(t+100,s,150),this.in_money.Draw(),s+=70,this.pm3f.DrawTextEx(t,s+15,"铜币:"+xh.me.rbs.iMoney,4278190080,30,101,1,1,0,0,-2),s+=50,E.new_Text(t,s,150,sh.sName),s+=40,E.new_Text(t,s,150,"号码:"+sh.iRid),this.btn_give.Move(this.iX+this.iW-30-110,this.iY+this.iH-30-52-10,110,52),this.btn_give.Draw(),qi.bShowDetail()&&qi.new_DrawDetail(null,-1,-1,0)}ProcTouch(i,t,s){var e,h;if(this.in_money.ProcTouch(i,t,s))return!0;for(e=0;e<3;e++)if(null!=this.givegoods[e]&&(h=gn.de_goods.intValue(this.givegoods[e].iTid,0,28))>1&&this.in_count[e].ProcTouch(i,t,s))return!0;if(this.lockgoods=qi.new_LockGoods(t,s,this.iX+30,this.iY+30,ht.gi().goods[2],i),qi.NoMove(),3==i&&null!=this.lockgoods&&qi.bCanProc()){if(0!=this.lockgoods.iAtts[7]&&123!=this.lockgoods.iTid)return L.easymsg.AddMessage("绑定物品不可给予"),!0;if(h=gn.de_goods.intValue(this.lockgoods.iTid,0,28),this.givegoods[0]==this.lockgoods||this.givegoods[1]==this.lockgoods||this.givegoods[2]==this.lockgoods);else for(e=0;e<3;e++)if(null==this.givegoods[e]){this.givegoods[e]=this.lockgoods,this.in_count[e].iNumber=1,h>1&&this.in_count[e].MinMax(1,this.lockgoods.iCount);break}}for(e=0;e<3;e++)this.btn_goods[e].ProcTouch(i,t,s)&&this.btn_goods[e].bCheck()&&(this.givegoods[e]=null);if(this.btn_give.ProcTouch(i,t,s)){if(this.btn_give.bCheck()){for(this.in_money.iNumber>0&&this.in_money.iNumber<=xh.me.rbs.iMoney&&(xh.me.rbs.iMoney-=this.in_money.iNumber,Mh.gi().s_GiveGoods(0,sh.iRid,this.in_money.iNumber,1)),e=0;e<3;e++)null!=this.givegoods[e]&&-1!=this.givegoods[e].iGid&&(Mh.gi().s_GiveGoods(1,sh.iRid,this.givegoods[e].iGid,this.in_count[e].iNumber),(h=gn.de_goods.intValue(this.givegoods[e].iTid,0,28))<=1?this.givegoods[e].iGid=-1:(this.givegoods[e].iCount-=this.in_count[e].iNumber,this.givegoods[e].iCount<=0&&(this.givegoods[e].iGid=-1)));ln.gi().PopStat(1)}return!0}return 3!=i||bn.bOnRect(t,s,this.iX,this.iY,this.iW,this.iH)||ln.gi().PopStat(1),!1}}sh.iRid,sh.sName,sh.GiveTo=function(i,t){sh.iRid=i,sh.sName=t,ln.gi().PushStat(ln.GS_GIVEGOODS)};class eh{constructor(){this.name=""}}class hh{constructor(){var i;for(this.OFFX=h.SCRW/4*3,this.OFFY=h.SCRH/4*1,this.sls=new Array(hh.MAXSELECTCOUNT),i=0;i<hh.MAXSELECTCOUNT;i++)this.sls[i]=new eh;for(this.iSelectCount=0,this.btn_operate=new Array(16),i=0;i<16;i++)this.btn_operate[i]=new D(gn.xani_nui3),this.btn_operate[i].Move(this.OFFX+50+i%2*80,this.OFFY+50+50*parseInt(i/2),80,50),this.btn_operate[i].InitButton("附近操作按钮"),this.btn_operate[i].sName="无无"}Clear(){this.iSelectCount=0,this.iSelectPoint=-1,this.iOperatePoint=-1}Add(i,t,s){this.iSelectCount>=hh.MAXSELECTCOUNT||(this.sls[this.iSelectCount].type=i,this.sls[this.iSelectCount].name=t,this.sls[this.iSelectCount].point=s,this.iSelectCount++)}OpenMyBuy(i,t,s){th.gi().bBuying||(th.gi().InitBuy(t,i,s),Mh.gi().s_StartBuy(t))}Draw(){var i;if(!(this.iSelectCount<=0)){for(this.OFFX=h.SCRW/8*5,this.OFFY=h.SCRH/4*1,i=0;i<16;i++)this.btn_operate[i].Move(this.OFFX+80+10+i%2*77,this.OFFY+80+53*parseInt(i/2),72,50);if(1==this.iSelectCount){if(0!=this.iOperatePoint){this.iOperatePoint=0;var t=this.sls[this.iOperatePoint].point;this.iORid=t.iRid}else{t=this.sls[this.iOperatePoint].point;if(this.iORid!=t.iRid)return void(this.iSelectCount=0)}if(3==this.sls[this.iOperatePoint].type){t=this.sls[this.iOperatePoint].point;return this.OpenMyBuy(t.sSellName,t.iRid,t.sName),void(this.iSelectCount=0)}}if(-1==this.iOperatePoint){for(this.x1=this.OFFX+100,this.y1=this.OFFY,this.x2=this.x1+10+10+160,this.y2=this.y1+10+10+30*this.iSelectCount,E.new_framepc(this.x1-5,this.y1-5,this.x2-this.x1+10,this.y2-this.y1+10),c.gi().SetViewClip(this.x1,this.y1,this.x2,this.y2),i=0;i<this.iSelectCount;i++)this.iSelectPoint==i&&c.gi().FillRect_2D(this.x1+10,this.y1+10+30*i,this.x1+10+160,this.y1+10+30*i+30,4278190335),2==this.sls[i].type?c.gi().DrawTextEx(this.x1+10,this.y1+10+30*i+2,"[队]"+this.sls[i].name,4294967295,25,101,1,1,0,-1,-1):c.gi().DrawTextEx(this.x1+10,this.y1+10+30*i+2,this.sls[i].name,4294967295,25,101,1,1,0,-1,-1);c.gi().NoClip()}else switch(this.sls[this.iOperatePoint].type){case 1:var s=this.sls[this.iOperatePoint].point;gn.xani_head.DrawAnima(this.OFFX-33,this.OFFY-10,"新头像"+(2*s.iRace+s.iSex),0),gn.xani_ui.DrawAnimaEx(this.OFFX+50,this.OFFY-10,"附近操作框",0,101,1,1,0,0,0),c.gi().DrawTextEx(this.OFFX+60,this.OFFY-5,s.sName,4294967295,25,101,1,1,0,-1,-1),c.gi().DrawTextEx(this.OFFX+60,this.OFFY+25,"号码:"+s.iRid,4294967295,20,101,1,1,0,-1,-1),this.btn_operate[0].sName="组队",this.btn_operate[0].Draw(),this.btn_operate[1].sName="摆摊",this.btn_operate[1].Draw();break;case 2:case 4:t=this.sls[this.iOperatePoint].point;gn.xani_head.DrawAnima(this.OFFX,this.OFFY,"新头像"+(2*t.iRace+t.iSex),0),E.new_framepc(this.OFFX+80,this.OFFY,169,297),c.gi().DrawTextEx(this.OFFX+80+10,this.OFFY+22,t.sName,4294967295,25,101,1,1,0,-1,-2),c.gi().DrawTextEx(this.OFFX+80+10,this.OFFY+58,"号码:"+t.iRid,4294967295,25,101,1,1,0,-1,-2),2==this.sls[this.iOperatePoint].type?this.btn_operate[0].sName="入队":this.btn_operate[0].sName="组队",this.btn_operate[0].Draw(),this.btn_operate[1].sName="好友",this.btn_operate[1].Draw(),this.btn_operate[2].sName="发送",this.btn_operate[2].Draw(),this.btn_operate[3].sName="给予",this.btn_operate[3].Draw(),this.btn_operate[4].sName="攻击",this.btn_operate[4].Draw(),this.btn_operate[5].sName="查看",this.btn_operate[5].Draw(),this.btn_operate[6].sName="交易",this.btn_operate[6].Draw()}}}ProcTouch(i,t,s){var e;if(this.iSelectCount<=0)return!1;if(-1==this.iOperatePoint){for(this.iSelectPoint=-1,e=0;e<this.iSelectCount;e++)bn.bInRect(t,s,this.x1+10,this.y1+10+30*e,160,30)&&(this.iSelectPoint=e);if(-1!=this.iSelectPoint&&3==i&&(this.iOperatePoint=this.iSelectPoint,3==this.sls[this.iOperatePoint].type)){var h=this.sls[this.iOperatePoint].point;return this.OpenMyBuy(h.sSellName,h.iRid,h.sName),this.iSelectCount=0,!0}if(bn.bInRect(t,s,this.x1,this.y1,this.x2-this.x1,this.y2-this.y1))return!0}else switch(this.sls[this.iOperatePoint].type){case 1:if(this.btn_operate[0].ProcTouch(i,t,s)){if(this.btn_operate[0].bCheck()){this.sls[this.iOperatePoint].point;H.bNoTeam()&&Mh.gi().s_TeamOperate(0,0,0),this.Clear()}return!0}if(this.btn_operate[1].ProcTouch(i,t,s))return this.btn_operate[1].bCheck()&&(H.bInTeam()?L.easymsg.AddMessage("队伍中不能摆摊"):ct.gi().bSelling?ct.gi().bShow=!0:Mh.gi().s_StartSell(0,0,0,""),this.Clear()),!0;break;case 2:case 4:if(this.btn_operate[0].ProcTouch(i,t,s)){if(this.btn_operate[0].bCheck()){h=this.sls[this.iOperatePoint].point,rh.gameing.me;H.bTeamLeader()?Mh.gi().s_TeamOperate(6,h.iRid,0):H.bNoTeam()&&1==h.iIsLeader?Mh.gi().s_TeamOperate(3,h.iRid,0):H.bNoTeam(),this.Clear()}return!0}if(this.btn_operate[1].ProcTouch(i,t,s)){if(this.btn_operate[1].bCheck()){h=this.sls[this.iOperatePoint].point;Mh.gi().s_FriendOperate(0,h.iRid,0),this.Clear()}return!0}if(this.btn_operate[2].ProcTouch(i,t,s)){if(this.btn_operate[2].bCheck()){h=this.sls[this.iOperatePoint].point;dt.OpenChat(h.iRid,h.sName,2*h.iRace+h.iSex),this.Clear()}return!0}if(this.btn_operate[3].ProcTouch(i,t,s)){if(this.btn_operate[3].bCheck()){if(xh.me.bHaveLock&&xh.me.bLocked)return L.easymsg.AddMessage("未解锁不能给予"),!0;if(ct.gi().bSelling)return L.easymsg.AddMessage("摆摊中不能给予"),!0;h=this.sls[this.iOperatePoint].point;sh.GiveTo(h.iRid,h.sName),this.Clear()}return!0}if(this.btn_operate[4].ProcTouch(i,t,s)){if(this.btn_operate[4].bCheck()){h=this.sls[this.iOperatePoint].point;Mh.gi().s_PK(h.iRid),this.Clear()}return!0}if(this.btn_operate[5].ProcTouch(i,t,s)){if(this.btn_operate[5].bCheck()){h=this.sls[this.iOperatePoint].point;Mh.gi().s_WatchOn(0,h.iRid,0,""),this.Clear()}return!0}if(this.btn_operate[6].ProcTouch(i,t,s)){if(this.btn_operate[6].bCheck()){if(xh.me.bHaveLock&&xh.me.bLocked)return L.easymsg.AddMessage("未解锁不能交易"),!0;h=this.sls[this.iOperatePoint].point;Mh.gi().s_Trade(0,h.iRid,0,0,0,0,0,0,0,0,0),this.Clear()}return!0}}return!1}}hh.MAXSELECTCOUNT=15;class ah{constructor(){}}class nh{constructor(){var i;for(this.btns=new Array(nh.MAXBTN),i=0;i<nh.MAXBTN;i++)this.btns[i]=null}SetIcon(i){var t,s=i.GetNextInt(),e=i.GetNextString(),h=i.GetNextString();if(0==s){for(t=0;t<nh.MAXBTN;t++)if(null!=this.btns[t]&&this.btns[t].sCmd==h&&this.btns[t].sAnima==e)return void(this.btns[t]=null)}else{for(t=0;t<nh.MAXBTN;t++)if(null!=this.btns[t]&&this.btns[t].sCmd==h&&this.btns[t].sAnima==e)return;for(t=0;t<nh.MAXBTN;t++)if(null==this.btns[t])return this.btns[t]=new ah,this.btns[t].btn_icon=new Eh(gn.xani_button),this.btns[t].btn_icon.InitButton(e),this.btns[t].sAnima=e,this.btns[t].sCmd=h,void(this.btns[t].iShow=s)}}Draw(i){var t,s=h.SCRW-120-nh.BW,e=h.SCRH-120-nh.BH;for(t=0;t<nh.MAXBTN;t++)null!=this.btns[t]&&0!=(this.btns[t].iShow&i)&&(E.new_framepc(s,e,nh.BW,nh.BH),this.btns[t].btn_icon.Move(s,e,nh.BW,nh.BH),this.btns[t].btn_icon.Draw(),s-=nh.BW-20)}ProcTouch(i,t,s,e){var h;for(h=0;h<nh.MAXBTN;h++)if(null!=this.btns[h]&&0!=(this.btns[h].iShow&i)&&this.btns[h].btn_icon.ProcTouch(t,s,e))return this.btns[h].btn_icon.bCheck()&&Mh.gi().s_ExtendCmd(this.btns[h].sCmd,"","","","","","",""),!0;return!1}}nh.MAXBTN=3,nh.BW=80,nh.BH=80,nh.peb=new nh;class oh{constructor(){this.iW=200,this.iH=24,this.iX=(h.SCRW-this.iW)/2,this.iY=2*(h.SCRH-this.iH)/3,this.bShow=!1}InitProgress(i){var t=i.GetNextInt();t<=0?this.bShow=!1:(this.iStartMillis=gn.iNowMillis,this.iLastMillis=gn.iNowMillis+t,this.bShow=!0,this.sDetail=i.GetNextString(),this.sCmd=i.GetNextString())}Draw(){if(this.bShow){var i=1*(gn.iNowMillis-this.iStartMillis)/(this.iLastMillis-this.iStartMillis);E.new_framepc(this.iX,this.iY,this.iW,this.iH),E.frame_type1("埋宝地进度条8_18",this.iX+3,this.iY+3,i*(this.iW-6),8);var t=gn.iDelay/10,s="";t%3==0&&(s="."),t%3==1&&(s=".."),t%3==2&&(s="..."),c.gi().DrawTextEx(this.iX,this.iY-30,this.sDetail+s,4294967040,30,101,1,1,0,0,0),gn.iNowMillis>=this.iLastMillis&&(this.bShow=!1)}}ProcTouch(i,t,s,e){return!1}}oh.ppb=null,oh.gi=function(){return null==oh.ppb&&(oh.ppb=new oh),oh.ppb};class rh extends s{findnrs(i){var t;for(t=0;t<rh.iNearMax;t++)if(this.nrs[t].bUseing&&this.nrs[t].iRid==i)return this.nrs[t];return null}ClearPopo(){var i;for(i=0;i<rh.iNearMax;i++)this.nrs[i].bUseing&&(this.nrs[i].iPopoDelay=0)}findnrsbyname(i){var t;for(t=0;t<rh.iNearMax;t++)if(this.nrs[t].bUseing&&this.nrs[t].sName==i)return this.nrs[t];return null}constructor(i){var t;for(super(),rh.gameing=this,this.pani=i,this.pm3f=i.pm3f,this.pls=new u(524288),this.m_map=Ih.gi(),this.m_dbf=M.gi(),this.me=xh.me,this.me.iX=50,this.me.iY=50,this.me.iRid=0,this.nrs=new Array(rh.iNearMax),t=0;t<rh.iNearMax;t++)this.nrs[t]=new lt;this.nb=new hh,this.aa_pos=gn.xani_nui3.InitAnimaWithName("地图坐标",null),this.aa_network=gn.xani_nui2.InitAnimaWithName("网络状况",null),this.aa_numtime=gn.xani_nui2.InitAnimaWithName("时间",null),this.aa_numpos=gn.xani_nui2.InitAnimaWithName("坐标",null),this.oldhour=0,this.iFStat=0,this.iFDT1=0,this.iFDT2=0,this.iFDT3=0}FreshNearRole(){var i;for(i=0;i<rh.iNearMax;i++)this.nrs[i].bsc=!0}DrawMapUI(){if(!Ih.gi().vbk.mapdialog.bHideUI()&&!xs.jq.bJQLock()){var i,t,s;for(this.aa_pos.Draw(0,0),i=t=gn.xntf.NetBusy();i<t+5;i++)s=i<5?0:i<9?i-4:4,this.aa_network.iFrame=s,this.aa_network.Draw(23*(i-t),0);if(this.pm3f.DrawText_2(59,42,Ih.gi().mapdata.sMapDetail,4294967295,20,101,1,1,0,-2,-2,1,4278190080),c.gi().DrawTextEx(42,17,":",4294967295,20,101,1,1,0,-2,-2),c.gi().DrawTextEx(76,17,":",4294967295,20,101,1,1,0,-2,-2),i=parseInt((gn.iNowMillis-xh.iMillis)/1e3),s=(t=xh.iTime[2]+i%60)>=60?1:0,t%=60,c.gi().DrawTextEx(94,17,""+parseInt(t/10)+t%10,4294967295,20,101,1,1,0,-2,-2),s=(t=xh.iTime[1]+parseInt(i/60)%60+s)>=60?1:0,t%=60,c.gi().DrawTextEx(59,17,""+parseInt(t/10)+t%10,4294967295,20,101,1,1,0,-2,-2),t=xh.iTime[0]+parseInt(i/60/60)+s,t%=24,c.gi().DrawTextEx(24,17,""+parseInt(t/10)+t%10,4294967295,20,101,1,1,0,-2,-2),23==this.oldhour&&0==t)for(var e=0;e<20;e++)ht.gi().goods[2][e].iGid>0&&ht.gi().goods[2][e].iTid>=347&&ht.gi().goods[2][e].iTid<=351&&(ht.gi().goods[2][e].iGid=-1),ht.gi().goods[3][e].iGid>0&&ht.gi().goods[3][e].iTid>=347&&ht.gi().goods[3][e].iTid<=351&&(ht.gi().goods[3][e].iGid=-1);this.oldhour=t,c.gi().DrawTextEx(59,69,":",4294967040,20,101,1,1,0,-2,-2),c.gi().DrawTextEx(29,69,""+parseInt(xh.me.iX/16),4294967040,20,101,1,1,0,-2,-2),c.gi().DrawTextEx(89,69,""+parseInt(xh.me.iY/16),4294967040,20,101,1,1,0,-2,-2)}}Draw(){var i;if(Ih.gi().bMapLoaded&&this.m_map.mto(this.me.iX,this.me.iY),Ih.gi().bMapLoaded&&this.m_map.DrawGround(),ws.bFighting){if(Ih.gi().iMapChangeing=0,Ih.gi().bMapLoaded&&this.m_map.DrawMiddleDirect(),yh.SetScreenMode(11),ws.gi().Draw_UI1(),yh.SetScreenMode(10),ws.gi().Draw(),yh.SetScreenMode(11),ws.gi().Draw_UI2(),es.gi().Draw(),this.DrawMapUI(),_s.aff.Draw(),this.me.TeamFollow(),ts.gi().Draw(),dh.gi().Draw(),nh.peb.Draw(2),this.me.DrawExp(),ws.gi().iAlphaEffect>=h.SCRW||300!=ws.gi().iFightStat)return;yh.SetScreenMode(10)}if(this.m_dbf.ClearBuffer(),Ih.gi().bMapLoaded&&this.m_map.DrawMiddle(this.m_dbf),this.me.Draw(),Bs.psp.Draw(),this.me.next(this.m_map.mfy.iPath,this.m_map.mfy.iPathDeep),h.bDebug){for(i=1;i<this.m_map.mfy.iPathDeep;i++)c.gi().DrawLine(Ih.gi().iOffx+this.m_map.mfy.iPath[i][0],Ih.gi().iOffy+this.m_map.mfy.iPath[i][1],Ih.gi().iOffx+this.m_map.mfy.iPath[i-1][0],Ih.gi().iOffy+this.m_map.mfy.iPath[i-1][1],4294901760);Ih.gi().bMapLoaded&&Ih.gi().mfy.Draw()}for(this.me.TeamFollow(),this.iNearRoleCount=0,i=0;i<rh.iNearMax;i++)this.nrs[i].bUseing&&(this.nrs[i].Go(),this.nrs[i].Draw(),this.iNearRoleCount++);this.m_dbf.SortAndDraw(),G.fe.Draw(),Ih.gi().bMapLoaded&&this.m_map.DrawSky(),yh.SetScreenMode(11),this.me.DrawUI(),this.DrawMapUI(),this.nb.Draw(),es.gi().Draw(),Ks.sw.Draw(),qt.gi().Draw(),uh.gi().Draw(),Ls.gi().Draw(),dh.gi().Draw(),rh.iFindWayOnce>0&&rh.iFindWayOnce--,ct.gi().bSelling&&ct.gi().Draw(),th.gi().bBuying&&th.gi().Draw(),Qi.Draw(),Ue.gi().Draw(),Zt.iWaitingApplyMapId>0&&Zt.iWaitingApplyMapId==Ih.gi().iCurrentMapId&&(Zt.iWaitingApplyMapId=0,Mh.gi().s_TeamOperate(3,Zt.iWaitingApplyRid,0)),_s.aff.Draw(),vt.gi().Draw(),rh.iTopIconOffX=130,Qe.lb.Draw(),Je.fg.Draw(),qe.lg.Draw(),je.fg.Draw(),Ke.su.Draw(),1==this.iFStat&&(this.iFDT2=bn.get_ms(),this.iFDT2-this.iFDT1>500&&(this.iFDT1=this.iFDT2,this.goon(this.iFX,this.iFY))),ts.gi().Draw(),nh.peb.Draw(1),this.m_map.vbk.mapdialog.Draw(),Vs.mf.Draw(),Ze.ue.Draw(),this.me.DrawExp(),xs.jq.JQLogic()}ProcTouch(i,t,s){if(xs.jq.ProcTouch(i,t,s))return!0;if(_s.aff.ProcTouch(i,t,s))return!0;if(ws.bFighting)return!!nh.peb.ProcTouch(2,i,t,s)||(!!dh.gi().ProcTouch(i,t,s)||(!!ts.gi().ProcTouch(i,t,s)||(!!es.gi().ProcTouch(i,t,s)||(ws.gi().ProcTouch(i,t,s),ws.gi().iFightStat>=100&&uh.gi().ProcTouch(i,t,s),!0))));if(ln.gi().iXStat==ln.GS_GAMEING&&Le.gi().ProcTouch(i,t,s))return!0;if(this.m_map.vbk.mapdialog.ProcTouch(i,t,s))return!0;if(nh.peb.ProcTouch(1,i,t,s))return!0;if(dh.gi().ProcTouch(i,t,s))return!0;if(ts.gi().ProcTouch(i,t,s))return!0;var e,h,a,n,o=Ih.gi().iOffx,r=Ih.gi().iOffy;if(a=t,n=s,2==i&&1==this.iFStat)return this.iFDT2=bn.get_ms(),this.iFDT2-this.iFDT1>50&&this.iFDT2-this.iFDT3>500&&(this.iFDT1=this.iFDT2,this.iFX=t,this.iFY=s,this.goon(t,s)),!0;if(3==i&&1==this.iFStat){if(this.iFStat=0,this.iFDT2=bn.get_ms(),this.iFDT2-this.iFDT3<500)if(Ih.gi().vbk.GoToNpc(t-this.m_map.iOffx,s-this.m_map.iOffy))(H.bNoTeam()||H.bTeamLeader()||H.bAway())&&!ct.gi().bSelling&&(t=Ih.gi().vbk.iNpcX+this.m_map.iOffx,s=Ih.gi().vbk.iNpcY+this.m_map.iOffy,this.m_map.mfy.findway(this.me.iX,this.me.iY,t-this.m_map.iOffx,s-this.m_map.iOffy)&&this.m_map.mfy.checkagain()&&(this.me.start(this.m_map.mfy.iPath,this.m_map.mfy.iPathDeep),Q.te.Add(t-this.m_map.iOffx,s-this.m_map.iOffy)),this.nb.Clear());else{for(this.nb.Clear(),ct.gi().bSelling,e=0;e<rh.iNearMax;e++)this.nrs[e].bUseing&&(yh.bShowRole||H.bInTmpTeam(this.nrs[e].iRid))&&(gn.xani_newrole[2*this.nrs[e].iRace+this.nrs[e].iSex].bInAnima(this.nrs[e].aa_body,o+this.nrs[e].iX,r+this.nrs[e].iY,t,s)||bn.bInRect(t-this.m_map.iOffx,s-this.m_map.iOffy,this.nrs[e].iX-20,this.nrs[e].iY-60,40,60))&&(gn.sop("ppp===="+this.nrs[e].aa_body.iAnimaPoint),1==this.nrs[e].iIsLeader?this.nb.Add(2,this.nrs[e].sName,this.nrs[e]):this.nb.Add(4,this.nrs[e].sName,this.nrs[e]));if(yh.bShowSell)for(e=0;e<rh.iNearMax;e++)this.nrs[e].bUseing&&bn.bInRect(t,s,o+this.nrs[e].iX-this.nrs[e].iSellWidth/2,r+this.nrs[e].iY-140,this.nrs[e].iSellWidth,40)&&1==this.nrs[e].iIsSelling&&this.nb.Add(3,this.nrs[e].sSellName,this.nrs[e]);0==this.nb.iSelectCount&&this.goon(t,s)}else this.goon(t,s);return!0}if(t=a,s=n,Qe.lb.ProcTouch(i,t,s))return!0;if(je.fg.ProcTouch(i,t,s))return!0;if(Je.fg.ProcTouch(i,t,s))return!0;if(qe.lg.ProcTouch(i,t,s))return!0;if(Ke.su.ProcTouch(i,t,s))return!0;if(vt.gi().ProcTouch(i,t,s))return!0;if(Ue.gi().ProcTouch(Gh.gi().procing.iTouchStat,Gh.gi().procing.iX,Gh.gi().procing.iY))return!0;if(Qi.ProcTouch(i,t,s))return!0;if(th.gi().bBuying)return th.gi().ProcTouch(i,t,s),!0;if(ct.gi().bSelling&&ct.gi().bShow)return ct.gi().ProcTouch(i,t,s),!0;if(this.me.ProcTouch_AttFrame(i,t,s))return!0;if(uh.gi().ProcTouch(i,t,s))return!0;if(es.gi().ProcTouch(i,t,s))return!0;if(oh.gi().bShow)return!0;if(Ls.gi().ProcTouch(i,t,s))return!0;if(qt.gi().ProcTouch(i,t,s))return!0;if(Ks.sw.ProcTouch(i,t,s))return!0;if(this.me.ProcTouch(i,t,s))return!0;if(this.nb.ProcTouch(i,t,s))return!0;if(a=t,n=s,Ue.gi().bFinding=!1,1==i){if(Ih.gi().vbk.bOnNpc(t-this.m_map.iOffx,s-this.m_map.iOffy));else{for(this.nb.Clear(),ct.gi().bSelling,h=0,e=0;e<rh.iNearMax;e++)this.nrs[e].bUseing&&(yh.bShowRole||H.bInTmpTeam(this.nrs[e].iRid))&&(gn.xani_newrole[2*this.nrs[e].iRace+this.nrs[e].iSex].bInAnima(this.nrs[e].aa_body,o+this.nrs[e].iX,r+this.nrs[e].iY,t,s)||bn.bInRect(t-this.m_map.iOffx,s-this.m_map.iOffy,this.nrs[e].iX-20,this.nrs[e].iY-60,40,60))&&h++;if(yh.bShowSell)for(e=0;e<rh.iNearMax;e++)this.nrs[e].bUseing&&bn.bInRect(t,s,o+this.nrs[e].iX-this.nrs[e].iSellWidth/2,r+this.nrs[e].iY-140,this.nrs[e].iSellWidth,40)&&h++;0==h&&this.goon(t,s)}this.iFStat=1,this.iFX=t,this.iFY=s,this.iFDT1=bn.get_ms(),this.iFDT3=bn.get_ms()}return t=a,s=n,!1}goon(i,t){rh.iFindWayOnce>0||(rh.iFindWayOnce++,ct.gi().bSelling||(H.bNoTeam()||H.bTeamLeader()||H.bAway())&&(this.m_map.mfy.findway(this.me.iX,this.me.iY,i-this.m_map.iOffx,t-this.m_map.iOffy)?this.m_map.mfy.checkagain()&&(Ih.gi().vbk.iGoToNpcFlag=-1,Ih.gi().vbk.iGoToNpcId=-1,this.me.start(this.m_map.mfy.iPath,this.m_map.mfy.iPathDeep),Ks.sw.bLocked=!1,Ks.sw.bAutoRun=!1,Q.te.Add(i-this.m_map.iOffx,t-this.m_map.iOffy)):(Ks.sw.bLocked=!0,Ks.sw.iLockX=i-(Ih.gi().iOffx+xh.me.iX)+Ks.sw.iX,Ks.sw.iLockY=t-(Ih.gi().iOffy+xh.me.iY)+Ks.sw.iY,Ks.sw.bAutoRun=!0)))}}rh.iNearMax=50,rh.iFindWayOnce=0,rh.bSheildRoles=!1,rh.bSheildUis=!1,rh.iTopIconOffX;class ch{MyFriends(){this.bUseing=!1,this.sName=""}}class lh{constructor(){}}class bh extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=600,this.iH=500,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.iOffY=0,this.bLock=!1}Draw(){var i,t,s,e;for(E.new_framewatch(this.iX,this.iY,this.iW,this.iH),c.gi().SetViewClip(this.iX+20,this.iY+20,this.iX+this.iW-20,this.iY+this.iH-20),t=this.iX+20,e=this.iOffY+this.iY+20,i=0;i<iRecordPoint&&(crs[i].fromid!=iRid&&crs[i].toid!=iRid||(Y.gi().FormatEx(crs[i].sName+":"+crs[i].sDetail,this.iW-40,25,0,0,27),s=Y.gi().iH,Y.gi().Draw(t,e),!((e+=s+3)>=this.iY+this.iH-20)));i++);i>=iRecordPoint?this.bCanDown=!1:this.bCanDown=!0,c.gi().NoClip()}ProcTouch(i,t,s){if(3!=i||bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||ln.gi().PopStat(1),1==i)bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)&&(this.bLock=!0,this.iLockY=s);else if(2==i){if(this.bLock){var e=s-this.iLockY;e>0&&this.iOffY<0?this.iOffY+=e:this.bCanDown&&(this.iOffY+=e),this.iOffY>0&&(this.iOffY=0),this.iLockY=s}}else 3==i&&(this.bLock=!1);return!1}}bh.AddChatRecord=function(i,t,s,e,h){if(crs[iRecordPoint]=new lh,crs[iRecordPoint].fromid=i,crs[iRecordPoint].toid=t,crs[iRecordPoint].sName=s,crs[iRecordPoint].sDetail=e,crs[iRecordPoint].sTime=h,iRecordPoint++,iRecordPoint>=bh.MAXCHATRECORD){var a;for(a=0;a<bh.MAXCHATRECORD/2;a++)crs[a]=crs[bh.MAXCHATRECORD/2+a];iRecordPoint=bh.MAXCHATRECORD/2}},bh.OpenRecord=function(i,t,s){ph.iPrivateChatMode=1,dt.OpenChat(i,t,s)},bh.iRid,bh.iRecordPoint=0,bh.MAXCHATRECORD=1e3,bh.crs=new Array(bh.MAXCHATRECORD);class _h extends s{constructor(i){var t;for(super(),this.iW=150,this.iH=340,this.iX=h.SCRW-this.iW-230,this.iY=(h.SCRH-this.iH)/2,this.btn_team=new Array(4),t=0;t<4;t++)this.btn_team[t]=new Eh(gn.xani_nui2),this.btn_team[t].InitButton("按钮1_110");this.btn_team[0].sName="亲密",this.btn_team[1].sName="普通",this.btn_team[2].sName="黑名单",this.btn_team[3].sName="删除"}Draw(){var i;for(E.new_framewatch(this.iX,this.iY,this.iW,this.iH),c.gi().DrawTextEx(this.iX+this.iW/2,this.iY+20,_h.sName,4294967295,25,101,1,1,0,-2,0),c.gi().DrawTextEx(this.iX+this.iW/2,this.iY+20+30,""+_h.iRid,4294967295,25,101,1,1,0,-2,0),i=0;i<4;i++)this.btn_team[i].Move(this.iX+20,this.iY+20+30+30+60*i,110,52),this.btn_team[i].Draw()}ProcTouch(i,t,s){var e;for(e=0;e<4;e++)if(this.btn_team[e].ProcTouch(i,t,s)&&this.btn_team[e].bCheck()){if(Mh.gi().s_FriendOperate(2,_h.iRid,e),3==e){var h=FriendList.gi().FindFriend(_h.iRid);null!=h&&(h.bUseing=!1),FriendList.gi().SortFriends()}ln.gi().PopStat(1)}return 3!=i||bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||ln.gi().PopStat(1),!0}}_h.sName,_h.iRid,_h.Open=function(i,t){_h.sName=i,_h.iRid=t,ln.gi().PushStat(ln.GS_FRIENDTEAM)};class fh{constructor(){}copyfrom(i){this.iRid=i.iRid,this.sName=i.sName,this.iRax=i.iRax}}class uh{constructor(){var i;for(this.pm3f=c.gi(),this.bShow=!1,this.btn_section=new Array(3),this.btn_mpl=new Array(3),i=0;i<3;i++)this.btn_section[i]=new D(gn.xani_nui3),this.btn_section[i].InitButton("分类标签按钮"),this.btn_mpl[i]=new D(gn.xani_nui3),this.btn_mpl[i].InitButton("分组标签按钮");for(this.btn_mpl[0].sName="密",this.btn_mpl[1].sName="普",this.btn_mpl[2].sName="临",this.btn_operate=new Array(4),i=0;i<4;i++)this.btn_operate[i]=new D(gn.xani_nui3),this.btn_operate[i].InitButton("好友功能按钮");for(this.iSectPoint=1,this.iScrollOff=0,this.iNameSize=24,this.iSelectPoint=-1,this.friends=new Array(uh.MAXFRIEND),i=0;i<uh.MAXFRIEND;i++)this.friends[i]=new ch;for(this.iOnLineFriendCount=0,this.iOffLineFriendCount=0,this.iBlackFriendCount=0,this.btn_chat0=new Eh(gn.xani_icon),this.btn_chat0.InitButton("好友功能按钮"),this.btn_chat0.bCheckByRect=!0,this.btn_chat1=new Eh(gn.xani_icon),this.btn_chat1.InitButton("好友功能按钮"),this.btn_chat1.bCheckByRect=!0,this.bOpening=!1,this.bCloseing=!1,this.iModifyX=0,this.bLocked=!1,this.bDrag=!1,this.iModifyY=0,this.iDragDelay=0,this.iOffY=0,this.iF1Count=0,this.iF2Count=0,this.iF3Count=0,this.iF4Count=0,this.tmpchat=new Array(uh.MAXTEMPCHAT),i=0;i<uh.MAXTEMPCHAT;i++)this.tmpchat[i]=new fh,this.tmpchat[i].iRid=0}Draw(){var i,t,s;if(!Ih.gi().vbk.mapdialog.bHideUI()&&!xs.jq.bJQLock()){var e;if(this.iW=200,this.iH=h.SCRH-20,this.iX=h.SCRW-this.iW,this.iY=(h.SCRH-this.iH)/2,fn.gi().iBx>0&&(this.iY=fn.gi().iBy+fn.gi().iBh,this.iH=h.SCRH-this.iY-10),this.iCbx=h.SCRW-80,ws.bFighting&&ws.gi().iAlphaEffect>=h.SCRW?this.iCby=h.SCRH-80-340:this.iCby=h.SCRH-80-255-5,this.bOpening&&(this.iModifyX+=this.iW/4,this.iModifyX>=this.iW&&(this.iModifyX=this.iW,this.bOpening=!1)),this.bCloseing&&(this.iModifyX-=this.iW/4,this.iModifyX<0&&(this.iModifyX=0,this.bCloseing=!1,this.bShow=!1)),this.bPrivateChatFlash&&(this.bPrivateChatFlash=dh.gi().bHaveUnWatched()),this.bShow?(this.btn_chat1.Move(this.iCbx-this.iModifyX,this.iCby,72,72),this.bPrivateChatFlash&&parseInt(gn.iDelay/2)%2==0&&this.btn_chat1.Move(this.iCbx-this.iModifyX+2,this.iCby+2,72,72),this.btn_chat1.Draw(),c.gi().DrawText_2(this.btn_chat1.iX+36,this.btn_chat1.iY+80,"好友",4294833640,22,101,1,1,0,-2,-3,3,4279894016)):(this.btn_chat0.Move(this.iCbx-this.iModifyX,this.iCby,72,72),this.bPrivateChatFlash&&parseInt(gn.iDelay/2)%2==0&&this.btn_chat0.Move(this.iCbx-this.iModifyX+2,this.iCby+2,72,72),this.btn_chat0.Draw(),c.gi().DrawText_2(this.btn_chat0.iX+36,this.btn_chat0.iY+80,"好友",4294833640,22,101,1,1,0,-2,-3,3,4279894016)),this.bShow){var a,n,o,r;for(this.iX=h.SCRW-this.iModifyX,E.new_framepc(this.iX,this.iY,this.iW,this.iH),i=0;i<3;i++)switch(a=this.iX+5,n=i<=this.iSectPoint?this.iY+5+45*i:this.iY+this.iH-135+45*i,this.btn_section[i].Move(a,n,190,40),this.btn_section[i].Draw(),i==this.iSectPoint?gn.xani_nui3.DrawAnima(a+4,n+10,"打开关闭小箭头",1):gn.xani_nui3.DrawAnima(a+4+6,n+4,"打开关闭小箭头",0),c.gi().DrawTextEx(a+50,n+20,uh.btnstr[i],4294967295,30,100,1,1,0,0,-2),i){case 0:c.gi().DrawTextEx(a+185,n+20,""+rh.gameing.iNearRoleCount,4294967295,30,100,1,1,0,-3,-2);break;case 1:c.gi().DrawTextEx(a+185,n+20,""+(this.iF1Count+this.iF2Count+this.iF3Count),4294967295,30,100,1,1,0,-3,-2);break;case 2:c.gi().DrawTextEx(a+185,n+20,""+this.iF4Count,4294967295,30,100,1,1,0,-3,-2)}switch(this.iOx=this.iX+5,this.iOy=this.iY+5+45*(this.iSectPoint+1),this.iDx=this.iOx+190,this.iDy=this.iY+this.iH-135+45*(this.iSectPoint+1)-5,this.pm3f.SetViewClip(this.iOx-60,this.iOy-3,this.iDx,this.iDy),this.iOy+=this.iModifyY+this.iOffY,t=0,this.bSelected=!1,this.iSectPoint){case 0:for(t=0,i=0;i<rh.iNearMax;i++)rh.gameing.nrs[i].bUseing&&(o=this.iOx,r=this.iOy+40*t,this.iSelectPoint==t&&(gn.xani_nui3.DrawAnima(o,r-1,"选中好友",0),this.bSelected=!0,this.iSelectX=o,this.iSelectY=r,this.iSelectRid=rh.gameing.nrs[i].iRid,this.sSelectName=rh.gameing.nrs[i].sName,this.iSelectRax=2*rh.gameing.nrs[i].iRace+rh.gameing.nrs[i].iSex,this.iGoX=rh.gameing.nrs[i].iX,this.iGoY=rh.gameing.nrs[i].iY,this.iSBCount=3,this.btn_operate[0].sName="查看",this.btn_operate[1].sName="前往",this.btn_operate[2].sName="攻击"),gn.xani_nui3.DrawAnima(o,r,"小头像",2*rh.gameing.nrs[i].iRace+rh.gameing.nrs[i].iSex),this.pm3f.DrawTextEx(o+42,r+20,rh.gameing.nrs[i].sName,4294967295,this.iNameSize,101,1,1,0,0,-2),t++);break;case 1:for(i=0;i<3;i++)uh.iMplPoint==i&&(this.btn_mpl[i].bMouseDown=!0,this.btn_mpl[i].bMouseIn=!0),this.btn_mpl[i].Move(this.iOx+63*i,this.iOy-(this.iModifyY+this.iOffY)-3,62,50),this.btn_mpl[i].Draw();if(this.iOy+=50,this.pm3f.SetViewClip(this.iOx-60,this.iOy-(this.iModifyY+this.iOffY)-3,this.iDx,this.iDy),0==uh.iMplPoint){for(i=0;i<this.iF1Count;i++)o=this.iOx,r=this.iOy+40*i,e=this.friends[this.flist1[i]],this.iSelectPoint==i&&(gn.xani_nui3.DrawAnima(o,r-1,"选中好友",0),this.bSelected=!0,this.iSelectX=o,this.iSelectY=r,this.iSelectRid=e.iRid,this.sSelectName=e.sName,this.iSelectRax=e.iImportant%100,e.bOnLine?this.iSBCount=4:this.iSBCount=3,this.btn_operate[0].sName="发送",this.btn_operate[1].sName="记录",this.btn_operate[2].sName="分组",this.btn_operate[3].sName="查看"),gn.xani_nui3.DrawAnima(o,r,"小头像",e.iImportant%100),this.pm3f.DrawTextEx(o+42,r+20,e.sName,e.bOnLine?4294967295:4288716960,this.iNameSize,101,1,1,0,0,-2);t=this.iF1Count}if(1==uh.iMplPoint){for(i=0;i<this.iF2Count;i++)o=this.iOx,r=this.iOy+40*i,e=this.friends[this.flist2[i]],this.iSelectPoint==i&&(gn.xani_nui3.DrawAnima(o,r-1,"选中好友",0),this.bSelected=!0,this.iSelectX=o,this.iSelectY=r,this.iSelectRid=e.iRid,this.sSelectName=e.sName,this.iSelectRax=e.iImportant%100,e.bOnLine?this.iSBCount=4:this.iSBCount=3,this.btn_operate[0].sName="发送",this.btn_operate[1].sName="记录",this.btn_operate[2].sName="分组",this.btn_operate[3].sName="查看"),gn.xani_nui3.DrawAnima(o,r,"小头像",e.iImportant%100),this.pm3f.DrawTextEx(o+42,r+20,e.sName,e.bOnLine?4294967295:4288716960,this.iNameSize,101,1,1,0,0,-2);t=this.iF2Count}if(2==uh.iMplPoint){for(i=0;i<this.iF3Count;i++)o=this.iOx,r=this.iOy+40*i,this.iSelectPoint==i&&(gn.xani_nui3.DrawAnima(o,r-1,"选中好友",0),this.bSelected=!0,this.iSelectX=o,this.iSelectY=r,this.iSelectRid=this.tmpchat[i].iRid,this.sSelectName=this.tmpchat[i].sName,this.iSelectRax=this.tmpchat[i].iRax,this.iSBCount=4,this.btn_operate[0].sName="发送",this.btn_operate[1].sName="记录",this.btn_operate[2].sName="分组",this.btn_operate[3].sName="查看"),this.pm3f.DrawTextEx(o+2,r+20,this.tmpchat[i].sName,4294967295,this.iNameSize,101,1,1,0,0,-2);t=this.iF3Count}this.pm3f.NoClip();break;case 2:for(i=0;i<this.iF4Count;i++)o=this.iOx,r=this.iOy+40*i,e=this.friends[this.flist4[i]],this.iSelectPoint==i&&(gn.xani_nui3.DrawAnima(o,r-1,"选中好友",0),this.bSelected=!0,this.iSelectX=o,this.iSelectY=r,this.iSelectRid=e.iRid,this.sSelectName=e.sName,this.iSBCount=1,this.btn_operate[0].sName="分组"),gn.xani_nui3.DrawAnima(o,r,"小头像",e.iImportant%100),this.pm3f.DrawTextEx(o+42,r+20,e.sName,e.bOnLine?4294967295:4288716960,this.iNameSize,101,1,1,0,0,-2);t=this.iF4Count}if(this.iOy-=this.iModifyY+this.iOffY,this.pm3f.NoClip(),this.bSelected)for(this.iSelectY>h.SCRH-51*this.iSBCount&&(this.iSelectY=h.SCRH-51*this.iSBCount),i=0;i<4;i++)i<this.iSBCount?(this.btn_operate[i].Move(this.iSelectX-80,this.iSelectY+51*i,80,51),this.btn_operate[i].Draw()):this.btn_operate[i].Move(0,0,0,0);this.iSelectCount=t,(s=40*t-(this.iDy-this.iOy))<0&&(s=0),0!=this.iDragDelay?(this.iDragDelay=this.iDragDelay/2,this.iDragDelay>10||this.iDragDelay<-10?this.iOffY+=this.iDragDelay:this.iDragDelay=0):this.iOffY<-s?(i=(-s-this.iOffY)/2)>10?this.iOffY+=i:this.iOffY=-s:this.iOffY>0&&((i=this.iOffY/2)>10?this.iOffY-=i:this.iOffY=0),this.bDrag&&this.iDragTime++}}}Close(){this.bCloseing=!0,this.bOpening=!1}ProcTouch(i,t,s){var e,h,a;if(a=this.bShow?this.btn_chat1:this.btn_chat0,!this.bShow)return!!a.ProcTouch(i,t,s)&&(a.bCheck()&&(this.bPrivateChatFlash?dh.gi().ShowMessage():uh.gi().bShow?this.Close():(this.bShow=!0,this.bCloseing=!1,this.bOpening=!0,this.iModifyX=0)),!0);switch(i){case 2:if(this.bLocked&&(this.iDragY=s,this.iModifyY=this.iDragY-this.iLockY,(e=this.iOffY+this.iModifyY)>0&&(this.iModifyY-=e/2,this.iDragTime=10),(h=40*this.iSelectCount-(this.iDy-this.iOy))<0&&(h=0),e<-h&&(this.iModifyY-=(e+h)/2,this.iDragTime=10),this.iModifyY>15||this.iModifyY<-15))return this.bDrag=!0,this.iSelectPoint=-1,!0;break;case 3:if(this.bLocked=!1,this.bDrag)return this.iOffY+=this.iModifyY,this.iDragTime<=0&&(this.iDragTime=1),this.iDragTime<5&&(this.iDragDelay=3*this.iModifyY/this.iDragTime),gn.sop("this.iDragDelay="+this.iDragDelay),this.iModifyY=0,this.bDrag=!1,!0}for(e=0;e<3;e++)if(this.btn_section[e].ProcTouch(i,t,s))return this.btn_section[e].bCheck()&&(this.iSectPoint==e?this.iSectPoint=10:this.iSectPoint=e,this.iScrollOff=0,this.iOffY=0,this.iSelectPoint=-1),!0;if(1==this.iSectPoint)for(e=0;e<3;e++)this.btn_mpl[e].ProcTouch(i,t,s)&&this.btn_mpl[e].bCheck()&&(uh.iMplPoint=e);if(this.bSelected)for(e=0;e<this.iSBCount;e++)if(this.btn_operate[e].ProcTouch(i,t,s))return this.btn_operate[e].bCheck()&&(0==this.iSectPoint&&(0==e&&Mh.gi().s_WatchOn(0,this.iSelectRid,0,""),1==e&&0==this.iSectPoint&&(ct.gi().bSelling?L.easymsg.AddMessage("摆摊中不能行走"):(H.bNoTeam()||H.bTeamLeader()||H.bAway())&&Ih.gi().mfy.findway(xh.me.iX,xh.me.iY,this.iGoX,this.iGoY)&&(gn.sop("check again start"),Ih.gi().mfy.checkagain()?(Ih.gi().vbk.iGoToNpcFlag=-1,Ih.gi().vbk.iGoToNpcId=-1,xh.me.start(Ih.gi().mfy.iPath,Ih.gi().mfy.iPathDeep)):gn.sop("check again end2"))),2==e&&Mh.gi().s_PK(this.iSelectRid)),1==this.iSectPoint&&(0==e&&dt.OpenChat(this.iSelectRid,this.sSelectName,this.iSelectRax),1==e&&bh.OpenRecord(this.iSelectRid,this.sSelectName,this.iSelectRax),2==e&&_h.Open(this.sSelectName,this.iSelectRid),3==e&&Mh.gi().s_WatchOn(0,this.iSelectRid,0,"")),2==this.iSectPoint&&0==e&&_h.Open(this.sSelectName,this.iSelectRid),this.iSelectPoint=-1),!0;if(this.iSelectPoint=-1,bn.bInRect(t,s,this.iOx,this.iOy,this.iDx-this.iOx,this.iDy-this.iOy)){switch(i){case 1:this.bLocked||(this.bLocked=!0,this.iLockY=s,this.iModifyY=0,this.iDragTime=0,this.iDragDelay=0)}for(this.iSelectPoint=-1,e=0;e<this.iSelectCount;e++)bn.bInRect(t,s,this.iOx,this.iOy+this.iOffY+40*e,this.iW-10,40)&&(this.iSelectPoint=e)}return a.ProcTouch(i,t,s)?(a.bCheck()&&(this.bPrivateChatFlash?dh.gi().ShowMessage():uh.gi().bShow?this.Close():(this.bShow=!0,this.bCloseing=!1,this.bOpening=!0,this.iModifyX=0)),!0):!!bn.bInRect(t,s,this.iX,this.iY,this.iW+10,this.iH+1)}GetFreeFriendOle(){var i;for(i=0;i<uh.MAXFRIEND;i++)if(!this.friends[i].bUseing)return this.friends[i];return null}FindFriend(i){var t;for(t=0;t<uh.MAXFRIEND;t++)if(this.friends[t].bUseing&&this.friends[t].iRid==i)return this.friends[t];return null}Clean(){var i;for(i=0;i<uh.MAXFRIEND;i++)this.friends[i].bUseing=!1;this.SortFriends()}GetFriends(i){for(var t,s,e;0!=(s=i.GetNextByte())&&(t=i.GetNextInt(),null==(e=this.FindFriend(t))&&(e=this.GetFreeFriendOle()),null!=e);)e.bOnLine=0!=(2&s),e.iRid=t,e.sName=i.GetNextString(),e.iRelation=i.GetNextByte(),e.iAmity=i.GetNextShort(),e.iTeam=i.GetNextByte(),e.iImportant=i.GetNextByte(),e.bUseing=!0;this.SortFriends()}SortFriends(){var i;for(null==this.flist1&&(this.flist1=new Int32Array(uh.MAXFRIEND)),null==this.flist2&&(this.flist2=new Int32Array(uh.MAXFRIEND)),null==this.flist4&&(this.flist4=new Int32Array(uh.MAXFRIEND)),this.iF1Count=0,this.iF2Count=0,this.iF4Count=0,i=0;i<uh.MAXFRIEND;i++)this.friends[i].bUseing&&(0==this.friends[i].iTeam&&this.friends[i].bOnLine&&(this.flist1[this.iF1Count]=i,this.iF1Count++),1==this.friends[i].iTeam&&this.friends[i].bOnLine&&(this.flist2[this.iF2Count]=i,this.iF2Count++),3==this.friends[i].iTeam&&this.friends[i].bOnLine&&(this.flist4[this.iF4Count]=i,this.iF4Count++));for(i=0;i<uh.MAXFRIEND;i++)this.friends[i].bUseing&&(0!=this.friends[i].iTeam||this.friends[i].bOnLine||(this.flist1[this.iF1Count]=i,this.iF1Count++),1!=this.friends[i].iTeam||this.friends[i].bOnLine||(this.flist2[this.iF2Count]=i,this.iF2Count++),3!=this.friends[i].iTeam||this.friends[i].bOnLine||(this.flist4[this.iF4Count]=i,this.iF4Count++))}DelTmpChat(i){var t,s;for(t=0;t<uh.MAXTEMPCHAT;t++)if(this.tmpchat[t].iRid==i){for(s=t;s<uh.MAXTEMPCHAT-1;s++)this.tmpchat[s].iRid=this.tmpchat[s+1].iRid,this.tmpchat[s].sName=this.tmpchat[s+1].sName,this.tmpchat[s].iRax=this.tmpchat[s+1].iRax;return void(this.iF3Count>0&&this.iF3Count--)}}AddTmpChat(i,t,s){var e,h;for(e=0;e<uh.MAXTEMPCHAT;e++)if(this.tmpchat[e].iRid==i){for(h=e;h>0;h--)this.tmpchat[h].copyfrom(this.tmpchat[h-1]);return this.tmpchat[0].iRid=i,this.tmpchat[0].sName=t,void(this.tmpchat[0].iRax=s)}for(h=uh.MAXTEMPCHAT-1;h>0;h--)this.tmpchat[h].copyfrom(this.tmpchat[h-1]);this.tmpchat[0].iRid=i,this.tmpchat[0].sName=t,this.tmpchat[0].iRax=s,this.iF3Count<uh.MAXTEMPCHAT&&this.iF3Count++}}uh.MAXFRIEND=128,uh.iMplPoint=0,uh.MAXTEMPCHAT=16,uh.btnstr=["附近","好友","黑名单"],uh.flist=null,uh.gi=function(){return null==uh.flist&&(uh.flist=new uh),uh.flist};class dh{constructor(){var i;for(this.pm3f=c.gi(),this.pms=new Array(dh.MAXMESSAGE),i=0;i<dh.MAXMESSAGE;i++)this.pms[i]=new U;this.iMessageCount=0,this.bShow=!1,this.iW=550,this.iH=360,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2-50,this.btn_record=new Eh(gn.xani_button),this.btn_record.Move(this.iX+this.iW-25-90,this.iY+25,90,60),this.btn_record.InitButton("发送聊天按钮"),this.btn_record.sName="记录",this.btn_watch=new Eh(gn.xani_button),this.btn_watch.Move(this.iX+this.iW-25-90-10-90,this.iY+25,90,60),this.btn_watch.InitButton("发送聊天按钮"),this.btn_watch.sName="查看",this.btn_reply=new Eh(gn.xani_button),this.btn_reply.Move(this.iX+this.iW-25-90,this.iY+this.iH-60-25,90,60),this.btn_reply.InitButton("发送聊天按钮"),this.btn_reply.sName="回复"}GetPrivateMessage(i){var t;for(gn.sop("aaaaaaaaaaaaaaaaa"+this.iMessageCount),this.iMessageCount>=dh.MAXMESSAGE&&(this.iMessageCount=dh.MAXMESSAGE-1),t=this.iMessageCount;t>0;t--)this.pms[t]=this.pms[t-1];for(this.pms[0]=new U,this.pms[0].iSession=i.GetNextInt(),this.pms[0].iRid=i.GetNextInt(),this.pms[0].sName=i.GetNextString(),this.pms[0].iRax=i.GetNextByte(),this.pms[0].iFlag=i.GetNextByte(),this.pms[0].iDRid=i.GetNextInt(),this.pms[0].sTime=i.GetNextString(),this.pms[0].sDetail=i.GetNextString(),this.pms[0].exts[0].type=3,this.pms[0].exts[0].eid=this.pms[0].iRid,t=1;t<5;t++)if(i.iOffset>=i.iLength)this.pms[0].exts[t].type=100;else switch(this.pms[0].exts[t].type=i.GetNextByte(),this.pms[0].exts[t].type){case 0:case 1:case 4:this.pms[0].exts[t].eid=i.GetNextInt(),this.pms[0].exts[t].tid=i.GetNextShort();break;case 2:this.pms[0].exts[t].eid=i.GetNextInt(),this.pms[0].exts[t].name=i.GetNextString(),this.pms[0].exts[t].detail=i.GetNextString()}this.pms[0].iRid==xh.me.iRid?(this.pms[0].bFriend=!1,this.pms[0].bWatched=!0,gn.x_record.SavePrivateChat(),gn.sop("bbbbbbbbb")):(null==uh.gi().FindFriend(this.pms[0].iRid)?this.pms[0].bFriend=!1:this.pms[0].bFriend=!0,this.pms[0].bWatched=!1,uh.gi().AddTmpChat(this.pms[0].iRid,this.pms[0].sName,this.pms[0].iRax),uh.gi().bPrivateChatFlash=!0,gn.sop("cccccccccccc")),this.iMessageCount++}ShowMessage(){var i;for(i=this.iMessageCount-1;i>=0&&0!=this.pms[i].bWatched;i--);i>=0&&(0==ph.iPrivateChatMode?(this.showpms=this.pms[i],Mh.gi().s_ReviewPrivateChat(this.pms[i].iSession),this.pms[i].bWatched=!0,gn.x_record.SavePrivateChat(),this.bShow=!0):dt.OpenChat(this.pms[i].iRid,this.pms[i].sName,this.pms[i].iRax))}bHaveUnWatched(){for(var i=0;i<this.iMessageCount;i++)if(0==this.pms[i].bWatched)return!0;return!1}Draw(){if(this.bShow){var i=0;if(!this.showpms.bFriend){var t=gn.iDelay%20;i=25*(t>=10?20-t:t)<<24|16711680,c.gi().FillRect_2D(this.iX-10,this.iY-10,this.iX+this.iW+10,this.iY+this.iH+10,i)}E.frame_type4("中等框a52_50",this.iX,this.iY,this.iW,this.iH,52,50),E.frame_type4("聊天显示框亮20_20",this.iX+25,this.iY+25+60+10,this.iW-50,this.iH-25-60-10-25-60-10,20,20),gn.xani_head.DrawAnimaEx(this.iX+25,this.iY+25,"新头像"+this.showpms.iRax,0,101,.75,.75,0,0,0),c.gi().DrawTextEx(this.iX+25+65,this.iY+25,"名字:"+this.showpms.sName,4278190080,30,101,1,1,0,0,0),c.gi().DrawTextEx(this.iX+25+65,this.iY+25+35+5,"号码:"+this.showpms.iRid,4278190080,25,101,1,1,0,0,0),this.pm3f.DrawTextEx(this.iX+25,this.iY+this.iH-25-30,""+this.showpms.sTime,4278190080,30,101,1,1,0,0,-2),this.btn_record.Draw(),this.btn_watch.Draw(),this.btn_reply.Draw(),this.DrawPms(this.iX+25,this.iY+25+60+10)}}DrawPms(i,t){var s,h="#c176b51"+this.showpms.sDetail;for(s=1;s<5;s++)switch(this.showpms.exts[s].type){case 0:h=Y.gi().InsertLocker(s,h,"["+gn.de_goods.strValue(this.showpms.exts[s].tid,0,4)+"]",e.EXTCOLOR,"#c00c000");break;case 1:h=Y.gi().InsertLocker(s,h,"["+gn.de_pet.strValue(this.showpms.exts[s].tid,0,1)+"]",e.EXTCOLOR,"#c00c000");break;case 2:h=Y.gi().InsertLocker(s,h,"[语音:"+this.showpms.exts[s].detail+"]",e.EXTCOLOR,"#c00c000");break;case 4:h=Y.gi().InsertLocker(s,h,"[申请入队]",e.EXTCOLOR,"#c00c000")}for(Y.gi().Format(h,this.iW-50-30,yh.WordSize(24)),Y.gi().CheckOutRect(),s=1;s<5;s++)switch(this.showpms.exts[s].type){case 0:case 1:case 2:case 3:case 4:this.showpms.lrs_small[s].CopyFrom(Y.gi().lrs[s])}this.showpms.ox=i+15,this.showpms.oy=t+10,this.showpms.ow=Y.gi().iW,this.showpms.oh=Y.gi().iH,this.DrawSelect(i+15,t+10),Y.gi().Draw(i+15,t+10)}DrawSelect(i,t){var s;for(s=1;s<5;s++)switch(this.showpms.exts[s].type){case 0:case 1:case 2:if(this.showpms.lrs_small[s].CopyFrom(Y.gi().lrs[s]),this.showpms.exts[s].iShowDelay>0){for(var e=0;e<this.showpms.lrs_small[s].iCount;e++){var h=i+this.showpms.lrs_small[s].rs[e].iX,a=t+this.showpms.lrs_small[s].rs[e].iY,n=i+this.showpms.lrs_small[s].rs[e].iX+this.showpms.lrs_small[s].rs[e].iW,o=t+this.showpms.lrs_small[s].rs[e].iY+this.showpms.lrs_small[s].rs[e].iH;c.gi().FillRect_2D(h,a,n,o,16711935|this.showpms.exts[s].iShowDelay<<24)}this.showpms.exts[s].iShowDelay>200?this.showpms.exts[s].iShowDelay-=3:this.showpms.exts[s].iShowDelay>150?this.showpms.exts[s].iShowDelay-=6:this.showpms.exts[s].iShowDelay>100?this.showpms.exts[s].iShowDelay-=9:this.showpms.exts[s].iShowDelay>50?this.showpms.exts[s].iShowDelay-=12:this.showpms.exts[s].iShowDelay=0}}}ProcTouch(i,t,s){if(!this.bShow)return!1;if(bn.bInRect(t,s,this.showpms.ox,this.showpms.oy,this.showpms.ow,this.showpms.oh))for(j=1;j<5;j++)if(!(this.showpms.exts[j].type>=100)&&!(this.showpms.exts[j].iShowDelay>0)&&this.showpms.lrs_small[j].bIn(t-this.showpms.ox,s-this.showpms.oy))switch(this.showpms.exts[j].type){case 0:Mh.gi().s_WatchOn(1,this.showpms.exts[j].eid,0,""),this.showpms.exts[j].iShowDelay=255;break;case 1:Mh.gi().s_WatchOn(2,this.showpms.exts[j].eid,0,""),this.showpms.exts[j].iShowDelay=255;break;case 2:gn.m_vi.PlayUrlVoice(this.showpms.exts[j].name),this.showpms.exts[j].iShowDelay=255;break;case 4:H.bInTeam()?L.easymsg.AddMessage("已有队伍"):Mh.gi().s_TeamOperate(3,this.showpms.exts[j].eid,0),this.showpms.exts[j].iShowDelay=255}return this.btn_watch.ProcTouch(i,t,s)&&this.btn_watch.bCheck()&&Mh.gi().s_WatchOn(0,this.showpms.iRid,0,""),this.btn_record.ProcTouch(i,t,s)&&this.btn_record.bCheck()&&(ph.iPrivateChatMode=1,dt.OpenChat(this.showpms.iRid,this.showpms.sName,this.showpms.iRax),this.bShow=!1),this.btn_reply.ProcTouch(i,t,s)&&this.btn_reply.bCheck()&&(dt.OpenChat(this.showpms.iRid,this.showpms.sName,this.showpms.iRax),this.bShow=!1),3!=i||bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||(this.bShow=!1),!0}}dh.pp=null,dh.gi=function(){return null==dh.pp&&(dh.pp=new dh),dh.pp},dh.MAXMESSAGE=1024;class ph{constructor(i){var t;for(this.pls=new u(524288),this.v=0,this.iUserCount=0,this.sUser=new Array(5),this.sPass=new Array(5),t=0;t<5;t++)this.sUser[t]="",this.sPass[t]="";for(ph.iGuideFlags=new Int32Array(16),t=0;t<16;t++)ph.iGuideFlags[t]=0;ph.iExtHelp=1,ph.iQQSay=0}SaveTo(i){var t;for(this.pls.iOffset=0,this.pls.InsertByte(this.v),this.pls.InsertByte(this.iUserCount),t=0;t<this.iUserCount;t++)this.pls.InsertString(this.sUser[t]),this.pls.InsertString(this.sPass[t]);for(this.bSaveUser?this.pls.InsertByte(1):this.pls.InsertByte(0),this.bSavePass?this.pls.InsertByte(1):this.pls.InsertByte(0),t=0;t<16;t++)this.pls.InsertInt(ph.iGuideFlags[t]);yh.bShowName?this.pls.InsertByte(0):this.pls.InsertByte(1),yh.bShowRole?this.pls.InsertByte(0):this.pls.InsertByte(1),yh.bShowSell?this.pls.InsertByte(0):this.pls.InsertByte(1),this.pls.InsertByte(yh.iNearRoleCount),this.pls.InsertByte(yh.iPictureQuality),this.pls.InsertByte(yh.iPictureBuffer),this.pls.InsertByte(yh.iRenderType),gn.bCheckRes?this.pls.InsertByte(1):this.pls.InsertByte(0),this.pls.InsertByte(yh.iMusic),this.pls.InsertByte(yh.iSound),this.pls.InsertByte(ph.iHaveSeverRecord),this.pls.InsertInt(ph.iLastSector),this.pls.InsertInt(ph.iLastSever),this.pls.InsertByte(yh.iWheel),this.pls.InsertInt(yh.iSameRate),this.pls.InsertInt(yh.iScreenLS),(yh.iScreenLS<0||yh.iScreenLS>400)&&(yh.iScreenLS=0),this.pls.InsertInt(ph.iClientID),this.pls.InsertInt(ph.iExtHelp),this.pls.InsertInt(ph.iQQSay),yh.bShowMount?this.pls.InsertByte(0):this.pls.InsertByte(1),yh.bShowWeapon?this.pls.InsertByte(0):this.pls.InsertByte(1),yh.bShowColor?this.pls.InsertByte(0):this.pls.InsertByte(1),yh.bShowFollow?this.pls.InsertByte(0):this.pls.InsertByte(1),yh.bShowTitle?this.pls.InsertByte(0):this.pls.InsertByte(1),this.pls.InsertInt(ph.iPublicVoiceShow),this.pls.InsertByte(ph.iPrivateChatMode),this.pls.InsertInt(ph.iFilterChannel),this.pls.InsertInt(ph.iAutoPlay),this.pls.InsertInt(ph.iFastVoice),this.pls.iLength=this.pls.iOffset,this.pls.JS_DataToLocal(i),bn.sop("SaveTo 1"+yh.iMusic+","+yh.iSound)}ReadFrom(i){var t;if(bn.sop("ReadFrom 1"),this.pls.JS_DataFromLocal(i)||(console.log("初始存储数据"),ph.iFirstOpen=!0,this.SaveTo(i),this.pls.JS_DataFromLocal(i))){for(bn.sop("ReadFrom 3"),this.v=this.pls.GetNextByte(),this.iUserCount=this.pls.GetNextByte(),t=0;t<this.iUserCount;t++)this.sUser[t]=this.pls.GetNextString(),this.sPass[t]=this.pls.GetNextString();for(0==this.pls.GetNextByte()?this.bSaveUser=!1:this.bSaveUser=!0,0==this.pls.GetNextByte()?this.bSavePass=!1:this.bSavePass=!0,t=0;t<16;t++)ph.iGuideFlags[t]=this.pls.GetNextInt();0==this.pls.GetNextByte()?yh.bShowName=!0:yh.bShowName=!1,0==this.pls.GetNextByte()?yh.bShowRole=!0:yh.bShowRole=!1,0==this.pls.GetNextByte()?yh.bShowSell=!0:yh.bShowSell=!1,yh.iNearRoleCount=this.pls.GetNextByte(),yh.iNearRoleCount=25,yh.iPictureQuality=this.pls.GetNextByte(),yh.iPictureQuality=1,yh.iPictureBuffer=this.pls.GetNextByte(),yh.iPictureBuffer=50,yh.iRenderType=this.pls.GetNextByte(),yh.iRenderType=1,yh.iNearRoleCount<5&&(yh.iNearRoleCount=5),t=h.SYSW<=800?10:h.SYSW<1280?25:1280==h.SYSW?40:50,1==this.pls.GetNextByte()?(gn.bCheckRes=!0,yh.iNearRoleCount>20?yh.iNearRoleCount-=10:yh.iNearRoleCount=10):gn.bCheckRes=!1,ph.iFirstOpen&&(yh.iPictureBuffer=t),yh.iMusic=this.pls.GetNextByte(),yh.iSound=this.pls.GetNextByte(),ph.iHaveSeverRecord=this.pls.GetNextByte(),ph.iLastSector=this.pls.GetNextInt(),ph.iLastSever=this.pls.GetNextInt(),yh.iWheel=this.pls.GetNextByte(),yh.iSameRate=this.pls.GetNextInt(),yh.iSameRate=0,yh.iScreenLS=this.pls.GetNextInt(),h.SYSW>=1280?yh.iScreenLS=192e3/(h.SYSW-800):yh.iScreenLS=400*(h.SYSW-800)/480,ph.iClientID=this.pls.GetNextInt(),ph.iExtHelp=this.pls.GetNextInt(),ph.iQQSay=this.pls.GetNextInt(),0==this.pls.GetNextByte()?yh.bShowMount=!0:yh.bShowMount=!1,0==this.pls.GetNextByte()?yh.bShowWeapon=!0:yh.bShowWeapon=!1,0==this.pls.GetNextByte()?yh.bShowColor=!0:yh.bShowColor=!1,0==this.pls.GetNextByte()?yh.bShowFollow=!0:yh.bShowFollow=!1,0==this.pls.GetNextByte()?yh.bShowTitle=!0:yh.bShowTitle=!1,0==yh.iPictureQuality?yh.iPictureBuffer=50:1==yh.iPictureQuality?yh.iPictureBuffer=25:yh.iPictureBuffer=0,ph.iPublicVoiceShow=this.pls.GetNextInt(),ph.iPrivateChatMode=this.pls.GetNextByte(),this.pls.iOffset>=this.pls.iLength?ph.iFilterChannel=255:ph.iFilterChannel=this.pls.GetNextInt(),this.pls.iOffset>=this.pls.iLength?ph.iAutoPlay=0:ph.iAutoPlay=this.pls.GetNextInt(),this.pls.iOffset>=this.pls.iLength?ph.iFastVoice=3:ph.iFastVoice=this.pls.GetNextInt()}else bn.sop("ReadFrom 2")}SavePrivateChat(){var i,t,s=dh.gi();for(this.pls.iOffset=0,i=0;i<s.iMessageCount;i++)if(s.pms[i].bWatched)for(this.pls.InsertInt(s.pms[i].iRid),this.pls.InsertString(s.pms[i].sName),this.pls.InsertByte(s.pms[i].iRax),this.pls.InsertInt(s.pms[i].iDRid),this.pls.InsertString(s.pms[i].sTime),this.pls.InsertString(s.pms[i].sDetail),t=1;t<5;t++)switch(this.pls.InsertByte(s.pms[i].exts[t].type),s.pms[i].exts[t].type){case 0:case 1:this.pls.InsertInt(s.pms[i].exts[t].eid),this.pls.InsertShort(s.pms[i].exts[t].tid);break;case 2:this.pls.InsertInt(s.pms[i].exts[t].eid),this.pls.InsertString(s.pms[i].exts[t].name),this.pls.InsertString(s.pms[i].exts[t].detail)}this.pls.InsertInt(123454321),this.pls.JS_DataFromLocal("recordchat_"+xh.me.iRid+".dat")}ReadPrivateChat(){if(this.pls.JS_DataFromLocal("recordchat_"+xh.me.iRid+".dat")){var i,t,s=dh.gi();for(i=0;i<dh.MAXMESSAGE&&123454321!=(t=this.pls.GetNextInt());i++){for(s.pms[i].iRid=t,s.pms[i].sName=this.pls.GetNextString(),s.pms[i].iRax=this.pls.GetNextByte(),s.pms[i].iDRid=this.pls.GetNextInt(),s.pms[i].sTime=this.pls.GetNextString(),s.pms[i].sDetail=this.pls.GetNextString(),s.pms[i].exts[0].type=3,s.pms[i].exts[0].eid=s.pms[i].iRid,t=1;t<5;t++)switch(s.pms[i].exts[t].type=this.pls.GetNextByte(),s.pms[i].exts[t].type){case 0:case 1:s.pms[i].exts[t].eid=this.pls.GetNextInt(),s.pms[i].exts[t].tid=this.pls.GetNextShort();break;case 2:s.pms[i].exts[t].eid=this.pls.GetNextInt(),s.pms[i].exts[t].name=this.pls.GetNextString(),s.pms[i].exts[t].detail=this.pls.GetNextString()}s.pms[i].bWatched=!0,s.pms[i].iSession=0}s.iMessageCount=i}}}ph.iGuideFlags,ph.iExtHelp,ph.iQQSay,ph.iHaveSeverRecord=0,ph.iLastSector=0,ph.iLastSever=0,ph.iClientID=0,ph.sLastSeverName="",ph.iPublicVoiceShow=1,ph.iPrivateChatMode=0,ph.iFilterChannel=255,ph.iAutoPlay=0,ph.iFastVoice=3,ph.iFirstOpen=!1;class mh extends s{constructor(i){var t;for(super(),this.pani=i,this.pm3f=i.pm3f,this.iW=940,this.iH=555,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_switch=new Array(20),t=0;t<20;t++)this.btn_switch[t]=new D(gn.xani_nui3),this.btn_switch[t].InitButton("仓库按钮");this.btn_out=new D(gn.xani_nui2),this.btn_out.InitButton("按钮1_110"),this.btn_out.sName="取出",this.btn_in=new D(gn.xani_nui2),this.btn_in.InitButton("按钮1_110"),this.btn_in.sName="存入",this.iStorePoint=0}Draw(){var i,t,s;for(E.new_bigframe(this.iX,this.iY,this.iW,this.iH),t=this.iX+30,s=this.iY+30,i=0;i<13;i++){if(i==this.iStorePoint&&(this.btn_switch[i].bMouseDown=!0,this.btn_switch[i].bMouseIn=!0),this.btn_switch[i].Move(t+68*i,s,60,60),this.btn_switch[i].iNameColor=4278206039,!(i<mh.iStoreCount)){this.btn_switch[i].sName="开",this.btn_switch[i].Draw();break}this.btn_switch[i].sName=""+(i+1),this.btn_switch[i].Draw()}s+=80,this.iGx1=t,this.iGy1=s,qi.new_DrawGoods(t,s,ht.gi().goods[this.iStorePoint+10],null,null),null!=this.lockgoods1&&qi.new_DrawRect(t,s,ht.gi().goods[this.iStorePoint+10],this.lockgoods1,0),this.iGx2=t+430+20,this.iGy2=s,qi.new_DrawGoods(this.iGx2,s,ht.gi().goods[2],null,null),null!=this.lockgoods2&&qi.new_DrawRect(this.iGx2,s,ht.gi().goods[2],this.lockgoods2,0),s+=365,this.btn_out.Move(t+430-110,s-1,110,52),this.btn_out.Draw(),E.new_TagText2(t,s+9,150,"存银",""+xh.me.rbs.iStore),this.btn_in.Move(t+430+20+430-110,s,110,52),this.btn_in.Draw(),E.new_TagText2(t+430+20,s+9,150,"铜币",""+xh.me.rbs.iMoney),ei.end(ei.CONFIRM_BUYSTORE)&&ei.bConfirm&&Mh.gi().s_OpenStore(10,10*(mh.iStoreCount-mh.MAXFREESTORE+1),0),Zs.end(Zs.IN_IN)&&Zs.bOk&&Mh.gi().s_OpenStore(20,Zs.iNumber,0),Zs.end(Zs.IN_OUT)&&Zs.bOk&&Mh.gi().s_OpenStore(21,Zs.iNumber,0),qi.bShowDetail()&&qi.new_DrawDetail(null,-1,-1,0)}ProcTouch(i,t,s){var e;if(null==this.lockgoods1&&null==this.lockgoods2||null!=this.lockgoods1){if(this.lockgoods1=qi.new_LockGoods(t,s,this.iGx1,this.iGy1,ht.gi().goods[this.iStorePoint+10],i),qi.bCanProc()&&null!=this.lockgoods1)for(e=0;e<20;e++)if(ht.gi().goods[2][e].iGid<=0){ht.gi().MoveGoods(this.lockgoods1,ht.gi().goods[2][e]),this.lockgoods1=null;break}qi.bCanMove()&&null!=this.lockgoods1&&ht.gi().MoveGoods(this.lockgoods1,qi.swaplock)}if(null==this.lockgoods1&&null==this.lockgoods2||null!=this.lockgoods2){if(this.lockgoods2=qi.new_LockGoods(t,s,this.iGx2,this.iGy2,ht.gi().goods[2],i),qi.bCanProc()&&null!=this.lockgoods2)for(e=0;e<20;e++)if(ht.gi().goods[this.iStorePoint+10][e].iGid<=0){ht.gi().MoveGoods(this.lockgoods2,ht.gi().goods[this.iStorePoint+10][e]),this.lockgoods2=null;break}qi.bCanMove()&&null!=this.lockgoods2&&ht.gi().MoveGoods(this.lockgoods2,qi.swaplock)}if(this.btn_out.ProcTouch(i,t,s)&&this.btn_out.bCheck()&&Zs.start(Zs.IN_OUT,"输入要取出金额",xh.me.rbs.iStore,xh.me.rbs.iStore),this.btn_in.ProcTouch(i,t,s)&&this.btn_in.bCheck()&&(e=xh.me.rbs.iStore+xh.me.rbs.iMoney>2e7?2e7-xh.me.rbs.iStore:xh.me.rbs.iMoney,Zs.start(Zs.IN_IN,"输入要存入金额",e,e)),3==i&&!bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH))return ln.gi().PopStat(1),!0;for(e=0;e<13;e++)this.btn_switch[e].ProcTouch(i,t,s)&&this.btn_switch[e].bCheck()&&(e<mh.iStoreCount?e!=this.iStorePoint&&(this.iStorePoint=e,ln.gi().PushStat(ln.GS_LOADING1),Mh.gi().s_OpenStore(0,e,0)):e==mh.iStoreCount&&ei.start(ei.CONFIRM_BUYSTORE,"是否确认花费"+10*(mh.iStoreCount-mh.MAXFREESTORE+1)+"元宝开启一个仓库？"));return!1}}mh.MAXFREESTORE=3,mh.iStoreCount,mh.ResetStoreCount=function(i){mh.iStoreCount=i%100+mh.MAXFREESTORE};class gh extends s{constructor(i){var t;for(super(),this.pani=i,this.pm3f=i.pm3f,this.iW=510,this.iH=400,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_io=new Eh(gn.xani_button),this.btn_io.InitButton("1号按钮90_60"),this.btn_watch=new Eh(gn.xani_button),this.btn_watch.InitButton("1号按钮90_60"),this.btn_watch.sName="查看",this.iPid=new Int32Array(16),this.sPName=new Array(16),this.iPetPoint=-1,this.btn_switch=new Array(20),t=0;t<20;t++)this.btn_switch[t]=new Eh(gn.xani_button),this.btn_switch[t].InitButton("4号按钮60_60"),this.btn_switch[t].Move(this.iX+20+70*t,this.iY+this.iH-30-60,60,60),this.btn_switch[t].sName=""+(t+1)}Draw(){var i,t,s,e,h;for(E.frame_type4("10号框20_20",this.iX,this.iY,this.iW,this.iH,20,20),t=this.iX+20,s=this.iY+20,e=180,h=260,E.frame_type4("11号框20_20",t,s,e,h,20,20),i=0;i<this.iCount;i++)this.iPetPoint>=0&&0==this.iPagePoint&&this.iPetPoint==i&&E.frame_type1("12号框20_30",t+10,s+10+30*i,160,20),c.gi().DrawTextEx(t+10,s+10+15+30*i,this.sPName[i],4279324257,20,101,1,1,0,0,-2);for(this.iPetPoint>=0&&(0==this.iPagePoint?this.btn_io.sName="取出":this.btn_io.sName="存入",this.btn_io.Move(t+e+10,s+130-30-60,90,60),this.btn_io.Draw(),this.btn_watch.Move(t+e+10,s+130+30,90,60),this.btn_watch.Draw()),t=this.iX+20+e+10+90+10,E.frame_type4("11号框20_20",t,s,e,h,20,20),i=0;i<Bi.mp.iPetCount;i++)this.iPetPoint>=0&&1==this.iPagePoint&&this.iPetPoint==i&&E.frame_type1("12号框20_30",t+10,s+10+30*i,160,20),c.gi().DrawTextEx(t+10,s+10+15+30*i,Bi.mp.pets[i].sName,4279324257,20,101,1,1,0,0,-2);for(i=0;i<6;i++){if(i==this.iStorePoint&&(this.btn_switch[i].bMouseDown=!0,this.btn_switch[i].bMouseIn=!0),!(i<gh.iStoreCount)){this.btn_switch[i].sName="开",this.btn_switch[i].Draw();break}this.btn_switch[i].sName=""+(i+1),this.btn_switch[i].Draw()}ei.end(ei.CONFIRM_BUYSTORE)&&ei.bConfirm&&Mh.gi().s_OpenStore(11,10*(gh.iStoreCount-gh.MAXFREESTORE+1),0)}ProcTouch(i,t,s){var e,h,a;if(this.iPetPoint>=0){if(this.btn_io.ProcTouch(i,t,s))return this.btn_io.bCheck()&&(0==this.iPagePoint?(Mh.gi().s_OpenStore(31,this.iStorePoint,this.iPid[this.iPetPoint]),this.btn_io.sName="取出"):(Mh.gi().s_OpenStore(30,this.iStorePoint,Bi.mp.pets[this.iPetPoint].iPid),this.btn_io.sName="存入")),!0;if(this.btn_watch.ProcTouch(i,t,s))return this.btn_watch.bCheck()&&(0==this.iPagePoint?Mh.gi().s_WatchOn(2,this.iPid[this.iPetPoint],0,""):Mh.gi().s_WatchOn(2,Bi.mp.pets[this.iPetPoint].iPid,0,"")),!0}for(this.iPetPoint=-1,h=this.iX+20,a=this.iY+20,e=0;e<this.iCount;e++)if(bn.bInRect(t,s,h+10,a+10+30*e,160,30))return this.iPagePoint=0,this.iPetPoint=e,!0;for(h=this.iX+20+180+10+90+10,e=0;e<Bi.mp.iPetCount;e++)if(bn.bInRect(t,s,h+10,a+10+30*e,160,30))return this.iPagePoint=1,this.iPetPoint=e,!0;for(e=0;e<6;e++)this.btn_switch[e].ProcTouch(i,t,s)&&this.btn_switch[e].bCheck()&&(e<gh.iStoreCount?e!=this.iStorePoint&&(this.iStorePoint=e,ln.gi().PushStat(ln.GS_LOADING1),Mh.gi().s_OpenStore(1,e,0)):e==gh.iStoreCount&&ei.start(ei.CONFIRM_BUYSTORE,"是否确认花费"+10*(gh.iStoreCount-gh.MAXFREESTORE+1)+"元宝开启一个宠物仓库？"));return 3!=i||bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||ln.gi().PopStat(1),!1}}gh.MAXFREESTORE=1,gh.iStoreCount,gh.ResetStoreCount=function(i){gh.iStoreCount=i/100+gh.MAXFREESTORE},gh.Open=function(i){var t;ln.gi().LastStatType(0)==ln.GS_LOADING1&&ln.gi().PopStat(1),ln.gi().LastStatType(0)!=ln.GS_PETSTOREFRAME&&ln.gi().PushStat(ln.GS_PETSTOREFRAME);var s=ln.gi().LastStat(0);for(s.iStorePoint=i.GetNextByte(),s.iCount=i.GetNextByte(),t=0;t<s.iCount;t++)s.iPid[t]=i.GetNextInt(),s.sPName[t]=i.GetNextString();s.iPetPoint=-1};class wh{constructor(){this.sTitle="",this.iLev=0,this.iGovXiu=new Array(10);for(var i=0;i<10;i++)this.iGovXiu[i]=new Int32Array(2);this.iGovSkill=new Int32Array(8),this.iSchoolSkill=new Int32Array(as.MAXSKILLCOUNT),this.iBaseAtt=new Int32Array(5)}}class xh{constructor(){this.iRace=0,this.iSex=0,this.bInited=!1,this.rbs=new wh,this.iOldType=-1,this.bShowHpDetail=!1,this.RETEXT_CHANGETYPE=1,this.RETEXT_LOCKER=2,this.RETEXT_ANGER=4,this.bHaveLock=!1,this.bLocked,this.iUnlockTime,this.RETBASE_HP=1,this.RETBASE_MP=2,this.RETBASE_POWER=4,this.RETBASE_MONEY=8,this.RETBASE_EXP=16,this.RETBASE_LEV=32,this.RETBASE_ATT=64,this.RETBASE_OTHER=128,this.iScore,this.iComplexScore}Init(){var i,t;for(this.iFlag=new Int32Array(64),this.iFlagExt=new Int32Array(64),this.aa_body=new l,this.aa_weapon=new l,this.aa_mounts=new l,this.iSpeed=8,this.iPopoDelay=0,this.iWeapTid=-1,this.bwc=!0,this.bsc=!0,this.bfc8=!1,this.bfc4=!0,this.bfc6=!1,this.sStat="站立",this.iFace8=0,this.sFace8="左",this.iRid=0,this.iMarks=new Array(xh.MAXMARK),i=0;i<xh.MAXMARK;i++)this.iMarks[i]=new Int32Array(3);for(this.iFollowPid=0,this.iFollowX=0,this.iFollowY=0,this.aa_follow=new l,this.aa_team=new l,gn.xani_ui.InitAnimaWithName("队伍图标",this.aa_team),this.btn_reset=new D(gn.xani_ui),this.btn_reset.Move(0,0,118,83),this.btn_reset.bSingleButton=!0,this.btn_reset.sName="重置",this.btn_att=new D(gn.xani_ui),this.btn_att.bSingleButton=!0,this.btn_att.sName="属性",this.btn_petatt=new D(gn.xani_ui),this.btn_petatt.bSingleButton=!0,this.btn_petatt.sName="宠物",this.btn_petatt.Move(h.SCRW-190-83,0,83,83),this.iFightPid=-1,this.iFollowPid=-1,this.iFightMid=-1,this.iMountsTid=-1,this.iMountsJjLev=-1,this.bInited=!0,this.aa_mts=new Array(6),this.aa_bds=new Array(6),this.aa_cls=new Array(6),this.iColor=new Int32Array(6),i=0;i<6;i++){for(this.aa_mts[i]=new l,this.aa_bds[i]=new l,this.aa_cls[i]=new Array(5),t=0;t<5;t++)this.aa_cls[i][t]=new l;this.iColor[i]=0}}BeInvite(i){this.iInviteId=i.GetNextInt();var t=i.GetNextString();ei.start(ei.CONFIRM_INVITE,t+"邀请你加入队伍，是否同意？")}start(i,t){this.iPathPoint=0,this.iSx=i[this.iPathPoint][0],this.iSy=i[this.iPathPoint][1],this.iDx=i[this.iPathPoint+1][0],this.iDy=i[this.iPathPoint+1][1],this.iTick=parseInt(bn.llength(this.iSx,this.iSy,this.iDx,this.iDy)/this.iSpeed),this.iAt=0,0==this.iTick?(this.iX=this.iDx,this.iY=this.iDy):(this.iX=this.iSx+(this.iDx-this.iSx)*this.iAt/this.iTick,this.iY=this.iSy+(this.iDy-this.iSy)*this.iAt/this.iTick),this.FaceTo(),this.ChangeStat("跑步")}TeamFollow(){var i;if(H.bTeamLeader())for(i=1;i<xh.MAXTEAMOLE;i++)if(0!=H.iTeamRid[i]){var t=rh.gameing.findnrs(H.iTeamRid[i]);null!=t&&(t.iDx=this.iMarks[10*i][0],t.iDy=this.iMarks[10*i][1],t.iDFaceTo=this.iMarks[10*i][2])}}next(i,t){var s;if(!this.IsStat("跑步"))return!0;if(this.iAt++,0==this.iTick)this.iX=this.iDx,this.iY=this.iDy;else{for(s=xh.MAXMARK-1;s>0;s--)this.iMarks[s][0]=this.iMarks[s-1][0],this.iMarks[s][1]=this.iMarks[s-1][1],this.iMarks[s][2]=this.iMarks[s-1][2];this.iMarks[0][0]=this.iX,this.iMarks[0][1]=this.iY,this.iMarks[0][2]=this.iFace8+10*this.iFace4,this.iX=this.iSx+(this.iDx-this.iSx)*this.iAt/this.iTick,this.iY=this.iSy+(this.iDy-this.iSy)*this.iAt/this.iTick}if(this.iAt>=this.iTick){if(this.iPathPoint++,this.iPathPoint>=t-1)return this.ChangeStat("站立"),!0;this.iSx=i[this.iPathPoint][0],this.iSy=i[this.iPathPoint][1],this.iDx=i[this.iPathPoint+1][0],this.iDy=i[this.iPathPoint+1][1],this.iTick=parseInt(bn.llength(this.iSx,this.iSy,this.iDx,this.iDy)/this.iSpeed),this.iAt=0,0==this.iTick?(this.iX=this.iDx,this.iY=this.iDy):(this.iX=this.iSx+(this.iDx-this.iSx)*this.iAt/this.iTick,this.iY=this.iSy+(this.iDy-this.iSy)*this.iAt/this.iTick),this.FaceTo()}return!1}FaceTo(){var i,t,s;i=360-bn.GetAngleXY(this.iDx,this.iDy,this.iSx,this.iSy),i%=360,t=this.iFace4,this.iFace4=0<=i&&i<=90?0:90<=i&&i<=180?3:180<=i&&i<=270?2:1,t!=this.iFace4&&(this.bfc4=!0),t=this.iFace6,this.iFace6=0<=i&&i<=30?0:30<i&&i<=90?5:90<i&&i<=150?4:150<i&&i<=210?3:210<i&&i<=270?2:270<i&&i<=330?1:0,t!=this.iFace6&&(this.bfc6=!0),s=this.sFace8,22<i&&i<68?(this.iFace8=1,this.sFace8="右上"):67<i&&i<113?(this.iFace8=2,this.sFace8="上"):112<i&&i<158?(this.iFace8=3,this.sFace8="左上"):157<i&&i<203?(this.iFace8=4,this.sFace8="左"):202<i&&i<248?(this.iFace8=5,this.sFace8="左下"):247<i&&i<293?(this.iFace8=6,this.sFace8="下"):292<i&&i<338?(this.iFace8=7,this.sFace8="右下"):(this.iFace8=0,this.sFace8="右"),s!=this.sFace8&&(this.bfc8=!0)}ChangeStat(i){this.sStat!=i&&(this.sStat=i,this.bsc=!0)}IsStat(i){return this.sStat==i}DrawMounts(i,t,s,e,h){var a,n=0,o=2*this.iRace+this.iSex,r=xh.face_sti(s),c=xh.stat_sti(e),l=this.iMountsTid-1,b=this.iMountsJjLev-1,_=0;h&&(this.iOffY=0);var f=0;for(2==this.iMountsTid&&(f=12),a=0;a<N._ANIMASORT_MOUNT[l][b][c][r].length;a++)"左翅膀"==N._ANIMASORT_MOUNT[l][b][c][r][a]?(h&&gn.xani_nmounts[l][b].InitAnimaWithName(this.iMountsJjLev+"_"+e+"_"+s+"_左翅膀",this.aa_mts[2]),M.gi().DrawAnima_aa(t+_,null,i,t+f,this.aa_mts[2]),this.aa_mts[2].NextFrame(),_++):"右翅膀"==N._ANIMASORT_MOUNT[l][b][c][r][a]?(h&&gn.xani_nmounts[l][b].InitAnimaWithName(this.iMountsJjLev+"_"+e+"_"+s+"_右翅膀",this.aa_mts[3]),M.gi().DrawAnima_aa(t+_,null,i,t+f,this.aa_mts[3]),this.aa_mts[3].NextFrame(),_++):"前"==N._ANIMASORT_MOUNT[l][b][c][r][a]?(h&&gn.xani_nmounts[l][b].InitAnimaWithName(this.iMountsJjLev+"_"+e+"_"+s+"_前",this.aa_mts[0]),M.gi().DrawAnima_aa(t+_,null,i,t+f,this.aa_mts[0]),this.aa_mts[0].NextFrame(),_++):"后"==N._ANIMASORT_MOUNT[l][b][c][r][a]?(h&&gn.xani_nmounts[l][b].InitAnimaWithName(this.iMountsJjLev+"_"+e+"_"+s+"_后",this.aa_mts[1]),M.gi().DrawAnima_aa(t+_,null,i,t+f,this.aa_mts[1]),this.aa_mts[1].NextFrame(),_++):"身体"==N._ANIMASORT_MOUNT[l][b][c][r][a]?(h&&gn.xani_nmounts[l][b].InitAnimaWithName(this.iMountsJjLev+"_"+e+"_"+s+"_身体",this.aa_mts[4]),M.gi().DrawAnima_aa(t+_,null,i,t+f,this.aa_mts[4]),this.aa_mts[4].NextFrame(),_++):"飘带"==N._ANIMASORT_MOUNT[l][b][c][r][a]?(h&&gn.xani_nmounts[l][b].InitAnimaWithName(this.iMountsJjLev+"_"+e+"_"+s+"_飘带",this.aa_mts[5]),M.gi().DrawAnima_aa(t+_,null,i,t+f,this.aa_mts[5]),this.aa_mts[5].NextFrame(),_++):"人前"==N._ANIMASORT_MOUNT[l][b][c][r][a]?(h&&(gn.xani_newrole[o].InitAnimaWithName("骑"+e+"_"+s+"_前",this.aa_bds[0]),this.ChangeColor(o,"骑"+e+"_"+s+"_前",0),n=this.aa_bds[0].pani.iAnimaY(this.aa_bds[0])-30,this.iOffY>n&&(this.iOffY=n)),M.gi().DrawAnima_aa(t+_,null,i,t+f,this.aa_bds[0]),this.DrawColor(o,this.aa_bds[0].iFrame,t+_,i,t+f,0),this.aa_bds[0].NextFrame(),_++):"人后"==N._ANIMASORT_MOUNT[l][b][c][r][a]?(h&&(gn.xani_newrole[o].InitAnimaWithName("骑"+e+"_"+s+"_后",this.aa_bds[1]),this.ChangeColor(o,"骑"+e+"_"+s+"_后",1),n=this.aa_bds[1].pani.iAnimaY(this.aa_bds[1])-30,this.iOffY>n&&(this.iOffY=n)),M.gi().DrawAnima_aa(t+_,null,i,t+f,this.aa_bds[1]),this.DrawColor(o,this.aa_bds[1].iFrame,t+_,i,t+f,1),this.aa_bds[1].NextFrame(),_++):"人左"==N._ANIMASORT_MOUNT[l][b][c][r][a]?(h&&(gn.xani_newrole[o].InitAnimaWithName("骑"+e+"_"+s+"_左",this.aa_bds[2]),this.ChangeColor(o,"骑"+e+"_"+s+"_左",2),n=this.aa_bds[2].pani.iAnimaY(this.aa_bds[2])-30,this.iOffY>n&&(this.iOffY=n)),M.gi().DrawAnima_aa(t+_,null,i,t+f,this.aa_bds[2]),this.DrawColor(o,this.aa_bds[2].iFrame,t+_,i,t+f,2),this.aa_bds[2].NextFrame(),_++):"人右"==N._ANIMASORT_MOUNT[l][b][c][r][a]?(h&&(gn.xani_newrole[o].InitAnimaWithName("骑"+e+"_"+s+"_右",this.aa_bds[3]),this.ChangeColor(o,"骑"+e+"_"+s+"_右",3),n=this.aa_bds[3].pani.iAnimaY(this.aa_bds[3])-30,this.iOffY>n&&(this.iOffY=n)),M.gi().DrawAnima_aa(t+_,null,i,t+f,this.aa_bds[3]),this.DrawColor(o,this.aa_bds[3].iFrame,t+_,i,t+f,3),this.aa_bds[3].NextFrame(),_++):"人"==N._ANIMASORT_MOUNT[l][b][c][r][a]?(h&&(gn.xani_newrole[o].InitAnimaWithName("骑"+e+"_"+s,this.aa_bds[4]),this.ChangeColor(o,"骑"+e+"_"+s,4),n=this.aa_bds[4].pani.iAnimaY(this.aa_bds[4])-30,this.iOffY>n&&(this.iOffY=n)),M.gi().DrawAnima_aa(t+_,null,i,t+f,this.aa_bds[4]),this.DrawColor(o,this.aa_bds[4].iFrame,t+_,i,t+f,4),this.aa_bds[4].NextFrame(),_++):"武器"==N._ANIMASORT_MOUNT[l][b][c][r][a]&&(h&&(this.iWeapTid=ht.gi().GetWeaponTid(),this.iWeapTid>=0&&gn.xani_weap[o][N.WeapFlag(this.iWeapTid)].InitAnimaWithName("骑"+e+"_"+s,this.aa_weapon)),this.iWeapTid>=0&&(yh.bShowWeapon&&M.gi().DrawAnima_aa(t+_,null,i,t+f,this.aa_weapon),this.aa_weapon.NextFrame()),_++)}ChangeColor(i,t,s){var e;if(yh.bShowColor)for(e=0;e<N._CHANGECOLOR[i].length;e++)this.iColor[e]<=0||this.iColor[e]>=6||gn.xani_color[i][this.iColor[e]-1].InitAnimaWithName(N._CHANGECOLOR[i][e]+"_"+t,this.aa_cls[s][e])}DrawColor(i,t,s,e,h,a){var n;if(yh.bShowColor)for(n=0;n<N._CHANGECOLOR[i].length;n++)this.iColor[n]<=0||this.iColor[n]>=6||(this.aa_cls[a][n].iFrame=t,M.gi().DrawAnima_aa(s,null,e,h,this.aa_cls[a][n]))}DrawRole(i,t,s,e,h){var a,n=2*this.iRace+this.iSex,o=xh.face_sti(s),r=xh.stat_sti(e),c=0;for(a=0;a<N._ANIMASORT[n][r][o].length;a++)"人物"==N._ANIMASORT[n][r][o][a]?(h&&(gn.xani_newrole[n].InitAnimaWithName(e+"_"+s,this.aa_body),this.ChangeColor(n,e+"_"+s,0),this.iOffY=this.aa_body.pani.iAnimaY(this.aa_body)-30),M.gi().DrawAnima_aa(t+c,null,i,t,this.aa_body),this.DrawColor(n,this.aa_body.iFrame,t+c,i,t,0),this.aa_body.NextFrame(),c++):"武器"==N._ANIMASORT[n][r][o][a]&&(h&&(this.iWeapTid=ht.gi().GetWeaponTid(),this.iWeapTid>=0&&gn.xani_weap[n][N.WeapFlag(this.iWeapTid)].InitAnimaWithName(e+"_"+s,this.aa_weapon)),this.iWeapTid>=0&&(yh.bShowWeapon&&M.gi().DrawAnima_aa(t+c,null,i,t,this.aa_weapon),this.aa_weapon.NextFrame()),c++)}Draw(){var i,t=!1;if(this.iChangeType>0)0!=this.iOldType&&(this.iOldType=0,t=!0),t=this.bStatChanged()|t,(t=this.bFaceChanged6()|t)&&(0==this.iFace6?this.sFace6="右":1==this.iFace6?this.sFace6="右下":2==this.iFace6?this.sFace6="左下":3==this.iFace6?this.sFace6="左":4==this.iFace6?this.sFace6="左上":5==this.iFace6&&(this.sFace6="右上"),this.iChangeType>=1e4?gn.xani_pets[this.iChangeType%1e4].InitAnimaWithName("变异_"+this.sStat+"_"+this.sFace6,this.aa_body):gn.xani_pets[this.iChangeType%1e4].InitAnimaWithName(this.sStat+"_"+this.sFace6,this.aa_body),this.iOffY=this.aa_body.pani.iAnimaY(this.aa_body)-30);else if(this.iFightMid>0&&!ct.gi().bSelling&&yh.bShowMount){if(2!=this.iOldType&&(this.iOldType=2,t=!0),t=this.bWeapChanged()|t,t=this.bStatChanged()|t,t=this.bFaceChanged8()|t){var s=Ht.mm.FindMounts(this.iFightMid);if(null==s)return void(this.bsc=!0);this.iMountsTid=s.iTid,this.iMountsJjLev=s.iJjLev}}else 1!=this.iOldType&&(this.iOldType=1,t=!0),t=this.bStatChanged()|t,t=this.bFaceChanged8()|t,t=this.bWeapChanged()|t;if(this.iFollowPid>0&&yh.bShowFollow){var e=Bi.mp.FindPet(this.iFollowPid);if(null!=e){this.iFollowX=this.iMarks[5][0],this.iFollowY=this.iMarks[5][1];var h="";h=0==(2&e.iBaobao)?"":"变异_",this.iFollowX>this.iX?h+=this.sStat+"_左":h+=this.sStat+"_右",gn.xani_pets[e.iTid].InitAnimaWithName(h,this.aa_follow),this.aa_follow.SetFrame(gn.iDelay),M.gi().DrawAnima_aa(Ih.gi().iOffy+this.iFollowY,null,Ih.gi().iOffx+this.iFollowX,Ih.gi().iOffy+this.iFollowY,this.aa_follow),G.DrawAura(0,Ih.gi().iOffx+this.iFollowX,Ih.gi().iOffy+this.iFollowY,M.gi(),Ih.gi().iOffy+this.iFollowY-1),M.gi().DrawText_2(Ih.gi().iOffy+this.iFollowY+1,1,Ih.gi().iOffx+this.iFollowX,Ih.gi().iOffy+this.iFollowY+30,e.sName,4294946944,20,1,4278190080)}}if(M.gi().BeginGroup(),G.DrawAura(0,Ih.gi().iOffx+this.iX,Ih.gi().iOffy+this.iY,M.gi(),Ih.gi().iOffy+this.iY),this.rbs.sTitle.length>0&&yh.bShowTitle?(M.gi().DrawText_2(Ih.gi().iOffy+this.iY,1,Ih.gi().iOffx+this.iX,Ih.gi().iOffy+this.iY+20,this.rbs.sTitle,4286628095,20,1,4278190080),M.gi().DrawText_2(Ih.gi().iOffy+this.iY,1,Ih.gi().iOffx+this.iX,Ih.gi().iOffy+this.iY+20+20,this.sName,4286644096,20,1,4278190080)):M.gi().DrawText_2(Ih.gi().iOffy+this.iY,1,Ih.gi().iOffx+this.iX,Ih.gi().iOffy+this.iY+30,this.sName,4286644096,20,1,4278190080),this.iChangeType>0?(M.gi().DrawAnima_aa(Ih.gi().iOffy+this.iY,null,Ih.gi().iOffx+this.iX,Ih.gi().iOffy+this.iY,this.aa_body),this.aa_body.NextFrame()):this.iFightMid>0&&!ct.gi().bSelling&&yh.bShowMount?this.DrawMounts(Ih.gi().iOffx+this.iX,Ih.gi().iOffy+this.iY,this.sFace8,this.sStat,t):this.DrawRole(Ih.gi().iOffx+this.iX,Ih.gi().iOffy+this.iY,this.sFace8,this.sStat,t),ct.gi().bSelling){var a=c.gi().GetTextWidth(ct.gi().sSellName,25);(i=(a-60)/30+2)<2?i=2:i>6&&(i=6),gn.xani_ui2.InitAnimaWithName("普通摊位",gn.aaa),gn.aaa.iFrame=0,M.gi().DrawAnimaEx(Ih.gi().iOffy+this.iY-2,Ih.gi().iOffx+this.iX-a/2-9,Ih.gi().iOffy+this.iY+this.iOffY+5,gn.aaa,101,1,1,0,0,0),gn.aaa.iFrame=1,M.gi().DrawAnimaEx(Ih.gi().iOffy+this.iY-2,Ih.gi().iOffx+this.iX-a/2,Ih.gi().iOffy+this.iY+this.iOffY+5,gn.aaa,101,1*a/10,1,0,0,0),gn.aaa.iFrame=2,M.gi().DrawAnimaEx(Ih.gi().iOffy+this.iY-2,Ih.gi().iOffx+this.iX+a/2,Ih.gi().iOffy+this.iY+this.iOffY+5,gn.aaa,101,1,1,0,0,0),M.gi().DrawText(Ih.gi().iOffy+this.iY-1,1,Ih.gi().iOffx+this.iX,Ih.gi().iOffy+this.iY+this.iOffY+20,ct.gi().sSellName,4282433791,25)}H.bTeamLeader()&&(M.gi().DrawAnima_aa(Ih.gi().iOffy+this.iY,gn.xani_ui,Ih.gi().iOffx+this.iX,Ih.gi().iOffy+this.iY+this.iOffY,this.aa_team),gn.xani_ui.NextFrame(this.aa_team)),this.DrawPopo(Ih.gi().iOffx+this.iX,Ih.gi().iOffy+this.iY),M.gi().EndGroup()}DrawPopo(i,t){if(!(this.iPopoDelay<=0)){this.iPopoDelay--,Y.gi().Format(this.sPopoString,151,25),i-=Y.gi().iW/2;var s=t+this.iOffY+40-Y.gi().iH;M.gi().FillRect(t,i,s,i+Y.gi().iW,s+Y.gi().iH,1342177280),Y.gi().DrawToBuffer(t+1,i,s)}}weapname(i,t){var s;for(s=0;s<gn.de_goods.iDataCount;s++)if(2==gn.de_goods.datas[s].intValue(16)&&gn.de_goods.datas[s].intValue(19)==i&&gn.de_goods.datas[s].intValue(9)==t)return gn.de_goods.datas[s].strValue(4);return""}DrawFightUI(){gn.xani_ui.DrawAnima(h.SCRW,0,"test",0),this.btn_att.Draw(),this.btn_petatt.Draw()}DrawHpDetail(){var i=h.SCRW-88-60-150;c.gi().FillRect_2D(i,0,i+150,60,2147483648),c.gi().DrawTextEx(i,0,"气血:"+xh.me.rbs.iHp+"/"+xh.me.rbs.iMaxHp,4294967295,20,101,1,1,0,0,0),c.gi().DrawTextEx(i,20,"魔法:"+xh.me.rbs.iMp+"/"+xh.me.rbs.iMaxMp,4294967295,20,101,1,1,0,0,0),c.gi().DrawTextEx(i,40,"愤怒:"+xh.me.rbs.iAnger+"/150",4294967295,20,101,1,1,0,0,0)}DrawHeadEx(i,t,s,a,n,o,r,l,b,_,f,u,d){if(!(this.rbs.iMaxHp<=0||this.rbs.iMaxMp<=0||this.rbs.iLev<0)){var p=0;fn.gi().iBx>0&&(p=h.SCRW-fn.gi().iBx),gn.xani_frame.DrawAnima(h.SCRW-81-p,1,"角色头像80_80",2*this.iRace+this.iSex),r<0?gn.xani_frame.DrawAnima(h.SCRW-251-p,3,"默认宠物头像框68_68",0):(gn.xani_frame.DrawAnima(h.SCRW-251-p,3,"默认宠物头像框68_68",1),gn.xani_head.DrawAnimaEx(h.SCRW-251-p,3,gn.de_pet.strValue(r,0,1),0,101,.92,.92,4096,0,0)),gn.xani_frame.DrawAnima(h.SCRW-336-p,0,"漫游属性框336_82",0);var m=0;r>=0&&((m=79*l/b)>1&&E.frame_type1("气血框20_16",h.SCRW-336+3+79-m-p,3,m,20),(m=79*_/f)>1&&E.frame_type1("魔法框20_16",h.SCRW-336+3+79-m-p,22,m,20),(m=79*(d>e.iUpgradeExp[u]/3?e.iUpgradeExp[u]/3:d)/(e.iUpgradeExp[u]/3))>1&&E.frame_type1("经验框20_16",h.SCRW-336+3+79-m-p,41,m,20),c.gi().DrawTextEx(h.SCRW-336+140-p,62,""+u,4280698183,16,101,1,1,0,-2,-2)),(m=96*i/t)>1&&E.frame_type1("气血框20_16",h.SCRW-336+158+96-m-p,3,m,20),(m=96*s/a)>1&&E.frame_type1("魔法框20_16",h.SCRW-336+158+96-m-p,22,m,20),(m=96*n/150)>1&&E.frame_type1("愤怒框20_16",h.SCRW-336+158+96-m-p,41,m,20),c.gi().DrawTextEx(h.SCRW-336+320-p,71,""+o,4280698183,16,101,1,1,0,-2,-2)}}DrawHead(){if(!(this.rbs.iMaxHp<=0||this.rbs.iMaxMp<=0||this.rbs.iLev<0)){var i=Bi.mp.GetUseingPet();null==i?this.DrawHeadEx(this.rbs.iHp,this.rbs.iMaxHp,this.rbs.iMp,this.rbs.iMaxMp,this.rbs.iAnger,this.rbs.iLev,-1,0,0,0,0,0,0):this.DrawHeadEx(this.rbs.iHp,this.rbs.iMaxHp,this.rbs.iMp,this.rbs.iMaxMp,this.rbs.iAnger,this.rbs.iLev,i.iTid,i.iHp,i.iMaxHp,i.iMp,i.iMaxMp,i.iLev,i.iExp)}}DrawExp(){var i,t,s,a,n;a=this.rbs.iExp>e.iUpgradeExp[xh.me.rbs.iLev]?e.iUpgradeExp[xh.me.rbs.iLev]:this.rbs.iExp,t=(n=e.iUpgradeExp[xh.me.rbs.iLev])/10;var o=Math.floor(a/t);for(o<0&&(o=0),o>9&&(o=9),i=0;i<10;i++){var r=40+159*i;i<o?gn.xani_frame.DrawAnimaEx(r,h.SCRH-10,"经验底框124_10",1,101,159/124,1,0,0,0):gn.xani_frame.DrawAnimaEx(r,h.SCRH-10,"经验底框124_10",0,101,159/124,1,0,0,0),i==o&&(a>=n?E.frame_type1("经验框20_10",r,h.SCRH-10,159,20):(s=a-o*t)>0&&(s=Math.floor(159*s/t),E.frame_type1("经验框20_10",r,h.SCRH-10,s,20)))}gn.xani_frame.DrawAnima(0,h.SCRH-10,"经验标签40_10",0),c.gi().DrawTextEx(20,h.SCRH-5,"经  验",4294967040,10,101,1,1,0,-2,-2)}DrawUI(){if(!Ih.gi().vbk.mapdialog.bHideUI()&&!xs.jq.bJQLock()){var i,t,s=0;if(fn.gi().iBx>0&&(s=h.SCRW-fn.gi().iBx),this.btn_att.Move(h.SCRW-83-s,0,83,83),this.btn_petatt.Move(h.SCRW-253-s,0,76,76),this.DrawHead(),H.bInTeam())for(i=0;i<5;i++)0!=H.iTmpTeamRid[i]&&(t=H.iTmpTeamRid[i]==this.iRid?2*this.iRace+this.iSex:H.iRas[i],0==H.iTeamRid[i]?gn.xani_head.DrawAnimaEx(h.SCRW-500-83*i-s,0,"新头像"+t,0,50,1,1,0,0,0):gn.xani_head.DrawAnima(h.SCRW-500-83*i-s,0,"新头像"+t,0));ei.end(ei.CONFIRM_INVITE)&&ei.bConfirm&&Mh.gi().s_TeamOperate(7,this.iInviteId,0),this.bShowHpDetail&&this.DrawHpDetail()}}ProcTouch_AttFrame(i,t,s){return!!Bi.mp.ProcTouch(i,t,s)}ProcTouch(i,t,s){return this.bShowHpDetail=!1,this.btn_att.ProcTouch(i,t,s)?(this.btn_att.bCheck()&&ln.gi().PushStat(ln.GS_MYATTFRAME),!0):this.btn_petatt.ProcTouch(i,t,s)?(this.btn_petatt.bCheck()&&et.Open(),!0):this.btn_reset.ProcTouch(i,t,s)?(this.btn_reset.bCheck()&&ln.gi().PushStat(ln.GS_SMALLMAP),!0):!(2!=i&&1!=i||!bn.bInRect(t,s,h.SCRW-191,0,108,80))&&(this.bShowHpDetail=!0,!0)}getinit(i){this.iRid=i.GetNextInt(),this.sName=i.GetNextString(),gn.m_vi.Login(""+this.iRid,this.sName),this.iSex=i.GetNextByte(),this.iRace=i.GetNextByte(),this.iFightPid=i.GetNextInt(),this.rbs.iSchoolId=i.GetNextByte(),this.rbs.iInGot=i.GetNextInt(),this.iFightMid=i.GetNextInt(),this.rbs.iLev=i.GetNextShort(),xh.iSecond=i.GetNextInt(),xh.iTime[0]=i.GetNextShort(),xh.iTime[1]=i.GetNextShort(),xh.iTime[2]=i.GetNextShort(),console.log("初始化角色数据：",i,this.iRace,this.iSex),gn.xani_newrole[2*this.iRace+this.iSex].LoadRes(),xh.iMillis=bn.get_ms(),this.rbs.iLev<=0&&(h.SYSW>=1280?yh.iScreenLS=192e3/(h.SYSW-800):yh.iScreenLS=400*(h.SYSW-800)/480,yh.iSameRate=0),fn.gi().mta_record(1,this.iRid,this.sName),this.bsc=!0,gn.x_record.ReadPrivateChat()}getflag(i){var t,s,e=i.GetNextByte();if(0==e){for(s=this.iFlag[53],t=0;t<64;t++)this.iFlag[t]=i.GetNextInt();this.iFlag[14]|=1,this.bDark=0==(1&this.iFlag[2]),this.bPk=0==(2&this.iFlag[2]),this.bStandIn=0!=(4&this.iFlag[2]),this.bQP=0!=(8&this.iFlag[2]),this.lt1=bn.get_ms()/1e3,mh.ResetStoreCount(this.iFlag[8]),gh.ResetStoreCount(this.iFlag[8]),xh.me.CalcFightAtt(),qe.lg.SetStatByFlag(),Je.fg.SetStatByFlag(),je.fg.SetStatByFlag(),Xs.bSELock=!1;var h=this.iFlag[53];this.iColor[0]=7&h,this.iColor[1]=h>>3&7,this.iColor[2]=h>>6&7,this.iColor[3]=h>>9&7,this.iColor[4]=h>>12&7,s!=h&&(this.bsc=!0)}else if(1==e)for(t=0;t<64;t++)this.iFlagExt[t]=i.GetNextInt()}GetExt(i){var t=i.GetNextInt();0!=(t&this.RETEXT_CHANGETYPE)&&(this.iOldType=-1,this.iChangeType=i.GetNextShort(),this.iChangeLast=i.GetNextInt(),this.iChangeSkill=i.GetNextInt(),this.iChangeAtt=i.GetNextInt(),this.iChangeFC=i.GetNextByte()),0!=(t&this.RETEXT_LOCKER)&&(1==i.GetNextByte()?(this.bHaveLock=!0,1==i.GetNextByte()?this.bLocked=!0:this.bLocked=!1,this.iUnlockTime=i.GetNextInt()):this.bHaveLock=!1),0!=(t&this.RETEXT_ANGER)&&(this.rbs.iAnger=i.GetNextShort()),xh.me.CalcFightAtt(),this.ltex=bn.get_ms()/1e3}GetBaseAtt(i){var t,s=i.GetNextByte();if(0!=(s&this.RETBASE_HP)&&(this.rbs.iHp=i.GetNextShort(),this.rbs.iMaxHp=i.GetNextShort()),0!=(s&this.RETBASE_MP)&&(this.rbs.iMp=i.GetNextShort(),this.rbs.iMaxMp=i.GetNextShort()),0!=(s&this.RETBASE_POWER)&&(this.rbs.iPower=i.GetNextShort()),0!=(s&this.RETBASE_MONEY)&&(this.rbs.iMoney=i.GetNextInt()),0!=(s&this.RETBASE_EXP)&&(this.rbs.iExp=i.GetNextInt()),0!=(s&this.RETBASE_LEV)&&(this.rbs.iLev=i.GetNextShort(),fn.gi().mta_record(2,this.rbs.iLev,""+ph.iLastSever)),0!=(s&this.RETBASE_ATT))for(t=0;t<5;t++)this.rbs.iBaseAtt[t]=i.GetNextShort();0!=(s&this.RETBASE_OTHER)&&(this.rbs.iRenQi=i.GetNextShort(),this.rbs.sTitle=i.GetNextString(),Fi.mg.iTick=i.GetNextInt(),this.rbs.iInGot=i.GetNextInt(),this.rbs.iStore=i.GetNextInt(),this.rbs.iReserve=i.GetNextInt()),this.CalcFightAtt()}getschoolskill(i){var t;for(t=0;t<6;t++)this.rbs.iSchoolSkill[t]=i.GetNextShort();(t=i.GetNextShort())!=this.rbs.iSchoolId&&0==this.rbs.iSchoolId&&(this.rbs.iSchoolId=t),this.rbs.iHp=i.GetNextShort(),this.rbs.iMp=i.GetNextShort(),this.CalcFightAtt()}getgovskill(i){var t;for(t=0;t<8;t++)this.rbs.iGovSkill[t]=i.GetNextShort();this.CalcFightAtt()}getgovxiu(i){var t;for(t=0;t<10;t++)this.rbs.iGovXiu[t][0]=i.GetNextShort(),this.rbs.iGovXiu[t][1]=i.GetNextInt()}CalcFightAtt(){var i,t,s,h,a;i=5*this.rbs.iLev,t=this.rbs.iBaseAtt[0]+this.rbs.iBaseAtt[1]+this.rbs.iBaseAtt[2]+this.rbs.iBaseAtt[3]+this.rbs.iBaseAtt[4],this.rbs.nut=i-t,this.rbs.nut+=this.iFlag[54]%1e3;var n=e.iBaseAttAdd[this.iRace][0]+this.rbs.iBaseAtt[0]+this.rbs.iLev,o=e.iBaseAttAdd[this.iRace][1]+this.rbs.iBaseAtt[1]+this.rbs.iLev,r=e.iBaseAttAdd[this.iRace][2]+this.rbs.iBaseAtt[2]+this.rbs.iLev,c=e.iBaseAttAdd[this.iRace][3]+this.rbs.iBaseAtt[3]+this.rbs.iLev,l=e.iBaseAttAdd[this.iRace][4]+this.rbs.iBaseAtt[4]+this.rbs.iLev;for(this.iFlag[28]>0&&(n+=this.iFlag[27]>>24&31),this.iFlag[29]>0&&(o+=this.iFlag[27]>>18&31),this.iFlag[30]>0&&(r+=this.iFlag[27]>>12&31),this.iFlag[31]>0&&(c+=this.iFlag[27]>>6&31),this.iFlag[32]>0&&(l+=31&this.iFlag[27]),i=0;i<6;i++)if(-1!=ht.gi().goods[1][i].iGid&&!(ht.gi().goods[1][i].iAtts[5]%1e5<=0)){if(a=ht.gi().goods[1][i],s=Math.floor(a.iAtts[1]/1e4),h=a.iAtts[1]%1e4,s>0){const i=Math.floor(s/1e3);0==i?n+=s%1e3:1==i?o+=s%1e3:2==i?r+=s%1e3:3==i?c+=s%1e3:4==i&&(l+=s%1e3)}if(h>0){const i=Math.floor(h/1e3);0==i?n+=h%1e3:1==i?o+=h%1e3:2==i?r+=h%1e3:3==i?c+=h%1e3:4==i&&(l+=h%1e3)}}switch(this.rbs.iMaxHp=50*n+1e3,this.rbs.iMaxMp=30*o,this.rbs.iSpirit=3*n+7*o+4*r+2*c,this.rbs.iSpeed=n+r+c+7*l,this.iRace){case 0:this.rbs.iAttack=Math.floor(25*r/3),this.rbs.iDefence=15*c;break;case 1:this.rbs.iMaxHp+=10*n,this.rbs.iMaxMp-=5*o,this.rbs.iAttack=Math.floor(27*r/3),this.rbs.iDefence=14*c;break;case 2:this.rbs.iMaxHp-=5*n,this.rbs.iMaxMp+=5*o,this.rbs.iAttack=Math.floor(23*r/3),this.rbs.iDefence=16*c}for(i=0;i<6;i++)if(-1!=ht.gi().goods[1][i].iGid&&!(ht.gi().goods[1][i].iAtts[5]%1e5<=0)){switch(a=ht.gi().goods[1][i],(t=gn.de_goods.intValue(a.iTid,-1,3))>0&&(this.rbs.iAttack+=10*t),(t=gn.de_goods.intValue(a.iTid,-1,25))>0&&(this.rbs.iSpeed+=10*t),(t=gn.de_goods.intValue(a.iTid,-1,24))>0&&(this.rbs.iMaxHp+=10*t),(t=gn.de_goods.intValue(a.iTid,-1,23))>0&&(this.rbs.iSpirit+=10*t),(t=gn.de_goods.intValue(a.iTid,-1,22))>0&&(this.rbs.iMaxMp+=10*t),(t=gn.de_goods.intValue(a.iTid,-1,21))>0&&(this.rbs.iDefence+=10*t),s=Math.floor(a.iAtts[0]/1e4),h=a.iAtts[0]%1e4,i){case 0:this.rbs.iDefence+=10*s,this.rbs.iMaxMp+=10*h;break;case 1:this.rbs.iSpirit+=10*h;break;case 2:this.rbs.iAttack+=10*h;break;case 3:this.rbs.iDefence+=10*h;break;case 4:this.rbs.iDefence+=10*s,this.rbs.iMaxHp+=10*h;break;case 5:this.rbs.iDefence+=10*s,this.rbs.iSpeed+=10*h}if((s=Math.floor(a.iAtts[2]/1e4))>0){switch(Math.floor(s/1e3)){case 0:this.rbs.iAttack+=s%1e3*80;break;case 1:this.rbs.iDefence+=s%1e3*120;break;case 2:this.rbs.iMaxHp+=s%1e3*400;break;case 3:this.rbs.iSpeed+=s%1e3*80;break;case 4:this.rbs.iSpirit+=s%1e3*60}}if((s=a.iAtts[2]%1e4)>0){switch(Math.floor(s/1e3)){case 0:this.rbs.iAttack+=s%1e3*80;break;case 1:this.rbs.iDefence+=s%1e3*120;break;case 2:this.rbs.iMaxHp+=s%1e3*400;break;case 3:this.rbs.iSpeed+=s%1e3*80;break;case 4:this.rbs.iSpirit+=s%1e3*60}}}if(xh.me.rbs.iSchoolId>0&&xh.me.rbs.iSchoolId<=9)for(i=0;i<6;i++)(t=gn.de_skill.intValue(e.iSchoolSkillId[xh.me.rbs.iSchoolId][i],-1,17))>0&&(this.rbs.iAttack+=this.rbs.iSchoolSkill[i]*t/10),(t=gn.de_skill.intValue(e.iSchoolSkillId[xh.me.rbs.iSchoolId][i],-1,18))>0&&(this.rbs.iDefence+=this.rbs.iSchoolSkill[i]*t/10),(t=gn.de_skill.intValue(e.iSchoolSkillId[xh.me.rbs.iSchoolId][i],-1,19))>0&&(this.rbs.iSpeed+=this.rbs.iSchoolSkill[i]*t/10),(t=gn.de_skill.intValue(e.iSchoolSkillId[xh.me.rbs.iSchoolId][i],-1,20))>0&&(this.rbs.iSpirit+=this.rbs.iSchoolSkill[i]*t/10),(t=gn.de_skill.intValue(e.iSchoolSkillId[xh.me.rbs.iSchoolId][i],-1,21))>0&&(this.rbs.iMaxHp+=this.rbs.iSchoolSkill[i]*t/10),(t=gn.de_skill.intValue(e.iSchoolSkillId[xh.me.rbs.iSchoolId][i],-1,22))>0&&(this.rbs.iMaxMp+=this.rbs.iSchoolSkill[i]*t/10);var b=Ht.mm.FindMounts(this.iFightMid);if(null!=b&&(this.rbs.iMaxHp+=b.iMaxHp,this.rbs.iMaxMp+=b.iMaxMp,this.rbs.iAttack+=b.iAttack,this.rbs.iDefence+=b.iDefence,this.rbs.iSpirit+=b.iSpirit,this.rbs.iSpeed+=b.iSpeed),this.rbs.tz=Math.floor(n),this.rbs.fl=Math.floor(o),this.rbs.ll=Math.floor(r),this.rbs.nl=Math.floor(c),this.rbs.mj=Math.floor(l),this.rbs.iMaxPower=5*this.rbs.iLev+100,this.rbs.iGovSkill[0]>0&&(this.rbs.iMaxHp+=this.rbs.iMaxHp*this.rbs.iGovSkill[0]/100),this.rbs.iGovSkill[6]>0&&(this.rbs.iMaxPower+=5*this.rbs.iGovSkill[6]),this.rbs.iGovSkill[7]>0&&(this.rbs.iMaxMp+=this.rbs.iMaxMp*this.rbs.iGovSkill[7]/100),this.iChangeType>0){if(this.iChangeAtt>0)switch(i=this.iChangeAtt%1e3,Math.floor(this.iChangeAtt/1e3)%10){case 0:this.rbs.iMaxHp=Math.floor(this.rbs.iMaxHp*i/100);break;case 1:this.rbs.iSpirit=Math.floor(this.rbs.iSpirit*i/100);break;case 2:this.rbs.iAttack=Math.floor(this.rbs.iAttack*i/100);break;case 3:this.rbs.iDefence=Math.floor(this.rbs.iDefence*i/100);break;case 4:this.rbs.iSpeed=Math.floor(this.rbs.iSpeed*i/100)}this.iChangeSkill>0&&(212==this.iChangeSkill?this.rbs.iDefence+=18*this.rbs.iLev:211==this.iChangeSkill?this.rbs.iDefence+=12*this.rbs.iLev:210==this.iChangeSkill&&(this.rbs.iDefence+=6*this.rbs.iLev),215==this.iChangeSkill?this.rbs.iAttack+=15*this.rbs.iLev:214==this.iChangeSkill?this.rbs.iAttack+=10*this.rbs.iLev:213==this.iChangeSkill&&(this.rbs.iAttack+=5*this.rbs.iLev))}this.rbs.iMaxHp=parseInt(this.rbs.iMaxHp/10),this.rbs.iMaxMp=parseInt(this.rbs.iMaxMp/10),this.rbs.iSpirit=parseInt(this.rbs.iSpirit/10),this.rbs.iAttack=parseInt(this.rbs.iAttack/10),this.rbs.iDefence=parseInt(this.rbs.iDefence/10),this.rbs.iSpeed=parseInt(this.rbs.iSpeed/10),this.rbs.iHp>this.rbs.iMaxHp&&(this.rbs.iHp=this.rbs.iMaxHp),this.rbs.iMp>this.rbs.iMaxMp&&(this.rbs.iMp=this.rbs.iMaxMp)}CalcUserScore(){var i,t,s,e=0,h=0,a=0,n=0,o=0;for(i=1;i<=this.rbs.iLev;i++)e+=i;if(e*=2,this.rbs.iSchoolId>0){for(t=0,i=0;i<6;i++)this.rbs.iSchoolSkill[i]>0&&(t+=this.rbs.iSchoolSkill[i]);h=3*t}for(t=0,this.rbs.iGovSkill[0]>0&&(t+=this.rbs.iGovSkill[0]),this.rbs.iGovSkill[6]>0&&(t+=this.rbs.iGovSkill[6]),this.rbs.iGovSkill[7]>0&&(t+=this.rbs.iGovSkill[7]),h+=3*t,t=0,this.rbs.iGovSkill[1]>0&&(t+=this.rbs.iGovSkill[1]),this.rbs.iGovSkill[2]>0&&(t+=this.rbs.iGovSkill[2]),this.rbs.iGovSkill[3]>0&&(t+=this.rbs.iGovSkill[3]),this.rbs.iGovSkill[4]>0&&(t+=this.rbs.iGovSkill[4]),this.rbs.iGovSkill[5]>0&&(t+=this.rbs.iGovSkill[5]),h+=2*t,i=0;i<6;i++)ht.gi().goods[1][i].iGid>0&&(a+=ht.gi().goods[1][i].CalcSetScore());for(t=0,i=0;i<10;i++)t+=this.rbs.iGovXiu[i][0];for(s=8;t>0;)n+=t>=10?10*s:t*s,t-=10,s+=8;for(i=1;i<10;i++)0!=(this.iFlag[14]&1<<i)&&(o+=50);return(i=parseInt(e+h+a+n+o))!=this.iScore&&(this.iScore=i),this.CalcComplexScore(),this.iScore}CalcComplexScore(){var i,t,s=0,e=new Int32Array(8);for(i=0;i<8;i++)Bi.mp.pets[i].iPid>0?(Bi.mp.pets[i].CalcPetScore(),e[i]=Bi.mp.pets[i].iScore):e[i]=0;for(i=0;i<7;i++)for(t=i+1;t<8;t++)e[i]<e[t]&&(s=e[i],e[i]=e[t],e[t]=s);return s=e[0]+e[1]+e[2]+e[3],(s+=this.iScore)!=this.iComplexScore&&(this.iComplexScore=s),this.iComplexScore}bWeapChanged(){return!!this.bwc&&(this.bwc=!1,!0)}bFaceChanged4(){return!!this.bfc4&&(this.bfc4=!1,!0)}bFaceChanged6(){return!!this.bfc6&&(this.bfc6=!1,!0)}bFaceChanged8(){return!!this.bfc8&&(this.bfc8=!1,!0)}bStatChanged(){return!!this.bsc&&(this.bsc=!1,!0)}}xh.iTime=new Int32Array(3),xh.iSecond,xh.iMillis,xh.MAXTEAMOLE=5,xh.MAXMARK=60,xh.iTeamZhen=0,xh.iTeamMap=0,xh.me,xh.sSex=function(i){return 0==i?"女":"男"},xh.sRace=function(i){return 0==i?"人":1==i?"魔":"仙"},xh.face_sti=function(i){return"上"==i?0:"左上"==i?1:"左"==i?2:"左下"==i?3:"下"==i?4:"右下"==i?5:"右"==i?6:"右上"==i?7:0},xh.stat_sti=function(i){return"站立"==i?0:"跑步"==i?1:"战斗站立"==i?2:"普通攻击"==i?3:"施法"==i?4:"防御"==i?5:"死亡过程"==i?6:"被攻击"==i?6:"死亡"==i?6:7};class Sh{Draw(){var i,t;for(i=0;i<P.MAXPATHCOUNT;i++)if(null!=this.pps[i])for(t=1;t<this.pps[i].iPathCount;t++)M2DFast.xm3f.DrawLine(Ih.gi().iOffx+this.pps[i].path[t-1][0],Ih.gi().iOffy+this.pps[i].path[t-1][1],Ih.gi().iOffx+this.pps[i].path[t][0],Ih.gi().iOffy+this.pps[i].path[t][1],4294902015);this.DrawBoom()}DrawBoom(){var i,t,s,e;for(i=0;i<this.iMapWidth/this.iBlockWidth;i++)for(t=0;t<this.iMapHeight/this.iBlockHeight;t++)if(this.boom[t][i]>=2){if(s=Ih.gi().iOffx+32*i,e=Ih.gi().iOffy+32*t,s<0||s>h.SCRW||e<0||e>h.SCRH)continue;M2DFast.xm3f.FillRect_2D(s-3,e-3,s+3,e+3,4294901760)}}constructor(){this.iDelay=0,this.iPathDeep=0,this.iPath=new Array(256),this.boom=new Array(256);for(var i=0;i<256;i++)this.iPath[i]=new Int32Array(2),this.boom[i]=new Int32Array(256);this.tmpst=new Array(4096);for(i=0;i<4096;i++)this.tmpst[i]=new Int32Array(2)}bCanMove(i,t,s,e){if(s<0||e<0||s>Ih.gi().mapdata.iMapWidth||e>Ih.gi().mapdata.iMapHeight)return!1;var h,a;for(h=0;h<P.MAXPATHCOUNT;h++)if(null!=this.pps[h])for(a=1;a<this.pps[h].iPathCount;a++)if(!(i<this.pps[h].path[a-1][0]&&s<this.pps[h].path[a-1][0]&&i<this.pps[h].path[a][0]&&s<this.pps[h].path[a][0])&&!(i>this.pps[h].path[a-1][0]&&s>this.pps[h].path[a-1][0]&&i>this.pps[h].path[a][0]&&s>this.pps[h].path[a][0])&&!(t<this.pps[h].path[a-1][1]&&e<this.pps[h].path[a-1][1]&&t<this.pps[h].path[a][1]&&e<this.pps[h].path[a][1])&&!(t>this.pps[h].path[a-1][1]&&e>this.pps[h].path[a-1][1]&&t>this.pps[h].path[a][1]&&e>this.pps[h].path[a][1])&&P.llcollision_ai(i,t,s,e,this.pps[h].path[a-1][0],this.pps[h].path[a-1][1],this.pps[h].path[a][0],this.pps[h].path[a][1]))return this.iBx1=this.pps[h].path[a-1][0],this.iBy1=this.pps[h].path[a-1][1],this.iBx2=this.pps[h].path[a][0],this.iBy2=this.pps[h].path[a][1],!1;return!0}setboom(i,t,s,e,h){return!(1!=this.boom[e][s]||!this.bCanMove(i*this.iBlockWidth,t*this.iBlockHeight,s*this.iBlockWidth,e*this.iBlockHeight))&&(this.boom[e][s]=h,!0)}initboom(i,t,s,e,h,a){var n,o,r,c;for(i<0&&(i=0),t<0&&(t=0),this.pps=Ih.gi().mapdata.pps,this.iMapWidth=s,this.iMapHeight=e,this.iBlockWidth=h,this.iBlockHeight=a,n=0;n<s/h;n++)for(o=0;o<e/a;o++)this.boom[o][n]=1;for(this.boom[parseInt(t/this.iBlockHeight)][parseInt(i/this.iBlockWidth)]=2,r=2,c=1;c>0;){for(c=0,n=1;n<s/h;n++)for(o=1;o<e/a;o++)this.boom[o][n]==r&&(this.setboom(n,o,n-1,o,r+1)&&c++,this.setboom(n,o,n+1,o,r+1)&&c++,this.setboom(n,o,n,o-1,r+1)&&c++,this.setboom(n,o,n,o+1,r+1)&&c++);r++}for(n=0;n<s/h+1;n++)for(o=0;o<e/a+1;o++)(1==this.boom[o][n]||n>=s/h||o>=e/a)&&(this.boom[o][n]=0)}findway(i,t,s,e){if(bn.llength(i,t,s,e)<20)return!1;if(s<0||e<0||s>=Ih.gi().mapdata.iMapWidth||e>=Ih.gi().mapdata.iMapHeight)return!1;if(this.bCanMove(i,t,s,e))return this.iPath[0][0]=i,this.iPath[0][1]=t,this.iPath[1][0]=s,this.iPath[1][1]=e,this.iPathDeep=2,!0;var h,a,n,o,r,c;for(h=0;h<this.iMapWidth/this.iBlockWidth+2;h++)for(a=0;a<this.iMapHeight/this.iBlockHeight+2;a++)this.boom[a][h]>2&&(this.boom[a][h]=2);if(n=parseInt(i/this.iBlockWidth),o=parseInt(t/this.iBlockHeight),this.bCanMove(n*this.iBlockWidth,o*this.iBlockHeight,i,t));else if(this.bCanMove((n+1)*this.iBlockWidth,o*this.iBlockHeight,i,t))n++;else if(this.bCanMove((n-1)*this.iBlockWidth,o*this.iBlockHeight,i,t))n--;else if(this.bCanMove(n*this.iBlockWidth,(o+1)*this.iBlockHeight,i,t))o++;else{if(!this.bCanMove(n*this.iBlockWidth,(o-1)*this.iBlockHeight,i,t)){if(2==this.boom[o][n]);else if(2==this.boom[o+1][n])o+=1;else if(2==this.boom[o-1][n])o-=1;else if(2==this.boom[o][n+1])n+=1;else{if(2!=this.boom[o][n-1])return!1;n-=1}return this.iPath[0][0]=i,this.iPath[0][1]=t,this.iPath[1][0]=n*this.iBlockWidth,this.iPath[1][1]=o*this.iBlockHeight,this.iPathDeep=2,!0}o--}if(r=parseInt(s/this.iBlockWidth),c=parseInt(e/this.iBlockHeight),this.bCanMove(r*this.iBlockWidth,c*this.iBlockHeight,s,e));else if(this.bCanMove((r+1)*this.iBlockWidth,c*this.iBlockHeight,s,e))r++;else if(this.bCanMove((r-1)*this.iBlockWidth,c*this.iBlockHeight,s,e))r--;else if(this.bCanMove(r*this.iBlockWidth,(c+1)*this.iBlockHeight,s,e))c++;else{if(!this.bCanMove(r*this.iBlockWidth,(c-1)*this.iBlockHeight,s,e))return!1;c--}return!(r<0||c<0)&&(h=0,0==this.boom[c][r]&&h++,r-1>=0&&0==this.boom[c][r-1]&&h++,c-1>=0&&0==this.boom[c-1][r]&&h++,0==this.boom[c][r+1]&&h++,0==this.boom[c+1][r]&&h++,!(h>=3)&&(!!this.findway_(n*this.iBlockWidth,o*this.iBlockHeight,r*this.iBlockWidth,c*this.iBlockHeight)&&(this.iPath[0][0]=i,this.iPath[0][1]=t,this.iPath[this.iPathDeep-1][0]=s,this.iPath[this.iPathDeep-1][1]=e,this.iDelay++,this.pullline(),!0)))}findway_(i,t,s,e){if(console.log("寻路2"),i<0||t<0||i>=Ih.gi().mapdata.iMapWidth||t>=Ih.gi().mapdata.iMapHeight)return!1;if(s<0||e<0||s>=Ih.gi().mapdata.iMapWidth||e>=Ih.gi().mapdata.iMapHeight)return!1;var h,a,n,o,r,c,l,b;for(this.boom[parseInt(t/this.iBlockHeight)][parseInt(i/this.iBlockWidth)]=3,this.tmpst[0][0]=parseInt(i/this.iBlockWidth),this.tmpst[0][1]=parseInt(t/this.iBlockHeight),r=0,c=1,l=1,b=1,n=3;;){for(o=r;o<c;o++)h=this.tmpst[o%4096][0],a=this.tmpst[o%4096][1],h-1>=0&&2==this.boom[a][h-1]&&this.bCanMove(h*this.iBlockWidth,a*this.iBlockHeight,(h-1)*this.iBlockWidth,a*this.iBlockHeight)&&(this.boom[a][h-1]=n+1,this.tmpst[b%4096][0]=h-1,this.tmpst[b%4096][1]=a,b++),h+1<this.iMapWidth/this.iBlockWidth&&2==this.boom[a][h+1]&&this.bCanMove(h*this.iBlockWidth,a*this.iBlockHeight,(h+1)*this.iBlockWidth,a*this.iBlockHeight)&&(this.boom[a][h+1]=n+1,this.tmpst[b%4096][0]=h+1,this.tmpst[b%4096][1]=a,b++),a-1>=0&&2==this.boom[a-1][h]&&this.bCanMove(h*this.iBlockWidth,a*this.iBlockHeight,h*this.iBlockWidth,(a-1)*this.iBlockHeight)&&(this.boom[a-1][h]=n+1,this.tmpst[b%4096][0]=h,this.tmpst[b%4096][1]=a-1,b++),a+1<this.iMapHeight/this.iBlockHeight&&2==this.boom[a+1][h]&&this.bCanMove(h*this.iBlockWidth,a*this.iBlockHeight,h*this.iBlockWidth,(a+1)*this.iBlockHeight)&&(this.boom[a+1][h]=n+1,this.tmpst[b%4096][0]=h,this.tmpst[b%4096][1]=a+1,b++);if(this.boom[parseInt(e/this.iBlockHeight)][parseInt(s/this.iBlockWidth)]>2)return this.getback(parseInt(s/this.iBlockWidth),parseInt(e/this.iBlockHeight)),!0;if(l==b)break;r=l,c=b,l=b,n++}return!1}findway____(i,t,s,e){if(console.log("寻路3"),i<0||t<0||i>=Ih.gi().mapdata.iMapWidth||t>=Ih.gi().mapdata.iMapHeight)return!1;if(s<0||e<0||s>=Ih.gi().mapdata.iMapWidth||e>=Ih.gi().mapdata.iMapHeight)return!1;var h,a,n,o;for(boom[parseInt(t/this.iBlockHeight)][parseInt(i/this.iBlockWidth)]=3,n=3,o=1;o>0;){for(o=0,h=0;h<this.iMapWidth/this.iBlockWidth;h++)for(a=0;a<this.iMapHeight/this.iBlockHeight;a++)this.boom[a][h]==n&&(h-1>=0&&2==this.boom[a][h-1]&&this.bCanMove(h*this.iBlockWidth,a*this.iBlockHeight,(h-1)*this.iBlockWidth,a*this.iBlockHeight)&&(boom[a][h-1]=n+1,o++),h+1<this.iMapWidth/this.iBlockWidth&&2==this.boom[a][h+1]&&this.bCanMove(h*this.iBlockWidth,a*this.iBlockHeight,(h+1)*this.iBlockWidth,a*this.iBlockHeight)&&(this.boom[a][h+1]=n+1,o++),a-1>=0&&2==this.boom[a-1][h]&&this.bCanMove(h*this.iBlockWidth,a*this.iBlockHeight,h*this.iBlockWidth,(a-1)*this.iBlockHeight)&&(this.boom[a-1][h]=n+1,o++),a+1<this.iMapHeight/this.iBlockHeight&&2==this.boom[a+1][h]&&this.bCanMove(h*this.iBlockWidth,a*this.iBlockHeight,h*this.iBlockWidth,(a+1)*this.iBlockHeight)&&(this.boom[a+1][h]=n+1,o++));if(this.boom[parseInt(e/this.iBlockHeight)][parseInt(s/this.iBlockWidth)]>2)return this.getback(parseInt(s/this.iBlockWidth),parseInt(e/this.iBlockHeight)),!0;if(++n>=256)return!1}return!1}getback(i,t){var s;for(this.iPathDeep=this.boom[t][i],s=this.iPathDeep-2;s>1;)this.iPath[s][0]=i*this.iBlockWidth,this.iPath[s][1]=t*this.iBlockHeight,s--,i-1>=0&&this.boom[t][i-1]==this.boom[t][i]-1&&this.bCanMove(i*this.iBlockWidth,t*this.iBlockHeight,(i-1)*this.iBlockWidth,t*this.iBlockHeight)?i--:i+1<this.iMapWidth/this.iBlockWidth&&this.boom[t][i+1]==this.boom[t][i]-1&&this.bCanMove(i*this.iBlockWidth,t*this.iBlockHeight,(i+1)*this.iBlockWidth,t*this.iBlockHeight)?i++:t-1>=0&&this.boom[t-1][i]==this.boom[t][i]-1&&this.bCanMove(i*this.iBlockWidth,t*this.iBlockHeight,i*this.iBlockWidth,(t-1)*this.iBlockHeight)?t--:t+1<this.iMapHeight/this.iBlockHeight&&this.boom[t+1][i]==this.boom[t][i]-1&&this.bCanMove(i*this.iBlockWidth,t*this.iBlockHeight,i*this.iBlockWidth,(t+1)*this.iBlockHeight)&&t++;this.iPath[s][0]=i*this.iBlockWidth,this.iPath[s][1]=t*this.iBlockHeight}bCanMoveEx(i,t,s,e){var h,a,n,o,r,c;if(s!=i)o=-1,r=1*t-(n=1*(e-t)/(s-i))*i;else{if(e==t)return!1;o=-1*(i-s)/(t-e),r=-(1*i-(n=1)*t)}for(h=0;h<P.MAXPATHCOUNT;h++)if(null!=this.pps[h])for(a=0;a<this.pps[h].iPathCount;a++)if(!(this.pps[h].path[a][0]<i&&this.pps[h].path[a][0]<s||this.pps[h].path[a][0]>i&&this.pps[h].path[a][0]>s||this.pps[h].path[a][1]<t&&this.pps[h].path[a][1]<e||this.pps[h].path[a][1]>t&&this.pps[h].path[a][1]>e||((c=n*this.pps[h].path[a][0]+o*this.pps[h].path[a][1]+r)<0&&(c=-c),!((c/=Math.sqrt(n*n+o*o))<10))))return!1;return!0}pullline(){var i,t;for(t=0,i=2;i<this.iPathDeep;i++)i!=t+1&&(this.bCanMoveEx(this.iPath[t][0],this.iPath[t][1],this.iPath[i][0],this.iPath[i][1])&&this.bCanMove(this.iPath[t][0],this.iPath[t][1],this.iPath[i][0],this.iPath[i][1])?(this.iPath[t+1][0]=this.iPath[i][0],this.iPath[t+1][1]=this.iPath[i][1]):(t++,i--));this.iPathDeep=t+2}checkagain(){var i;for(i=1;i<this.iPathDeep;i++)if(!this.bCanMove(this.iPath[i-1][0],this.iPath[i-1][1],this.iPath[i][0],this.iPath[i][1]))return!1;return!0}findway1(i,t,s,e){if(bn.llength(i,t,s,e)<20)return!1;var h,a,n,o,r,c=0,l=0;if(s<0||e<0||s>Ih.gi().mapdata.iMapWidth||e>Ih.gi().mapdata.iMapHeight)return!1;for(o=999999,r=!1,Sh.bAutoBoom=!1,h=0;h<P.MAXPATHCOUNT;h++)if(null!=this.pps[h])for(a=1;a<this.pps[h].iPathCount;a++)i<this.pps[h].path[a-1][0]&&s<this.pps[h].path[a-1][0]&&i<this.pps[h].path[a][0]&&s<this.pps[h].path[a][0]||i>this.pps[h].path[a-1][0]&&s>this.pps[h].path[a-1][0]&&i>this.pps[h].path[a][0]&&s>this.pps[h].path[a][0]||t<this.pps[h].path[a-1][1]&&e<this.pps[h].path[a-1][1]&&t<this.pps[h].path[a][1]&&e<this.pps[h].path[a][1]||t>this.pps[h].path[a-1][1]&&e>this.pps[h].path[a-1][1]&&t>this.pps[h].path[a][1]&&e>this.pps[h].path[a][1]||P.llcollision_ai(i,t,s,e,this.pps[h].path[a-1][0],this.pps[h].path[a-1][1],this.pps[h].path[a][0],this.pps[h].path[a][1])&&((n=bn.llength(i,t,P.iJx,P.iJy))<o||!r)&&(this.iBx1=this.pps[h].path[a-1][0],this.iBy1=this.pps[h].path[a-1][1],this.iBx2=this.pps[h].path[a][0],this.iBy2=this.pps[h].path[a][1],c=P.iJx,l=P.iJy,o=n,r=!0,Sh.bAutoBoom=!0);if(r){var b,_=0,f=0,u=0,d=0,p=0,m=0;b=bn.GetAngleXY_ext(iBx1,iBy1,iBx2,iBy2),_=80*Math.cos(b+.15),f=80*Math.sin(b+.15),u=80*Math.cos(b-.15),d=80*Math.sin(b-.15),p=80*Math.cos(b),m=80*Math.sin(b),(h=bn.llength(i,t,c+p,l+m))>(a=bn.llength(i,t,c-p,l-m))||(_=-_,f=-f,u=-u,d=-d,p=-p,m=-m);var g=this.bCanMove(i,t,i+_,t+f),w=this.bCanMove(i,t,i+u,t+d);return!!this.bCanMove(i,t,i+p,t+m)&&(g&&w?(this.iPath[0][0]=i,this.iPath[0][1]=t,this.iPath[1][0]=i+5*p/8,this.iPath[1][1]=t+5*m/8,this.iPathDeep=2,!0):!g&&w?(this.iPath[0][0]=i,this.iPath[0][1]=t,this.iPath[1][0]=i+5*u/8,this.iPath[1][1]=t+5*d/8,this.iPathDeep=2,!0):!(!g||w)&&(this.iPath[0][0]=i,this.iPath[0][1]=t,this.iPath[1][0]=i+5*_/8,this.iPath[1][1]=t+5*f/8,this.iPathDeep=2,!0))}return this.iPath[0][0]=i,this.iPath[0][1]=t,this.iPath[1][0]=s,this.iPath[1][1]=e,this.iPathDeep=2,!0}}Sh.bAutoBoom=!1;class Dh{constructor(){this.sName=""}}class Th extends Dh{constructor(i){super(),this.xani=new S(i)}}class Ch extends Dh{constructor(){super(),this.sImageName="",this.iRid=-1}}class kh extends Dh{constructor(){var i,t;for(super(),this.iRid=new Array(10),i=0;i<10;i++)for(this.iRid[i]=new Int32Array(10),t=0;t<10;t++)this.iRid[i][t]=-1}}class Ah{constructor(){this.sMapName="",this.iMapId=-1}}class Ih{constructor(){var i;for(this.iOffx=0,this.iOffy=0,this.xm3f=c.gi(),this.pSourceIndex=new Dh(Ih.SOURCECOUNT),this.pSourceList=new Dh(Ih.SOURCECOUNT),i=0;i<Ih.SOURCECOUNT;i++)this.pSourceIndex[i]=null,this.pSourceList[i]=null;for(this.mapdata=new P,this.mfy=new Sh,this.vbk=new Ye(this.xm3f),this.maplist=new Ah(Ih.MAXMAPCOUNT),i=0;i<Ih.MAXMAPCOUNT;i++)this.maplist[i]=new Ah;this.sCurrentMapName="",this.bMapLoaded=!1,this.iMapChangeing=0,this.bOpenProjected=!1,this.bLoadSourced=!1,this.iLoadStat=0,this.iKeepDetialAsMapId=-1}LoadMapList(){var i,t,s,e;for(i=0;i<gn.de_map.iDataCount;i++)for(e=gn.de_map.datas[i].iDid,this.maplist[e].iMapId=e,t=0;t<gn.de_map.datas[i].iItemCount;t++)for(s=0;s<gn.de_map.datas[i].items[t].iValueCount;s++)2==gn.de_map.datas[i].items[t].values[s].iVid&&(this.maplist[e].sMapName=gn.de_map.datas[i].items[t].values[s].sValue)}IdToName(i){var t;for(t=0;t<Ih.MAXMAPCOUNT;t++)if(this.maplist[t].iMapId==i)return this.maplist[t].sMapName;return""}NameToId(i){var t;for(t=0;t<Ih.MAXMAPCOUNT;t++)if(gn.sop("------------"+this.maplist[t].sMapName+"==="+i+"------------"),this.maplist[t].sMapName==i)return this.maplist[t].iMapId;return-1}LoadLogic(){switch(this.iLoadStat){case 0:this.sProjectPath="res/datapackage/maps",this.pls=u.gi(),this.OpenProject(),this.iLoadStat=1;break;case 1:this.bOpenProjected&&(this.iLoadStat=2,this.LoadSource());break;case 2:this.bLoadSourced&&(this.iLoadStat=3,this.Load2Source());break;case 3:for(var i=0;i<this.iSourceCount;i++)if(!this.pSourceList[i].bLoaded)return!1;this.iLoadStat=4,this.vbk.LoadNpcs(this.pls,this.sProjectPath+"/npcs");break;case 4:this.vbk.ani_npcs.bLoadSuccess&&(this.iLoadStat=5);break;case 5:return!0}return!1}Load2Source(){for(var i=0;i<this.iSourceCount;i++)gn.sop("载入:"+this.pSourceList[i].iType+","+this.pSourceList[i].sName),this.pSourceList[i].bLoaded=!1,this._Load2Source(i,bn.BASE_URL+this.sProjectPath+"/source_"+this.pSourceList[i].sName+"/config.dat")}_Load2Source(i,t,s){if(null!=s){var e,h,a;this.pSourceList[i].bLoaded=!0,this.pls.GetData3(s);var n="datapackage/maps";switch(this.pls.GetNextByte(),this.pls.GetNextByte(),this.pSourceList[i].iType){case 0:e=this.pSourceList[i],this.pls.GetNextString(),this.pls.GetNextString(),e.iSid=this.pls.GetNextInt(),e.xani.LoadAnima_fullpath(this.sProjectPath+"/source_"+this.pSourceList[i].sName,this.pls,!0),this.pSourceIndex[e.iSid]=e;break;case 1:h=this.pSourceList[i],this.pls.GetNextString(),this.pls.GetNextString(),h.iSid=this.pls.GetNextInt(),this.pls.GetNextString(),h.sImageName=this.pls.GetNextString(),h.iBw=this.pls.GetNextInt(),h.iBh=this.pls.GetNextInt(),gn.sop(this.sProjectPath+"/source_"+this.pSourceList[i].sName+"/"+h.sImageName),h.sImageName=n+"/source_"+this.pSourceList[i].sName+"/"+h.sImageName,h.iRid=-1,this.pSourceIndex[h.iSid]=h;break;case 2:a=this.pSourceList[i],this.pls.GetNextString(),this.pls.GetNextString(),a.iSid=this.pls.GetNextInt(),this.pls.GetNextString(),this.pls.GetNextString(),a.ww=this.pls.GetNextInt(),a.hh=this.pls.GetNextInt(),a.w=this.pls.GetNextInt(),a.h=this.pls.GetNextInt(),a.sImagePath=n+"/source_"+this.pSourceList[i].sName+"/",this.pSourceIndex[a.iSid]=a}}else Laya.loader.load(t,Laya.Handler.create(this,this._Load2Source,[i,t]),null,Laya.Loader.BUFFER)}OpenProject(){this._OpenProject(this,bn.BASE_URL+this.sProjectPath+"/project.dat")}_OpenProject(i,t,s){null!=s?(this.pls.GetData3(s),this.pls.GetNextByte(),gn.sop("打开工程:"+this.pls.GetNextString()),this.iBlockWidth=this.pls.GetNextInt(),this.iBlockHeight=this.pls.GetNextInt(),gn.sop("BW:"+this.iBlockWidth+",BH:"+this.iBlockHeight),this.LoadMapList(),this.bOpenProjected=!0):Laya.loader.load(t,Laya.Handler.create(this,this._OpenProject,[this,t]),null,Laya.Loader.BUFFER)}LoadSource(){this._LoadSource(this,bn.BASE_URL+this.sProjectPath+"/sourceconfig.dat")}_LoadSource(i,t,s){if(null!=s){var e,h;for(this.bLoadSourced=!0,e=0,this.pls.GetData3(s),this.pls.GetNextByte(),e=0,h=this.pls.GetNextByte();h>=0;){switch(h){case 0:this.pSourceList[e]=new Th(this.xm3f);break;case 1:this.pSourceList[e]=new Ch;break;case 2:this.pSourceList[e]=new kh}this.pSourceList[e].iType=h,this.pSourceList[e].sName=this.pls.GetNextString(),gn.sop("["+e+"]Source:"+h+","+this.pSourceList[e].sName),h=this.pls.GetNextByte(),e++}this.iSourceCount=e}else Laya.loader.load(t,Laya.Handler.create(this,this._LoadSource,[this,t]),null,Laya.Loader.BUFFER)}LoadMap(i,t,s,e){this.iVisualMapId=t,this.iCurrentMapId!=i&&(gn.gi().mapChanging.changed=!1,this.sCurrentMapName=this.IdToName(i),this.iCurrentMapId=i,this._LoadMap(this,bn.BASE_URL+this.sProjectPath+"/maps/"+this.sCurrentMapName),gn.sop(this.sProjectPath+"/"+this.sCurrentMapName))}_LoadMap(i,t,s){if(null!=s){var e,h,a,n,o;for(this.pls.GetData3(s),this.pls.xordata(this.pls.iLength),this.pls.GetNextByte(),this.pls.GetNextInt(),this.mapdata.sMapName=this.pls.GetNextString(),this.iCurrentMapId==this.iKeepDetialAsMapId?(this.iKeepDetialAsMapId=-1,this.pls.GetNextString()):this.mapdata.sMapDetail=this.pls.GetNextString(),this.mapdata.iMapWidth=this.pls.GetNextInt(),this.mapdata.iMapHeight=this.pls.GetNextInt(),this.mapdata.iGroundSourceId=this.pls.GetNextInt(),this.mapdata.iMapFlag=0,this.mapdata.iBCW=parseInt((this.mapdata.iMapWidth+this.iBlockWidth-1)/this.iBlockWidth),this.mapdata.iBCH=parseInt((this.mapdata.iMapHeight+this.iBlockHeight-1)/this.iBlockHeight),gn.sop("open map:"+this.mapdata.sMapName+","+this.mapdata.iMapWidth+","+this.mapdata.iMapHeight+","+this.mapdata.iBCW+","+this.mapdata.iBCH),this.mapdata.InitCutLevel(),gn.sop("at 1="+this.pls.iOffset),n=this.pls.GetNextInt(),o=0,e=0;e<3;e++)for(h=0;h<this.mapdata.iBCH;h++)for(a=0;a<this.mapdata.iBCW;a++)o>=n&&(this.mapdata.cutlevel[e][h][a][0]=this.pls.GetNextShort(),-1==this.mapdata.cutlevel[e][h][a][0]?(n=this.pls.GetNextInt(),o=0):this.mapdata.cutlevel[e][h][a][1]=this.pls.GetNextShort()),o++;for(gn.sop("at 2="+this.pls.iOffset),e=0;e<3;e++)for(h=0;-1!=(a=this.pls.GetNextShort());)this.mapdata.animalevel[e][h]=new A,this.mapdata.animalevel[e][h].sourceId=a,this.mapdata.animalevel[e][h].iX=this.pls.GetNextInt(),this.mapdata.animalevel[e][h].iY=this.pls.GetNextInt(),this.mapdata.animalevel[e][h].sName=this.pls.GetNextString(),this.pSourceIndex[this.mapdata.animalevel[e][h].sourceId].xani.InitAnimaWithName(this.mapdata.animalevel[e][h].sName,this.mapdata.animalevel[e][h].aa),h++;for(e=0,a=this.pls.GetNextByte();a>0;){for(this.mapdata.pps[e]=new I(a),h=0;h<a;h++)this.mapdata.pps[e].path[h][0]=this.pls.GetNextShort(),this.mapdata.pps[e].path[h][1]=this.pls.GetNextShort();e++,a=this.pls.GetNextByte()}gn.sop("at 3="+this.pls.iOffset),this.vbk.LoadVisual(this.pls),this.mfy.initboom(this.vbk.iBoomX,this.vbk.iBoomY,this.mapdata.iMapWidth,this.mapdata.iMapHeight,this.iBlockWidth,this.iBlockHeight),gn.sop("at 4="+this.pls.iOffset),this.bMapLoaded=!0,1==gn.iTraverse&&this.RemoveTraverse(0)}else Laya.loader.load(t,Laya.Handler.create(i,i._LoadMap,[i,t]),null,Laya.Loader.BUFFER)}RemoveTraverse(i){var t;if(0==i&&3==this.iCurrentMapId)for(t=0;t<P.MAXPATHCOUNT&&null!=this.mapdata.pps[t];t++)if(1248==this.mapdata.pps[t].path[0][0]&&713==this.mapdata.pps[t].path[0][1])return this.mapdata.pps[t].iPathCount=0,void this.mfy.initboom(this.vbk.iBoomX,this.vbk.iBoomY,this.mapdata.iMapWidth,this.mapdata.iMapHeight,this.iBlockWidth,this.iBlockHeight)}mto(i,t){var s,e;this.vbk.CheckNow(i,t),this.vbk.bFaceToFace&&(this.vbk.bFaceToFace=!1,xs.jq.iGoToNpc=0,xh.me.ChangeStat("站立")),s=h.SCRW/2-i,e=h.SCRH/2-t,s>0&&(s=0),s<h.SCRW-this.mapdata.iMapWidth&&(s=h.SCRW-this.mapdata.iMapWidth),e>0&&(e=0),e<h.SCRH-this.mapdata.iMapHeight&&(e=h.SCRH-this.mapdata.iMapHeight),this.iOffx=s,this.iOffy=e,this.mapdata.iMapWidth<h.SCRW&&(this.iOffx=(h.SCRW-this.mapdata.iMapWidth)/2),this.mapdata.iMapHeight<h.SCRH&&(this.iOffy=(h.SCRH-this.mapdata.iMapHeight)/2)}Draw(){var i,t,s,a,n,o,r,l,b;for(o=-this.iOffx/this.iBlockWidth,r=-this.iOffy/this.iBlockHeight,l=o+(h.SCRW+this.iBlockWidth-1)/this.iBlockWidth+1,b=r+(h.SCRH+this.iBlockHeight-1)/this.iBlockHeight+1,l>this.mapdata.iBCW&&(l=this.mapdata.iBCW),b>this.mapdata.iBCH&&(b=this.mapdata.iBCH),i=0;i<3;i++){for(t=r;t<b;t++)for(s=o;s<l;s++)-1!=this.mapdata.cutlevel[i][t][s][0]&&(-1==(a=this.pSourceIndex[this.mapdata.cutlevel[i][t][s][0]]).iRid&&(a.iRid=c.gi().LoadFromFile(a.sImageName,-1,e.bFromSD)),this.xm3f.DrawImageEx(0,this.iOffx+s*this.iBlockWidth,this.iOffy+t*this.iBlockHeight,a.iRid,this.mapdata.cutlevel[i][t][s][1]%a.iBw*this.iBlockWidth,this.mapdata.cutlevel[i][t][s][1]/a.iBw*this.iBlockHeight,this.iBlockWidth,this.iBlockHeight,100,1,1,0,0,0));for(t=0;t<256;t++)null!=this.mapdata.animalevel[i][t]&&((n=this.pSourceIndex[this.mapdata.animalevel[i][t].sourceId]).xani.DrawAnima_aa(this.iOffx+this.mapdata.animalevel[i][t].iX,this.iOffy+this.mapdata.animalevel[i][t].iY,this.mapdata.animalevel[i][t].aa),n.xani.NextFrame(this.mapdata.animalevel[i][t].aa))}}DrawGround(){var i,t,s,a,n;if(this.idsx=-this.iOffx/this.iBlockWidth,this.idsy=-this.iOffy/this.iBlockHeight,this.idsw=this.idsx+(h.SCRW+this.iBlockWidth-1)/this.iBlockWidth+1,this.idsh=this.idsy+(h.SCRH+this.iBlockHeight-1)/this.iBlockHeight+1,this.idsx<0&&(this.idsx=0),this.idsy<0&&(this.idsy=0),this.idsw>this.mapdata.iBCW&&(this.idsw=this.mapdata.iBCW),this.idsh>this.mapdata.iBCH&&(this.idsh=this.mapdata.iBCH),this.mapdata.iGroundSourceId>=0){var o=this.pSourceIndex[this.mapdata.iGroundSourceId];for(i=0;i<o.ww;i++)for(t=0;t<o.hh;t++)s=this.iOffx+512*i,a=this.iOffy+512*t,-1==o.iRid[t][i]&&(o.iRid[t][i]=c.gi().LoadFromFile(o.sImagePath+"spirit_"+i+"_"+t+".png",-1,e.bFromSD)),s+512<0||s>=h.SCRW||a+512<0||a>=h.SCRH||this.xm3f.DrawImageEx(0,s,a,o.iRid[t][i],0,0,512,512,100,1,1,0,0,0)}for(i=0,t=0;t<256;t++)null!=this.mapdata.animalevel[i][t]&&((n=this.pSourceIndex[this.mapdata.animalevel[i][t].sourceId]).xani.DrawAnima_aa(this.iOffx+this.mapdata.animalevel[i][t].iX,this.iOffy+this.mapdata.animalevel[i][t].iY,this.mapdata.animalevel[i][t].aa),n.xani.NextFrame(this.mapdata.animalevel[i][t].aa));if(this.mapdata.iMapWidth<h.SCRW&&this.mapdata.iMapWidth%512!=0&&M2DFast.xm3f.FillRect_2D(this.iOffx+this.mapdata.iMapWidth,this.iOffy,h.SCRW,h.SCRH,4278190080),this.mapdata.iMapHeight<h.SCRH&&this.mapdata.iMapHeight%512!=0&&M2DFast.xm3f.FillRect_2D(this.iOffx,this.iOffy+this.mapdata.iMapHeight,h.SCRW,h.SCRH,4278190080),this.iCurrentMapId>=41&&this.iCurrentMapId<=45)for(i=0;i<ji.iMaxArable;i++)0!=(ji.iArableGrow&1<<i)?gn.xani_grow.DrawAnima(this.iOffx+ji.iArableOff[i][0],this.iOffy+ji.iArableOff[i][1],ji.sLandName[this.iCurrentMapId-41]+"地块",0):ji.bShowBlock&&gn.xani_grow.DrawAnima(this.iOffx+ji.iArableOff[i][0],this.iOffy+ji.iArableOff[i][1],"选择地块",0);1==gn.iTraverse&&3==this.iCurrentMapId&&gn.xani_ui4.DrawAnima(this.iOffx+1218,this.iOffy+718,"西阳补路",0),Q.te.Draw()}DrawMiddleDirect(){var i,t;for(1,i=0;i<256;i++)null!=this.mapdata.animalevel[1][i]&&((t=this.pSourceIndex[this.mapdata.animalevel[1][i].sourceId]).xani.DrawAnima_aa(this.iOffx+this.mapdata.animalevel[1][i].iX,this.iOffy+this.mapdata.animalevel[1][i].iY,this.mapdata.animalevel[1][i].aa),t.xani.NextFrame(this.mapdata.animalevel[1][i].aa))}DrawMiddle(i){var t,s;for(1,t=0;t<256;t++)null!=this.mapdata.animalevel[1][t]&&(s=this.pSourceIndex[this.mapdata.animalevel[1][t].sourceId],i.DrawAnima_aa(this.iOffy+this.mapdata.animalevel[1][t].iY,s.xani,this.iOffx+this.mapdata.animalevel[1][t].iX,this.iOffy+this.mapdata.animalevel[1][t].iY,this.mapdata.animalevel[1][t].aa),s.xani.NextFrame(this.mapdata.animalevel[1][t].aa));this.vbk.DrawNpcInBuffer(i,this.iOffx,this.iOffy)}DrawSky(){var i,t;for(2,i=0;i<256;i++)null!=this.mapdata.animalevel[2][i]&&((t=this.pSourceIndex[this.mapdata.animalevel[2][i].sourceId]).xani.DrawAnima_aa(this.iOffx+this.mapdata.animalevel[2][i].iX,this.iOffy+this.mapdata.animalevel[2][i].iY,this.mapdata.animalevel[2][i].aa),t.xani.NextFrame(this.mapdata.animalevel[2][i].aa))}}Ih.MAXMAPCOUNT=128,Ih.SOURCECOUNT=128,Ih.mm=null,Ih.gi=function(){return null==Ih.mm&&(Ih.mm=new Ih),Ih.mm};class Ph{constructor(){this.MAXMESSAGESIZE=2048,this.iSize,this.data=new Uint8Array(this.MAXMESSAGESIZE)}copyfrom(i){this.iSize=i.iSize,bn.arraycopy(i.data,0,this.data,0,this.iSize)}}class Nh{constructor(){var i;for(this.MAXRECVBUFFERCOUNT=64,this.MAXSENDBUFFERCOUNT=64,this.iRecvHead=0,this.iRecvTail=0,this.recv=new Array(this.MAXRECVBUFFERCOUNT),i=0;i<this.MAXRECVBUFFERCOUNT;i++)this.recv[i]=new Ph;for(this.recvout=new Ph,this.iSendHead=0,this.iSendTail=0,this.send=new Array(this.MAXSENDBUFFERCOUNT),i=0;i<this.MAXSENDBUFFERCOUNT;i++)this.send[i]=new Ph;this.sendout=new Ph,this.bStartMessage=!1,this.bEndMessage=!1,this.startmessage=new Ph,this.endmessage=new Ph}ResetQueue(){this.iRecvHead=0,this.iRecvTail=0,this.iSendHead=0,this.iSendTail=0}SetStartMessage(i,t){this.startmessage.iSize=i,bn.arraycopy(t,0,this.startmessage.data,0,i),this.bStartMessage=!0}SetEndMessage(i,t){this.endmessage.iSize=i,bn.arraycopy(t,0,this.endmessage.data,0,i),this.bEndMessage=!0}InSendQueue(i,t){for(;this.iSendTail-this.iSendHead>=this.MAXSENDBUFFERCOUNT;)return!1;var s=this.iSendTail%this.MAXSENDBUFFERCOUNT;return this.send[s].iSize=i,bn.arraycopy(t,0,this.send[s].data,0,i),this.iSendTail++,!0}OutSendQueue(){return!(this.iSendTail-this.iSendHead<=0)&&(this.sendout.copyfrom(this.send[this.iSendHead%this.MAXSENDBUFFERCOUNT]),this.iSendHead++,!0)}InRecvQueue(i,t){for(;this.iRecvTail-this.iRecvHead>=this.MAXRECVBUFFERCOUNT;)return!1;var s=this.iRecvTail%this.MAXRECVBUFFERCOUNT;return this.recv[s].iSize=i,bn.arraycopy(t,0,this.recv[s].data,0,i),this.iRecvTail++,!0}OutRecvQueue(){return!(this.iRecvTail-this.iRecvHead<=0)&&(this.recvout.copyfrom(this.recv[this.iRecvHead%this.MAXRECVBUFFERCOUNT]),this.iRecvHead++,!0)}}class vh{constructor(i){this.socket=new Laya.Socket,this.socket.on(Laya.Event.OPEN,this,this.onConnect),this.socket.on(Laya.Event.MESSAGE,this,this.onReceive),this.socket.on(Laya.Event.CLOSE,this,this.onClose),this.socket.on(Laya.Event.ERROR,this,this.onError),this.sConnectUrl=i,this.socket.connectByUrl(this.sConnectUrl),this.bConnected=!1,this.pls=new u(10240),this.pls_package=new u(10240),this.pls_ext=new u(10240),this.msg=new Nh,this.iLastSendMs=bn.get_ms(),this.bAllow=!0,this.bReconnect=!1,this.byte=new Laya.Byte,this.bWaitingClose=!1,this.iReconnectDelay=0,this.iReTryCount=0}onConnect(){if(this.bConnected=!0,bn.sop("onConnect"),gn.gi().mapChanging.changed){let i=gn.gi().mapChanging.type,t=gn.gi().mapChanging.dest;Mh.gi().s_ChangeMapNew(i,t)}}onReceive(i){this.byte.clear(),this.byte.writeArrayBuffer(i),this.byte.pos=0;for(var t=0;t<this.byte.length;t++){var s=this.byte.getByte();s<0&&(s=256+s),this.pls_package.databuf[t]=s}this.pls_package.iLength=this.byte.length,this.pls_package.iOffset=0,this.AnalyzePackage()}onClose(){bn.sop("onClose"),this.bConnected=!1,this.bWaitingClose=!1}onError(){bn.sop("onError"),this.socket.close(),this.bConnected=!1}Init1(){this.pls_ext.iOffset=0,this.pls_ext.InsertInt(0),this.pls_ext.InsertInt(0),this.pls_ext.InsertInt(0),this.InQueue(500,this.pls_ext.iOffset,this.pls_ext.databuf)}InQueue(i,t,s){return bn.sop("---send "+i+" : "+t),this.pls.iOffset=0,this.pls.InsertShort(i),bn.arraycopy(s,0,this.pls.databuf,this.pls.iOffset,t),this.msg.InSendQueue(this.pls.iOffset+t,this.pls.databuf)}GetQueue(){return this.msg.OutRecvQueue()}CreatePackage(){var i=0;for(ln.gi().bGameing()&&Mh.gi().s_UploadMyPos(),this.pls_package.iOffset=10,this.msg.bStartMessage?(this.pls_package.InsertData(this.msg.startmessage.data,this.msg.startmessage.iSize),i++):this.msg.iSendTail-this.msg.iSendHead<=0&&this.Init1();this.msg.OutSendQueue()&&(this.pls_package.InsertData(this.msg.sendout.data,this.msg.sendout.iSize),i++,!(this.pls_package.iOffset>=1024)););this.msg.bEndMessage&&(this.pls_package.InsertData(this.msg.endmessage.data,this.msg.endmessage.iSize),i++),this.pls_package.databuf[this.pls_package.iOffset++]="E".charCodeAt(0),this.pls_package.databuf[this.pls_package.iOffset++]="O".charCodeAt(0),this.pls_package.databuf[this.pls_package.iOffset++]="F".charCodeAt(0),this.pls_package.databuf[0]="s".charCodeAt(0),this.pls_package.databuf[1]="o".charCodeAt(0),this.pls_package.databuf[2]="s".charCodeAt(0),this.pls_package.databuf[3]=0,this.pls_package.databuf[4]=0,this.pls_package.databuf[5]=0,this.pls_package.databuf[6]=0,this.pls_package.databuf[7]=i,this.pls_package.databuf[8]=this.pls_package.iOffset>>8&255,this.pls_package.databuf[9]=255&this.pls_package.iOffset}Sleep(i){Thread.sleep(i)}send(){for(var i=0;i<this.pls_package.iOffset;i++)this.socket.output.writeByte(this.pls_package.databuf[i]);return this.socket.flush(),!0}recv(){var i;for(this.pls_package.iLength=0;!((i=m_is.read(this.pls_package.databuf,this.pls_package.iLength,2048))<=0);){if(this.pls_package.iLength+=i,"E"==this.pls_package.databuf[this.pls_package.iLength-3]&&"O"==this.pls_package.databuf[this.pls_package.iLength-2]&&"F"==this.pls_package.databuf[this.pls_package.iLength-1])return this.pls_package.iOffset=0,!0;if(iLastConnectDelay>1e3){this.bReconnect=!0;break}}return!1}AnalyzePackage(){var i,t;if(this.pls_package.iLength<13||this.pls_package.iLength>=4096)return-1;if(t=this.pls_package.databuf[8]<<8&65280|255&this.pls_package.databuf[9],this.pls_package.iLength<t||t<13||t>=4096)return-1;for(i=this.pls_package.databuf[7],this.pls_package.iOffset=10;i>0;)this.pls_package.GetNextData(),this.msg.InRecvQueue(this.pls_package.obi,this.pls_package.obd),i--;return t}ResetSever(i){this.sConnectUrl!=i&&(this.sConnectUrl=i,bn.sop("ResetSever:"+i),this.msg.ResetQueue(),this.bReconnect=!0,this.socket.close(),this.bWaitingClose=!0)}NetLogic(){this.bAllow&&(this.bWaitingClose||(this.bConnected?this.iLastSendMs+600>bn.get_ms()||(this.iLastSendMs=bn.get_ms(),this.CreatePackage(),this.send()):this.bReconnect?(this.socket.connectByUrl(this.sConnectUrl),bn.sop("do connect"),this.bReconnect=!1):this.iReTryCount<10&&(this.iReconnectDelay++,this.iReconnectDelay>=60&&(this.iReconnectDelay=0,this.bReconnect=!0,this.iReTryCount++))))}NetBusy(){return 3}InitClient(i,t){return gn.sop("connect:"+i+":"+t),sock=new Socket(i,t),m_os=sock.getOutputStream(),m_is=sock.getInputStream(),!0}CloseClient(){null!=m_os&&m_os.close(),m_os=null,null!=m_is&&m_is.close(),m_is=null,null!=sock&&sock.close(),sock=null}}class Mh{constructor(i,t){this.pls=new u(3072),this.xntf=t,this.iEchoId=0,this.pos1=0,this.pos2,this.pos3=0,this.ox,this.oy}GetBase(i){this.iSid=i.GetNextInt(),this.iPid=i.GetNextInt(),this.iUid=i.GetNextInt(),this.xntf.msg.SetStartMessage(i.iLength,i.databuf)}set_Head(){this.pls.iOffset=0,this.pls.InsertShort(500),this.pls.InsertInt(this.iSid),this.pls.InsertInt(this.iPid),this.pls.InsertInt(this.iUid),this.pls.InsertInt(e.APKVersion),this.pls.InsertByte(this.iEchoId),this.xntf.msg.SetStartMessage(this.pls.iOffset,this.pls.databuf)}s_CheckVersion(){"0"==Mh.sMid&&(Mh.sMid=""),this.pls.iOffset=0,this.pls.InsertInt(e.APKVersion),this.pls.InsertInt(ph.iClientID),this.pls.InsertString(Mh.sMid),this.xntf.InQueue(510,this.pls.iOffset,this.pls.databuf)}s_CheckReply(i){this.pls.iOffset=0,this.pls.InsertInt(i),this.xntf.InQueue(512,this.pls.iOffset,this.pls.databuf)}s_Check2Reply(i){this.pls.iOffset=0,this.pls.InsertInt(i),this.xntf.InQueue(514,this.pls.iOffset,this.pls.databuf)}s_ClientExp(i){this.pls.iOffset=0,this.pls.InsertString(i),this.xntf.InQueue(513,this.pls.iOffset,this.pls.databuf)}s_Regist(i,t){this.pls.iOffset=0,this.pls.InsertString(i),this.pls.InsertString(t),this.xntf.InQueue(1e3,this.pls.iOffset,this.pls.databuf)}s_Login(i,t){this.pls.iOffset=0,this.pls.InsertString(i),this.pls.InsertString(t),this.xntf.InQueue(1001,this.pls.iOffset,this.pls.databuf)}s_Login_xyx(i,t,s){this.pls.iOffset=0,this.pls.InsertInt(i),this.pls.InsertString(t),this.pls.InsertString(s),this.xntf.InQueue(4002,this.pls.iOffset,this.pls.databuf)}s_GetRoleList(i,t){this.pls.iOffset=0,this.pls.InsertInt(i),this.pls.InsertInt(t),this.xntf.InQueue(1006,this.pls.iOffset,this.pls.databuf)}s_GetSeverList(i){this.pls.iOffset=0,this.pls.InsertByte(i),this.xntf.InQueue(1003,this.pls.iOffset,this.pls.databuf)}s_CreateRole(i,t,s,e,h){this.pls.iOffset=0,this.pls.InsertInt(i),this.pls.InsertInt(t),this.pls.InsertString(s),this.pls.InsertByte(e),this.pls.InsertByte(h),this.xntf.InQueue(1004,this.pls.iOffset,this.pls.databuf)}s_StartGame(i){this.pls.iOffset=0,this.pls.InsertInt(i),this.pls.InsertInt(e.GV),console.log("请求进入游戏：",i,this.pls),this.xntf.InQueue(1005,this.pls.iOffset,this.pls.databuf)}s_GetRandName(i){this.pls.iOffset=0,this.pls.InsertInt(i),this.xntf.InQueue(1007,this.pls.iOffset,this.pls.databuf)}s_UpgradeMe(i){this.pls.iOffset=0,this.pls.InsertShort(i),this.xntf.InQueue(2001,this.pls.iOffset,this.pls.databuf)}s_AddPoint(i,t,s,e,h){this.pls.iOffset=0,this.pls.InsertShort(i),this.pls.InsertShort(t),this.pls.InsertShort(s),this.pls.InsertShort(e),this.pls.InsertShort(h),this.xntf.InQueue(2002,this.pls.iOffset,this.pls.databuf)}s_GetInSchool(i){this.pls.iOffset=0,this.pls.InsertByte(i),this.xntf.InQueue(2003,this.pls.iOffset,this.pls.databuf)}s_learnschoolskill(i,t){this.pls.iOffset=0,this.pls.InsertInt(i),this.pls.InsertByte(t),this.xntf.InQueue(2004,this.pls.iOffset,this.pls.databuf)}s_setflag(i,t,s){this.pls.iOffset=0,this.pls.InsertInt(i),this.pls.InsertInt(t),this.pls.InsertInt(s),this.xntf.InQueue(2005,this.pls.iOffset,this.pls.databuf)}s_getflag(){this.pls.iOffset=0,this.xntf.InQueue(2006,this.pls.iOffset,this.pls.databuf)}s_proctitle(i,t){this.pls.iOffset=0,this.pls.InsertByte(i),this.pls.InsertString(t),this.xntf.InQueue(2007,this.pls.iOffset,this.pls.databuf)}s_changenick(i){this.pls.iOffset=0,this.pls.InsertString(i),this.xntf.InQueue(2008,this.pls.iOffset,this.pls.databuf)}s_SetLock(i,t,s){this.pls.iOffset=0,this.pls.InsertByte(i),this.pls.InsertInt(t),this.pls.InsertString(s),this.xntf.InQueue(2009,this.pls.iOffset,this.pls.databuf)}s_PublicChat(i,t){this.pls.iOffset=0,this.pls.InsertByte(i),this.pls.InsertString(t);for(var s=0;s<4;s++)this.pls.InsertByte($t.cext[s].type),$t.cext[s].type>=100||(0==$t.cext[s].type||1==$t.cext[s].type||4==$t.cext[s].type?(this.pls.InsertInt($t.cext[s].eid),this.pls.InsertShort($t.cext[s].tid)):2==$t.cext[s].type&&(this.pls.InsertInt($t.cext[s].eid),this.pls.InsertString($t.cext[s].name),this.pls.InsertString($t.cext[s].detail)));this.xntf.InQueue(2020,this.pls.iOffset,this.pls.databuf)}s_FriendOperate(i,t,s){this.pls.iOffset=0,this.pls.InsertByte(i),this.pls.InsertInt(t),this.pls.InsertInt(s),this.xntf.InQueue(2021,this.pls.iOffset,this.pls.databuf)}s_PrivateChat(i,t,s){this.pls.iOffset=0,this.pls.InsertInt(i),this.pls.InsertString(t),this.pls.InsertString(s);for(var e=0;e<4;e++)this.pls.InsertByte(dt.cext[e].type),dt.cext[e].type>=100||(0==dt.cext[e].type||1==dt.cext[e].type||4==dt.cext[e].type?(this.pls.InsertInt(dt.cext[e].eid),this.pls.InsertShort(dt.cext[e].tid)):2==dt.cext[e].type&&(this.pls.InsertInt(dt.cext[e].eid),this.pls.InsertString(dt.cext[e].name),this.pls.InsertString(dt.cext[e].detail)));this.xntf.InQueue(2022,this.pls.iOffset,this.pls.databuf)}s_ReviewPrivateChat(i){this.pls.iOffset=0,this.pls.InsertInt(i),this.xntf.InQueue(2023,this.pls.iOffset,this.pls.databuf)}s_ChangeMapNew(i,t){gn.gi().mapChanging.changed=!0,gn.gi().mapChanging.type=i,gn.gi().mapChanging.dest=t,this.pls.iOffset=0,this.pls.InsertInt(i),this.pls.InsertInt(t),this.xntf.InQueue(2032,this.pls.iOffset,this.pls.databuf),Ih.gi().iMapChangeing=100}s_ChangeMap(i,t,s){this.pls.iOffset=0,this.pls.InsertInt(i),this.pls.InsertInt(t),this.pls.InsertInt(s),this.xntf.InQueue(2030,this.pls.iOffset,this.pls.databuf),Ih.gi().iMapChangeing=100}s_UploadMyPos(){var i;if(0!=xh.me.iRid){if(this.pls.iOffset=0,this.pls.InsertInt(Ih.gi().iVisualMapId),this.pls.InsertInt(rh.gameing.me.iX),this.pls.InsertInt(rh.gameing.me.iY),this.pls.InsertByte(xh.me.iFace8+10*xh.me.iFace4),this.pos2=bn.get_ms()%1e8,this.pls.InsertInt(parseInt(this.pos2)),H.bTeamLeader()){for(this.pls.InsertByte(1),i=1;i<5;i++)if(0!=H.iTeamRid[i]){var t=rh.gameing.findnrs(H.iTeamRid[i]);null!=t&&(this.pls.InsertInt(t.iRid),this.pls.InsertShort(t.iDx),this.pls.InsertShort(t.iDy),this.pls.InsertByte(t.iDFaceTo))}this.pls.InsertInt(0)}else this.pls.InsertByte(0);0==this.pos1?this.pos1=bn.get_ms():(this.pos2=bn.get_ms()-this.pos1,this.pos1=bn.get_ms(),this.ox=xh.me.iX,this.oy=xh.me.iY),this.xntf.InQueue(2031,this.pls.iOffset,this.pls.databuf)}}s_TeamOperate(i,t,s){this.pls.iOffset=0,this.pls.InsertByte(i),this.pls.InsertInt(t),this.pls.InsertInt(s),this.xntf.InQueue(2035,this.pls.iOffset,this.pls.databuf)}s_TeamOperateEx(i,t,s,e,h){this.pls.iOffset=0,this.pls.InsertByte(i),this.pls.InsertInt(t),this.pls.InsertInt(s),this.pls.InsertInt(e),this.pls.InsertInt(h),this.xntf.InQueue(2035,this.pls.iOffset,this.pls.databuf)}s_TeamOperateEx(i,t,s,e){this.pls.iOffset=0,this.pls.InsertByte(i),this.pls.InsertInt(t),this.pls.InsertInt(s),this.pls.InsertString(e),this.xntf.InQueue(2035,this.pls.iOffset,this.pls.databuf)}s_ChangeZhen(i){this.pls.iOffset=0,this.pls.InsertByte(i),this.xntf.InQueue(2036,this.pls.iOffset,this.pls.databuf)}s_SwapEquipment(i){this.pls.iOffset=0,this.pls.InsertByte(i),this.xntf.InQueue(2044,this.pls.iOffset,this.pls.databuf)}s_MoveGoods(i,t,s,e,h,a){this.pls.iOffset=0,this.pls.InsertInt(i),this.pls.InsertByte(t),this.pls.InsertByte(s),this.pls.InsertInt(e),this.pls.InsertByte(h),this.pls.InsertByte(a),this.xntf.InQueue(2040,this.pls.iOffset,this.pls.databuf)}s_DropGoods(i){this.pls.iOffset=0,this.pls.InsertInt(i),this.xntf.InQueue(2041,this.pls.iOffset,this.pls.databuf)}s_GiveGoods(i,t,s,e){this.pls.iOffset=0,this.pls.InsertByte(i),this.pls.InsertInt(t),this.pls.InsertInt(s),this.pls.InsertInt(e),this.xntf.InQueue(2042,this.pls.iOffset,this.pls.databuf)}s_StartSell(i,t,s,e){this.pls.iOffset=0,this.pls.InsertByte(i),this.pls.InsertInt(t),this.pls.InsertInt(s),this.pls.InsertString(e),this.xntf.InQueue(2043,this.pls.iOffset,this.pls.databuf)}s_StartBuy(i){this.pls.iOffset=0,this.pls.InsertInt(i),this.xntf.InQueue(2045,this.pls.iOffset,this.pls.databuf)}s_MyBuy(i,t,s,e){this.pls.iOffset=0,this.pls.InsertByte(i),this.pls.InsertInt(t),this.pls.InsertInt(s),this.pls.InsertInt(e),this.xntf.InQueue(2046,this.pls.iOffset,this.pls.databuf)}s_UseGoods(i,t,s){this.pls.iOffset=0,this.pls.InsertInt(i),this.pls.InsertByte(t),this.pls.InsertString(s),this.xntf.InQueue(2047,this.pls.iOffset,this.pls.databuf)}s_RecoverGoods(i){this.pls.iOffset=0,this.pls.InsertInt(i),this.xntf.InQueue(2048,this.pls.iOffset,this.pls.databuf)}s_NewShopBuy(i,t,s,e){this.pls.iOffset=0,this.pls.InsertInt(i),this.pls.InsertInt(t),this.pls.InsertInt(s),this.pls.InsertInt(e),this.xntf.InQueue(2049,this.pls.iOffset,this.pls.databuf)}s_ChangePetName(i,t){this.pls.iOffset=0,this.pls.InsertInt(i),this.pls.InsertString(t),this.xntf.InQueue(2050,this.pls.iOffset,this.pls.databuf)}s_ChangeFightPet(i){this.pls.iOffset=0,this.pls.InsertInt(i),this.xntf.InQueue(2051,this.pls.iOffset,this.pls.databuf)}s_ChangeFollowPet(i){this.pls.iOffset=0,this.pls.InsertInt(i),this.xntf.InQueue(2057,this.pls.iOffset,this.pls.databuf)}s_PetJJ(i,t,s){this.pls.iOffset=0,this.pls.InsertInt(i),this.pls.InsertInt(t),this.pls.InsertInt(s),this.xntf.InQueue(2058,this.pls.iOffset,this.pls.databuf)}s_DropPet(i){this.pls.iOffset=0,this.pls.InsertInt(i),this.xntf.InQueue(2052,this.pls.iOffset,this.pls.databuf)}s_AddPetPoint(i,t,s,e,h,a){this.pls.iOffset=0,this.pls.InsertInt(i),this.pls.InsertShort(t),this.pls.InsertShort(s),this.pls.InsertShort(e),this.pls.InsertShort(h),this.pls.InsertShort(a),this.xntf.InQueue(2053,this.pls.iOffset,this.pls.databuf)}s_LearnPetSkill(i,t){this.pls.iOffset=0,this.pls.InsertInt(i),this.pls.InsertInt(t),this.xntf.InQueue(2054,this.pls.iOffset,this.pls.databuf)}s_WashPet(i,t){this.pls.iOffset=0,this.pls.InsertInt(i),this.pls.InsertInt(t),this.xntf.InQueue(2055,this.pls.iOffset,this.pls.databuf)}s_OpenStore(i,t,s){this.pls.iOffset=0,this.pls.InsertByte(i),this.pls.InsertInt(t),this.pls.InsertInt(s),this.xntf.InQueue(2056,this.pls.iOffset,this.pls.databuf)}s_SeverSelect(i,t,s){this.pls.iOffset=0,this.pls.InsertByte(i),this.pls.InsertByte(t),this.pls.InsertInt(s),this.xntf.InQueue(2061,this.pls.iOffset,this.pls.databuf)}s_SevConfirm(i){this.pls.iOffset=0,this.pls.InsertString(i),this.xntf.InQueue(2068,this.pls.iOffset,this.pls.databuf)}s_NpcReply(i,t,s){this.pls.iOffset=0,this.pls.InsertInt(i),this.pls.InsertInt(t),this.pls.InsertByte(s),this.xntf.InQueue(2062,this.pls.iOffset,this.pls.databuf)}s_NpcCmd(i,t,s,e,h,a,n,o){this.pls.iOffset=0,this.pls.InsertString(i),this.pls.InsertString(t),this.pls.InsertString(s),this.pls.InsertString(e),this.pls.InsertString(h),this.pls.InsertString(a),this.pls.InsertString(n),this.pls.InsertString(o),this.xntf.InQueue(2063,this.pls.iOffset,this.pls.databuf)}s_NpcShop(i){console.log("打开商店：",i),this.pls.iOffset=0,this.pls.InsertInt(i),this.xntf.InQueue(2064,this.pls.iOffset,this.pls.databuf)}s_NpcShopBuy(i,t,s){this.pls.iOffset=0,this.pls.InsertInt(i),this.pls.InsertInt(t),this.pls.InsertInt(s),this.xntf.InQueue(2065,this.pls.iOffset,this.pls.databuf)}s_IngotMall(i,t){this.pls.iOffset=0,this.pls.InsertInt(i),this.pls.InsertInt(t),this.xntf.InQueue(2066,this.pls.iOffset,this.pls.databuf)}s_IngotMallBuy(i,t,s){this.pls.iOffset=0,this.pls.InsertInt(i),this.pls.InsertInt(t),this.pls.InsertInt(s),this.xntf.InQueue(2067,this.pls.iOffset,this.pls.databuf)}s_GetSchoolMission(i){this.pls.iOffset=0,this.pls.InsertInt(i),this.xntf.InQueue(2070,this.pls.iOffset,this.pls.databuf)}s_GetMissionDetail(i,t){this.pls.iOffset=0,this.pls.InsertInt(i),this.pls.InsertByte(t),this.xntf.InQueue(2071,this.pls.iOffset,this.pls.databuf)}s_FinishMission(i,t,s,e){this.pls.iOffset=0,this.pls.InsertByte(i),this.pls.InsertInt(t),this.pls.InsertInt(s),this.pls.InsertInt(e),this.xntf.InQueue(2072,this.pls.iOffset,this.pls.databuf)}s_GetMission(i,t){this.pls.iOffset=0,this.pls.InsertByte(i),this.pls.InsertInt(t),this.xntf.InQueue(2073,this.pls.iOffset,this.pls.databuf)}s_CancelMission(i){this.pls.iOffset=0,this.pls.InsertInt(i),this.xntf.InQueue(2074,this.pls.iOffset,this.pls.databuf)}s_CreateGov(i,t){this.pls.iOffset=0,this.pls.InsertString(i),this.pls.InsertString(t),this.xntf.InQueue(2080,this.pls.iOffset,this.pls.databuf)}s_GetGovList(i){this.pls.iOffset=0,this.pls.InsertByte(i),this.xntf.InQueue(2081,this.pls.iOffset,this.pls.databuf)}s_ApplyForGov(i){this.pls.iOffset=0,this.pls.InsertInt(i),this.xntf.InQueue(2082,this.pls.iOffset,this.pls.databuf)}s_GetBaseGovData(i,t){this.pls.iOffset=0,this.pls.InsertByte(i),this.pls.InsertInt(t),this.xntf.InQueue(2083,this.pls.iOffset,this.pls.databuf)}s_OperateGovMember(i,t,s){this.pls.iOffset=0,this.pls.InsertInt(i),this.pls.InsertByte(t),this.pls.InsertInt(s),this.xntf.InQueue(2084,this.pls.iOffset,this.pls.databuf)}s_GetIntoGov(i){this.pls.iOffset=0,this.pls.InsertInt(i),this.xntf.InQueue(2085,this.pls.iOffset,this.pls.databuf),Ih.gi().iMapChangeing=100}s_HireWorker(i,t,s){this.pls.iOffset=0,this.pls.InsertByte(i),this.pls.InsertByte(t),this.pls.InsertByte(s),this.xntf.InQueue(2086,this.pls.iOffset,this.pls.databuf)}s_GovSet(i,t){this.pls.iOffset=0,this.pls.InsertByte(i),this.pls.InsertInt(t),this.xntf.InQueue(2087,this.pls.iOffset,this.pls.databuf)}s_GovOperateFrame(i){this.pls.iOffset=0,this.pls.InsertByte(i),this.xntf.InQueue(2088,this.pls.iOffset,this.pls.databuf)}s_LearnGovSkill(i,t){this.pls.iOffset=0,this.pls.InsertInt(i),this.pls.InsertInt(t),this.xntf.InQueue(2089,this.pls.iOffset,this.pls.databuf)}s_GovXiu(i,t){this.pls.iOffset=0,this.pls.InsertInt(i),this.pls.InsertInt(t),this.xntf.InQueue(2090,this.pls.iOffset,this.pls.databuf)}s_LeaveGov(){this.pls.iOffset=0,this.xntf.InQueue(2091,this.pls.iOffset,this.pls.databuf)}s_UseSkill(i,t,s,e,h,a,n){this.pls.iOffset=0,this.pls.InsertInt(i),this.pls.InsertInt(t),this.pls.InsertInt(s),this.pls.InsertInt(e),this.pls.InsertInt(h),this.pls.InsertInt(a),this.pls.InsertInt(n),this.xntf.InQueue(2092,this.pls.iOffset,this.pls.databuf)}s_WatchOn(i,t,s,e){this.pls.iOffset=0,this.pls.InsertByte(i),this.pls.InsertInt(t),this.pls.InsertInt(s),this.pls.InsertString(e),this.xntf.InQueue(2093,this.pls.iOffset,this.pls.databuf)}s_NewGovOperate(i,t,s,e,h,a){this.pls.iOffset=0,this.pls.InsertByte(i),this.pls.InsertInt(t),this.pls.InsertInt(s),this.pls.InsertInt(e),this.pls.InsertInt(h),this.pls.InsertString(a),this.xntf.InQueue(2095,this.pls.iOffset,this.pls.databuf),4==i&&(Ih.gi().iMapChangeing=100)}s_ChangeFightMounts(i){this.pls.iOffset=0,this.pls.InsertInt(i),this.xntf.InQueue(2101,this.pls.iOffset,this.pls.databuf)}s_DropMounts(i){this.pls.iOffset=0,this.pls.InsertInt(i),this.xntf.InQueue(2102,this.pls.iOffset,this.pls.databuf)}s_TrainMounts(i){this.pls.iOffset=0,this.pls.InsertInt(i),this.xntf.InQueue(2103,this.pls.iOffset,this.pls.databuf)}s_AddMountsPoint(i,t,s,e,h,a){this.pls.iOffset=0,this.pls.InsertInt(i),this.pls.InsertShort(t),this.pls.InsertShort(s),this.pls.InsertShort(e),this.pls.InsertShort(h),this.pls.InsertShort(a),this.xntf.InQueue(2104,this.pls.iOffset,this.pls.databuf)}s_FeedMounts(i,t,s){this.pls.iOffset=0,this.pls.InsertInt(i),this.pls.InsertInt(t),this.pls.InsertInt(s),this.xntf.InQueue(2105,this.pls.iOffset,this.pls.databuf)}s_JJMounts(i){this.pls.iOffset=0,this.pls.InsertInt(i),this.xntf.InQueue(2106,this.pls.iOffset,this.pls.databuf)}s_FightOperate(i,t){this.pls.iOffset=0,this.pls.InsertByte(i),this.pls.InsertByte(t[0]),this.pls.InsertInt(t[1]),this.pls.InsertInt(t[2]),this.xntf.InQueue(2200,this.pls.iOffset,this.pls.databuf)}s_PK(i){this.pls.iOffset=0,this.pls.InsertInt(i),this.xntf.InQueue(2201,this.pls.iOffset,this.pls.databuf)}s_WatchFight(i,t){this.pls.iOffset=0,this.pls.InsertByte(i),this.pls.InsertInt(t),this.xntf.InQueue(2202,this.pls.iOffset,this.pls.databuf)}s_Trade(i,t,s,e,h,a,n,o,r,c,l){this.pls.iOffset=0,this.pls.InsertByte(i),this.pls.InsertInt(t),this.pls.InsertInt(s),this.pls.InsertInt(e),this.pls.InsertInt(h),this.pls.InsertInt(a),this.pls.InsertInt(n),this.pls.InsertInt(o),this.pls.InsertInt(r),this.pls.InsertInt(c),this.pls.InsertInt(l),this.xntf.InQueue(2010,this.pls.iOffset,this.pls.databuf)}s_SeverEvent(i,t,s,e,h){this.pls.iOffset=0,this.pls.InsertByte(i),this.pls.InsertByte(t),this.pls.InsertInt(s),this.pls.InsertInt(e),this.pls.InsertInt(h),this.xntf.InQueue(2100,this.pls.iOffset,this.pls.databuf)}s_NoviceHelp(i,t,s,e){this.pls.iOffset=0,this.pls.InsertByte(i),this.pls.InsertInt(t),this.pls.InsertInt(s),this.pls.InsertString(e),this.xntf.InQueue(2300,this.pls.iOffset,this.pls.databuf)}s_GetCodeReward(i,t){this.pls.iOffset=0,this.pls.InsertByte(i),this.pls.InsertString(t),this.xntf.InQueue(2301,this.pls.iOffset,this.pls.databuf)}s_Pay(i,s,e,h,a){this.pls.iOffset=0,this.pls.InsertInt(t.QUDAO),this.pls.InsertString(s),this.pls.InsertInt(e),this.pls.InsertInt(h),this.pls.InsertString(a),this.xntf.InQueue(2302,this.pls.iOffset,this.pls.databuf)}s_PromptActivity(i,t){this.pls.iOffset=0,this.pls.InsertByte(i),this.pls.InsertInt(t),this.xntf.InQueue(2304,this.pls.iOffset,this.pls.databuf)}s_FuBen(i,t){this.pls.iOffset=0,this.pls.InsertByte(i),this.pls.InsertInt(t),this.xntf.InQueue(2400,this.pls.iOffset,this.pls.databuf)}s_CreateFuBen(i,t){this.pls.iOffset=0,this.pls.InsertInt(i),this.pls.InsertString(t),this.xntf.InQueue(2401,this.pls.iOffset,this.pls.databuf)}s_ApplyFuBen(i){this.pls.iOffset=0,this.pls.InsertInt(i),this.xntf.InQueue(2402,this.pls.iOffset,this.pls.databuf)}s_ManageFuBen(i,t,s){this.pls.iOffset=0,this.pls.InsertInt(i),this.pls.InsertInt(t),this.pls.InsertInt(s),this.xntf.InQueue(2403,this.pls.iOffset,this.pls.databuf)}s_FuBenMail(i){this.pls.iOffset=0,this.pls.InsertInt(i),this.xntf.InQueue(2408,this.pls.iOffset,this.pls.databuf)}s_FubenMallBuy(i,t,s){this.pls.iOffset=0,this.pls.InsertInt(i),this.pls.InsertInt(t),this.pls.InsertInt(s),this.xntf.InQueue(2409,this.pls.iOffset,this.pls.databuf)}s_LandOperate(i,t,s,e){this.pls.iOffset=0,this.pls.InsertByte(i),this.pls.InsertInt(t),this.pls.InsertInt(s),this.pls.InsertInt(e),this.xntf.InQueue(2150,this.pls.iOffset,this.pls.databuf)}s_CreateFT(i,t){this.pls.iOffset=0,this.pls.InsertString(i),this.pls.InsertString(t),this.xntf.InQueue(2500,this.pls.iOffset,this.pls.databuf)}s_ApplyFT(i){this.pls.iOffset=0,this.pls.InsertInt(i),this.xntf.InQueue(2502,this.pls.iOffset,this.pls.databuf)}s_GetApply(i){this.pls.iOffset=0,this.pls.InsertInt(i),this.xntf.InQueue(2503,this.pls.iOffset,this.pls.databuf)}s_FTAgree(i,t){this.pls.iOffset=0,this.pls.InsertByte(i),this.pls.InsertInt(t),this.xntf.InQueue(2504,this.pls.iOffset,this.pls.databuf)}s_FTChallenge(i,t,s){this.pls.iOffset=0,this.pls.InsertByte(i),this.pls.InsertInt(t),this.pls.InsertInt(s),this.xntf.InQueue(2505,this.pls.iOffset,this.pls.databuf)}s_FTOperate(i,t,s){this.pls.iOffset=0,this.pls.InsertByte(i),this.pls.InsertInt(t),this.pls.InsertInt(s),this.xntf.InQueue(2506,this.pls.iOffset,this.pls.databuf)}s_CreateShop(i,t){this.pls.iOffset=0,this.pls.InsertString(i),this.pls.InsertInt(t),this.xntf.InQueue(2600,this.pls.iOffset,this.pls.databuf)}s_AfternoooQuestion(i,t,s){this.pls.iOffset=0,this.pls.InsertInt(i),this.pls.InsertInt(t),this.pls.InsertInt(s),this.xntf.InQueue(2700,this.pls.iOffset,this.pls.databuf)}s_ExtendCmd(i,t,s,e,h,a,n,o){this.pls.iOffset=0,this.pls.InsertString(i),this.pls.InsertString(t),this.pls.InsertString(s),this.pls.InsertString(e),this.pls.InsertString(h),this.pls.InsertString(a),this.pls.InsertString(n),this.pls.InsertString(o),this.xntf.InQueue(2800,this.pls.iOffset,this.pls.databuf)}xms_send(i,t,s,e,h,a,n){this.pls.iOffset=0,this.pls.InsertString(i),this.pls.InsertString(t),this.pls.InsertString(s),this.pls.InsertString(e),this.pls.InsertString(h),this.pls.InsertString(a),this.pls.InsertString(n),this.xntf.InQueue(5e3,this.pls.iOffset,this.pls.databuf)}s_LeaderBoardFresh(i,t,s){this.pls.iOffset=0,this.pls.InsertInt(i),this.pls.InsertInt(t),this.pls.InsertInt(s),this.xntf.InQueue(2910,this.pls.iOffset,this.pls.databuf)}}Mh.sMid="0",Mh.pt=null,Mh.gi=function(){return null==Mh.pt&&(Mh.pt=new Mh(null,gn.xntf)),Mh.pt};class yh extends s{constructor(i){var t;for(super(),this.pani=i,this.pm3f=i.pm3f,yh.iW=980,yh.iH=640,yh.iX=(h.SCRW-yh.iW)/2,yh.iY=(h.SCRH-yh.iH)/2,this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(yh.iX+yh.iW-35,yh.iY-25,60,60),this.btn_page=new Array(3),t=0;t<3;t++)this.btn_page[t]=new Eh(gn.xani_nui2),this.btn_page[t].InitButton("按钮2");for(this.btn_page[0].sName="显示",this.btn_page[1].sName="声音",this.btn_page[2].sName="其他",this.iPage=0,this.chk_show=new Array(8),t=0;t<8;t++)this.chk_show[t]=new T(gn.xani_nui3),this.chk_show[t].InitBox("统一勾选"),this.chk_show[t].Move(yh.iX+yh.iW-25-50-60,yh.iY+25+55*t,50,50),this.chk_show[t].bTrue=!0;for(this.chk_show[0].sDetail="显示人物",this.chk_show[1].sDetail="显示坐骑",this.chk_show[2].sDetail="显示武器",this.chk_show[3].sDetail="显示换色",this.chk_show[4].sDetail="显示跟随宠物",this.chk_show[5].sDetail="显示名字",this.chk_show[6].sDetail="显示称谓",this.chk_show[7].sDetail="显示摊位",this.chk_show[0].bTrue=yh.bShowRole,this.chk_show[1].bTrue=yh.bShowMount,this.chk_show[2].bTrue=yh.bShowWeapon,this.chk_show[3].bTrue=yh.bShowColor,this.chk_show[4].bTrue=yh.bShowFollow,this.chk_show[5].bTrue=yh.bShowName,this.chk_show[6].bTrue=yh.bShowTitle,this.chk_show[7].bTrue=yh.bShowSell,this.btn_resetrate=new Eh(gn.xani_nui2),this.btn_resetrate.InitButton("按钮1_110"),this.btn_resetrate.sName="重置",this.adj_ls=new b(gn.xani_nui3),this.adj_ls.InitAdjust("左右调节"),this.adj_ls.SetPos(0,400,yh.iScreenLS),this.btn_pq=new Array(3),t=0;t<3;t++)this.btn_pq[t]=new T(gn.xani_nui3),this.btn_pq[t].InitBox("圆形选中"),this.btn_pq[t].bTrue=!1;bn.sop("SystemOperate.iPictureQuality"+yh.iPictureQuality),bn.sop("SystemOperate.iMusic"+yh.iMusic),this.btn_pq[yh.iPictureQuality].bTrue=!0,this.btn_pq[0].sDetail="高",this.btn_pq[1].sDetail="中",this.btn_pq[2].sDetail="低",this.adj_pb=new b(gn.xani_nui3),this.adj_pb.InitAdjust("左右调节"),this.adj_pb.SetPos(0,50,yh.iPictureBuffer),this.adj_nrc=new b(gn.xani_nui3),this.adj_nrc.InitAdjust("左右调节"),this.adj_nrc.SetPos(10,50,yh.iNearRoleCount),this.chk_music=new T(gn.xani_nui3),this.chk_music.InitBox("统一勾选"),1==yh.iMusic?this.chk_music.bTrue=!0:this.chk_music.bTrue=!1,this.chk_music.sDetail="音乐",this.chk_sound=new T(gn.xani_nui3),this.chk_sound.InitBox("统一勾选"),1==yh.iSound?this.chk_sound.bTrue=!0:this.chk_sound.bTrue=!1,this.chk_sound.sDetail="音效",this.chk_wheel=new T(gn.xani_nui3),this.chk_wheel.InitBox("统一勾选"),0==yh.iWheel?this.chk_wheel.bTrue=!0:this.chk_wheel.bTrue=!1,this.chk_wheel.sDetail="方向盘控制",this.chk_exthelp=new T(gn.xani_nui3),this.chk_exthelp.InitBox("统一勾选"),1==ph.iExtHelp?this.chk_exthelp.bTrue=!0:this.chk_exthelp.bTrue=!1,this.chk_exthelp.sDetail="开启新手引导",yh.bAllowTeam=(256&xh.me.iFlag[2])>0,yh.bAllowGoods=(512&xh.me.iFlag[2])>0,yh.bAllowTrade=(1024&xh.me.iFlag[2])>0,yh.bAllowChat=(128&xh.me.iFlag[2])>0,this.chk_allowteam=new T(gn.xani_nui3),this.chk_allowteam.InitBox("统一勾选"),this.chk_allowteam.bTrue=yh.bAllowTeam,this.chk_allowteam.sDetail="拒绝其他玩家发起的组队邀请",this.chk_allowgoods=new T(gn.xani_nui3),this.chk_allowgoods.InitBox("统一勾选"),this.chk_allowgoods.bTrue=yh.bAllowGoods,this.chk_allowgoods.sDetail="拒绝接受其他玩家给予的物品",this.chk_allowtrade=new T(gn.xani_nui3),this.chk_allowtrade.InitBox("统一勾选"),this.chk_allowtrade.bTrue=yh.bAllowTrade,this.chk_allowtrade.sDetail="屏蔽其他玩家发起的交易",this.chk_allowchat=new T(gn.xani_nui3),this.chk_allowchat.InitBox("统一勾选"),this.chk_allowchat.bTrue=yh.bAllowChat,this.chk_allowchat.sDetail="屏蔽陌生人的私聊信息"}ResetAnima(){var i;for(i=0;i<rh.iNearMax;i++)rh.gameing.nrs[i].bUseing&&(rh.gameing.nrs[i].bfc8=!0);xh.me.bfc8=!0}Draw(){var i,t,s,e,a;for(yh.iX=(h.SCRW-yh.iW)/2,yh.iY=(h.SCRH-yh.iH)/2,E.new_baseframe2(yh.iX,yh.iY,yh.iW,yh.iH,"系","统"),this.btn_close.Draw(),s=yh.iX+30,t=yh.iY+30,e=185,a=yh.iH-60,E.new_framein(s,t,e,a),i=0;i<3;i++)this.iPage==i&&(this.btn_page[i].bMouseDown=!0,this.btn_page[i].bMouseIn=!0),this.btn_page[i].Move(s+20,t+20+76*i,145,56),this.btn_page[i].Draw();if(s+=e+20,e=yh.iW-60-20-e,E.new_framein(s,t,e,a),0==this.iPage){for(s+=20,t+=20,s+=15,t+=15,this.chk_show[0].Move(s,t,50,50),this.chk_show[1].Move(s+200,t,50,50),this.chk_show[2].Move(s+400,t,50,50),t+=60,this.chk_show[3].Move(s+200,t,50,50),this.chk_show[4].Move(s+400,t,50,50),t+=60,this.chk_show[5].Move(s,t,50,50),this.chk_show[6].Move(s+200,t,50,50),this.chk_show[7].Move(s+400,t,50,50),i=0;i<8;i++)this.chk_show[i].Draw();for(yh.bShowRole!=this.chk_show[0].bTrue&&(yh.bShowRole=this.chk_show[0].bTrue,this.ResetAnima()),yh.bShowMount!=this.chk_show[1].bTrue&&(yh.bShowMount=this.chk_show[1].bTrue,this.ResetAnima()),yh.bShowWeapon!=this.chk_show[2].bTrue&&(yh.bShowWeapon=this.chk_show[2].bTrue,this.ResetAnima()),yh.bShowColor!=this.chk_show[3].bTrue&&(yh.bShowColor=this.chk_show[3].bTrue,this.ResetAnima()),yh.bShowFollow!=this.chk_show[4].bTrue&&(yh.bShowFollow=this.chk_show[4].bTrue,this.ResetAnima()),yh.bShowName!=this.chk_show[5].bTrue&&(yh.bShowName=this.chk_show[5].bTrue,this.ResetAnima()),yh.bShowTitle!=this.chk_show[6].bTrue&&(yh.bShowTitle=this.chk_show[6].bTrue,this.ResetAnima()),yh.bShowSell!=this.chk_show[7].bTrue&&(yh.bShowSell=this.chk_show[7].bTrue,this.ResetAnima()),s-=15,t+=75,s+=15,yh.iSameRate=0,s-=15,s+=15,t+=15,c.gi().DrawTextEx(s,t+10,"画面缓存",4278206039,30,101,1,1,0,0,0),E.new_numberframe(s+150,t,70,""+parseInt(this.adj_pb.iPos)),this.adj_pb.Move(s+150+100,t+10,350,30),this.adj_pb.Draw(),t+=50,c.gi().DrawTextEx(s,t+10,"画面质量",4278206039,30,101,1,1,0,0,0),i=0;i<3;i++)this.btn_pq[i].bTrue,this.btn_pq[i].Move(s+150+180*i,t,50,50),this.btn_pq[i].Draw();t+=50,c.gi().DrawTextEx(s,t+10,"周围玩家数",4278206039,30,101,1,1,0,0,0),E.new_numberframe(s+150,t,70,""+parseInt(this.adj_nrc.iPos)),this.adj_nrc.Move(s+150+100,t+10,350,30),this.adj_nrc.Draw()}1==this.iPage&&(s+=20,t+=20,this.chk_music.Move(s,t,50,50),this.chk_music.bTrue?yh.iMusic=1:yh.iMusic=0,this.chk_music.Draw(),this.chk_sound.Move(s+200,t,50,50),this.chk_sound.bTrue?yh.iSound=1:yh.iSound=0,this.chk_sound.Draw()),2==this.iPage&&(s+=20,t+=20,this.chk_wheel.Move(s,t,50,50),this.chk_wheel.bTrue?yh.iWheel=0:yh.iWheel=1,this.chk_wheel.Draw(),t+=70,this.chk_exthelp.Move(s,t,50,50),this.chk_exthelp.bTrue?ph.iExtHelp=1:ph.iExtHelp=3,this.chk_exthelp.Draw(),t+=70,this.chk_allowteam.Move(s,t,50,50),yh.bAllowTeam!=this.chk_allowteam.bTrue&&(yh.bAllowTeam=this.chk_allowteam.bTrue,Mh.gi().s_setflag(2,8,yh.bAllowTeam?1:0),yh.bAllowTeam?xh.me.iFlag[2]=256|xh.me.iFlag[2]:xh.me.iFlag[2]=-257&xh.me.iFlag[2]),this.chk_allowteam.Draw(),t+=70,this.chk_allowgoods.Move(s,t,50,50),yh.bAllowGoods!=this.chk_allowgoods.bTrue&&(yh.bAllowGoods=this.chk_allowgoods.bTrue,Mh.gi().s_setflag(2,9,yh.bAllowGoods?1:0),yh.bAllowGoods?xh.me.iFlag[2]=512|xh.me.iFlag[2]:xh.me.iFlag[2]=-513&xh.me.iFlag[2]),this.chk_allowgoods.Draw(),t+=70,this.chk_allowtrade.Move(s,t,50,50),yh.bAllowTrade!=this.chk_allowtrade.bTrue&&(yh.bAllowTrade=this.chk_allowtrade.bTrue,Mh.gi().s_setflag(2,10,yh.bAllowTrade?1:0),yh.bAllowTrade?xh.me.iFlag[2]=1024|xh.me.iFlag[2]:xh.me.iFlag[2]=-1025&xh.me.iFlag[2]),this.chk_allowtrade.Draw(),t+=70,this.chk_allowchat.Move(s,t,50,50),yh.bAllowChat!=this.chk_allowchat.bTrue&&(yh.bAllowChat=this.chk_allowchat.bTrue,Mh.gi().s_setflag(2,7,yh.bAllowChat?1:0),yh.bAllowChat?xh.me.iFlag[2]=128|xh.me.iFlag[2]:xh.me.iFlag[2]=-129&xh.me.iFlag[2]),this.chk_allowchat.Draw(),t+=70)}ProcTouch(i,t,s){var e;for(e=0;e<3;e++)this.btn_page[e].ProcTouch(i,t,s)&&this.btn_page[e].bCheck()&&(this.iPage=e);if(0==this.iPage){for(e=0;e<8;e++)this.chk_show[e].ProcTouch(i,t,s);if(this.adj_pb.ProcTouch(i,t,s))return yh.iPictureBuffer=parseInt(this.adj_pb.iPos),!0;for(e=0;e<3;e++)this.btn_pq[e].ProcTouch(i,t,s)&&3==i&&(this.btn_pq[0].bTrue=!1,this.btn_pq[1].bTrue=!1,this.btn_pq[2].bTrue=!1,this.btn_pq[e].bTrue=!0,L.easymsg.AddMessage("调整画面质量需重启游戏后才生效"),yh.iPictureQuality=e,0==yh.iPictureQuality?yh.iPictureBuffer=50:1==yh.iPictureQuality?yh.iPictureBuffer=25:yh.iPictureBuffer=0,this.adj_pb.SetPos(0,50,yh.iPictureBuffer));if(this.adj_nrc.ProcTouch(i,t,s))return yh.iNearRoleCount=parseInt(this.adj_nrc.iPos),!0}return 1==this.iPage&&i==Gh.TOUCH_UP&&(this.chk_music.ProcTouch(i,t,s)&&(this.chk_music.bTrue?yh.iMusic=1:yh.iMusic=0,gn.ResetSound()),this.chk_sound.ProcTouch(i,t,s)&&(this.chk_sound.bTrue?yh.iSound=1:yh.iSound=0)),2==this.iPage&&(this.chk_wheel.ProcTouch(i,t,s),this.chk_exthelp.ProcTouch(i,t,s),this.chk_allowteam.ProcTouch(i,t,s),this.chk_allowgoods.ProcTouch(i,t,s),this.chk_allowtrade.ProcTouch(i,t,s),this.chk_allowchat.ProcTouch(i,t,s)),!!this.btn_close.ProcTouch(i,t,s)&&(this.btn_close.bCheck()&&ln.gi().PopStat(1),!0)}}yh.iX=0,yh.iY=0,yh.iW=0,yh.iH=0,yh.bShowRole=!0,yh.bShowMount=!0,yh.bShowWeapon=!0,yh.bShowColor=!0,yh.bShowFollow=!0,yh.bShowName=!0,yh.bShowSell=!0,yh.bShowTitle=!0,yh.bAllowTeam=!0,yh.bAllowGoods=!0,yh.bAllowTrade=!0,yh.bAllowChat=!0,yh.iSameRate=0,yh.iScreenLS=0,yh.iPictureQuality=0,yh.iPictureBuffer=50,yh.iNearRoleCount=25,yh.iMusic=1,yh.iSound=1,yh.iWheel=1,yh.iFPS,yh.iRenderType=1,yh.BASEW=1280,yh.BASEH=720,yh.MAXW=1280,yh.MAXH=720,yh.iWordRate=1e3,yh.SetScreenMode=function(i){ln.gi().bGameing()&&(yh.BASEH=yh.BASEW*h.SYSH/h.SYSW,yh.MAXH=yh.BASEH),h.SCRW=yh.BASEW,h.SCRH=yh.BASEH,h.REALW=h.SYSW,h.REALH=h.SYSH,h.OFFX=(h.SYSW-h.REALW)/2,h.OFFY=(h.SYSH-h.REALH)/2,yh.iX=(h.SCRW-yh.iW)/2,yh.iY=(h.SCRH-yh.iH)/2},yh.WordSize=function(i){return i*yh.iWordRate/1e3};class Rh{constructor(){this.iTouchStat=0}copyfrom(i){this.iTid=i.iTid,this.iTouchStat=i.iTouchStat,this.iPX=i.iPX,this.iPY=i.iPY,this.iX=i.iX,this.iY=i.iY,this.iSourceX=i.iSourceX,this.iSourceY=i.iSourceY}}class Gh{constructor(){var i;for(this.procstack=new Rh(Gh.MAXTOUCHPROC),this.procing=new Rh,this.ISHENGPING=!1,i=0;i<Gh.MAXTOUCH;i++)Gh.ths[i]=new Rh,Gh.ths[i].iTouchStat=Gh.TOUCH_NONE;for(i=0;i<Gh.MAXTOUCHPROC;i++)this.procstack[i]=new Rh;this.iTouchCount=0,this.iProcPoint=0,this.iProcEnd=0,Gh.iFingerId=-1}clear(){var i;for(i=0;i<Gh.MAXTOUCH;i++)Gh.ths[i].iTouchStat=Gh.TOUCH_NONE;this.iTouchCount=0,this.iProcPoint=0,this.iProcEnd=0,Gh.iFingerId=-1}pushtouch(i){return this.iProcEnd<this.iProcPoint+Gh.MAXTOUCHPROC?(this.procstack[this.iProcEnd%Gh.MAXTOUCHPROC].copyfrom(Gh.ths[i]),this.iProcEnd++,!0):(gn.sop("Not Enuphy touch"),!1)}poptouch(){return this.iProcPoint<this.iProcEnd&&(this.procing.copyfrom(this.procstack[this.iProcPoint%Gh.MAXTOUCHPROC]),Gh.iFingerId=this.procing.iTid,this.iProcPoint++,!0)}touch_count(){return this.iTouchCount}calcxy(i,t){this.ISHENGPING?(i=i*h.SCRH/h.REALW,t=t*h.SCRW/h.REALH,this.cy=i,this.cx=t):(this.cx=(i-h.OFFX)*yh.BASEW/h.REALW,this.cy=(t-h.OFFY)*yh.BASEH/h.REALH)}touch_down(i,t,s){Gh.ths[i].iTouchStat==Gh.TOUCH_NONE&&(this.calcxy(t,s),this.iLastDownX=this.cx,this.iLastDownY=this.cy,Gh.ths[i].iTouchStat=Gh.TOUCH_DOWN,Gh.ths[i].iTid=i,Gh.ths[i].iX=this.cx,Gh.ths[i].iY=this.cy,Gh.ths[i].iPX=this.cx,Gh.ths[i].iPY=this.cy,Gh.ths[i].iSourceX=t,Gh.ths[i].iSourceY=s,this.pushtouch(i),this.iTouchCount++)}touch_up(i,t,s){Gh.ths[i].iTouchStat!=Gh.TOUCH_NONE&&(this.calcxy(t,s),Gh.ths[i].iTouchStat=Gh.TOUCH_UP,Gh.ths[i].iX=this.cx,Gh.ths[i].iY=this.cy,Gh.ths[i].iSourceX=t,Gh.ths[i].iSourceY=s,this.pushtouch(i),Gh.ths[i].iTouchStat=Gh.TOUCH_NONE,this.iTouchCount--)}touch_move(i,t){var s,e,h=99999,a=-1;for(this.calcxy(i,t),s=0;s<Gh.MAXTOUCH;s++)if(Gh.ths[s].iTouchStat!=Gh.TOUCH_NONE){if(0==(e=bn.llength(this.cx,this.cy,Gh.ths[s].iX,Gh.ths[s].iY)))return;-1==a?(a=s,h=e):e<h&&(a=s,h=e)}-1!=a&&(Gh.ths[a].iTouchStat=Gh.TOUCH_MOVE,Gh.ths[a].iPX=Gh.ths[a].iX,Gh.ths[a].iPY=Gh.ths[a].iY,Gh.ths[a].iX=this.cx,Gh.ths[a].iY=this.cy,Gh.ths[a].iSourceX=i,Gh.ths[a].iSourceY=t,this.pushtouch(a))}}Gh.TOUCH_NONE=0,Gh.TOUCH_DOWN=1,Gh.TOUCH_MOVE=2,Gh.TOUCH_UP=3,Gh.MAXTOUCHPROC=64,Gh.MAXTOUCH=64,Gh.ths=new Array(Gh.MAXTOUCH),Gh.iFingerId,Gh.tm=null,Gh.gi=function(){return null==Gh.tm&&(Gh.tm=new Gh),Gh.tm},Gh.FingerLocker=function(i){return-1==i?-1:Gh.ths[i].iTouchStat==Gh.TOUCH_NONE?-1:i},Gh._swapx=function(i){return i*(800+yh.iScreenLS*(yh.MAXW-800)/400)/yh.BASEW},Gh._swapy=function(i){return i*(0==yh.iSameRate?(800+yh.iScreenLS*(yh.MAXW-800)/400)*h.SYSH/h.SYSW:480+yh.iScreenLS*(yh.MAXH-480)/400)/yh.BASEH};class Eh{constructor(i){this.pani=i,this.pm3f=this.pani.pm3f,this.bSingleButton=!1,this.bCheckByRect=!1,this.bCheckByRect1=!1,this.ReleaseButton(),this.sName="",this.iNameColor=4294962304,this.Move(0,0,100,100),this.iFingerLocker=-1,this.iAnimaStat=0,this.fScale=1,this.iNameSize=30,this.bChecked=!1,this.exts=new Int32Array(3)}InitButton(i){this.sAnimaName=i,this.pani.InitAnimaWithName(i,gn.aaa),gn.aaa.iFrame=0,this.SetAnimaNormal(gn.aaa,!1),gn.aaa.iFrame=1,this.SetAnimaMouseon(gn.aaa,!1),this.SetAnimaMousedown(gn.aaa,!1),gn.aaa.iFrame=2,this.SetAnimaDisable(gn.aaa,!1)}ReleaseButton(){this.aa_normal=null,this.act_normal=!1,this.aa_mouseon=null,this.act_mouseon=!1,this.aa_mousedown=null,this.act_mousedown=!1,this.aa_disable=null,this.bMouseIn=!1,this.bMouseDown=!1,this.bVisible=!0,this.bDisable=!1,this.iX=0,this.iY=0}SetAnimaNormal(i,t){null==this.aa_normal&&(this.aa_normal=new l),this.aa_normal.copyfrom(i),this.act_normal=t}SetAnimaMouseon(i,t){null==this.aa_mouseon&&(this.aa_mouseon=new l),this.aa_mouseon.copyfrom(i),this.act_mouseon=t}SetAnimaMousedown(i,t){null==this.aa_mousedown&&(this.aa_mousedown=new l),this.aa_mousedown.copyfrom(i),this.act_mousedown=t}SetAnimaDisable(i,t){null==this.aa_disable&&(this.aa_disable=new l),this.aa_disable.copyfrom(i),this.act_disable=t}Move(i,t,s,e){this.iX=i,this.iY=t,this.iW=s,this.iH=e}setdown(){this.bMouseDown=!0,this.bMouseIn=!0}ProcTouch(i,t,s){if(-1!=this.iFingerLocker&&this.iFingerLocker!=Gh.iFingerId)return!1;if(!this.bVisible)return!1;if(this.bDisable)return this.bMoveIn(t,s);if(3==i&&(this.iFingerLocker=-1),!this.bMoveIn(t,s))return this.iFingerLocker=-1,this.bMouseDown=!1,0==this.iAnimaStat&&1!=this.fScale&&(this.iAnimaStat=11),!1;switch(i){case 1:this.iFingerLocker=Gh.iFingerId,this.bMouseDown=!0,this.iAnimaStat=1;break;case 2:break;case 3:this.bMouseDown&&(this.bMouseDown=!1,this.bChecked=!0,this.iAnimaStat=11),this.iFingerLocker=-1}return!0}bCheck(){return!!this.bChecked&&(this.bChecked=!1,!0)}bMoveIn(i,t){return this.bMouseIn=!1,this.bCheckByRect1?i>=this.iCheckX&&i<=this.iCheckX+this.iCheckW&&t>=this.iCheckY&&t<=this.iCheckY+this.iCheckH?this.bMouseIn=!0:this.bMouseIn=!1:this.bSingleButton||this.bCheckByRect?i>=this.iX&&i<=this.iX+this.iW&&t>=this.iY&&t<=this.iY+this.iH?this.bMouseIn=!0:this.bMouseIn=!1:this.pani.bInAnima(this.aa_normal,this.iX,this.iY,i,t)?this.bMouseIn=!0:this.bMouseIn=!1,this.bMouseIn}SetNormal(){this.bMouseDown=!1,this.iAnimaStat=0,this.fScale=1}Draw(){for(;fn.gi().bInBound(this.iX,this.iY,this.iW,this.iH);)this.iX--;switch(this.iAnimaStat){case 0:break;case 1:this.fScale-=.1,this.fScale<.8&&(this.iAnimaStat=2);break;case 2:this.fScale+=.1,this.iAnimaStat=0;break;case 11:this.fScale+=.1,this.fScale>1&&(this.iAnimaStat=12);break;case 12:this.fScale=1,this.iAnimaStat=0}this.bVisible&&(this.bDisable?this.bSingleButton?this.pm3f.FillRect_2D(this.iX,this.iY,this.iX+this.iW,this.iY+this.iH,3238002687):this.pani.DrawAnima_aa(this.iX,this.iY,this.aa_disable):this.bMouseDown?this.pani.DrawAnimaEx(this.iX-(this.fScale-1)*this.iW/2,this.iY-(this.fScale-1)*this.iH/2,this.aa_mousedown,101,this.fScale,this.fScale,0,0,0):this.pani.DrawAnimaEx(this.iX-(this.fScale-1)*this.iW/2,this.iY-(this.fScale-1)*this.iH/2,this.aa_normal,101,this.fScale,this.fScale,0,0,0),this.DrawText(0,0))}DrawText(i,t){if(this.bSingleButton||this.sName.length>0){var s=this.iNameColor;this.bDisable&&(s=4286611584),this.pm3f.DrawText_2(this.iX+this.iW/2+i,this.iY+this.iH/2+t,this.sName,s,this.fScale*this.iNameSize,101,1,1,0,-2,-2,4,4278199373)}}SetCheckRect(i,t,s,e){this.bCheckByRect1=!0,this.iCheckX=i,this.iCheckY=t,this.iCheckW=s,this.iCheckH=e}}class Oh extends s{constructor(i){var t;for(super(),this.pani=i,this.pm3f=i.pm3f,this.iNpcCount=0,this.btn_npcs=new Array(64),t=0;t<64;t++)this.btn_npcs[t]=new Eh(gn.xani_nui3),this.btn_npcs[t].bSingleButton=!0;this.btn_worldmap=new Eh(gn.xani_ui2),this.btn_worldmap.InitButton("世界地图按钮")}Draw_smallmap(){var i,t,s,e,h,a,n,o;if(h=Ih.gi().mapdata.iMapWidth,a=Ih.gi().mapdata.iMapHeight,Ih.gi().mapdata.iGroundSourceId>=0){var r=Ih.gi().pSourceIndex[Ih.gi().mapdata.iGroundSourceId];for(i=0;i<r.ww;i++)for(t=0;t<r.hh;t++)s=parseInt(this.iRate*i*512)+Oh.iMapX,e=parseInt(this.iRate*t*512)+Oh.iMapY,n=h<512*(i+1)?h%512:512,o=a<512*(t+1)?a%512:512,-1==r.iRid[t][i]&&(r.iRid[t][i]=c.gi().LoadFromFile(r.sImagePath+"spirit_"+i+"_"+t+".png",-1,!0)),c.gi().DrawImageEx(0,s,e,r.iRid[t][i],0,0,n,o,100,this.iRate,this.iRate,0,-1,-1)}s=parseInt(this.iRate*xh.me.iX+Oh.iMapX),e=parseInt(this.iRate*xh.me.iY+Oh.iMapY),c.gi().FillRect_2D(s-5,e-5,s+5,e+5,4294901760)}Draw(){var i,t;i=Ih.gi().mapdata.iMapWidth,t=Ih.gi().mapdata.iMapHeight,this.iRate=i>t?700/i:700/t,Oh.iMapW=parseInt(i*this.iRate),Oh.iMapH=parseInt(t*this.iRate),Oh.iW=Oh.iMapW+20,Oh.iH=Oh.iMapH+20,Oh.iX=(h.SCRW-Oh.iW)/2,Oh.iY=(h.SCRH-Oh.iH)/2,Oh.iMapX=Oh.iX+10,Oh.iMapY=Oh.iY+10,E.new_bigframe(Oh.iX,Oh.iY,Oh.iW,Oh.iH),this.Draw_smallmap(),this.Draw_npc(),this.iFindWayOnce=0,this.btn_worldmap.Move(Oh.iX+10,Oh.iY+10,60,60),this.btn_worldmap.Draw()}Draw_npc(){var i,t,s,e,h=Ih.gi().vbk;for(this.iNpcCount=0,i=0;i<h.MAXVISUALBLOCK;i++)if(null!=h.vbs[i]){if(!h.vbs[i].bCurrentBlock)continue;h.vbs[i].iX>0&&h.vbs[i].iY>0&&h.vbs[i].sNpcName.length>0&&(e=c.gi().GetTextWidth(h.vbs[i].sNpcName,20)+20,t=parseInt(this.iRate*h.vbs[i].iX)-e/2+Oh.iMapX,s=parseInt(this.iRate*h.vbs[i].iY)-16+Oh.iMapY,t<Oh.iMapX&&(t=Oh.iMapX),s<Oh.iMapY&&(s=Oh.iMapY),t+e>Oh.iMapX+Oh.iMapW&&(t=Oh.iMapX+Oh.iMapW-e),s+32>Oh.iMapY+Oh.iMapH&&(s=Oh.iMapY+Oh.iMapH-32),this.iNpcPoint==i&&c.gi().FillRect_2D(t-3,s-3,t+e+3,s+32+3,4294901760),L.new_Text(t,s,e),c.gi().DrawText_2(t+e/2,s+16,h.vbs[i].sNpcName,4294967295,20,101,1,1,0,-2,-2,3,4278190080),this.btn_npcs[this.iNpcCount].Move(t,s,e,32),this.btn_npcs[this.iNpcCount].exts[0]=h.vbs[i].iX,this.btn_npcs[this.iNpcCount].exts[1]=h.vbs[i].iY,this.btn_npcs[this.iNpcCount].exts[2]=h.vbs[i].iDownFlag,this.btn_npcs[this.iNpcCount].sName=h.vbs[i].sNpcName,"前往郊外"==h.vbs[i].sNpcName&&(Oh.x_x=t,Oh.x_y=s,Oh.x_w=e,Oh.x_h=32),this.iNpcCount++)}}ProcTouch(i,t,s){var e,h,a;if(this.btn_worldmap.ProcTouch(i,t,s))return this.btn_worldmap.bCheck()&&ln.gi().PushStat(ln.GS_WORLDMAP),!0;if(bn.bInRect(t,s,Oh.iX,Oh.iY,Oh.iW,Oh.iH)){for(e=0;e<this.iNpcCount;e++)if(bn.bInRect(t,s,this.btn_npcs[e].iX,this.btn_npcs[e].iY,this.btn_npcs[e].iW,this.btn_npcs[e].iH)&&gn.sop("3"),this.btn_npcs[e].ProcTouch(i,t,s)&&this.btn_npcs[e].bCheck())return ct.gi().bSelling?L.easymsg.AddMessage("摆摊中不能行走"):(H.bNoTeam()||H.bTeamLeader()||H.bAway())&&Ih.gi().mfy.findway(xh.me.iX,xh.me.iY,this.btn_npcs[e].exts[0],this.btn_npcs[e].exts[1])&&(gn.sop("check again start"),Ih.gi().mfy.checkagain()?(L.easymsg.AddMessage("自动寻路："+this.btn_npcs[e].sName),Ih.gi().vbk.iNpcX=this.btn_npcs[e].exts[0],Ih.gi().vbk.iNpcY=this.btn_npcs[e].exts[1],Ih.gi().vbk.iGoToNpcFlag=this.btn_npcs[e].exts[2],xh.me.start(Ih.gi().mfy.iPath,Ih.gi().mfy.iPathDeep),this.iNpcPoint=e):gn.sop("check again end2")),ln.gi().PopStat(1),!0}else 3==i&&ln.gi().PopStat(1);this.iNpcPoint=-1;var n=Ih.gi();return bn.bInRect(t,s,Oh.iMapX,Oh.iMapY,Oh.iMapW,Oh.iMapH)&&this.iFindWayOnce<=0&&!ct.gi().bSelling&&(H.bNoTeam()||H.bTeamLeader()||H.bAway())&&(h=parseInt(1*(t-Oh.iMapX)/this.iRate),a=parseInt(1*(s-Oh.iMapY)/this.iRate),Ks.sw.bAutoRun=!1,Ks.sw.bLocked=!1,n.mfy.findway(xh.me.iX,xh.me.iY,h,a)?(gn.sop("check again start"),n.mfy.checkagain()?(Ih.gi().vbk.iGoToNpcFlag=-1,Ih.gi().vbk.iGoToNpcId=-1,gn.sop("check again end1"),xh.me.start(n.mfy.iPath,n.mfy.iPathDeep)):gn.sop("check again end2")):(Ks.sw.bLocked=!0,Ks.sw.iLockX=h-(Ih.gi().iOffx+xh.me.iX)+Ks.sw.iX,Ks.sw.iLockY=a-(Ih.gi().iOffy+xh.me.iY)+Ks.sw.iY,Ks.sw.bAutoRun=!0),this.iFindWayOnce++),!1}}Oh.iX,Oh.iY,Oh.iW,Oh.iH,Oh.iMapX,Oh.iMapY,Oh.iMapW,Oh.iMapH,Oh.x_x,Oh.x_y,Oh.x_w,Oh.x_h;class Fh extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=800,this.iH=480,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new Wi(gn.xani_ui3),this.btn_close.InitButton("统一关闭按钮"),this.btn_close.Move(this.iX+this.iW-60-5,this.iY,60,60)}Draw(){Fh.ipid1<0&&(Fh.ipid1=c.gi().LoadFromFile("bk/ba.xxx",-1,!1)),Fh.ipid2<0&&(Fh.ipid2=c.gi().LoadFromFile("bk/bb.xxx",-1,!1)),E.Frame2_MD(this.iX,this.iY,this.iW,this.iH),c.gi().DrawImageEx(0,this.iX,this.iY,Fh.ipid1,0,0,512,480,101,1,1,0,0,0),c.gi().DrawImageEx(0,this.iX+512,this.iY,Fh.ipid2,0,0,288,480,101,1,1,0,0,0),this.btn_close.Draw()}ProcTouch(i,t,s){return!!this.btn_close.ProcTouch(i,t,s)&&(this.btn_close.bCheck()&&ln.gi().PopStat(1),!0)}}Fh.ipid1=-1,Fh.ipid2=-1;class Xh extends s{constructor(i){super(),iStatType=ln.GS_LOGO,this.pani=i,this.pm3f=c.xm3f,this.iDelay=40,this.iLogoId1=c.gi().LoadFromFile("bk/ca.xxx",-1,!1),this.iLogoId2=c.gi().LoadFromFile("bk/cb.xxx",-1,!1),this.iW=480,this.iH=320}Draw(){this.pm3f.FillRect_2D(0,0,h.SCRW,h.SCRH,4278190080),this.pm3f.DrawImageEx(0,0,0,this.iLogoId1,0,0,512,480,101,1,1,0,0,0),this.pm3f.DrawImageEx(0,512,0,this.iLogoId2,0,0,288,480,101,1,1,0,0,0),this.iDelay--,this.iDelay<=0&&Xh.bInited&&(ln.gi().PopStat(1),ln.gi().PushStat(ln.GS_LEADPAGE)),e.bAutoGetInForDebug&&(ln.gi().PopStat(1),ln.gi().PushStat(ln.GS_LOGIN),ln.gi().oCurrentView.in_user.sDetail="user",ln.gi().oCurrentView.in_pass.sDetail="pass")}ProcTouch(i,t,s){return!1}}Xh.bInited=!1;class Yh extends s{constructor(i){var t;for(super(),this.WHEELGAP=1e3,this.WHEELMAX=6*this.WHEELGAP,this.school_special=["物理输出、点杀","高敏、封系、控制","辅助、奶妈、复活、恢复","物理输出、群攻","最高法系伤害、群秒(但目标数量较少)","封印、解封、控制","较高法系伤害、群秒(目标数量多)","固定伤害、随机群秒、辅助、持续恢复","单体高伤、复活、持续蓝恢复、封印"],this.pani=i,this.pm3f=i.pm3f,this.bDown=!1,this.iWheel=this.WHEELGAP/2,this.iSelectPoint=0,this.in_nick=new pi(i),this.bCanRand=!0,this.iRandNameDelay=0,this.btn_randname=new Eh(gn.xani_nui1),this.btn_randname.InitButton("随机按钮"),this.btn_randname.Move(706*h.SCRW/1280,634,48,48),this.btn_create=new Eh(gn.xani_nui1),this.btn_create.InitButton("创建按钮"),this.btn_create.Move(h.SCRW-126-25,576,126,128),this.btn_back=new Eh(gn.xani_nui1),this.btn_back.InitButton("返回按钮"),this.btn_back.Move(25,576,126,128),this.aa_roles=new Array(6),this.aa_weapons=new Array(6),t=0;t<6;t++)this.aa_roles[t]=new l,gn.xani_newrole[t].InitAnimaWithName("站立_下",this.aa_roles[t])}wheeldraw(i){for(var t,s,e,a,n;i<0;)i+=this.WHEELMAX;for(i%=this.WHEELMAX,t=0;t<6;t++)if(t*this.WHEELGAP<=i&&i<=(t+1)*this.WHEELGAP){this.iSelectPoint=t;break}for(a=0;a<2;a++)for(t=0;t<6;t++){n=(s=t*this.WHEELGAP+this.WHEELGAP/2)<i?-1:1,(e=Math.abs(s-i))>this.WHEELMAX/2&&(e=Math.abs(s+this.WHEELMAX-i),n=s+this.WHEELMAX<i?-1:1),e>this.WHEELMAX/2&&(e=Math.abs(s-this.WHEELMAX-i),n=s-this.WHEELMAX<i?-1:1);var o=300*h.SCRW/1280;e<this.WHEELGAP?1==a&&gn.xani_nui1.DrawAnimaEx(558*h.SCRW/1280+n*o*e/this.WHEELGAP,544-100*e/this.WHEELGAP,"人物原画",t,101,.65+.35*(this.WHEELGAP-e)/this.WHEELGAP,.65+.35*(this.WHEELGAP-e)/this.WHEELGAP,0,-2,-2):e<2*this.WHEELGAP&&0==a&&gn.xani_nui1.DrawAnimaEx(558*h.SCRW/1280+n*o,444,"人物原画",t,100*(2*this.WHEELGAP-e)/this.WHEELGAP,.65,.65,0,-2,-2)}}Draw(){var i,t;if(Yh.drawback(),this.wheeldraw(this.iWheel+(this.bDown?2*(this.iLockX-this.iMoveX):0)),!this.bDown){for(;this.iWheel<0;)this.iWheel+=this.WHEELMAX;this.iWheel%=this.WHEELMAX,i=this.iSelectPoint*this.WHEELGAP+this.WHEELGAP/2,t=100,this.iWheel<i-t?this.iWheel+=t:this.iWheel>i+t?this.iWheel-=t:this.iWheel=i}for(gn.xani_nui1.DrawAnima(557*h.SCRW/1280-45,15,"种族性别",this.iSelectPoint),i=0;i<3;i++)t=3*parseInt(this.iSelectPoint/2)+i,c.gi().DrawTextEx(1137*h.SCRW/1280,47+106*i,e.sSchools[t+1],4294967295,yh.WordSize(20),101,1,1,0,-2,-2),Y.gi().Format(this.school_special[t],yh.WordSize(120)*h.SCRW/1280,yh.WordSize(20)),Y.gi().Draw(1076*h.SCRW/1280,72+106*i);gn.xani_nui1.DrawAnimaEx(1140*h.SCRW/1280,525,"选中角色底",gn.iDelay,101,.5,.5,0,-2,-2),this.aa_roles[this.iSelectPoint].Draw(1140*h.SCRW/1280,525),this.aa_roles[this.iSelectPoint].NextFrame(),this.in_nick.Move(365*h.SCRW/1280,629,330*h.SCRW/1280,56),this.in_nick.sDetail.length<=0?c.gi().DrawTextEx(536*h.SCRW/1280,657,"角  色  昵  称",1895825407,yh.WordSize(33),101,1,1,0,-2,-2):c.gi().DrawTextEx(536*h.SCRW/1280,657,this.in_nick.sDetail,4294967295,yh.WordSize(30),101,1,1,0,-2,-2),this.iRandNameDelay<=0?this.bCanRand&&this.btn_randname.Draw():this.iRandNameDelay--,this.in_nick.onscr(),this.btn_create.Draw(),this.btn_back.Draw()}ProcTouch(i,t,s){return s<570&&1==i&&(this.bDown=!0,this.iLockX=t,this.iMoveX=t),this.bDown&&(2==i&&(this.iMoveX=t),3==i&&(this.iWheel+=2*(this.iLockX-this.iMoveX),this.bDown=!1)),this.iRandNameDelay<=0&&this.bCanRand&&this.btn_randname.ProcTouch(i,t,s)?(this.btn_randname.bCheck()&&(this.iRandNameDelay=20,this.bCanRand=!1,Mh.gi().s_GetRandName(this.iSelectPoint%2)),!0):(this.in_nick.ProcTouch(i,t,s),this.btn_create.ProcTouch(i,t,s)?(this.btn_create.bCheck()&&(Yh.bCheckNick(this.in_nick.sDetail,4,24)?(Mh.gi().s_CreateRole(ph.iLastSector,ph.iLastSever,this.in_nick.sDetail,this.iSelectPoint%2,this.iSelectPoint/2),ln.gi().PushStat(ln.GS_LOADING1)):L.easymsg.AddMessage("请填写正确的昵称")),!0):!!this.btn_back.ProcTouch(i,t,s)&&(this.btn_back.bCheck()&&ln.gi().PopStat(1),!0))}}Yh.res_bk=-1,Yh.drawback=function(){Yh.res_bk<0&&(Yh.res_bk=c.gi().LoadFromFile("datapackage/others/createrole.png",-1,!0)),c.gi().DrawImageEx(0,0,0,Yh.res_bk,0,0,1280,720,101,yh.BASEW/1280,1,0,0,0)},Yh.GetRandName=function(i){if(ln.gi().LastStatType(0)==ln.GS_CREATEROLE){var t=ln.gi().LastStat(0);t.in_nick.sDetail=i.GetNextString(),t.in_nick.OpenInput(),t.bCanRand=!0}},Yh.bCheckNick=function(i,t,s){var e,h=f.utf8_to_gb2312a(i);if(h.length<t||h.length>s)return!1;for(e=0;e<h.length;e++){if(h[e]=="\\".charCodeAt(0))return!1;if(h[e]=="/".charCodeAt(0))return!1;if(h[e]=="|".charCodeAt(0))return!1}return!0};class Wh{constructor(){this.sName="",this.aa=new l}}class Lh extends s{constructor(){super(),this.btn_startgame=new Eh(gn.xani_local),this.btn_startgame.InitButton("登陆游戏"),this.btn_startgame.Move(h.SCRW/2,h.SCRH/2+200,50,50),this.btn_startgame.SetCheckRect(h.SCRW/2-100,h.SCRH/2+200-100,200,200),this.bLogined=!1}Draw(){drawback(!0),this.btn_startgame.Draw(),this.bLogined||(this.bLogined=!0,fn.gi().Login())}ProcTouch(i,t,s){return this.btn_startgame.ProcTouch(i,t,s)&&this.btn_startgame.bCheck()&&fn.gi().Login(),!1}}Lh.res_bk=-1,Lh.drawback=function(i){Lh.res_bk<0&&(Lh.res_bk=c.gi().LoadFromFile("datapackage/others/back.png",-1,!0)),c.gi().DrawImageEx(0,0,0,Lh.res_bk,0,0,1280,720,101,h.SCRW/1280,1,0,0,0),i&&c.gi().DrawImageEx(0,0,620,Lh.res_bk,0,720,1280,99,101,h.SCRW/1280,1,0,0,0)};class Hh extends s{constructor(i){var t;for(super(),this.MAXROLECOUNT=6,this.posX=new Int32Array(5),this.posY=new Int32Array(5),this.pani=i,this.pm3f=i.pm3f,this.posX[0]=130,this.posY[0]=480,this.posX[1]=330,this.posY[1]=380,this.posX[2]=530,this.posY[2]=480,this.posX[3]=730,this.posY[3]=380,this.posX[4]=930,this.posY[4]=480,this.rlist=new Array(this.MAXROLECOUNT),t=0;t<this.MAXROLECOUNT;t++)this.rlist[t]=new Wh;for(this.btn_select=new Array(this.MAXROLECOUNT+1),t=0;t<this.MAXROLECOUNT+1;t++)this.btn_select[t]=new D(i),this.btn_select[t].bSingleButton=!0,this.btn_select[t].sName="";this.iRoleCount=0,this.btn_changesever=new Eh(gn.xani_nui1),this.btn_changesever.InitButton("选服按钮"),this.btn_changesever.sName="选择服务器",this.btn_changesever.Move(h.OX+919,50,183,54),this.btn_createrole=new Eh(gn.xani_nui1),this.btn_createrole.InitButton("选服按钮"),this.btn_createrole.sName="创建角色",this.btn_createrole.Move(h.OX+1057,299,183,54),this.btn_startgame=new Eh(gn.xani_nui1),this.btn_startgame.InitButton("选服按钮"),this.btn_startgame.sName="进入游戏",this.btn_startgame.Move(h.OX+1057,391,183,54),this.se=new mt,this.se.Init2(0,0,80,50),this.iSelectRolePoint=0}Draw(){var i;for(Lh.drawback(!0),c.gi().FillRect_2D(0,0,h.SCRW,h.SCRH,1342177280),gn.xani_nui1.DrawAnima(h.OX+186,47,"区服条",0),c.gi().DrawTextEx(h.OX+380,74,this.sSectorName,4294967295,yh.WordSize(30),101,1,1,0,-2,-2),c.gi().DrawTextEx(h.OX+700,74,this.sSeverName,4294967295,yh.WordSize(30),101,1,1,0,-2,-2),this.btn_changesever.Draw(),E.local_frame1(h.OX+1046,262,207,219),this.btn_createrole.Draw(),this.btn_startgame.Draw(),i=0;i<5;i++)gn.xani_nui1.DrawAnimaEx(h.OX+this.posX[i],this.posY[i],"站台",0,101,1,1,0,0,0),this.iSelectRolePoint==i&&(gn.xani_nui1.DrawAnimaEx(h.OX+this.posX[i],this.posY[i],"选中角色底",gn.iDelay,101,1,1,0,0,0),this.se.Draw(h.OX+this.posX[i],this.posY[i])),this.btn_select[i].Move(h.OX+this.posX[i]-60,this.posY[i]-250,120,300),i<this.iRoleCount&&(this.rlist[i].aa.Draw(h.OX+this.posX[i],this.posY[i]),this.rlist[i].aa.NextFrame(),gn.xani_nui1.DrawAnimaEx(h.OX+this.posX[i],this.posY[i]-250,"名字框",0,101,1,1,0,0,0),this.pm3f.DrawTextEx(h.OX+this.posX[i],this.posY[i]-250,this.rlist[i].sName,4294967295,yh.WordSize(30),101,1,1,0,-2,-2)),this.iSelectRolePoint==i&&this.se.DrawFront(h.OX+this.posX[i],this.posY[i]);e.bAutoGetInForDebug&&(ln.gi().PopStat(1),ln.gi().PushStat(ln.GS_LOADING1),Mh.gi().s_StartGame(this.rlist[0].iRid),xh.me.iSex=this.rlist[0].iSex,xh.me.iRace=this.rlist[0].iRace,xh.me.bsc=!0)}ProcTouch(i,t,s){var e;if(this.btn_createrole.ProcTouch(i,t,s))return this.btn_createrole.bCheck()&&(this.iRoleCount>=5?L.easymsg.AddMessage("最多创建5个角色"):ln.gi().PushStat(ln.GS_CREATEROLE)),!0;if(this.btn_startgame.ProcTouch(i,t,s))return this.btn_startgame.bCheck()&&(this.iRoleCount<=0?L.easymsg.AddMessage("请先创建角色"):this.iSelectRolePoint<0||this.iSelectRolePoint>=this.iRoleCount?L.easymsg.AddMessage("请先选择角色"):(ln.gi().PushStat(ln.GS_LOADING1),Mh.gi().s_StartGame(this.rlist[this.iSelectRolePoint].iRid),xh.me.iSex=this.rlist[this.iSelectRolePoint].iSex,xh.me.iRace=this.rlist[this.iSelectRolePoint].iRace,xh.me.bsc=!0)),!0;if(this.btn_changesever.ProcTouch(i,t,s))return this.btn_changesever.bCheck()&&(Mh.gi().s_GetSeverList(ph.iLastSector),ln.gi().PushStat(ln.GS_LOADING1)),!0;for(e=0;e<5;e++)if(this.btn_select[e].ProcTouch(i,t,s)&&this.btn_select[e].bCheck())return e<this.iRoleCount?0==this.rlist[e].iStat?L.easymsg.AddMessage("服务器维护中,进入失败"):this.iSelectRolePoint==e?(ln.gi().PushStat(ln.GS_LOADING1),Mh.gi().s_StartGame(this.rlist[this.iSelectRolePoint].iRid),xh.me.iSex=this.rlist[this.iSelectRolePoint].iSex,xh.me.iRace=this.rlist[this.iSelectRolePoint].iRace,xh.me.bsc=!0):this.iSelectRolePoint=e:e>=this.iRoleCount&&ln.gi().PushStat(ln.GS_CREATEROLE),!0;return!1}}Hh.Open=function(i){for(var t,s;ln.gi().iXStat==ln.GS_LOADING1;)ln.gi().PopStat(1);for(;ln.gi().iXStat==ln.GS_SELECTSEVER;)ln.gi().PopStat(1);for((s=ln.gi().iXStat==ln.GS_SELECTROLE?ln.gi().LastStat(0):ln.gi().PushStat(ln.GS_SELECTROLE)).iSectorId=i.GetNextInt(),s.sSectorName=i.GetNextString(),s.iSeverId=i.GetNextInt(),s.sSeverName=i.GetNextString(),ph.iHaveSeverRecord=1,ph.iLastSector=s.iSectorId,ph.iLastSever=s.iSeverId,s.iRoleCount=i.GetNextByte(),t=0;t<s.iRoleCount;t++)s.rlist[t].iRid=i.GetNextInt(),s.rlist[t].sName=i.GetNextString(),s.rlist[t].iSex=i.GetNextByte(),s.rlist[t].iRace=i.GetNextByte(),s.rlist[t].aa=gn.xani_nui1.InitAnimaWithName("展示"+(2*s.rlist[t].iRace+s.rlist[t].iSex),null),s.rlist[t].iStat=1,i.GetNextByte();s.iRoleCount<=0?s.iSelectRolePoint=-1:s.iSelectRolePoint=0};class Bh extends s{constructor(i){var t;for(super(),this.pani=i,this.pm3f=i.pm3f,this.iW=800,this.iH=480,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new D(gn.xani_ui3),this.btn_close.InitButton("统一关闭按钮"),this.btn_close.Move(this.iX+748,this.iY,60,60),this.ifblist=new Int32Array(16),this.btn_fuben=new Array(8),t=0;t<8;t++)this.btn_fuben[t]=new D(gn.xani_ui3),this.btn_fuben[t].InitButton("统一按钮2"),this.btn_fuben[t].Move(this.iX+60,this.iY+40+50*t,128,32),this.btn_fuben[t].iNameSize=20;this.iPoint=0,this.btn_create=new Wi(gn.xani_ui3),this.btn_create.InitButton("统一按钮1"),this.btn_create.Move(this.iX+620,this.iY+390,117,40),this.btn_create.sName="创 建",this.btn_detail=new Wi(gn.xani_ui3),this.btn_detail.InitButton("统一按钮1"),this.btn_detail.Move(this.iX+620,this.iY+310,117,40),this.btn_detail.sName="修改简介",this.btn_detail.iNameSize=25,this.sDetail="无",this.in_detail=new pi(gn.xani_frame),this.in_detail.Move(h.SCRW,h.SCRH,10,10),this.in_detail.sDetail="",this.bEditingName=!1}Draw(){var i;for(E.ui3_BaseFrame4(this.iX,this.iY,"创","建","副","本"),this.btn_close.Draw(),i=0;i<this.iCount;i++)this.iPoint==i&&gn.xani_ui3.DrawAnimaEx(this.iX+45,this.iY+30+50*i+5,"选中背景",0,101,.9,.71,0,0,0),this.btn_fuben[i].sName=gn.de_fuben.strValue(this.ifblist[i],0,1),this.btn_fuben[i].Draw();gn.xani_ui3.DrawAnima(this.iX+200,this.iY,"大框分割线",0),E.ui3_Frame2(this.iX+230,this.iY+40,500,120),Y.gi().Format(gn.de_fuben.strValue(this.ifblist[this.iPoint],0,2),480,20),Y.gi().Draw(this.iX+230+10,this.iY+40+10),E.ui3_Text1(this.iX+230,this.iY+180,100,130,"人数限制",gn.de_fuben.strValue(this.ifblist[this.iPoint],0,3)+"~"+gn.de_fuben.strValue(this.ifblist[this.iPoint],0,4)),E.ui3_Text1(this.iX+230+270,this.iY+180,100,130,"等级限制",gn.de_fuben.strValue(this.ifblist[this.iPoint],0,5)+"~"+gn.de_fuben.strValue(this.ifblist[this.iPoint],0,6)),E.ui3_Text1(this.iX+230,this.iY+180+50,100,130,"创建花费",gn.de_fuben.strValue(this.ifblist[this.iPoint],0,8)+"金钱"),c.gi().DrawText_2(this.iX+230,this.iY+180+100,"团队简介:",4294959264,20,101,1,1,0,0,0,3,4278190080),E.ui3_Frame2(this.iX+230,this.iY+180+100+30,350,120),Y.gi().Format(this.sDetail,330,20),Y.gi().Draw(this.iX+230+10,this.iY+180+100+30+10),this.btn_detail.Draw(),this.btn_create.Draw(),this.bEditingName&&(this.in_detail.onscr(),this.sDetail=this.in_detail.sDetail,this.in_detail.bFinished&&(this.bEditingName=!1,this.in_detail.bFinished=!1))}ProcTouch(i,t,s){var e;for(e=0;e<this.iCount;e++)if(this.btn_fuben[e].ProcTouch(i,t,s))return this.btn_fuben[e].bCheck()&&(this.iPoint=e),!0;return this.btn_close.ProcTouch(i,t,s)?(this.btn_close.bCheck()&&ln.gi().PopStat(1),!0):(this.btn_create.ProcTouch(i,t,s)&&this.btn_create.bCheck()&&(Mh.gi().s_CreateFuBen(this.ifblist[this.iPoint],this.sDetail),ln.gi().PopStat(1)),this.btn_detail.ProcTouch(i,t,s)&&this.btn_detail.bCheck()&&(this.in_detail.Move(this.btn_detail.iX,this.btn_detail.iY,this.btn_detail.iW,this.btn_detail.iH),this.in_detail.sDetail=this.sDetail,this.in_detail.OpenInput(),this.in_detail.ProcTouch(3,h.SCRW+1,h.SCRH+1),this.bEditingName=!0),!1)}}class Vh{}class Uh extends s{constructor(i){var t;for(super(),this.MAXSECTORCOUNT=10,this.MAXSEVERCOUNT=10,this.iW=800,this.iH=480,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.pani=i,this.pm3f=i.pm3f,this.sSectorName=new Array(this.MAXSECTORCOUNT),this.iSectorId=new Int32Array(this.MAXSECTORCOUNT),this.slist=new Array(this.MAXSEVERCOUNT),this.tjlist=new Array(this.MAXSEVERCOUNT),t=0;t<this.MAXSEVERCOUNT;t++)this.slist[t]=new Vh,this.tjlist[t]=new Vh;for(this.iSeverCount=0,this.iSectorCount=0,this.iCurrentSectorId=0,this.btn_sector=new Array(this.MAXSECTORCOUNT),t=0;t<this.MAXSECTORCOUNT;t++)this.btn_sector[t]=new Eh(gn.xani_nui1),this.btn_sector[t].InitButton("选区按钮1"),this.btn_sector[t].sName="",this.btn_sector[t].Move(h.OX+200,270+73*t,183,54);for(this.btn_sever=new Array(this.MAXSEVERCOUNT),this.btn_tj=new Array(this.MAXSEVERCOUNT),t=0;t<this.MAXSEVERCOUNT;t++)this.btn_sever[t]=new Eh(gn.xani_nui1),this.btn_sever[t].InitButton("选服按钮2"),this.btn_sever[t].sName="",this.btn_sever[t].Move(h.OX+457+t%3*220,253+86*parseInt(t/3),178,51),this.btn_tj[t]=new Eh(gn.xani_nui1),this.btn_tj[t].InitButton("选服按钮2"),this.btn_tj[t].sName="",this.btn_tj[t].Move(h.OX+457+t%3*220,112+t/3*86,178,51);this.btn_create=new Eh(gn.xani_nui1),this.btn_create.InitButton("确定服务器"),this.btn_create.Move(h.SCRW-126-25,576,126,128),this.btn_back=new Eh(gn.xani_nui1),this.btn_back.InitButton("返回按钮"),this.btn_back.Move(25,576,126,128),this.se=new mt,this.se.Init1(0,0,178,50,100)}InitSeverList(i){var t,s,e;for(this.iCurrentSectorId=i.GetNextInt(),this.iSectorCount=i.GetNextByte(),t=0;t<this.iSectorCount;t++)this.sSectorName[t]=i.GetNextString(),this.iSectorId[t]=i.GetNextInt(),this.btn_sector[t].bMouseIn=!1,this.btn_sector[t].bMouseDown=!1,this.btn_sector[t].sName=this.sSectorName[t];for(this.iCurrentSeverId=-1,t=0;t<100&&1==(s=i.GetNextByte());t++){switch(this.slist[t].sName=i.GetNextString(),this.slist[t].iSeverId=i.GetNextInt(),this.slist[t].iStatus=i.GetNextByte(),this.btn_sever[t].sName=this.slist[t].sName,this.slist[t].iStatus){case 0:default:this.btn_sever[t].InitButton("选服按钮a");break;case 1:this.btn_sever[t].InitButton("选服按钮b");break;case 2:this.btn_sever[t].InitButton("选服按钮c");break;case 3:case 5:this.btn_sever[t].InitButton("选服按钮d")}this.slist[t].iSeverId==ph.iLastSever&&(this.iCurrentSeverId=ph.iLastSever),this.slist[t].bNew=!1}for(this.iSeverCount=t,-1==this.iCurrentSeverId&&this.iSeverCount>0&&(this.iCurrentSeverId=this.slist[0].iSeverId),t=0;t<100&&2==(s=i.GetNextByte());t++){switch(this.tjlist[t].sName=i.GetNextString(),this.tjlist[t].iSectorId=i.GetNextInt(),this.tjlist[t].iSeverId=i.GetNextInt(),this.tjlist[t].iStatus=i.GetNextByte(),this.btn_tj[t].sName=this.tjlist[t].sName,this.tjlist[t].iStatus){case 0:default:this.btn_tj[t].InitButton("选服按钮a");break;case 1:this.btn_tj[t].InitButton("选服按钮b");break;case 2:this.btn_tj[t].InitButton("选服按钮c");break;case 3:case 5:this.btn_tj[t].InitButton("选服按钮d")}this.tjlist[t].iSeverId==ph.iLastSever&&(this.iCurrentSeverId=ph.iLastSever)}for(this.iTJCount=t,t=0;t<100&&3==(s=i.GetNextByte());t++)for(e=i.GetNextInt(),s=0;s<this.iSeverCount;s++)if(this.slist[s].iSeverId==e){this.slist[s].bNew=!0;break}}Draw(){var i,t;for(Lh.drawback(!0),E.local_frame2((h.SCRW-950)/2,(h.SCRH-560)/2,950,560),gn.xani_nui1.DrawAnimaEx(h.OX+640,80,"背景框2",8,101,1,1,0,0,0),gn.xani_nui1.DrawAnimaEx(h.OX+300,137,"推荐区标题",0,101,1,1,0,0,0),gn.xani_local.DrawAnimaEx(h.OX+140,210,"分隔条",0,101,2.5,1,0,0,0),gn.xani_local.DrawAnimaEx(h.OX+420,210,"分隔条",0,101,1,1,90,h.OX+420,210),i=-6;i<6;i++)gn.xani_nui1.DrawAnimaEx(h.OX+640+76*i,180,"底纹",0,101,1,1,0,0,0);for(gn.xani_local.DrawAnimaEx(h.OX+291,239,"方向指引",0,101,1,1,0,0,0),gn.xani_local.DrawAnimaEx(h.OX+291,586,"方向指引",0,101,1,1,180,-1,-1),i=0;i<this.iSectorCount;i++)this.iSectorId[i]==this.iCurrentSectorId?(gn.xani_nui1.DrawAnimaEx(this.btn_sector[i].iX,this.btn_sector[i].iY,"选区按钮2",0,101,1,1,0,0,0),this.btn_sector[i].DrawText(0,0)):this.btn_sector[i].Draw();for(this.se.Logic(),i=0;i<this.iSeverCount;i++)this.btn_sever[i].Draw(),this.slist[i].iSeverId==this.iCurrentSeverId&&this.se.Draw(this.btn_sever[i].iX-20,this.btn_sever[i].iY),this.slist[i].bNew&&gn.xani_nui4.DrawAnima(this.btn_sever[i].iX+160-44+15,this.btn_sever[i].iY-15,"新服提示",0);for(i=0;i<this.iTJCount;i++)this.btn_tj[i].Draw(),this.tjlist[i].iSeverId==this.iCurrentSeverId&&this.se.Draw(this.btn_tj[i].iX-20,this.btn_tj[i].iY);i=h.OX+560,t=580,gn.xani_nui1.DrawAnimaEx(i,t,"状态说明",0,101,1,1,0,0,0),gn.xani_nui1.DrawAnimaEx(i+30,596,"状态说明",1,101,1,1,0,0,0),c.gi().DrawTextEx(i+50,596,"维护",4294967295,20,101,1,1,0,0,-2),i+=124,gn.xani_nui1.DrawAnimaEx(i+30,596,"状态说明",2,101,1,1,0,0,0),c.gi().DrawTextEx(i+50,596,"良好",4294967295,20,101,1,1,0,0,-2),i+=124,gn.xani_nui1.DrawAnimaEx(i+30,596,"状态说明",3,101,1,1,0,0,0),c.gi().DrawTextEx(i+50,596,"繁忙",4294967295,20,101,1,1,0,0,-2),i+=124,gn.xani_nui1.DrawAnimaEx(i+30,596,"状态说明",4,101,1,1,0,0,0),c.gi().DrawTextEx(i+50,596,"火爆",4294967295,20,101,1,1,0,0,-2),this.btn_create.Draw(),this.btn_back.Draw(),e.bAutoGetInForDebug&&(this.iCurrentSeverId=this.slist[1].iSeverId,Mh.gi().s_GetRoleList(this.iCurrentSectorId,this.iCurrentSeverId),ln.gi().PushStat(ln.GS_LOADING1))}ProcTouch(i,t,s){var e;if(this.btn_create.ProcTouch(i,t,s)){if(this.btn_create.bCheck()){for(e=0;e<this.iSeverCount;e++)if(this.iCurrentSeverId==this.slist[e].iSeverId){if(0!=this.slist[e].iStatus)return Mh.gi().s_GetRoleList(this.iCurrentSectorId,this.iCurrentSeverId),ln.gi().PushStat(ln.GS_LOADING1),!0;L.easymsg.AddMessage("服务器维护中，不能进入")}for(e=0;e<this.iTJCount;e++)if(this.iCurrentSeverId==this.tjlist[e].iSeverId){if(0!=this.tjlist[e].iStatus)return Mh.gi().s_GetRoleList(this.tjlist[e].iSectorId,this.iCurrentSeverId),ln.gi().PushStat(ln.GS_LOADING1),!0;L.easymsg.AddMessage("服务器维护中，不能进入")}L.easymsg.AddMessage("请先选中服务器")}return!0}if(this.btn_back.ProcTouch(i,t,s))return this.btn_back.bCheck()&&ln.gi().PopStat(1),!0;for(e=0;e<this.iSectorCount;e++)this.btn_sector[e].ProcTouch(i,t,s)&&this.btn_sector[e].bCheck()&&this.iSectorId[e]!=this.iCurrentSectorId&&(ln.gi().PushStat(ln.GS_LOADING1),Mh.gi().s_GetSeverList(this.iSectorId[e]));for(e=0;e<this.iSeverCount;e++)this.btn_sever[e].ProcTouch(i,t,s)&&this.btn_sever[e].bCheck()&&(this.iCurrentSeverId=this.slist[e].iSeverId);for(e=0;e<this.iTJCount;e++)this.btn_tj[e].ProcTouch(i,t,s)&&this.btn_tj[e].bCheck()&&(this.iCurrentSeverId=this.tjlist[e].iSeverId);return!1}}Uh.Open=function(i){for(;ln.gi().iXStat==ln.GS_LOADING1;)ln.gi().PopStat(1);ln.gi().iXStat==ln.GS_LEADPAGE&&ln.gi().PopStat(1),(ln.gi().iXStat==ln.GS_SELECTSEVER?ln.gi().LastStat(0):ln.gi().PushStat(ln.GS_SELECTSEVER)).InitSeverList(i)};class zh extends s{constructor(){var i;for(super(),this.MAXDESTORYUSER=5,this.pani=gn.xani_ui,this.pm3f=gn.xani_ui.pm3f,this.btn_history=new Array(this.MAXDESTORYUSER),this.btn_delete=new Array(this.MAXDESTORYUSER),i=0;i<this.MAXDESTORYUSER;i++)this.btn_history[i]=new D(gn.xani_ui),this.btn_history[i].InitButton("主菜单按钮2"),this.btn_delete[i]=new D(gn.xani_ui),this.btn_delete[i].sName="x",this.btn_delete[i].InitButton("中按钮1");this.InitUserBtn(),this.btn_autogetin=new D(gn.xani_ui),this.btn_autogetin.sName="渠道登陆",this.btn_autogetin.InitButton("主菜单按钮2"),this.btn_regist=new D(gn.xani_ui),this.btn_regist.sName="注册帐号",this.btn_regist.InitButton("主菜单按钮2"),this.btn_login=new D(gn.xani_ui),this.btn_login.sName="登录",this.btn_login.InitButton("主菜单按钮2")}InitUserBtn(){var i;for(i=0;i<gn.x_record.iUserCount;i++)this.btn_history[i].sName=gn.x_record.sUser[i]}Draw(){var i,t,s;for(Lh.drawback(!0),gn.xani_local.DrawAnimaEx(240,150,"七国标题",0,101,1,1,0,0,0),this.InitUserBtn(),t=0,s=218,i=0;i<gn.x_record.iUserCount;i++)this.btn_history[i].Move(h.SCRW/2-109,h.SCRH/2+60*t,s,50),this.btn_history[i].Draw(),this.btn_delete[i].Move(h.SCRW/2+109-51,h.SCRH/2+60*t+6,40,40),this.btn_delete[i].Draw(),t++;this.btn_login.Move(h.SCRW/2-109,h.SCRH/2+60*t,s,50),this.btn_login.Draw(),t++,this.btn_regist.Move(h.SCRW/2-109,h.SCRH/2+60*t,s,50),this.btn_regist.Draw(),e.bAutoGetInForDebug&&(ln.gi().PopStat(1),ln.gi().PushStat(ln.GS_LOGIN))}ProcTouch(i,t,s){var e,h;for(e=0;e<gn.x_record.iUserCount;e++){if(this.btn_delete[e].ProcTouch(i,t,s)&&this.btn_delete[e].bCheck()){for(gn.x_record.iUserCount--,h=e;h<gn.x_record.iUserCount;h++)gn.x_record.sUser[h]=gn.x_record.sUser[h+1],gn.x_record.sPass[h]=gn.x_record.sPass[h+1];return this.InitUserBtn(),gn.x_record.SaveTo(bn.RECORDFILENAME),!0}if(this.btn_history[e].ProcTouch(i,t,s)&&this.btn_history[e].bCheck())return ln.gi().PushStat(ln.GS_LOGIN),ln.gi().oCurrentView.in_user.sDetail=gn.x_record.sUser[e],ln.gi().oCurrentView.in_pass.sDetail=gn.x_record.sPass[e],ln.gi().oCurrentView.in_user.OpenInput(),ln.gi().oCurrentView.in_pass.OpenInput(),ln.gi().oCurrentView.chk_saveuser.bTrue=gn.x_record.bSaveUser,ln.gi().oCurrentView.chk_savepass.bTrue=gn.x_record.bSavePass,!0}return this.btn_login.ProcTouch(i,t,s)&&this.btn_login.bCheck()&&(ln.gi().PushStat(ln.GS_LOGIN),ln.gi().oCurrentView.in_user.sDetail="",ln.gi().oCurrentView.in_pass.sDetail="",ln.gi().oCurrentView.in_user.OpenInput(),ln.gi().oCurrentView.in_pass.OpenInput(),ln.gi().oCurrentView.chk_saveuser.bTrue=gn.x_record.bSaveUser,ln.gi().oCurrentView.chk_savepass.bTrue=gn.x_record.bSavePass),this.btn_regist.ProcTouch(i,t,s)&&this.btn_regist.bCheck()&&(ln.gi().PushStat(ln.GS_REGIST),ln.gi().oCurrentView.in_user.sDetail="",ln.gi().oCurrentView.in_pass.sDetail=""),!1}}class jh extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.in_user=new pi(this.pani),this.in_user.Move(h.SCRW/2-100,h.SCRH/2-100,300,50),this.in_user.sDetail="user",this.in_pass=new pi(this.pani),this.in_pass.Move(h.SCRW/2-100,h.SCRH/2-20,300,50),this.in_pass.sDetail="pass",this.btn_regist=new D(i),this.btn_regist.sName="确定注册",this.btn_regist.Move(h.SCRW/2-70,h.SCRH/2+80,140,50),this.btn_regist.InitButton("大按钮4"),this.iErrorDelay=0}Draw(){this.pm3f.FillRect_2D(0,0,h.SCRW,h.SCRH,4280295456),this.pm3f.DrawText(0,0,"注册帐号",4294967295),this.pm3f.DrawText(h.SCRW/2-200,h.SCRH/2-100+10,"账号:",4294967295),this.pm3f.DrawText(h.SCRW/2-200,h.SCRH/2-20+10,"密码:",4294967295),this.in_user.Draw(),this.in_pass.Draw(),this.btn_regist.Draw(),this.in_user.onscr(),this.in_pass.onscr()}ProcTouch(i,t,s){return this.in_user.ProcTouch(i,t,s),this.in_pass.ProcTouch(i,t,s),this.btn_regist.ProcTouch(i,t,s)&&this.btn_regist.bCheck()&&(jh.bCheckString(this.in_user.sDetail,4,24)?jh.bCheckString(this.in_pass.sDetail,4,24)?(Mh.gi().s_Regist(this.in_user.sDetail,this.in_pass.sDetail),ln.gi().PushStat(ln.GS_LOADING1)):(this.iErrorDelay=30,L.easymsg.AddMessage("密码格式有误"),this.sErrorDetail="密码格式有误"):(this.iErrorDelay=30,L.easymsg.AddMessage("帐号格式有误"),this.sErrorDetail="帐号格式有误")),!1}}jh.bCheckString=function(i,t,s){var e,h=f.utf8_to_gb2312a(i);if(h.length<t||h.length>s)return!1;for(e=0;e<h.length;e++)if(!(h[e]>="a".charCodeAt(0)&&h[e]<="z".charCodeAt(0)||h[e]>="A".charCodeAt(0)&&h[e]<="Z".charCodeAt(0)||h[e]>="0".charCodeAt(0)&&h[e]<="9".charCodeAt(0)))return!1;return!0};class Jh extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.in_user=new pi(this.pani),this.in_user.Move(h.SCRW/2-100,h.SCRH/2-100,200,50),this.in_user.sDetail="user",this.in_user.OpenInput(),this.in_pass=new pi(this.pani),this.in_pass.Move(h.SCRW/2-100,h.SCRH/2-20,200,50),this.in_pass.sDetail="pass",this.in_pass.OpenInput(),this.btn_login=new D(i),this.btn_login.sName="确定登录",this.btn_login.Move(h.SCRW/2-70,h.SCRH/2+60,140,50),this.btn_login.InitButton("主菜单按钮2"),this.chk_saveuser=new T(i),this.chk_saveuser.Move(h.SCRW/2+120,h.SCRH/2-100+5,40,40),this.chk_saveuser.sDetail="",this.chk_saveuser.InitBox("复选框"),this.chk_savepass=new T(i),this.chk_savepass.Move(h.SCRW/2+120,h.SCRH/2-20+5,40,40),this.chk_savepass.sDetail="",this.chk_savepass.InitBox("复选框"),this.iErrorDelay=0}Draw(){var i,t;Lh.drawback(!0),gn.xani_local.DrawAnimaEx(240,150,"七国标题",0,101,1,1,0,0,0),i=h.SCRW/2-100,t=200,gn.xani_ui.DrawAnimaEx(i-70,t+55,"账号密码",0,101,1,1,0,0,0),gn.xani_ui.DrawAnimaEx(i+30,t+50,"账号密码",2,101,1,1,0,0,0),this.in_user.Move(i+30,t+50,215,47),this.in_user.DrawText(),this.chk_saveuser.Move(i+30+215+10,t+53,40,40),this.chk_saveuser.Draw(),t=300,gn.xani_ui.DrawAnimaEx(i-70,t+55,"账号密码",1,101,1,1,0,0,0),gn.xani_ui.DrawAnimaEx(i+30,t+50,"账号密码",2,101,1,1,0,0,0),this.in_pass.Move(i+30,t+50,215,47),this.in_pass.DrawText(),this.chk_savepass.Move(i+30+215+10,t+53,40,40),this.chk_savepass.Draw(),this.in_user.onscr(),this.in_pass.onscr(),t=450,this.btn_login.Move(h.SCRW/2-109,t,218,50),this.btn_login.Draw(),e.bAutoGetInForDebug&&(ln.gi().PopStat(1),Mh.gi().s_Login(this.in_user.sDetail,this.in_pass.sDetail),ln.gi().PushStat(ln.GS_LOADING1))}ProcTouch(i,t,s){return this.in_user.ProcTouch(i,t,s),this.in_pass.ProcTouch(i,t,s),this.chk_saveuser.ProcTouch(i,t,s),this.chk_savepass.ProcTouch(i,t,s),this.btn_login.ProcTouch(i,t,s)&&this.btn_login.bCheck()&&(jh.bCheckString(this.in_user.sDetail,4,24)?jh.bCheckString(this.in_pass.sDetail,4,24)?(Mh.gi().s_Login(this.in_user.sDetail,this.in_pass.sDetail),ln.gi().PushStat(ln.GS_LOADING1),this.chk_saveuser.bTrue&&(gn.x_record.sUser[0]=this.in_user.sDetail,this.chk_savepass.bTrue?gn.x_record.sPass[0]=this.in_pass.sDetail:gn.x_record.sPass[0]="",gn.x_record.iUserCount=1,gn.x_record.bSaveUser=this.chk_saveuser.bTrue,gn.x_record.bSavePass=this.chk_savepass.bTrue,gn.x_record.SaveTo(bn.RECORDFILENAME))):(this.iErrorDelay=30,L.easymsg.AddMessage("密码格式有误"),this.sErrorDetail="密码格式有误"):(this.iErrorDelay=30,L.easymsg.AddMessage("帐号格式有误"),this.sErrorDetail="帐号格式有误")),!1}}class Qh extends s{constructor(i){super(),this.pani=i,this.iW=350,this.iH=200,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_ok=null,this.btn_cancel=null}Draw(){gn.bInited&&(null==this.btn_ok&&(this.btn_ok=new Eh(gn.xani_nui3),this.btn_ok.InitButton("内框按钮"),this.btn_ok.Move(this.iX+10,this.iY+this.iH-60,70,40),this.btn_ok.sName="确定",this.btn_cancel=new Eh(gn.xani_nui3),this.btn_cancel.InitButton("内框按钮"),this.btn_cancel.Move(this.iX+this.iW-90,this.iY+this.iH-60,70,40),this.btn_cancel.sName="取消"),Y.gi().FormatEx("是否确定退出游戏",this.iW-40,26,0,0,30),this.iH=20+Y.gi().iH+20+55+20,this.iY=(h.SCRH-this.iH)/2,this.btn_ok.Move(this.iX+20,this.iY+this.iH-70,98,55),this.btn_cancel.Move(this.iX+this.iW-98-20,this.iY+this.iH-70,98,55),DrawMode.new_framewatch(this.iX,this.iY,this.iW,this.iH),Y.gi().Draw(this.iX+20,this.iY+20),this.btn_ok.Draw(),this.btn_cancel.Draw())}ProcTouch(i,t,s){return!!gn.bInited&&(this.btn_ok.ProcTouch(i,t,s)&&this.btn_ok.bCheck()&&(ln.gi().PopStat(1),fn.gi().Exit()),this.btn_cancel.ProcTouch(i,t,s)&&this.btn_cancel.bCheck()&&ln.gi().PopStat(1),!1)}}class qh extends s{constructor(i){super(),this.iW=300,this.iH=200,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.sDetail="点击确定关闭游戏",this.btn_ok=null}Draw(){null==this.btn_ok&&(this.btn_ok=new Eh(gn.xani_button),this.btn_ok.sName="确定",this.btn_ok.Move(this.iX+(this.iW-90)/2,this.iY+this.iH-60-20,90,60),this.btn_ok.InitButton("1号按钮90_60")),c.gi().FillRect_2D(this.iX,this.iY,this.iX+this.iW,this.iY+this.iH,2147483648),c.gi().DrawRect_2D(this.iX,this.iY,this.iX+this.iW,this.iY+this.iH,4294967295),Y.gi().Format("#cffff00已掉线",this.iW-40,20),Y.gi().Draw(this.iX+20,this.iY+20)}ProcTouch(i,t,s){return null!=this.btn_ok&&(this.btn_ok.ProcTouch(i,t,s)&&this.btn_ok.bCheck()&&fn.gi().Exit(),!1)}}class Kh extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iDelay=0,this.aa_loading=gn.xani_ui.InitAnimaWithName("载入中",null)}Draw(){this.iDelay<128&&(this.iDelay+=15),c.gi().FillRect_2D(0,0,h.SCRW,h.SCRH,this.iDelay<<24),this.aa_loading.Draw(h.SCRW/2,3*h.SCRH/5),this.aa_loading.NextFrame()}ProcTouch(i,t,s){return!1}}class Zh extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iStat=0,this.iDelay=0,this.aa_loading=gn.xani_ui.InitAnimaWithName("载入中",null)}Draw(){c.gi().FillRect_2D(0,0,h.SCRW,h.SCRH,4278190080),this.aa_loading.Draw(h.SCRW/2,3*h.SCRH/5),this.aa_loading.NextFrame()}ProcTouch(i,t,s){return!1}}class $h extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f}Draw(){this.pm3f.FillRect_2D(0,0,h.SCRW,h.SCRH,4278190080),this.pm3f.DrawText(0,0,"Message",4294967295),this.pm3f.DrawText(100,h.SCRH/2,this.sDetail,4294967295),parseInt(this.iDelay/5)%2==0&&this.pm3f.DrawText(100,h.SCRH/2+50,"按任意键继续...",4294967295),this.iDelay++}ProcTouch(i,t,s){return i==Gh.TOUCH_UP&&ln.gi().PopStat(1),!1}}$h.Open=function(i){ln.gi().PushStat(ln.GS_MESSAGE1).sDetail=i};class ia extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=350,this.iH=200,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_ok=new Eh(gn.xani_nui3),this.btn_ok.InitButton("内框按钮"),this.btn_ok.Move(this.iX+10,this.iY+this.iH-60,70,40),this.btn_cancel=new Eh(gn.xani_nui3),this.btn_cancel.InitButton("内框按钮"),this.btn_cancel.Move(this.iX+this.iW-90,this.iY+this.iH-60,70,40)}Draw(){Y.gi().FormatEx(this.sMsg,this.iW-40,26,0,0,30),this.iH=20+Y.gi().iH+20+55+20,this.iY=(h.SCRH-this.iH)/2,this.btn_ok.Move(this.iX+20,this.iY+this.iH-70,98,55),this.btn_cancel.Move(this.iX+this.iW-98-20,this.iY+this.iH-70,98,55),DrawMode.new_framewatch(this.iX,this.iY,this.iW,this.iH),Y.gi().Draw(this.iX+20,this.iY+20),this.btn_ok.Draw(),this.btn_cancel.Draw()}ProcTouch(i,t,s){return this.btn_ok.ProcTouch(i,t,s)&&this.btn_ok.bCheck()&&(Mh.gi().s_SevConfirm(this.sCmd),ln.gi().PopStat(1)),this.btn_cancel.ProcTouch(i,t,s)&&this.btn_cancel.bCheck()&&ln.gi().PopStat(1),!1}}ia.Open=function(i){if(ln.gi().LastStatType(0)!=ln.GS_CONFIRM2){var t=ln.gi().PushStat(ln.GS_CONFIRM2);t.sMsg=i.GetNextString(),t.btn_ok.sName=i.GetNextString(),t.btn_cancel.sName=i.GetNextString(),t.sCmd=i.GetNextString()}};class ta{constructor(){}}class sa extends s{constructor(i){super(),this.campscore=new Int32Array(3),this.ranklist=new ta(6);for(var t=0;t<6;t++)this.ranklist[t]=new ta;for(this.iW=950,this.iH=570,this.iX=(GmConfig.SCRW-this.iW)/2,this.iY=(GmConfig.SCRH-this.iH)/2,this.btn_close=new XButtonEx2(GmPlay.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.sAttack=new Array(2),this.btn_attack=new Array(2),t=0;t<2;t++)this.btn_attack[t]=new XButtonEx2(GmPlay.xani_button),this.btn_attack[t].InitButton("巅峰决战进攻173_94");this.list_rank=new UIList(0,4,490,290),this.list_rank.SetTitle(0,"排名",80,!1),this.list_rank.SetTitle(1,"玩家名称",160,!1),this.list_rank.SetTitle(2,"门派",100,!1),this.list_rank.SetTitle(3,"个人积分",150,!1),this.iCountDown=[[0,0,0],[0,0,0]]}_open(i){var t;for(this.campscore[0]=i.GetNextInt(),this.campscore[1]=i.GetNextInt(),this.campscore[2]=i.GetNextInt(),t=0;t<5;t++)this.ranklist[t].iRank=t+1,this.ranklist[t].sName=i.GetNextString(),this.ranklist[t].iSchoolId=i.GetNextByte(),this.ranklist[t].iScore=i.GetNextInt();this.ranklist[5].iRank=i.GetNextInt()+1,this.ranklist[5].sName=GmMe.me.sName,this.ranklist[5].iSchoolId=GmMe.me.rbs.iSchoolId,this.ranklist[5].iScore=i.GetNextInt(),this.iMyCamp=i.GetNextInt(),this.iCountDown[0][0]=i.GetNextInt(),this.iCountDown[0][1]=i.GetNextInt(),this.iCountDown[0][2]=XDefine.get_ms(),this.iCountDown[1][0]=i.GetNextInt(),this.iCountDown[1][1]=i.GetNextInt(),this.iCountDown[1][2]=XDefine.get_ms()}Draw(){var i,t,s,e;for(DrawMode.frame_type4("主背景框a150_150",this.iX,this.iY,this.iW,this.iH,150,150),DrawMode.frame_type4("子背景框b35_35",this.iX+30,this.iY+30,this.iW-60,this.iH-60,35,35),this.btn_close.Draw(),i=0;i<3;i++)GmPlay.xani_frame.DrawAnima(this.iX+100+260*i,this.iY+50,"巅峰决战国家框172_84",0),GmPlay.xani_icon.DrawAnima(this.iX+100+260*i,this.iY+50,"巅峰决战国"+(i+1),0),M3DFast.gi().DrawTextEx(this.iX+100+260*i+115,this.iY+50+42,""+this.campscore[i],4294967295,20,101,1,1,0,-2,-2);for(this.list_rank.BeginDraw(this.iX+100,this.iY+150),i=0;i<6;i++)this.ranklist[i].iScore>0&&(this.list_rank.DrawUnit(0,i,""+this.ranklist[i].iRank),this.list_rank.DrawUnit(1,i,this.ranklist[i].sName),this.list_rank.DrawUnit(2,i,GameData.sSchools[this.ranklist[i].iSchoolId]),this.list_rank.DrawUnit(3,i,""+this.ranklist[i].iScore));switch(this.list_rank.FinishDraw(),this.iMyCamp){case 0:this.sAttack[0]="伐楚",this.sAttack[1]="伐齐";break;case 1:this.sAttack[0]="伐秦",this.sAttack[1]="伐齐";break;case 2:this.sAttack[0]="伐秦",this.sAttack[1]="伐楚"}for(i=0;i<2;i++)this.btn_attack[i].Move(this.iX+620,this.iY+180+130*i,173,94),this.btn_attack[i].Draw(),GmPlay.xani_icon.DrawAnima(this.btn_attack[i].iX+10,this.btn_attack[i].iY+8,"巅峰决战旗",0),M3DFast.gi().DrawText_2(this.btn_attack[i].iX+100,this.btn_attack[i].iY+47,this.sAttack[i],4294967040,30,101,1,1,0,-2,-2,4,4278199373);DrawMode.frame_type1("文本框a20_40",this.iX+this.iW/2-325,this.iY+this.iH-90,650,20),DrawMode.frame_type1("活跃进度外框a20_24",this.iX+50,this.iY+this.iH-100,850,20),t=this.iY+this.iH-100+2,(e=1e3*this.iCountDown[0][1]-(XDefine.get_ms()-this.iCountDown[0][2]))<0&&(e=0),M3DFast.gi().DrawTextEx(this.iX+this.iW/2-60,this.iY+this.iH-80+4,"进攻冷却倒计时："+e/1e3+"秒",4294967040,24,101,1,1,0,-3,0),s=425*e/this.iCountDown[0][0]/1e3,i=this.iX+50+2+425-s,DrawMode.frame_type1("活跃进度内框a10_18",i,t,s,10),i=this.iX+50+425+2,(e=1e3*this.iCountDown[1][1]-(XDefine.get_ms()-this.iCountDown[1][2]))<0&&(e=0),M3DFast.gi().DrawTextEx(this.iX+this.iW/2+60,this.iY+this.iH-80+4,"防守冷却倒计时："+e/1e3+"秒",4294967040,24,101,1,1,0,-1,0),s=425*e/this.iCountDown[1][0]/1e3,DrawMode.frame_type1("活跃进度内框a10_18",i,t,s,10),GmPlay.xani_icon.DrawAnima(this.iX+this.iW/2-63,this.iY+this.iH-125,"巅峰决战狮子头",0)}ProcTouch(i,t,s){var e;if(this.btn_close.ProcTouch(i,t,s))return this.btn_close.bCheck()&&XStat.gi().PopStat(1),!0;for(e=0;e<2;e++)this.btn_attack[e].ProcTouch(i,t,s)&&this.btn_attack[e].bCheck()&&GmProtocol.gi().s_SevConfirm("巅峰之战进攻"+e);return!1}}sa.Open=function(i){var t=XStat.gi().FindStat(XStat.GS_PEAKFIGHT);null==t&&(t=XStat.gi().PushStat(XStat.GS_PEAKFIGHT)),t._open(i)};class ea extends s{constructor(i){var t;for(super(),this.sAnswers=new Array(4),this.iW=750,this.iH=540,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_sel=new Array(4),t=0;t<4;t++)this.btn_sel[t]=new Eh(gn.xani_nui3),this.btn_sel[t].InitButton("分类标签按钮");this.btn_exit=new Eh(gn.xani_nui3),this.btn_exit.InitButton("分类标签按钮"),this.btn_exit.sName="退出答题",this.btn_exit.Move(this.iX+this.iW-40-190,this.iY+this.iH-40-40,190,40),this.btn_get=new Eh(gn.xani_ngoods),this.btn_get.InitButton("礼包1"),this.bWin=!1,this._bigletter=["A.","B.","C.","D."]}Draw(){var i,t,s;if(E.new_bigframe(this.iX,this.iY,this.iW,this.iH),t=this.iX+30,s=this.iY+30,E.new_framein(t,s,200,200),c.gi().DrawTextEx(t+20,s+20,"答对题数",4278206039,30,101,1,1,0,0,0),c.gi().DrawTextEx(t+50,s+60,this.iRightCount+"/"+this.iReplyCount,4278206039,30,101,1,1,0,0,0),t+=220,E.new_framein(t,s,this.iW-200-30-30-20,200),this.bWin||(c.gi().DrawTextEx(t+20,s+20,"题目"+e.sBigNum[this.iReplyCount+1],4278206039,30,101,1,1,0,0,0),Y.gi().FormatEx("#c003e57"+this.sQuestion,this.iW-200-30-30-20,30,0,0,35),Y.gi().Draw(t+20,s+60),(i=parseInt((this.iTm-gn.iNowMillis)/1e3))<0&&(i=0),c.gi().DrawTextEx(this.iX+this.iW-30-20,s+200-20,"倒计时："+i+"s",4278206039,30,101,1,1,0,-3,-3)),t=this.iX+30,s+=220,E.new_framein(t,s,200,this.iH-200-30-30-20),c.gi().DrawTextEx(t+20,s+20,"活动奖励",4278206039,30,101,1,1,0,0,0),this.bWin&&(this.btn_get.Move(t+100-40,s+100,80,80),this.btn_get.Draw()),t+=220,E.new_framein(t,s,this.iW-200-30-30-20,this.iH-200-30-30-20-40-40),!this.bWin)for(i=0;i<this.iACount;i++)this.btn_sel[i].Move(t+30+i%2*220,s+30+80*parseInt(i/2),190,40),this.btn_sel[i].sName=this._bigletter[i]+this.sAnswers[i],this.btn_sel[i].Draw();this.btn_exit.Draw(),ei.end(ei.CONFIRM_EXITAQ)&&ei.bConfirm&&(Mh.gi().s_AfternoooQuestion(3,0,0),ln.gi().PopStat(1))}ProcTouch(i,t,s){var e;for(e=0;e<this.iACount;e++)this.btn_sel[e].ProcTouch(i,t,s)&&this.btn_sel[e].bCheck()&&Mh.gi().s_AfternoooQuestion(1,this.iCheck,e);return this.btn_exit.ProcTouch(i,t,s)&&this.btn_exit.bCheck()&&(this.bWin?ei.start(ei.CONFIRM_EXITAQ,"你已答满15道题，可以点击左侧图标领取额外奖励，退出后奖励无法领取"):ei.start(ei.CONFIRM_EXITAQ,"离开活动界面后计算为活动失败，是否确定退出活动？")),this.bWin&&this.btn_get.ProcTouch(i,t,s)&&this.btn_get.ProcTouch(i,t,s)&&(Mh.gi().s_AfternoooQuestion(2,0,0),ln.gi().PopStat(1)),!1}}ea.Open=function(i){var t,s=i.GetNextInt();if(1==s){var e;for(ln.gi().iXStat!=ln.GS_AQDOING&&ln.gi().PushStat(ln.GS_AQDOING),(e=ln.gi().LastStat(0)).sQuestion=i.GetNextString(),e.iACount=i.GetNextInt(),t=0;t<e.iACount;t++)e.sAnswers[t]=i.GetNextString();e.iCheck=i.GetNextInt(),e.iReplyCount=i.GetNextInt(),e.iRightCount=i.GetNextInt(),e.iTm=gn.iNowMillis+2e4}(2==s&&ln.gi().iXStat==ln.GS_AQDOING&&ln.gi().PopStat(1),3==s)&&(ln.gi().iXStat!=ln.GS_AQDOING&&ln.gi().PushStat(ln.GS_AQDOING),(e=ln.gi().LastStat(0)).iReplyCount=i.GetNextInt(),e.iRightCount=i.GetNextInt(),e.bWin=!0)};class ha extends s{constructor(i){var t;for(super(),this.pani=i,this.pm3f=i.pm3f,this.iW=950,this.iH=475,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new D(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_goods=new Array(8),this.gmake=new Array(8),this.igsub=new Array(8),t=0;t<8;t++)this.btn_goods[t]=new D(gn.xani_button),this.btn_goods[t].InitButton("物品格"),this.btn_goods[t].bSingleButton=!0,this.gmake[t]=null,this.igsub[t]=1;this.btn_goods[0].Move(this.iX+35+80,this.iY+120,80,80),this.btn_goods[1].Move(this.iX+35+80+140,this.iY+120,80,80),this.btn_make=new Eh(gn.xani_nui2),this.btn_make.InitButton("按钮1_110"),this.btn_make.sName="制造"}Draw(){var i,t,s;for(E.new_baseframe4(this.iX,this.iY,this.iW,this.iH,"镶","嵌","合","成"),this.btn_close.Draw(),gn.xani_nui3.DrawAnima(this.iX+230,this.iY+200,"炼丹炉背景",0),t=this.iX+this.iW-30-430-40,s=this.iY+30,E.new_framein(t,s,470,this.iH-60),c.gi().DrawTextEx(t+20,s+20,"双击选择装备或宝石：",4278206039,30,101,1,1,0,0,0),this.iGx=t+20,this.iGy=s+20+30,qi.new_DrawGoods(this.iGx,this.iGy,ht.gi().goods[2],this.gmake,this.igsub),null!=this.lockgoods&&qi.new_DrawRect(this.iGx,this.iGy,ht.gi().goods[2],this.lockgoods,0),i=0;i<2;i++)gn.xani_nui3.DrawAnima(this.btn_goods[i].iX,this.btn_goods[i].iY,"物品格子",0),null!=this.gmake[i]&&qi.new_DrawOneGoods_ext(this.btn_goods[i].iX,this.btn_goods[i].iY,this.gmake[i],1);s=this.iY+this.iH-30-160,E.new_framein(this.iX+30,s,400,160);var e="#c003e57"+this.Check();Y.gi().FormatEx(e,360,25,0,0,30),Y.gi().Draw(this.iX+30+20,s+20),this.btn_make.Move(this.iX+30+400-20-110,s+160-20-52,110,52),1==this.iCanMake?(this.btn_make.sName="合成",this.btn_make.Draw()):2==this.iCanMake?(this.btn_make.sName="镶嵌",this.btn_make.Draw()):3==this.iCanMake&&(this.btn_make.sName="使用",this.btn_make.Draw()),qi.bShowDetail()&&qi.new_DrawDetail(null,-1,-1,0)}Check(){var i,t,s,e;if(this.iCanMake=0,null==this.gmake[0])return"请先放入镶嵌的装备或合成的宝石";if(-1==(s=gn.de_goods.intValue(this.gmake[0].iTid,-1,16)))return null==this.gmake[1]?"请先放入同类型同等级的宝石进行合成":this.gmake[1].iTid!=this.gmake[0].iTid?"宝石类型不同，不能合成":this.gmake[1].iAtts[0]!=this.gmake[0].iAtts[0]?"宝石等级不同，不能合成":(this.iCanMake=1,"#c00ff00宝石齐备，可以合成");if(null!=this.gmake[1]&&229==this.gmake[1].iTid)return this.iCanMake=3,"碎石锤可以除去装备上的宝石";switch(s){case 0:if(null==this.gmake[1])return"放入红宝石或月光石进行镶嵌";if(101!=this.gmake[1].iTid&&102!=this.gmake[1].iTid)return"只能镶嵌红宝石或月光石";break;case 1:if(null==this.gmake[1])return"放入碧玺石进行镶嵌";if(105!=this.gmake[1].iTid)return"只能镶嵌碧玺石";break;case 2:if(null==this.gmake[1])return"放入红宝石进行镶嵌";if(101!=this.gmake[1].iTid)return"只能镶嵌红宝石";break;case 3:if(null==this.gmake[1])return"放入紫鸦石或月光石进行镶嵌";if(103!=this.gmake[1].iTid&&102!=this.gmake[1].iTid)return"只能镶嵌紫鸦石或月光石";break;case 4:if(null==this.gmake[1])return"放入紫鸦石或墨晶石进行镶嵌";if(103!=this.gmake[1].iTid&&104!=this.gmake[1].iTid)return"只能镶嵌紫鸦石或墨晶石";break;case 5:if(null==this.gmake[1])return"放入墨晶石或碧玺石进行镶嵌";if(104!=this.gmake[1].iTid&&105!=this.gmake[1].iTid)return"只能镶嵌墨晶石或碧玺石";break;default:return"数据错误3"}return e=1,0!=(i=Math.floor(this.gmake[0].iAtts[2]/1e4))&&(e+=i%1e3),0!=(t=this.gmake[0].iAtts[2]%1e4)&&(e+=t%1e3),this.gmake[1].iAtts[0]!=e?"必须镶嵌"+e+"级宝石":0!=i&&Math.floor(i/1e3)==this.gmake[1].iTid-101?(this.iCanMake=2,"#c00ff00宝石齐备，可以镶嵌"):0!=t&&Math.floor(t/1e3)==this.gmake[1].iTid-101?(this.iCanMake=2,"#c00ff00宝石齐备，可以镶嵌"):0!=i&&0!=t?"已经镶嵌两种不同类型宝石":(this.iCanMake=2,"#c00ff00宝石齐备，可以镶嵌")}ProcTouch(i,t,s){for(e=0;e<2;e++)if(this.btn_goods[e].ProcTouch(i,t,s))return console.log("点击物品"),this.btn_goods[e].bCheck()&&(this.gmake[e]=null),!0;var e;if(this.iCanMake>0&&this.btn_make.ProcTouch(i,t,s)&&this.btn_make.bCheck()){var h=[0,0,0,0,0,0,0,0];for(e=0;e<8;e++)null!=this.gmake[e]&&(h[e]=this.gmake[e].iGid,gn.de_goods.intValue(this.gmake[e].iTid,0,28)>1?(this.gmake[e].iCount--,this.gmake[e].iCount<=0&&(this.gmake[e].iGid=-1)):this.gmake[e].iGid=-1,this.gmake[e]=null);Mh.gi().s_UseSkill(5,h[0],h[1],h[2],h[3],h[4],h[5])}if(this.btn_close.ProcTouch(i,t,s))return this.btn_close.bCheck()&&ln.gi().PopStat(1),!0;(this.lockgoods=qi.new_LockGoods(t,s,this.iGx,this.iGy,ht.gi().goods[2],i),3==i&&null!=this.lockgoods&&qi.bCanProc())&&(-1!=gn.de_goods.intValue(this.lockgoods.iTid,0,16)?this.gmake[0]=this.lockgoods:(this.lockgoods.iTid>=101&&this.lockgoods.iTid<=105&&(null==this.gmake[0]?this.gmake[0]=this.lockgoods:null==this.gmake[1]&&this.gmake[0]!=this.lockgoods&&(this.gmake[1]=this.lockgoods)),229==this.lockgoods.iTid&&(this.gmake[1]=this.lockgoods)),this.lockgoods=null);return!1}}class aa extends s{constructor(i){var t;for(super(),this.pani=i,this.pm3f=i.pm3f,this.iW=950,this.iH=475,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new D(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_goods=new Array(8),this.gmake=new Array(8),this.igsub=new Array(8),t=0;t<8;t++)this.btn_goods[t]=new D(gn.xani_ui),this.btn_goods[t].InitButton("物品格"),this.gmake[t]=null,this.igsub[t]=1;this.btn_goods[0].Move(this.iX+35+80,this.iY+80,80,80),this.btn_goods[1].Move(this.iX+35+80+140,this.iY+80,80,80),this.btn_goods[2].Move(this.iX+35+80,this.iY+180,80,80),this.btn_goods[3].Move(this.iX+35+80+140,this.iY+180,80,80),this.btn_make=new Eh(gn.xani_nui2),this.btn_make.InitButton("按钮1_110"),this.btn_make.sName="强化",this.btn_make.Move(this.iX+270,this.iY+this.iH-40-40,70,40)}Draw(){var i,t,s;for(E.new_baseframe2(this.iX,this.iY,this.iW,this.iH,"强","化"),this.btn_close.Draw(),gn.xani_nui3.DrawAnima(this.iX+230,this.iY+200,"炼丹炉背景",0),t=this.iX+this.iW-30-430-40,s=this.iY+30,E.new_framein(t,s,470,this.iH-60),c.gi().DrawTextEx(t+20,s+20,"双击选择要强化的装备：",4278206039,30,101,1,1,0,0,0),this.iGx=t+20,this.iGy=s+20+30,qi.new_DrawGoods(this.iGx,this.iGy,ht.gi().goods[2],this.gmake,this.igsub),null!=this.lockgoods&&qi.new_DrawRect(this.iGx,this.iGy,ht.gi().goods[2],this.lockgoods,0),null!=this.gmake[1]&&(this.igsub[1]!=this.iNeed&&(this.igsub[1]=this.iNeed),this.igsub[1]>this.gmake[1].iCount&&(this.igsub[1]=this.gmake[1].iCount)),i=0;i<4;i++)gn.xani_nui3.DrawAnima(this.btn_goods[i].iX,this.btn_goods[i].iY,"物品格子",0),null!=this.gmake[i]&&qi.new_DrawOneGoods_ext(this.btn_goods[i].iX,this.btn_goods[i].iY,this.gmake[i],this.igsub[i]);s=this.iY+this.iH-30-160,E.new_framein(this.iX+30,s,400,160);var e="#c003e57"+this.Check();Y.gi().FormatEx(e,360,25,0,0,30),Y.gi().Draw(this.iX+30+20,s+20),this.bCanMake&&(this.btn_make.Move(this.iX+30+400-20-110,s+160-20-52,110,52),this.btn_make.Draw()),qi.bShowDetail()&&qi.new_DrawDetail(null,-1,-1,0),ei.end(ei.CONFIRM_IMPROVEEQUIP)&&ei.bConfirm&&this.ie()}Check(){var i,t;this.iNeed=1;var s="#c00ff00材料齐备，可以强化";return this.bCanMake=!1,null==this.gmake[0]?"请先放入需要强化的装备":-1==gn.de_goods.intValue(this.gmake[0].iTid,-1,16)?"数据异常6":(t=this.gmake[0].iAtts[3]/1e4)>=9?"装备已经强化到顶层":(this.iNeed=gn.de_goods.intValue(this.gmake[0].iTid,0,9)/10+t+1,null==this.gmake[1]?"请放入强化符"+this.iNeed+"张":this.gmake[1].iCount<this.iNeed?"强化符数量不足，需要"+this.iNeed+"张":(i=115-15*t,null!=this.gmake[3]&&(i+=20),i>100&&(i=100),s+="#e强化成功率"+i+"%",null==this.gmake[3]&&i<100&&(s+="#e#cff0000幸运符提高强化成功率"),null==this.gmake[2]&&i<100&&(s+="#e#cff0000替身木偶使装备不损毁"),this.bCanMake=!0,s))}ie(){var i,t=[0,0,0,0,0,0,0,0];for(i=0;i<8;i++)null!=this.gmake[i]&&(t[i]=this.gmake[i].iGid,this.gmake[i].iGid=-1,this.gmake[i]=null);Mh.gi().s_UseSkill(6,t[0],t[1],t[2],t[3],t[4],t[5])}ProcTouch(i,t,s){var e,h,a;if(this.bCanMake&&this.btn_make.ProcTouch(i,t,s)&&this.btn_make.bCheck()&&(null==this.gmake[2]?ei.start(ei.CONFIRM_IMPROVEEQUIP,"#cff0000没有放入替身木偶，如果强化失败，装备会消失，是否确定继续强化？"):this.ie()),this.btn_close.ProcTouch(i,t,s))return this.btn_close.bCheck()&&ln.gi().PopStat(1),!0;if(this.lockgoods=qi.new_LockGoods(t,s,this.iGx,this.iGy,ht.gi().goods[2],i),3==i&&null!=this.lockgoods&&qi.bCanProc()){if(-1!=gn.de_goods.intValue(this.lockgoods.iTid,0,16)){for(this.gmake[0]=this.lockgoods,h=gn.de_goods.intValue(this.gmake[0].iTid,0,9)/10+this.gmake[0].iAtts[3]/1e4+1,a=0;a<20;a++)if(ht.gi().goods[2][a].iGid>0&&107==ht.gi().goods[2][a].iTid&&ht.gi().goods[2][a].iCount>=h){this.gmake[1]=ht.gi().goods[2][a];break}for(a=0;a<20;a++)if(ht.gi().goods[2][a].iGid>0&&106==ht.gi().goods[2][a].iTid){this.gmake[2]=ht.gi().goods[2][a];break}for(a=0;a<20;a++)if(ht.gi().goods[2][a].iGid>0&&108==ht.gi().goods[2][a].iTid){this.gmake[3]=ht.gi().goods[2][a];break}}else 107==this.lockgoods.iTid&&(this.gmake[1]=this.lockgoods),106==this.lockgoods.iTid&&(this.gmake[2]=this.lockgoods),108==this.lockgoods.iTid&&(this.gmake[3]=this.lockgoods);this.lockgoods=null}for(e=0;e<4;e++)this.btn_goods[e].ProcTouch(i,t,s)&&this.btn_goods[e].bCheck()&&(this.gmake[e]=null);return!1}}class na extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=450,this.iH=220,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.in_name=new pi(gn.xani_ui),this.in_name.Move(this.iX+40+80+20,this.iY+40,160,50),this.in_name.sDetail="",this.in_name.iTextSize=30,this.in_name.iLength=12,this.in_name.iTextColor=4279324257,this.in_id=new pi(gn.xani_ui),this.in_id.Move(this.iX+40+80+20,this.iY+40+50+40,160,50),this.in_id.sDetail="",this.in_id.bNumber=!0,this.in_id.iTextSize=30,this.in_id.iMaxNumber=99999999,this.in_id.iTextColor=4279324257,this.btn_name=new D(gn.xani_button),this.btn_name.InitButton("1号按钮90_60"),this.btn_name.sName="查找",this.btn_name.Move(this.iX+40+80+20+160+20,this.iY+35,90,60),this.btn_id=new D(gn.xani_button),this.btn_id.InitButton("1号按钮90_60"),this.btn_id.sName="查找",this.btn_id.Move(this.iX+40+80+20+160+20,this.iY+40+50+40-5,90,60)}Draw(){E.frame_type4("7号框52_52",this.iX,this.iY,this.iW,this.iH,52,52),c.gi().DrawTextEx(this.iX+40,this.iY+40+25,"根据名字",4279324257,20,101,1,1,0,0,-2),E.frame_type4("8号框20_20",this.in_name.iX,this.in_name.iY,this.in_name.iW,50,20,20),this.in_name.DrawText(),this.btn_name.Draw(),c.gi().DrawTextEx(this.iX+40,this.iY+40+50+40+25,"根据号码",4279324257,20,101,1,1,0,0,-2),E.frame_type4("8号框20_20",this.in_id.iX,this.in_id.iY,this.in_id.iW,50,20,20),this.in_id.DrawText(),this.btn_id.Draw(),this.in_name.onscr(),this.in_id.onscr()}ProcTouch(i,t,s){return this.in_name.ProcTouch(i,t,s),this.in_id.ProcTouch(i,t,s),this.btn_name.ProcTouch(i,t,s)&&this.btn_name.bCheck()&&(this.in_name.sDetail.length<=0?L.easymsg.AddMessage("请先输入玩家名字"):Mh.gi().s_WatchOn(4,0,0,this.in_name.sDetail)),this.btn_id.ProcTouch(i,t,s)&&this.btn_id.bCheck()&&(this.in_id.sDetail.length<=0?L.easymsg.AddMessage("请先输入号码"):Mh.gi().s_WatchOn(0,parseInt(this.in_id.sDetail),0,"")),3!=i||bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||ln.gi().PopStat(1),!1}}class oa extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=530,this.iH=340,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.goods=new Li,this.goods.iGid=-1,this.pet=new Hi,this.pet.iPid=-1,this.btn_send=new Eh(gn.xani_button),this.btn_send.InitButton("1号按钮90_60"),this.btn_send.sName="发送",this.btn_friend=new Eh(gn.xani_button),this.btn_friend.InitButton("1号按钮90_60"),this.btn_friend.sName="好友",this.bInited=!1,this.iRankCount=0,this.sRankDetail=new Array(10),this.btn_close=new Eh(gn.xani_button),this.btn_close.InitButton("关闭按钮")}Draw_Pet(){var i,t,s,a,n;for(this.iW=915,this.iH=610,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,E.new_bigframe(this.iX,this.iY,this.iW,this.iH),t=this.iX+28,s=this.iY+28,a=406,n=553,E.new_framein(t,s,a,n),t=t+a+15,a=440,n=553,E.new_framein(t,s,a,n),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_close.Draw(),gn.xani_nui2.DrawAnima(this.iX+28+203-130,this.iY+50,"宠物背景",0),G.DrawAura(0,this.iX+28+203,this.iY+240,null,0),this.pet.aa_body.Draw(this.iX+28+203,this.iY+240),this.pet.aa_body.NextFrame(),et.wordframe(this.iX+28+203-100,this.iY+50,200),c.gi().DrawText_2(this.iX+28+203,this.iY+50+16,this.pet.sName,4294967295,22,101,1,1,0,-2,-2,3,4278190080),this.pet.CalcPetScore(),c.gi().DrawText_2(this.iX+28+203,this.iY+50+16+50,"评分:"+this.pet.iScore,4294967295,26,101,1,1,0,-2,-2,3,4278190080),i=0;i<5;i++)i<this.pet.iStar?gn.xani_nui2.DrawAnima(this.iX+54,this.iY+60+40*i,"宠物进阶星星",1):gn.xani_nui2.DrawAnima(this.iX+54,this.iY+60+40*i,"宠物进阶星星",0);gn.xani_nui2.DrawAnima(this.iX+380,this.iY+128,"宠物类型红印",3&this.pet.iBaobao),c.gi().DrawText_2(this.iX+130,this.iY+239,this.pet.iLev+"级",4294967295,20,101,1,1,0,-2,-2,3,4278190080),c.gi().DrawText_2(this.iX+350,this.iY+239,"仙露仙桃："+this.pet.iFlag%100,4294967295,20,101,1,1,0,-2,-2,3,4278190080);var o,r,l=this.iX+45,b=this.iY+285;for(i=0;i<12;i++)o=l+i%4*97,r=b+97*parseInt(i/4),gn.xani_nui2.DrawAnima(o,r,"技能框",0),i<this.pet.iSkillBlock&&this.pet.jn[i]>0&&gn.xani_nicon.DrawAnima_aa(o,r,gn.de_skill.strValue(this.pet.jn[i],0,5),0),i>=this.pet.iSkillBlock&&gn.xani_nui2.DrawAnima(o,r,"技能框",1);for(i=0;i<12;i++)o=l+i%4*97,r=b+97*parseInt(i/4),null==oa.btn_skilllist[i]&&(oa.btn_skilllist[i]=new Eh(gn.xani_nui2),oa.btn_skilllist[i].bSingleButton=!0),oa.btn_skilllist[i].Move(o,r,92,92),oa.btn_skilllist[i].bMouseDown&&this.pet.jn[i]>0&&Yi.Skill_Detail(this.pet.jn[i],o,r,-1);l=this.iX+470+10,b=this.iY+49,gn.xani_nui2.DrawAnima(l,b,"提示1",0),c.gi().DrawText_2(l+33.5,b+16,"气血",4294967295,20,101,1,1,0,-2,-2,3,4278190080),gn.xani_nui2.DrawAnima(l,b+38,"提示1",0),c.gi().DrawText_2(l+33.5,b+38+16,"魔法",4294967295,20,101,1,1,0,-2,-2,3,4278190080),gn.xani_nui2.DrawAnima(l,b+76,"提示1",0),c.gi().DrawText_2(l+33.5,b+76+16,"经验",4294967295,20,101,1,1,0,-2,-2,3,4278190080);var _=67;gn.xani_nui2.DrawAnima(l+_,b,"宠物大血条",0),gn.xani_nui2.DrawAnima(l+_,b+36,"宠物大血条",0),gn.xani_nui2.DrawAnima(l+_,b+72,"宠物大血条",0),c.gi().SetViewClip(l,b,l+_+311*this.pet.iHp/this.pet.iMaxHp,b+480),gn.xani_nui2.DrawAnima(l+_+2,b+3,"宠物大血条",1),c.gi().NoClip(),c.gi().SetViewClip(l,b,l+_+311*this.pet.iMp/this.pet.iMaxMp,b+480),gn.xani_nui2.DrawAnima(l+_+2,b+36+3,"宠物大血条",2),c.gi().NoClip(),c.gi().SetViewClip(l,b,l+_+311*this.pet.iExp/(e.iUpgradeExp[this.pet.iLev]/3),b+480),gn.xani_nui2.DrawAnima(l+_+2,b+72+3,"宠物大血条",3),c.gi().NoClip(),c.gi().DrawTextEx(l+_+155.5,b+15,this.pet.iHp+"/"+this.pet.iMaxHp,4294967295,20,101,1,1,0,-2,-2),c.gi().DrawTextEx(l+_+155.5,b+40+13,this.pet.iMp+"/"+this.pet.iMaxMp,4294967295,20,101,1,1,0,-2,-2),c.gi().DrawTextEx(l+_+155.5,b+80+12,this.pet.iExp+"/"+parseInt(e.iUpgradeExp[this.pet.iLev]/3),4294967295,20,101,1,1,0,-2,-2),l=this.iX+470+10,b=this.iY+176,b+=105,E.ui3_Text1_(l,b-60-45,67,100,"体质",""+this.pet.tz),E.ui3_Text1_(l,b-20-45-2,67,100,"法力",""+this.pet.fl),E.ui3_Text1_(l,b+20-45-4,67,100,"力量",""+this.pet.ll),E.ui3_Text1_(l,b+60-45-6,67,100,"耐力",""+this.pet.nl),E.ui3_Text1_(l,b+100-45-8,67,100,"敏捷",""+this.pet.mj),E.ui3_Text1_(l+220,b-60-45,67,100,"灵力",""+this.pet.iSpirit),E.ui3_Text1_(l+220,b-20-45-2,67,100,"伤害",""+this.pet.iAttack),E.ui3_Text1_(l+220,b+20-45-4,67,100,"防御",""+this.pet.iDefence),E.ui3_Text1_(l+220,b+60-45-6,67,100,"速度",""+this.pet.iSpeed),E.ui3_Text1_(l+220,b+100-45-8,67,100,"潜能",""+this.pet.nut),l=this.iX+470+10,b=this.iY+378,E.ui3_Text1_4word(l,b,110,100,"体质资质",""+this.pet.zz[0]),E.ui3_Text1_4word(l,b+40-2,110,100,"法力资质",""+this.pet.zz[1]),E.ui3_Text1_4word(l,b+80-4,110,100,"力量资质",""+this.pet.zz[2]),E.ui3_Text1_4word(l,b+120-6,110,100,"耐力资质",""+this.pet.zz[3]),E.ui3_Text1_4word(l,b+160-8,110,100,"敏捷资质",""+this.pet.zz[4]),E.ui3_Text1_(l+220,b,67,100,"成长",""+Bi.swapcz(this.pet.cz)),this.pet.iLife>3e4?E.ui3_Text1_(l+220,b+40-2,67,100,"寿命","永生"):E.ui3_Text1_(l+220,b+40-2,67,100,"寿命",""+this.pet.iLife)}Draw_Role(){var i;if(this.iW=500,this.iH=335,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,E.frame_type4("7号框52_52",this.iX,this.iY,this.iW,this.iH,52,52),gn.xani_head.DrawAnima(this.iX+20+350+20,this.iY+20,"新头像"+this.r_head,0),this.btn_send.Move(this.iX+20+350+20-5,this.iY+20+60+20+50,90,60),this.btn_send.Draw(),this.btn_friend.Move(this.iX+20+350+20-5,this.iY+20+60+20+60+20+70,90,60),this.btn_friend.Draw(),i=260,E.frame_type4("11号框20_20",this.iX+20,this.iY+20,350,295,20,20),E.ui3_Text1(this.iX+30,this.iY+30,70,i,"名字",this.r_name),E.ui3_Text1(this.iX+30,this.iY+30+35,70,i,"号码",""+this.r_rid),E.ui3_Text1(this.iX+30,this.iY+30+70,70,i,"等级",""+this.r_lev),E.ui3_Text1(this.iX+30,this.iY+30+105,70,i,"门派",e.sSchools[this.r_school]),this.r_title.length<=0?E.ui3_Text1(this.iX+30,this.iY+30+140,70,i,"称谓","无"):E.ui3_Text1(this.iX+30,this.iY+30+140,70,i,"称谓",this.r_title),E.ui3_Text1(this.iX+30,this.iY+30+175,70,i,"帮派",this.r_gov),0==this.r_relation)E.ui3_Text1(this.iX+30,this.iY+30+210,70,i,"关系","陌生人");else{var t="";0==(2&this.r_relation)&&0==(8&this.r_relation)||(t+="徒弟"),0!=(4&this.r_relation)&&(t+="师傅"),t.length<=0&&(t="普通朋友"),E.ui3_Text1(this.iX+30,this.iY+30+210,70,i,"关系",t)}E.ui3_Text1(this.iX+30,this.iY+30+245,70,i,"友好度",""+this.r_amity)}Draw_Goods(){this.iX=(h.SCRW+270)/2,this.iY=h.SCRH/2,this.iW=270,this.iH=270,qi.new_DrawDetail(this.goods,this.iX,this.iY,0),this.iX-=270,this.iY-=135}Draw(){if(this.bInited)switch(this.iType){case 0:case 4:this.Draw_Role();break;case 1:this.Draw_Goods();break;case 2:this.Draw_Pet();break;case 10:case 11:case 12:case 13:this.Draw_Rank()}}Draw_Rank(){var i;for(this.iW=300,this.iH=350,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,E.Frame2_MD(this.iX,this.iY,this.iW,this.iH),10==this.iType?c.gi().DrawTextEx(this.iX+this.iW/2,this.iY+30,"~~~实力排行榜~~~",4278190080,30,101,1,1,0,-2,-2):11==this.iType?c.gi().DrawTextEx(this.iX+this.iW/2,this.iY+30,"~~~财富排行榜~~~",4278190080,30,101,1,1,0,-2,-2):12==this.iType?c.gi().DrawTextEx(this.iX+this.iW/2,this.iY+30,"~~~帮派排行榜~~~",4278190080,30,101,1,1,0,-2,-2):13==this.iType&&c.gi().DrawTextEx(this.iX+this.iW/2,this.iY+30,this.sRankTitle,4278190080,30,101,1,1,0,-2,-2),c.gi().DrawTextEx(this.iX+50,this.iY+30+40,"排名",4278190080,20,101,1,1,0,-2,-2),c.gi().DrawTextEx(this.iX+200,this.iY+30+40,"名称",4278190080,20,101,1,1,0,-2,-2),i=0;i<this.iRankCount;i++)i%2==0&&c.gi().FillRect_2D(this.iX+20,this.iY+30+40+30+25*i-13,this.iX+this.iW-20,this.iY+30+40+30+25*i+13,536870912),c.gi().DrawTextEx(this.iX+50,this.iY+30+40+30+25*i,""+(i+1),4278190080,20,101,1,1,0,-2,-2),c.gi().DrawTextEx(this.iX+200,this.iY+30+40+30+25*i,this.sRankDetail[i],4278190080,20,101,1,1,0,-2,-2)}ProcTouch(i,t,s){var e;if(this.btn_close.ProcTouch(i,t,s)&&this.btn_close.bCheck())return ln.gi().PopStat(1),!0;if(3==i&&!bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH))return ln.gi().PopStat(1),!0;switch(this.iType){case 0:case 4:if(this.btn_send.ProcTouch(i,t,s))return this.btn_send.bCheck()&&(ln.gi().PopStat(1),dt.OpenChat(this.r_rid,this.r_name,this.r_head)),!0;if(this.btn_friend.ProcTouch(i,t,s))return this.btn_friend.bCheck()&&(Mh.gi().s_FriendOperate(0,this.r_rid,0),ln.gi().PopStat(1)),!0;break;case 1:break;case 2:for(e=0;e<12;e++)null!=oa.btn_skilllist[e]&&oa.btn_skilllist[e].ProcTouch(i,t,s)}return!1}InitData(i){var t,s;if(this.iType=i.GetNextByte(),this.iId=i.GetNextInt(),this.iFlag=i.GetNextInt(),0==this.iType||4==this.iType)this.r_name=i.GetNextString(),this.r_rid=i.GetNextInt(),this.r_lev=i.GetNextInt(),this.r_school=i.GetNextByte(),this.r_head=i.GetNextByte(),this.r_gov=i.GetNextString(),this.r_relation=i.GetNextByte(),this.r_amity=i.GetNextInt(),this.r_title=i.GetNextString();else if(1==this.iType){for(this.goods.iGid=i.GetNextInt(),this.goods.iTid=i.GetNextShort(),i.GetNextInt(),i.GetNextByte(),i.GetNextByte(),this.goods.iCount=i.GetNextByte(),t=0;t<8;t++)this.goods.iAtts[t]=i.GetNextInt();gn.xani_ngoods.InitAnimaWithName(gn.de_goods.strValue(this.goods.iTid,-1,10),this.goods.aa)}else if(2==this.iType){for(this.pet.iPid=i.GetNextInt(),this.pet.iTid=i.GetNextShort(),this.pet.sName=i.GetNextString()+"("+gn.de_pet.strValue(this.pet.iTid,0,1)+")",this.pet.iLev=i.GetNextShort(),this.pet.iExp=i.GetNextInt(),this.pet.iHp=i.GetNextShort(),this.pet.iMp=i.GetNextShort(),this.pet.iLife=i.GetNextShort(),s=0;s<5;s++)this.pet.iBaseAtt[s]=i.GetNextShort();for(s=0;s<5;s++)this.pet.zz[s]=i.GetNextShort();for(this.pet.cz=i.GetNextShort(),s=0;s<8;s++)this.pet.jn[s]=i.GetNextShort();this.pet.iAddAtt=i.GetNextByte(),this.pet.iBaobao=i.GetNextByte(),this.pet.iFlag=i.GetNextShort(),this.pet.jn[8]=i.GetNextShort(),this.pet.jn[9]=i.GetNextShort(),this.pet.jn[10]=i.GetNextShort(),this.pet.jn[11]=i.GetNextShort(),0==(2&this.pet.iBaobao)?gn.xani_pets[this.pet.iTid].InitAnimaWithName("站立_右下",this.pet.aa_body):gn.xani_pets[this.pet.iTid].InitAnimaWithName("变异_站立_右下",this.pet.aa_body),Bi.CalcFightAtt(this.pet)}else if(10==this.iType)for(this.iRankCount=i.GetNextInt(),s=0;s<this.iRankCount;s++)this.sRankDetail[s]=i.GetNextString();else if(11==this.iType)for(this.iRankCount=i.GetNextInt(),s=0;s<this.iRankCount;s++)this.sRankDetail[s]=i.GetNextString();else if(12==this.iType)for(this.iRankCount=i.GetNextInt(),s=0;s<this.iRankCount;s++)this.sRankDetail[s]=i.GetNextString();else if(13==this.iType)for(this.sRankTitle=i.GetNextString(),this.iRankCount=i.GetNextInt(),s=0;s<this.iRankCount;s++)this.sRankDetail[s]=i.GetNextString();else ln.gi().PopStat(1);this.bInited=!0}}oa.btn_skilllist=new Array(12),oa.Init_Pet=function(i){ln.gi().PushStat(ln.GS_WATCHON);var t=ln.gi().LastStat(0);t.pet.copyfrom(i),t.pet.sName=i.sName+"("+gn.de_pet.strValue(i.iTid,0,1)+")",0==(2&t.pet.iBaobao)?gn.xani_pets[t.pet.iTid].InitAnimaWithName("站立_右下",t.pet.aa_body):gn.xani_pets[t.pet.iTid].InitAnimaWithName("变异_站立_右下",t.pet.aa_body),Bi.CalcFightAtt(t.pet),t.iType=2,t.bInited=!0};class ra extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=500,this.iH=350,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.in_money=new pi(gn.xani_ui),this.in_money.sDetail="100000",this.in_money.bNumber=!0,this.in_money.iTextSize=20,this.in_money.iMaxNumber=2e7,this.in_money.iTextColor=4279324257,this.btn_ok=new Eh(gn.xani_button),this.btn_ok.Move(this.iX+330,this.iY+60+50+10,150,60),this.btn_ok.InitButton("1号按钮150_60"),this.btn_ok.sName="确定挑战",this.btn_close=new Eh(gn.xani_button),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_close.InitButton("关闭按钮")}Draw(){var i;i=this.iY+15,E.frame_type4("7号框52_52",this.iX,this.iY,this.iW,this.iH,52,52),this.pm3f.DrawText_2(this.iX+this.iW/2,i,"发起挑战",4294896766,40,101,1,1,0,-2,0,2,4278261038),i+=60,this.pm3f.DrawText_2(this.iX+20,i,"挑战战队:"+this.sDName,4294896766,30,101,1,1,0,0,0,2,4278261038),i+=60,this.pm3f.DrawText_2(this.iX+20,i,"挑战金",4294896766,30,101,1,1,0,0,0,2,4278261038),this.in_money.Move(this.iX+120,i-10,155,50),E.frame_type4("8号框20_20",this.in_money.iX,this.in_money.iY,this.in_money.iW,50,20,20),this.in_money.DrawText(),this.in_money.onscr(),i+=60,Y.gi().Format("#c114e61说明：挑战金从战队资金支出，最低10万，扣除挑战金后，战队资金不能低于100万，否则挑战无效。#e如同一战队被多个战队挑战，挑战金高者配对成功#e配对成功后，系统将扣除10%挑战金#e挑战胜利，剩余90%挑战金归还挑战方；#e挑战失败，挑战金归被挑战方所有",this.iW-40,20),Y.gi().Draw(this.iX+20,i),this.btn_ok.Draw(),this.btn_close.Draw()}ProcTouch(i,t,s){var e;return this.btn_ok.ProcTouch(i,t,s)?(this.btn_ok.bCheck()&&this.in_money.sDetail.length>0&&((e=parseInt(this.in_money.sDetail))<1e5?L.easymsg.AddMessage("挑战金不能低于10万"):(Mh.gi().s_FTChallenge(1,e,this.iDFid),ln.gi().PopStat(1))),!0):this.btn_close.ProcTouch(i,t,s)?(this.btn_close.bCheck()&&ln.gi().PopStat(1),!0):(this.in_money.ProcTouch(i,t,s),!1)}}ra.Open=function(i,t){var s;(s=ln.gi().iXStat==ln.GS_FTCHALLENGE?ln.gi().oCurrentView:ln.gi().PushStat(ln.GS_FTCHALLENGE)).sDName=i,s.iDFid=t};class ca{constructor(){}}class la extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=600,this.iH=480,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_pageup=new Eh(gn.xani_button),this.btn_pageup.Move(this.iX+30,this.iY+this.iH-30-60,120,60),this.btn_pageup.InitButton("1号按钮120_60"),this.btn_pageup.sName="上一页",this.btn_pagedown=new Eh(gn.xani_button),this.btn_pagedown.Move(this.iX+this.iW-30-120,this.iY+this.iH-30-60,120,60),this.btn_pagedown.InitButton("1号按钮120_60"),this.btn_pagedown.sName="下一页",this.btn_fight=new Eh(gn.xani_button),this.btn_fight.Move(this.iX+this.iW/2-60,this.iY+this.iH-30-60,120,60),this.btn_fight.InitButton("1号按钮120_60"),this.btn_fight.sName="挑战",this.btn_close=new Eh(gn.xani_button),this.btn_close.Move(this.iX+this.iW-30,this.iY-20,60,60),this.btn_close.InitButton("关闭按钮")}Draw(){var i,t,s,e;for(E.frame_type4("10号框20_20",this.iX,this.iY,this.iW,this.iH,20,20),this.pm3f.DrawText_2(this.iX+this.iW/2,this.iY+15,"战队排行",4294896766,40,101,1,1,0,-2,0,2,4278261038),i=0;i<10;i++)t=this.iX+20+Math.floor(i/5)*this.iW/2,s=this.iY+60+i%5*65,this.iPoint==i?this.pm3f.FillRect_2D(t,s,t+this.iW/2-40,s+60,2147483776):i<this.iCount&&this.ranklist[i].fid==te.mft.iFTid?this.pm3f.FillRect_2D(t,s,t+this.iW/2-40,s+60,2147516416):E.frame_type4("2号框20_20",t,s,this.iW/2-40,60,20,20);for(e=this.iW/2-40,i=0;i<this.iCount;i++)t=this.iX+20+Math.floor(i/5)*this.iW/2,s=this.iY+60+i%5*65,this.pm3f.DrawText_2(t+15,s+30,""+this.ranklist[i].rank,4294952960,50,101,1,1,0,0,-2,2,4278190080),this.pm3f.DrawTextEx(t+e-10,s+5,"队名:"+this.ranklist[i].name,4294967295,20,101,1,1,0,-3,0),this.pm3f.DrawTextEx(t+e-10,s+5+30,"队长:"+this.ranklist[i].leader,4294967295,20,101,1,1,0,-3,0),this.ranklist[i].nowar>0&&c.gi().DrawTextEx(t+e/2-50,s+30-25,"免战",4294901760,50,101,1,1,30,t+e/2,s+30),this.ranklist[i].fid==la.iDFid&&c.gi().DrawTextEx(t+e/2-50,s+30-25,"挑战",4294901760,50,101,1,1,30,t+e/2,s+30);this.iNoWar>0?this.pm3f.DrawTextEx(this.btn_fight.iX,this.btn_fight.iY,"免战中",4294967295,20,101,1,1,0,0,0):2==la.iFTStat?(this.btn_fight.sName="挑战查询",this.btn_fight.Draw()):1==la.iFTStat&&(0==la.iDFid?(this.btn_fight.sName="发起挑战",this.iPoint>=0&&this.iPoint<this.iCount&&this.ranklist[this.iPoint].rank<this.iMyRank&&this.ranklist[this.iPoint].fid!=te.mft.iFTid&&0==this.ranklist[this.iPoint].nowar&&this.btn_fight.Draw()):(this.btn_fight.sName="取消挑战",this.btn_fight.Draw())),gn.sop("ftstat="+la.iFTStat),this.btn_pageup.Draw(),this.btn_pagedown.Draw(),this.btn_close.Draw()}ProcTouch(i,t,s){var e,h,a;if(2==la.iFTStat){if(this.btn_fight.ProcTouch(i,t,s))return this.btn_fight.bCheck()&&Mh.gi().s_FTChallenge(3,0,0),!0}else if(1==la.iFTStat)if(0==la.iDFid){if(this.iPoint>=0&&this.iPoint<this.iCount&&this.ranklist[this.iPoint].rank<this.iMyRank&&this.ranklist[this.iPoint].fid!=te.mft.iFTid&&0==this.ranklist[this.iPoint].nowar&&this.btn_fight.ProcTouch(i,t,s))return this.btn_fight.bCheck()&&ra.Open(this.ranklist[this.iPoint].name,this.ranklist[this.iPoint].fid),!0}else if(this.btn_fight.ProcTouch(i,t,s))return this.btn_fight.bCheck()&&Mh.gi().s_FTChallenge(2,0,0),!0;for(this.iPoint=-1,e=0;e<10;e++)h=this.iX+20+Math.floor(e/5)*this.iW/2,a=this.iY+60+e%5*65,bn.bInRect(t,s,h,a,this.iW/2-40,60)&&(this.iPoint=e);return this.btn_close.ProcTouch(i,t,s)?(this.btn_close.bCheck()&&ln.gi().PopStat(1),!0):this.btn_pageup.ProcTouch(i,t,s)?(this.btn_pageup.bCheck()&&(this.iPage>0?(this.iPage--,Mh.gi().s_FTChallenge(0,this.iPage,0)):L.easymsg.AddMessage("已到首页")),!0):this.btn_pagedown.ProcTouch(i,t,s)?(this.btn_pagedown.bCheck()&&(this.iPage++,Mh.gi().s_FTChallenge(0,this.iPage,0)),!0):!!bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)}}la.iFTStat,la.iDFid,la.iDMoney,la._2506c=function(i){la.iFTStat=i.GetNextInt(),la.iDFid=i.GetNextInt(),la.iDMoney=i.GetNextInt(),la.iDMoney<=0&&(la.iDFid=0)},la.Open=function(i){var t,s;if(ln.gi().iXStat==ln.GS_LOADING1&&ln.gi().PopStat(1),ln.gi().iXStat==ln.GS_FTRANK)s=ln.gi().oCurrentView;else for((s=ln.gi().PushStat(ln.GS_FTRANK)).ranklist=new Array(10),t=0;t<10;t++)s.ranklist[t]=new ca;for(s.iNoWar=i.GetNextInt(),s.iMyRank=i.GetNextInt(),s.iPage=i.GetNextInt(),s.iCount=i.GetNextInt(),t=0;t<s.iCount;t++)s.ranklist[t].rank=i.GetNextInt(),s.ranklist[t].fid=i.GetNextInt(),s.ranklist[t].name=i.GetNextString(),s.ranklist[t].leader=i.GetNextString(),s.ranklist[t].nowar=i.GetNextInt();s.iPoint=-1};class ba extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=430,this.iH=160,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.in_money=new pi(gn.xani_ui),this.in_money.sDetail="0",this.in_money.bNumber=!0,this.in_money.iTextSize=20,this.in_money.iMaxNumber=2e7,this.in_money.iTextColor=4279324257,this.btn_ok=new Eh(gn.xani_button),this.btn_ok.Move(this.iX+30+200+20,this.iY+30-5,150,60),this.btn_ok.InitButton("1号按钮150_60"),this.btn_ok.sName="存入",this.btn_close=new Eh(gn.xani_button),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_close.InitButton("关闭按钮")}Draw(){E.frame_type4("7号框52_52",this.iX,this.iY,this.iW,this.iH,52,52),this.in_money.Move(this.iX+30,this.iY+30,200,50),E.frame_type4("8号框20_20",this.in_money.iX,this.in_money.iY,this.in_money.iW,this.in_money.iH,20,20),this.in_money.DrawText(),this.in_money.onscr(),Y.gi().Format("#c000000说明：将你的铜币存入到战队资金，战队资金总额最高不能超过2000万",this.iW-40,20),Y.gi().Draw(this.iX+30,this.iY+30+50+10),this.btn_ok.Draw(),this.btn_close.Draw()}ProcTouch(i,t,s){var e;if(this.btn_ok.ProcTouch(i,t,s)){if(this.btn_ok.bCheck()&&this.in_money.sDetail.length>0){if((e=parseInt(this.in_money.sDetail))<=0)return L.easymsg.AddMessage("存入资金不能为0"),!0;if(e>xh.me.rbs.iMoney)return L.easymsg.AddMessage("存入资金不能超过上限"),!0;Mh.gi().s_FTOperate(1,e,0),ln.gi().PopStat(1)}return!0}return this.btn_close.ProcTouch(i,t,s)?(this.btn_close.bCheck()&&ln.gi().PopStat(1),!0):(this.in_money.ProcTouch(i,t,s),!1)}}ba.Open=function(i){var t;(t=ln.gi().iXStat==ln.GS_FTPUTIN?ln.gi().oCurrentView:ln.gi().PushStat(ln.GS_FTPUTIN)).in_money.iMaxNumber=2e7-i,t.in_money.iMaxNumber>xh.me.rbs.iMoney&&(t.in_money.iMaxNumber=xh.me.rbs.iMoney)};class _a extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=430,this.iH=160,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.in_money=new pi(gn.xani_ui),this.in_money.sDetail="0",this.in_money.bNumber=!0,this.in_money.iTextSize=20,this.in_money.iMaxNumber=2e7,this.in_money.iTextColor=4279324257,this.btn_ok=new Eh(gn.xani_button),this.btn_ok.Move(this.iX+30+200+20,this.iY+30-5,150,60),this.btn_ok.InitButton("1号按钮150_60"),this.btn_ok.sName="取出",this.btn_close=new Eh(gn.xani_button),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_close.InitButton("关闭按钮")}Draw(){E.frame_type4("7号框52_52",this.iX,this.iY,this.iW,this.iH,52,52),this.in_money.Move(this.iX+30,this.iY+30,200,50),E.frame_type4("8号框20_20",this.in_money.iX,this.in_money.iY,this.in_money.iW,this.in_money.iH,20,20),this.in_money.DrawText(),this.in_money.onscr(),Y.gi().Format("#c000000说明：从战队资金中取出铜币，战队剩余资金不能低于100万",this.iW-40,20),Y.gi().Draw(this.iX+30,this.iY+30+50+10),this.btn_ok.Draw(),this.btn_close.Draw()}ProcTouch(i,t,s){var e;if(this.btn_ok.ProcTouch(i,t,s)){if(this.btn_ok.bCheck()&&this.in_money.sDetail.length>0){if((e=parseInt(this.in_money.sDetail))<=0)return L.easymsg.AddMessage("取出资金不能为0"),!0;Mh.gi().s_FTOperate(2,e,0),ln.gi().PopStat(1)}return!0}return this.btn_close.ProcTouch(i,t,s)?(this.btn_close.bCheck()&&ln.gi().PopStat(1),!0):(this.in_money.ProcTouch(i,t,s),!1)}}_a.Open=function(i){(ln.gi().iXStat==ln.GS_FTGETOUT?ln.gi().oCurrentView:ln.gi().PushStat(ln.GS_FTGETOUT)).in_money.iMaxNumber=i-1e6};class fa extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=500,this.iH=415,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_open=new Array(5);for(var t=0;t<3;t++)this.btn_open[t]=new Eh(gn.xani_button),this.btn_open[t].InitButton("1号按钮90_60"),this.btn_open[t].sName="开启";this.btn_close=new Eh(gn.xani_button),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_close.InitButton("关闭按钮")}Draw(){var i,t,s;E.frame_type4("10号框20_20",this.iX,this.iY,this.iW,this.iH,20,20),this.pm3f.DrawText_2(this.iX+this.iW/2,this.iY+15,"战队秘境",4294896766,40,101,1,1,0,-2,0,2,4278261038),i=this.iX+20,t=this.iY+60,s=this.iW-40,E.frame_type4("2号框20_20",i,t,s,100,20,20),this.pm3f.DrawText_2(i+5,t+5,"封印之地1",4294896766,30,101,1,1,0,0,0,2,4278261038),this.pm3f.DrawTextEx(i+5,t+5+30,"进入条件：本战队成员且等级>=40",4294967295,20,101,1,1,0,0,0),this.pm3f.DrawTextEx(i+5,t+5+50,"消耗：100声望",4294967295,20,101,1,1,0,0,0),this.pm3f.DrawTextEx(i+5,t+5+70,"通关掉落：一级封印兽魂",4294967295,20,101,1,1,0,0,0),this.btn_open[0].Move(i+s-20-90,t+50-30,90,60),this.btn_open[0].Draw(),t+=105,E.frame_type4("2号框20_20",i,t,s,100,20,20),this.pm3f.DrawText_2(i+5,t+5,"封印之地2",4294896766,30,101,1,1,0,0,0,2,4278261038),this.pm3f.DrawTextEx(i+5,t+5+30,"进入条件：本战队成员且等级>=40",4294967295,20,101,1,1,0,0,0),this.pm3f.DrawTextEx(i+5,t+5+50,"消耗：200声望",4294967295,20,101,1,1,0,0,0),this.pm3f.DrawTextEx(i+5,t+5+70,"通关掉落：二级封印兽魂",4294967295,20,101,1,1,0,0,0),this.btn_open[1].Move(i+s-20-90,t+50-30,90,60),this.btn_open[1].Draw(),t+=105,E.frame_type4("2号框20_20",i,t,s,100,20,20),this.pm3f.DrawText_2(i+5,t+5,"封印之地3",4294896766,30,101,1,1,0,0,0,2,4278261038),this.pm3f.DrawTextEx(i+5,t+5+30,"进入条件：本战队成员且等级>=60",4294967295,20,101,1,1,0,0,0),this.pm3f.DrawTextEx(i+5,t+5+50,"消耗：400声望",4294967295,20,101,1,1,0,0,0),this.pm3f.DrawTextEx(i+5,t+5+70,"通关掉落：三级封印兽魂",4294967295,20,101,1,1,0,0,0),this.btn_open[2].Move(i+s-20-90,t+50-30,90,60),this.btn_open[2].Draw(),this.pm3f.DrawTextEx(i,this.iY+this.iH-40,"注：加入战队七天以上才能参与秘境",4279324257,20,101,1,1,0,0,0),this.btn_close.Draw(),ei.end(ei.CONFIRM_FTMJ1)&&ei.bConfirm&&(Mh.gi().s_FTOperate(7,1,0),ln.gi().PopStat(2)),ei.end(ei.CONFIRM_FTMJ2)&&ei.bConfirm&&(Mh.gi().s_FTOperate(7,2,0),ln.gi().PopStat(2)),ei.end(ei.CONFIRM_FTMJ3)&&ei.bConfirm&&(Mh.gi().s_FTOperate(7,3,0),ln.gi().PopStat(2))}ProcTouch(i,t,s){var e;for(e=0;e<3;e++)this.btn_open[e].ProcTouch(i,t,s)&&this.btn_open[e].bCheck()&&(0==te.mft.iFTJob?ei.start(ei.CONFIRM_FTMJ1+e,"战队秘境开启后只能持续一小时，未完成计算为失败，是否确定开启？"):L.easymsg.AddMessage("队长才能开启秘境"));return this.btn_close.ProcTouch(i,t,s)?(this.btn_close.bCheck()&&ln.gi().PopStat(1),!0):!!bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)}}fa.Open=function(){ln.gi().iXStat==ln.GS_FTMIJING?ln.gi().oCurrentView:ln.gi().PushStat(ln.GS_FTMIJING)};class ua extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=590,this.iH=420,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_putin=new Eh(gn.xani_button),this.btn_putin.Move(this.iX+30,this.iY+this.iH-30-60-10-60,150,60),this.btn_putin.InitButton("1号按钮150_60"),this.btn_putin.sName="存入资金",this.btn_getout=new Eh(gn.xani_button),this.btn_getout.Move(this.iX+30,this.iY+this.iH-30-60,150,60),this.btn_getout.InitButton("1号按钮150_60"),this.btn_getout.sName="提取资金",this.btn_nowar=new Eh(gn.xani_button),this.btn_nowar.Move(this.iX+this.iW/2-75,this.iY+this.iH-30-60-10-60,150,60),this.btn_nowar.InitButton("1号按钮150_60"),this.btn_nowar.sName="免战",this.btn_sw=new Eh(gn.xani_button),this.btn_sw.Move(this.iX+this.iW/2-75,this.iY+this.iH-30-60,150,60),this.btn_sw.InitButton("1号按钮150_60"),this.btn_sw.sName="领取声望",this.btn_secret=new Eh(gn.xani_button),this.btn_secret.Move(this.iX+this.iW-30-150,this.iY+this.iH-30-60-10-60,150,60),this.btn_secret.InitButton("1号按钮150_60"),this.btn_secret.sName="战队秘境",this.btn_dismiss=new Eh(gn.xani_button),this.btn_dismiss.Move(this.iX+this.iW-30-150,this.iY+this.iH-30-60,150,60),this.btn_dismiss.InitButton("1号按钮150_60"),0==te.mft.iFTJob?this.btn_dismiss.sName="解散战队":this.btn_dismiss.sName="退出战队",this.btn_close=new Eh(gn.xani_button),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_close.InitButton("关闭按钮")}Draw(){E.frame_type4("10号框20_20",this.iX,this.iY,this.iW,this.iH,20,20),E.ui3_Text1(this.iX+30,this.iY+40,80,160,"名称",this.sName),E.ui3_Text1(this.iX+30,this.iY+40+40,80,160,"队长",this.sLeader),E.ui3_Text1(this.iX+30,this.iY+40+80,80,160,"号码",""+this.iRid),E.ui3_Text1(this.iX+30,this.iY+40+120,80,160,"荣誉",""+this.iRy),E.ui3_Text1(this.iX+30,this.iY+40+160,80,160,"声望",""+this.iSw),this.iRank>=1e5?E.ui3_Text1(this.iX+30+250,this.iY+40,120,160,"战队排名","暂无"):E.ui3_Text1(this.iX+30+250,this.iY+40,120,160,"战队排名",""+this.iRank),E.ui3_Text1(this.iX+30+250,this.iY+40+40,120,160,"胜利场次",""+this.iWin),E.ui3_Text1(this.iX+30+250,this.iY+40+80,120,160,"失败场次",""+this.iLost),E.ui3_Text1(this.iX+30+250,this.iY+40+120,120,160,"放弃场次",""+this.iGiveup),E.ui3_Text1(this.iX+30+250,this.iY+40+160,120,160,"战队资金",""+this.iMoney),0==te.mft.iFTJob&&(this.btn_putin.Draw(),this.btn_getout.Draw(),0==this.iNoWar?this.btn_nowar.sName="免战：关":this.btn_nowar.sName="免战：开",this.btn_nowar.Draw(),this.iSwAdd>0&&(this.btn_sw.Draw(),ei.end(ei.CONFIRM_SWADD)&&ei.bConfirm&&(Mh.gi().s_FTOperate(4,this.iSwAdd,0),this.iSwAdd=0)),ei.end(ei.CONFIRM_NOWAR)&&ei.bConfirm&&(0==this.iNoWar?this.iNoWar=1:this.iNoWar=0,Mh.gi().s_FTOperate(3,this.iNoWar,0))),this.btn_secret.Draw(),this.btn_dismiss.Draw(),ei.end(ei.CONFIRM_FTDISMISS)&&ei.bConfirm&&(Mh.gi().s_FTOperate(5,te.mft.iFTJob,0),ln.gi().PopStat(1)),this.btn_close.Draw()}ProcTouch(i,t,s){if(0==te.mft.iFTJob){if(this.btn_putin.ProcTouch(i,t,s))return this.btn_putin.bCheck()&&(this.iMoney>=2e7?L.easymsg.AddMessage("战队资金已达2000万"):ba.Open(this.iMoney)),!0;if(this.btn_getout.ProcTouch(i,t,s))return this.btn_getout.bCheck()&&(this.iMoney<=1e6?L.easymsg.AddMessage("战队资金不能低于100万"):_a.Open(this.iMoney)),!0;if(this.btn_nowar.ProcTouch(i,t,s))return this.btn_nowar.bCheck()&&ei.start(ei.CONFIRM_NOWAR,"每天20:00:00~24:00:00之间可切换免战状态#e免战开启后，可免受其他战队的挑战(每天0点将扣除10万战队资金)#e是否确定切换免战状态？"),!0;if(this.iSwAdd>0&&this.btn_sw.ProcTouch(i,t,s))return this.btn_sw.bCheck()&&ei.start(ei.CONFIRM_SWADD,"每天18:00:00之前可领取当日战队声望奖励#e当前可领"+this.iSwAdd+"点战队声望，战队排名越靠前，每日可领取声望越多#e是否确定领取？"),!0}return this.btn_secret.ProcTouch(i,t,s)?(this.btn_secret.bCheck()&&ln.gi().PushStat(ln.GS_FTMIJING),!0):this.btn_dismiss.ProcTouch(i,t,s)?(this.btn_dismiss.bCheck()&&(0==te.mft.iFTJob?ei.start(ei.CONFIRM_FTDISMISS,"战队解散后，战队资金将消失#e是否确定解散战队？"):ei.start(ei.CONFIRM_FTDISMISS,"是否确定离开战队？")),!0):this.btn_close.ProcTouch(i,t,s)?(this.btn_close.bCheck()&&ln.gi().PopStat(1),!0):!!bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)}}ua.Open=function(i){var t;(t=ln.gi().iXStat==ln.GS_FTFRAME?ln.gi().oCurrentView:ln.gi().PushStat(ln.GS_FTFRAME)).sName=i.GetNextString(),t.iRank=i.GetNextInt(),t.iMoney=i.GetNextInt(),t.iWin=i.GetNextInt(),t.iLost=i.GetNextInt(),t.iGiveup=i.GetNextInt(),t.iSw=i.GetNextInt(),t.iSwAdd=i.GetNextInt(),t.iRy=i.GetNextInt(),t.iNoWar=i.GetNextInt(),t.sLeader=i.GetNextString(),t.iRid=i.GetNextInt()};class da{constructor(){}}class pa extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=560,this.iH=640,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_refuse=new Eh(gn.xani_button),this.btn_refuse.Move(this.iX+30,this.iY+this.iH-30-60,150,60),this.btn_refuse.InitButton("1号按钮150_60"),this.btn_refuse.sName="拒绝",this.btn_agree=new Eh(gn.xani_button),this.btn_agree.Move(this.iX+this.iW/2-75,this.iY+this.iH-30-60,150,60),this.btn_agree.InitButton("1号按钮150_60"),this.btn_agree.sName="同意",this.btn_watch=new Eh(gn.xani_button),this.btn_watch.Move(this.iX+this.iW-30-150,this.iY+this.iH-30-60,150,60),this.btn_watch.InitButton("1号按钮150_60"),this.btn_watch.sName="查看",this.btn_close=new Eh(gn.xani_button),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_close.InitButton("关闭按钮"),this.ui_mlist=new Oi(0,4,500,450),this.ui_mlist.SetTitle(0,"序号",80,!1),this.ui_mlist.SetTitle(1,"名字",200,!1),this.ui_mlist.SetTitle(2,"等级",80,!1),this.ui_mlist.SetTitle(3,"是否在线",140,!1)}Draw(){var i;for(E.frame_type4("10号框20_20",this.iX,this.iY,this.iW,this.iH,20,20),this.pm3f.DrawText_2(this.iX+this.iW/2,this.iY+30+25,"申请列表",4294896766,36,101,1,1,0,-2,-2,2,4278261038),this.ui_mlist.BeginDraw(this.iX+30,this.iY+30+50),i=0;i<this.iAppCount;i++)this.ui_mlist.DrawUnit(0,i,""+(i+1)),this.ui_mlist.DrawUnit(1,i,this.applist[i].name),this.ui_mlist.DrawUnit(2,i,""+this.applist[i].lev),0!=this.applist[i].online&&this.ui_mlist.DrawUnit(3,i,"在线");this.ui_mlist.FinishDraw(),this.iPoint>=0&&this.iPoint<this.iAppCount&&(this.btn_agree.Draw(),this.btn_refuse.Draw(),this.btn_watch.Draw()),this.btn_close.Draw(),this.iPoint=this.ui_mlist.iLockPoint}ProcTouch(i,t,s){if(this.ui_mlist.ProcTouch(i,t,s))return!0;if(this.btn_close.ProcTouch(i,t,s))return this.btn_close.bCheck()&&ln.gi().PopStat(1),!0;if(this.iPoint>=0&&this.iPoint<this.iAppCount){if(this.btn_agree.ProcTouch(i,t,s))return this.btn_agree.bCheck()&&(Mh.gi().s_FTAgree(0,this.applist[this.iPoint].rid),ln.gi().PopStat(1),ln.gi().PushStat(ln.GS_LOADING1)),!0;if(this.btn_refuse.ProcTouch(i,t,s))return this.btn_refuse.bCheck()&&(Mh.gi().s_FTAgree(1,this.applist[this.iPoint].rid),ln.gi().PopStat(1),ln.gi().PushStat(ln.GS_LOADING1)),!0;if(this.btn_watch.ProcTouch(i,t,s))return this.btn_watch.bCheck()&&Mh.gi().s_WatchOn(0,this.applist[this.iPoint].rid,0,""),!0}return!!bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)}}pa.Open=function(i){var t,s;if(ln.gi().iXStat==ln.GS_LOADING1&&ln.gi().PopStat(1),ln.gi().iXStat==ln.GS_FTAGREE)s=ln.gi().oCurrentView;else for((s=ln.gi().PushStat(ln.GS_FTAGREE)).applist=new Array(10),t=0;t<10;t++)s.applist[t]=new da;for(s.iAppCount=i.GetNextInt(),t=0;t<s.iAppCount;t++)s.applist[t].rid=i.GetNextInt(),s.applist[t].online=i.GetNextByte(),s.applist[t].name=i.GetNextString(),s.applist[t].lev=i.GetNextInt();s.iPoint=-1};class ma{constructor(){}}class ga extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=560,this.iH=640,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_pageup=new Eh(gn.xani_button),this.btn_pageup.Move(this.iX+30,this.iY+this.iH-30-60,120,60),this.btn_pageup.InitButton("1号按钮120_60"),this.btn_pageup.sName="上一页",this.btn_pagedown=new Eh(gn.xani_button),this.btn_pagedown.Move(this.iX+this.iW-30-120,this.iY+this.iH-30-60,120,60),this.btn_pagedown.InitButton("1号按钮120_60"),this.btn_pagedown.sName="下一页",this.btn_apply=new Eh(gn.xani_button),this.btn_apply.Move(this.iX+this.iW/2-60,this.iY+this.iH-30-60,120,60),this.btn_apply.InitButton("1号按钮120_60"),this.btn_apply.sName="申请",this.btn_close=new Eh(gn.xani_button),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_close.InitButton("关闭按钮"),this.ui_mlist=new Oi(0,3,500,450),this.ui_mlist.SetTitle(0,"序号",100,!1),this.ui_mlist.SetTitle(1,"战队名称",200,!1),this.ui_mlist.SetTitle(2,"队长",200,!1)}Draw(){var i;for(E.frame_type4("10号框20_20",this.iX,this.iY,this.iW,this.iH,20,20),this.pm3f.DrawText_2(this.iX+this.iW/2,this.iY+30+25,"申请加入战队",4294896766,36,101,1,1,0,-2,-2,2,4278261038),this.ui_mlist.BeginDraw(this.iX+30,this.iY+30+50),i=0;i<this.iFtCount;i++)this.ui_mlist.DrawUnit(0,i,""+(10*this.iPage+1+i)),this.ui_mlist.DrawUnit(1,i,this.ftlist[i].name),this.ui_mlist.DrawUnit(2,i,this.ftlist[i].header);this.ui_mlist.FinishDraw(),this.iPoint=this.ui_mlist.iLockPoint,this.iPoint>=0&&this.iPoint<this.iFtCount&&this.btn_apply.Draw(),this.btn_pageup.Draw(),this.btn_pagedown.Draw(),this.btn_close.Draw()}ProcTouch(i,t,s){return!!this.ui_mlist.ProcTouch(i,t,s)||(this.btn_close.ProcTouch(i,t,s)?(this.btn_close.bCheck()&&ln.gi().PopStat(1),!0):this.iPoint>=0&&this.iPoint<this.iFtCount&&this.btn_apply.ProcTouch(i,t,s)?(this.btn_apply.bCheck()&&Mh.gi().s_ApplyFT(this.ftlist[this.iPoint].fid),!0):this.btn_pageup.ProcTouch(i,t,s)?(this.btn_pageup.bCheck()&&(this.iPage>0?(this.iPage--,Mh.gi().s_SeverEvent(18,2,this.iPage,0,0)):L.easymsg.AddMessage("已到首页")),!0):this.btn_pagedown.ProcTouch(i,t,s)?(this.btn_pagedown.bCheck()&&(this.iFtCount>=10?(this.iPage++,Mh.gi().s_SeverEvent(18,2,this.iPage,0,0)):L.easymsg.AddMessage("已到末页")),!0):!!bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH))}}ga.Open=function(i){var t,s;if(ln.gi().iXStat==ln.GS_FTAPPLY)s=ln.gi().oCurrentView;else for((s=ln.gi().PushStat(ln.GS_FTAPPLY)).ftlist=new Array(10),t=0;t<10;t++)s.ftlist[t]=new ma;for(s.iPage=i.GetNextShort(),s.iFtCount=i.GetNextByte(),t=0;t<s.iFtCount;t++)s.ftlist[t].fid=i.GetNextInt(),s.ftlist[t].rank=i.GetNextInt(),s.ftlist[t].name=i.GetNextString(),s.ftlist[t].header=i.GetNextString();s.iPoint=-1};class wa{constructor(){}}class xa extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=660,this.iH=640,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_watch=new Eh(gn.xani_button),this.btn_watch.Move(this.iX+30,this.iY+this.iH-30-60,90,60),this.btn_watch.InitButton("1号按钮90_60"),this.btn_watch.sName="查看",this.btn_tranfer=new Eh(gn.xani_button),this.btn_tranfer.Move(this.iX+30+110,this.iY+this.iH-30-60,90,60),this.btn_tranfer.InitButton("1号按钮90_60"),this.btn_tranfer.sName="转让",this.btn_kick=new Eh(gn.xani_button),this.btn_kick.Move(this.iX+30+220,this.iY+this.iH-30-60,90,60),this.btn_kick.InitButton("1号按钮90_60"),this.btn_kick.sName="踢出",this.btn_agree=new Eh(gn.xani_button),this.btn_agree.Move(this.iX+this.iW-30-90-20-150,this.iY+this.iH-30-60,150,60),this.btn_agree.InitButton("1号按钮150_60"),this.btn_agree.sName="申请列表",this.btn_message=new Eh(gn.xani_button),this.btn_message.Move(this.iX+this.iW-30-90,this.iY+this.iH-30-60,90,60),this.btn_message.InitButton("1号按钮90_60"),this.btn_message.sName="群邮",this.btn_close=new Eh(gn.xani_button),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_close.InitButton("关闭按钮"),this.ui_mlist=new Oi(0,5,600,450),this.ui_mlist.SetTitle(0,"序号",80,!1),this.ui_mlist.SetTitle(1,"名字",200,!1),this.ui_mlist.SetTitle(2,"贡献",120,!1),this.ui_mlist.SetTitle(3,"职位",80,!1),this.ui_mlist.SetTitle(4,"是否在线",120,!1)}Draw(){var i;for(E.frame_type4("10号框20_20",this.iX,this.iY,this.iW,this.iH,20,20),this.pm3f.DrawText_2(this.iX+this.iW/2,this.iY+30+25,"战队成员",4294896766,36,101,1,1,0,-2,-2,2,4278261038),this.ui_mlist.BeginDraw(this.iX+30,this.iY+30+50),i=0;i<this.iMemberCount;i++)this.ui_mlist.DrawUnit(0,i,""+(i+1)),this.ui_mlist.DrawUnit(1,i,this.ftmember[i].name),this.ui_mlist.DrawUnit(2,i,this.ftmember[i].tick+"/"+this.ftmember[i].maxtick),0!=this.ftmember[i].online&&this.ui_mlist.DrawUnit(4,i,"在线"),0==this.ftmember[i].job?this.ui_mlist.DrawUnit(3,i,"队长"):1==this.ftmember[i].job?this.ui_mlist.DrawUnit(3,i,"副队长"):this.ui_mlist.DrawUnit(3,i,"队员");this.ui_mlist.FinishDraw(),this.btn_close.Draw(),this.iPoint=this.ui_mlist.iLockPoint,this.iPoint>=0&&this.iPoint<this.iMemberCount&&this.btn_watch.Draw(),this.btn_message.Draw(),te.mft.iFTid>0&&0==te.mft.iFTJob&&(this.iPoint>0&&this.iPoint<this.iMemberCount&&(this.btn_kick.Draw(),this.btn_tranfer.Draw()),this.btn_agree.Draw(),ei.end(ei.CONFIRM_FTKICK)&&ei.bConfirm&&this.iPoint>=0&&this.iPoint<this.iMemberCount&&Mh.gi().s_FTOperate(6,this.ftmember[this.iPoint].rid,0),ei.end(ei.CONFIRM_FTTRANFER)&&ei.bConfirm&&this.iPoint>=0&&this.iPoint<this.iMemberCount&&(Mh.gi().s_FTOperate(9,this.ftmember[this.iPoint].rid,0),ln.gi().PopStat(1)))}ProcTouch(i,t,s){if(this.ui_mlist.ProcTouch(i,t,s))return!0;if(te.mft.iFTid>0&&0==te.mft.iFTJob){if(this.btn_agree.ProcTouch(i,t,s))return this.btn_agree.bCheck()&&(ln.gi().PopStat(1),Mh.gi().s_GetApply(0)),!0;if(this.iPoint>=0&&this.iPoint<this.iMemberCount){if(this.btn_kick.ProcTouch(i,t,s))return this.btn_kick.bCheck()&&ei.start(ei.CONFIRM_FTKICK,"是否确定将"+this.ftmember[this.iPoint].name+"("+this.ftmember[this.iPoint].rid+")踢出战队？"),!0;if(this.btn_tranfer.ProcTouch(i,t,s))return this.btn_tranfer.bCheck()&&ei.start(ei.CONFIRM_FTTRANFER,"是否确定将战队转让给"+this.ftmember[this.iPoint].name+"("+this.ftmember[this.iPoint].rid+")？(转让战队需要扣除20万战队资金)"),!0}}return this.btn_close.ProcTouch(i,t,s)?(this.btn_close.bCheck()&&ln.gi().PopStat(1),!0):this.iPoint>=0&&this.iPoint<this.iMemberCount&&this.btn_watch.ProcTouch(i,t,s)?(this.btn_watch.bCheck()&&Mh.gi().s_WatchOn(0,this.ftmember[this.iPoint].rid,0,""),!0):(this.btn_message.ProcTouch(i,t,s)&&this.btn_message.bCheck()&&(dt.OpenChat(10001,"战队群邮",6),L.easymsg.AddMessage("发送收取1万铜币")),!!bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH))}}xa.Open=function(i){var t,s;if(ln.gi().iXStat==ln.GS_FTMEMBER)s=ln.gi().oCurrentView;else for((s=ln.gi().PushStat(ln.GS_FTMEMBER)).ftmember=new Array(10),t=0;t<10;t++)s.ftmember[t]=new wa;for(s.iMemberCount=i.GetNextByte(),t=0;t<s.iMemberCount;t++)s.ftmember[t].rid=i.GetNextInt(),s.ftmember[t].online=i.GetNextByte(),s.ftmember[t].name=i.GetNextString(),s.ftmember[t].job=i.GetNextInt(),s.ftmember[t].tick=i.GetNextInt(),s.ftmember[t].maxtick=i.GetNextInt();s.iPoint=-1};class Sa extends s{constructor(i){var t;for(super(),this.pani=i,this.pm3f=i.pm3f,this.iW=950,this.iH=610,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new D(gn.xani_button),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.fblist=new Array(10),t=0;t<10;t++)this.fblist[t]=new Object;this.iCount=0,this.btn_apply=new Wi(gn.xani_button),this.btn_apply.InitButton("1号按钮150_60"),this.btn_apply.Move(this.iX+this.iW-40-150,this.iY+this.iH-40-60,150,60),this.btn_apply.sName="申 请",this.btn_up=new Wi(gn.xani_button),this.btn_up.InitButton("1号按钮150_60"),this.btn_up.Move(this.iX+50,this.iY+this.iH-40-60,150,60),this.btn_up.sName="上一页",this.btn_down=new Wi(gn.xani_button),this.btn_down.InitButton("1号按钮150_60"),this.btn_down.Move(this.iX+50+520-150,this.iY+this.iH-40-60,150,60),this.btn_down.sName="下一页",this.ui_fblist=new Oi(0,4,520,450),this.ui_fblist.SetTitle(0,"副本名",100,!1),this.ui_fblist.SetTitle(1,"团长",200,!1),this.ui_fblist.SetTitle(2,"团长等级",120,!1),this.ui_fblist.SetTitle(3,"状态",100,!1)}Draw(){var i;for(E.new_baseframe4(this.iX,this.iY,this.iW,this.iH,"加","入","副","本"),E.new_framein(this.iX+25,this.iY+25,this.iW-50,this.iH-50),this.btn_close.Draw(),this.ui_fblist.BeginDraw(this.iX+50,this.iY+50),i=0;i<10;i++)i>=this.iCount||(this.ui_fblist.DrawUnit(0,i,gn.de_fuben.strValue(this.fblist[i].iType,0,1)),this.ui_fblist.DrawUnit(1,i,this.fblist[i].sName),this.ui_fblist.DrawUnit(2,i,""+this.fblist[i].iLev),this.ui_fblist.DrawUnit(3,i,"招募中"));this.ui_fblist.FinishDraw(),c.gi().DrawText_2(this.iX+50+260,this.iY+this.iH-40-30,this.iPage+1+" / "+this.iTotalPage,4294959264,20,101,1,1,0,-2,-2,3,4278190080),this.btn_up.Draw(),this.btn_down.Draw(),this.ui_fblist.iLockPoint>=0&&this.ui_fblist.iLockPoint<this.iCount&&(E.ui3_Text1(this.iX+590,this.iY+50,100,220,"副本名",gn.de_fuben.strValue(this.fblist[this.ui_fblist.iLockPoint].iType,0,1)),E.ui3_Text1(this.iX+590,this.iY+50+35,100,220,"团长",this.fblist[this.ui_fblist.iLockPoint].sName),E.ui3_Text1(this.iX+590,this.iY+50+70,100,220,"团长号码",this.fblist[this.ui_fblist.iLockPoint].iRid+"("+(0==this.fblist[this.ui_fblist.iLockPoint].iOnLine?"离线":"在线")+")"),E.ui3_Text1(this.iX+590,this.iY+50+105,100,220,"人数限制",gn.de_fuben.strValue(this.fblist[this.ui_fblist.iLockPoint].iType,0,3)+"~"+gn.de_fuben.strValue(this.fblist[this.ui_fblist.iLockPoint].iType,0,4)),E.ui3_Text1(this.iX+590,this.iY+50+140,100,220,"等级限制",gn.de_fuben.strValue(this.fblist[this.ui_fblist.iLockPoint].iType,0,5)+"~"+gn.de_fuben.strValue(this.fblist[this.ui_fblist.iLockPoint].iType,0,6)),E.ui3_Text1(this.iX+590,this.iY+50+175,100,220,"创建时间",gn.de_fuben.strValue(this.fblist[this.ui_fblist.iLockPoint].iType,0,5)+"~"+gn.de_fuben.strValue(this.fblist[this.ui_fblist.iLockPoint].iType,0,6)),c.gi().DrawText_2(this.iX+590,this.iY+50+210+5,"团队简介:",4294959264,28,101,1,1,0,0,0,3,4278190080),E.frame_type4("2号框20_20",this.iX+590,this.iY+50+245,320,205,20,20),Y.gi().Format(this.fblist[this.ui_fblist.iLockPoint].sDetail,300,20),Y.gi().Draw(this.iX+600,this.iY+50+245+10),this.btn_apply.Draw())}ProcTouch(i,t,s){return!!this.ui_fblist.ProcTouch(i,t,s)||(this.btn_close.ProcTouch(i,t,s)?(this.btn_close.bCheck()&&ln.gi().PopStat(1),!0):(this.btn_apply.ProcTouch(i,t,s)&&this.btn_apply.bCheck()&&Mh.gi().s_ApplyFuBen(this.fblist[this.ui_fblist.iLockPoint].iFid),this.btn_up.ProcTouch(i,t,s)&&this.btn_up.bCheck()&&this.iPage>0&&(this.iPage--,Mh.gi().s_FuBen(2,this.iPage),ln.gi().PushStat(ln.GS_LOADING1)),this.btn_down.ProcTouch(i,t,s)&&this.btn_down.bCheck()&&this.iPage<this.iTotalPage-1&&(this.iPage++,Mh.gi().s_FuBen(2,this.iPage),ln.gi().PushStat(ln.GS_LOADING1)),!1))}}class Da{constructor(){}}class Ta extends s{constructor(i){var t;for(super(),this.sTitle="",this.pani=i,this.pm3f=i.pm3f,this.iW=800,this.iH=405,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.sgs=new Array(20),t=0;t<20;t++)this.sgs[t]=new Da;for(this.btn_buy=new Eh(gn.xani_nui2),this.btn_buy.InitButton("按钮1_110"),this.btn_buy.sName="兑换",this.goods=new Array(20),t=0;t<20;t++)this.goods[t]=new Li,this.goods[t].iPos=t}Draw_0(){var i,t;i=this.iX+30,t=this.iY+30,qi.new_DrawGoods(i,t,this.goods,null,null),c.gi().DrawTextEx(i+430+20,t+10,"拥有:"+xh.me.iFlag[25]+"积分",4278206039,30,101,1,1,0,0,0),null!=this.lockgoods&&(c.gi().DrawTextEx(i+430+20,t+10+50,"名称:"+gn.de_goods.strValue(this.lockgoods.iTid,0,4),4278206039,30,101,1,1,0,0,0),c.gi().DrawTextEx(i+430+20,t+10+100,"数量:1",4278206039,30,101,1,1,0,0,0),c.gi().DrawTextEx(i+430+20,t+10+150,"价格:"+this.sgs[this.lockgoods.iPos].iPrice+"积分",4278206039,30,101,1,1,0,0,0),this.btn_buy.Move(this.iX+this.iW-110-30,this.iY+this.iH-30-52,110,52),this.btn_buy.Draw(),qi.new_DrawRect(i,t,this.goods,this.lockgoods,0)),qi.bShowDetail()&&qi.new_DrawDetail(null,-1,-1,0)}Draw(){E.new_bigframe(this.iX,this.iY,this.iW,this.iH),this.btn_close.Draw(),this.Draw_0()}ProcTouch(i,t,s){return this.btn_close.ProcTouch(i,t,s)?(this.btn_close.bCheck()&&ln.gi().PopStat(1),!0):(e=this.iX+30,h=this.iY+30,null!=this.lockgoods&&this.btn_buy.ProcTouch(i,t,s)?(this.btn_buy.bCheck()&&(xh.me.iFlag[25]<this.sgs[this.lockgoods.iPos].iPrice?L.easymsg.AddMessage("积分不足"):(Mh.gi().s_FubenMallBuy(this.sgs[this.lockgoods.iPos].iFlag,this.sgs[this.lockgoods.iPos].iTid,this.sgs[this.lockgoods.iPos].iPrice),ln.gi().PushStat(ln.GS_LOADING1))),!0):(this.lockgoods=qi.new_LockGoods(t,s,e,h,this.goods,i),qi.NoMove(),!1));var e,h}}Ta.OPEN=function(i){var t,s;ln.gi().iXStat!=ln.GS_FUBENMALL&&ln.gi().PushStat(ln.GS_FUBENMALL);var e=ln.gi().LastStat(0);if(e.iShopId=i.GetNextInt(),e.sShopName=i.GetNextString(),0==e.iShopId){for(t=0;t<20;t++)e.goods[t].iGid=-1;for(t=0;e.sgs[t].iFlag=i.GetNextInt(),-1!=e.sgs[t].iFlag;){for(e.sgs[t].iTid=i.GetNextInt(),e.sgs[t].iPrice=i.GetNextInt(),e.sgs[t].iCount=1,e.goods[t].iGid=1,e.goods[t].iTid=e.sgs[t].iTid,e.goods[t].iCount=e.sgs[t].iCount,s=0;s<8;s++)e.goods[t].iAtts[s]=0;gn.xani_ngoods.InitAnimaWithName(gn.de_goods.strValue(e.goods[t].iTid,-1,10),e.goods[t].aa),t++}e.iSgCount=t,e.lockgoods=null,e.sTitle=i.GetNextString()}else ln.gi().PopStat(1)};class Ca{}class ka extends s{constructor(i){var t;for(super(),this.pani=i,this.pm3f=i.pm3f,this.iW=880,this.iH=550,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new D(gn.xani_button),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.fuben=new Object,this.members=new Array(128),this.applyers=new Array(128),t=0;t<128;t++)this.members[t]=new Ca,this.applyers[t]=new Ca;this.btn_leave=new Wi(gn.xani_button),this.btn_leave.InitButton("1号按钮150_60"),this.btn_leave.Move(this.iX+this.iW-40-320,this.iY+this.iH-40-60,150,60),this.btn_leave.sName="离开团队",this.btn_start=new Wi(gn.xani_button),this.btn_start.InitButton("1号按钮150_60"),this.btn_start.Move(this.iX+this.iW-40-150,this.iY+this.iH-40-60,150,60),this.btn_start.sName="开始副本",this.btn_watch=new Wi(gn.xani_button),this.btn_watch.InitButton("1号按钮120_60"),this.btn_watch.sName="查看",this.btn_agree=new Wi(gn.xani_button),this.btn_agree.InitButton("1号按钮120_60"),this.btn_agree.sName="同意",this.btn_refuse=new Wi(gn.xani_button),this.btn_refuse.InitButton("1号按钮120_60"),this.btn_refuse.sName="拒绝",this.btn_kick=new Wi(gn.xani_button),this.btn_kick.InitButton("1号按钮120_60"),this.btn_kick.sName="踢出",this.iSelectPoint=-1}Draw(){var i,t,s;for(E.new_baseframe4(this.iX,this.iY,this.iW,this.iH,"管","理","副","本"),this.btn_close.Draw(),E.new_framein(this.iX+25,this.iY+25,this.iW-50,this.iH-50),t=this.iX+50,s=this.iY+40,c.gi().DrawText_2(t+105,s,"申请列表",4294896766,28,101,1,1,0,-2,0,3,4278261038),E.frame_type4("2号框20_20",t,s+30,210,360,20,20),this.iSelectPoint>=0&&0==this.iSelectPage&&E.frame_type1("12号框20_30",t+5,s+50+20*this.iSelectPoint-15,200,20),i=0;i<this.iApplyCount;i++)c.gi().DrawText_2(t+10,s+50+20*i,this.applyers[i].sName,4294967295,20,101,1,1,0,0,-2,0,4278190080),1==this.applyers[i].iOnLine&&c.gi().DrawText_2(t+200,s+50+20*i,"在线",4294959264,20,101,1,1,0,-3,-2,3,4278190080);for(t=this.iX+60+210+20,s=this.iY+40,c.gi().DrawText_2(t+105,s,"团队成员",4294896766,28,101,1,1,0,-2,0,3,4278261038),E.frame_type4("2号框20_20",t,s+30,210,360,20,20),this.iSelectPoint>=0&&1==this.iSelectPage&&E.frame_type1("12号框20_30",t+5,s+50+20*this.iSelectPoint-15,200,20),i=0;i<this.iMemberCount;i++)c.gi().DrawText_2(t+10,s+50+20*i,this.members[i].sName,4294967295,20,101,1,1,0,0,-2,0,4278190080),1==this.members[i].iOnLine&&this.pm3f.DrawText_2(t+200,s+50+20*i,"在线",4294959264,20,101,1,1,0,-3,-2,3,4278190080);E.ui3_Text1(this.iX+520,this.iY+70,100,220,"副本名",gn.de_fuben.strValue(this.fuben.iType,0,1)),E.ui3_Text1(this.iX+520,this.iY+70+35,100,220,"团长",this.fuben.sName),E.ui3_Text1(this.iX+520,this.iY+70+70,100,220,"团长号码",this.fuben.iRid+"("+(0==this.fuben.iOnLine?"离线":"在线")+")"),E.ui3_Text1(this.iX+520,this.iY+70+105,100,220,"人数限制",gn.de_fuben.strValue(this.fuben.iType,0,3)+"~"+gn.de_fuben.strValue(this.fuben.iType,0,4)),E.ui3_Text1(this.iX+520,this.iY+70+140,100,220,"等级限制",gn.de_fuben.strValue(this.fuben.iType,0,5)+"~"+gn.de_fuben.strValue(this.fuben.iType,0,6)),E.ui3_Text1(this.iX+520,this.iY+70+175,100,220,"创建时间",this.fuben.tm),c.gi().DrawText_2(this.iX+520,this.iY+70+210+5,"团队简介:",4294896766,28,101,1,1,0,0,0,3,4278261038),E.frame_type4("2号框20_20",this.iX+520,this.iY+70+245,320,115,20,20),Y.gi().Format(this.fuben.sDetail,300,20),Y.gi().Draw(this.iX+530,this.iY+70+245+10),this.fuben.iRid==xh.me.iRid?(this.btn_leave.Move(this.iX+this.iW-40-320,this.iY+this.iH-40-60,150,60),this.btn_leave.sName="解散团队",this.btn_start.Draw(),this.iSelectPoint>=0&&(0==this.iSelectPage?(this.btn_watch.Move(this.iX+50,this.iY+this.iH-40-60,120,60),this.btn_watch.Draw(),this.btn_agree.Move(this.iX+50+45+120,this.iY+this.iH-40-60,120,60),this.btn_agree.Draw(),this.btn_refuse.Move(this.iX+50+45+120+45+120,this.iY+this.iH-40-60,120,60),this.btn_refuse.Draw()):(this.btn_watch.Move(this.iX+50+70,this.iY+this.iH-40-60,120,60),this.btn_watch.Draw(),this.btn_kick.Move(this.iX+50+70+120+70,this.iY+this.iH-40-60,120,60),this.btn_kick.Draw()))):(this.btn_leave.Move(this.iX+this.iW-40-150,this.iY+this.iH-40-60,150,60),this.btn_leave.sName="离开团队",this.iSelectPoint>=0&&1==this.iSelectPage&&(this.btn_watch.Move(this.iX+50+45+120,this.iY+this.iH-40-60,120,60),this.btn_watch.Draw())),this.btn_leave.Draw(),ei.end(ei.CONFIRM_LEAVEFUBEN)&&ei.bConfirm&&(Mh.gi().s_ManageFuBen(0,0,0),ln.gi().PopStat(1))}ProcTouch(i,t,s){if(this.iSelectPoint>=0&&this.btn_watch.ProcTouch(i,t,s))return this.btn_watch.bCheck()&&(0==this.iSelectPage?Mh.gi().s_WatchOn(0,this.applyers[this.iSelectPoint].iRid,0,""):Mh.gi().s_WatchOn(0,this.members[this.iSelectPoint].iRid,0,"")),!0;if(this.fuben.iRid==xh.me.iRid){if(this.btn_start.ProcTouch(i,t,s))return this.btn_start.bCheck()&&Mh.gi().s_ManageFuBen(4,0,0),!0;if(this.iSelectPoint>=0)if(0==this.iSelectPage){if(this.btn_agree.ProcTouch(i,t,s))return this.btn_agree.bCheck()&&(Mh.gi().s_ManageFuBen(1,this.applyers[this.iSelectPoint].iRid,0),this.iSelectPoint=-1),!0;if(this.btn_refuse.ProcTouch(i,t,s))return this.btn_refuse.bCheck()&&(Mh.gi().s_ManageFuBen(3,this.applyers[this.iSelectPoint].iRid,0),this.iSelectPoint=-1),!0}else if(this.btn_kick.ProcTouch(i,t,s))return this.btn_kick.bCheck()&&(Mh.gi().s_ManageFuBen(2,this.members[this.iSelectPoint].iRid,0),this.iSelectPoint=-1),!0}if(this.btn_leave.ProcTouch(i,t,s))return this.btn_leave.bCheck()&&(this.fuben.iRid==xh.me.iRid?ei.start(ei.CONFIRM_LEAVEFUBEN,"是否确定解散团队？"):ei.start(ei.CONFIRM_LEAVEFUBEN,"是否确定退出团队？")),!0;if(this.btn_close.ProcTouch(i,t,s))return this.btn_close.bCheck()&&ln.gi().PopStat(1),!0;var e,h,a,n,o;for(this.btn_leave.ProcTouch(i,t,s)&&this.btn_leave.bCheck()&&ln.gi().PopStat(1),this.iSelectPoint=-1,n=this.iX+60,o=this.iY+40,e=0;e<this.iApplyCount;e++)h=n+10,a=o+50+20*e,bn.bInRect(t,s,h,a-10,190,20)&&(this.iSelectPage=0,this.iSelectPoint=e);for(n=this.iX+60+210+20,o=this.iY+40,e=0;e<this.iMemberCount;e++)h=n+10,a=o+50+20*e,bn.bInRect(t,s,h,a-10,190,20)&&(this.iSelectPage=1,this.iSelectPoint=e);return!1}}class Aa extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=480,this.iH=440,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.in_govname=new pi(gn.xani_frame),this.in_govname.Move(this.iX+25+20,this.iY+25+20+30,this.iW-90,50),this.in_govname.bHideText=!0,this.in_govdetail=new pi(gn.xani_frame),this.in_govdetail.Move(this.iX+25+20,this.iY+25+20+30+50+20+30,this.iW-90,150),this.in_govdetail.bHideText=!0,this.btn_create=new D(gn.xani_nui2),this.btn_create.Move(this.iX+this.iW-25-20-110,this.iY+this.iH-25-20-52,110,52),this.btn_create.InitButton("按钮1_110"),this.btn_create.sName="创建",this.btn_cancel=new D(gn.xani_nui2),this.btn_cancel.Move(this.iX+25+20,this.iY+this.iH-25-20-52,110,52),this.btn_cancel.InitButton("按钮1_110"),this.btn_cancel.sName="取消"}Draw(){E.new_bigframe(this.iX,this.iY,this.iW,this.iH),E.new_framein(this.iX+25,this.iY+25,this.iW-50,this.iH-50),this.pm3f.DrawTextEx(this.in_govname.iX,this.in_govname.iY-30,"输入帮派名称(2~8字)：",4278206039,30,101,1,1,0,0,0),E.new_frameon(this.in_govname.iX,this.in_govname.iY,this.in_govname.iW,this.in_govname.iH,1),E.new_framepc(this.in_govname.iX,this.in_govname.iY,this.in_govname.iW,this.in_govname.iH),this.pm3f.DrawTextEx(this.in_govname.iX+10,this.in_govname.iY+25,this.in_govname.sDetail,4294967295,30,101,1,1,0,0,-2),this.pm3f.DrawTextEx(this.in_govdetail.iX,this.in_govdetail.iY-30,"输入帮派简介：",4278206039,30,101,1,1,0,0,0),E.new_frameon(this.in_govdetail.iX,this.in_govdetail.iY,this.in_govdetail.iW,this.in_govdetail.iH,1),E.new_framepc(this.in_govdetail.iX,this.in_govdetail.iY,this.in_govdetail.iW,this.in_govdetail.iH),Y.gi().Format(this.in_govdetail.sDetail,this.in_govdetail.iW-20,30),Y.gi().Draw(this.in_govdetail.iX+10,this.in_govdetail.iY+10),this.btn_create.Draw(),this.btn_cancel.Draw(),this.in_govname.onscr(),this.in_govdetail.onscr()}ProcTouch(i,t,s){if(this.in_govname.ProcTouch(i,t,s),this.in_govdetail.ProcTouch(i,t,s),this.btn_create.ProcTouch(i,t,s)){if(this.btn_create.bCheck()){if(this.in_govname.length<2||this.in_govname.length>8)return L.easymsg.AddMessage("帮派名称2-8个字"),!0;if(this.in_govdetail.length<2||this.in_govdetail.length>40)return L.easymsg.AddMessage("帮派宗旨2-40个字"),!0;Mh.gi().s_CreateGov(this.in_govname.sDetail,this.in_govdetail.sDetail),ln.gi().PopStat(1)}return!0}return this.btn_cancel.ProcTouch(i,t,s)?(this.btn_cancel.bCheck()&&ln.gi().PopStat(1),!0):!!bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)}}class Ia{constructor(){}}class Pa extends s{constructor(i){var t;for(super(),this.pani=i,this.pm3f=i.pm3f,this.iW=800,this.iH=400,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.elist=new Array(8),t=0;t<8;t++)this.elist[t]=new Ia;for(this.btn_learn=new Eh(gn.xani_nui2),this.btn_learn.InitButton("按钮1_110"),this.btn_learn.sName="学习",this.btn_select=new Array(8),t=0;t<8;t++)this.btn_select[t]=new Eh(gn.xani_nui2),this.btn_select[t].InitButton("按钮2");this.iSelectPoint=0,this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60)}Draw(){var i,t,s,e;for(t=this.iW-185-20-25-25,E.new_bigframe(this.iX,this.iY,this.iW,this.iH),E.new_framein(this.iX+25,this.iY+25,185,this.iH-25-25),E.new_framein(this.iX+25+185+20,this.iY+25,t,this.iH-25-25),i=0;i<this.iCount;i++)s=this.iX+20+25,e=this.iY+25+20+70*i,this.btn_select[i].Move(s,e,145,56),this.btn_select[i].sName=me.sSkill(this.elist[i].iPoint),this.iSelectPoint==i&&(this.btn_select[i].bMouseDown=!0,this.btn_select[i].bMouseIn=!0),this.btn_select[i].Draw();this.iSelectPoint>=0&&(s=this.iX+25+185+20+20,e=this.iY+25+20,gn.xani_nicon.DrawAnima_aa(s,e,gn.de_skill.strValue(this.elist[this.iSelectPoint].iSid,0,6),0),this.pm3f.DrawTextEx(s+90,e+25,gn.de_skill.strValue(this.elist[this.iSelectPoint].iSid,0,6),4278206039,40,101,1,1,0,0,-2),this.pm3f.DrawTextEx(s+90,e+80,"等级："+this.elist[this.iSelectPoint].iLev+"/"+this.elist[this.iSelectPoint].iMaxLev,4278206039,30,101,1,1,0,0,-3),e+=90,Y.gi().FormatEx("#c003e57"+gn.de_skill.strValue(this.elist[this.iSelectPoint].iSid,0,3),t-40,30,0,0,32),Y.gi().Draw(s,e),e+=Y.gi().iH+8,this.elist[this.iSelectPoint].iNeedExp<=xh.me.rbs.iExp?this.pm3f.DrawTextEx(s,e,"升级经验："+this.elist[this.iSelectPoint].iNeedExp+"/"+xh.me.rbs.iExp,4278255360,30,101,1,1,0,0,0):this.pm3f.DrawTextEx(s,e,"升级经验："+this.elist[this.iSelectPoint].iNeedExp+"/"+xh.me.rbs.iExp,4294901760,30,101,1,1,0,0,0),e+=35,this.elist[this.iSelectPoint].iNeedMoney<=xh.me.rbs.iMoney?this.pm3f.DrawTextEx(s,e,"升级金钱:"+this.elist[this.iSelectPoint].iNeedMoney+"/"+xh.me.rbs.iMoney,4278255360,30,101,1,1,0,0,0):this.pm3f.DrawTextEx(s,e,"升级金钱:"+this.elist[this.iSelectPoint].iNeedMoney+"/"+xh.me.rbs.iMoney,4294901760,30,101,1,1,0,0,0),e+=35,this.pm3f.DrawTextEx(s,e,"绑铜："+xh.me.rbs.iReserve,4278206039,30,101,1,1,0,0,0),this.btn_learn.Move(this.iX+this.iW-110-25-20,this.iY+this.iH-52-25-20,110,52),this.btn_learn.Draw()),this.btn_close.Draw()}ProcTouch(i,t,s){var e;if(3==i&&!bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH))return ln.gi().PopStat(1),!0;if(this.iSelectPoint>=0&&this.btn_learn.ProcTouch(i,t,s))return this.btn_learn.bCheck()&&(Mh.gi().s_SeverEvent(6,this.stype,this.elist[this.iSelectPoint].iPoint,this.elist[this.iSelectPoint].iSid,0),ln.gi().PushStat(ln.GS_LOADING1)),!0;for(e=0;e<this.iCount;e++)this.btn_select[e].ProcTouch(i,t,s)&&this.btn_select[e].bCheck()&&(this.iSelectPoint=e);return!!this.btn_close.ProcTouch(i,t,s)&&(this.btn_close.bCheck()&&ln.gi().PopStat(1),!0)}}Pa.Open=function(i){var t,s;for(ln.gi().iXStat==ln.GS_LOADING1&&ln.gi().PopStat(1),(s=ln.gi().iXStat==ln.GS_EXTLEARNSKILL?ln.gi().LastStat(0):ln.gi().PushStat(ln.GS_EXTLEARNSKILL)).stype=i.GetNextInt(),s.iCount=i.GetNextByte(),t=0;t<s.iCount;t++)s.elist[t].iPoint=i.GetNextByte(),s.elist[t].iSid=i.GetNextShort(),s.elist[t].iLev=i.GetNextShort(),s.elist[t].iMaxLev=i.GetNextShort(),s.elist[t].iNeedExp=i.GetNextInt(),s.elist[t].iNeedMoney=i.GetNextInt(),s.elist[t].iNeedOther=i.GetNextInt()};class Na extends s{constructor(i){var t;for(super(),this.pani=i,this.pm3f=i.pm3f,this.iW=560,this.iH=500,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.iDelay=new Int32Array(6),this.btn_xiu=new Array(6),t=0;t<6;t++)this.iDelay[t]=0,this.btn_xiu[t]=new Eh(gn.xani_nui3),this.btn_xiu[t].InitButton("内框按钮"),this.btn_xiu[t].sName="修炼"}Draw(){var i,t,s,h,a,n,o,r;for(E.new_baseframe2(this.iX,this.iY,this.iW,this.iH,"修","炼"),this.btn_close.Draw(),h=this.iX+25,a=this.iY+25,n=this.iW-50,o=this.iH-50-70,E.new_framein(h,a,n,o),i=0;i<6;i++)t=h+10,s=a+60*i+10,E.new_frameon(t,s,n-20,60,0),r=xh.me.rbs.iGovXiu[i][0],this.pm3f.DrawTextEx(t+10,s+30,gn.de_skill.strValue(e.iGovXiuId[i],0,6)+r+"级",4294967295,25,101,1,1,0,0,-2),this.pm3f.DrawTextEx(t+n-20-180,s+30,xh.me.rbs.iGovXiu[i][1]+"/"+Fi.iBuildingUpgrad[r]/10,4294967295,20,101,1,1,0,-2,-2),this.btn_xiu[i].Move(t+n-20-2-98,s+2.5,98,55),this.iDelay[i]>0?(this.iDelay[i]--,this.btn_xiu[i].bDisable=!0):this.btn_xiu[i].bDisable=!1,this.btn_xiu[i].Draw();this.pm3f.DrawTextEx(this.iX+25,this.iY+this.iH-25-60,"每次修炼花费30000金钱和5点帮贡，并消耗5点帮派行动力",4278206039,20,101,1,1,0,0,0),this.pm3f.DrawTextEx(this.iX+25,this.iY+this.iH-25-30,"如果背包中有修炼丹，优先消耗修炼丹",4278206039,20,101,1,1,0,0,0)}ProcTouch(i,t,s){var h,a,n;if(this.btn_close.ProcTouch(i,t,s))return this.btn_close.bCheck()&&ln.gi().PopStat(1),!0;for(h=0;h<6;h++)this.btn_xiu[h].ProcTouch(i,t,s)&&this.btn_xiu[h].bCheck()&&((n=xh.me.rbs.iGovXiu[h][0])>=xh.me.rbs.iLev/5?L.easymsg.AddMessage("修炼不能超过人物等级/5"):Fi.mg.iTick<5?L.easymsg.AddMessage("帮贡不足"):Fi.mg.iGovTick<5?L.easymsg.AddMessage("帮派行动力不足"):xh.me.rbs.iMoney+xh.me.rbs.iReserve<3e4?L.easymsg.AddMessage("金钱不足"):(this.iDelay[h]=20,xh.me.rbs.iReserve>=3e4?xh.me.rbs.iReserve-=3e4:(a=3e4-xh.me.rbs.iReserve,xh.me.rbs.iReserve=0,xh.me.rbs.iMoney-=a),Fi.mg.iGovTick-=5,Fi.mg.iTick-=5,xh.me.rbs.iGovXiu[h][1]+=10,xh.me.rbs.iGovXiu[h][1]>=Fi.iBuildingUpgrad[n]/10&&(xh.me.rbs.iGovXiu[h][0]++,xh.me.rbs.iGovXiu[h][1]-=Fi.iBuildingUpgrad[n]/10),Mh.gi().s_GovXiu(e.iGovXiuId[h],h)));return!1}}class va extends s{constructor(i){var t;for(super(),this.pani=i,this.pm3f=i.pm3f,this.iW=800,this.iH=550,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_learn=new Eh(gn.xani_nui2),this.btn_learn.InitButton("按钮1_110"),this.btn_learn.sName="学习",this.btn_select=new Array(10),t=0;t<10;t++)this.btn_select[t]=new Eh(gn.xani_nui2),this.btn_select[t].InitButton("按钮2");this.iSelectPoint=0}Draw(){var i,t,s,h;for(t=this.iW-185-20-25-25,E.new_bigframe(this.iX,this.iY,this.iW,this.iH),E.new_framein(this.iX+25,this.iY+25,185,this.iH-25-25),E.new_framein(this.iX+25+185+20,this.iY+25,t,this.iH-25-25),this.btn_close.Draw(),i=0;i<8;i++)s=this.iX+20+25,h=this.iY+25+20+56*i,this.btn_select[i].Move(s,h,145,56),this.btn_select[i].sName=me.sSkill(i),this.iSelectPoint==i&&(this.btn_select[i].bMouseDown=!0,this.btn_select[i].bMouseIn=!0),this.btn_select[i].Draw();this.iSelectPoint>=0&&(s=this.iX+25+185+20+20,h=this.iY+25+20,gn.xani_nicon.DrawAnima_aa(s,h,gn.de_skill.strValue(e.iGovSkillId[this.iSelectPoint],0,6),0),this.pm3f.DrawTextEx(s+90,h+25,gn.de_skill.strValue(e.iGovSkillId[this.iSelectPoint],0,6),4278206039,40,101,1,1,0,0,-2),this.pm3f.DrawTextEx(s+90,h+80,"等级："+xh.me.rbs.iGovSkill[this.iSelectPoint]+"/"+Fi.mg.iGovSkillLev[this.iSelectPoint],4278206039,30,101,1,1,0,0,-3),h+=90,Y.gi().FormatEx("#c003e57"+gn.de_skill.strValue(e.iGovSkillId[this.iSelectPoint],0,3),t-40,30,0,0,32),Y.gi().Draw(s,h),h+=Y.gi().iH+8,parseInt(e.iUpgradeExp[xh.me.rbs.iGovSkill[this.iSelectPoint]]/6)<=xh.me.rbs.iExp?this.pm3f.DrawTextEx(s,h,"升级经验："+parseInt(e.iUpgradeExp[xh.me.rbs.iGovSkill[this.iSelectPoint]]/6)+"/"+xh.me.rbs.iExp,4278255360,30,101,1,1,0,0,0):this.pm3f.DrawTextEx(s,h,"升级经验："+parseInt(e.iUpgradeExp[xh.me.rbs.iGovSkill[this.iSelectPoint]]/6)+"/"+xh.me.rbs.iExp,4294901760,30,101,1,1,0,0,0),h+=35,parseInt(e.iUpgradeMoney[xh.me.rbs.iGovSkill[this.iSelectPoint]]/18)<=xh.me.rbs.iMoney?this.pm3f.DrawTextEx(s,h,"升级金钱:"+parseInt(e.iUpgradeMoney[xh.me.rbs.iGovSkill[this.iSelectPoint]]/18)+"/"+xh.me.rbs.iMoney,4278255360,30,101,1,1,0,0,0):this.pm3f.DrawTextEx(s,h,"升级金钱:"+parseInt(e.iUpgradeMoney[xh.me.rbs.iGovSkill[this.iSelectPoint]]/18)+"/"+xh.me.rbs.iMoney,4294901760,30,101,1,1,0,0,0),h+=35,5*(xh.me.rbs.iGovSkill[this.iSelectPoint]+1)<=Fi.mg.iTick?this.pm3f.DrawTextEx(s,h,"升级贡献:"+5*(xh.me.rbs.iGovSkill[this.iSelectPoint]+1)+"/"+Fi.mg.iTick,4278255360,30,101,1,1,0,0,0):this.pm3f.DrawTextEx(s,h,"升级贡献:"+5*(xh.me.rbs.iGovSkill[this.iSelectPoint]+1)+"/"+Fi.mg.iTick,4294901760,30,101,1,1,0,0,0),h+=35,xh.me.rbs.iGovSkill[this.iSelectPoint]+1<=Fi.mg.iGovTick?this.pm3f.DrawTextEx(s,h,"升级行动力:"+(xh.me.rbs.iGovSkill[this.iSelectPoint]+1)+"/"+Fi.mg.iGovTick,4278255360,30,101,1,1,0,0,0):this.pm3f.DrawTextEx(s,h,"升级行动力:"+(xh.me.rbs.iGovSkill[this.iSelectPoint]+1)+"/"+Fi.mg.iGovTick,4294901760,30,101,1,1,0,0,0),h+=35,this.pm3f.DrawTextEx(s,h,"绑铜："+xh.me.rbs.iReserve,4278206039,30,101,1,1,0,0,0),this.btn_learn.Move(this.iX+this.iW-110-25-20,this.iY+this.iH-52-25-20,110,52),this.btn_learn.Draw())}ProcTouch(i,t,s){var h;if(this.btn_close.ProcTouch(i,t,s))return this.btn_close.bCheck()&&ln.gi().PopStat(1),!0;for(h=0;h<8;h++)this.btn_select[h].ProcTouch(i,t,s)&&this.btn_select[h].bCheck()&&(this.iSelectPoint=h);return this.iSelectPoint>=0&&this.btn_learn.ProcTouch(i,t,s)&&this.btn_learn.bCheck()&&(xh.me.rbs.iGovSkill[this.iSelectPoint]>=Fi.mg.iGovSkillLev[this.iSelectPoint]?L.easymsg.AddMessage("已达学习上限"):xh.me.rbs.iGovSkill[this.iSelectPoint]>=xh.me.rbs.iLev+10?L.easymsg.AddMessage("不能超过人物等级10级"):parseInt(e.iUpgradeExp[xh.me.rbs.iGovSkill[this.iSelectPoint]]/6)>xh.me.rbs.iExp?L.easymsg.AddMessage("经验不足"):parseInt(e.iUpgradeMoney[xh.me.rbs.iGovSkill[this.iSelectPoint]]/18)>xh.me.rbs.iMoney?L.easymsg.AddMessage("金钱不足"):5*(xh.me.rbs.iGovSkill[this.iSelectPoint]+1)>Fi.mg.iTick?L.easymsg.AddMessage("帮派贡献不足"):xh.me.rbs.iGovSkill[this.iSelectPoint]+1>Fi.mg.iGovTick?L.easymsg.AddMessage("帮派行动力不足"):(Mh.gi().s_LearnGovSkill(e.iGovSkillId[this.iSelectPoint],this.iSelectPoint),xh.me.rbs.iExp-=parseInt(e.iUpgradeExp[xh.me.rbs.iGovSkill[this.iSelectPoint]]/6),xh.me.rbs.iMoney-=parseInt(e.iUpgradeExp[xh.me.rbs.iGovSkill[this.iSelectPoint]]/18),Fi.mg.iTick-=5*(xh.me.rbs.iGovSkill[this.iSelectPoint]+1),Fi.mg.iGovTick-=xh.me.rbs.iGovSkill[this.iSelectPoint]+1,xh.me.rbs.iGovSkill[this.iSelectPoint]++,xh.me.CalcFightAtt())),!1}}class Ma extends s{constructor(i){super(),this.iJobList=[0,1,2,3,4,5,10],this.pani=i,this.pm3f=i.pm3f,this.iW=540,this.iH=340,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new D(gn.xani_ui),this.btn_close.InitButton("统一关闭按钮"),this.btn_close.Move(this.iX+this.iW-60-5,this.iY,60,60);this.btn_send=new D(gn.xani_ui),this.btn_send.InitButton("统一中按钮4"),this.btn_send.Move(this.iX+this.iW-130-30,this.iY+35+50,130,40),this.btn_send.sName="发送消息",this.btn_add=new D(gn.xani_ui),this.btn_add.InitButton("统一中按钮4"),this.btn_add.Move(this.iX+this.iW-130-30,this.iY+35+100,130,40),this.btn_add.sName="加为好友",this.btn_set=new D(gn.xani_ui),this.btn_set.InitButton("统一中按钮4"),this.btn_set.Move(this.iX+this.iW-130-30,this.iY+35+150,130,40),this.btn_set.sName="职位设置",this.btn_kick=new D(gn.xani_ui),this.btn_kick.InitButton("统一中按钮4"),this.btn_kick.Move(this.iX+this.iW-130-30,this.iY+35+200,130,40),this.btn_kick.sName="踢出帮派",this.bInited=!1,this.bSetJob=!1}Draw(){E.Frame3_BK(this.iX,this.iY,this.iW,this.iH,"成员属性"),this.btn_close.Draw(),E.Frame2_MD(this.iX+10,this.iY+70-5,this.iW-20,this.iH-80),E.Frame1_BR(this.iX+30,this.iY+90-5,340,this.iH-120);var i=this.iX+30,t=this.iY+90-5;if(E.Data1_BR(i+10,t+10,"名字",this.sName,60,100),E.Data1_BR(i+180,t+10,"号码",""+this.iRid,40,100),E.Data1_BR(i+10,t+10+30,"性别",xh.sSex(this.iSex),60,60),E.Data1_BR(i+180,t+10+30,"种族",xh.sRace(this.iRace),60,80),E.Data1_BR(i+10,t+10+60,"等级",""+this.iLev,60,50),E.Data1_BR(i+180,t+10+60,"门派",e.sSchools[this.iSchoolId],60,80),E.Data1_BR(i+10,t+10+90,"职位",me.sJob(this.iJob),60,80),E.Data1_BR(i+180,t+10+90,"贡献",""+this.iTick,60,80),E.Data1_BR(i+10,t+10+120,"历史帮贡",""+this.iMaxTick,100,200),E.Data1_BR(i+10,t+10+150,"入帮时间",this.sJoinTime,100,200),E.Data1_BR(i+10,t+10+180,"登陆时间",this.sLoginTime,100,200),this.btn_send.Draw(),this.btn_add.Draw(),0!=Fi.mg.iJob&&1!=Fi.mg.iJob||Fi.mg.iJob<this.iJob&&(ei.end(ei.CONFIRM_GOVKICK)&&ei.bConfirm&&(Mh.gi().s_OperateGovMember(this.iRid,2,0),ln.gi().PopStat(1),me.ReloadMember()),this.btn_kick.Draw(),this.btn_set.Draw()),this.bSetJob){var s,a=(h.SCRW-140)/2,n=(h.SCRH-265)/2;for(E.Frame2_MD(a,n,140,265),E.Frame1_BR(a+20,n+20,100,225),s=0;s<7;s++)i=a+30,t=n+30+30*s,s==this.iJobPoint&&this.pm3f.FillRect_2D(i,t,i+140-60,t+30,4278255360),this.iJobList[s]<=Fi.mg.iJob?this.pm3f.DrawTextEx(i,t,me.sJob(this.iJobList[s]),4286611584,25,101,1,1,0,0,0):this.pm3f.DrawTextEx(i,t,me.sJob(this.iJobList[s]),4294967295,25,101,1,1,0,0,0)}}ProcTouch(i,t,s){var e;if(this.bSetJob){var a=(h.SCRW-140)/2,n=(h.SCRH-265)/2;for(this.iJobPoint=-1,e=0;e<7;e++){var o=a+30,r=n+30+30*e;bn.bInRect(t,s,o,r,80,30)&&(this.iJobList[e]<Fi.mg.iJob?this.iJobPoint=-1:this.iJobPoint=e)}return 3==i&&-1!=this.iJobPoint&&(this.iJob=this.iJobList[this.iJobPoint],Mh.gi().s_OperateGovMember(this.iRid,3,this.iJob),this.bSetJob=!1,ln.gi().PopStat(1),me.ReloadMember()),1!=i||bn.bInRect(t,s,a,n,140,265)||(this.bSetJob=!1),!1}if(this.btn_close.ProcTouch(i,t,s))return this.btn_close.bCheck()&&ln.gi().PopStat(1),!0;if(this.btn_send.ProcTouch(i,t,s))return this.btn_send.bCheck()&&dt.OpenChat(this.iRid,this.sName,2*this.iRace+this.iSex),!0;if(this.btn_add.ProcTouch(i,t,s))return this.btn_add.bCheck()&&Mh.gi().s_FriendOperate(0,this.iRid,0),!0;if((0==Fi.mg.iJob||1==Fi.mg.iJob||4==Fi.mg.iJob)&&Fi.mg.iJob<this.iJob){if(this.btn_kick.ProcTouch(i,t,s))return this.btn_kick.bCheck()&&ei.start(ei.CONFIRM_GOVKICK,"是否确定把"+this.sName+"踢出帮派？"),!0;if(this.btn_set.ProcTouch(i,t,s))return this.btn_set.bCheck()&&(this.iJobPoint=-1,this.bSetJob=!0),!0}return!1}getgovdata(i){6==i.GetNextByte()&&(this.iRid=i.GetNextInt(),this.sName=i.GetNextString(),this.iRace=i.GetNextByte(),this.iSex=i.GetNextByte(),this.iLev=i.GetNextInt(),this.iSchoolId=i.GetNextByte(),this.iJob=i.GetNextInt(),this.iTick=i.GetNextInt(),this.sJoinTime=i.GetNextString(),this.sLoginTime=i.GetNextString(),this.iMaxTick=i.GetNextInt(),this.bInited=!0)}}class ya extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=540,this.iH=350,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new Eh(gn.xani_button),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.iDelay=0,this.btn_xiu=new Eh(gn.xani_button),this.btn_xiu.InitButton("1号按钮90_60"),this.btn_xiu.sName="修炼",this.iXiuPoint=0}Draw(){var i,t,s,h,a;for(E.frame_type4("10号框20_20",this.iX,this.iY,this.iW,this.iH,20,20),this.btn_close.Draw(),this.pm3f.DrawText_2(this.iX+this.iW/2,this.iY+30,"宠物修炼",4294896766,36,101,1,1,0,-2,0,2,4278261038),E.frame_type4("11号框20_20",this.iX+20,this.iY+70,this.iW-40,150,20,20),i=0;i<4;i++)t=this.iX+30,s=this.iY+65+20+30*i,a=4279324257,this.iXiuPoint==i&&(E.frame_type1("12号框20_30",t,s,this.iW-60,20),this.iDelay>0?(this.iDelay--,this.btn_xiu.bDisable=!0):this.btn_xiu.bDisable=!1),h=xh.me.rbs.iGovXiu[i+6][0],this.pm3f.DrawTextEx(t+10,s+15,""+gn.de_skill.strValue(e.iGovXiuId[i+6],0,6)+h+"级",a,20,101,1,1,0,0,-2),this.pm3f.DrawTextEx(this.iX+this.iW-40,s+15,xh.me.rbs.iGovXiu[i+6][1]+"/"+Fi.iBuildingUpgrad[h]/10,a,20,101,1,1,0,-3,-2);this.btn_xiu.Move(this.iX+this.iW-20-90,this.iY+this.iH-20-60,90,60),this.btn_xiu.Draw(),E.frame_type4("11号框20_20",this.iX+20,this.iY+70+150+20,this.iW-40-90-20,90,20,20),this.pm3f.DrawTextEx(this.iX+40,this.iY+260,"当前拥有修炼积分:"+xh.me.iFlag[13],4279324257,20,101,1,1,0,0,0),this.pm3f.DrawTextEx(this.iX+40,this.iY+290,"每次修炼花费10点修炼积分",4279324257,20,101,1,1,0,0,0)}ProcTouch(i,t,s){var h,a;if(this.btn_close.ProcTouch(i,t,s))return this.btn_close.bCheck()&&ln.gi().PopStat(1),!0;for(h=0;h<4;h++){var n=this.iX+30,o=this.iY+65+20+30*h;bn.bInRect(t,s,n,o,this.iW-60,30)&&(this.iXiuPoint=h)}return this.iXiuPoint>=0&&this.iXiuPoint<4&&this.iDelay<=0&&(h=this.iXiuPoint,this.btn_xiu.ProcTouch(i,t,s)&&this.btn_xiu.bCheck()&&((a=xh.me.rbs.iGovXiu[h+6][0])>=xh.me.rbs.iLev/5?L.easymsg.AddMessage("修炼不能超过人物等级/5"):xh.me.iFlag[13]<10?L.easymsg.AddMessage("宠修积分不足"):(xh.me.iFlag[13]-=10,xh.me.rbs.iGovXiu[h+6][1]+=10,xh.me.rbs.iGovXiu[h+6][1]>=Fi.iBuildingUpgrad[a]/10&&(xh.me.rbs.iGovXiu[h+6][0]++,xh.me.rbs.iGovXiu[h+6][1]-=Fi.iBuildingUpgrad[a]/10),Mh.gi().s_GovXiu(e.iGovXiuId[h+6],h+6)))),!1}}class Ra{constructor(){}}class Ga extends s{constructor(i){var t;for(super(),this.MAXGOVLIST=32,this.pani=i,this.pm3f=i.pm3f,this.govlist=new Array(this.MAXGOVLIST),t=0;t<this.MAXGOVLIST;t++)this.govlist[t]=new Ra;this.Init()}ApplyedGovs(i){var t,s,e,h;for(s=i.GetNextInt(),t=0;t<s;t++)for(h=i.GetNextShort(),e=0;e<this.iGovCount;e++)null!=this.govlist[e]&&this.govlist[e].iGovId==h&&(this.govlist[e].bApplyed=!0)}GetGovDetail(i){for(var t=i.GetNextInt(),s=i.GetNextByte(),e=0;e<this.iGovCount;e++)if(null!=this.govlist[e]&&this.govlist[e].iGovId==t){1==this.govlist[e].iInitStat&&(0==s?this.govlist[e].iInitStat=3:(this.govlist[e].iInitStat=2,this.govlist[e].sGovName=i.GetNextString(),this.govlist[e].iGovLev=i.GetNextInt(),this.govlist[e].iMemberCount=i.GetNextInt(),this.govlist[e].iMaxMemberCount=i.GetNextInt(),this.govlist[e].sMaster=i.GetNextString(),this.govlist[e].iMasterId=i.GetNextInt(),this.govlist[e].sDetail=i.GetNextString()));break}}GetIdList(i){var t,s;for(t=i.GetNextInt(),0==(s=i.GetNextShort())&&(this.iGovCount=t,this.govlist=new Array(this.iGovCount),this.iOffY=0);!(3e4==(t=i.GetNextShort())||i.iOffset>1024||s>=this.iGovCount);)null==this.govlist[s]&&(this.govlist[s]=new Ra),this.govlist[s].iGovId=t,this.govlist[s].iInitStat=0,this.govlist[s].bApplyed=!1,s++}Init(){this.iW=920,this.iH=620,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.ui_govlist=new Oi(0,6,this.iW-90,330),this.ui_govlist.SetTitle(0,"序号",90,!1),this.ui_govlist.SetTitle(1,"名称",200,!1),this.ui_govlist.SetTitle(2,"帮派号码",130,!1),this.ui_govlist.SetTitle(3,"等级",90,!1),this.ui_govlist.SetTitle(4,"人数",140,!1),this.ui_govlist.SetTitle(5,"帮主",180,!1),this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.govlist=null,this.iGovCount=-1,this.in_govni=new pi(gn.xani_ui),this.in_govni.sDetail="",this.in_govni.sBackPrompt="点击这里输入帮派号码或名称",this.in_govni.iBackSize=24,this.in_govni.iTextSize=30,this.btn_find=new Eh(gn.xani_button),this.btn_find.InitButton("查找按钮60_60"),this.btn_callmaster=new Eh(gn.xani_button),this.btn_callmaster.InitButton("普通按钮195_55"),this.btn_callmaster.sName="联系帮主",this.btn_applyall=new Eh(gn.xani_button),this.btn_applyall.InitButton("普通按钮195_55"),this.btn_applyall.sName="一键申请",this.btn_applyone=new Eh(gn.xani_button),this.btn_applyone.InitButton("普通按钮195_55"),this.btn_applyone.sName="申请加入",this.btn_creategov=new Eh(gn.xani_button),this.btn_creategov.InitButton("普通按钮195_55"),this.btn_creategov.sName="创建帮派",this.btn_getingov=new Eh(gn.xani_button),this.btn_getingov.InitButton("普通按钮195_55"),this.btn_getingov.sName="进入帮派",this.aa_applyed=gn.xani_frame.InitAnimaWithName("选中勾a43_36",null),this.bApplyAll=!1}Draw(){var i,t,s,e,h;for(E.new_baseframe4(this.iX,this.iY,this.iW,this.iH,"帮","派","列","表"),this.btn_close.Draw(),t=this.iX+25,s=this.iY+25,e=this.iW-50,h=this.iH-50,E.new_framein(t,s,e,h),t+=20,s+=20,this.ui_govlist.BeginDraw(t,s),i=0;i<this.iGovCount;i++)this.ui_govlist.DrawUnit(0,i,""+(i+1)),this.ui_govlist.bShow(i)&&null!=this.govlist[i]&&(0==this.govlist[i].iInitStat?(this.govlist[i].iInitStat=1,Mh.gi().s_NewGovOperate(1,this.govlist[i].iGovId,0,0,0,"")):1==this.govlist[i].iInitStat?this.ui_govlist.DrawUnit(1,i,"获取中..."):2==this.govlist[i].iInitStat&&(this.govlist[i].bApplyed?this.ui_govlist.DrawUnitEx_Anima(0,i,this.aa_applyed,60,2):this.bApplyAll&&(Mh.gi().s_ApplyForGov(this.govlist[i].iGovId),this.govlist[i].bApplyed=!this.govlist[i].bApplyed),this.ui_govlist.DrawUnit(1,i,this.govlist[i].sGovName),this.ui_govlist.DrawUnit(2,i,""+this.govlist[i].iGovId),this.ui_govlist.DrawUnit(3,i,""+(this.govlist[i].iGovLev+1)),this.ui_govlist.DrawUnit(4,i,this.govlist[i].iMemberCount+"/"+this.govlist[i].iMaxMemberCount),this.ui_govlist.DrawUnit(5,i,this.govlist[i].sMaster)));this.ui_govlist.FinishDraw(),t=this.iX+25+20,s=this.iY+25+20+330+20,E.frame_type3("纯色b10_10",t,s,400,180,10,10),E.frame_type2("外边框a10_10",t,s,400,180,10,10),E.frame_type1("帮派宣言a20_44",t+200-60,s+20,120,20),c.gi().DrawTextEx(t+200,s+20+22,"帮派宣言",4278190080,25,101,1,1,0,-2,-2),this.ui_govlist.iLockPoint>=0&&this.ui_govlist.iLockPoint<this.iGovCount?(i=this.ui_govlist.iLockPoint,2==this.govlist[i].iInitStat&&(Y.gi().FormatEx("#c000000"+this.govlist[i].sDetail,360,20,0,0,20),Y.gi().Draw(t+20,s+80)),this.btn_callmaster.bDisable=!1,this.btn_applyone.bDisable=!1,this.govlist[i].bApplyed?this.btn_applyone.sName="撤销申请":this.btn_applyone.sName="申请加入",this.btn_getingov.bDisable=!1):(this.btn_callmaster.bDisable=!0,this.btn_applyone.bDisable=!0,this.btn_getingov.bDisable=!0),t+=420,this.in_govni.Move(t,s,300,47),E.frame_type1("输入框a20_47",t,s,300,20),this.in_govni.DrawText(),this.btn_find.Move(t+300+30,s-6.5,60,60),this.btn_find.Draw(),this.in_govni.onscr(),s+=67,this.btn_callmaster.Move(t,s,195,55),this.btn_callmaster.Draw(),-1==Fi.mg.iRealGid?(this.btn_applyall.Move(t+205,s,195,55),this.btn_applyall.Draw(),this.btn_applyone.Move(t,s+60,195,55),this.btn_applyone.Draw(),this.btn_creategov.Move(t+205,s+60,195,55),this.btn_creategov.Draw()):(this.btn_getingov.Move(t+205,s,195,55),this.btn_getingov.Draw()),this.bApplyAll=!1}ProcTouch(i,t,s){if(this.ui_govlist.ProcTouch(i,t,s))return!0;if(this.in_govni.ProcTouch(i,t,s))return!0;if(this.btn_find.ProcTouch(i,t,s))return this.btn_find.bCheck()&&(this.in_govni.sDetail.length>0?(Mh.gi().s_NewGovOperate(0,0,0,0,0,this.in_govni.sDetail),Mh.gi().s_NewGovOperate(2,0,0,0,0,""),this.ui_govlist.iLockPoint=-1):L.easymsg.AddMessage("请先输入搜索内容")),!0;if(this.ui_govlist.iLockPoint>=0&&this.ui_govlist.iLockPoint<this.iGovCount){var e=this.ui_govlist.iLockPoint;if(this.btn_callmaster.ProcTouch(i,t,s))return this.btn_callmaster.bCheck()&&dt.OpenChat(this.govlist[e].iMasterId,this.govlist[e].sMaster,6),!0;if(-1==Fi.mg.iRealGid){if(this.btn_applyone.ProcTouch(i,t,s))return this.btn_applyone.bCheck()&&(xh.me.rbs.iLev<20?Z.fm.Open("达到20级才能申请入帮"):(Mh.gi().s_ApplyForGov(this.govlist[e].iGovId),this.govlist[e].bApplyed=!this.govlist[e].bApplyed)),!0}else if(this.btn_getingov.ProcTouch(i,t,s))return this.btn_getingov.bCheck()&&(ln.gi().PopStat(1),Mh.gi().s_GetIntoGov(this.govlist[e].iGovId)),!0}if(-1==Fi.mg.iRealGid){if(this.btn_applyall.ProcTouch(i,t,s))return this.btn_applyall.bCheck()&&(xh.me.rbs.iLev<20?Z.fm.Open("达到20级才能申请入帮"):this.bApplyAll=!0),!0;if(this.btn_creategov.ProcTouch(i,t,s))return this.btn_creategov.bCheck()&&Z.fm.Open("集齐七国旗后可以找郢城的帮派总管创建帮派"),!0}return this.btn_close.ProcTouch(i,t,s)&&this.btn_close.bCheck()&&ln.gi().PopStat(1),!1}}Ga.Applyed=function(i){var t;null!=(t=ln.gi().FindStat(ln.GS_APPLYFORGOV))&&t.ApplyedGovs(i)},Ga.Get=function(i){var t;null!=(t=ln.gi().FindStat(ln.GS_APPLYFORGOV))&&t.GetGovDetail(i)},Ga.Open=function(i){(ln.gi().iXStat!=ln.GS_APPLYFORGOV?ln.gi().PushStat(ln.GS_APPLYFORGOV):ln.gi().LastStat(0)).GetIdList(i)};class Ea extends s{constructor(i){var t;for(super(),this.iW=750,this.iH=480,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.iCount=new Int32Array(3),this.btn_hire=new Array(3),t=0;t<3;t++)this.btn_hire[t]=new Eh(gn.xani_button),this.btn_hire[t].sName="雇佣",this.btn_hire[t].InitButton("普通按钮140_55")}Draw(){E.frame_type4("中等框a52_50",this.iX,this.iY,this.iW,this.iH,52,50),0==this.iType?this.Draw_0():this.Draw_1()}Draw_0(){var i,t;c.gi().DrawTextEx(this.iX+30,this.iY+30,"我这里的工人无所不能！",4278410564,30,101,1,1,0,0,0),c.gi().DrawTextEx(this.iX+30,this.iY+30+40,"当前正在工作的普通工人"+this.iCount[0]+"名，高级工人"+this.iCount[1]+"名，特殊工人"+this.iCount[2]+"名",4279586904,20,101,1,1,0,0,0),c.gi().DrawTextEx(this.iX+30,this.iY+30+80,"维护时增加"+this.iAdd+"建筑进度",4279586904,20,101,1,1,0,0,0),i=this.iX+30,t=this.iY+150,this.DrawEntry(0,i,t,"普通工人","6万铜币(获得60帮贡)"),this.DrawEntry(1,i,t+100,"高级工人","12万铜币(获得90帮贡)"),this.DrawEntry(2,i,t+200,"特殊工人","20元宝(获得120帮贡)")}Draw_1(){var i,t;c.gi().DrawTextEx(this.iX+30,this.iY+30,"我这里的商人个个都是好手！",4278410564,30,101,1,1,0,0,0),c.gi().DrawTextEx(this.iX+30,this.iY+30+40,"当前正在工作的普通商人"+this.iCount[0]+"名，高级商人"+this.iCount[1]+"名，特殊商人"+this.iCount[2]+"名",4279586904,20,101,1,1,0,0,0),c.gi().DrawTextEx(this.iX+30,this.iY+30+80,"维护时恢复"+this.iAdd+"帮派资金",4279586904,20,101,1,1,0,0,0),i=this.iX+30,t=this.iY+150,this.DrawEntry(0,i,t,"普通商人","6万铜币(获得60帮贡)"),this.DrawEntry(1,i,t+100,"高级商人","12万铜币(获得90帮贡)"),this.DrawEntry(2,i,t+200,"特殊商人","20元宝(获得120帮贡)")}DrawEntry(i,t,s,e,h){E.frame_type1("帮派福利条a20_92",t,s,690,20),gn.xani_icon.DrawAnima_aa(t+20,s+9.5,e,0),c.gi().DrawText_2(t+20+73+20,s+46,e,4294967040,30,101,1,1,0,0,-2,4,4289034305),h.length>0&&c.gi().DrawTextEx(t+20+73+20+160,s+46,h,4278190080,20,101,1,1,0,0,-2),this.btn_hire[i].Move(t+690-20-140,s+18.5,140,55),this.btn_hire[i].Draw()}ProcTouch(i,t,s){var e;for(e=0;e<3;e++)if(this.btn_hire[e].ProcTouch(i,t,s)){this.btn_hire[e].bCheck()&&(Mh.gi().s_HireWorker(this.iType,e,24),ln.gi().PopStat(1));break}return bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||3!=i||ln.gi().PopStat(1),!1}}Ea.Open=function(i){if(0==i.GetNextInt()){var t=ln.gi().PushStat(ln.GS_HIRETRADERWORKER);t.iType=i.GetNextInt(),t.iCount[0]=i.GetNextInt(),t.iCount[1]=i.GetNextInt(),t.iCount[2]=i.GetNextInt(),t.iAdd=i.GetNextInt()}};class Oa{constructor(){this.Clear()}Clear(){this.iMoney=0,this.iIngot=0,this.iGovTick=0}}class Fa extends s{_Open(i){var t,s,e;for(this.iShopId=i.GetNextInt(),this.sName=i.GetNextString(),t=0;t<20;t++)if(this.goods[t].iGid=-1,this.goods[t].iTid=i.GetNextInt(),0!=this.goods[t].iTid){for(this.goods[t].iGid=1,this.goods[t].iCount=i.GetNextByte(),this.iOnceBuyCount[t]=i.GetNextByte(),e=i.GetNextByte(),s=0;s<8;s++)0!=(e&1<<s)&&(this.goods[t].iAtts[s]=i.GetNextInt());gn.xani_ngoods.InitAnimaWithName(gn.de_goods.strValue(this.goods[t].iTid,0,10),this.goods[t].aa),e=i.GetNextShort(),this.price[t].iFlag=e,0!=(1&e)&&(this.price[t].iMoney=i.GetNextInt()),0!=(2&e)&&(this.price[t].iIngot=i.GetNextInt()),0!=(4&e)&&(this.price[t].iGovTick=i.GetNextInt()),0!=(8&e)&&i.GetNextInt(),0!=(16&e)&&i.GetNextInt(),0!=(32&e)&&i.GetNextInt(),0!=(64&e)&&i.GetNextInt(),0!=(128&e)&&i.GetNextInt(),0!=(256&e)&&i.GetNextInt(),0!=(512&e)&&i.GetNextInt(),0!=(1024&e)&&i.GetNextInt(),0!=(2048&e)&&i.GetNextInt(),0!=(4096&e)&&i.GetNextInt(),0!=(8192&e)&&i.GetNextInt(),0!=(16384&e)&&i.GetNextInt(),0!=(32768&e)&&i.GetNextInt(),this.price[t].iLable=i.GetNextByte()}null!=this.lockgoods&&this.lockgoods.iGid<=0&&(this.lockgoods=null,qi.Reset())}constructor(i){var t;for(super(),this.goods=new Array(20),this.price=new Array(20),this.iOnceBuyCount=new Int32Array(20),t=0;t<20;t++)this.goods[t]=new Li,this.goods[t].iPos=t,this.price[t]=new Oa;this.pani=i,this.pm3f=i.pm3f,this.iW=710,this.iH=405,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.lockgoods=null,this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_buy=new Eh(gn.xani_nui2),this.btn_buy.InitButton("按钮1_110"),this.btn_buy.sName="购买",this.btn_buy.Move(this.iX+this.iW-110-30,this.iY+this.iH-52-30,110,52),this.in_count=new vs(gn.xani_nui3),this.in_count.iNumber=1}Draw(){var i,t,s,e,h,a;for(E.new_bigframe(this.iX,this.iY,this.iW,this.iH),this.btn_close.Draw(),this.pm3f.DrawTextEx(this.iX+430+30+15,this.iY+35,this.sName,4278206039,30,101,1,1,0,0,0),qi.new_DrawGoods(this.iX+30,this.iY+30,this.goods,null,null),h=this.iX+30+5,a=this.iY+30+5,i=0;i<5;i++)for(t=0;t<4;t++)s=h+85*i,e=a+85*t,-1!=this.goods[5*t+i].iGid&&this.price[5*t+i].iLable>0&&gn.xani_other.DrawAnima(s,e,"商店标签"+this.price[5*t+i].iLable,0);null!=this.lockgoods&&(qi.new_DrawRect(this.iX+30,this.iY+30,this.goods,this.lockgoods,0),h=this.iX+430+30+15,a=this.iY+80,this.pm3f.DrawTextEx(h,a,"名称："+gn.de_goods.strValue(this.lockgoods.iTid,0,4),4278206039,25,101,1,1,0,0,0),a+=30,this.pm3f.DrawTextEx(h,a,"单价：",4278206039,25,101,1,1,0,0,0),a+=30,t=this.lockgoods.iPos,0!=(1&this.price[t].iFlag)&&(this.pm3f.DrawTextEx(h+20,a,"铜币："+this.price[t].iMoney,4278206039,25,101,1,1,0,0,0),a+=30),0!=(2&this.price[t].iFlag)&&(this.pm3f.DrawTextEx(h+20,a,"元宝："+this.price[t].iIngot,4278206039,25,101,1,1,0,0,0),a+=30),0!=(4&this.price[t].iFlag)&&(this.pm3f.DrawTextEx(h+20,a,"帮贡："+this.price[t].iGovTick,4278206039,25,101,1,1,0,0,0),a+=30),this.pm3f.DrawTextEx(h,a,"数量：",4278206039,25,101,1,1,0,0,0),a+=30,this.in_count.Move(h+20,a,100),this.in_count.Draw()),this.btn_buy.bDisable&&(this.iBuyDelay--,this.iBuyDelay<=0&&(this.btn_buy.bDisable=!1)),this.btn_buy.Draw(),qi.bShowDetail()&&qi.new_DrawDetail(null,-1,-1,0)}ProcTouch(i,t,s){var e,h;if(null!=this.lockgoods){if(this.in_count.ProcTouch(i,t,s))return!0;if(this.btn_buy.ProcTouch(i,t,s))return this.btn_buy.bCheck()&&(e=this.lockgoods.iPos,this.in_count.iNumber<=0?L.easymsg.AddMessage("购买数量不能为0"):this.in_count.iNumber>this.iOnceBuyCount[e]?L.easymsg.AddMessage("购买数量超过单次可购买上限"):this.in_count.iNumber>this.lockgoods.iCount?L.easymsg.AddMessage("购买数量超过上限"):0!=(1&this.price[e].iFlag)&&xh.me.rbs.iMoney<this.price[e].iMoney*this.in_count.iNumber?L.easymsg.AddMessage("铜币不足"):0!=(2&this.price[e].iFlag)&&xh.me.rbs.iInGot<this.price[e].iIngot*this.in_count.iNumber?L.easymsg.AddMessage("铜币不足"):0!=(4&this.price[e].iFlag)&&Fi.mg.iTick<this.price[e].iGovTick*this.in_count.iNumber?L.easymsg.AddMessage("帮贡不足"):(Mh.gi().s_NewShopBuy(this.iShopId,this.lockgoods.iPos,this.lockgoods.iTid,this.in_count.iNumber),this.btn_buy.bDisable=!0,this.iBuyDelay=30)),!0}return h=qi.new_LockGoods(t,s,this.iX+30,this.iY+30,this.goods,i),qi.NoMove(),3==i&&null!=h?(h!=this.lockgoods&&(this.in_count.iNumber=1),this.lockgoods=h,(e=this.lockgoods.iCount)>this.iOnceBuyCount[this.lockgoods.iPos]&&(e=this.iOnceBuyCount[this.lockgoods.iPos]),this.in_count.MinMax(1,e)):null==h&&(this.lockgoods=null),this.btn_close.ProcTouch(i,t,s)?(this.btn_close.bCheck()&&ln.gi().PopStat(1),!0):(3!=i||bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||ln.gi().PopStat(1),!1)}}Fa.Open=function(i){var t;null==(t=ln.gi().FindStat(ln.GS_NEWSHOP))&&(t=ln.gi().PushStat(ln.GS_NEWSHOP)),t._Open(i)};class Xa extends s{constructor(i){var t;for(super(),this.iW=640,this.iH=560,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_select=new Array(4),t=0;t<4;t++)this.btn_select[t]=new Eh(gn.xani_icon),this.btn_select[t].InitButton(_FOUR[t]);this.btn_ok=new Eh(gn.xani_button),this.btn_ok.InitButton("普通按钮140_55"),this.btn_ok.sName="确定",this.btn_cancel=new Eh(gn.xani_button),this.btn_cancel.InitButton("普通按钮140_55"),this.btn_cancel.sName="取消",this.in_ingot=new vs(gn.xani_nui3),this.in_ingot.iNumber=0,this.in_ingot.MinMax(0,200),this.in_money=new vs(gn.xani_nui3),this.in_money.iNumber=0,this.in_money.MinMax(0,2e6),this.in_count=new vs(gn.xani_nui3),this.in_count.iNumber=1,this.in_count.MinMax(1,20)}Draw(){var i,t,s;for(E.frame_type4("中等框a52_50",this.iX,this.iY,this.iW,this.iH,52,50),c.gi().DrawTextEx(this.iX+this.iW/2,this.iY+20+15,"发布委托",4278213441,30,101,1,1,0,-2,-2),t=this.iX+30,s=this.iY+20+30+20,c.gi().DrawTextEx(t,s,"任务类型:",4278190080,25,101,1,1,0,0,0),s+=35,i=0;i<4;i++)this.btn_select[i].Move(t+50+130*i,s,73,73),this.btn_select[i].Draw(),c.gi().DrawTextEx(this.btn_select[i].iX+this.btn_select[i].iW/2,this.btn_select[i].iY+this.btn_select[i].iH+5,_FOUR[i],4278190080,25,101,1,1,0,-2,0),this.iMissionType==i&&E.frame_type2("黄色透明框a25_25",this.btn_select[i].iX,this.btn_select[i].iY,73,73,25,25);s+=123,c.gi().DrawTextEx(t,s,"委托花费:",4278190080,25,101,1,1,0,0,0),s+=40,c.gi().DrawTextEx(t+40,s,"元宝:",4278190080,25,101,1,1,0,0,0),this.in_ingot.Move(t+40+70,s+-11,140),this.in_ingot.Draw(),i=(i=5*this.in_ingot.iNumber/100)<1?1:i,0==this.in_ingot.iNumber&&(i=0),c.gi().DrawTextEx(t+40+70+150,s,"(额外收取手续费"+i+"元宝)",4278190080,25,101,1,1,0,0,0),s+=55,i=(i=5*this.in_money.iNumber/100)<1e4?1e4:i,0==this.in_money.iNumber&&(i=0),c.gi().DrawTextEx(t+40+70+150,s,"(额外收取手续费"+i+"铜币)",4278190080,25,101,1,1,0,0,0),c.gi().DrawTextEx(t+40,s,"铜币:",4278190080,25,101,1,1,0,0,0),this.in_money.Move(t+40+70,s+-11,140),this.in_money.Draw(),s+=60,c.gi().DrawTextEx(t,s,"委托轮数:",4278190080,25,101,1,1,0,0,0),s+=40,c.gi().DrawTextEx(t+40,s,"数量:",4278190080,25,101,1,1,0,0,0),this.in_count.Move(t+40+70,s+-11,140),this.in_count.Draw(),c.gi().DrawTextEx(t+40+70+150,s,"(当前可发布"+this.iCanEntrust+"轮)",4278190080,25,101,1,1,0,0,0),this.btn_ok.Move(this.iX+this.iW-30-140,this.iY+this.iH-30-55,140,55),this.btn_ok.Draw(),this.btn_cancel.Move(this.iX+30,this.iY+this.iH-30-55,140,55),this.btn_cancel.Draw(),ei.end(ei.CONFIRM_GOVRELEASEENTRUST)&&ei.bConfirm&&(Mh.gi().s_NewGovOperate(16,this.iMissionType,this.in_count.iNumber,this.in_ingot.iNumber,this.in_money.iNumber,""),ln.gi().PopStat(1),Mh.gi().s_NewGovOperate(14,100,0,0,0,""))}ProcTouch(i,t,s){var e,h;if(this.in_count.ProcTouch(i,t,s))return this.in_money.bShow=!1,this.in_ingot.bShow=!1,!0;if(this.in_money.ProcTouch(i,t,s))return this.in_count.bShow=!1,this.in_ingot.bShow=!1,!0;if(this.in_ingot.ProcTouch(i,t,s))return this.in_count.bShow=!1,this.in_money.bShow=!1,!0;for(e=0;e<4;e++)if(this.btn_select[e].ProcTouch(i,t,s))return this.btn_select[e].bCheck()&&(this.iMissionType=e),!0;return this.btn_ok.ProcTouch(i,t,s)&&this.btn_ok.bCheck()&&(0==this.in_ingot.iNumber?e=0:((e=5*this.in_ingot.iNumber/100)<1&&(e=1),e+=this.in_ingot.iNumber,e*=this.in_count.iNumber),0==this.in_money.iNumber?h=0:((h=5*this.in_money.iNumber/100)<1e4&&(h=1e4),h+=this.in_money.iNumber,h*=this.in_count.iNumber),0==e&&0==h?L.easymsg.AddMessage("请先设置委托奖励"):xh.me.rbs.iInGot<e?Z.fm.Open("元宝不足"):xh.me.rbs.iMoney<h?Z.fm.Open("铜币不足"):ei.start(ei.CONFIRM_GOVRELEASEENTRUST,"发布"+this.in_count.iNumber+"轮"+_FOUR[this.iMissionType]+"共需花费"+e+"元宝，"+h+"铜币#e#e撤销委托不退还手续费，是否确定发布？")),this.btn_cancel.ProcTouch(i,t,s)&&this.btn_cancel.bCheck()&&ln.gi().PopStat(1),bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||3!=i||ln.gi().PopStat(1),!1}}Xa._FOUR=["朱雀任务","青龙任务","白虎任务","玄武任务"],Xa.Open=function(i,t,s){var e;ln.gi().iXStat!=ln.GS_RELEASEGOVMISSION&&((e=ln.gi().PushStat(ln.GS_RELEASEGOVMISSION)).iMissionType=i,e.iCanEntrust=t,e.iMaxCanEntrust=s,e.in_count.MinMax(1,t))};class Ya extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=460,this.iH=350,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_get=new D(gn.xani_button),this.btn_get.InitButton("统一大按钮2"),this.btn_get.Move(this.iX+this.iW-60-5,this.iY,60,60),this.btn_get.sName="签到",this.iNeedDay=new Int32Array(6),this.sGiveDetail=new Array(6)}Draw(){var i,t,s,h,a,n,o,r;for(E.Frame2_MD(this.iX,this.iY,this.iW,this.iH),a=this.iX+20,n=this.iY+20,o=200,r=230,c.gi().FillRect_2D(a,n,a+o,n+r,536870912),s=0==this.iWeek?7:this.iWeek,h=0,i=0;i<7;i++)(t=0==i?7:i)<s?(c.gi().DrawTextEx(a+10,n+10+30*t-30,"周"+e.sWeek[t],4278190080,20,101,1,1,0,0,0),0==(this.iFlag19&1<<i)?c.gi().DrawTextEx(a+10+120,n+10+30*t-30,"未签到",4294901760,20,101,1,1,0,0,0):(c.gi().DrawTextEx(a+10+120,n+10+30*t-30,"已签到",4278255360,20,101,1,1,0,0,0),h++)):s==t?(c.gi().FillRect_2D(a+10,n+10+30*t-30,a+o-10,n+10+30*t-30+20,536870912),c.gi().DrawTextEx(a+10,n+10+30*t-30,"周"+e.sWeek[t],4278190080,20,101,1,1,0,0,0),0!=(this.iFlag19&1<<i)&&(c.gi().DrawTextEx(a+10+120,n+10+30*t-30,"已签到",4278255360,20,101,1,1,0,0,0),h++)):c.gi().DrawTextEx(a+10,n+10+30*t-30,"周"+e.sWeek[t],4278190080,20,101,1,1,0,0,0);n+=r,c.gi().DrawTextEx(a+10,n+10,"当前活跃度"+this.iAct,4278190080,30,101,1,1,0,0,0),c.gi().DrawTextEx(a+10,n+50,"活跃度达到"+this.iNeedAct+"可签到",4278190080,20,101,1,1,0,0,0),a+=220,n=this.iY+20,c.gi().FillRect_2D(a,n,a+o,n+r,536870912);var l="#cffff00本周已累计签到"+h+"次#e#e#c000000";for(i=0;i<this.iGiveCount;i++)l+="累计签到"+this.iNeedDay[i]+"次可获得:#e"+this.sGiveDetail[i],l+="#e#e";Y.gi().Format(l,180,20),Y.gi().Draw(a+10,n+10),n+=r,this.btn_get.Move(a+100-40,n+20,80,50),this.btn_get.Draw()}ProcTouch(i,t,s){return this.btn_get.ProcTouch(i,t,s)?(this.btn_get.bCheck()&&(this.iAct<this.iNeedAct?L.easymsg.AddMessage("活跃度未达不能签到"):(Mh.gi().s_GetCodeReward(3,""),ln.gi().PopStat(1))),!0):(3!=i||bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||ln.gi().PopStat(1),!1)}}Ya.Open=function(i){var t,s=ln.gi().PushStat(ln.GS_DAYATTEND);for(s.iWeek=i.GetNextByte(),s.iFlag19=i.GetNextInt(),s.iAct=i.GetNextInt(),s.iNeedAct=i.GetNextInt(),s.iGiveCount=i.GetNextByte(),t=0;t<s.iGiveCount;t++)s.iNeedDay[t]=i.GetNextByte(),s.sGiveDetail[t]=i.GetNextString()};class Wa extends s{constructor(i){super(),this.iW=500,this.iH=320,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new Eh(gn.xani_button),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.iColor=new Int32Array(6)}Draw(){var i,t=200;for(E.frame_type4("10号框20_20",this.iX,this.iY,this.iW,this.iH,20,20),this.btn_close.Draw(),G.DrawAura(0,this.iX+30+100,this.iY+this.iH-30-30-60,null,0),gn.xani_newrole[this.iRas].DrawAnima(this.iX+30+100,this.iY+this.iH-30-30-60,"站立_下",gn.iDelay/2),i=0;i<N._CHANGECOLOR[this.iRas].length;i++)this.iColor[i]<=0||gn.xani_color[this.iRas][this.iColor[i]-1].DrawAnima(this.iX+30+100,this.iY+this.iH-30-30-60,N._CHANGECOLOR[this.iRas][i]+"_站立_下",gn.iDelay/2);gn.xani_weap[this.iRas][N.WeapFlag(this.iWeapId)].DrawAnima(this.iX+30+100,this.iY+this.iH-30-30-60,"站立_下",gn.iDelay/2),E.frame_type1("4号框20_30",this.iX+30,this.iY+this.iH-30-30,t,20),c.gi().DrawTextEx(this.iX+30+100,this.iY+this.iH-30-15,this.sName,4294967295,24,101,1,1,0,-2,-2),0==this.iRank?c.gi().DrawText_2(this.iX+30+t+30,this.iY+30,"未上榜",4294962302,24,101,1,1,0,0,0,3,4278261038):1==this.iRank?c.gi().DrawText_2(this.iX+30+t+30,this.iY+30,"超越下一名："+this.iGap,4294962302,24,101,1,1,0,0,0,3,4278261038):c.gi().DrawText_2(this.iX+30+t+30,this.iY+30,"距离上一名："+this.iGap,4294962302,24,101,1,1,0,0,0,3,4278261038),c.gi().DrawText_2(this.iX+30+t+30,this.iY+30+30,"综合评分："+this.iComplexScore,4294962302,24,101,1,1,0,0,0,3,4278261038),E.frame_type4("11号框20_20",this.iX+30+t+30,this.iY+30+60,this.iW-30-t-30-30,(this.iH-30-60-30-20)/2,20,20),c.gi().DrawTextEx(this.iX+30+t+30+15,this.iY+30+60+15,"人物评分："+this.iScore,4279389280,20,101,1,1,0,0,0),Y.gi().Format("#c124c60(与等级，技能，修炼，装备，阵法相关)",this.iW-30-t-30-30-30,16),Y.gi().Draw(this.iX+30+t+30+15,this.iY+30+60+15+25),E.frame_type4("11号框20_20",this.iX+30+t+30,this.iY+30+60+(this.iH-30-60-30-20)/2+20,this.iW-30-t-30-30,(this.iH-30-60-30-20)/2,20,20),c.gi().DrawTextEx(this.iX+30+t+30+15,this.iY+30+60+15+(this.iH-30-60-30-20)/2+20,"宠物评分："+(this.iComplexScore-this.iScore),4279389280,20,101,1,1,0,0,0),Y.gi().Format("#c124c60(与携带评分最高的四只宠物相关)",this.iW-30-t-30-30-30,16),Y.gi().Draw(this.iX+30+t+30+15,this.iY+30+60+15+25+(this.iH-30-60-30-20)/2+20)}ProcTouch(i,t,s){return!(!this.btn_close.ProcTouch(i,t,s)||!this.btn_close.bCheck())&&(ln.gi().PopStat(1),!0)}}Wa.Open=function(i,t,s,e,h,a,n,o,r){var c=ln.gi().PushStat(ln.GS_LEADERBOARDROLE);c.iRid=i,c.sName=t,c.iComplexScore=s,c.iScore=e,c.iPetScore=s-e,c.iRas=h,c.iWeapId=n,c.iRank=o,c.iGap=r,c.iColor[0]=7&a,c.iColor[1]=a>>3&7,c.iColor[2]=a>>6&7,c.iColor[3]=a>>9&7,c.iColor[4]=a>>12&7};class La{constructor(){}}class Ha{constructor(){this.iComplexScore=0,this.iScore=0}}class Ba{constructor(){}}class Va extends s{constructor(i){var t;for(super(),this._titles=[["七国第一","七国英杰","七国才俊"],["独占鳌头","超群绝伦","出类拔萃"],["驯兽大师","驯兽达人","驯兽有方"],["会当凌绝顶","山高我为峰","高处不胜寒"],["锻器大师","锻器达人","锻器有方"],["富甲天下","富可敌国","家财万贯"],["壕气冲天","威风壕壕","英雄壕杰"]],this.iLW=660,this.iW=340+this.iLW,this.iH=530,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.iShowH=this.iH-80,this.iDestH=0,this.btn_close=new Eh(gn.xani_button),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_grsl=new Eh(gn.xani_button),this.btn_grsl.InitButton("6号按钮210_60"),this.btn_grsl.sName="个人实力",this.btn_zhpf=new Eh(gn.xani_button),this.btn_zhpf.InitButton("7号按钮180_60"),this.btn_zhpf.sName="综合评分",this.btn_rwpf=new Eh(gn.xani_button),this.btn_rwpf.InitButton("7号按钮180_60"),this.btn_rwpf.sName="人物评分",this.btn_cwpf=new Eh(gn.xani_button),this.btn_cwpf.InitButton("7号按钮180_60"),this.btn_cwpf.sName="宠物评分",this.btn_dj=new Eh(gn.xani_button),this.btn_dj.InitButton("7号按钮180_60"),this.btn_dj.sName="等级",this.btn_jssb=new Eh(gn.xani_button),this.btn_jssb.InitButton("6号按钮210_60"),this.btn_jssb.sName="绝世神兵",this.btn_wq=new Eh(gn.xani_button),this.btn_wq.InitButton("7号按钮180_60"),this.btn_wq.sName="武器",this.btn_xl=new Eh(gn.xani_button),this.btn_xl.InitButton("7号按钮180_60"),this.btn_xl.sName="项链",this.btn_yf=new Eh(gn.xani_button),this.btn_yf.InitButton("7号按钮180_60"),this.btn_yf.sName="衣服",this.btn_tk=new Eh(gn.xani_button),this.btn_tk.InitButton("7号按钮180_60"),this.btn_tk.sName="头盔",this.btn_yd=new Eh(gn.xani_button),this.btn_yd.InitButton("7号按钮180_60"),this.btn_yd.sName="腰带",this.btn_xz=new Eh(gn.xani_button),this.btn_xz.InitButton("7号按钮180_60"),this.btn_xz.sName="鞋子",this.btn_bwjfb=new Eh(gn.xani_button),this.btn_bwjfb.InitButton("6号按钮210_60"),this.btn_bwjfb.sName="比武积分榜",this.btn_49z=new Eh(gn.xani_button),this.btn_49z.InitButton("7号按钮180_60"),this.btn_49z.sName="上届49组",this.btn_69z=new Eh(gn.xani_button),this.btn_69z.InitButton("7号按钮180_60"),this.btn_69z.sName="上届69组",this.btn_89z=new Eh(gn.xani_button),this.btn_89z.InitButton("7号按钮180_60"),this.btn_89z.sName="上届80组",this.btn_qgyh=new Eh(gn.xani_button),this.btn_qgyh.InitButton("6号按钮210_60"),this.btn_qgyh.sName="七国英豪",this.btn_49t=new Eh(gn.xani_button),this.btn_49t.InitButton("7号按钮180_60"),this.btn_49t.sName="49组",this.btn_69t=new Eh(gn.xani_button),this.btn_69t.InitButton("7号按钮180_60"),this.btn_69t.sName="69组",this.btn_89t=new Eh(gn.xani_button),this.btn_89t.InitButton("7号按钮180_60"),this.btn_89t.sName="80组",this.btn_cfb=new Eh(gn.xani_button),this.btn_cfb.InitButton("6号按钮210_60"),this.btn_cfb.sName="财富榜",this.btn_money=new Eh(gn.xani_button),this.btn_money.InitButton("7号按钮180_60"),this.btn_money.sName="铜币榜",this.btn_ingot=new Eh(gn.xani_button),this.btn_ingot.InitButton("7号按钮180_60"),this.btn_ingot.sName="元宝榜",this.btn_hyb=new Eh(gn.xani_button),this.btn_hyb.InitButton("6号按钮210_60"),this.btn_hyb.sName="活跃榜",this.btn_thisweek=new Eh(gn.xani_button),this.btn_thisweek.InitButton("7号按钮180_60"),this.btn_thisweek.sName="本周活跃榜",this.btn_previousweek=new Eh(gn.xani_button),this.btn_previousweek.InitButton("7号按钮180_60"),this.btn_previousweek.sName="上周活跃榜",this.equip_list=new Array(50),this.role_list=new Array(50),this.pet_list=new Array(50),t=0;t<50;t++)this.equip_list[t]=new La,this.role_list[t]=new Ha,this.pet_list[t]=new Ba;for(this.ui_equip=new Oi(0,4,this.iW-25-25-20-240-30,this.iH-50-30),this.ui_equip.SetTitle(0,"排名",160,!1),this.ui_equip.SetTitle(1,"神兵名称",170,!1),this.ui_equip.SetTitle(2,"拥有者",170,!1),this.ui_equip.SetTitle(3,"评分",160,!1),this.ui_role=new Oi(0,4,this.iW-25-25-20-240-30,this.iH-50-30),this.ui_role.SetTitle(0,"排名",160,!1),this.ui_role.SetTitle(1,"角色名称",170,!1),this.ui_role.SetTitle(2,"门派",170,!1),this.ui_role.SetTitle(3,"评分",160,!1),this.ui_pet=new Oi(0,4,this.iW-25-25-20-240-30,this.iH-50-30),this.ui_pet.SetTitle(0,"排名",160,!1),this.ui_pet.SetTitle(1,"宠物名称",170,!1),this.ui_pet.SetTitle(2,"主人名称",170,!1),this.ui_pet.SetTitle(3,"评分",160,!1),this.iSelect1=0,this.iSelect2=0,this.iRoleCount=0,this.iPetCount=0,this.iEquipCount=0,Mh.gi().s_LeaderBoardFresh(0,this.iSelect1,this.iSelect2),xh.me.CalcUserScore(),this.btn_explain=new Array(3),t=0;t<3;t++)this.btn_explain[t]=new Eh(gn.xani_button),this.btn_explain[t].InitButton("5号按钮30_30"),this.btn_explain[t].Move(0,0,30,30);this.btn_getprice=new Eh(gn.xani_button),this.btn_getprice.InitButton("3号按钮160_42"),this.btn_getprice.sName="领取奖励",this.aa_icon=gn.xani_frame.InitAnimaWithName("皇冠图标38_32",null),this.btn_self=new Eh(gn.xani_button),this.btn_self.bSingleButton=!0,this.iOffY=0,this.bLocked1=!1}Draw(){var i;E.new_baseframe3(this.iX,this.iY,this.iW,this.iH,"排","行","榜"),this.btn_close.Draw(),this.bLocked1||(this.iOffY>0&&(this.iOffY/=2),this.iOffY<0&&this.iDestH<this.iY+this.iH-40&&(i=this.iY+this.iH-40-this.iDestH,this.iOffY+=i/2)),E.new_framein(this.iX+25,this.iY+25,240,this.iH-50),c.gi().SetViewClip(this.iX+40,this.iY+40,this.iX+40+210,this.iY+this.iH-40);var t=this.iX+25+15,s=this.iY+25+15+this.iOffY;this.btn_grsl.Move(t,s,210,60),0==this.iSelect1&&this.btn_grsl.setdown(),this.btn_grsl.Draw(),s+=60,0==this.iSelect1&&(this.btn_zhpf.Move(t+15,s,180,60),0==this.iSelect2&&this.btn_zhpf.setdown(),this.btn_zhpf.Draw(),s+=60,this.btn_rwpf.Move(t+15,s,180,60),1==this.iSelect2&&this.btn_rwpf.setdown(),this.btn_rwpf.Draw(),s+=60,this.btn_cwpf.Move(t+15,s,180,60),2==this.iSelect2&&this.btn_cwpf.setdown(),this.btn_cwpf.Draw(),s+=60,this.btn_dj.Move(t+15,s,180,60),3==this.iSelect2&&this.btn_dj.setdown(),this.btn_dj.Draw(),s+=60),this.btn_jssb.Move(t,s,210,60),1==this.iSelect1&&this.btn_jssb.setdown(),this.btn_jssb.Draw(),s+=60,1==this.iSelect1&&(this.btn_wq.Move(t+15,s,180,60),0==this.iSelect2&&this.btn_wq.setdown(),this.btn_wq.Draw(),s+=60,this.btn_xl.Move(t+15,s,180,60),1==this.iSelect2&&this.btn_xl.setdown(),this.btn_xl.Draw(),s+=60,this.btn_yf.Move(t+15,s,180,60),2==this.iSelect2&&this.btn_yf.setdown(),this.btn_yf.Draw(),s+=60,this.btn_tk.Move(t+15,s,180,60),3==this.iSelect2&&this.btn_tk.setdown(),this.btn_tk.Draw(),s+=60,this.btn_yd.Move(t+15,s,180,60),4==this.iSelect2&&this.btn_yd.setdown(),this.btn_yd.Draw(),s+=60,this.btn_xz.Move(t+15,s,180,60),5==this.iSelect2&&this.btn_xz.setdown(),this.btn_xz.Draw(),s+=60),this.btn_bwjfb.Move(t,s,210,60),2==this.iSelect1&&this.btn_bwjfb.setdown(),this.btn_bwjfb.Draw(),s+=60,2==this.iSelect1&&(this.btn_49z.Move(t+15,s,180,60),0==this.iSelect2&&this.btn_49z.setdown(),this.btn_49z.Draw(),s+=60,this.btn_69z.Move(t+15,s,180,60),1==this.iSelect2&&this.btn_69z.setdown(),this.btn_69z.Draw(),s+=60,this.btn_89z.Move(t+15,s,180,60),2==this.iSelect2&&this.btn_89z.setdown(),this.btn_89z.Draw(),s+=60),this.btn_qgyh.Move(t,s,210,60),3==this.iSelect1&&this.btn_qgyh.setdown(),this.btn_qgyh.Draw(),s+=60,3==this.iSelect1&&(this.btn_49t.Move(t+15,s,180,60),0==this.iSelect2&&this.btn_49t.setdown(),this.btn_49t.Draw(),s+=60,this.btn_69t.Move(t+15,s,180,60),1==this.iSelect2&&this.btn_69t.setdown(),this.btn_69t.Draw(),s+=60,this.btn_89t.Move(t+15,s,180,60),2==this.iSelect2&&this.btn_89t.setdown(),this.btn_89t.Draw(),s+=60),this.btn_cfb.Move(t,s,210,60),5==this.iSelect1&&this.btn_cfb.setdown(),this.btn_cfb.Draw(),s+=60,5==this.iSelect1&&(this.btn_money.Move(t+15,s,180,60),0==this.iSelect2&&this.btn_money.setdown(),this.btn_money.Draw(),s+=60,this.btn_ingot.Move(t+15,s,180,60),1==this.iSelect2&&this.btn_ingot.setdown(),this.btn_ingot.Draw(),s+=60),this.btn_hyb.Move(t,s,210,60),6==this.iSelect1&&this.btn_hyb.setdown(),this.btn_hyb.Draw(),s+=60,6==this.iSelect1&&(this.btn_thisweek.Move(t+15,s,180,60),0==this.iSelect2&&this.btn_thisweek.setdown(),this.btn_thisweek.Draw(),s+=60,this.btn_previousweek.Move(t+15,s,180,60),1==this.iSelect2&&this.btn_previousweek.setdown(),this.btn_previousweek.Draw(),s+=60),this.iDestH=s,c.gi().NoClip();var h=this.iW-25-25-20-240;if(E.new_framein(this.iX+25+240+20,this.iY+25,h,this.iH-50),t=this.iX+25+240+20,s=this.iY+25,this.myrank=-1,0==this.iSelect1)if(2!=this.iSelect2){for(3==this.iSelect2?this.ui_role.SetTitle(3,"等级",160,!1):this.ui_role.SetTitle(3,"评分",160,!1),this.ui_role.BeginDraw(t+15,s+15),i=0;i<this.iRoleCount+1;i++)if(i<this.iRoleCount&&this.role_list[i].iRid==xh.me.iRid&&(this.myrank=i),this.ui_role.bShow(i)){if(i==this.iRoleCount){this.ui_role.DrawUnit(0,i,"");break}switch(this.ui_role.DrawUnit(0,i,""+(i+1)),i<3&&(this.aa_icon.iFrame=i,this.ui_role.DrawUnitEx_Anima(0,i,this.aa_icon,61,4),this.ui_role.DrawUnitEx_Button(0,i,this.btn_explain[i],100,5)),this.role_list[i].iInitProc){case 0:Mh.gi().s_LeaderBoardFresh(2,this.role_list[i].iRid,0),this.role_list[i].iInitProc=1;break;case 1:this.ui_role.DrawUnit(1,i,"获取中...");break;case 2:this.ui_role.DrawUnit(1,i,this.role_list[i].sName),this.ui_role.DrawUnit(2,i,e.sSchools[this.role_list[i].iSchoolId]),0==this.iSelect2?this.ui_role.DrawUnit(3,i,""+this.role_list[i].iComplexScore):1==this.iSelect2?this.ui_role.DrawUnit(3,i,""+this.role_list[i].iScore):3==this.iSelect2&&this.ui_role.DrawUnit(3,i,""+this.role_list[i].iLev)}}this.ui_role.FinishDraw(),s+=410,this.btn_self.Move(t+15,s+15,this.iLW,40),E.frame_type4("22号框20_20",t+15,s+15,this.iLW,40,20,20),this.myrank>=0?this.myrank<3?this.aa_icon.Draw(this.ui_role.OffX(0)-19,s+15+20-16,this.myrank):c.gi().DrawTextEx(this.ui_role.OffX(0),s+15+20,""+(this.myrank+1),4294967295,20,101,1,1,0,-2,-2):c.gi().DrawTextEx(this.ui_role.OffX(0),s+15+20,"未上榜",4294967295,20,101,1,1,0,-2,-2),c.gi().DrawTextEx(this.ui_role.OffX(1),s+35,xh.me.sName,4294967295,20,101,1,1,0,-2,-2),c.gi().DrawTextEx(this.ui_role.OffX(2),s+35,e.sSchools[xh.me.rbs.iSchoolId],4294967295,20,101,1,1,0,-2,-2),0==this.iSelect2&&c.gi().DrawTextEx(this.ui_role.OffX(3),s+35,""+xh.me.iComplexScore,4294967295,20,101,1,1,0,-2,-2),1==this.iSelect2&&c.gi().DrawTextEx(this.ui_role.OffX(3),s+35,""+xh.me.iScore,4294967295,20,101,1,1,0,-2,-2),3==this.iSelect2&&c.gi().DrawTextEx(this.ui_role.OffX(3),s+35,""+xh.me.rbs.iLev,4294967295,20,101,1,1,0,-2,-2)}else{for(this.ui_pet.BeginDraw(t+15,s+15),i=0;i<this.iPetCount+1;i++)if(this.ui_pet.bShow(i))if(i!=this.iPetCount)switch(this.ui_pet.DrawUnit(0,i,""+(i+1)),i<3&&(this.aa_icon.iFrame=i,this.ui_pet.DrawUnitEx_Anima(0,i,this.aa_icon,61,4),this.ui_pet.DrawUnitEx_Button(0,i,this.btn_explain[i],100,5)),this.pet_list[i].iInitProc){case 0:Mh.gi().s_LeaderBoardFresh(3,this.pet_list[i].iPid,0),this.pet_list[i].iInitProc=1;break;case 1:this.ui_pet.DrawUnit(1,i,"获取中...");break;case 2:this.ui_pet.DrawUnit(1,i,gn.de_pet.strValue(this.pet_list[i].iTid,0,1)),this.ui_pet.DrawUnit(2,i,this.pet_list[i].sOwner),this.ui_pet.DrawUnit(3,i,""+this.pet_list[i].iScore)}else this.ui_pet.DrawUnit(0,i,"");this.ui_pet.FinishDraw()}if(1==this.iSelect1){for(this.ui_equip.BeginDraw(t+15,s+15),i=0;i<this.iEquipCount;i++)if(this.ui_equip.bShow(i))switch(this.ui_equip.DrawUnit(0,i,""+(i+1)),i<3&&(this.aa_icon.iFrame=i,this.ui_equip.DrawUnitEx_Anima(0,i,this.aa_icon,61,4),this.ui_equip.DrawUnitEx_Button(0,i,this.btn_explain[i],100,5)),this.equip_list[i].iInitProc){case 0:Mh.gi().s_LeaderBoardFresh(1,this.equip_list[i].iGid,0),this.equip_list[i].iInitProc=1;break;case 1:this.ui_equip.DrawUnit(1,i,"获取中...");break;case 2:this.ui_equip.DrawUnit(1,i,gn.de_goods.strValue(this.equip_list[i].iTid,0,4)),this.ui_equip.DrawUnit(2,i,this.equip_list[i].sOwner),this.ui_equip.DrawUnit(3,i,""+this.equip_list[i].iScore)}this.ui_equip.FinishDraw()}if(2==this.iSelect1){for(this.ui_role.SetTitle(3,"积分",160,!1),this.ui_role.BeginDraw(t+15,s+15),i=0;i<this.iRoleCount+1;i++)if(i<this.iRoleCount&&this.role_list[i].iRid==xh.me.iRid&&(this.myrank=i),this.ui_role.bShow(i)){if(i==this.iRoleCount){this.ui_role.DrawUnit(0,i,"");break}switch(this.ui_role.DrawUnit(0,i,""+(i+1)),i<3&&(this.aa_icon.iFrame=i,this.ui_role.DrawUnitEx_Anima(0,i,this.aa_icon,61,4)),this.role_list[i].iInitProc){case 0:Mh.gi().s_LeaderBoardFresh(2,this.role_list[i].iRid,0),this.role_list[i].iInitProc=1;break;case 1:this.ui_role.DrawUnit(1,i,"获取中...");break;case 2:this.ui_role.DrawUnit(1,i,this.role_list[i].sName),this.ui_role.DrawUnit(2,i,e.sSchools[this.role_list[i].iSchoolId]),this.ui_role.DrawUnit(3,i,""+this.role_list[i].iFlag16)}}this.ui_role.FinishDraw(),s+=410,this.btn_self.Move(t+15,s+15,this.iLW,40),E.frame_type4("22号框20_20",t+15,s+15,this.iLW,40,20,20),this.myrank>=0?this.myrank<3?this.aa_icon.Draw(this.ui_role.OffX(0)-19,s+15+20-16,this.myrank):c.gi().DrawTextEx(this.ui_role.OffX(0),s+15+20,""+(this.myrank+1),4294967295,20,101,1,1,0,-2,-2):c.gi().DrawTextEx(this.ui_role.OffX(0),s+15+20,"未上榜",4294967295,20,101,1,1,0,-2,-2),c.gi().DrawTextEx(this.ui_role.OffX(1),s+35,xh.me.sName,4294967295,20,101,1,1,0,-2,-2),c.gi().DrawTextEx(this.ui_role.OffX(2),s+35,e.sSchools[xh.me.rbs.iSchoolId],4294967295,20,101,1,1,0,-2,-2),c.gi().DrawTextEx(this.ui_role.OffX(3),s+35,""+xh.me.iFlag[16],4294967295,20,101,1,1,0,-2,-2)}if(3==this.iSelect1){for(this.ui_role.SetTitle(3,"综合评分",160,!1),this.ui_role.BeginDraw(t+15,s+15),i=0;i<this.iRoleCount+1;i++)if(i<this.iRoleCount&&this.role_list[i].iRid==xh.me.iRid&&(this.myrank=i),this.ui_role.bShow(i)){if(i==this.iRoleCount){this.ui_role.DrawUnit(0,i,"");break}switch(this.ui_role.DrawUnit(0,i,""+(i+1)),i<3&&(this.aa_icon.iFrame=i,this.ui_role.DrawUnitEx_Anima(0,i,this.aa_icon,61,4)),this.role_list[i].iInitProc){case 0:Mh.gi().s_LeaderBoardFresh(2,this.role_list[i].iRid,0),this.role_list[i].iInitProc=1;break;case 1:this.ui_role.DrawUnit(1,i,"获取中...");break;case 2:this.ui_role.DrawUnit(1,i,this.role_list[i].sName),this.ui_role.DrawUnit(2,i,e.sSchools[this.role_list[i].iSchoolId]),this.ui_role.DrawUnit(3,i,""+this.role_list[i].iComplexScore)}}this.ui_role.FinishDraw(),s+=410,this.btn_self.Move(t+15,s+15,this.iLW,40),E.frame_type4("22号框20_20",t+15,s+15,this.iLW,40,20,20),this.myrank>=0?this.myrank<3?this.aa_icon.Draw(this.ui_role.OffX(0)-19,s+15+20-16,this.myrank):c.gi().DrawTextEx(this.ui_role.OffX(0),s+15+20,""+(this.myrank+1),4294967295,20,101,1,1,0,-2,-2):c.gi().DrawTextEx(this.ui_role.OffX(0),s+15+20,"未上榜",4294967295,20,101,1,1,0,-2,-2),c.gi().DrawTextEx(this.ui_role.OffX(1),s+35,xh.me.sName,4294967295,20,101,1,1,0,-2,-2),c.gi().DrawTextEx(this.ui_role.OffX(2),s+35,e.sSchools[xh.me.rbs.iSchoolId],4294967295,20,101,1,1,0,-2,-2),c.gi().DrawTextEx(this.ui_role.OffX(3),s+35,""+xh.me.iComplexScore,4294967295,20,101,1,1,0,-2,-2)}if(5==this.iSelect1){for(0==this.iSelect2?this.ui_role.SetTitle(3,"铜币",160,!1):this.ui_role.SetTitle(3,"元宝",160,!1),this.ui_role.BeginDraw(t+15,s+15),i=0;i<this.iRoleCount+1;i++)if(i<this.iRoleCount&&this.role_list[i].iRid==xh.me.iRid&&(this.myrank=i),this.ui_role.bShow(i)){if(i==this.iRoleCount){this.ui_role.DrawUnit(0,i,"");break}switch(this.ui_role.DrawUnit(0,i,""+(i+1)),i<3&&(this.aa_icon.iFrame=i,this.ui_role.DrawUnitEx_Anima(0,i,this.aa_icon,61,4),this.ui_role.DrawUnitEx_Button(0,i,this.btn_explain[i],100,5)),this.role_list[i].iInitProc){case 0:Mh.gi().s_LeaderBoardFresh(2,this.role_list[i].iRid,0),this.role_list[i].iInitProc=1;break;case 1:this.ui_role.DrawUnit(1,i,"获取中...");break;case 2:this.ui_role.DrawUnit(1,i,this.role_list[i].sName),this.ui_role.DrawUnit(2,i,e.sSchools[this.role_list[i].iSchoolId]),this.ui_role.DrawUnit(3,i,""+this.role_list[i].iMoney)}}this.ui_role.FinishDraw(),s+=410,this.btn_self.Move(t+15,s+15,this.iLW,40),E.frame_type4("22号框20_20",t+15,s+15,this.iLW,40,20,20),this.myrank>=0?this.myrank<3?this.aa_icon.Draw(this.ui_role.OffX(0)-19,s+15+20-16,this.myrank):c.gi().DrawTextEx(this.ui_role.OffX(0),s+15+20,""+(this.myrank+1),4294967295,20,101,1,1,0,-2,-2):c.gi().DrawTextEx(this.ui_role.OffX(0),s+15+20,"未上榜",4294967295,20,101,1,1,0,-2,-2),c.gi().DrawTextEx(this.ui_role.OffX(1),s+35,xh.me.sName,4294967295,20,101,1,1,0,-2,-2),c.gi().DrawTextEx(this.ui_role.OffX(2),s+35,e.sSchools[xh.me.rbs.iSchoolId],4294967295,20,101,1,1,0,-2,-2),0==this.iSelect2?c.gi().DrawTextEx(this.ui_role.OffX(3),s+35,""+(xh.me.rbs.iMoney+xh.me.rbs.iStore),4294967295,20,101,1,1,0,-2,-2):c.gi().DrawTextEx(this.ui_role.OffX(3),s+35,""+xh.me.rbs.iInGot,4294967295,20,101,1,1,0,-2,-2)}if(6==this.iSelect1){for(this.ui_role.SetTitle(3,"活跃度积分",160,!1),this.ui_role.BeginDraw(t+15,s+15),i=0;i<this.iRoleCount+1;i++)if(i<this.iRoleCount&&this.role_list[i].iRid==xh.me.iRid&&(this.myrank=i),this.ui_role.bShow(i)){if(i==this.iRoleCount){this.ui_role.DrawUnit(0,i,"");break}switch(this.ui_role.DrawUnit(0,i,""+(i+1)),i<3&&(this.aa_icon.iFrame=i,this.ui_role.DrawUnitEx_Anima(0,i,this.aa_icon,61,4),this.ui_role.DrawUnitEx_Button(0,i,this.btn_explain[i],100,5)),this.role_list[i].iInitProc){case 0:Mh.gi().s_LeaderBoardFresh(2,this.role_list[i].iRid,0),this.role_list[i].iInitProc=1;break;case 1:this.ui_role.DrawUnit(1,i,"获取中...");break;case 2:this.ui_role.DrawUnit(1,i,this.role_list[i].sName),this.ui_role.DrawUnit(2,i,e.sSchools[this.role_list[i].iSchoolId]),this.ui_role.DrawUnit(3,i,""+this.role_list[i].iMoney)}}this.ui_role.FinishDraw(),s+=410,this.btn_self.Move(t+15,s+15,this.iLW,40),E.frame_type4("22号框20_20",t+15,s+15,this.iLW,40,20,20),this.myrank>=0?this.myrank<3?this.aa_icon.Draw(this.ui_role.OffX(0)-19,s+15+20-16,this.myrank):c.gi().DrawTextEx(this.ui_role.OffX(0),s+15+20,""+(this.myrank+1),4294967295,20,101,1,1,0,-2,-2):c.gi().DrawTextEx(this.ui_role.OffX(0),s+15+20,"未上榜",4294967295,20,101,1,1,0,-2,-2),c.gi().DrawTextEx(this.ui_role.OffX(1),s+35,xh.me.sName,4294967295,20,101,1,1,0,-2,-2),c.gi().DrawTextEx(this.ui_role.OffX(2),s+35,e.sSchools[xh.me.rbs.iSchoolId],4294967295,20,101,1,1,0,-2,-2),0==this.iSelect2?c.gi().DrawTextEx(this.ui_role.OffX(3),s+35,""+(xh.me.iFlagExt[25]+xh.me.iFlagExt[24]),4294967295,20,101,1,1,0,-2,-2):(c.gi().DrawTextEx(this.ui_role.OffX(3),s+35,""+xh.me.iFlagExt[26],4294967295,20,101,1,1,0,-2,-2),this.myrank>=0&&this.myrank<3&&(this.btn_getprice.Move(this.ui_role.OffX(3)-80,s+15-1,160,42),this.btn_getprice.Draw()))}}ProcTouch(i,t,s){var e;if(3==i&&this.bLocked1)return this.bLocked1=!1,!0;if(2==i&&this.bLocked1)return e=this.iLockY-s,this.iOffY-=e,this.iLockY=s,!0;if(this.btn_close.ProcTouch(i,t,s))return this.btn_close.bCheck()&&ln.gi().PopStat(1),!0;if(0==this.iSelect1){if(2!=this.iSelect2){if(this.btn_self.ProcTouch(i,t,s))return this.btn_self.bCheck()&&(0==this.iSelect2&&Mh.gi().s_LeaderBoardFresh(4,xh.me.iRid,0),1!=this.iSelect2&&3!=this.iSelect2||Mh.gi().s_WatchOn(0,xh.me.iRid,0,"")),!0;if(this.ui_role.ProcTouch(i,t,s)){for(e=0;e<3;e++)this.btn_explain[e].bCheck()&&Z.fm.Open("每日0点前排名第"+(e+1)+"的玩家获得称谓"+this._titles[this.iSelect2][e]+"，持续一天");return(e=this.ui_role.iChecked())>=0&&e<this.iRoleCount&&(0==this.iSelect2&&Mh.gi().s_LeaderBoardFresh(4,this.role_list[e].iRid,0),1!=this.iSelect2&&3!=this.iSelect2||Mh.gi().s_WatchOn(0,this.role_list[e].iRid,0,"")),!0}}else if(this.ui_pet.ProcTouch(i,t,s)){for(e=0;e<3;e++)this.btn_explain[e].bCheck()&&Z.fm.Open("每日0点前排名第"+(e+1)+"的玩家获得称谓"+this._titles[this.iSelect2][e]+"，持续一天");return(e=this.ui_pet.iChecked())>=0&&e<this.iPetCount&&Mh.gi().s_WatchOn(2,this.pet_list[e].iPid,0,""),!0}}else if(1==this.iSelect1){if(this.ui_equip.ProcTouch(i,t,s)){for(e=0;e<3;e++)this.btn_explain[e].bCheck()&&Z.fm.Open("每日0点前排名第"+(e+1)+"的玩家获得称谓"+this._titles[4][e]+"，持续一天");return(e=this.ui_equip.iChecked())>=0&&e<this.iEquipCount&&Mh.gi().s_WatchOn(1,this.equip_list[e].iGid,0,""),!0}}else if(2==this.iSelect1){if(this.btn_self.ProcTouch(i,t,s))return this.btn_self.bCheck()&&Mh.gi().s_WatchOn(0,xh.me.iRid,0,""),!0;if(this.ui_role.ProcTouch(i,t,s))return(e=this.ui_role.iChecked())>=0&&e<this.iRoleCount&&Mh.gi().s_WatchOn(0,this.role_list[e].iRid,0,""),!0}else if(3==this.iSelect1){if(this.btn_self.ProcTouch(i,t,s))return this.btn_self.bCheck()&&Mh.gi().s_LeaderBoardFresh(4,xh.me.iRid,0),!0;if(this.ui_role.ProcTouch(i,t,s))return(e=this.ui_role.iChecked())>=0&&e<this.iRoleCount&&Mh.gi().s_LeaderBoardFresh(4,this.role_list[e].iRid,0),!0}else if(5==this.iSelect1||6==this.iSelect1){if(6==this.iSelect1&&1==this.iSelect2&&this.myrank>=0&&this.myrank<3&&this.btn_getprice.ProcTouch(i,t,s))return this.btn_getprice.bCheck()&&Mh.gi().s_ExtendCmd("领取活跃排行奖励","","","","","","",""),!0;if(this.btn_self.ProcTouch(i,t,s))return this.btn_self.bCheck()&&Mh.gi().s_WatchOn(0,xh.me.iRid,0,""),!0;if(this.ui_role.ProcTouch(i,t,s)){for(e=0;e<3;e++)this.btn_explain[e].bCheck()&&(5==this.iSelect1?0==this.iSelect2?Z.fm.Open("每日0点前排名第"+(e+1)+"的玩家获得称谓"+this._titles[5][e]+"，持续一天"):1==this.iSelect2&&Z.fm.Open("每日0点前排名第"+(e+1)+"的玩家获得称谓"+this._titles[6][e]+"，持续一天"):6==this.iSelect1&&(0==e?Z.fm.Open("每周活跃第一的玩家将获得活跃礼包，可获得丰厚奖励，更有概率获得特级技能书"):1==e?Z.fm.Open("每周活跃第二的玩家将获得活跃礼包，可获得丰厚奖励"):Z.fm.Open("每周活跃第三的玩家将获得活跃礼包，可获得丰厚奖励")));return(e=this.ui_role.iChecked())>=0&&e<this.iRoleCount&&Mh.gi().s_WatchOn(0,this.role_list[e].iRid,0,""),!0}}var h=!1;return this.btn_grsl.ProcTouch(i,t,s)&&this.btn_grsl.bCheck()&&0!=this.iSelect1&&(this.iSelect1=0,this.iSelect2=0,h=!0),0==this.iSelect1&&(this.btn_zhpf.ProcTouch(i,t,s)&&this.btn_zhpf.bCheck()&&0!=this.iSelect2&&(this.iSelect2=0,h=!0),this.btn_rwpf.ProcTouch(i,t,s)&&this.btn_rwpf.bCheck()&&1!=this.iSelect2&&(this.iSelect2=1,h=!0),this.btn_cwpf.ProcTouch(i,t,s)&&this.btn_cwpf.bCheck()&&2!=this.iSelect2&&(this.iSelect2=2,h=!0),this.btn_dj.ProcTouch(i,t,s)&&this.btn_dj.bCheck()&&3!=this.iSelect2&&(this.iSelect2=3,h=!0)),this.btn_jssb.ProcTouch(i,t,s)&&this.btn_jssb.bCheck()&&1!=this.iSelect1&&(this.iSelect1=1,this.iSelect2=0,h=!0),1==this.iSelect1&&(this.btn_wq.ProcTouch(i,t,s)&&this.btn_wq.bCheck()&&0!=this.iSelect2&&(this.iSelect2=0,h=!0),this.btn_xl.ProcTouch(i,t,s)&&this.btn_xl.bCheck()&&1!=this.iSelect2&&(this.iSelect2=1,h=!0),this.btn_yf.ProcTouch(i,t,s)&&this.btn_yf.bCheck()&&2!=this.iSelect2&&(this.iSelect2=2,h=!0),this.btn_tk.ProcTouch(i,t,s)&&this.btn_tk.bCheck()&&3!=this.iSelect2&&(this.iSelect2=3,h=!0),this.btn_yd.ProcTouch(i,t,s)&&this.btn_yd.bCheck()&&4!=this.iSelect2&&(this.iSelect2=4,h=!0),this.btn_xz.ProcTouch(i,t,s)&&this.btn_xz.bCheck()&&5!=this.iSelect2&&(this.iSelect2=5,h=!0)),this.btn_bwjfb.ProcTouch(i,t,s)&&this.btn_bwjfb.bCheck()&&(this.iSelect1=2,this.iSelect2=0,h=!0),2==this.iSelect1&&(this.btn_49z.ProcTouch(i,t,s)&&this.btn_49z.bCheck()&&0!=this.iSelect2&&(this.iSelect2=0,h=!0),this.btn_69z.ProcTouch(i,t,s)&&this.btn_69z.bCheck()&&1!=this.iSelect2&&(this.iSelect2=1,h=!0),this.btn_89z.ProcTouch(i,t,s)&&this.btn_89z.bCheck()&&2!=this.iSelect2&&(this.iSelect2=2,h=!0)),this.btn_qgyh.ProcTouch(i,t,s)&&this.btn_qgyh.bCheck()&&(this.iSelect1=3,this.iSelect2=0,h=!0),3==this.iSelect1&&(this.btn_49t.ProcTouch(i,t,s)&&this.btn_49t.bCheck()&&0!=this.iSelect2&&(this.iSelect2=0,h=!0),this.btn_69t.ProcTouch(i,t,s)&&this.btn_69t.bCheck()&&1!=this.iSelect2&&(this.iSelect2=1,h=!0),this.btn_89t.ProcTouch(i,t,s)&&this.btn_89t.bCheck()&&2!=this.iSelect2&&(this.iSelect2=2,h=!0)),this.btn_cfb.ProcTouch(i,t,s)&&this.btn_cfb.bCheck()&&(this.iSelect1=5,this.iSelect2=0,h=!0),5==this.iSelect1&&(this.btn_money.ProcTouch(i,t,s)&&this.btn_money.bCheck()&&0!=this.iSelect2&&(this.iSelect2=0,h=!0),this.btn_ingot.ProcTouch(i,t,s)&&this.btn_ingot.bCheck()&&1!=this.iSelect2&&(this.iSelect2=1,h=!0)),this.btn_hyb.ProcTouch(i,t,s)&&this.btn_hyb.bCheck()&&(this.iSelect1=6,this.iSelect2=0,h=!0),6==this.iSelect1&&(this.btn_thisweek.ProcTouch(i,t,s)&&this.btn_thisweek.bCheck()&&0!=this.iSelect2&&(this.iSelect2=0,h=!0),this.btn_previousweek.ProcTouch(i,t,s)&&this.btn_previousweek.bCheck()&&1!=this.iSelect2&&(this.iSelect2=1,h=!0)),h&&(this.iRoleCount=0,this.iPetCount=0,this.iEquipCount=0,Mh.gi().s_LeaderBoardFresh(0,this.iSelect1,this.iSelect2),ln.gi().PushStat(ln.GS_LOADING1)),bn.bInRect(t,s,this.iX+40,this.iY+40,210,this.iH-80)&&(1==i&&(this.iLockY=s),2==i&&(this.bLocked1||((e=this.iLockY-s)<-15||e>15)&&(this.bLocked1=!0,this.btn_grsl.SetNormal(),this.btn_zhpf.SetNormal(),this.btn_rwpf.SetNormal(),this.btn_cwpf.SetNormal(),this.btn_dj.SetNormal(),this.btn_jssb.SetNormal(),this.btn_wq.SetNormal(),this.btn_xl.SetNormal(),this.btn_yf.SetNormal(),this.btn_tk.SetNormal(),this.btn_yd.SetNormal(),this.btn_xz.SetNormal(),this.btn_bwjfb.SetNormal(),this.btn_49z.SetNormal(),this.btn_69z.SetNormal(),this.btn_89z.SetNormal(),this.btn_qgyh.SetNormal(),this.btn_49t.SetNormal(),this.btn_69t.SetNormal(),this.btn_89t.SetNormal(),this.btn_cfb.SetNormal(),this.btn_money.SetNormal(),this.btn_ingot.SetNormal(),this.btn_hyb.SetNormal(),this.btn_thisweek.SetNormal(),this.btn_previousweek.SetNormal()))),!1}_LeaderBoardFresh(i){var t,s,e=i.GetNextInt(),h=i.GetNextInt(),a=i.GetNextInt();switch(e){case 0:if(0==h)if(2!=this.iSelect2&&this.iSelect2==a)for(this.iRoleCount=i.GetNextByte(),t=0;t<this.iRoleCount;t++)this.role_list[t].iRid=i.GetNextInt(),this.role_list[t].iInitProc=0;else if(this.iSelect2==a)for(this.iPetCount=i.GetNextByte(),t=0;t<this.iPetCount;t++)this.pet_list[t].iPid=i.GetNextInt(),this.pet_list[t].iInitProc=0;if(1==h&&1==this.iSelect1&&this.iSelect2==a)for(this.iEquipCount=i.GetNextByte(),t=0;t<this.iEquipCount;t++)this.equip_list[t].iGid=i.GetNextInt(),this.equip_list[t].iInitProc=0;if(2==h&&this.iSelect1==h&&this.iSelect2==a)for(this.iRoleCount=i.GetNextByte(),t=0;t<this.iRoleCount;t++)this.role_list[t].iRid=i.GetNextInt(),this.role_list[t].iFlag16=i.GetNextInt(),this.role_list[t].iInitProc=0;if(3==h&&this.iSelect1==h&&this.iSelect2==a)for(this.iRoleCount=i.GetNextByte(),t=0;t<this.iRoleCount;t++)this.role_list[t].iRid=i.GetNextInt(),this.role_list[t].iInitProc=0;if((5==h||6==h)&&this.iSelect1==h&&this.iSelect2==a)for(this.iRoleCount=i.GetNextByte(),t=0;t<this.iRoleCount;t++)this.role_list[t].iRid=i.GetNextInt(),this.role_list[t].iMoney=i.GetNextInt(),this.role_list[t].iInitProc=0;break;case 1:if(1==this.iSelect1)for(t=0;t<this.iEquipCount;t++)1==this.equip_list[t].iInitProc&&this.equip_list[t].iGid==h&&(this.equip_list[t].iTid=i.GetNextInt(),this.equip_list[t].iRid=i.GetNextInt(),this.equip_list[t].iScore=i.GetNextInt(),this.equip_list[t].sOwner=i.GetNextString(),this.equip_list[t].iInitProc=2);break;case 2:if(0==this.iSelect1&&2!=this.iSelect2||2==this.iSelect1||3==this.iSelect1||5==this.iSelect1||6==this.iSelect1)for(t=0;t<this.iRoleCount;t++)1==this.role_list[t].iInitProc&&this.role_list[t].iRid==h&&(this.role_list[t].sName=i.GetNextString(),this.role_list[t].iSchoolId=i.GetNextInt(),this.role_list[t].iComplexScore=i.GetNextInt(),this.role_list[t].iScore=i.GetNextInt(),this.role_list[t].iLev=i.GetNextInt(),this.role_list[t].iInitProc=2);break;case 3:if(0==this.iSelect1&&2==this.iSelect2)for(t=0;t<this.iPetCount;t++)1==this.pet_list[t].iInitProc&&this.pet_list[t].iPid==h&&(this.pet_list[t].iTid=i.GetNextInt(),this.pet_list[t].iScore=i.GetNextInt(),this.pet_list[t].iRid=i.GetNextInt(),this.pet_list[t].sOwner=i.GetNextString(),this.pet_list[t].iInitProc=2);break;case 4:for(t=0;t<this.iRoleCount;t++)if(this.role_list[t].iRid==h){var n=i.GetNextInt(),o=i.GetNextInt(),r=i.GetNextInt();return s=0==t?this.role_list[t].iComplexScore-this.role_list[t+1].iComplexScore:this.role_list[t-1].iComplexScore-this.role_list[t].iComplexScore,void Wa.Open(this.role_list[t].iRid,this.role_list[t].sName,this.role_list[t].iComplexScore,this.role_list[t].iScore,n,o,r,t+1,s)}if(h==xh.me.iRid){n=i.GetNextInt(),o=i.GetNextInt(),r=i.GetNextInt();Wa.Open(xh.me.iRid,xh.me.sName,xh.me.iComplexScore,xh.me.iScore,n,o,r,0,0)}}}}Va.LeaderBoardFresh=function(i){for(;ln.gi().LastStatType(0)==ln.GS_LOADING1;)ln.gi().PopStat(1);ln.gi().LastStatType(0)==ln.GS_LEADERBOARDFRAME&&ln.gi().LastStat(0)._LeaderBoardFresh(i)};class Ua extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=400,this.iH=300,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_yes=new D(gn.xani_ui),this.btn_yes.InitButton("统一中按钮2"),this.btn_yes.sName="解决",this.btn_no=new D(gn.xani_ui),this.btn_no.InitButton("统一中按钮3"),this.btn_no.sName="未解决",this.btn_ts=new D(gn.xani_ui),this.btn_ts.InitButton("统一中按钮2"),this.btn_ts.sName="投诉"}Draw(){Y.gi().Format("您提的问题:"+this.sQDetail+"#e#e"+this.sAName+"的回答:"+this.sADetail+"#e#e如果对回答不满意，或者有不和谐文字，点击投诉",this.iW-20,20),this.iH=Y.gi().iH+20+60,E.Frame1_BR(this.iX,this.iY,this.iW,this.iH),Y.gi().Draw(this.iX+10,this.iY+10),this.btn_yes.Move(this.iX+10,this.iY+this.iH-50,70,40),this.btn_yes.Draw(),this.btn_no.Move(this.iX+this.iW/2-50,this.iY+this.iH-50,100,40),this.btn_no.Draw(),this.btn_ts.Move(this.iX+this.iW-80,this.iY+this.iH-50,70,40),this.btn_ts.Draw()}ProcTouch(i,t,s){return this.btn_yes.ProcTouch(i,t,s)&&this.btn_yes.bCheck()&&(Mh.gi().s_NoviceHelp(4,xh.me.iRid,this.iQSid,""),ln.gi().PopStat(1)),this.btn_no.ProcTouch(i,t,s)&&this.btn_no.bCheck()&&(Mh.gi().s_NoviceHelp(5,xh.me.iRid,this.iQSid,""),ln.gi().PopStat(1)),this.btn_ts.ProcTouch(i,t,s)&&this.btn_ts.bCheck()&&(Mh.gi().s_NoviceHelp(6,xh.me.iRid,this.iQSid,""),ln.gi().PopStat(1)),!1}}Ua.getanswer=function(i){ln.gi().LastStatType(0)!=ln.GS_NOVICECHECKANSWER&&ln.gi().PushStat(ln.GS_NOVICECHECKANSWER);var t=ln.gi().LastStat(0);t.iQSid=i.GetNextInt(),t.sQDetail=i.GetNextString(),t.iARid=i.GetNextInt(),t.sAName=i.GetNextString(),t.sADetail=i.GetNextString()};class za extends s{constructor(i){var t,s;for(super(),this.pani=i,this.pm3f=i.pm3f,this.iW=800,this.iH=480,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_help=new Array(10),t=0;t<10;t++)this.btn_help[t]=new D(gn.xani_ui3),this.btn_help[t].InitButton("统一按钮2"),this.btn_help[t].Move(this.iX+50,this.iY+45+50*t,128,32),this.btn_help[t].iNameSize=25;for(this.btn_help[0].sName="游戏介绍",this.btn_help[1].sName="新手玩法",this.btn_help[2].sName="门派介绍",this.btn_help[3].sName="日常活动",this.btn_help[4].sName="游戏公告",this.btn_help[5].sName="新手提问",this.btn_help[6].sName="高手解答",this.btn_btns=new Array(2),t=0;t<2;t++)for(this.btn_btns[t]=new Array(6),s=0;s<6;s++)this.btn_btns[t][s]=new D(gn.xani_ui),this.btn_btns[t][s].Move(this.iX+20+130*t,this.iY+20+60*s,130,60),this.btn_btns[t][s].bSingleButton=!0;for(this.btn_btns[0][0].sName="新手提问",this.btn_btns[1][0].sName="高手解答",this.btn_btns[0][1].sName="0~10级",this.btn_btns[1][1].sName="基本操作",this.btn_btns[0][2].sName="10~20级",this.btn_btns[1][2].sName="门派介绍",this.btn_btns[0][3].sName="20~30级",this.btn_btns[0][4].sName="30~40级",this.btn_close=new Wi(gn.xani_ui3),this.btn_close.InitButton("统一关闭按钮"),this.btn_close.Move(this.iX+748,this.iY,60,60),this.ip1=0,this.ip2=0,this.btn_rmx=new Array(3),this.btn_mp=new Array(3),t=0;t<3;t++)this.btn_rmx[t]=new Wi(gn.xani_ui3),this.btn_rmx[t].InitButton("统一按钮3"),this.btn_mp[t]=new Wi(gn.xani_ui3),this.btn_mp[t].InitButton("统一按钮3");this.btn_rmx[0].sName="人",this.btn_rmx[1].sName="魔",this.btn_rmx[2].sName="仙",za.sDetail=""}Draw_0(i){var t=this.iX+485,s=i+60;c.gi().DrawText_2(t,s,"~~~ 游戏介绍 ~~~",4294952960,25,101,1,1,0,-2,-2,3,4278190080),s+=30,c.gi().DrawText_2(t-210+40,s,"春秋战国期间，七雄争霸，豪杰雄起。谋臣",4278190080,20,101,1,1,0,0,-2,0,4278190080),s+=25,c.gi().DrawText_2(t-210,s,"运筹帷幄，将士浴血沙场。战争此起彼伏，局势",4278190080,20,101,1,1,0,0,-2,0,4278190080),s+=25,c.gi().DrawText_2(t-210,s,"变化跌宕。时代赋予三界风云人物神圣使命去掌",4278190080,20,101,1,1,0,0,-2,0,4278190080),s+=25,c.gi().DrawText_2(t-210,s,"控国家生死存亡、左右民族荣辱兴衰。人族、魔",4278190080,20,101,1,1,0,0,-2,0,4278190080),s+=25,c.gi().DrawText_2(t-210,s,"族、仙族率领九大门派弟子卷入了这场声势浩大",4278190080,20,101,1,1,0,0,-2,0,4278190080),s+=25,c.gi().DrawText_2(t-210,s,"的征战之中。岁月长河涤荡两千余载，那些璀璨",4278190080,20,101,1,1,0,0,-2,0,4278190080),s+=25,c.gi().DrawText_2(t-210,s,"的智慧和生命依然熠熠发光，依然动人心魄......",4278190080,20,101,1,1,0,0,-2,0,4278190080)}Draw_1(i){var t=this.iX+485,s=i+60;c.gi().DrawText_2(t,s,"0级~10级",4294952960,25,101,1,1,0,-2,-2,3,4278190080),s+=30,c.gi().DrawText_2(t,s,"打开任务提示，跟随引导剧情可快速升级",4278190080,20,101,1,1,0,-2,-2,0,4278190080),s+=23,c.gi().DrawText_2(t,s,"剧情战斗难度较高，建议组队完成",4278190080,20,101,1,1,0,-2,-2,0,4278190080),s+=23,c.gi().DrawText_2(t,s,"0~5级可在郊外组队练级",4278190080,20,101,1,1,0,-2,-2,0,4278190080),s+=23,c.gi().DrawText_2(t,s,"5~10级可在西阳山道组队练级",4278190080,20,101,1,1,0,-2,-2,0,4278190080),s+=30,c.gi().DrawText_2(t,s,"10级~20级",4294952960,25,101,1,1,0,-2,-2,3,4278190080),s+=30,c.gi().DrawText_2(t,s,"西阳城<门派传送人>处传送加入门派,学门派技能",4278190080,20,101,1,1,0,-2,-2,0,4278190080),s+=23,c.gi().DrawText_2(t,s,"每天前2轮门派任务可获得双倍奖励",4278190080,20,101,1,1,0,-2,-2,0,4278190080),s+=23,c.gi().DrawText_2(t,s,"10~25级之间可拜40级以上玩家为师",4278190080,20,101,1,1,0,-2,-2,0,4278190080),s+=30,c.gi().DrawText_2(t,s,"20级~30级",4294952960,25,101,1,1,0,-2,-2,3,4278190080),s+=30,c.gi().DrawText_2(t,s,"郢城<栾千盛>组队进行强盗任务",4278190080,20,101,1,1,0,-2,-2,0,4278190080),s+=23,c.gi().DrawText_2(t,s,"郢城<帮派总管>处申请加入帮派",4278190080,20,101,1,1,0,-2,-2,0,4278190080),s+=23,c.gi().DrawText_2(t,s,"帮派内可学到打造，强身，炼丹等辅助技能",4278190080,20,101,1,1,0,-2,-2,0,4278190080),s+=23,c.gi().DrawText_2(t,s,"临淄<程镖头>可领取押镖任务，有几率得到阵法书",4278190080,20,101,1,1,0,-2,-2,0,4278190080),s+=23,c.gi().DrawText_2(t,s,"咸阳<商鞅>处领取材料任务(限30次/天)",4278190080,20,101,1,1,0,-2,-2,0,4278190080)}Draw_2(i){var t;for(t=0;t<3;t++)this.btn_rmx[t].Move(this.iX+280+160*t,i+40,110,40),this.btn_rmx[t].Draw(),this.ip1==t&&gn.xani_ui3.DrawAnima_aa(this.btn_rmx[t].iX,this.btn_rmx[t].iY,"按钮选中框",0),this.btn_mp[t].Move(this.iX+280+160*t,i+40+50,110,40),this.btn_mp[t].sName=e.sSchools[3*this.ip1+t+1],this.btn_mp[t].Draw(),this.ip2==t&&gn.xani_ui3.DrawAnima(this.btn_mp[t].iX,this.btn_mp[t].iY,"按钮选中框",0);if(0==this.ip1)switch(this.ip2){case 0:Y.fs.FormatEx("#cffff00师父：盖聂#e门派特点：物理型，拥有强大的物理攻击技能。#e门派加点：推荐4力1速、3力1体1耐或全力。#e门派技能",500,18,1,4278190080,20),Y.gi().Draw(this.iX+240,this.iY+150),Y.fs.FormatEx("浩然剑气:对目标造成伤害的同时以剑气伤害另外两个敌方单位，消耗25魔法。#e无双剑法：连续攻击目标三次，使用后休息一回合，要求当前气血40%以上，消耗10%当前气血。#e幻影剑法：分身攻击后主体攻击，要求当前气血60%以上，不消耗气血和魔法 。#e凝神聚气：临时增加自身攻击，消耗20魔法。#e虎啸：增加我方士气，消耗20魔法。#e先发制人：对目标造成伤害的同时降低目标速度，消耗20魔法。#e遁地术：非战斗时回到门派。",500,18,1,4278190080,20),Y.gi().Draw(this.iX+240,this.iY+230);break;case 1:Y.fs.FormatEx("#cffff00师父：孙武#e门派特点：辅助型，拥有强大封印技能。#e门派加点：推荐3体2速、2体1耐2速或2体3速。#e门派技能",500,18,1,4278190080,20),Y.gi().Draw(this.iX+240,this.iY+150),Y.fs.FormatEx("奇谋：临时降低目标防御和法防，消耗30魔法。#e陷阱：有几率控制对方，使对方无法攻击和使用技能，消耗20魔法。#e烈焰阵：攻击全体对方气血和魔法，消耗30魔法。#e轮轴术：临时提高己方单人速度，消耗20魔法。#e迷雾：使己方全体有几率躲避物理伤害，消耗40魔法。#e兵诡：持续降低敌方士气，消耗20魔法。#e遁地术：非战斗时回到门派。",500,18,1,4278190080,20),Y.gi().Draw(this.iX+240,this.iY+230);break;case 2:Y.fs.FormatEx("#cffff00师父：扁鹊#e门派特点：辅助型，拥有强大的加血技能，是七国唯一的奶妈。#e门派加点：推荐3体1法1耐、3体1耐1速或4体1耐。#e门派技能",500,18,1,4278190080,20),Y.gi().Draw(this.iX+240,this.iY+150),Y.fs.FormatEx("推功过血：群体恢复气血，恢复人数随着技能等级增加,作用人数（技能等级+10）/20+1，消耗作用人数*15魔法。#e起死回生：救活死亡的队友并恢复一定气血，消耗50魔法。#e练气化神：转化部分气血为魔法，消耗技能等级*1气血。#e浑圆气功：法术攻击2人，消耗20魔法。#e知己知彼：命中后能看到对方当前剩于气血，消耗20魔法。#e针灸：单人加血，并临时提高目标攻击和法防，消耗20魔法。#e神农本草：增加使用药物的效果。",500,18,1,4278190080,20),Y.gi().Draw(this.iX+240,this.iY+230)}else if(1==this.ip1)switch(this.ip2){case 0:Y.fs.FormatEx("#cffff00师父：白起#e门派特点：物攻型，拥有强大的物理伤害技能。#e门派加点：推荐4力1体或全力。#e门派技能",500,18,1,4278190080,20),Y.gi().Draw(this.iX+240,this.iY+150),Y.fs.FormatEx("狂暴诀：临时增加自身攻击，减少防御，并进入狂暴状态，无法和定心状态叠加，消耗15魔法。#e连环刀：在狂暴状态下，攻击对方多人。攻击人数=（技能等级+10）/20+1，使用后休息一回合，消耗攻击人数*15魔法。#e乱舞：连续攻击1一3次，狂暴状态下可连续攻击2一4次消耗25魔法。#e定心诀：临时增加防御和法术防御，减少攻击力，并进入定心状态，无法和狂暴状态叠加，消耗15魔法。#e魔甲术：处定心状态下使用，减免受到的法术伤害并有几率躲避对方的法术攻击，消耗20魔法。#e壁垒：使用后受到普通物理攻击时会反击，若处于定心状态则反击伤害加倍消耗25魔法。#e遁地术：非战斗时回到门派。",500,18,1,4278190080,20),Y.gi().Draw(this.iX+240,this.iY+230);break;case 1:Y.fs.FormatEx("#cffff00师父：祝融#e门派特点：法术攻击型，拥有强大的法术伤害技能。#e门派加点：推荐4法1体、3法2体或全法。#e门派技能",500,18,1,4278190080,20),Y.gi().Draw(this.iX+240,this.iY+150),Y.fs.FormatEx("火流星：法术攻击对方多人，攻击人数随着技能等级增加，攻击人数=（技能等级+10）/20+1，，消耗攻击人数*15魔法。#e毒火术：攻击单人并临时降低目标防御，消耗30魔法。#e火牢：有几率控制对方，使目标无法使用普通攻击，消耗25魔法。#e炎爆术：法术攻击对方单人，消耗30魔法。#e火甲术：被物理攻击时，对方受到反震伤害，消耗25魔法。#e火灵诀：临时增加法术暴击率和封系法术抗性，消耗40魔法。#e遁地术：非战斗时回到门派",500,18,1,4278190080,20),Y.gi().Draw(this.iX+240,this.iY+230);break;case 2:Y.fs.FormatEx("#cffff00师父：鬼谷子#e门派特点：辅助型，拥有强大的封印技能。#e门派加点：推荐3体2速或2体3速。#e门派技能",500,18,1,4278190080,20),Y.gi().Draw(this.iX+240,this.iY+150),Y.fs.FormatEx("飞钳术：有几率控制对方，使对方无法使用普通攻击和法术，消耗20魔法。#e凝神诀：增加飞钳术成功率消耗20魔法。#e鬼谷刀法：连续攻击目标两次，要求当前气血70%以上，消耗25魔法。#e散势法：降低对方士气，消耗20魔法。#e清心咒：解除已方队员封类状态，消耗20魔法。#e鬼符：对中了飞钳术的敌方目标造成固定伤害，并降低法术防御，消耗15魔法。#e遁地术：非战斗时回到门派。",500,18,1,4278190080,20),Y.gi().Draw(this.iX+240,this.iY+230)}else if(2==this.ip1)switch(this.ip2){case 0:Y.fs.FormatEx("#cffff00师父：姜太公#e门派特点：法术型，拥有强大的法术伤害技能。#e门派加点：推荐4法1耐、3法1体1耐或全法。#e门派技能",500,18,1,4278190080,20),Y.gi().Draw(this.iX+240,this.iY+150),Y.fs.FormatEx("呼风：法术攻击对方多人，攻击人数随技能等级增加，攻击人数为技能等级/15+2，消耗攻击人数*15魔法。#e唤雨：攻击对方全体气血和魔法，消耗30魔法。#e天雷封魔：法术攻击对方单人，消耗30魔法。#e仙甲术：临时增加自已防御，消耗25魔法。#e天神助威：提高已方士气，消耗20魔法。#e灵智术：临时增加我方单体灵力，消耗25魔法。#e遁地术：非战斗时回到门派。",500,18,1,4278190080,20),Y.gi().Draw(this.iX+240,this.iY+230);break;case 1:Y.fs.FormatEx("#cffff00师父：风后#e门派特点：辅助攻击型，拥有加血技能与固伤技能。#e门派加点：2体2耐1速、3体1耐1速或3体2耐。#e门派技能",500,18,1,4278190080,20),Y.gi().Draw(this.iX+240,this.iY+150),Y.fs.FormatEx("天阵：提高已方全体物理和法术攻击，使用后休息2回合，消耗50魔法。#e地阵：提高已方全体物理和法术防御，使用后休息2回合，消耗50魔法。#e五行击：固定伤害攻击随机1一5个目标，消耗40魔法。#e五行甲：临时提高目标法术攻击和防御，并持续恢复气血若干回合，消耗25魔法。#e孤虚法：降低对方士气并增加已方士气，消耗20魔法。#e归元法：解除五行甲效果并立即回复目标五行甲剩余治疗效果的气血，消耗20魔法。#e遁地术：非战斗时回到门派。",500,18,1,4278190080,20),Y.gi().Draw(this.iX+240,this.iY+230);break;case 2:Y.fs.FormatEx("#cffff00师父：九天玄女#e门派特点：辅助攻击型，拥有封印、恢复和攻击技能。#e门派加点：推荐2体1耐2速或2体2耐1速。#e门派技能",500,18,1,4278190080,20),Y.gi().Draw(this.iX+240,this.iY+150),Y.fs.FormatEx("穿云箭：加入灵气的箭，伤害受自身灵和攻击的影响，被攻击者降低速度，消耗15魔法。#e定天弓：提高穿云箭伤害，使穿云箭有几率击晕目标，使目标无法进行任何操作。消耗15魔法。#e驱魔符：驱除对方单人状态，并造成一定的伤害，消耗20魔法。#e天地同寿：救活一个队友。#e灵动九天：临时增加己方单体灵力，并持续恢复其魔法，消耗20魔法。#e仙绫缚：有几率束缚目标，使其无法使用技能消耗20魔法。#e遁地术：非战斗时回到门派。",500,18,1,4278190080,20),Y.gi().Draw(this.iX+240,this.iY+230)}}Draw_3(i){var t=this.iX+485,s=i+60;c.gi().DrawText_2(t,s,"~~~ 日常活动 ~~~",4294952960,25,101,1,1,0,-2,-2,3,4278190080),s+=30,c.gi().DrawText_2(t,s,"1.师门任务",4278190080,20,101,1,1,0,-2,-2,0,4278190080),s+=23,c.gi().DrawText_2(t,s,"2.强盗任务",4278190080,20,101,1,1,0,-2,-2,0,4278190080),s+=23,c.gi().DrawText_2(t,s,"3.师徒任务",4278190080,20,101,1,1,0,-2,-2,0,4278190080),s+=23,c.gi().DrawText_2(t,s,"4.为民除害",4278190080,20,101,1,1,0,-2,-2,0,4278190080),s+=23,c.gi().DrawText_2(t,s,"5.帮派-朱雀任务",4278190080,20,101,1,1,0,-2,-2,0,4278190080),s+=23,c.gi().DrawText_2(t,s,"6.帮派-青龙任务",4278190080,20,101,1,1,0,-2,-2,0,4278190080),s+=23,c.gi().DrawText_2(t,s,"7.帮派-玄武任务",4278190080,20,101,1,1,0,-2,-2,0,4278190080),s+=23,c.gi().DrawText_2(t,s,"8.商鞅-护法任务",4278190080,20,101,1,1,0,-2,-2,0,4278190080),s+=23,c.gi().DrawText_2(t,s,"9.商鞅-执法任务",4278190080,20,101,1,1,0,-2,-2,0,4278190080),s+=23,c.gi().DrawText_2(t,s,"10.押镖任务",4278190080,20,101,1,1,0,-2,-2,0,4278190080),s+=23,c.gi().DrawText_2(t,s,"11.手艺任务",4278190080,20,101,1,1,0,-2,-2,0,4278190080),s+=23,c.gi().DrawText_2(t,s,"12.周末比武",4278190080,20,101,1,1,0,-2,-2,0,4278190080),s+=23,c.gi().DrawText_2(t,s,"13.准点山贼",4278190080,20,101,1,1,0,-2,-2,0,4278190080),s+=23,c.gi().DrawText_2(t,s,"14.智者答题",4278190080,20,101,1,1,0,-2,-2,0,4278190080),s+=23,c.gi().DrawText_2(t,s,"15.世界抢答",4278190080,20,101,1,1,0,-2,-2,0,4278190080),s+=23,c.gi().DrawText_2(t,s,"16.副本",4278190080,20,101,1,1,0,-2,-2,0,4278190080)}Draw(){var i;for(E.ui3_BaseFrame2(this.iX,this.iY,"帮","助"),this.btn_close.Draw(),i=0;i<7;i++)this.iPoint==i&&(this.btn_help[i].bMouseIn=!0,this.btn_help[i].bMouseDown=!0,gn.xani_ui3.DrawAnimaEx(this.iX+40,this.iY+30+50*i+10,"选中背景",0,101,.9,.71,0,0,0)),this.btn_help[i].Draw();switch(gn.xani_ui3.DrawAnima(this.iX+190,this.iY,"大框分割线",0),this.iPoint){case 0:this.Draw_0(this.iY);break;case 1:this.Draw_1(this.iY);break;case 2:this.Draw_2(this.iY);break;case 3:this.Draw_3(this.iY);break;case 4:c.gi().DrawText_2(this.iX+485,this.iY+60,za.sTitle,4294952960,25,101,1,1,0,-2,-2,3,4278190080),Y.gi().FormatEx(za.sDetail,500,20,1,4278190080,25),Y.gi().Draw(this.iX+240,this.iY+100)}}ProcTouch(i,t,s){var e;if(2==this.iPoint)for(e=0;e<3;e++){if(this.btn_rmx[e].ProcTouch(i,t,s))return this.btn_rmx[e].bCheck()&&(this.ip1=e),!0;if(this.btn_mp[e].ProcTouch(i,t,s))return this.btn_mp[e].bCheck()&&(this.ip2=e),!0}for(e=0;e<7;e++)if(this.btn_help[e].ProcTouch(i,t,s))return this.btn_help[e].bCheck()&&(5==e?Send_NoviceAsk.Open():6==e?NoviceQuestionList.Open():(4==e&&this.iPoint!=e&&Mh.gi().s_SeverEvent(2,10,0,0,0),this.iPoint=e)),!0;return!!this.btn_close.ProcTouch(i,t,s)&&(this.btn_close.bCheck()&&ln.gi().PopStat(1),!0)}}za.sDetail,za.sTitle;class ja{constructor(){}}class Ja extends s{constructor(i){var t;for(super(),this.pani=i,this.pm3f=i.pm3f,this.iW=400,this.iH=320,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.iQuestionCount=0,this.qlist=new Array(10),t=0;t<10;t++)this.qlist[t]=new ja;this.iPoint=-1,this.btn_answer=new D(gn.xani_ui),this.btn_answer.InitButton("统一中按钮2"),this.btn_answer.sName="回答",this.btn_delete=new D(gn.xani_ui),this.btn_delete.InitButton("统一中按钮2"),this.btn_delete.sName="去除"}Draw(){var i;for(E.Frame1_BR(this.iX,this.iY,this.iW,this.iH),i=0;i<this.iQuestionCount;i++)c.gi().FillRect_2D(this.iX+10,this.iY+10+60*i,this.iX+this.iW-10,this.iY+10+60*i+60,i%2==0?1345335344:1343229968),Y.gi().Format(this.qlist[i].sName+":"+this.qlist[i].sDetail,this.iW-40,20),Y.gi().Draw(this.iX+20,this.iY+10+60*i+(60-Y.gi().iH)/2),this.iPoint==i&&(this.btn_answer.Move(this.iX+this.iW-20-70,this.iY+10+60*i+10,70,40),this.btn_answer.Draw(),this.btn_delete.Move(this.iX+this.iW-20-70-80,this.iY+10+60*i+10,70,40),this.btn_delete.Draw())}RemoveQuestion(){var i;for(i=this.iPoint;i<this.iQuestionCount-1;i++)this.qlist[i].iRid=this.qlist[i+1].iRid,this.qlist[i].iSid=this.qlist[i+1].iSid,this.qlist[i].sName=this.qlist[i+1].sName,this.qlist[i].sDetail=this.qlist[i+1].sDetail;this.iQuestionCount--,this.iPoint=-1,this.iQuestionCount<=0&&ln.gi().PopStat(1)}ProcTouch(i,t,s){var e;for(this.iPoint>=0&&this.iPoint<this.iQuestionCount&&(this.btn_delete.ProcTouch(i,t,s)&&this.btn_delete.bCheck()&&(Mh.gi().s_NoviceHelp(3,this.qlist[this.iPoint].iRid,this.qlist[this.iPoint].iSid,""),this.RemoveQuestion()),this.btn_answer.ProcTouch(i,t,s)&&this.btn_answer.bCheck()&&Send_AceAnswer.Open()),e=0;e<this.iQuestionCount;e++)bn.bInRect(t,s,this.iX+10,this.iY+10+60*e,this.iW-20,60)&&(this.iPoint=e);return 3!=i||bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||ln.gi().PopStat(1),!1}}Ja.AnswerTheQuestion=function(i){if(ln.gi().LastStatType(1)==ln.GS_NOVICEQUESTIONLIST){var t=ln.gi().LastStat(1);Mh.gi().s_NoviceHelp(2,t.qlist[t.iPoint].iRid,t.qlist[t.iPoint].iSid,i),t.RemoveQuestion()}},Ja.Open=function(){ln.gi().PushStat(ln.GS_NOVICEQUESTIONLIST),Mh.gi().s_NoviceHelp(1,0,0,"")},Ja.getquestion=function(i){ln.gi().LastStatType(0)!=ln.GS_NOVICEQUESTIONLIST&&ln.gi().PushStat(ln.GS_NOVICEQUESTIONLIST);var t,s=ln.gi().LastStat(0);if(s.iQuestionCount=i.GetNextByte(),0!=s.iQuestionCount)for(t=0;t<s.iQuestionCount;t++)s.qlist[t].iRid=i.GetNextInt(),s.qlist[t].iSid=i.GetNextInt(),s.qlist[t].sName=i.GetNextString(),s.qlist[t].sDetail=i.GetNextString();else ln.gi().PopStat(1)};class Qa extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=600,this.iH=100,this.iX=(h.SCRW-this.iW)/2,this.iY=0,this.btn_close=new D(gn.xani_ui),this.btn_close.InitButton("统一关闭按钮"),this.btn_close.Move(this.iX+this.iW-60-20,this.iY+20,60,60),this.btn_send=new D(gn.xani_ui),this.btn_send.InitButton("统一大按钮2"),this.btn_send.Move(this.iX+this.iW-80-100,this.iY+25,80,50),this.btn_send.sName="发送",this.in_speak=new pi(gn.xani_ui),this.in_speak.Move(this.iX+20,this.iY+20,this.iW-220,this.iH-40),this.in_speak.bHideText=!0,this.in_speak.OpenInput()}Draw(){E.Frame2_MD(this.iX,this.iY,this.iW,this.iH),E.Frame1_BR(this.iX+20,this.iY+20,this.iW-220,this.iH-40),Y.gi().Format(this.in_speak.sDetail,this.in_speak.iW-10,20),Y.gi().Draw(this.in_speak.iX+10,this.in_speak.iY+10),this.btn_send.Draw(),this.btn_close.Draw(),this.in_speak.onscr()}ProcTouch(i,t,s){return this.in_speak.ProcTouch(i,t,s),this.btn_send.ProcTouch(i,t,s)&&this.btn_send.bCheck()&&(this.in_speak.sDetail.length<=0?L.easymsg.AddMessage("请先输入内容"):this.in_speak.sDetail.length>=40?L.easymsg.AddMessage("内容过长"):(NoviceQuestionList.AnswerTheQuestion(this.in_speak.sDetail),ln.gi().PopStat(1))),!!this.btn_close.ProcTouch(i,t,s)&&(this.btn_close.bCheck()&&ln.gi().PopStat(1),!0)}}Qa.Open=function(){ln.gi().PushStat(ln.GS_SENDACEANSWER)};class qa extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=600,this.iH=100,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new D(gn.xani_ui),this.btn_close.InitButton("统一关闭按钮"),this.btn_close.Move(this.iX+this.iW-60-20,this.iY+20,60,60),this.btn_send=new D(gn.xani_ui),this.btn_send.InitButton("统一大按钮2"),this.btn_send.Move(this.iX+this.iW-80-100,this.iY+25,80,50),this.btn_send.sName="发送",this.in_speak=new pi(gn.xani_ui),this.in_speak.Move(this.iX+20,this.iY+20,this.iW-220,this.iH-40),this.in_speak.bHideText=!0,this.in_speak.OpenInput()}Draw(){E.Frame2_MD(this.iX,this.iY,this.iW,this.iH),E.Frame1_BR(this.iX+20,this.iY+20,this.iW-220,this.iH-40),Y.gi().Format(this.in_speak.sDetail,this.in_speak.iW-10,20),Y.gi().Draw(this.in_speak.iX+10,this.in_speak.iY+10),this.btn_send.Draw(),this.btn_close.Draw(),this.in_speak.onscr()}ProcTouch(i,t,s){return this.in_speak.ProcTouch(i,t,s),this.btn_send.ProcTouch(i,t,s)&&this.btn_send.bCheck()&&(this.in_speak.sDetail.length<=0?L.easymsg.AddMessage("请先输入内容"):this.in_speak.sDetail.length>=40?L.easymsg.AddMessage("内容过长"):(Mh.gi().s_NoviceHelp(0,0,0,this.in_speak.sDetail),ln.gi().PopStat(1))),!!this.btn_close.ProcTouch(i,t,s)&&(this.btn_close.bCheck()&&ln.gi().PopStat(1),!0)}}qa.Open=function(){ln.gi().PushStat(ln.GS_SENDNOVICEASK)};class Ka extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=400,this.iH=250,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_change=new Eh(gn.xani_button),this.btn_change.InitButton("1号按钮90_60"),this.btn_change.Move(this.iX+40,this.iY+this.iH-60-40,90,60),this.btn_change.sName="改名",this.btn_cancel=new Eh(gn.xani_button),this.btn_cancel.InitButton("1号按钮90_60"),this.btn_cancel.Move(this.iX+this.iW-40-90,this.iY+this.iH-60-40,90,60),this.btn_cancel.sName="取消",this.in_nick=new pi(gn.xani_frame),this.in_nick.Move(this.iX+140,this.iY+20,this.iW-160,50),this.in_nick.sDetail="",this.in_nick.iTextSize=30}Draw(){E.frame_type4("7号框52_52",this.iX,this.iY,this.iW,this.iH,52,52),c.gi().DrawTextEx(this.iX+40,this.iY+40,"输入新的昵称：",4279324257,30,101,1,1,0,0,0),this.in_nick.Move(this.iX+40,this.iY+80,this.iW-80,50),E.frame_type4("8号框20_20",this.in_nick.iX,this.in_nick.iY,this.in_nick.iW,50,20,20),this.pm3f.DrawTextEx(this.in_nick.iX+10,this.in_nick.iY+this.in_nick.iH/2,this.in_nick.sDetail,4279324257,20,101,1,1,0,0,-2),this.btn_change.Draw(),this.btn_cancel.Draw(),this.in_nick.onscr()}ProcTouch(i,t,s){return this.btn_change.ProcTouch(i,t,s)?(this.btn_change.bCheck()&&(Yh.bCheckNick(this.in_nick.sDetail,4,24)?(Mh.gi().s_changenick(this.in_nick.sDetail),ln.gi().PopStat(1)):L.easymsg.AddMessage("昵称填写有误")),!0):(this.in_nick.ProcTouch(i,t,s),!!this.btn_cancel.ProcTouch(i,t,s)&&(this.btn_cancel.bCheck()&&ln.gi().PopStat(1),!0))}}class Za extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=290,this.iH=440,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_set=new Eh(gn.xani_button),this.btn_set.InitButton("1号按钮90_60"),this.btn_set.Move(this.iX+this.iW-90-25,this.iY+this.iH-60-25,90,60),this.btn_set.sName="设置",this.btn_shadow=new Eh(gn.xani_button),this.btn_shadow.InitButton("1号按钮90_60"),this.btn_shadow.Move(this.iX+25,this.iY+this.iH-60-25,90,60),this.btn_shadow.sName="隐藏",this.sTitles=new Array(64),this.iCount=0,this.bNoTitile=!1,this.list_titles=new Oi(0,1,this.iW-50,this.iH-50-60-10),this.list_titles.SetTitle(0,"",this.iW-50,!1),this.list_titles.iTitleHeight=0}getlist(i){var t;for(i.GetNextByte(),this.iCount=i.GetNextByte(),t=0;t<this.iCount;t++)this.sTitles[t]=i.GetNextString();0==this.iCount&&(this.bNoTitile=!0)}Draw(){var i;if(E.frame_type4("10号框20_20",this.iX,this.iY,this.iW,this.iH,20,20),this.bNoTitile)c.gi().DrawTextEx(this.iX+45,this.iY+45+5,"没有可用称谓",4278190080,25,101,1,1,0,0,0);else{for(this.list_titles.BeginDraw(this.iX+25,this.iY+25),i=0;i<this.iCount;i++)this.list_titles.DrawUnit(0,i,this.sTitles[i]);this.list_titles.FinishDraw()}this.btn_set.Draw(),this.btn_shadow.Draw()}ProcTouch(i,t,s){return this.bNoTitile||this.list_titles.ProcTouch(i,t,s),this.btn_shadow.ProcTouch(i,t,s)?(this.btn_shadow.bCheck()&&(xh.me.rbs.sTitle="",Mh.gi().s_proctitle(99,""),ln.gi().PopStat(1)),!0):this.btn_set.ProcTouch(i,t,s)?(this.btn_set.bCheck()&&this.list_titles.iLockPoint>=0&&this.list_titles.iLockPoint<this.iCount&&(xh.me.rbs.sTitle=this.sTitles[this.list_titles.iLockPoint],Mh.gi().s_proctitle(this.list_titles.iLockPoint,this.sTitles[this.list_titles.iLockPoint]),ln.gi().PopStat(1)),!0):(3!=i||bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||ln.gi().PopStat(1),!1)}}class $a extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=490,this.iH=472,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_sel=new D(gn.xani_nui2),this.btn_sel.InitButton("按钮1_110"),this.btn_sel.sName="选择",this.btn_sel.Move(this.iX+this.iW-110-30,this.iY+this.iH-55-30,110,52),this.lockgoods=null}Draw(){E.new_bigframe(this.iX,this.iY,this.iW,this.iH),qi.new_DrawGoods(this.iX+30,this.iY+30,ht.gi().goods[2],null,null),c.gi().DrawTextEx(this.iX+30,this.iY+this.iH-30-52,$a.s1,4278190080,24,101,1,1,0,0,0),c.gi().DrawTextEx(this.iX+30,this.iY+this.iH-30-26,$a.s2,4278190080,24,101,1,1,0,0,0),null!=this.lockgoods&&(qi.new_DrawRect(this.iX+30,this.iY+30,ht.gi().goods[2],this.lockgoods,0),this.btn_sel.Draw()),qi.bShowDetail()&&qi.new_DrawDetail(null,-1,-1,0)}ProcTouch(i,t,s){return null!=this.lockgoods&&this.btn_sel.ProcTouch(i,t,s)?(this.btn_sel.bCheck()&&(Mh.gi().s_LandOperate(0,$a.iDest,this.lockgoods.iGid,0),ln.gi().PopStat(1)),!0):(this.lockgoods=qi.new_LockGoods(t,s,this.iX+30,this.iY+30,ht.gi().goods[2],i),qi.NoMove(),3!=i||bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||ln.gi().PopStat(1),!1)}}$a.s1,$a.s2,$a.iDest,$a.Open=function(i,t,s){ln.gi().PushStat(ln.GS_SELECTLS),$a.s1=i,$a.s2=t,$a.iDest=s};class tn extends s{constructor(i){var t;for(super(),this.iW=490,this.iH=410,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_give=new Array(5),t=0;t<5;t++)this.btn_give[t]=new D(gn.xani_ui3),this.btn_give[t].bSingleButton=!0;this.iWx=new Int32Array(5)}Draw(){var i;for(E.frame_type4("7号框52_52",this.iX,this.iY,this.iW,this.iH,52,52),c.gi().DrawTextEx(this.iX+20,this.iY+20,"土地类型:"+ji.sLandName[this.iType],4279324257,30,101,1,1,0,0,0),c.gi().DrawTextEx(this.iX+20,this.iY+20+40,"风水等级:"+this.iLev,4279324257,30,101,1,1,0,0,0),c.gi().DrawTextEx(this.iX+20,this.iY+20+80,"风水经验:"+this.iExp,4279324257,30,101,1,1,0,0,0),c.gi().DrawTextEx(this.iX+20,this.iY+20+120,"五行总灵气:"+(this.iWx[0]+this.iWx[1]+this.iWx[2]+this.iWx[3]+this.iWx[4])+"/"+(100+this.iExp),4279324257,30,101,1,1,0,0,0),i=0;i<5;i++)gn.xani_ui4.DrawAnimaEx(this.iX+40+90*i,this.iY+180,e.sWuXing[i]+"水晶",0,101,1,1,0,0,0),c.gi().DrawTextEx(this.iX+40+90*i+25,this.iY+180+160+25,this.iWx[i]+"/100",4279324257,20,101,1,1,0,-2,0),c.gi().DrawTextEx(this.iX+40+90*i+25,this.iY+180+160,e.sWuXing[i],4279324257,20,101,1,1,0,-2,0),this.btn_give[i].Move(this.iX+40+90*i-10,this.iY+180,70,160)}ProcTouch(i,t,s){var h;for(h=0;h<5;h++)if(this.btn_give[h].ProcTouch(i,t,s))return this.btn_give[h].bCheck()&&$a.Open(e.sWXS[h]+"生"+e.sWuXing[h]+"(选择"+e.sWXS[h]+"灵石)",e.sWXK[h]+"克"+e.sWuXing[h]+"(选择"+e.sWXK[h]+"灵石)",h),!0;return 3==i&&!bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)&&(ln.gi().PopStat(1),!0)}}tn.Open=function(i){var t;(t=ln.gi().iXStat==ln.GS_LANDFRAME?ln.gi().LastStat(0):ln.gi().PushStat(ln.GS_LANDFRAME)).iLid=i.GetNextInt(),t.iType=i.GetNextInt(),t.iLev=i.GetNextInt(),t.iExp=i.GetNextInt(),t.iWx[0]=i.GetNextInt(),t.iWx[1]=i.GetNextInt(),t.iWx[2]=i.GetNextInt(),t.iWx[3]=i.GetNextInt(),t.iWx[4]=i.GetNextInt()};class sn extends s{constructor(i){super(),this.iW=400,this.iH=320,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_op=new Eh(gn.xani_button),this.btn_op.InitButton("1号按钮90_60"),this.btn_op.Move(this.iX+250,this.iY+20+215,90,60),this.btn_op.sName="申请",this.btn_pick=new Eh(gn.xani_button),this.btn_pick.InitButton("1号按钮90_60"),this.btn_pick.Move(this.iX+250,this.iY+20+215,90,60),this.btn_pick.sName="采摘",this.btn_clear=new Eh(gn.xani_button),this.btn_clear.InitButton("1号按钮90_60"),this.btn_clear.Move(this.iX+250,this.iY+20+215,90,60),this.btn_clear.sName="清理",this.sStage=["幼苗期","成长期","采摘期","枯萎","枯萎"]}Draw(){if(E.frame_type4("7号框52_52",this.iX,this.iY,this.iW,this.iH,52,52),c.gi().DrawTextEx(this.iX+20,this.iY+20,"名称:"+gn.de_grow.strValue(this.iGType,0,1),4279324257,30,101,1,1,0,0,0),c.gi().DrawTextEx(this.iX+20,this.iY+20+40,"五行:"+e.sWuXing[this.iWx],4279324257,30,101,1,1,0,0,0),c.gi().DrawTextEx(this.iX+20,this.iY+20+80,"品质:"+this.iQuality,4279324257,30,101,1,1,0,0,0),this.iTime>=3)return c.gi().DrawTextEx(this.iX+20,this.iY+20+120,"成长阶段:"+this.sStage[this.iTime],4279324257,30,101,1,1,0,0,0),this.btn_clear.Move(this.iX+250,this.iY+20+120-5,90,60),void this.btn_clear.Draw();switch(2==this.iTime&&(this.btn_pick.Move(this.iX+250,this.iY+20+120-5,90,60),this.btn_pick.Draw()),c.gi().DrawTextEx(this.iX+20,this.iY+20+120,"成长阶段:"+this.sStage[this.iTime],4279324257,30,101,1,1,0,0,0),c.gi().DrawTextEx(this.iX+20,this.iY+20+160,this.iNextTime+"小时后进入"+this.sStage[this.iTime+1],4279324257,30,101,1,1,0,0,0),this.iStat){case 0:default:c.gi().DrawTextEx(this.iX+20,this.iY+20+220,"当前状态:正常",4278255360,30,101,1,1,0,0,0);break;case 1:c.gi().DrawTextEx(this.iX+20,this.iY+20+220,"当前状态:干燥",4294901760,30,101,1,1,0,0,0),this.btn_op.sName="取水",this.btn_op.Draw();break;case 2:c.gi().DrawTextEx(this.iX+20,this.iY+20+220,"当前状态:虫害",4294901760,30,101,1,1,0,0,0),this.btn_op.sName="驱虫",this.btn_op.Draw();break;case 3:c.gi().DrawTextEx(this.iX+20,this.iY+20+220,"当前状态:杂草",4294901760,30,101,1,1,0,0,0),this.btn_op.sName="除草",this.btn_op.Draw();break;case 4:c.gi().DrawTextEx(this.iX+20,this.iY+20+220,"当前状态:已采摘",4291346407,30,101,1,1,0,0,0);break;case 5:c.gi().DrawTextEx(this.iX+20,this.iY+20+220,"当前状态:可采摘",4291346407,30,101,1,1,0,0,0)}}ProcTouch(i,t,s){if(this.iStat>0&&this.btn_op.ProcTouch(i,t,s)){if(this.btn_op.bCheck()){switch(this.iStat){case 1:Mh.gi().s_LandOperate(1,0,0,0);break;case 2:Mh.gi().s_LandOperate(2,0,0,0);break;case 3:Mh.gi().s_LandOperate(3,0,0,0)}ln.gi().PopStat(1)}return!0}return this.iTime>=3&&this.btn_clear.ProcTouch(i,t,s)?(this.btn_clear.bCheck()&&(Mh.gi().s_LandOperate(5,this.iZid,0,0),ln.gi().PopStat(1)),!0):2==this.iTime&&this.btn_pick.ProcTouch(i,t,s)?(this.btn_pick.bCheck()&&(Mh.gi().s_LandOperate(4,this.iZid,0,0),ln.gi().PopStat(1)),!0):3==i&&!bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)&&(ln.gi().PopStat(1),!0)}}sn.Open=function(i){var t;(t=ln.gi().iXStat==ln.GS_PLANTFRAME?ln.gi().LastStat(0):ln.gi().PushStat(ln.GS_PLANTFRAME)).iZid=i.GetNextInt(),t.iGType=i.GetNextInt(),t.iTime=i.GetNextInt(),t.iNextTime=i.GetNextInt(),t.iQuality=i.GetNextInt(),t.iStat=i.GetNextInt(),t.iWx=i.GetNextInt()};class en extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=710,this.iH=405,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.lockgoods=null,this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_recover=new Eh(gn.xani_nui2),this.btn_recover.InitButton("按钮1_110"),this.btn_recover.sName="出售",this.btn_recover.Move(this.iX+this.iW-110-30,this.iY+this.iH-52-30,110,52),this.bCanRecover=!1}Draw(){var i,t;E.new_bigframe(this.iX,this.iY,this.iW,this.iH),this.btn_close.Draw(),qi.new_DrawGoods(this.iX+30,this.iY+30,ht.gi().goods[2],null,null),null!=this.lockgoods&&this.lockgoods.iGid>0&&(qi.new_DrawRect(this.iX+30,this.iY+30,ht.gi().goods[2],this.lockgoods,0),i=gn.de_goods.intValue(this.lockgoods.iTid,0,9),this.bCanRecover=!1,i<0||i>40?this.pm3f.DrawTextEx(this.iX+430+30+20,this.iY+35,"本店不收此物品",4278206039,30,101,1,1,0,0,0):(this.bCanRecover=!0,t=0,0==i?t=50:10==i?t=500:20==i?t=2e3:30==i?t=4500:40==i&&(t=7e3),this.pm3f.DrawTextEx(this.iX+430+30+20,this.iY+35,"回收价格 "+t,4278206039,30,101,1,1,0,0,0)),this.btn_recover.Draw()),qi.bShowDetail()&&qi.new_DrawDetail(null,-1,-1,0)}ProcTouch(i,t,s){return this.btn_close.ProcTouch(i,t,s)?(this.btn_close.bCheck()&&ln.gi().PopStat(1),!0):null!=this.lockgoods&&this.btn_recover.ProcTouch(i,t,s)?(this.btn_recover.bCheck()&&(Mh.gi().s_RecoverGoods(this.lockgoods.iGid),this.lockgoods=null,qi.new_LockGoods(t,s,this.iX+30,this.iY+30,ht.gi().goods[2],i)),!0):(this.lockgoods=qi.new_LockGoods(t,s,this.iX+30,this.iY+30,ht.gi().goods[2],i),qi.NoMove(),3!=i||bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||ln.gi().PopStat(1),!1)}}class hn extends s{constructor(i){super(),this.iW=360,this.iH=280,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_shelves=new Eh(gn.xani_nui3),this.btn_shelves.InitButton("内框按钮"),this.btn_shelves.sName="上架",this.btn_shelves.Move(this.iX+20,this.iY+this.iH-55-20,98,55),this.btn_cancel=new Eh(gn.xani_nui3),this.btn_cancel.InitButton("内框按钮"),this.btn_cancel.sName="取消",this.btn_cancel.Move(this.iX+this.iW-98-20,this.iY+this.iH-55-20,98,55),this.chk_watch=new T(gn.xani_nui3),this.chk_watch.InitBox("统一勾选"),this.chk_watch.bTrue=!1,this.chk_watch.Move(this.iX+10,this.iY+130,50,50),this.in_number=new vs(gn.xani_nui3),this.in_number.MinMax(0,99999999)}Draw(){var i;E.new_framewatch(this.iX,this.iY,this.iW,this.iH),i=this.iY+20,null!=ct.gi().lockgoods?c.gi().DrawTextEx(this.iX+20,i,"物品："+gn.de_goods.strValue(ct.gi().lockgoods.iTid,-1,4),4294967295,30,100,1,1,0,0,0):null!=ct.gi().lockpet&&c.gi().DrawTextEx(this.iX+20,i,"宠物："+ct.gi().lockpet.sName,4294967295,30,100,1,1,0,0,0),i+=60,c.gi().DrawTextEx(this.iX+20,i,"上架价格:",4294967295,30,100,1,1,0,0,0),this.in_number.Move(this.iX+20+130,i-10,this.iW-170),this.in_number.Draw(),i+=70,c.gi().DrawTextEx(this.iX+80,i,"观赏",4294967295,30,100,1,1,0,0,0),this.chk_watch.Move(this.iX+20,i-10,50,50),this.chk_watch.Draw(),this.btn_shelves.Draw(),this.btn_cancel.Draw()}ProcTouch(i,t,s){return this.btn_shelves.ProcTouch(i,t,s)?(this.btn_shelves.bCheck()&&(this.chk_watch.bTrue?(null!=ct.gi().lockgoods&&Mh.gi().s_StartSell(1,ct.gi().lockgoods.iGid,0,""),null!=ct.gi().lockpet&&Mh.gi().s_StartSell(3,ct.gi().lockpet.iPid,0,""),ln.gi().PopStat(1)):this.in_number.iNumber>0?(null!=ct.gi().lockgoods&&Mh.gi().s_StartSell(1,ct.gi().lockgoods.iGid,this.in_number.iNumber,""),null!=ct.gi().lockpet&&Mh.gi().s_StartSell(3,ct.gi().lockpet.iPid,this.in_number.iNumber,""),ln.gi().PopStat(1)):L.easymsg.AddMessage("请先输入上架价格")),!0):this.btn_cancel.ProcTouch(i,t,s)?(this.btn_cancel.bCheck()&&ln.gi().PopStat(1),!0):(this.in_number.ProcTouch(i,t,s),this.chk_watch.ProcTouch(i,t,s),!1)}}class an extends s{constructor(i){var t;for(super(),this.goods=new Array(20),this.iPrice=new Int32Array(20),t=0;t<20;t++)this.goods[t]=new Li,this.iPrice[t]=0;this.iW=800,this.iH=450,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_buy=new Eh(gn.xani_button),this.btn_buy.InitButton("普通按钮140_55"),this.btn_buy.sName="购买",this.lockgoods=null}_open(i){this.iCount=i.GetNextInt(),this.iCount>20&&(this.iCount=20);for(var t=0;t<20;t++)t<this.iCount?(this.goods[t].iTid=i.GetNextInt(),this.goods[t].iGid=1,this.goods[t].iCount=1,this.iPrice[t]=i.GetNextInt(),gn.xani_ngoods.InitAnimaWithName(gn.de_goods.strValue(this.goods[t].iTid,0,10),this.goods[t].aa)):(this.goods[t].iGid=-1,this.iPrice[t]=0),this.goods[t].iPos=t}Draw(){E.new_baseframe4(this.iX,this.iY,this.iW,this.iH,"积","分","商","店"),this.btn_close.Draw(),E.new_framein(this.iX+30,this.iY+30,this.iW-60,this.iH-60),qi.new_DrawGoods(this.iX+50,this.iY+50,this.goods,null,null),null!=this.lockgoods&&(qi.new_DrawRect(this.iX+50,this.iY+50,this.goods,this.lockgoods,0),c.gi().DrawTextEx(this.iX+430+50+15,this.iY+90+0,"名称 "+gn.de_goods.strValue(this.lockgoods.iTid,0,4),4278206039,25,101,1,1,0,0,0),c.gi().DrawTextEx(this.iX+430+50+15,this.iY+90+50,"价格 "+this.iPrice[this.lockgoods.iPos]+"积分",4278206039,25,101,1,1,0,0,0)),c.gi().DrawTextEx(this.iX+430+50+15,this.iY+90+150,"可用积分："+xh.me.iFlagExt[23],4294967040,25,101,1,1,0,0,-2),this.btn_buy.Move(this.iX+this.iW-30-20-140,this.iY+this.iH-30-20-55,140,55),this.btn_buy.Draw(),qi.bShowDetail()&&qi.new_DrawDetail(null,-1,-1,0)}ProcTouch(i,t,s){return this.btn_buy.ProcTouch(i,t,s)?(this.btn_buy.bCheck()&&(null==this.lockgoods?L.easymsg.AddMessage("请先选中物品"):xh.me.iFlagExt[23]<this.iPrice[this.lockgoods.iPos]?L.easymsg.AddMessage("积分不足"):Mh.gi().s_SeverEvent(35,1,this.lockgoods.iPos,this.lockgoods.iTid,this.iPrice[this.lockgoods.iPos])),!0):(e=qi.new_LockGoods(t,s,this.iX+50,this.iY+50,this.goods,i),qi.NoMove(),3==i&&null!=e?this.lockgoods=e:null==e&&(this.lockgoods=null),this.btn_close.ProcTouch(i,t,s)&&this.btn_close.bCheck()&&ln.gi().PopStat(1),!1);var e}}an.Open=function(i){var t=ln.gi().FindStat(ln.GS_PEAKFIGHTSHOP);null==t&&(t=ln.gi().PushStat(ln.GS_PEAKFIGHTSHOP)),t._open(i)};class nn extends s{constructor(i){var t;for(super(),this.iW=630,this.iH=600,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_close=new Eh(gn.xani_nui2),this.btn_close.InitButton("关闭按钮"),this.btn_change=new Eh(gn.xani_nui2),this.btn_change.InitButton("按钮1"),this.btn_change.sName="确定",this.btncs=new Array(16),this.btn_dest=new Array(16),t=0;t<16;t++)this.btncs[t]=new Int32Array(5),this.btn_dest[t]=new D(gn.xani_nui4);for(this.iDestPoint=0,this.iOpenPoint=-1,this.iOffH=0,this.iShowH=this.iH-30-30-20-20,this.ResetButton(!0),this.bLocked1=!1,this.in_lev1=new vs(gn.xani_nui3),this.in_lev1.iNumber=0,this.in_lev1.MinMax(0,100),this.in_lev2=new vs(gn.xani_nui3),this.in_lev2.iNumber=80,this.in_lev2.MinMax(0,100),t=0;t<this.iDestCount;t++)this.btncs[t][0]==MyTeam.iTeamTarget&&(this.iDestPoint=t,this.in_lev1.iNumber=MyTeam.iLev1,this.in_lev2.iNumber=MyTeam.iLev2)}ResetButton(i){var t;this.iDestCount=0,this.btn_dest[this.iDestCount].InitButton("组队类型1"),this.btn_dest[this.iDestCount].sName="无目标",this.btncs[this.iDestCount][0]=0,this.btncs[this.iDestCount][1]=0,this.btncs[this.iDestCount][2]=0,this.btncs[this.iDestCount][3]=0,this.btncs[this.iDestCount][4]=80,this.iDestCount++,xh.me.rbs.iLev>=10&&(this.btn_dest[this.iDestCount].InitButton("组队类型1"),this.btn_dest[this.iDestCount].sName="为民除害",this.btncs[this.iDestCount][0]=1,this.btncs[this.iDestCount][1]=0,this.btncs[this.iDestCount][2]=0,this.btncs[this.iDestCount][3]=10,this.btncs[this.iDestCount][4]=80,this.iDestCount++),xh.me.rbs.iLev>=20&&(this.btn_dest[this.iDestCount].InitButton("组队类型1"),this.btn_dest[this.iDestCount].sName="追捕强盗",this.btncs[this.iDestCount][0]=2,this.btncs[this.iDestCount][1]=0,this.btncs[this.iDestCount][2]=0,this.btncs[this.iDestCount][3]=20,this.btncs[this.iDestCount][4]=80,this.iDestCount++),xh.me.rbs.iLev>=30&&(this.btn_dest[this.iDestCount].InitButton("组队类型1"),this.btn_dest[this.iDestCount].sName="山贼宝图",this.btncs[this.iDestCount][0]=3,this.btncs[this.iDestCount][1]=0,this.btncs[this.iDestCount][2]=0,this.btncs[this.iDestCount][3]=30,this.btncs[this.iDestCount][4]=80,this.iDestCount++),xh.me.rbs.iLev>=40&&(this.btn_dest[this.iDestCount].InitButton("组队类型1"),this.btn_dest[this.iDestCount].sName="挑战嚣张",this.btncs[this.iDestCount][0]=4,this.btncs[this.iDestCount][1]=0,this.btncs[this.iDestCount][2]=0,this.btncs[this.iDestCount][3]=40,this.btncs[this.iDestCount][4]=80,this.iDestCount++),xh.me.rbs.iLev>=20&&(this.btn_dest[this.iDestCount].InitButton("组队类型1"),this.btn_dest[this.iDestCount].sName="封印叔叔",this.btncs[this.iDestCount][0]=5,this.btncs[this.iDestCount][1]=0,this.btncs[this.iDestCount][2]=0,this.btncs[this.iDestCount][3]=20,this.btncs[this.iDestCount][4]=80,this.iDestCount++),this.btn_dest[this.iDestCount].InitButton("组队类型1"),this.btn_dest[this.iDestCount].sName="定时活动",this.btncs[this.iDestCount][0]=99,this.btncs[this.iDestCount][1]=0,i&&(this.iOpenPoint=this.iDestCount),t=this.iDestCount,this.iOpenPoint==t?this.btncs[this.iDestCount][2]=1:this.btncs[this.iDestCount][2]=2,this.btncs[this.iDestCount][3]=20,this.btncs[this.iDestCount][4]=80,this.iDestCount++,this.iOpenPoint==t&&xh.me.rbs.iLev>=30&&(this.btn_dest[this.iDestCount].InitButton("组队类型2"),this.btn_dest[this.iDestCount].sName="门派闯关",this.btncs[this.iDestCount][0]=6,this.btncs[this.iDestCount][1]=0,this.btncs[this.iDestCount][2]=0,this.btncs[this.iDestCount][3]=30,this.btncs[this.iDestCount][4]=80,this.iDestCount++,this.btn_dest[this.iDestCount].InitButton("组队类型2"),this.btn_dest[this.iDestCount].sName="保卫西阳",this.btncs[this.iDestCount][0]=7,this.btncs[this.iDestCount][1]=0,this.btncs[this.iDestCount][2]=0,this.btncs[this.iDestCount][3]=30,this.btncs[this.iDestCount][4]=80,this.iDestCount++),this.iDestH=85*this.iDestCount-5+40}Draw(){var i,t,s,e,h;for(E.frame_type4("中等框a52_50",this.iX,this.iY,this.iW,this.iH,52,50),this.btn_close.Move(this.iX+this.iW-35,this.iY-25,60,60),this.btn_close.Draw(),this.bLocked1||(this.iOffH>0&&(this.iOffH/=2),i=this.iDestH<this.iShowH?this.iDestH:this.iShowH,(t=this.iDestH+this.iOffH)<i&&(this.iOffH+=(i-t)/2)),s=this.iX+30,e=this.iY+30,270,h=this.iH-60,E.new_framein(s,e,270,h),c.gi().SetViewClip(s+20,e+20,s+20+230,e+20+this.iShowH),i=0;i<this.iDestCount;i++)this.btn_dest[i].Move(s+20,e+20+85*i+this.iOffH,230,80),i==this.iDestPoint&&(this.btn_dest[i].bMouseIn=!0,this.btn_dest[i].bMouseDown=!0),this.btn_dest[i].Draw(),1==this.btncs[i][2]?gn.xani_nui4.DrawAnima(this.btn_dest[i].iX,this.btn_dest[i].iY,"组队目录开关",1):2==this.btncs[i][2]&&gn.xani_nui4.DrawAnima(this.btn_dest[i].iX,this.btn_dest[i].iY,"组队目录开关",0);c.gi().NoClip(),s+=300,E.new_framein(s,e,270,h),this.btncs[this.iDestPoint][0]<90&&(c.gi().DrawTextEx(s+30,e+100,"等级下限:",4294967295,30,101,1,1,0,0,0),this.in_lev1.Move(s+90,e+100+40,150),this.in_lev1.Draw(),c.gi().DrawTextEx(s+30,e+100+120,"等级上限:",4294967295,30,101,1,1,0,0,0),this.in_lev2.Move(s+90,e+100+40+120,150),this.in_lev2.Draw(),this.btn_change.Move(this.iX+this.iW-30-30-161,this.iY+this.iH-30-30-53,161,53),this.btn_change.Draw())}ProcTouch(i,t,s){if(3==i&&this.bLocked1)return this.bLocked1=!1,!0;var e,h,a;if(h=this.iX+30,a=this.iY+30,bn.bInRect(t,s,h,a,270,20+this.iShowH)){for(e=0;e<this.iDestCount;e++)this.btn_dest[e].ProcTouch(i,t,s)&&this.btn_dest[e].bCheck()&&(this.iDestPoint=e,this.in_lev1.iNumber=this.btncs[e][3],this.in_lev2.iNumber=this.btncs[e][4],99==this.btncs[e][0]&&(this.iOpenPoint<0?this.iOpenPoint=e:this.iOpenPoint=-1,this.ResetButton(!1)));if(1==i&&(this.iLockY=s),2==i&&!this.bLocked1&&((e=this.iLockY-s)<-15||e>15))for(this.bLocked1=!0,e=0;e<this.iDestCount;e++)this.btn_dest[e].bMouseDown=!1}if(2==i&&this.bLocked1)return e=this.iLockY-s,this.iOffH-=e,this.iLockY=s,!0;if(this.btncs[this.iDestPoint][0]<90){if(this.in_lev2.bShow){if(this.in_lev2.ProcTouch(i,t,s))return this.in_lev2.bShow||this.in_lev2.iNumber<this.in_lev1.iNumber&&(this.in_lev2.iNumber=this.in_lev1.iNumber),!0}else{if(this.in_lev1.ProcTouch(i,t,s))return this.in_lev1.bShow||this.in_lev1.iNumber>this.in_lev2.iNumber&&(this.in_lev1.iNumber=this.in_lev2.iNumber),!0;if(this.in_lev2.ProcTouch(i,t,s))return!0}if(this.btn_change.ProcTouch(i,t,s))return this.btn_change.bCheck()&&(Mh.gi().s_TeamOperateEx(13,this.btncs[this.iDestPoint][0],this.btncs[this.iDestPoint][1],this.in_lev1.iNumber,this.in_lev2.iNumber),ln.gi().PopStat(1)),!0}return this.btn_close.ProcTouch(i,t,s)?(this.btn_close.bCheck()&&ln.gi().PopStat(1),!0):(3!=i||bn.bInRect(t,s,this.iX,this.iY,this.iW,this.iH)||ln.gi().PopStat(1),!1)}}nn.Open=function(){ln.gi().CheckStat(ln.GS_TEAMDEST)||ln.gi().PushStat(ln.GS_TEAMDEST)};class on{constructor(){var i;for(on.bCheckTradeing=!1,this.dgs=new Array(3),this.dgcount=new Int32Array(3),this.dps=new Array(3),i=0;i<3;i++)this.dgs[i]=new Li,this.dps[i]=new Hi;this.mgs=new Array(3),this.mps=new Array(3)}tradestart(i){var t;for(this.iDRid=i.GetNextInt(),this.sDName=i.GetNextString(),t=0;t<3;t++)this.dgs[t].iGid=-1,this.dgcount[t]=1,this.dps[t].iPid=-1,this.mgs[t]=null,this.mps[t]=null;this.dproc=0,this.mproc=0,ln.gi().PushStat(ln.GS_MYTRADEFRAME),on.bCheckTradeing=!0}tradeready(i){for(var t,s=0,e=0;;)switch(i.GetNextByte()){case 0:return void(this.dproc=1);case 1:for(this.dgs[s].iGid=i.GetNextInt(),this.dgs[s].iTid=i.GetNextShort(),this.dgs[s].iCount=i.GetNextByte(),t=0;t<8;t++)this.dgs[s].iAtts[t]=i.GetNextInt();gn.xani_ngoods.InitAnimaWithName(gn.de_goods.strValue(this.dgs[s].iTid,-1,10),this.dgs[s].aa),s++;break;case 2:for(this.dps[e].iPid=i.GetNextInt(),this.dps[e].iTid=i.GetNextShort(),this.dps[e].sName=i.GetNextString(),this.dps[e].iLev=i.GetNextShort(),this.dps[e].iExp=i.GetNextInt(),this.dps[e].iHp=i.GetNextShort(),this.dps[e].iMp=i.GetNextShort(),this.dps[e].iLife=i.GetNextShort(),t=0;t<5;t++)this.dps[e].iBaseAtt[t]=i.GetNextShort();for(t=0;t<5;t++)this.dps[e].zz[t]=i.GetNextShort();for(this.dps[e].cz=i.GetNextShort(),t=0;t<8;t++)this.dps[e].jn[t]=i.GetNextShort();this.dps[e].iAddAtt=i.GetNextByte(),this.dps[e].iBaobao=i.GetNextByte(),this.dps[e].iFlag=i.GetNextShort(),this.dps[e].sName=gn.de_pet.strValue(this.dps[e].iTid,0,1),0!=(1&this.dps[e].iBaobao)&&(this.dps[e].sName=this.dps[e].sName+"宝宝"),0!=(2&this.dps[e].iBaobao)&&(this.dps[e].sName="变异"+this.dps[e].sName),e++;break;case 3:this.dmoney=i.GetNextInt()}}}on.bCheckTradeing=!1,on.mt=new on;class rn extends s{constructor(i){var t;for(super(),this.maxcount=[999,999,999],this.pani=i,this.pm3f=i.pm3f,this.iW=680,this.iH=475,this.iX=(h.SCRW-this.iW)/2,this.iY=(h.SCRH-this.iH)/2,this.btn_dgoods=new Array(3),this.btn_dpet=new Array(3),this.btn_mgoods=new Array(3),this.btn_mpet=new Array(3),this.in_count=new Array(3),t=0;t<3;t++)this.btn_dgoods[t]=new D(gn.xani_nui3),this.btn_dgoods[t].InitButton("物品格子"),this.btn_mgoods[t]=new D(gn.xani_nui3),this.btn_mgoods[t].InitButton("物品格子"),this.btn_dpet[t]=new D(gn.xani_nui2),this.btn_dpet[t].InitButton("宠物头像框"),this.btn_mpet[t]=new D(gn.xani_nui2),this.btn_mpet[t].InitButton("宠物头像框"),this.in_count[t]=new vs(gn.xani_nui3),this.in_count[t].iNumber=1;for(this.btn_selgp=new Array(8),t=0;t<8;t++)this.btn_selgp[t]=new Eh(gn.xani_button),this.btn_selgp[t].InitButton("3号按钮250_42");this.bSelectGoods=!1,this.lockgoods=null,this.iPetPoint=0,this.iPetSelect=-1,this.iShowDGoodsPoint=-1,this.in_money=new vs(gn.xani_nui3),this.in_money.iNumber=0,this.in_money.MinMax(0,xh.me.rbs.iMoney),this.btn_ready=new D(gn.xani_nui3),this.btn_ready.InitButton("内框按钮"),this.btn_ready.Move(this.iX+this.iW/2+30,this.iY+this.iH-30-55,98,55),this.btn_ready.sName="准备",this.btn_trade=new D(gn.xani_nui3),this.btn_trade.InitButton("内框按钮"),this.btn_trade.Move(this.iX+this.iW/2+30,this.iY+this.iH-30-55,98,55),this.btn_trade.sName="交易",this.btn_close=new D(gn.xani_nui3),this.btn_close.InitButton("内框按钮"),this.btn_close.Move(this.iX+this.iW-98-30,this.iY+this.iH-30-55,98,55),this.btn_close.sName="取消"}Draw(){var i,t,s,e,a,n;for(E.new_bigframe(this.iX,this.iY,this.iW/2,this.iH),E.new_bigframe(this.iX+this.iW/2,this.iY,this.iW/2,this.iH),s=this.iX+30,e=this.iY+30,this.pm3f.DrawTextEx(s,e,on.mt.sDName+"("+on.mt.iDRid+")",4278190080,30,101,1,1,0,0,0),e+=45,i=0;i<3;i++)this.btn_dgoods[i].Move(s+100*i,e,80,80),this.btn_dgoods[i].Draw(),on.mt.dproc>=1&&on.mt.dgs[i].iGid>0?(qi.new_DrawOneGoods(this.btn_dgoods[i].iX,this.btn_dgoods[i].iY,on.mt.dgs[i],null,null),E.new_Text(this.btn_dgoods[i].iX,this.btn_dgoods[i].iY+80+10,80,""+on.mt.dgs[i].iCount)):E.new_Text(this.btn_dgoods[i].iX,this.btn_dgoods[i].iY+80+10,80,"");for(e+=140,this.pm3f.DrawTextEx(s+10,e+25,"铜币:",4278190080,30,101,1,1,0,0,-2),0==on.mt.dproc?E.new_Text(s+100,e+10,180,""):E.new_Text(s+100,e+10,180,""+on.mt.dmoney),e+=65,this.pm3f.DrawTextEx(s+10,e+40,"宠物:",4278190080,30,101,1,1,0,0,-2),i=0;i<2;i++)this.btn_dpet[i].Move(s+100+100*i,e,80,80),gn.xani_nui2.DrawAnima(this.btn_dpet[i].iX,this.btn_dpet[i].iY,"宠物头像框",0),on.mt.dproc>=1&&on.mt.dps[i].iPid>0&&gn.xani_head.DrawAnima_aa(s+100+100*i,e,gn.de_pet.strValue(on.mt.dps[i].iTid,0,1),0);for(e+=110,0==on.mt.dproc?this.pm3f.DrawText_2(this.iX+this.iW/4,e+15,"未准备",4294901760,30,101,1,1,0,-2,0,1,4278190080):1==on.mt.dproc&&this.pm3f.DrawText_2(this.iX+this.iW/4,e+15,"已准备",4278255360,30,101,1,1,0,-2,0,1,4278190080),s=this.iX+this.iW/2+30,e=this.iY+30,e+=45,i=0;i<3;i++)this.btn_mgoods[i].Move(s+100*i,e,80,80),this.btn_mgoods[i].Draw(),null!=on.mt.mgs[i]&&qi.new_DrawOneGoods_ext(this.btn_mgoods[i].iX,this.btn_mgoods[i].iY,on.mt.mgs[i],this.in_count[i].iNumber);for(i=0;i<3;i++)null!=on.mt.mgs[i]&&((t=gn.de_goods.intValue(on.mt.mgs[i].iTid,0,28))>1?(this.in_count[i].Move(this.btn_mgoods[i].iX,this.btn_mgoods[i].iY+80,80),this.in_count[i].MinMax(1,on.mt.mgs[i].iCount),this.in_count[i].Draw()):this.in_count[i].iNumber=1);for(e+=140,this.pm3f.DrawTextEx(s+10,e+25,"铜币:",4278190080,30,101,1,1,0,0,-2),this.in_money.Move(s+100,e,180),this.in_money.Draw(),e+=65,this.pm3f.DrawTextEx(s+10,e+40,"宠物:",4278190080,30,101,1,1,0,0,-2),i=0;i<2;i++)this.btn_mpet[i].Move(s+100+100*i,e,80,80),gn.xani_nui2.DrawAnima(this.btn_mpet[i].iX,this.btn_mpet[i].iY,"宠物头像框",0),null!=on.mt.mps[i]&&on.mt.mps[i].iPid>0&&gn.xani_head.DrawAnima_aa(s+100+100*i,e,gn.de_pet.strValue(on.mt.mps[i].iTid,0,1),0);for(e+=110,0==on.mt.mproc?(this.pm3f.DrawText_2(this.iX+this.iW/2+this.iW/4,e+15,"未准备",4294901760,30,101,1,1,0,-2,0,1,4278190080),this.btn_ready.Draw()):1==on.mt.mproc?this.pm3f.DrawText_2(this.iX+this.iW/2+this.iW/4,e+15,"已准备",4278255360,30,101,1,1,0,-2,0,1,4278190080):2==on.mt.mproc&&this.pm3f.DrawText_2(this.iX+this.iW/2+30,e+15,"等待对方交易",4278255360,30,101,1,1,0,0,0,1,4278190080),1==on.mt.mproc&&on.mt.dproc>=1&&this.btn_trade.Draw(),this.btn_close.Draw(),i=0;i<3;i++)on.mt.dproc>=1&&on.mt.dgs[i].iGid>0&&this.iShowDGoodsPoint==i&&qi.new_DrawDetail(on.mt.dgs[i],this.btn_dgoods[i].iX,this.btn_dgoods[i].iY,0);if(this.bSelectGoods&&(a=490,n=405,s=(h.SCRW-a)/2,e=(h.SCRH-n)/2,this.iGx=s+30,this.iGy=e+30,E.new_bigframe(s,e,a,n),qi.new_DrawGoods(s+30,e+30,ht.gi().goods[2],on.mt.mgs,this.maxcount),null!=this.lockgoods&&(qi.new_DrawRect(s+30,e+30,ht.gi().goods[2],this.lockgoods,0),qi.bShowDetail()&&qi.new_DrawDetail(this.lockgoods,-1,-1,0))),this.bSelectPet)for(a=310,n=50*Bi.mp.iPetCount+50,s=(h.SCRW-a)/2,e=(h.SCRH-n)/2,E.frame_type4("10号框20_20",s,e,a,n,20,20),i=0;i<Bi.mp.iPetCount;i++){for(t=0;t<2&&Bi.mp.pets[i]!=on.mt.mps[t];t++);t<2||(this.btn_selgp[i].Move(s+30,e+30+50*i,250,42),this.btn_selgp[i].sName=Bi.mp.pets[i].sName,this.btn_selgp[i].Draw())}}ProcTouch(i,t,s){var e,a,n,o,r;if(0==on.mt.mproc){if(this.bSelectPet){for(310,r=50*Bi.mp.iPetCount+50,n=(h.SCRW-310)/2,o=(h.SCRH-r)/2,e=0;e<Bi.mp.iPetCount;e++){for(a=0;a<2&&Bi.mp.pets[e]!=on.mt.mps[a];a++);a<2||this.btn_selgp[e].ProcTouch(i,t,s)&&this.btn_selgp[e].bCheck()&&(this.iPetSelect=e,parseInt(Bi.mp.pets[this.iPetSelect].iFlag/100)%10==0?(this.bSelectPet=!1,on.mt.mps[this.iPetPoint]=Bi.mp.pets[this.iPetSelect]):L.easymsg.AddMessage("绑定宠物无法交易"))}return 3!=i||bn.bInRect(t,s,n,o,310,r)||(this.bSelectPet=!1),!0}if(this.bSelectGoods){if(this.lockgoods=qi.new_LockGoods(t,s,this.iGx,this.iGy,ht.gi().goods[2],i),null!=this.lockgoods){for(e=0;e<3;e++)if(on.mt.mgs[e]==this.lockgoods)return this.lockgoods=null,!0;if(qi.bCanProc())return on.mt.mgs[this.iGoodsPoint]=this.lockgoods,this.bSelectGoods=!1,this.lockgoods=null,this.in_count[this.iGoodsPoint].iNumber=1,!0}return 3!=i||bn.bInRect(t,s,this.iGx-30,this.iGy-30,490,405)||(this.bSelectGoods=!1),!0}if(this.in_money.ProcTouch(i,t,s))return!0;for(e=0;e<3;e++)if(null!=on.mt.mgs[e]&&(a=gn.de_goods.intValue(on.mt.mgs[e].iTid,0,28))>1&&this.in_count[e].ProcTouch(i,t,s))return!0;for(e=0;e<3;e++)this.btn_mgoods[e].ProcTouch(i,t,s)&&this.btn_mgoods[e].bCheck()&&(null==on.mt.mgs[e]?(this.iGoodsPoint=e,this.bSelectGoods=!0,this.lockgoods=null):on.mt.mgs[e]=null);for(e=0;e<2;e++)if(this.btn_mpet[e].ProcTouch(i,t,s))return this.btn_mpet[e].bCheck()&&(null==on.mt.mps[e]?(this.iPetPoint=e,this.iPetSelect=-1,this.bSelectPet=!0):on.mt.mps[e]=null),!0;if(this.btn_ready.ProcTouch(i,t,s)){if(this.btn_ready.bCheck()){var c=new Int32Array(10);for(e=0;e<10;e++)c[e]=0;for(e=0;e<3;e++)null==on.mt.mgs[e]?c[2*e]=0:(c[2*e]=on.mt.mgs[e].iGid,c[2*e+1]=this.in_count[e].iNumber),null==on.mt.mps[e]?c[e+6]=0:c[e+6]=on.mt.mps[e].iPid;this.in_money.iNumber>0&&this.in_money.iNumber<=xh.me.rbs.iMoney&&(c[9]=this.in_money.iNumber),Mh.gi().s_Trade(1,c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7],c[8],c[9]),on.mt.mproc=1}return!0}}if(1==on.mt.dproc){for(this.iShowDGoodsPoint=-1,e=0;e<3;e++)if(this.btn_dgoods[e].ProcTouch(i,t,s))return this.btn_dgoods[e].bCheck()&&on.mt.dgs[e].iGid>0&&(this.iShowDGoodsPoint=e),!0;for(e=0;e<2;e++)if(this.btn_dpet[e].ProcTouch(i,t,s))return this.btn_dpet[e].bCheck()&&on.mt.dps[e].iPid>0&&oa.Init_Pet(on.mt.dps[e]),!0}return 1==on.mt.mproc&&on.mt.dproc>=1&&this.btn_trade.ProcTouch(i,t,s)?(this.btn_trade.bCheck()&&(Mh.gi().s_Trade(2,0,0,0,0,0,0,0,0,0,0),on.mt.mproc=2),!0):(this.btn_close.ProcTouch(i,t,s)&&this.btn_close.bCheck()&&ln.gi().PopStat(1),!1)}}class cn extends s{constructor(i){super(),this.pani=i,this.pm3f=i.pm3f,this.iW=14,this.iH=14,this.matrix=new Array(this.iW),this.tmpmatrix=new Array(this.iW),this.frame=new Array(this.iW);for(var t=0;t<this.iW;t++)this.matrix[t]=new Int32Array(this.iH),this.tmpmatrix[t]=new Int32Array(this.iH),this.frame[t]=new Int32Array(this.iH);this.block=new Array(4),this.tmpblock=new Array(4);for(t=0;t<4;t++)this.block[t]=new Int32Array(4),this.tmpblock[t]=new Int32Array(4);this.InitMatrix(),this.ResetBlock(),this.iBW=32,this.iBH=32,this.aa_frame=gn.xani_ui.InitAnimaWithName("统一小按钮1",null),this.aa_back=gn.xani_ui.InitAnimaWithName("统一小按钮1",null),this.aa_back.iFrame=1,this.aa_block=gn.xani_ngoods.InitAnimaWithName("高级经验丹",null),this.aa_block2=gn.xani_ngoods.InitAnimaWithName("普通经验丹",null),this._BLOCKS=[[[1,1,0,0],[0,1,0,0],[0,1,0,0],[0,0,0,0]],[[],[],[],[]]]}ResetBlock(){var i,t,s;for(s=bn.GetRand(0,0),i=0;i<4;i++)for(t=0;t<4;t++)this.block[i][t]=this._BLOCKS[s][i][t]+2;this.iX=1,this.iY=1}InitMatrix(){var i,t;for(i=0;i<this.iW;i++)for(t=0;t<this.iH;t++)0==i||0==t||i==this.iW-1||t==this.iH-1?this.matrix[i][t]=0:this.matrix[i][t]=2,0==i||0==t||i==this.iW-1||t==this.iH-1?this.frame[i][t]=0:t>=this.iH/2&&i<=t-this.iH/2+1?this.frame[i][t]=1:i>=this.iW/2&&t<=i-this.iW/2+1?this.frame[i][t]=1:this.frame[i][t]=2;this.iDelay=0,this.iFx=0}_boom(i,t){var s,e;for(s=0;s<4;s++)for(e=0;e<4;e++)if(2!=this.block[s][e]&&2!=this.matrix[this.iX+s+i][this.iY+e+t])return!0;return!1}Draw(){var i,t,s=!1;if(this.iDelay++,this.iDelay%10==0&&(0==this.iFx?this._boom(0,1)?this._boom(1,0)?s=!0:(this.iX++,this.iFx=1-this.iFx):this.iY++:this._boom(1,0)?this._boom(0,1)?s=!0:(this.iY++,this.iFx=1-this.iFx):this.iX++,this.iFx=1-this.iFx,s)){for(i=0;i<4;i++)for(t=0;t<4;t++)2!=this.block[i][t]&&(this.matrix[this.iX+i][this.iY+t]=4);this.ResetBlock()}for(i=0;i<this.iW;i++)for(t=0;t<this.iH;t++)this.tmpmatrix[i][t]=this.matrix[i][t];for(i=0;i<4;i++)for(t=0;t<4;t++)2!=this.block[i][t]&&(this.tmpmatrix[this.iX+i][this.iY+t]=this.block[i][t]);for(i=0;i<this.iW;i++)for(t=0;t<this.iH;t++)0==this.frame[i][t]?this.aa_frame.Draw(100+i*this.iBW,100+t*this.iBH):1==this.frame[i][t]&&this.aa_back.Draw(100+i*this.iBW,100+t*this.iBH),3==this.tmpmatrix[i][t]?this.aa_block.Draw(100+i*this.iBW-30+this.iBW/2,100+t*this.iBH-30+this.iBW/2):4==this.tmpmatrix[i][t]&&this.aa_block2.Draw(100+i*this.iBW-30+this.iBW/2,100+t*this.iBH-30+this.iBW/2)}rota(){var i,t;for(i=0;i<4;i++)for(t=0;t<4;t++)this.tmpblock[i][t]=this.block[t][3-i];for(i=0;i<4;i++)for(t=0;t<4;t++)if(2!=this.tmpblock[i][t]&&2!=this.matrix[this.iX+i][this.iY+t])return;for(i=0;i<4;i++)for(t=0;t<4;t++)this.block[i][t]=this.tmpblock[i][t]}ProcTouch(i,t,s){return bn.bInRect(t,s,100,100,this.iW*this.iBW,this.iH*this.iBH)||h.SCRW,!1}}cn.Open=function(){ln.gi().PushStat(ln.GS_TETRIS)};class ln{constructor(){this.MAXSTACKSIZE=32,this.iXStat=-1,this.iStatStack=new Int32Array(this.MAXSTACKSIZE),this.iPointStack=new Int32Array(this.MAXSTACKSIZE),this.iPageStack=new Int32Array(this.MAXSTACKSIZE),this.objstack=new Array(this.MAXSTACKSIZE),this.oCurrentView=null,this.oPreviousView=null,this.iStatPoint=0,this.iPoint=0,this.iPage=0;for(var i=0;i<this.MAXSTACKSIZE;i++)this.objstack[i]=null;this.ResetStat()}ResetStat(){for(var i=0;i<this.MAXSTACKSIZE;i++)this.objstack[i]=null;this.iStatPoint=0,this.iStatStack[this.iStatPoint]=0,this.PushStat(0)}PopStat(i,t){return null!=this.oPreviousView&&this.oPreviousView.CallBack(i,t),this.PopStat(1)}PopStat(i){return on.bCheckTradeing&&this.iXStat==ln.GS_MYTRADEFRAME&&(Mh.gi().s_Trade(10,0,0,0,0,0,0,0,0,0,0),on.bCheckTradeing=!1),this.iXStat==ln.GS_SYSTEMOPERATE&&(gn.x_record.SaveTo(bn.RECORDFILENAME),Mh.gi().s_UseSkill(100,yh.iNearRoleCount,0,0,0,0,0)),i>1&&this.PopStat(i-1),this.iStatPoint>1&&(this.iPoint=this.iPointStack[this.iStatPoint],this.iPage=this.iPageStack[this.iStatPoint],this.objstack[this.iStatPoint]=null,this.iStatPoint--),this.iXStat=this.iStatStack[this.iStatPoint],this.oCurrentView=this.objstack[this.iStatPoint],this.oPreviousView=this.objstack[this.iStatPoint-1],this.iStatStack[this.iStatPoint]}PushXmsStat(i,t){return on.bCheckTradeing&&i!=ln.GS_WATCHON&&(Mh.gi().s_Trade(10,0,0,0,0,0,0,0,0,0,0),on.bCheckTradeing=!1),this.iStatPoint<0||this.iStatPoint>=this.MAXSTACKSIZE?null:(this.iStatPoint++,this.iStatStack[this.iStatPoint]=i,this.iPointStack[this.iStatPoint]=this.iPoint,this.iPageStack[this.iStatPoint]=this.iPage,this.iPoint=0,this.iPage=0,this.iXStat=i,h.bBigUI&&i!=ln.GS_GAMEING&&(h.SCRW,h.BUW),this.objstack[this.iStatPoint]=t,null!=this.objstack[this.iStatPoint]&&(this.objstack[this.iStatPoint].iStatType=i),this.oCurrentView=this.objstack[this.iStatPoint],this.oPreviousView=this.objstack[this.iStatPoint-1],qi.Reset(),this.oCurrentView)}PushStat(i){return on.bCheckTradeing&&i!=ln.GS_WATCHON&&(Mh.gi().s_Trade(10,0,0,0,0,0,0,0,0,0,0),on.bCheckTradeing=!1),this.iStatPoint<0||this.iStatPoint>=this.MAXSTACKSIZE?null:(this.iStatPoint++,this.iStatStack[this.iStatPoint]=i,this.iPointStack[this.iStatPoint]=this.iPoint,this.iPageStack[this.iStatPoint]=this.iPage,this.iPoint=0,this.iPage=0,this.iXStat=i,h.bBigUI&&i!=ln.GS_GAMEING&&(h.SCRW,h.BUW),this.objstack[this.iStatPoint]=this.InitStat(),null!=this.objstack[this.iStatPoint]&&(this.objstack[this.iStatPoint].iStatType=i),this.oCurrentView=this.objstack[this.iStatPoint],this.oPreviousView=this.objstack[this.iStatPoint-1],qi.Reset(),this.oCurrentView)}bGameing(){for(var i=this.iStatPoint;i>0;i--)if(this.iStatStack[i]==ln.GS_GAMEING)return!0;return!1}bHaveStat(i){for(var t=this.iStatPoint;t>0;t--)if(this.iStatStack[t]==i)return!0;return!1}FindStat(i){for(var t=this.iStatPoint;t>0;t--)if(this.iStatStack[t]==i)return this.objstack[t];return null}LastStat(i){return this.objstack[this.iStatPoint-i]}CheckStat(i){return this.LastStatType(0)==i}LastStatType(i){return this.iStatStack[this.iStatPoint-i]}InitStat(){switch(this.iXStat){case ln.GS_EXITCONFIRM:return new Qh(gn.xani_ui);case ln.GS_KICKOUT:return new qh(gn.xani_back);case ln.GS_LOADING1:return new Kh(gn.xani_ui);case ln.GS_LOADING2:return new Zh(gn.xani_ui);case ln.GS_MESSAGE1:return new $h(gn.xani_ui);case ln.GS_PROMPTMESSAGE:return new Ni(gn.xani_ui);case ln.GS_CONFIRM1:return new ei(gn.xani_ui);case ln.GS_CONFIRM2:return new ia(gn.xani_ui);case ln.GS_INNUMBER:return new Zs(gn.xani_ui);case ln.GS_LOGO:return new Xh(gn.xani_ui);case ln.GS_LEADPAGE:return new kt;case ln.GS_STARTGAME:return new Lh;case ln.GS_MAINMENU:return new Pt(gn.xani_ui);case ln.GS_FASTLOGIN:switch(t.QUDAO){case 0:return new zh;case 1:default:return new Lh}case ln.GS_REGIST:return new jh(gn.xani_ui);case ln.GS_LOGIN:return new Jh(gn.xani_ui);case ln.GS_SELECTROLE:return new Hh(gn.xani_ui);case ln.GS_CREATEROLE:return new Yh(gn.xani_ui);case ln.GS_SELECTSEVER:return new Uh(gn.xani_ui);case ln.GS_GAMEING:return new rh(gn.xani_ui);case ln.GS_TEAMOPERATE:return new Qt(gn.xani_ui);case ln.GS_TEAMCREATE:return new Zt(gn.xani_ui);case ln.GS_TEAMZHEN:return new jt(gn.xani_ui);case ln.GS_TEAMDEST:return new nn(gn.xani_ui);case ln.GS_SENDPUBLICCHAT:return new $t(gn.xani_ui);case ln.GS_SETCHATVALUE:return new is(gn.xani_ui);case ln.GS_ADDPOINT:return new Xi(gn.xani_ui);case ln.GS_PRIVATECHAT:return new dt(gn.xani_ui);case ln.GS_GIVEGOODS:return new sh(gn.xani_ui);case ln.GS_LEARNSKILL:return new as(gn.xani_ui);case ln.GS_BACKTOSCHOOL:return new bt(gn.xani_ui);case ln.GS_MISSIONFRAME:return new Xt(gn.xani_ui);case ln.GS_SELECTGOODSFORMISSION:return new ve(gn.xani_ui);case ln.GS_FULLCHATFRAME:return new ts(gn.xani_ui);case ln.GS_SHOPFRAME:return new Be(gn.xani_ui);case ln.GS_SHELVESFRAME:return new hn(gn.xani_ui);case ln.GS_CREATEGOV:return new Aa(gn.xani_ui);case ln.GS_APPLYFORGOV:return new Ga(gn.xani_ui);case ln.GS_GOVFRAME:return new me(gn.xani_ui);case ln.GS_LEARNGOVSKILL:return new va(gn.xani_ui);case ln.GS_GOVXIU:return new Na(gn.xani_ui);case ln.GS_SMALLMAP:return new Oh(gn.xani_ui);case ln.GS_WORLDMAP:return new Fh(gn.xani_ui);case ln.GS_SYSTEMOPERATE:return new yh(gn.xani_ui);case ln.GS_MYATTFRAME:return new Yi(gn.xani_ui);case ln.GS_MEMBERDETAIL:return new Ma(gn.xani_ui);case ln.GS_MAKEEQUIP:return new Ds(gn.xani_ui);case ln.GS_FASTOPERATE:return new Cs(gn.xani_ui);case ln.GS_CAMEOOPERATE:return new ha(gn.xani_ui);case ln.GS_PETSFRAME:return new et(gn.xani_ui);case ln.GS_FUSEPET:return new Ui(gn.xani_ui);case ln.GS_APPROVEPET:return new Me(gn.xani_ui);case ln.GS_SELECTMYPET:return new Vi(gn.xani_ui);case ln.GS_INGOTMALL:return new ys(gn.xani_ui);case ln.GS_FUBENMALL:return new Ta(gn.xani_ui);case ln.GS_IMPROVEEQUIP:return new aa(gn.xani_ui);case ln.GS_REPAIREQUIP:return new $s(gn.xani_ui);case ln.GS_WATCHON:return new oa(gn.xani_ui);case ln.GS_FINDFRIEND:return new na(gn.xani_ui);case ln.GS_SMALLSPEAKER:return new Fs(gn.xani_ui);case ln.GS_SENDNOVICEASK:return new qa(gn.xani_ui);case ln.GS_SENDACEANSWER:return new Qa(gn.xani_ui);case ln.GS_GETCODEREWARD:return new Fe(gn.xani_ui);case ln.GS_LEARNPETSKILL:return new Ki(gn.xani_ui);case ln.GS_PETEAT:return new $i(gn.xani_ui);case ln.GS_WASHPET:return new Zi(gn.xani_ui);case ln.GS_MYRECOVER:return new en(gn.xani_ui);case ln.GS_MYGOODSFRAME:return new Xs(gn.xani_ui);case ln.GS_EXCHANGEMONEY:return new Rs(gn.xani_ui);case ln.GS_MYTRADEFRAME:return new rn(gn.xani_ui);case ln.GS_GOODSSTOREFROME:return new mh(gn.xani_ui);case ln.GS_PETSTOREFRAME:return new gh(gn.xani_ui);case ln.GS_PRIVATECHATRECORD:return new bh(gn.xani_ui);case ln.GS_LIANDANSHU:return new Ts(gn.xani_ui);case ln.GS_SETTITLE:return new Za(gn.xani_ui);case ln.GS_PETXIU:return new ya(gn.xani_ui);case ln.GS_MOUNTSFRAME:return new Lt(gn.xani_ui);case ln.GS_FEEDMOUNTS:return new Wt(gn.xani_ui);case ln.GS_NOVICEHELP:return new za(gn.xani_ui);case ln.GS_NOVICEQUESTIONLIST:return new Ja(gn.xani_ui);case ln.GS_NOVICECHECKANSWER:return new Ua(gn.xani_ui);case ln.GS_PROMPTACTIVITY:return new Ns(gn.xani_ui);case ln.GS_SHOWACTIVITYDETAIL:return new ks(gn.xani_ui);case ln.GS_WEEKLYACTIVITY:return new As(gn.xani_ui);case ln.GS_DAYATTEND:return new Ya(gn.xani_ui);case ln.GS_CHANGENAME:return new Ka(gn.xani_ui);case ln.GS_LOCKOPEN:return new Gs(gn.xani_ui);case ln.GS_LOCKSET:return new Os(gn.xani_ui);case ln.GS_LOCKFRAME:return new Es(gn.xani_ui);case ln.GS_SELECTGOODS:return new pt(gn.xani_ui);case ln.GS_SELECTPET:return new ut(gn.xani_ui);case ln.GS_EXTHELP:return new yt(gn.xani_ui);case ln.GS_PLANTFRAME:return new sn(gn.xani_ui);case ln.GS_LANDFRAME:return new tn(gn.xani_ui);case ln.GS_SELECTLS:return new $a(gn.xani_ui);case ln.GS_EXTLEARNSKILL:return new Pa(gn.xani_ui);case ln.GS_APPLYGOVFIGHT:return new se(gn.xani_ui);case ln.GS_GETINGOV:return new he(gn.xani_ui);case ln.GS_NEWGOVFRAME:return new Te(gn.xani_ui);case ln.GS_MEMBEROPERATE:return new _e(gn.xani_ui);case ln.GS_SETGOVPOWER:return new be(gn.xani_ui);case ln.GS_CONFIRMAPPLY:return new we(gn.xani_ui);case ln.GS_ENTRUSTMISSION:return new ke(gn.xani_ui);case ln.GS_RELEASEGOVMISSION:return new Xa(gn.xani_ui);case ln.GS_NEWGOVMANAGE:return new le(gn.xani_ui);case ln.GS_GOV_SETBUILDING:return new ae(gn.xani_ui);case ln.GS_GOV_SETRESEARCH:return new ce(gn.xani_ui);case ln.GS_GOV_SETMTLEV:return new oe(gn.xani_ui);case ln.GS_GOV_SETHOSTILITY:return new ne(gn.xani_ui);case ln.GS_GOV_SETNAME:return new re(gn.xani_ui);case ln.GS_GOV_SETDETAIL:return new ge(gn.xani_ui);case ln.GS_GOV_REMEDYMERGE:return new ee(gn.xani_ui);case ln.GS_HIRETRADERWORKER:return new Ea(gn.xani_ui);case ln.GS_GOVFBTARGET:return new Ie(gn.xani_ui);case ln.GS_CREATEFT:return new ie(gn.xani_ui);case ln.GS_FTFRAME:return new ua(gn.xani_ui);case ln.GS_FTAPPLY:return new ga(gn.xani_ui);case ln.GS_FTMEMBER:return new xa(gn.xani_ui);case ln.GS_FTAGREE:return new pa(gn.xani_ui);case ln.GS_FTRANK:return new la(gn.xani_ui);case ln.GS_FTCHALLENGE:return new ra(gn.xani_ui);case ln.GS_FTPUTIN:return new ba(gn.xani_ui);case ln.GS_FTGETOUT:return new _a(gn.xani_ui);case ln.GS_FTMIJING:return new fa(gn.xani_ui);case ln.GS_JJPET:return new ye(gn.xani_ui);case ln.GS_MERGEZR:return new Re(gn.xani_ui);case ln.GS_CREATESHOP:return new Ee(gn.xani_ui);case ln.GS_FRIENDTEAM:return new _h(gn.xani_ui);case ln.GS_CHANGECOLOR:return new Oe(gn.xani_ui);case ln.GS_SELECTSCHOOL:return new Ne(gn.xani_ui);case ln.GS_NEWSHOP:return new Fa(gn.xani_ui);case ln.GS_SELECTNEWPET:return new Pe(gn.xani_ui);case ln.GS_CREATEFUBEN:return new Bh(gn.xani_ui);case ln.GS_APPLYFUBEN:return new Sa(gn.xani_ui);case ln.GS_MANAGEFUBEN:return new ka(gn.xani_ui);case ln.GS_AQSTART:return new gt(gn.xani_ui);case ln.GS_AQDOING:return new ea(gn.xani_ui);case ln.GS_MAINHELP:return new xt(gn.xani_ui);case ln.GS_TETRIS:return new cn(gn.xani_ui);case ln.GS_DIEPROMPT:return new fs(gn.xani_ui);case ln.GS_MYSELECT:return new ze(gn.xani_ui);case ln.GS_SHOPBUYDRAWING:return new Ge(gn.xani_ui);case ln.GS_PEAKFIGHT:return new sa(gn.xani_ui);case ln.GS_PEAKFIGHTSHOP:return new an(gn.xani_ui);case ln.GS_LEADERBOARDFRAME:return new Va(gn.xani_ui);case ln.GS_LEADERBOARDROLE:return new Wa(gn.xani_ui);default:gn.sop("un init stat = "+this.iXStat)}return null}Draw(){var i;for(i=0;i<=this.iStatPoint;i++)null!=this.objstack[i]&&(h.bBigUI&&this.objstack[i].iStatType!=GS_GAMEING&&(h.SCRW,h.BUW),this.objstack[i].Draw())}ProcTouch(i,t,s,e,a){return null!=this.objstack[this.iStatPoint]&&(h.bBigUI&&this.objstack[this.iStatPoint].iStatType!=GS_GAMEING&&h.SCRW>h.BUW?(Gh.gi().calcxy(e,a),this.objstack[this.iStatPoint].ProcTouch(i,Gh.gi().cx,Gh.gi().cy)):this.objstack[this.iStatPoint].ProcTouch(i,t,s))}}ln.GS_EXITCONFIRM=1,ln.GS_KICKOUT=2,ln.GS_LOADING1=10,ln.GS_LOADING2=11,ln.GS_MESSAGE1=50,ln.GS_PROMPTMESSAGE=60,ln.GS_CONFIRM1=70,ln.GS_CONFIRM2=71,ln.GS_INNUMBER=80,ln.GS_LEADPAGE=101,ln.GS_STARTGAME=102,ln.GS_LOGO=100,ln.GS_MAINMENU=200,ln.GS_FASTLOGIN=300,ln.GS_REGIST=400,ln.GS_LOGIN=500,ln.GS_SELECTROLE=600,ln.GS_CREATEROLE=700,ln.GS_SELECTSEVER=800,ln.GS_GAMEING=2e3,ln.GS_TEAMOPERATE=2100,ln.GS_TEAMCREATE=2101,ln.GS_TEAMZHEN=2102,ln.GS_TEAMDEST=2103,ln.GS_SENDPUBLICCHAT=2200,ln.GS_SETCHATVALUE=2202,ln.GS_ADDPOINT=2300,ln.GS_PRIVATECHAT=2400,ln.GS_GIVEGOODS=2500,ln.GS_LEARNSKILL=2600,ln.GS_BACKTOSCHOOL=2601,ln.GS_MISSIONFRAME=2700,ln.GS_SELECTGOODSFORMISSION=2701,ln.GS_FULLCHATFRAME=2800,ln.GS_SHOPFRAME=2900,ln.GS_SHELVESFRAME=3e3,ln.GS_SMALLMAP=3010,ln.GS_WORLDMAP=3011,ln.GS_SYSTEMOPERATE=3020,ln.GS_MYATTFRAME=3030,ln.GS_FASTOPERATE=3040,ln.GS_PETSFRAME=3050,ln.GS_FUSEPET=3051,ln.GS_APPROVEPET=3052,ln.GS_SELECTMYPET=3053,ln.GS_INGOTMALL=3060,ln.GS_FUBENMALL=3061,ln.GS_WATCHON=3070,ln.GS_FINDFRIEND=3080,ln.GS_SMALLSPEAKER=3090,ln.GS_SENDNOVICEASK=3091,ln.GS_SENDACEANSWER=3092,ln.GS_GETCODEREWARD=3093,ln.GS_LEARNPETSKILL=3100,ln.GS_PETEAT=3101,ln.GS_WASHPET=3110,ln.GS_MYRECOVER=3120,ln.GS_MYGOODSFRAME=3130,ln.GS_EXCHANGEMONEY=3131,ln.GS_MYTRADEFRAME=3140,ln.GS_GOODSSTOREFROME=3150,ln.GS_PETSTOREFRAME=3151,ln.GS_PRIVATECHATRECORD=3160,ln.GS_LIANDANSHU=3170,ln.GS_SETTITLE=3180,ln.GS_PETXIU=3190,ln.GS_MOUNTSFRAME=3200,ln.GS_FEEDMOUNTS=3210,ln.GS_NOVICEHELP=3220,ln.GS_NOVICEQUESTIONLIST=3230,ln.GS_NOVICECHECKANSWER=3240,ln.GS_PROMPTACTIVITY=3250,ln.GS_SHOWACTIVITYDETAIL=3251,ln.GS_WEEKLYACTIVITY=3252,ln.GS_DAYATTEND=3260,ln.GS_CHANGENAME=3270,ln.GS_LOCKSET=3280,ln.GS_LOCKOPEN=3290,ln.GS_LOCKFRAME=3300,ln.GS_SELECTGOODS=3310,ln.GS_SELECTPET=3330,ln.GS_EXTHELP=3340,ln.GS_PLANTFRAME=3350,ln.GS_LANDFRAME=3360,ln.GS_SELECTLS=3370,ln.GS_CREATEGOV=4e3,ln.GS_APPLYFORGOV=4001,ln.GS_GOVFRAME=4002,ln.GS_LEARNGOVSKILL=4003,ln.GS_GOVXIU=4004,ln.GS_MEMBERDETAIL=4005,ln.GS_EXTLEARNSKILL=4006,ln.GS_APPLYGOVFIGHT=4007,ln.GS_GETINGOV=4008,ln.GS_NEWGOVFRAME=4009,ln.GS_MEMBEROPERATE=4010,ln.GS_SETGOVPOWER=4011,ln.GS_CONFIRMAPPLY=4012,ln.GS_ENTRUSTMISSION=4013,ln.GS_RELEASEGOVMISSION=4014,ln.GS_NEWGOVMANAGE=4015,ln.GS_GOV_SETBUILDING=4016,ln.GS_GOV_SETRESEARCH=4017,ln.GS_GOV_SETMTLEV=4018,ln.GS_GOV_SETHOSTILITY=4019,ln.GS_GOV_SETNAME=4020,ln.GS_GOV_SETDETAIL=4021,ln.GS_GOV_REMEDYMERGE=4022,ln.GS_HIRETRADERWORKER=4023,ln.GS_GOVFBTARGET=4024,ln.GS_CREATEFT=4100,ln.GS_FTFRAME=4101,ln.GS_FTAPPLY=4102,ln.GS_FTMEMBER=4103,ln.GS_FTAGREE=4104,ln.GS_FTRANK=4105,ln.GS_FTCHALLENGE=4106,ln.GS_FTPUTIN=4107,ln.GS_FTGETOUT=4108,ln.GS_FTMIJING=4109,ln.GS_JJPET=4110,ln.GS_MERGEZR=4111,ln.GS_CREATESHOP=4200,ln.GS_FRIENDTEAM=4300,ln.GS_CHANGECOLOR=4400,ln.GS_SELECTSCHOOL=4500,ln.GS_NEWSHOP=4600,ln.GS_SELECTNEWPET=4700,ln.GS_MAKEEQUIP=5e3,ln.GS_CAMEOOPERATE=5010,ln.GS_IMPROVEEQUIP=5020,ln.GS_REPAIREQUIP=5030,ln.GS_CREATEFUBEN=6e3,ln.GS_APPLYFUBEN=6010,ln.GS_MANAGEFUBEN=6020,ln.GS_AQSTART=6500,ln.GS_AQDOING=6501,ln.GS_MAINHELP=6502,ln.GS_DIEPROMPT=7e3,ln.GS_MYSELECT=7001,ln.GS_SHOPBUYDRAWING=7002,ln.GS_PEAKFIGHT=7003,ln.GS_PEAKFIGHTSHOP=7004,ln.GS_LEADERBOARDFRAME=7005,ln.GS_LEADERBOARDROLE=7006,ln.GS_TETRIS=1e4,ln.x_stat=null,ln.gi=function(){return null==ln.x_stat&&(ln.x_stat=new ln),ln.x_stat};class bn{constructor(){}}bn.RECORDFILENAME="record.dat",bn.PRIVATECHATRECORD="chatrecord.dat",bn.bInRect=function(i,t,s,e,h,a){return!(i<=s)&&(!(t<=e)&&(!(i>=s+h)&&!(t>=e+a)))},bn.bInLX=function(i,t,s,e,h,a){return!(i<s-h/2)&&(!(i>s+h/2)&&(!(t<e-a/2)&&(!(t>e+a/2)&&!((i=s>i?s-i:i-s)+(t=(t=e>t?e-t:t-e)*h/a)>h/2))))},bn.bOnRect=function(i,t,s,e,h,a){return!(i<s)&&(!(t<e)&&(!(i>s+h)&&!(t>e+a)))},bn.llength=function(i,t,s,e){return parseInt(Math.sqrt((i-s)*(i-s)+(t-e)*(t-e)))},bn.CalcRate=function(i,t,s){return parseInt(1*i*s/t)},bn.PI=3.1415926,bn.GetAngleXY=function(i,t,s,e){var h,a,n;return a=t-e,0==(h=i-s)&&(h=1e-7),n=Math.atan(a/h),h<0&&(n+=bn.PI),parseInt(180*n/bn.PI)},bn.GetAngleXY_ext=function(i,t,s,e){var h,a,n;return a=t-e,0==(h=i-s)&&(h=1e-7),n=Math.atan(a/h),h<0&&(n+=bn.PI),n},bn.ShowFM=function(){},bn.getFileMD5=function(i){return""},bn.SecondToTime=function(i){var t,s="";return 0==(t=i/3600)?s+="00":t<10?s=s+"0"+t:s+=t,s+=":",0==(t=i/60%60)?s+="00":t<10?s=s+"0"+t:s+=t,s+=":",0==(t=i%60)?s+="00":t<10?s=s+"0"+t:s+=t,s},bn.HEX_DIGITS=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],bn.toHexString=function(i){for(var t="",s=0;s<i.length;s++)t+=HEX_DIGITS[(240&i[s])>>4],t+=HEX_DIGITS[15&i[s]];return t},bn.grnd=function(i,t){return i>=t?i:Math.floor(Math.random()*(t-i+1))+i},bn.GetRand=function(i,t){return i>=t?i:Math.floor(Math.random()*(t-i+1))+i},bn.addLoadMask=function(i){switch(i){case 1:clearTimeout(this.id),ln.gi().CheckStat(ln.GS_LOADING2)||ln.gi().PushStat(ln.GS_LOADING2);break;case 2:this.id=setTimeout(()=>{ln.gi().LastStatType(0)!=ln.GS_GAMEING&&ln.gi().PopStat(1)},2e3)}},bn.get_ms=function(){return Date.now()},bn._debuglist=null,bn.sop=function(i){null==bn._debuglist&&(bn._debuglist=new Array(20));for(var t=20;t>0;t--)bn._debuglist[t]=bn._debuglist[t-1];bn._debuglist[0]=i,console.log(i)},bn.arraycopy=function(i,t,s,e,h){for(var a=0;a<h;a++)s[e+a]=i[t+a]},bn.BASE_URL="https://xiazai.qi-guo.cn/qiguo/xiaoyouxi/7g/";class _n{constructor(){this.bMusicEnabled=!0,this.bPause=!1}StartWav(i,t){if(0!=yh.iSound&&!this.bPause)for(var s=0;s<_n._d2.length;s++)_n._d2[s]==i&&Laya.SoundManager.playSound(bn.BASE_URL+"res/datapackage/sound/sound/"+_n._d2[s]+".xxx")}StartWav_Pet(i,t){0!=yh.iSound&&(this.bPause||i<=0||i>=20||17==i||t<0||t>=4||Laya.SoundManager.playSound(bn.BASE_URL+"res/datapackage/sound/sound/pets/"+parseInt(i/10)+i%10+"/"+_n._d1[t]+".xxx"))}StartBackMusic(i,t){this.bMusicEnabled&&(this.StopBackMusic(),console.log("音乐id:",i),bn.sop(bn.BASE_URL+"res/datapackage/sound/music/"+i+".xxx"),_n._music_channel=Laya.SoundManager.playMusic(bn.BASE_URL+"res/datapackage/sound/music/"+i+".xxx"))}StopBackMusic(){null!=_n._music_channel&&_n._music_channel.stop()}}_n._d1=["attack","magic","hurt","die"],_n._d2=["defence","escape","role0_attack","role0_magic","role0_hurt","role0_die","role1_attack","role1_magic","role1_hurt","role1_die",""],_n._music_channel=null,_n.MusicContinue=function(){null!=_n._music_channel&&_n._music_channel.play()};class fn{constructor(){this.iStat=0,this.iBx=-1,this.iLHX=-1,1==fn.QUDAO&&(setTimeout(()=>{var i=wx.getMenuButtonBoundingClientRect();console.log("菜单按键宽度：",i.width),console.log("菜单按键高度：",i.height),console.log("菜单按键上边界坐标：",i.top),console.log("菜单按键右边界坐标：",i.right),console.log("菜单按键下边界坐标：",i.bottom),console.log("菜单按键左边界坐标：",i.left);var t=wx.getSystemInfoSync();this.iScreenW=t.windowWidth,this.iScreenH=t.windowHeight,this.iBx=i.left*Laya.stage.width/this.iScreenW,this.iBy=i.top*Laya.stage.height/this.iScreenH,this.iBw=i.width*Laya.stage.width/this.iScreenW,this.iBh=i.height*Laya.stage.height/this.iScreenH;var s=t.safeArea;this.iLHX=s.left},5e3),wx.onKeyboardComplete(()=>{console.log("键盘收起"),st.dispatchEvent("onKeyboardComplete")}))}bInBound(i,t,s,e){return!(this.iBx<0)&&(!(i+s<this.iBx)&&(!(this.iBx+this.iBw<i)&&(!(t+e<this.iBy)&&!(this.iBy+this.iBh<t))))}DrawBoundRect(){}Logic(){gn.bConnected&&(gn.gi().iLoadStat<7||1==fn.QUDAO&&this.Logic_wx())}Logic_wx(){switch(this.iStat){case 0:wx.onShow(function(){_n.MusicContinue()}),wx.setKeepScreenOn({keepScreenOn:!0,success(){console.log("常亮打开成功")},fail(i){console.log(i,"常亮打开失败")}}),wx.login({success(i){i.code?(bn.sop("wx login success"),Mh.gi().s_Login_xyx(fn.QUDAO,i.code,"")):bn.sop("登录失败！"+i.errMsg)}}),this.iStat=1,this.iTimeOut=0;break;case 1:this.iTimeOut++,this.iTimeOut>=90&&(this.iStat=0)}}Init(){}Pause(){}_Login(){}Pay(i){}_Exit(){}Exit(){}Login(){}OnReceive(i){}mta_record(i,t,s){i}InitFloatButton(){}Draw(){}ProcTouch(i,t,s){}QUDAO(){return GameVersion.QUDAO}}fn.pp=null,fn.gi=function(){return null==fn.pp&&(fn.pp=new fn),fn.pp},fn.QUDAO=0,"undefined"!=typeof wx&&(fn.QUDAO=1);class un{constructor(){this.sValue=""}}class dn{GetData(i,t,s,e){if(null==e)return s>0&&bn.sop("retry "+s+","+t),void Laya.loader.load(t,Laya.Handler.create(i,i.GetData,[i,t,s+1]),null,Laya.Loader.BUFFER);var h=u.gi();h.GetData3(e),i._LoadData(h),this.bLoadSuccess=!0}constructor(i,t,s){s&&this.GetData(this,bn.BASE_URL+"res/datapackage/"+t,0),this.bLoadSuccess=!1}_LoadData(i){var t,s,e;for(this.iValueIndex=new Int32Array(dn.MAXVALUEINDEX),t=0;t<dn.MAXVALUEINDEX;t++)this.iValueIndex[t]=-1;for(i.GetNextByte(),this.iDataCount=i.GetNextInt(),this.datas=new Array(this.iDataCount),t=0;t<this.iDataCount;t++)for(this.datas[t]=new nt,this.datas[t].iDid=i.GetNextInt(),this.iValueIndex[this.datas[t].iDid]=t,this.datas[t].iItemCount=i.GetNextInt(),this.datas[t].items=new Array(this.datas[t].iItemCount),s=0;s<this.datas[t].iItemCount;s++)for(this.datas[t].items[s]=new Rt,this.datas[t].items[s].iItemId=i.GetNextInt(),this.datas[t].items[s].iType=i.GetNextInt(),this.datas[t].items[s].iValueCount=i.GetNextInt(),this.datas[t].items[s].values=new Array(this.datas[t].items[s].iValueCount),e=0;e<this.datas[t].items[s].iValueCount;e++)this.datas[t].items[s].values[e]=new un,this.datas[t].items[s].values[e].iVid=i.GetNextInt(),this.datas[t].items[s].values[e].sValue=i.GetNextString()}fdata(i){if(i>=dn.MAXVALUEINDEX)return null;var t=this.iValueIndex[i];return-1==t?null:this.datas[t]}intValue(i,t,s){return parseInt(this.strValue(i,t,s))}strValue(i,t,s){var e,h,a,n;if(i<0||i>=dn.MAXVALUEINDEX)return this.sResult="-1",this.sResult;if(n=0,-1!=(e=this.iValueIndex[i])&&this.datas[e].iDid==i)for(h=0;h<this.datas[e].iItemCount;h++)for(a=0;a<this.datas[e].items[h].iValueCount;a++)if(this.datas[e].items[h].values[a].iVid==s){if(n>=t)return this.sResult=this.datas[e].items[h].values[a].sValue,this.sResult.length<=0&&(this.sResult="-1"),this.sResult;n++;break}return"-1"}}dn.MAXVALUEINDEX=1024;class pn{FuYuan(){this.bInited=!1,this.bShow=!1,this.bShowEffect=!0,this.bShowFrame=!1}Draw(){if(!Ih.gi().vbk.mapdialog.bHideUI()&&!xs.jq.bJQLock()&&this.bShow){var i=rh.iTopIconOffX;this.bInited||(this.btn_open=new Eh(gn.xani_nui6),this.btn_open.InitButton("首充图标"),this.aa_effect=gn.xani_nui6.InitAnimaWithName("转圈效果",null),this.bInited=!0),this.btn_open.Move(i,0,80,80),this.btn_open.Draw(),this.bShowEffect&&(this.aa_effect.Draw(i+40,40),this.aa_effect.NextFrame()),this.bShowFrame,rh.iTopIconOffX+=90}}ProcTouch(i,t,s){return!1}}pn.fy=new pn;class mn{constructor(){}Init(){}CleanVoiceFile(){}Login(i,t){}StartRecord(){}sGetRecordName(){return this.sRecordName}StopRecord(){}PlayVoice(){}UpLoad(){}PlayUrlVoice(i){}StartRecognize(){}handleMessageEvent(i){}}class gn{constructor(){this.bTimerOnce=!1,this.sCheckError="验证错误，强制退出游戏",this.btn_checkok=null,this.btn_checkreset=null,gn.iNowMillis=bn.get_ms(),gn.gp=this,xh.me=new xh,ji.ml=new ji,this.bCheck=!1,this.iCheckFace=new Int32Array(4),this.iCheckRot=new Int32Array(4),this.iCheckAnima=new Int32Array(4),this.mapChanging={changed:!1,type:0,dest:0},this.bCheck2=!1,this.sCheckWord=new Array(4),this.iCheckValue=new Array(4),this.iCheckResult=new Int32Array(4),this.iResultValue=new Array(4);for(var i=0;i<4;i++)this.iCheckValue[i]=new Int32Array(9),this.iResultValue[i]=new Int32Array(9);this.pls=new u,gn.iDelay=0,gn.x_record=new ph(this.pls),gn.x_record.ReadFrom(bn.RECORDFILENAME),this.xm3f=c.gi(),gn.xani_local=new S,gn.xani_local.LoadAnima_fullpath("res/localres/anima",this.pls,!0,this._LoadFinish),this.iLoadStat=0}_LoadFinish(){ln.gi().PushStat(ln.GS_LEADPAGE)}init_data(i){Us.de_mission=new dn(this.pls,"data/mission.dat",i),gn.de_goods=new dn(this.pls,"data/goods.dat",i),gn.de_pet=new dn(this.pls,"data/pet.dat",i),gn.de_map=new dn(this.pls,"data/map.dat",i),gn.de_skill=new dn(this.pls,"data/skill.dat",i),gn.de_npc=new dn(this.pls,"data/npc.dat",i),gn.de_mounts=new dn(this.pls,"data/mounts.dat",i),gn.de_fuben=new dn(this.pls,"data/fuben.dat",i),gn.de_chuan_song=new dn(this.pls,"data/chuan_song.dat",i),gn.de_grow=new dn(this.pls,"data/grow.dat",i)}init_data_finished(){return!!(Us.de_mission.bLoadSuccess&&gn.de_goods.bLoadSuccess&&gn.de_pet.bLoadSuccess&&gn.de_map.bLoadSuccess&&gn.de_skill.bLoadSuccess&&gn.de_npc.bLoadSuccess&&gn.de_mounts.bLoadSuccess&&gn.de_fuben.bLoadSuccess&&gn.de_chuan_song.bLoadSuccess&&gn.de_grow.bLoadSuccess)}init_anima1(i){console.log("初始化动画");var t="res/datapackage/",s=this.pls;gn.xani_ui=new S(this.xm3f),gn.xani_ui.LoadAnima_fullpath(t+"ui",s,i),gn.xani_ui2=new S(this.xm3f),gn.xani_ui2.LoadAnima_fullpath(t+"ui2",s,i),gn.xani_ui3=new S(this.xm3f),gn.xani_ui3.LoadAnima_fullpath(t+"ui3",s,i),gn.xani_ui4=new S(this.xm3f),gn.xani_ui4.LoadAnima_fullpath(t+"ui4",s,i),gn.xani_nui1=new S(this.xm3f),gn.xani_nui1.LoadAnima_fullpath(t+"uis/nui1",s,i),gn.xani_nui2=new S(this.xm3f),gn.xani_nui2.LoadAnima_fullpath(t+"uis/nui2",s,i),gn.xani_nui3=new S(this.xm3f),gn.xani_nui3.LoadAnima_fullpath(t+"uis/nui3",s,i),gn.xani_nui4=new S(this.xm3f),gn.xani_nui4.LoadAnima_fullpath(t+"uis/nui4",s,i),gn.xani_nui5=new S(this.xm3f),gn.xani_nui5.LoadAnima_fullpath(t+"uis/nui5",s,i),gn.xani_nui6=new S(this.xm3f),gn.xani_nui6.LoadAnima_fullpath(t+"uis/nui6",s,i),gn.xani_nicon=new S(this.xm3f),gn.xani_nicon.LoadAnima_fullpath(t+"skills/nicon",s,i),gn.xani_aura=new S(this.xm3f),gn.xani_aura.LoadAnima_fullpath(t+"anima/aura",s,i),gn.xani_frame=new S(this.xm3f),gn.xani_frame.LoadAnima_fullpath(t+"uis/ui_frame",s,i),gn.xani_button=new S(this.xm3f),gn.xani_button.LoadAnima_fullpath(t+"uis/ui_button",s,i),gn.xani_icon=new S(this.xm3f),gn.xani_icon.LoadAnima_fullpath(t+"uis/ui_icon",s,i),gn.xani_other=new S(this.xm3f),gn.xani_other.LoadAnima_fullpath(t+"uis/ui_other",s,i),gn.xani_newrole=new Array(6),gn.xani_weap=new Array(6),gn.xani_color=new Array(6);for(var e=0;e<6;e++){gn.xani_newrole[e]=new S(this.xm3f),gn.xani_newrole[e].LoadAnima_fullpath(t+"nroles/role"+e,s,i),gn.xani_weap[e]=new Array(10);for(var h=0;h<10;h++)gn.xani_weap[e][h]=new S(this.xm3f),gn.xani_weap[e][h].LoadAnima_fullpath(t+"nroles/role"+e+"/weap_"+e+"_"+h,s,i);gn.xani_color[e]=new Array(5);for(h=0;h<5;h++)gn.xani_color[e][h]=new S(this.xm3f),gn.xani_color[e][h].LoadAnima_fullpath(t+"nroles/role"+e+"/c"+h,s,i)}for(gn.xani_ngoods=new S(this.xm3f),gn.xani_ngoods.LoadAnima_fullpath(t+"anima/ngoods",s,i),gn.xani_stand=new Array(5),gn.xani_shot=new Array(5),e=0;e<5;e++)gn.xani_stand[e]=new S(this.xm3f),gn.xani_shot[e]=new S(this.xm3f);gn.xani_shot[0].LoadAnima_fullpath(t+"anima/shot0",s,i),gn.xani_shot[1].LoadAnima_fullpath(t+"anima/shot1",s,i),gn.xani_stand[0].LoadAnima_fullpath(t+"anima/stand0",s,i),gn.xani_stand[1].LoadAnima_fullpath(t+"anima/stand1",s,i),gn.xani_stand[2].LoadAnima_fullpath(t+"anima/stand2",s,i),gn.xani_face=new S(this.xm3f),gn.xani_face.LoadAnima_fullpath(t+"anima/face",s,i),gn.xani_head=new S(this.xm3f),gn.xani_head.LoadAnima_fullpath(t+"anima/head",s,i),gn.xani_skill=new S(this.xm3f),gn.xani_skill.LoadAnima_fullpath(t+"skill",s,i),gn.xani_skills=new Array(13);var a=["other","sc1","sc2","sc3","sc4","sc5","sc6","sc7","sc8","sc9","equip","pet","equip2"];for(e=0;e<13;e++)gn.xani_skills[e]=new S(this.xm3f),gn.xani_skills[e].LoadAnima_fullpath(t+"skills/"+a[e],s,i);gn.xani_effect=new S(this.xm3f),gn.xani_effect.LoadAnima_fullpath(t+"effect",s,i),gn.xani_grow=new S(this.xm3f),gn.xani_grow.LoadAnima_fullpath(t+"grow",s,i),gn.xani_pets=new Array(40);for(e=0;e<40;e++){gn.xani_pets[e]=new S(this.xm3f),-1==(h=gn.de_pet.intValue(e,0,2))?gn.xani_pets[e].LoadAnima_fullpath(t+"pet/1",s,i):gn.xani_pets[e].LoadAnima_fullpath(t+"pet/"+e,s,i)}gn.xani_nmounts=new Array(3);for(e=0;e<3;e++){gn.xani_nmounts[e]=new Array(3);for(h=0;h<3;h++)gn.xani_nmounts[e][h]=new S(this.xm3f),gn.xani_nmounts[e][h].LoadAnima_fullpath(t+"anima/nmounts/"+(e+1)+"/"+(h+1),s,i)}}init_anima1_finished(){if(!gn.xani_ui.bLoadSuccess)return!1;if(!gn.xani_ui2.bLoadSuccess)return!1;if(!gn.xani_ui3.bLoadSuccess)return!1;if(!gn.xani_ui4.bLoadSuccess)return!1;if(!gn.xani_nui1.bLoadSuccess)return!1;if(!gn.xani_nui2.bLoadSuccess)return!1;if(!gn.xani_nui3.bLoadSuccess)return!1;if(!gn.xani_nui4.bLoadSuccess)return!1;if(!gn.xani_nui5.bLoadSuccess)return!1;if(!gn.xani_nui6.bLoadSuccess)return!1;if(!gn.xani_nicon.bLoadSuccess)return!1;if(!gn.xani_aura.bLoadSuccess)return!1;if(!gn.xani_frame.bLoadSuccess)return!1;if(!gn.xani_button.bLoadSuccess)return!1;if(!gn.xani_icon.bLoadSuccess)return!1;if(!gn.xani_other.bLoadSuccess)return!1;for(var i=0;i<6;i++){if(!gn.xani_newrole[i].bLoadSuccess)return!1;for(var t=0;t<10;t++)if(!gn.xani_weap[i][t].bLoadSuccess)return!1;for(t=0;t<5;t++)if(!gn.xani_color[i][t].bLoadSuccess)return!1}if(!gn.xani_ngoods.bLoadSuccess)return!1;if(!gn.xani_shot[0].bLoadSuccess)return!1;if(!gn.xani_shot[1].bLoadSuccess)return!1;if(!gn.xani_stand[0].bLoadSuccess)return!1;if(!gn.xani_stand[1].bLoadSuccess)return!1;if(!gn.xani_stand[2].bLoadSuccess)return!1;if(!gn.xani_face.bLoadSuccess)return!1;if(!gn.xani_head.bLoadSuccess)return!1;if(!gn.xani_skill.bLoadSuccess)return!1;for(i=0;i<13;i++)if(!gn.xani_skills[i].bLoadSuccess)return!1;if(!gn.xani_effect.bLoadSuccess)return!1;if(!gn.xani_grow.bLoadSuccess)return!1;for(i=0;i<40;i++)if(!gn.xani_pets[i].bLoadSuccess)return!1;for(i=0;i<3;i++)for(t=0;t<3;t++)if(!gn.xani_nmounts[i][t].bLoadSuccess)return!1;return!0}InitAnimaAndData(){switch(this.iLoadStat){case 0:gn.xntf=new vh("ws://121.40.40.172:11000/login"),this.init_data(!0),this.iLoadStat=1;break;case 1:this.init_data_finished()&&(this.iLoadStat=2);break;case 2:Ue.gi().InitLink(),this.iLoadStat=3;break;case 3:this.init_anima1(!0),this.iLoadStat=4;break;case 4:this.init_anima1_finished()&&(this.iLoadStat=5);break;case 5:gn.aa_auras=new Array(128);for(var i=0;i<128;i++)gn.aa_auras[i]=new l,i<2&&gn.xani_aura.InitAnimaWithName("aura"+i,gn.aa_auras[i]);gn.aa_fightready=new l,gn.xani_skills[0].InitAnimaWithName("准备中",gn.aa_fightready),this.iLoadStat=6;break;case 6:Ih.gi().LoadLogic()&&(xh.me.Init(),gn.m_vi=new mn,gn.m_vi.Init(),gn.pxe=new Ei,gn.x_wav=new _n,this.iLoadStat=7);break;case 7:return!0}return!1}GmTimer(){var i,t;if(gn.iNowMillis=bn.get_ms(),gn.ResetSound(),0==Ih.gi().iMapChangeing?this.ProcTouch():(Gh.gi().clear(),Ks.sw.bLocked=!1),ln.gi().Draw(),ln.gi().bGameing()&&Le.gi().Draw(),Ue.gi().AILogic(),es.gi().DrawSpeaker(),Hs.gi().Draw(),oh.gi().Draw(),Ih.gi().iMapChangeing>0&&(i=29*(i=Ih.gi().iMapChangeing%100)<<24,this.xm3f.FillRect_2D(0,0,h.SCRW,h.SCRH,i),Ih.gi().iMapChangeing>=100?Ih.gi().iMapChangeing<108&&Ih.gi().iMapChangeing++:Ih.gi().iMapChangeing--),null!=gn.xntf&&gn.xntf.NetLogic(),this.OnReceive(),gn.iDelay++,Ss.fm.Draw(),Z.fm.Draw(),L.easymsg.Draw(),Hs.gi().InitGuide(),this.bCheck){var s,e,a;for(600,a=200,s=(h.SCRW-600)/2,e=(h.SCRH-a)/2,this.xm3f.FillRect_2D(s,e,s+600,e+a,2147483648),i=0;i<4;i++){if(t=60,0==this.iCheckFace[i])gn.xani_newrole[this.iCheckAnima[i]].InitAnimaWithName("站立_下",gn.aaa);else if(1==this.iCheckFace[i])gn.xani_newrole[this.iCheckAnima[i]].InitAnimaWithName("站立_上",gn.aaa);else if(2==this.iCheckFace[i])gn.xani_newrole[this.iCheckAnima[i]].InitAnimaWithName("站立_左",gn.aaa);else{if(3!=this.iCheckFace[i])break;gn.xani_newrole[this.iCheckAnima[i]].InitAnimaWithName("站立_右",gn.aaa)}gn.aaa.SetFrame(gn.iDelay),this.iCheckRot[i]<0?gn.aaa.DrawEx(s+150*i+75,e+130,t,1,1,360+this.iCheckRot[i],-1,-1):gn.aaa.DrawEx(s+150*i+75,e+130,t,1,1,this.iCheckRot[i],-1,-1)}this.iCheckLast>0?(this.iCheckLast--,this.xm3f.DrawTextEx(s+300,e+a-30,"等待"+parseInt(this.iCheckLast/15),4294967295,30,101,1,1,0,-2,-2)):gn.iDelay/5%2==0&&this.xm3f.DrawTextEx(s+300,e+a-30,"选择一个面向你的角色",4294967295,30,101,1,1,0,-2,-2)}if(this.bCheck2){for(this.xm3f.FillRect_2D(this.C2X,this.C2Y,this.C2X+this.C2W+100,this.C2Y+this.C2H+100,2147483648),i=0;i<4;i++)this.xm3f.DrawTextEx(this.C2X+this.iCheckValue[i][5],this.C2Y+this.iCheckValue[i][6],this.sCheckWord[i],this.iCheckValue[i][4],this.iCheckValue[i][0],101,.01*this.iCheckValue[i][2],.01*this.iCheckValue[i][3],this.iCheckValue[i][1],this.C2X+this.iCheckValue[i][5]+.005*this.iCheckValue[i][2]*this.iCheckValue[i][0],this.C2Y+this.iCheckValue[i][6]+.005*this.iCheckValue[i][3]*this.iCheckValue[i][0]),this.iCheckValue[i][5]+=this.iCheckValue[i][7],this.iCheckValue[i][6]+=this.iCheckValue[i][8],this.iCheckValue[i][5]<0&&this.iCheckValue[i][7]<0&&(this.iCheckValue[i][7]=-this.iCheckValue[i][7]),this.iCheckValue[i][5]>this.C2W-this.iCheckValue[i][0]&&this.iCheckValue[i][7]>0&&(this.iCheckValue[i][7]=-this.iCheckValue[i][7]),this.iCheckValue[i][6]<0&&this.iCheckValue[i][8]<0&&(this.iCheckValue[i][8]=-this.iCheckValue[i][8]),this.iCheckValue[i][6]>this.C2H-this.iCheckValue[i][0]&&this.iCheckValue[i][8]>0&&(this.iCheckValue[i][8]=-this.iCheckValue[i][8]);for(this.xm3f.DrawTextEx(this.C2X+20,this.C2Y+this.C2H,"请按顺序点击文字组成成语",4294967295,30,101,1,1,0,0,0),i=0;i<this.iCRP;i++)t=this.iCheckResult[i],this.xm3f.DrawTextEx(this.C2X+20+80*i,this.C2Y+this.C2H+40,this.sCheckWord[t],this.iResultValue[i][4],this.iResultValue[i][0],101,.01*this.iResultValue[i][2],.01*this.iResultValue[i][3],this.iResultValue[i][1],this.C2X+20+80*i+.005*this.iResultValue[i][2]*this.iResultValue[i][0],this.C2Y+this.C2H+10+.005*this.iResultValue[i][3]*this.iResultValue[i][0]);this.btn_checkreset.Draw(),this.btn_checkok.Draw()}fn.gi().Draw()}ProcTouch(){for(var i,t,s;Gh.gi().poptouch();)if(i=Gh.gi().procing.iTouchStat,t=Gh.gi().procing.iX,s=Gh.gi().procing.iY,!fn.gi().ProcTouch(Gh.gi().procing.iTouchStat,Gh.gi().procing.iX,Gh.gi().procing.iY)){if(this.bCheck2){var e;if(this.btn_checkok.ProcTouch(i,t,s))return this.btn_checkok.bCheck()&&(this.bCheck2=!1,Mh.gi().s_Check2Reply(1e3*this.iCheckResult[0]+100*this.iCheckResult[1]+10*this.iCheckResult[2]+this.iCheckResult[3])),!0;if(this.btn_checkreset.ProcTouch(i,t,s))return this.btn_checkreset.bCheck()&&(this.iCRP=0,this.iCheckResult[0]=0,this.iCheckResult[1]=0,this.iCheckResult[2]=0,this.iCheckResult[3]=0),!0;if(1==Gh.gi().procing.iTouchStat)for(a=0;a<4;a++)if(bn.bInRect(Gh.gi().procing.iX,Gh.gi().procing.iY,this.C2X+this.iCheckValue[a][5],this.C2Y+this.iCheckValue[a][6],80,80)&&this.iCRP<4){for(this.iCheckResult[this.iCRP]=a,e=0;e<7;e++)this.iResultValue[this.iCRP][e]=this.iCheckValue[a][e];this.iCRP++,this.ResetCheckValue()}return!0}if(this.bCheck){var a,n,o;for(600,200,n=(h.SCRW-600)/2,o=(h.SCRH-200)/2,a=0;a<4&&!(this.iCheckLast>0);a++)3==Gh.gi().procing.iTouchStat&&bn.bInRect(Gh.gi().procing.iX,Gh.gi().procing.iY,n+150*a,o,150,200)&&(0==this.iCheckFace[a]?(this.bCheck=!1,Mh.gi().s_CheckReply(a)):(gn.xntf.bAllow=!1,ln.gi().iXStat!=ln.GS_KICKOUT&&ln.gi().PushStat(ln.GS_KICKOUT),ln.gi().LastStat(0).sDetail=this.sCheckError,this.bCheck=!1));return!0}Hs.gi().ProcTouch(Gh.gi().procing.iTouchStat,Gh.gi().procing.iX,Gh.gi().procing.iY)||Z.fm.ProcTouch(Gh.gi().procing.iTouchStat,Gh.gi().procing.iX,Gh.gi().procing.iY)||Ss.fm.ProcTouch(Gh.gi().procing.iTouchStat,Gh.gi().procing.iX,Gh.gi().procing.iY)||ln.gi().ProcTouch(Gh.gi().procing.iTouchStat,Gh.gi().procing.iX,Gh.gi().procing.iY,Gh.gi().procing.iSourceX,Gh.gi().procing.iSourceY)}return!1}ResetCheckValue(){var i;for(i=0;i<4;i++)this.iCheckValue[i][0]=bn.GetRand(60,80),0==bn.GetRand(0,1)?this.iCheckValue[i][1]=bn.GetRand(0,30):this.iCheckValue[i][1]=bn.GetRand(330,360),this.iCheckValue[i][2]=bn.GetRand(50,100),this.iCheckValue[i][3]=bn.GetRand(50,100),this.iCheckValue[i][4]=4278190080|bn.GetRand(128,255)<<16|bn.GetRand(128,255)<<8|bn.GetRand(128,255),this.iCheckValue[i][5]=bn.GetRand(0,this.C2W),this.iCheckValue[i][6]=bn.GetRand(0,this.C2H),this.iCheckValue[i][7]=bn.GetRand(2,4),this.iCheckValue[i][8]=6-this.iCheckValue[i][7],0==bn.GetRand(0,1)&&(this.iCheckValue[i][7]=-this.iCheckValue[i][7]),0==bn.GetRand(0,1)&&(this.iCheckValue[i][8]=-this.iCheckValue[i][8])}OnReceive(){if(null!=gn.xntf)for(var i=0,t=this.pls;gn.xntf.GetQueue();)bn.arraycopy(gn.xntf.msg.recvout.data,0,t.databuf,0,gn.xntf.msg.recvout.iSize),t.iOffset=0,t.iLength=gn.xntf.msg.recvout.iSize,503!=(i=t.GetNextShort())&&2032!=i&&bn.sop("------------------Recv msg : "+i),this.OnReceiveOrder(i)}OnReceiveOrder(i){var s,e,a,n,o,r,c,l,b,_,f=this.pls;switch(i){case 500:Mh.gi().GetBase(f),gn.bConnected=!0,Mh.gi().s_CheckVersion();break;case 502:break;case 503:Mh.gi().iEchoId=f.GetNextByte(),gn.xntf.msg.startmessage.data[gn.xntf.msg.startmessage.iSize-1]=Mh.gi().iEchoId;break;case 510:console.log("下线510"),s=f.GetNextByte(),ph.iClientID=f.GetNextInt(),0==s&&(gn.xntf.bAllow=!1,ln.gi().PushStat(ln.GS_KICKOUT),ln.gi().LastStat(0).sDetail="当前游戏版本号过低，请下载最新版本的游戏后重新登录，点击确定按钮退出游戏");break;case 511:if(this.bCheck=!1,this.bCheck2=!1,gn.xntf.bAllow=!1,ln.gi().iXStat==ln.GS_KICKOUT)break;ln.gi().PushStat(ln.GS_KICKOUT),ln.gi().LastStat(0).sDetail=f.GetNextString();break;case 512:for(s=0;s<4;s++)this.iCheckFace[s]=bn.GetRand(1,3),this.iCheckAnima[s]=bn.GetRand(0,5),this.iCheckRot[s]=bn.GetRand(0,60)-30;this.iCheckFace[f.GetNextByte()]=0,this.iCheckLast=80,this.bCheck=!0;break;case 513:b=f.GetNextString(),n=f.GetNextInt(),gn.xntf.ResetSever(b,n);break;case 514:for(this.C2W=h.SCRW/2,this.C2H=h.SCRH/2,this.C2X=(h.SCRW-this.C2W)/2,this.C2Y=(h.SCRH-this.C2H)/2,this.iCRP=0,s=0;s<4;s++)this.sCheckWord[s]=f.GetNextString(),this.iCheckResult[s]=0;this.ResetCheckValue(),null==this.btn_checkok&&(this.btn_checkok=new D(gn.xani_ui),this.btn_checkok.InitButton("统一大按钮2"),this.btn_checkok.sName="确定",this.btn_checkreset=new D(gn.xani_ui),this.btn_checkreset.InitButton("统一大按钮2"),this.btn_checkreset.sName="重置"),this.btn_checkok.Move(this.C2X+this.C2W,this.C2Y+this.C2H-20-50,80,50),this.btn_checkreset.Move(this.C2X+this.C2W,this.C2Y+20,80,50),this.bCheck2=!0;break;case 515:gn.iTraverse=f.GetNextInt(),1==gn.iTraverse&&Ih.gi().RemoveTraverse(0);break;case 1e3:if(ln.gi().LastStatType(0)!=ln.GS_LOADING1||ln.gi().LastStatType(1)!=ln.GS_REGIST)break;1==(s=f.GetNextByte())?(b=ln.gi().LastStat(1).in_user.sDetail,_=ln.gi().LastStat(1).in_pass.sDetail,ln.gi().PopStat(2),ln.gi().PushStat(ln.GS_LOGIN),ln.gi().PushStat(ln.GS_MESSAGE1),ln.gi().LastStat(1).in_user.sDetail=b,ln.gi().LastStat(1).in_pass.sDetail=_,ln.gi().LastStat(0).sDetail="注册成功，进入登录页面"):(ln.gi().PopStat(1),ln.gi().PushStat(ln.GS_MESSAGE1),ln.gi().LastStat(0).sDetail=f.GetNextString());break;case 1001:1==(s=f.GetNextByte())?(31==t.QUDAO&&fn.gi().proc_extend("uc_get_acid",0,f.GetNextString()),0==ph.iHaveSeverRecord?Mh.gi().s_GetSeverList(100):Mh.gi().s_GetRoleList(ph.iLastSector,ph.iLastSever),fn.gi().iStat=10,bn.sop("登陆成功")):(ln.gi().PopStat(1),$h.Open(f.GetNextString()));break;case 1006:xh.me.iRid=0,Hh.Open(f);break;case 1003:break;case 1002:Uh.Open(f);break;case 1004:if(ln.gi().LastStatType(0)!=ln.GS_LOADING1||ln.gi().LastStatType(1)!=ln.GS_CREATEROLE)break;0==(e=f.GetNextByte())?(f.GetNextString(),Mh.gi().s_StartGame(f.GetNextInt())):(L.easymsg.AddMessage(f.GetNextString()),ln.gi().PopStat(1));break;case 1005:if(console.log("进入游戏:",xh.me.iRace,xh.me.iSex),0==(e=f.GetNextByte())){if(Mh.gi().iUid=f.GetNextInt(),Mh.gi().iPid=f.GetNextInt(),b=f.GetNextString(),n=f.GetNextInt(),Mh.gi().iEchoId=0,Mh.gi().set_Head(),console.log("重置链接：",fn.QUDAO),0==fn.QUDAO)gn.xntf.ResetSever("ws://"+b+":"+n),gn.xntf.onClose();else{const i="wss://login.qi-guo.cn/game"+n;gn.xntf.ResetSever(i),console.log("server:",i)}ln.gi().ResetStat(),ln.gi().PushStat(ln.GS_GAMEING),ln.gi().PushStat(ln.GS_LOADING2),0==ph.iQQSay&&(yt.Initex("欢迎来到七国，我是琴清，下面我将带您熟悉游戏#e#cff0000老玩家可在系统设置关闭引导",0,1,"普通引导",0,2,"语音引导",1,1,"确定"),ph.iQQSay++),h.SYSW>=1280?yh.iScreenLS=192e3/(h.SYSW-800):yh.iScreenLS=400*(h.SYSW-800)/480,yh.iSameRate=0,console.log("登录成功"),Mh.gi().s_UseSkill(100,yh.iNearRoleCount,0,0,0,0,0)}else 5==e&&(console.log("登录失败"),ln.gi().PopStat(1),ln.gi().PushStat(ln.GS_MESSAGE1),ln.gi().objstack[ln.gi().iStatPoint].sDetail="进入失败，联系GM");break;case 1007:Yh.GetRandName(f);break;case 1100:fn.gi().OnReceive(f);break;case 2e3:for(s=f.GetNextInt(),e=f.GetNextInt(),xh.me.iX=f.GetNextInt(),xh.me.iY=f.GetNextInt(),xh.me.iDx=xh.me.iX,xh.me.iDy=xh.me.iY,rh.gameing.m_map.LoadMap(s,e,rh.gameing.me.iX,rh.gameing.me.iY),Ih.gi().mapdata.sMapDetail=f.GetNextString(),Ih.gi().iKeepDetialAsMapId=s,Ih.gi().mapdata.iMapFlag=f.GetNextInt(),0!=(1&Ih.gi().mapdata.iMapFlag)&&Ih.gi().vbk.ClearVisual(),rh.gameing.me.ChangeStat("站立"),s=0;s<xh.MAXMARK;s++)rh.gameing.me.iMarks[s][0]=rh.gameing.me.iX,rh.gameing.me.iMarks[s][1]=rh.gameing.me.iY,rh.gameing.me.iMarks[s][2]=rh.gameing.me.iFace8;break;case 2001:console.log("角色信息更新"),xh.me.getinit(f),Mh.gi().s_CheckVersion(),fn.gi().mta_record(6,0,"");break;case 2002:xh.me.GetBaseAtt(f);break;case 2003:xh.me.getschoolskill(f);break;case 2004:xh.me.getgovskill(f);break;case 2005:xh.me.getgovxiu(f);break;case 2006:xh.me.getflag(f);break;case 2007:ln.gi().LastStatType(0)==ln.GS_SETTITLE&&ln.gi().LastStat(0).getlist(f);break;case 2008:xh.me.sName=f.GetNextString();break;case 2009:xh.me.GetExt(f);break;case 2020:es.gi().GetMessage(f);break;case 2021:uh.gi().GetFriends(f);break;case 2022:dh.gi().GetPrivateMessage(f);break;case 2030:if(s=f.GetNextInt(),e=f.GetNextInt(),xh.me.iX=f.GetNextInt(),xh.me.iY=f.GetNextInt(),Ih.gi().iCurrentMapId==s)return void(Ih.gi().iMapChangeing>=100&&(Ih.gi().iMapChangeing-=100));for(Ih.gi().vbk.ClearVisual(),console.log("地图传送:",this.getTime()),Ih.gi().LoadMap(s,e,xh.me.iX,xh.me.iY),Ih.gi().mapdata.sMapDetail=f.GetNextString(),Ih.gi().iKeepDetialAsMapId=s,Ih.gi().mapdata.iMapFlag=f.GetNextInt(),0!=(1&Ih.gi().mapdata.iMapFlag)&&Ih.gi().vbk.ClearVisual(),xh.me.ChangeStat("站立"),s=0;s<xh.MAXMARK;s++)rh.gameing.me.iMarks[s][0]=rh.gameing.me.iX,rh.gameing.me.iMarks[s][1]=rh.gameing.me.iY,rh.gameing.me.iMarks[s][2]=rh.gameing.me.iFace8;for(s=0,e=0;e<rh.iNearMax;e++)rh.gameing.nrs[e].bUseing=!1;Ih.gi().iMapChangeing>=100&&(Ih.gi().iMapChangeing-=100);break;case 2031:s=f.GetNextInt(),e=f.GetNextInt(),s==xh.me.iX&&e==xh.me.iY||(Ih.gi().mfy.iPath[0][0]=xh.me.iX,Ih.gi().mfy.iPath[0][1]=xh.me.iY,Ih.gi().mfy.iPath[1][0]=s,Ih.gi().mfy.iPath[1][1]=e,Ih.gi().mfy.iPathDeep=2,Ih.gi().vbk.iGoToNpcFlag=-1,Ih.gi().vbk.iGoToNpcId=-1,xh.me.start(Ih.gi().mfy.iPath,Ih.gi().mfy.iPathDeep));break;case 2032:var u,d;for(n=0,s=f.GetNextInt();s>0;){for(d=!1,e=0;e<rh.iNearMax&&(!rh.gameing.nrs[e].bUseing||rh.gameing.nrs[e].iRid!=s);e++);if(e>=rh.iNearMax){for(e=0;e<rh.iNearMax&&rh.gameing.nrs[e].bUseing;e++);e>=rh.iNearMax&&(e=0),d=!0,rh.gameing.nrs[e].bUseing=!0,rh.gameing.nrs[e].iRid=s,rh.gameing.nrs[e].iPopoDelay=0,rh.gameing.nrs[e].sTitle="",rh.gameing.nrs[e].iFollowPid=0,rh.gameing.nrs[e].iFollowTid=1e4}u=rh.gameing.nrs[e],0!=(1&(e=f.GetNextByte()))&&(u.iDx=f.GetNextShort(),u.iDy=f.GetNextShort()),0!=(2&e)&&(u.iFighting=f.GetNextByte()),0!=(4&e)&&(u.iIsLeader=f.GetNextByte()),0!=(8&e)&&(u.sName=f.GetNextString(),a=f.GetNextByte(),u.iSex=parseInt(a/10),u.iRace=a%10,u.bsc=!0),0!=(16&e)&&(u.iDFaceTo=f.GetNextByte()),0!=(32&e)&&(0==(1&(a=f.GetNextByte()))?u.iIsSelling=0:(u.iIsSelling=1,u.sSellName=f.GetNextString()),u.iIsVip=0==(2&a)?0:1,u.iDChangeType=0==(4&a)?0:f.GetNextShort(),0==(8&a)?(u.iColor[0]=0,u.iColor[1]=0,u.iColor[2]=0,u.iColor[3]=0,u.iColor[4]=0,u.iColor[5]=0):(o=f.GetNextShort(),u.iColor[0]=7&o,u.iColor[1]=o>>3&7,u.iColor[2]=o>>6&7,u.iColor[3]=o>>9&7,u.iColor[4]=o>>12&7),u.iAura=0==(16&a)?0:f.GetNextShort()),0!=(64&e)&&(u.iDMountsTid=f.GetNextShort(),a=f.GetNextInt(),u.iDWeapTid=a%1e4,u.bwc=!0,a=f.GetNextShort(),u.iSchoolId=parseInt(a/1e3),u.iLev=a%1e3,u.sTitle=f.GetNextString(),u.iFollowPid=f.GetNextInt(),u.iFollowTid=f.GetNextShort(),u.sFollowName=f.GetNextString()),d&&(u.iX=u.iDx,u.iY=u.iDy,u.SetMarks(),u.iFaceTo=u.iDFaceTo,u.bfc8=!0),0!=(128&e)&&(u.bUseing=!1,n++,d&&gn.sop1("m error")),s=f.GetNextInt()}break;case 2033:3==(s=f.GetNextByte())?Zt.teamlist(f):1==s?Qt.rolelist(f):2==s?Qt.sZz=f.GetNextString():4==s?(ln.gi().PushStat(ln.GS_TEAMOPERATE),Mh.gi().s_TeamOperate(10,0,0)):5==s&&(1==f.GetNextByte()?H.bSingleAutoTeaming=!0:H.bSingleAutoTeaming=!1);break;case 2034:s=f.GetNextInt(),e=f.GetNextInt(),xh.me.iX=s,xh.me.iY=e,Ih.gi().mfy.iPath[0][0]=xh.me.iX,Ih.gi().mfy.iPath[0][1]=xh.me.iY,Ih.gi().mfy.iPath[1][0]=xh.me.iX,Ih.gi().mfy.iPath[1][1]=xh.me.iY,Ih.gi().mfy.iPathDeep=1,xh.me.ChangeStat("站立");break;case 2035:if(H.iTeamRid[0]=f.GetNextInt(),0==H.iTeamRid[0])H.iTmpTeamRid[0]=0;else{for(s=0;s<xh.MAXTEAMOLE;s++)s>0&&(H.iTeamRid[s]=f.GetNextInt()),H.iTmpTeamRid[s]=f.GetNextInt(),0!=H.iTmpTeamRid[s]&&(H.sName[s]=f.GetNextString(),H.iRas[s]=f.GetNextByte(),H.iSchoolId[s]=f.GetNextByte(),H.iLev[s]=f.GetNextShort(),o=f.GetNextShort(),H.iColor[s][0]=7&o,H.iColor[s][1]=o>>3&7,H.iColor[s][2]=o>>6&7,H.iColor[s][3]=o>>9&7,H.iColor[s][4]=o>>12&7,H.iWeapTid[s]=f.GetNextShort(),H.sMapName[s]=f.GetNextString());xh.iTeamZhen=f.GetNextByte(),H.iTeamTarget=f.GetNextByte(),xh.iTeamMap=f.GetNextShort(),H.iLev1=f.GetNextShort(),H.iLev2=f.GetNextShort(),1==f.GetNextByte()?H.bLeaderAutoTeaming=!0:H.bLeaderAutoTeaming=!1}Qt.CleanAnima(),jt.CleanAnima(),ln.gi().LastStatType(0)==ln.GS_TEAMCREATE&&ln.gi().PopStat(1);break;case 2036:0==(s=f.GetNextByte())?Qt.AddTeamRequest(f):1==s&&xh.me.BeInvite(f);break;case 2040:ht.gi().GetGoods(f);break;case 2041:ht.gi().UpdateOneGoods(f);break;case 2043:ct.gi().InitSell(f);break;case 2044:ct.gi().IndexSell(f);break;case 2045:th.gi().IndexBuy(f);break;case 2046:Qi.getgoods(f);break;case 2047:ct.gi().AddSellRecord(f);break;case 2048:Le.gi().PushGoods(f);break;case 2049:Fa.Open(f);break;case 2050:Bi.mp.GetPets(f);break;case 2051:Bi.mp.UpdateOnePet(f);break;case 2052:Bi.mp.GetPetBaseAtt(f);break;case 2056:gh.Open(f);break;case 2060:Ih.gi().vbk.getnpc(f);break;case 2061:ze.Open(f);break;case 2062:Ih.gi().vbk.npctalk(f);break;case 2063:Ih.gi().vbk.clearnpc(f);break;case 2064:He.ns.FreshGoods(f);break;case 2065:Ih.gi().vbk.npcmove(f);break;case 2066:ys.OPEN(f);break;case 2067:Ih.gi().vbk.getnpctalkext(f);break;case 2068:ia.Open(f);break;case 2069:s=f.GetNextInt(),e=f.GetNextInt(),a=f.GetNextByte(),b=f.GetNextString(),n=f.GetNextInt(),o=f.GetNextInt(),r=f.GetNextByte(),c=f.GetNextInt(),l=f.GetNextInt(),G.fe.AddFireworks(s,e,a,b,n,o,r,c,l);break;case 2070:Us.m.getmissionindex(f);break;case 2071:Us.m.getmissiondetail(f),Ls.gi().FreshMission();break;case 2072:Us.m.cleanclientmission(f),Ls.gi().FreshMission();break;case 2080:Fi.mg.initmygov(f);break;case 2081:break;case 2083:if(ln.gi().iXStat==ln.GS_GOVFRAME)ln.gi().LastStat(0).getgovdata(f);else if(ln.gi().LastStatType(0)==ln.GS_MEMBERDETAIL){ln.x_stat.LastStat(0).getgovdata(f)}break;case 2085:Ih.gi().mapdata.sMapDetail=f.GetNextString(),Ih.gi().iKeepDetialAsMapId=s;break;case 2088:Fi.mg.govoperateframe(f);break;case 2090:Pa.Open(f);break;case 2093:ln.gi().LastStatType(0)==ln.GS_LOADING1&&ln.gi().PopStat(1),ln.gi().LastStatType(0)==ln.GS_FINDFRIEND&&ln.gi().PopStat(1),ln.gi().LastStatType(0)!=ln.GS_WATCHON&&ln.gi().PushStat(ln.GS_WATCHON),ln.gi().LastStat(0).InitData(f);break;case 2094:za.sDetail=f.GetNextString(),za.sTitle=f.GetNextString(),f.GetNextData(),za.sDetail=f.DataToString();break;case 2095:0==(e=f.GetNextByte())?Ga.Open(f):1==e?Ga.Get(f):2==e?Ga.Applyed(f):3==e?Te.Open(f):5==e?Te.InitMemberList(f):6==e?Te.InitMemberDetail(f):7==e?Te.ChangeJob(f):9==e?Te.ApplyList(f):10==e?Te.ApplyDetail(f):11==e?Te.ApplyCheck(f):12==e?Te.InitGovEvent(f):13==e?Te.InitEventDetail(f):14==e?ke.GetMyMission(f):15==e?ke.GetMyDetail(f):17==e?ke.CancelEntrust(f):18==e?le.GetSet(f):19==e?Te.UpdateDetail(f):21==e?Ea.Open(f):22==e&&Ie.GetData(f);break;case 2096:Ue.gi().getlogicpath(f);break;case 2097:0==(e=f.GetNextByte())?Ls.gi().special_doyb():1==e&&(pn.fy.bShow=!0);break;case 2010:on.mt.tradestart(f);break;case 2011:ln.gi().iXStat==ln.GS_MYTRADEFRAME&&ln.gi().PopStat(1),on.bCheckTradeing=!1;break;case 2012:ln.gi().iXStat==ln.GS_MYTRADEFRAME&&on.mt.tradeready(f);break;case 2900:0==(s=f.GetNextByte())?Ge.Open(f):1==s&&an.Open(f);break;case 2100:Ht.mm.UpdateOneMounts(f);break;case 2150:ji.ml.Init(f);break;case 2151:ji.bShowBlock=!0;break;case 2152:sn.Open(f);break;case 2153:tn.Open(f);break;case 2205:for(;ln.gi().iXStat!=ln.GS_GAMEING&&ln.gi().iXStat!=ln.GS_PRIVATECHAT&&ln.gi().iXStat!=ln.GS_SENDPUBLICCHAT;)ln.gi().PopStat(1);Ih.gi().iMapChangeing=0,Ih.gi().mfy.iPathDeep=0,xh.me.ChangeStat("站立"),yh.SetScreenMode(10),ws.gi().InitFight(f),yh.SetScreenMode(11),Ks.sw.bLocked=!1;break;case 2206:ws.gi().updatefat(f);break;case 2207:ws.gi().setpetused(f);break;case 2202:ws.gi().getfightdata(f);break;case 2203:ws.gi().bFightFinished=!0;break;case 2204:ws.gi().getfightflag(f);break;case 2208:fs.bOpen=!0,f.GetNextByte(),fs.iLostExp=f.GetNextInt(),fs.iLostMoney=f.GetNextInt(),fs.sDetail=f.GetNextString();break;case 2209:for(n=0;n<6&&!((s=f.GetNextByte())>=64);n++)e=f.GetNextInt(),a=f.GetNextInt(),ht.gi().goods[1][s].iGid==e&&(ht.gi().goods[1][s].iAtts[5]=a);break;case 2301:Ja.getquestion(f);break;case 2302:Ua.getanswer(f);break;case 2303:Ns.Open(f);break;case 2304:Ya.Open(f);break;case 2305:Hs.gi().InitGuideFromSever(f);break;case 2306:yt.Init(f);break;case 2307:bt.Open(f);break;case 2400:break;case 2401:wt.OpenManage(f);break;case 2402:wt.OpenApply(f);break;case 2403:wt.GetStat(f),gn.bInitFinished=!0;break;case 2404:wt.GetTarget(f);break;case 2408:Ta.OPEN(f);break;case 2500:te.mft.iFTid=f.GetNextInt(),te.mft.iFTJob=f.GetNextInt();break;case 2501:ua.Open(f);break;case 2502:ga.Open(f);break;case 2503:xa.Open(f);break;case 2504:pa.Open(f);break;case 2505:la.Open(f);case 2506:la._2506c(f);break;case 2600:L.easymsg.AddMessage(f.GetNextString()),ln.gi().iXStat==ln.GS_LOADING1&&ln.gi().PopStat(1),Ih.gi().iMapChangeing=0;break;case 2601:Z.fm.Open(f.GetNextString()),ln.gi().iXStat==ln.GS_LOADING1&&ln.gi().PopStat(1),Ih.gi().iMapChangeing=0;break;case 2602:oh.gi().InitProgress(f);break;case 2700:1==(e=f.GetNextByte())?(gt.bShow=!0,gt.Open()):gt.bShow=!1;break;case 2701:ea.Open(f);break;case 2800:nh.peb.SetIcon(f);break;case 2801:this.RunCommand(f);break;case 2802:Ss.fm.Open(f.GetNextString()),ln.gi().iXStat==ln.GS_LOADING1&&ln.gi().PopStat(1),Ih.gi().iMapChangeing=0;break;case 2910:Va.LeaderBoardFresh(f);break;case 2901:0==(s=f.GetNextByte())&&sa.Open(f);break;case 5e3:gn.pxe.RunByPls(f)}}getTime(){let i=new Date(Date.now()),t=i.getFullYear(),s=i.getMonth()+1,e=i.getDate();return t+"-"+(s<10?"0"+s:s)+"-"+(e<10?"0"+e:e)+" "+i.toTimeString().substr(0,8)}RunCommand(i){var t=i.GetNextString(),s=i.GetNextInt(),e=i.GetNextString();"首次登陆黑屏提示语"==t?xs.jq.StartJQ(2):"升级效果"==t?Ze.ue.Init():"活跃抽奖结果"==t?ln.gi().iXStat==ln.GS_PROMPTACTIVITY&&ln.gi().LastStat(0).lottery_startround(s):"帮派副本进度查询"==t?Ie.Open():"升级"==t?fn.gi().mta_record(10,0,""):"uc_get_sign"==t&&fn.gi().proc_extend(t,s,e)}}gn.iPlayingId=-1,gn.ResetSound=function(){if(null!=gn.x_wav){if(0==yh.iMusic||_n.bPause)return gn.x_wav.StopBackMusic(),void(gn.iPlayingId=-1);var i=-1;if((i=ln.gi().bGameing()?ws.bFighting?1:1==Ih.gi().iCurrentMapId||3==Ih.gi().iCurrentMapId||14==Ih.gi().iCurrentMapId||15==Ih.gi().iCurrentMapId||16==Ih.gi().iCurrentMapId?2:3:0)!=gn.iPlayingId)switch(gn.iPlayingId=i,i){case 0:gn.x_wav.StartBackMusic("start",!0);break;case 1:gn.x_wav.StartBackMusic("fight",!0);break;case 2:gn.x_wav.StartBackMusic("city",!0);break;case 3:gn.x_wav.StartBackMusic("site",!0)}}},gn.bInitFinished=!1,gn.sop=function(i){},gn.sop1=function(i){},gn.sop2=function(i){},gn.pp=null,gn.gi=function(){return null==gn.pp&&(gn.pp=new gn),gn.pp},gn.iDelay,gn.aaa=new l,gn.aa_auras,gn.aa_fightready,gn.xntf,gn.x_record,gn.x_wav=null,gn.xani_local,gn.xani_nui1,gn.xani_nui2,gn.xani_nui3,gn.xani_nui4,gn.xani_nui5,gn.xani_nui6,gn.xani_aura,gn.xani_nicon,gn.xani_ngoods,gn.xani_stand,gn.xani_shot,gn.xani_frame,gn.xani_button,gn.xani_icon,gn.xani_other,gn.xani_back,gn.xani_color,gn.xani_newrole,gn.xani_weap,gn.xani_nmounts,gn.xani_ui,gn.xani_ui2,gn.xani_ui3,gn.xani_ui4,gn.xani_face,gn.xani_head,gn.xani_skill,gn.xani_effect,gn.xani_skills,gn.xani_grow,gn.xani_pets,gn.de_goods,gn.de_pet,gn.de_map,gn.de_skill,gn.de_npc,gn.de_mounts,gn.de_fuben,gn.de_chuan_song,gn.de_grow,gn.pxe,gn.gp,gn.bCheckRes=!1,gn.iTraverse=0,gn.m_vi,gn.sLoginIp=e.sLGURL,gn.iLoginPort=8002,gn.bInited=!1,gn.bConnected=!1,gn.iNowMillis,gn.xntf=null;new class{constructor(){window.Laya3D?Laya3D.init(i.width,i.height):Laya.init(i.width,i.height,Laya.WebGL),Laya.Physics&&Laya.Physics.enable(),Laya.DebugPanel&&Laya.DebugPanel.enable(),Laya.stage.scaleMode=i.scaleMode,Laya.stage.screenMode=i.screenMode,Laya.stage.alignV=i.alignV,Laya.stage.alignH=i.alignH,Laya.stage.frameRate="fast",Laya.URL.exportSceneToJson=i.exportSceneToJson,(i.debug||"true"==Laya.Utils.getQueryString("debug"))&&Laya.enableDebugPanel(),i.physicsDebug&&Laya.PhysicsDebugDraw&&Laya.PhysicsDebugDraw.enable(),i.stat&&Laya.Stat.show(0,50),Laya.alertGlobalError=!0,console.log("引入游戏"),Ct.gi().Init()}onVersionLoaded(){}onConfigLoaded(){}}}();